"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[71090],{603905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(667294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=u(n),m=s,h=p["".concat(l,".").concat(m)]||p[m]||c[m]||r;return n?a.createElement(h,i(i({ref:t},d),{},{components:n})):a.createElement(h,i({ref:t},d))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,i=new Array(r);i[0]=p;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:s,i[1]=o;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},404095:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>d});n(667294);var a=n(603905);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const i={id:"authUsers",title:"\u30e6\u30fc\u30b6\u30fc\u3068\u30bb\u30c3\u30b7\u30e7\u30f3"},o=void 0,l={unversionedId:"REST/authUsers",id:"version-20-R5/REST/authUsers",title:"\u30e6\u30fc\u30b6\u30fc\u3068\u30bb\u30c3\u30b7\u30e7\u30f3",description:"When scalable sessions are enabled (recommended), REST requests can create and use web user sessions, providing extra features such as multiple requests handling, data sharing between web client processes, and control of user privileges.",source:"@site/i18n/ja/docusaurus-plugin-content-docs/version-20-R5/REST/authUsers.md",sourceDirName:"REST",slug:"/REST/authUsers",permalink:"/docs/ja/REST/authUsers",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20REST%2FauthUsers.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"authUsers",title:"\u30e6\u30fc\u30b6\u30fc\u3068\u30bb\u30c3\u30b7\u30e7\u30f3"},sidebar:"docs",previous:{title:"\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a",permalink:"/docs/ja/REST/configuration"},next:{title:"\u30b5\u30fc\u30d0\u30fc\u60c5\u5831\u306e\u53d6\u5f97",permalink:"/docs/ja/REST/genInfo"}},u={},d=[{value:"\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9",id:"\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9",level:2},{value:"\u30c7\u30d5\u30a9\u30eb\u30c8\u30e2\u30fc\u30c9",id:"\u30c7\u30d5\u30a9\u30eb\u30c8\u30e2\u30fc\u30c9",level:3},{value:"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9",id:"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9",level:3},{value:"\u8a18\u8ff0\u7684REST\u30ea\u30af\u30a8\u30b9\u30c8",id:"\u8a18\u8ff0\u7684rest\u30ea\u30af\u30a8\u30b9\u30c8",level:3},{value:"<code>Function authentify</code>",id:"function-authentify",level:3},{value:"\u30b7\u30f3\u30bf\u30c3\u30af\u30b9",id:"\u30b7\u30f3\u30bf\u30c3\u30af\u30b9",level:4},{value:"\u4f8b\u984c",id:"\u4f8b\u984c",level:4},{value:"Using <code>On REST Authentication</code>",id:"using-on-rest-authentication",level:2},{value:"\u4f8b\u984c",id:"\u4f8b\u984c-1",level:3}],c={toc:d};function p(e){var{components:t}=e,i=r(e,["components"]);return(0,a.kt)("wrapper",s({},c,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/WebServer/sessions#enabling-sessions"}),"scalable sessions are enabled")," (recommended), REST requests can create and use ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/WebServer/sessions"}),"web user sessions"),", providing extra features such as multiple requests handling, data sharing between web client processes, and control of user privileges."),(0,a.kt)("p",null,"When a web user session is opened, you can handle it through the ",(0,a.kt)("inlineCode",{parentName:"p"},"Session")," object and the ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/API/SessionClass"}),"Session API"),". \u5f8c\u7d9a\u306e REST\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u540c\u3058\u30bb\u30c3\u30b7\u30e7\u30f3cookie \u3092\u518d\u4f7f\u7528\u3057\u307e\u3059\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"On 4D Server, opening a REST session might require that a free 4D client license is available, depending on the ",(0,a.kt)("a",s({parentName:"li"},{href:"#user-login-modes"}),"user login mode"),".",(0,a.kt)("br",null)),(0,a.kt)("li",{parentName:"ul"},"\u30b7\u30f3\u30b0\u30eb\u30e6\u30fc\u30b6\u30fc\u306e 4D \u3067\u306f\u3001\u30c6\u30b9\u30c8\u76ee\u7684\u3067 REST\u30bb\u30c3\u30b7\u30e7\u30f3\u3092 3\u3064\u307e\u3067\u958b\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"))),(0,a.kt)("h2",s({},{id:"\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9"}),"\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9"),(0,a.kt)("p",null,'REST\u30ea\u30af\u30a8\u30b9\u30c8\u304c 4D\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u3092\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9\u306b\u3088\u3063\u3066\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 "\u30c7\u30d5\u30a9\u30eb\u30c8" \u307e\u305f\u306f "\u5f37\u5236\u30ed\u30b0\u30a4\u30f3" \u306e 2\u3064\u306e\u30e6\u30fc\u30b6\u30fc\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9\u304b\u3089\u9078\u629e\u3067\u304d\u307e\u3059\u3002'),(0,a.kt)("p",null,"You set the user login mode through the ",(0,a.kt)("inlineCode",{parentName:"p"},"forceLogin")," property in the ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/ORDA/privileges#rolesjson-file"}),(0,a.kt)("inlineCode",{parentName:"a"},"roles.json")," file"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"the ",(0,a.kt)("strong",{parentName:"li"},"default mode"),' is used if the "forceLogin" property is missing or set to "false",'),(0,a.kt)("li",{parentName:"ul"},"the ",(0,a.kt)("strong",{parentName:"li"},"force login"),' mode is used if the "forceLogin" property is set to "true".')),(0,a.kt)("admonition",s({},{type:"caution"}),(0,a.kt)("p",{parentName:"admonition"},"\u3053\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u5909\u66f4\u3057\u305f\u5834\u5408\u3001\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\u306b\u306f\u30b5\u30fc\u30d0\u30fc\u3092\u518d\u8d77\u52d5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002")),(0,a.kt)("admonition",s({},{type:"note"}),(0,a.kt)("p",{parentName:"admonition"},"In Qodly Studio for 4D, the mode can be set using the ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/WebServer/qodly-studio#force-login"}),(0,a.kt)("strong",{parentName:"a"},"Force login")," option")," in the Privileges panel.")),(0,a.kt)("h3",s({},{id:"\u30c7\u30d5\u30a9\u30eb\u30c8\u30e2\u30fc\u30c9"}),"\u30c7\u30d5\u30a9\u30eb\u30c8\u30e2\u30fc\u30c9"),(0,a.kt)("p",null,"\u30c7\u30d5\u30a9\u30eb\u30c8\u30e2\u30fc\u30c9\u3067\u306f\u3001REST\u30ea\u30af\u30a8\u30b9\u30c8\u306f Web\u30e6\u30fc\u30b6\u30fc\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u51e6\u7406\u3055\u308c\u3001\u81ea\u52d5\u7684\u306b\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u6d88\u8cbb\u3055\u308c\u307e\u3059 (Web\u30e6\u30fc\u30b6\u30fc\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u4f5c\u6210\u3055\u308c\u307e\u3059)\u3002 \u30b5\u30fc\u30d0\u30fc\u4e0a\u3067\u4fdd\u6301\u3055\u308c\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u6570\u3092\u5236\u5fa1\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u306e\u30b7\u30f3\u30d7\u30eb\u30e2\u30fc\u30c9\u3092\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\nWhen the default mode is enabled, you can authenticate users through the ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method (see below)."),(0,a.kt)("h3",s({},{id:"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9"}),"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c9"),(0,a.kt)("p",null,'"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3" \u30e2\u30fc\u30c9\u3067\u306f\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6d88\u8cbb\u306f Web\u30e6\u30fc\u30b6\u30fc\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u5207\u308a\u96e2\u3055\u308c\u307e\u3059\u3002 A license is required only when the ',(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/API/SessionClass#setprivileges"}),(0,a.kt)("inlineCode",{parentName:"a"},"Session.setPrivileges()"))," is executed, allowing you to control the number of used licenses."),(0,a.kt)("p",null,(0,a.kt)("a",s({parentName:"p"},{href:"#descriptive-rest-requests"}),"Descriptive REST requests"),' are always processed by the server, even if no web user session using a license is opened. \u3053\u306e\u5834\u5408\u3001\u305d\u308c\u3089\u306f "\u30b2\u30b9\u30c8" \u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4ecb\u3057\u3066\u51e6\u7406\u3055\u308c\u307e\u3059\u3002'),(0,a.kt)("p",null,"\u4ed6\u306e\u3059\u3079\u3066\u306e REST\u30ea\u30af\u30a8\u30b9\u30c8 (\u30c7\u30fc\u30bf\u51e6\u7406\u3084\u95a2\u6570\u306e\u5b9f\u884c) \u306f\u3001\u9069\u5207\u306a\u6a29\u9650\u3092\u6301\u3064 Web\u30bb\u30c3\u30b7\u30e7\u30f3\u5185\u3067\u5b9f\u884c\u3055\u308c\u305f\u5834\u5408\u306b\u306e\u307f\u51e6\u7406\u3055\u308c\u307e\u3059\u3002\u305d\u308c\u4ee5\u5916\u306e\u5834\u5408\u306f\u30a8\u30e9\u30fc\u3092\u8fd4\u3057\u307e\u3059 To assign privileges to a web session, you need to execute the ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/API/SessionClass#setprivileges"}),(0,a.kt)("inlineCode",{parentName:"a"},"Session.setPrivileges()"))," function for the session. \u3053\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u30014D\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6d88\u8cbb\u304c\u767a\u751f\u3057\u307e\u3059\u3002"),(0,a.kt)("p",null,"\u3053\u306e\u30e2\u30fc\u30c9\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ed\u30b0\u30a4\u30f3\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u5b9f\u88c5\u3067\u304d\u307e\u3059:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},'\u6700\u521d\u306e REST\u30b3\u30fc\u30eb (\u305f\u3068\u3048\u3070 Web\u30d5\u30a9\u30fc\u30e0\u30b3\u30fc\u30eb) \u3067\u306f\u3001"\u30b2\u30b9\u30c8" Web\u30e6\u30fc\u30b6\u30fc\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002 \u8a18\u8ff0\u7684\u30ea\u30af\u30a8\u30b9\u30c8\u4ee5\u5916\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\u6a29\u9650\u3082\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6d88\u8cbb\u3082\u3042\u308a\u307e\u305b\u3093\u3002'),(0,a.kt)("li",{parentName:"ol"},"You call your exposed ",(0,a.kt)("a",s({parentName:"li"},{href:"/docs/ja/ORDA/ordaClasses#datastore-class"}),"datastore class function")," named ",(0,a.kt)("inlineCode",{parentName:"li"},"authentify()")," (created beforehand), in which you check the user credentials and call ",(0,a.kt)("a",s({parentName:"li"},{href:"/docs/ja/API/SessionClass#setprivileges"}),(0,a.kt)("inlineCode",{parentName:"a"},"Session.setPrivileges()"))," with appropriate privileges."),(0,a.kt)("li",{parentName:"ol"},"The ",(0,a.kt)("inlineCode",{parentName:"li"},"/rest/$catalog/authentify")," request is sent to the server along with user credentials. This step only requires a basic login form that do not access data; it can be a Qodly form (called via the ",(0,a.kt)("inlineCode",{parentName:"li"},"/rest/$getWebForm")," request)."),(0,a.kt)("li",{parentName:"ol"},"\u30e6\u30fc\u30b6\u30fc\u304c\u6b63\u5e38\u306b\u8a8d\u8a3c\u3055\u308c\u305f\u5834\u5408\u30014D\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067\u6d88\u8cbb\u3055\u308c\u3001\u3059\u3079\u3066\u306e REST\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u53d7\u3051\u5165\u308c\u3089\u308c\u307e\u3059\u3002")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt-text",src:n(113820).Z,width:"1344",height:"756"})),(0,a.kt)("h3",s({},{id:"\u8a18\u8ff0\u7684rest\u30ea\u30af\u30a8\u30b9\u30c8"}),"\u8a18\u8ff0\u7684REST\u30ea\u30af\u30a8\u30b9\u30c8"),(0,a.kt)("p",null,'\u8a18\u8ff0\u7684REST\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044 Web\u30e6\u30fc\u30b6\u30fc\u30bb\u30c3\u30b7\u30e7\u30f3 ("\u30b2\u30b9\u30c8" \u30bb\u30c3\u30b7\u30e7\u30f3) \u3067\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 \u8a18\u8ff0\u7684REST\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u3092\u6307\u3057\u307e\u3059:'),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",s({parentName:"li"},{href:"/docs/ja/REST/catalog"}),(0,a.kt)("inlineCode",{parentName:"a"},"/rest/$catalog"))," requests (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"/rest/$catalog/$all"),") - access to available dataclasses"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/rest/$catalog/authentify")," - the datastore function used to login the user"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/rest/$getWebForm")," - the rendering of a Qodly form")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt-text",src:n(995656).Z,width:"1171",height:"302"})),(0,a.kt)("h3",s({},{id:"function-authentify"}),(0,a.kt)("inlineCode",{parentName:"h3"},"Function authentify")),(0,a.kt)("h4",s({},{id:"\u30b7\u30f3\u30bf\u30c3\u30af\u30b9"}),"\u30b7\u30f3\u30bf\u30c3\u30af\u30b9"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-4d"}),"exposed Function authentify({params : type}) {-> result : type}\n    // code\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"authentify()")," function must be implemented in the ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/ORDA/ordaClasses#datastore-class"}),"DataStore class")," of the project and must be called through a REST request."),(0,a.kt)("p",null,'"\u5f37\u5236\u30ed\u30b0\u30a4\u30f3" \u30e2\u30fc\u30c9\u304c\u6709\u52b9\u306a\u5834\u5408\u3001\u3053\u306e\u95a2\u6570\u306f\u3001REST\u30b2\u30b9\u30c8\u30bb\u30c3\u30b7\u30e7\u30f3\u304b\u3089\u552f\u4e00\u306e\u5229\u7528\u53ef\u80fd\u306a\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u9069\u5207\u306a\u6a29\u9650\u3092\u53d6\u5f97\u3059\u308b\u307e\u3067\u3001\u4ed6\u306e\u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u3084\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306f\u62d2\u5426\u3055\u308c\u307e\u3059\u3002'),(0,a.kt)("p",null,"The function can receive any authentication or contextual information as ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/REST/classFunctions#parameters"}),"parameter(s)")," and can return any value. \u3053\u306e\u95a2\u6570\u306f REST\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u306e\u307f\u547c\u3073\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u305f\u3081\u3001\u5f15\u6570\u306f POST\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u672c\u6587\u3067\u6e21\u3055\u308c\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002"),(0,a.kt)("p",null,"\u3053\u306e\u95a2\u6570\u306f 2\u90e8\u69cb\u6210\u3067\u66f8\u304b\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"REST\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u9001\u4fe1\u5143\u3092\u8b58\u5225\u3057\u3001\u8a8d\u8a3c\u3059\u308b\u305f\u3081\u306e\u30b3\u30fc\u30c9"),(0,a.kt)("li",{parentName:"ul"},"if the authentication is successful, a call to ",(0,a.kt)("a",s({parentName:"li"},{href:"/docs/ja/API/SessionClass#setprivileges"}),(0,a.kt)("inlineCode",{parentName:"a"},"Session.setPrivileges()"))," that assigns appropriate privileges to the session.")),(0,a.kt)("p",null,"If the function does not call ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/API/SessionClass#setprivileges"}),(0,a.kt)("inlineCode",{parentName:"a"},"Session.setPrivileges()")),", no privileges are assigned, no license is consumed and subsequent non-descriptive REST requests are rejected."),(0,a.kt)("h4",s({},{id:"\u4f8b\u984c"}),"\u4f8b\u984c"),(0,a.kt)("p",null,"\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067 Web\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u958b\u304f\u305f\u3081\u306b\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002 You created the following ",(0,a.kt)("inlineCode",{parentName:"p"},"authentify()")," function in the datastore class:"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-4d"}),'exposed Function authentify($credentials : Object) : Text\n\nvar $users : cs.UsersSelection\nvar $user : cs.UsersEntity\n    \n$users:=ds.Users.query("name = :1"; $credentials.name)\n$user:=$users.first()\n\nIf ($user#Null) //the user is known\n    If (Verify password hash($credentials.password; $user.password))\n        Session.setPrivileges("vip")\n    Else \n\n        return "Wrong password"\n    End if \nElse \n        return "Wrong user"\nEnd if \n')),(0,a.kt)("p",null,"To call the ",(0,a.kt)("inlineCode",{parentName:"p"},"authentify()")," function:"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"POST")," ",(0,a.kt)("inlineCode",{parentName:"p"},"127.0.0.1:8111/rest/$catalog/authentify")),(0,a.kt)("p",null,"\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30dc\u30c7\u30a3:"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-json"}),'[{"name":"Henry",\n"password":"123"}]\n')),(0,a.kt)("h2",s({},{id:"using-on-rest-authentication"}),"Using ",(0,a.kt)("inlineCode",{parentName:"h2"},"On REST Authentication")),(0,a.kt)("p",null,'In default login mode (i.e. the "force login" mode is disabled), you can log in a user to your application by calling ',(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/REST/directory#directorylogin"}),(0,a.kt)("inlineCode",{parentName:"a"},"$directory/login"))," in a POST request including the user's name and password in the header. This request calls the ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method (if it exists), where you can check the user's credentials (see example below)."),(0,a.kt)("p",null,"If the ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method has not been defined, a ",(0,a.kt)("inlineCode",{parentName:"p"},"guest")," session is opened."),(0,a.kt)("h3",s({},{id:"\u4f8b\u984c-1"}),"\u4f8b\u984c"),(0,a.kt)("p",null,"In this example, the user enters their email and password in an html page that requests ",(0,a.kt)("a",s({parentName:"p"},{href:"/docs/ja/REST/directory#directorylogin"}),(0,a.kt)("inlineCode",{parentName:"a"},"$directory/login"))," in a POST (it is recommended to use an HTTPS connection to send the html page). The ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method is called to validate the credentials and to set the session."),(0,a.kt)("p",null,"html\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt-text",src:n(867663).Z,width:"268",height:"85"})),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-html"}),'<html><body bgcolor="#ffffff">\n\n<div id="demo">\n    <FORM name="myForm">\nEmail: <INPUT TYPE=TEXT NAME=userId VALUE=""><br/>\nPassword: <INPUT TYPE=TEXT NAME=password VALUE=""><br/>\n<button type="button" onclick="onClick()">\nLogin\n</button>\n<div id="authenticationFailed" style="visibility:hidden;">Authentication failed</div>\n</FORM>\n</div>\n\n<script>\nfunction sendData(data) {\n  var XHR = new XMLHttpRequest();\n  \n  XHR.onreadystatechange = function() {\n    if (this.status == 200) {      \n      window.location = "authenticationOK.shtml"; \n      }\n      else {\n      document.getElementById("authenticationFailed").style.visibility = "visible";\n      }\n  };\n  \n  XHR.open(\'POST\', \'http://127.0.0.1:8044/rest/$directory/login\'); //rest server address\n  \n  XHR.setRequestHeader(\'username-4D\', data.userId);\n  XHR.setRequestHeader(\'password-4D\', data.password);\n  XHR.setRequestHeader(\'session-4D-length\', data.timeout);\n  \n  XHR.send();\n};\nfunction onClick()\n{\nsendData({userId:document.forms[\'myForm\'].elements[\'userId\'].value , password:document.forms[\'myForm\'].elements[\'password\'].value , timeout:120})\n}\n<\/script></body></html>\n\n')),(0,a.kt)("p",null,"When the login page is sent to the server, the ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method is called:"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-4d"}),'    //On REST Authentication\n\n#DECLARE($userId : Text; $password : Text) -> $Accepted : Boolean\nvar $sales : cs.SalesPersonsEntity\n\n$Accepted:=False\n\n    //A \'/rest\' URL has been called with headers username-4D and password-4D\nIf ($userId#"")\n    $sales:=ds.SalesPersons.query("email = :1"; $userId).first()\n    If ($sales#Null)\n        If (Verify password hash($password; $sales.password))\n            fillSession($sales)\n            $Accepted:=True\n        End if \n    End if \nEnd if \n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"As soon as it has been called and returned ",(0,a.kt)("inlineCode",{parentName:"p"},"True"),", the ",(0,a.kt)("inlineCode",{parentName:"p"},"On REST Authentication")," database method is no longer called in the session.")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"fillSession")," project method initializes the user session, for example:"),(0,a.kt)("pre",null,(0,a.kt)("code",s({parentName:"pre"},{className:"language-4d"}),'#DECLARE($sales : cs.SalesPersonsEntity)\nvar $info : Object\n\n$info:=New object()\n$info.userName:=$sales.firstname+" "+$sales.lastname\n\nSession.setPrivileges($info)\n\nUse (Session.storage)\n    If (Session.storage.myTop3=Null)\n        Session.storage.myTop3:=$sales.customers.orderBy("totalPurchase desc").slice(0; 3)\n    End if \nEnd use\n')))}p.isMDXComponent=!0},995656:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/force-login-1-f9e377d9d1294c166d2e316a30d4eef4.jpeg"},113820:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/force-login-2-1930148cafd4aa463ed094161b992f72.jpeg"},867663:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,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"}}]);