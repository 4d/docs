<!doctype html><html lang=ja dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-21 docs-doc-page docs-doc-id-API/IMAPTransporterClass" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>IMAPTransporter | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/ja/API/IMAPTransporterClass><meta data-rh=true property=og:locale content=ja><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=pt><meta data-rh=true name=docusaurus_locale content=ja><meta data-rh=true name=docsearch:language content=ja><meta data-rh=true name=docusaurus_version content=21><meta data-rh=true name=docusaurus_tag content=docs-default-21><meta data-rh=true name=docsearch:version content=21><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-21><meta data-rh=true property=og:title content="IMAPTransporter | 4D Docs"><meta data-rh=true name=description content="IMAPTransporter クラスを使って、IMAP メールサーバーからメッセージを取得することができます。"><meta data-rh=true property=og:description content="IMAPTransporter クラスを使って、IMAP メールサーバーからメッセージを取得することができます。"><link data-rh=true rel=icon href=/docs/ja/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/ja/API/IMAPTransporterClass><link data-rh=true rel=alternate href=https://developer.4d.com/docs/API/IMAPTransporterClass hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/API/IMAPTransporterClass hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/API/IMAPTransporterClass hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/API/IMAPTransporterClass hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/API/IMAPTransporterClass hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/API/IMAPTransporterClass hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://developer.4d.com/docs/ja/category/4d-language","name":"4Dランゲージ","position":1},{"@type":"ListItem","item":"https://developer.4d.com/docs/ja/category/class-API-reference","name":"クラス","position":2},{"@type":"ListItem","item":"https://developer.4d.com/docs/ja/API/IMAPTransporterClass","name":"IMAPTransporter","position":3}]}</script><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/ja/opensearch.xml><script src=https://kit.fontawesome.com/daeacc3fc4.js crossorigin=anonymous></script><link rel=stylesheet href=/docs/ja/assets/css/styles.ae3169d2.css><script src=/docs/ja/assets/js/runtime~main.b698ae79.js defer></script><script src=/docs/ja/assets/js/main.e863382f.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/docs/ja/img/logohome.png><div role=region aria-label=メインコンテンツまでスキップ><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>メインコンテンツまでスキップ</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=ナビゲーションバーの切り替え aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/ja/><div class=navbar__logo><img src=/docs/ja/img/logohome.png alt="4D ロゴ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/ja/img/logohome.png alt="4D ロゴ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">4D ドキュメンテーション</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/ja/API/IMAPTransporterClass>21 BETA</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/ja/API/IMAPTransporterClass>21 BETA</a><li><a class=dropdown__link href=/docs/ja/20-R10/API/IMAPTransporterClass>20 R10</a><li><a class=dropdown__link href=/docs/ja/20/API/IMAPTransporterClass>20</a><li><a class=dropdown__link href=/docs/ja/19/API/IMAPTransporterClass>19</a><li><a class=dropdown__link href=/docs/ja/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>日本語</a><ul class=dropdown__menu><li><a href=/docs/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/docs/fr/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/docs/es/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/docs/ja/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ja>日本語</a><li><a href=/docs/pt/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="ダークモードとライトモードを切り替える (現在は system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="検索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>検索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=トップに戻る class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/ja/><img src=/docs/ja/img/logohome.png alt="4D ロゴ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/ja/img/logohome.png alt="4D ロゴ" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>4D ドキュメンテーション</b></a><nav aria-label=Docsサイドバー class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/getting-started>はじめに</a><button aria-label="サイドバーのカテゴリ 'はじめに ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/project-ide>Project & IDE</a><button aria-label="サイドバーのカテゴリ 'Project & IDE ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/ja/category/4d-language>4Dランゲージ</a><button aria-label="サイドバーのカテゴリ '4Dランゲージ ' を閉じる" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/ja/Concepts/about>コンセプト</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/commands/command-index>Commands by name</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/ja/commands/theme/4D-Environment>Commands by theme</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/ja/category/class-API-reference>クラス</a><button aria-label="サイドバーのカテゴリ 'クラス ' を閉じる" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/BlobClass>BLOB</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/ClassClass>Class</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/CollectionClass>Collection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/CryptoKeyClass>CryptoKey</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/DataClassClass>DataClass</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/DataStoreClass>DataStore</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/EmailObjectClass>Email</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/EntityClass>Entity</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/EntitySelectionClass>EntitySelection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/FileClass>File</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/FileHandleClass>FileHandle</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/FolderClass>Folder</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/FunctionClass>Function</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/HTTPAgentClass>HTTPAgent</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/HTTPRequestClass>HTTPRequest</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/ja/API/IMAPTransporterClass>IMAPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/IncomingMessageClass>IncomingMessage</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/MailAttachmentClass>MailAttachment</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/OutgoingMessageClass>OutgoingMessage</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/POP3TransporterClass>POP3Transporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/SessionClass>Session</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/SignalClass>Signal</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/SMTPTransporterClass>SMTPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/SystemWorkerClass>SystemWorker</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/TCPConnectionClass>TCPConnection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/TCPEventClass>TCPEvent</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/TCPListenerClass>TCPListener</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/UDPEventClass>UDPEvent</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/UDPSocketClass>UDPSocket</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/VectorClass>Vector</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebFormClass>WebForm</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebFormItemClass>WebFormItem</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebServerClass>WebServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebSocketClass>WebSocket</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebSocketConnectionClass>WebSocketConnection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/WebSocketServerClass>WebSocketServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/ZipArchiveClass>ZIPArchive</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/ZipFileClass>ZIPFile</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/ja/API/ZipFolderClass>ZIPFolder</a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/core>コア開発</a><button aria-label="サイドバーのカテゴリ 'コア開発 ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/web-applications>Web アプリ</a><button aria-label="サイドバーのカテゴリ 'Web アプリ ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/desktop-applications>デスクトップアプリ</a><button aria-label="サイドバーのカテゴリ 'デスクトップアプリ ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/administration>管理</a><button aria-label="サイドバーのカテゴリ '管理 ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/ja/category/extensions>拡張機能</a><button aria-label="サイドバーのカテゴリ '拡張機能 ' を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav><button type=button title=サイドバーを隠す aria-label=サイドバーを隠す class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=パンくずリスト><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=ホームページ class=breadcrumbs__link href=/docs/ja/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/docs/ja/category/4d-language><span>4Dランゲージ</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/docs/ja/category/class-API-reference><span>クラス</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>IMAPTransporter</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">バージョン: 21 BETA</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">このページ上で</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p><code>IMAPTransporter</code> クラスを使って、IMAP メールサーバーからメッセージを取得することができます。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=imap-transporter-オブジェクト>IMAP Transporter オブジェクト<a href=#imap-transporter-オブジェクト class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h3>
<p>IMAP Transporter オブジェクトは <a href=/docs/ja/commands/imap-new-transporter>IMP New transporter</a> コマンドによってインスタンス化されます。 これらは、次のプロパティや関数を持ちます:</p>


































































































<table><thead><tr><th><tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a><br>暗号化されていない接続の確立が許可されてれば <strong>true</strong><tr><td><a href=#addflags><strong>.addFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</a><br><code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを追加します<tr><td><a href=#append><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><br><code>destinationBox</code> に指定したメールボックスに、<code>mailObj</code> のメールを追加します<tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a><br>メールサーバーのセッションを開くのに使用される認証モード<tr><td><a href=#checkconnection><strong>.checkConnection()</strong> : Object</a><br><code>transporter</code> オブジェクトが保存する情報を使用して接続をチェックします<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a><br>サーバー接続をチェックするまでの最長時間 (秒単位)<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a><br>サーバー接続の確立までに待機する最長時間 (秒単位)<tr><td><a href=#copy><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br><em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へとコピーします<tr><td><a href=#createbox><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><br><code>name</code> に指定した名称の新規メールボックスを作成します<tr><td><a href=#delete><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><br><code>msgsIDs</code> または <code>allMsgs</code> が指定するメッセージに対して "削除済み" フラグを設定します<tr><td><a href=#deletebox><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><br><code>name</code> に指定した名称のメールボックスを IMAPサーバーから完全に削除します<tr><td><a href=#expunge><strong>.expunge()</strong> : Object</a><br>IMAPメールサーバーから "deleted "フラグのついたメッセー ジをすべて削除します。<tr><td><a href=#getboxinfo><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><br>カレントメールボックス、または <em>name</em> が指定するメールボックスに対応する <code>boxInfo</code> オブジェクトを返します<tr><td><a href=#getboxlist><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><br>利用可能なメールボックスの情報を mailbox オブジェクトのコレクションとしてを返します<tr><td><a href=#getdelimiter><strong>.getDelimiter()</strong> : Text</a><br>メールボックス名で階層レベルを区切るのに使用される文字を返します<tr><td><a href=#getmail><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><br><code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメールを <code>Email</code> オブジェクトとして返します<tr><td><a href=#getmails><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><br><code>Email</code> オブジェクトのコレクションを格納したオブジェクトを返します<tr><td><a href=#getmimeasblob><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><br><code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメッセージの MIMEコンテンツを格納した BLOB を返します<tr><td><a href=#host><strong>.host</strong> : Text</a><br>ホストサーバーの名前または IPアドレス<tr><td><a href=#logfile><strong>.logFile</strong> : Text</a><br>メール接続に対して定義された拡張ログファイル (あれば) へのフルパス<tr><td><a href=#move><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br><em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へと移動します<tr><td><a href=#numtoid><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><br><em>startMsg</em> および <em>endMsg</em> で指定された連続した範囲のメッセージのシーケンス番号を IMAP固有IDへと変換します<tr><td><a href=#removeflags><strong>.removeFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</a><br><code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを削除します<tr><td><a href=#renamebox><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><br>IMAPサーバー上でメールボックスの名称を変更します<tr><td><a href=#port><strong>.port</strong> : Integer</a><br>メール通信に使用されるポート番号<tr><td><a href=#searchmails><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><br>カレントメールボックスにおいて <em>searchCriteria</em> の検索条件に合致するメッセージを検索します<tr><td><a href=#selectbox><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><br><em>name</em> に指定したメールボックスをカレントメールボックスとして選択します<tr><td><a href=#subscribe><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><br>IMAPサーバーの購読メールボックスとして任意のメールボックスを追加します<tr><td><a href=#unsubscribe><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><br>指定したメールボックスを購読メールボックスから削除します<tr><td><a href=#user><strong>.user</strong> : Text</a><br>メールサーバーでの認証に使用されたユーザー名</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4dimaptransporternew>4D.IMAPTransporter.new()<a href=#4dimaptransporternew class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>メールサーバー情報<tr><td>戻り値<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#imap-transporter-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88>IMAP transporter オブジェクト</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明>説明<a href=#説明 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>4D.IMAPTransporter.new()</code> 関数は、新規の <code>4D.IMAPTransporter</code>型オブジェクトを作成して返します。 この関数の機能は、<a href=/docs/ja/commands/imap-new-transporter><code>IMAP New transporter</code></a> コマンドと同一です。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=acceptunsecureconnection>.acceptUnsecureConnection<a href=#acceptunsecureconnection class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R4<td>追加</table>
</div></div></details>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-1>説明<a href=#説明-1 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.acceptUnsecureConnection</code> プロパティは、暗号化された接続が不可能な場合に、 暗号化されていない接続の確立が許可されてれば <strong>true</strong> を格納します。</p>
<p>暗号化されていない接続が許可されていない場合には <strong>false</strong> が格納されており、その場合に暗号化された接続が不可能な場合にはエラーが返されます。</p>
<p>使用可能なセキュアなポートは次のとおりです:</p>
<ul>
<li>
<p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 または 25: STARTTLS アップグレードがされた SMTP (サーバーがサポートしていれば)</li>
</ul>
</li>
<li>
<p>IMAP</p>
<ul>
<li>143: IMAP 非暗号化ポート</li>
<li>993: STARTTLS アップグレードがされた IMAP (サーバーがサポートしていれば)</li>
</ul>
</li>
<li>
<p>POP3</p>
<ul>
<li>110: POP3 非暗号化ポート</li>
<li>995: STARTTLS アップグレードがされた POP3 (サーバーがサポートしていれば)</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=addflags>.addFlags()<a href=#addflags class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>リリース<th>内容<tbody><tr><td>20<td>カスタムキーワードをサポート<tr><td>18 R6<td>追加</table>
</div></div></details>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgIDs<td>any<td style=text-align:center>-><td>文字列のコレクション: メッセージの固有ID (テキスト型)<br>
テキスト: メッセージの固有ID<br>
倍長整数 (IMAP all): 選択されたメールボックス内の全メッセージ<tr><td>keywords<td>Object<td style=text-align:center>-><td>追加するキーワードフラグ<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>addFlags処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-2>説明<a href=#説明-2 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.addFlags()</code> 関数は、
<code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを追加します。</p>
<p><code>msgIDs</code> には、以下のいずれかを渡すことができます:</p>
<ul>
<li>指定するメッセージの固有ID を格納した <em>コレクション</em></li>
<li>単一のメッセージの固有ID (<em>テキスト</em>)</li>
<li>以下の定数 (<em>longint</em>) を使用することで、選択されているメールボックスの全メッセージを指定することができます:</li>
</ul>















<table><thead><tr><th>定数<th>値<th>説明<tbody><tr><td>IMAP all<td>1<td>選択されたメールボックスの全メッセージを選択します</table>
<p><code>keywords</code> を使って、<code>msgIDs</code> 引数で指定したメッセージに対して追加するフラグを定義します。 以下の標準フラグおよびカスタムフラグを使用することができます (カスタムフラグのサポートはサーバーの実装に依存します)。</p>








































<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>$draft<td>Boolean<td>メッセージに "draft" フラグを追加するには true<tr><td>$seen<td>Boolean<td>メッセージに "seen" フラグを追加するには true<tr><td>$flagged<td>Boolean<td>メッセージに "flagged" フラグを追加するには true<tr><td>$answered<td>Boolean<td>メッセージに "answered" フラグを追加するには true<tr><td>$deleted<td>Boolean<td>メッセージに "deleted" フラグを追加するには true<tr><td><code>&lt;custom flag></code><td>Boolean<td>メッセージにカスタムフラグを追加するには true</table>
<p>カスタムフラグ名は、次の規則に従う必要があります: キーワードは、制御文字とスペースを含まない、文字の大小を区別する文字列であり、次の文字は使用できません: <code>( ) { ] % * " \</code></p>
<blockquote>
<ul>
<li>キーワードが考慮されるためには、その値が true でなければなりません。</li>
<li>キーワードフラグの解釈は、メールクライアントごとに異なる可能性があります。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題>例題<a href=#例題 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// transporter を作成します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// INBOXの全メッセージを既読に設定します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=append>.append()<a href=#append class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R6<td>追加</table>
</div></div></details>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>



































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>mailObj<td>Object<td style=text-align:center>-><td>Email オブジェクト<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Emailオブジェクトを受信するメールボックス<tr><td>options<td>Object<td style=text-align:center>-><td>文字セット情報を格納したオブジェクト<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>append処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-3>説明<a href=#説明-3 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.append()</code> 関数は、<code>destinationBox</code> に指定したメールボックスに、<code>mailObj</code> のメールを追加します。</p>
<p><code>mailObj</code> には、Email オブジェクトを渡します。 メールプロパティに関する包括的な詳細については、<a href=/docs/ja/API/EmailObjectClass#email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88>Email オブジェクト</a> を参照ください。 <code>.append()</code> 関数は Email オブジェクトの <code>keywords</code> 属性内のキーワードタグをサポートします。</p>
<p>任意の <code>destinationBox</code> には、<code>mailObj</code> が追加されるメールボックスの名前を指定することができます。 省略した場合は、カレントメールボックスが使用されます。</p>
<p>任意の <code>options</code> には、メールの特定部分の文字セットやエンコーディングを定義するオブジェクトを渡すことができます。 次のプロパティを含みます:</p>




















<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>headerCharset<td>Text<td>メールの以下の部分で使用される文字セットとエンコーディング: 件名、添付ファイル名、メール名の属性。 取り得る値: 以下の可能な文字セットテーブルを参照ください。<tr><td>bodyCharset<td>Text<td>メールの HTML およびテキスト本文コンテンツで使用される文字セットとエンコーディング。 取り得る値: 以下の可能な文字セットテーブルを参照ください。</table>
<p>使用可能な文字セット:</p>






























<table><thead><tr><th>定数<th>値<th>説明<tbody><tr><td>mail mode ISO2022JP<td>US-ASCII_ISO-2022-JP_UTF8_QP<td><ul><li>headerCharset: 可能なら US-ASCII、次に可能なら Japanese (ISO-2022-JP) & Quoted-printable、それも不可なら UTF-8 & Quoted-printable<li>bodyCharset: 可能なら US-ASCII、次に可能なら Japanese (ISO-2022-JP) & 7-bit、それも不可なら UTF-8 & Quoted-printable</ul><tr><td>mail mode ISO88591<td>ISO-8859-1<td><ul><li>headerCharset: ISO-8859-1 & Quoted-printable<li>bodyCharset: ISO-8859-1 & 8-bit</ul><tr><td>mail mode UTF8<td>US-ASCII_UTF8_QP<td>headerCharset & bodyCharset: 可能なら US-ASCII、それが不可なら UTF-8 & Quoted-printable (<strong>デフォルト値</strong>)<tr><td>mail mode UTF8 in base64<td>US-ASCII_UTF8_B64<td>headerCharset & bodyCharset: 可能な場合は US-ASCII、それ以外は UTF-8 & base64</table>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-1>例題<a href=#例題-1 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>Drafts メールボックスにメールを保存します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$settings:=New object("host"; "domain.com"; "user"; "xxxx"; "password"; "xxxx"; "port"; 993)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.from:="xxxx@domain.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.subject:="Lorem Ipsum"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.textBody:="Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$seen"]:=True // メッセージに既読フラグをつけます</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$draft"]:=True // メッセージに下書きフラグをつけます</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$imap.append($msg; "Drafts")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=authenticationmode>.authenticationMode<a href=#authenticationmode class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R4<td>追加</table>
</div></div></details>
<p><strong>.authenticationMode</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-4>説明<a href=#説明-4 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.authenticationMode</code> プロパティは、 メールサーバーのセッションを開くのに使用される認証モードを格納します。</p>
<p>デフォルトでは、サーバーによってサポートされている最も安全なモードが使用されます。</p>
<p>とりうる値:</p>






























<table><thead><tr><th>値<th>定数<th>説明<tbody><tr><td>CRAM-MD5<td><code>IMAP authentication CRAM MD5</code><td>CRAM-MD5 プロトコルを使用した認証<tr><td>LOGIN<td><code>IMAP authentication login</code><td>LOGIN プロトコルを使用した認証<tr><td>OAUTH2<td><code>IMAP authentication OAUTH2</code><td>OAuth2 プロトコルを使用した認証<tr><td>PLAIN<td><code>IMAP authentication plain</code><td>PLAIN プロトコルを使用した認証</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnection>.checkConnection()<a href=#checkconnection class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R4<td>追加</table>
</div></div></details>
<p><strong>.checkConnection()</strong> : Object</p>

















<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>transporter オブジェクト接続のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-5>説明<a href=#説明-5 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.checkConnection()</code> 関数は、<code>transporter</code> オブジェクトが保存する情報を使用して接続をチェックします。必要なら再接続をし、そのステータスを返します。 この関数を使用して、ユーザーから提供された値が有効かどうかを検証することができます。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=返されるオブジェクト>返されるオブジェクト<a href=#返されるオブジェクト class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>この関数はメールサーバーにリクエストを送信し、メールステータスを表すオブジェクトを返します。 このオブジェクトには、次のプロパティが格納されることがあります:</p>





















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>boolean<td>チェックが成功した場合には true、それ以外は false<tr><td>status<td><td>number<td>(SMTPのみ) メールサーバーから返されたコード (メール処理に関係ない問題の場合には 0)<tr><td>statusText<td><td>text<td>メールサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>collection<td>4Dエラースタック (メールサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[ ].errCode<td>number<td>4Dエラーコード<tr><td><td>[ ].message<td>text<td>4Dエラーの詳細<tr><td><td>[ ].componentSignature<td>text<td>エラーを返した内部コンポーネントの署名</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnectiondelay>.checkConnectionDelay<a href=#checkconnectiondelay class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-6>説明<a href=#説明-6 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.checkConnectionDelay</code> 関数は、サーバー接続をチェックするまでの最長時間 (秒単位) を格納します。  関数呼び出しの間隔がこの時間を超過する場合、サーバー接続が確認されます。 プロパティが <em>server</em> オブジェクトによって設定されていない場合は、デフォルトで 300 という値が使用されます。</p>
<blockquote>
<p><strong>警告</strong>: 定義されたタイムアウトが、サーバータイムアウトより短いようにしてください。そうでない場合、クライアントタイムアウトは無意味になります。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=connectiontimeout>.connectionTimeOut<a href=#connectiontimeout class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R5<td>追加</table>
</div></div></details>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-7>説明<a href=#説明-7 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.connectionTimeOut</code> プロパティは、サーバー接続の確立までに待機する最長時間 (秒単位)を格納します。 <code>SMTP New transporter</code> や <code>POP3 New transporter</code>、 <code>IMAP New transporter</code> のコマンドで <code>transporter</code> オブジェクトを作成する際に使用される <code>server</code> オブジェクトにおいて、 このプロパティが指定されなかった場合のデフォルトは 30 です。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=copy>.copy()<a href=#copy class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>メッセージの固有ID のコレクション (テキスト)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>メッセージのコピー先のメールボックス<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>copy処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-8>説明<a href=#説明-8 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.copy()</code> 関数は、<em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へとコピーします。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><em>msgsIDs</em> には、コピーするメッセージの固有ID を格納したコレクション</li>
<li><em>allMsgs</em> には、選択されているメールボックスの全メッセージをコピーするための定数 (倍長整数型):</li>
</ul>
<p><em>destinationBox</em> には、メッセージのコピー先メールボックスの名称をテキスト値で渡すことができます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-1-1>例題 1<a href=#例題-1-1 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>選択されたメッセージをコピーします:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //  メッセージの固有ID のコレクションを取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 見つかったメッセージを "documents" メールボックスへコピーします</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy($mailIds;"documents")</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-2>例題 2<a href=#例題-2 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>カレントメールボックスの全メッセージをコピーします:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 全メッセージを "documents" メールボックスへコピーします</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy(IMAP all;"documents")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=createbox>.createBox()<a href=#createbox class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>19<td>追加</table>
</div></div></details>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>新規メールボックスの名称<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>createBox処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-9>説明<a href=#説明-9 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.createBox()</code> 関数は、<code>name</code> に指定した名称の新規メールボックスを作成します。 IMAPサーバーの階層区切り文字がメールボックス名内に含まれる場合、IMAPサーバーは指定のメールボックスを作成するのに必要な親階層を作成します。</p>
<p>たとえば、"/" が階層区切り文字として使われるサーバーにおいて、"Projects/IMAP/Doc" を作成しようとした場合:</p>
<ul>
<li>"Projects" & "IMAP" がすでに存在する場合は "Doc" メールボックスのみを作成します。</li>
<li>“Projects” のみが存在する場合は、"IMAP" & "Doc" メールボックスを作成します。</li>
<li>いずれも存在しない場合には、"Projects" & "IMAP" & "Doc" メールボックスをそれぞれ作成します。</li>
</ul>
<p><code>name</code> には、新しいメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-3>例題<a href=#例題-3 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>新しい “Invoices” メールボックスを作成します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("パスワードを入力してください:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.createBox("Invoices")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("メールボックスが作成できました。")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("エラー: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=delete>.delete()<a href=#delete class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>メッセージの固有ID のコレクション (テキスト)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>delete処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-10>説明<a href=#説明-10 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.delete()</code> 関数は、
<code>msgsIDs</code> または <code>allMsgs</code> が指定するメッセージに対して "削除済み" フラグを設定します。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><code>msgsIDs</code> には、削除するメッセージの固有ID を格納したコレクション</li>
<li><code>allMsgs</code> には、選択されているメールボックスの全メッセージを削除するための定数 (倍長整数型):</li>
</ul>
<p>この関数を実行しても、メールが実際に削除される訳ではありません。 "削除済み" フラグがつけられたメッセージも引き続き <a href=#searchmails>.searchMails()</a> 関数によって検索可能です。 フラグがつけられたメッセージは、<a href=#expunge><code>.expunge()</code></a> を実行したときか、別のメールボックスを選択したとき、あるいは(<a href=/docs/ja/commands/imap-new-transporter>IMAP New transporter</a> で作成された) <a href=#imap-transporter-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88>transporter オブジェクト</a> が消去されたときにのみ、IMAPサーバーから削除されます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-1-2>例題 1<a href=#例題-1-2 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>選択されたメッセージを削除します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メッセージの固有ID のコレクションを取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"Reports\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 選択されたメッセージを削除します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-2-1>例題 2<a href=#例題-2-1 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>カレントメールボックスの全メッセージを削除します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Junk Email")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // カレントメールボックスの全メッセージを削除します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete(IMAP all)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=deletebox>.deleteBox()<a href=#deletebox class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>19<td>追加</table>
</div></div></details>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>削除するメールボックスの名称<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>deleteBox処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-11>説明<a href=#説明-11 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.deleteBox()</code> 関数は、
<code>name</code> に指定した名称のメールボックスを IMAPサーバーから完全に削除します。 存在しないメールボックス、または INBOX を削除しようとして場合には、エラーが生成されます。</p>
<p><code>name</code> には、削除するメールボックスの名前を渡します。</p>
<blockquote>
<ul>
<li>子メールボックスを持つ親メールボックスが "\Noselect" 属性を持っている場合、そのメールボックスは削除できません。</li>
<li>削除されるメールボックス内のメッセージもすべて削除されます。</li>
<li>メールボックス削除の可否はメールサーバーに依存します。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-4>例題<a href=#例題-4 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>"Bills" メールボックスの階層から、"Nova Orion Industries" の子メールボックスを削除します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("パスワードを入力してください:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// delete mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Nova Orion Industries"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("メールボックスが削除されました。")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("エラー: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=expunge>.expunge()<a href=#expunge class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R6<td>追加</table>
</div></div></details>
<p><strong>.expunge()</strong> : Object</p>

















<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>expunge処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-12>説明<a href=#説明-12 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.expunge()</code> 関数は IMAPメールサーバーから "deleted "フラグのついたメッセー ジをすべて削除します。 "deleted" フラグは<a href=#delete><code>.delete()</code></a> または <a href=#addflags><code>.addFlags()</code></a> 関数によって設定可能です。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-5>例題<a href=#例題-5 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $ids : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// transporter を作成します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// INBOX の既読メッセージに削除フラグを立てます</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ids:=$transporter.searchMails("SEEN")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// "deleted" フラグがついたメッセージをすべて消去します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxinfo>.getBoxInfo()<a href=#getboxinfo class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>





















<table><thead><tr><th>リリース<th>内容<tbody><tr><td>20<td><em>id</em> が返されます<tr><td>18 R5<td><em>name</em> は任意です<tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>メールボックスの名称<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>boxInfo オブジェクト</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-13>説明<a href=#説明-13 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getBoxInfo()</code> 関数は、カレントメールボックス、または <em>name</em> が指定するメールボックスに対応する <code>boxInfo</code> オブジェクトを返します。 この関数は、<a href=#selectbox><code>.selectBox()</code></a> と同じ情報を返しますが、カレントメールボックスは変えません。</p>
<p>任意の <em>name</em> パラメーターには、アクセスするメールボックスの名称を渡します。 この名称は明確な左から右への階層を表し、特定の区切り文字でレベルを区分けします。 この区切り文字は <a href=#getdelimiter><code>.getDelimiter()</code></a> 関数で調べることができます。</p>
<p><em>name</em> のメールボックスが選択不可の場合、または見つからない場合には、関数はエラーを生成し、<strong>null</strong> を返します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>返される <code>boxInfo</code> オブジェクトには、以下のプロパティが格納されています:</p>



































<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>name<td>Text<td>メールボックスの名称<tr><td>mailCount<td>Number<td>メールボックス内のメッセージの数<tr><td>mailRecent<td>Number<td>(新しいメッセージであることを表す) "recent" フラグがついたメッセージの数<tr><td>id<td>text<td>メールボックスの固有ID<tr><td>mailUnseen<td>Number<td>"unseen" フラグがついたメッセージの数</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-6>例題<a href=#例題-6 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $info:=$transporter.getBoxInfo("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("INBOX には "+String($info.mailRecent)+" 件の最近のメールがあります。")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxlist>.getBoxList()<a href=#getboxlist class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R4<td>追加<tr><td>19<td><code>isSubscribed</code> を追加</table>
</div></div></details>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>parameters<td>Object<td style=text-align:center>-><td>引数のオブジェクト<tr><td>戻り値<td>Collection<td style=text-align:center>&lt;-<td>mailbox オブジェクトのコレクション</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-14>説明<a href=#説明-14 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getBoxList()</code> 関数は、利用可能なメールボックスの情報を mailbox オブジェクトのコレクションとしてを返します。 この関数を使用すると、IMAPメールサーバー上にあるメッセージの一覧をローカルで管理することができるようになります。</p>
<p>任意の <code>parameters</code> パラメーターには、返されるメールボックスをフィルターするための値を格納したオブジェクトを渡すことができます。 以下のものを渡すことができます:</p>






























<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>isSubscribed<td>Boolean<td><li><strong>True</strong>: 購読しているメールボックスのみを返します。</li><li><strong>False</strong>: すべての利用可能なメールボックスを返します。</li><tr><td>names<td>Collection<td>"name" 属性を含むオブジェクトのコレクション、またはボックス名を含むテキストのコレクション<tr><td>withBoxProperties<td>Boolean<td>true の場合 (デフォルト): 結果のオブジェクトに <code>selectable</code>、<code>inferior</code>、<code>interesting</code> 属性を追加します。 false の場合、これらの属性は省略されます。<tr><td>withBoxInfo<td>Boolean<td>デフォルト値は false です。 true の場合、結果のオブジェクトに <code>mailCount</code>、<code>mailRecent</code>、および <code>id</code> 属性を追加します。</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値>戻り値<a href=#戻り値 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>返されるコレクションの各オブジェクトには、以下のプロパティが格納されています:</p>


















































<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>[].name<td>Text<td>メールボックスの名称。 withBoxProperties=true または withBoxInfo=true の場合に返されます<tr><td>[].selectable<td>Boolean<td>アクセス権でメールボックスを選択できるかどうかを表します:<ul><li>true - メールボックスは選択可能<li>false - メールボックスは選択不可能</ul>withBoxProperties=true の場合に返されます<tr><td>[].inferior<td>Boolean<td>アクセス権でメールボックス内に下の階層レベルを作成できるかどうかを表します:<ul><li>true - 下の階層レベルは作成可能<li>false - 下の階層レベルは作成不可能</ul>withBoxProperties=true の場合に返されます<tr><td>[].interesting<td>Boolean<td>サーバーがメールボックスに “interesting” のマーク付けをしているかどうかを表します:<ul><li>true - メールボックスはサーバーから "interesting" のマーク付けをされています。 例えば、メールボックスには新着メッセージが入っている場合が考えられます。<li>false - メールボックスはサーバーから "interesting" のマーク付けをされていません。</ul>	withBoxProperties=true の場合に返されます<tr><td>[].mailCount<td>Number<td>受信ボックス内のメッセージの数。 withBoxInfo=true の場合に返されます<tr><td>[].mailRecent<td>Number<td>(新しいメッセージであることを表す) "recent" フラグがついたメッセージの数。 withBoxInfo=true の場合に返されます<tr><td>[].mailUnseen<td>Number<td>"unseen" フラグがついたメッセージの数。 withBoxInfo=true の場合に返されます<tr><td>[].id<td>Text<td>一意のメールボックス識別子。 withBoxInfo=true の場合に返されます</table>
<p>アカウントにメールボックスが一つもない場合、空のコレクションが返されます。</p>
<blockquote>
<ul>
<li>開いている接続がない場合、<code>.getBoxList()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<code>IMAP New transporter</code> 参照) 以上に使用されなかった場合には、<code>.checkConnection( )</code> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-7>例題<a href=#例題-7 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("新規メールが届いています: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getdelimiter>.getDelimiter()<a href=#getdelimiter class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.getDelimiter()</strong> : Text</p>

















<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>戻り値<td>Text<td style=text-align:center>&lt;-<td>階層区切り文字</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-15>説明<a href=#説明-15 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getDelimiter()</code> 関数は、メールボックス名で階層レベルを区切るのに使用される文字を返します。</p>
<p>この区切り文字は以下のように使用することができます:</p>
<ul>
<li>下層レベルのメールボックスを作成する</li>
<li>メールボックスの階層内での上層・下層レベルを検索する</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値-1>戻り値<a href=#戻り値-1 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>メールボックス名の区切り文字</p>
<blockquote>
<ul>
<li>開いている接続がない場合、<code>.getDelimiter()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<a href=#checkconnectiondelay>IMAP New transporter</a> 参照) 以上に使用されなかった場合には、<a href=#checkconnection><code>.checkConnection()</code></a> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-8>例題<a href=#例題-8 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("新規メールが届いています: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmail>.getMail()<a href=#getmail class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>



































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>メッセージのシーケンス番号<tr><td>msgID<td>Text<td style=text-align:center>-><td>メッセージの固有ID<tr><td>options<td>Object<td style=text-align:center>-><td>メッセージ管理オプション<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td><a href=/docs/ja/API/EmailObjectClass#email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88>Email オブジェクト</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-16>説明<a href=#説明-16 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMail()</code> 関数は、
<code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメールを <code>Email</code> オブジェクトとして返します。 この関すを使用すると、メールのコンテンツをローカルで管理できるようになります。</p>
<p>最初の引数として、次のいずれかを渡すことができます:</p>
<ul>
<li><em>msgNumber</em> に、取得するメッセージのシーケンス番号 (<em>倍長整数</em>) を渡します。</li>
<li><em>msgID</em>に、取得するメッセージの固有ID (<em>テキスト</em>) を渡します。</li>
</ul>
<p>任意の <em>options</em> 引数として、メッセージの扱い方を定義する追加のオブジェクトを渡すことができます。 次のプロパティを利用することができます:</p>




















<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>updateSeen<td>boolean<td>true 時には、メールボックス内でメッセージを "既読" にします。 false 時にはメッセージの状態は変化しません。 デフォルト値: true<tr><td>withBody<td>boolean<td>true を渡すとメッセージ本文を返します。 false 時には、メッセージヘッダーのみが返されます。 デフォルト値: true</table>
<blockquote>
<ul>
<li><em>msgID</em> 引数が存在しないメッセージを指定した場合、関数はエラーを生成し <strong>Null</strong> を返します。</li>
<li><a href=#selectbox><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMail()</code> は <a href=#selectbox><code>.selectBox()</code></a> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値-2>戻り値<a href=#戻り値-2 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMail()</code> は、以下の IMAP特有のプロパティを持つ <a href=/docs/ja/API/EmailObjectClass#email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88><code>Email</code> オブジェクト</a>を返します: <em>id</em>、<em>receivedAt</em>、および <em>size</em>。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-9>例題<a href=#例題-9 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>ID = 1のメッセージを取得します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // transporter を作成します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // ID = 1 の Emailオブジェクトを取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmails>.getMails()<a href=#getmails class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>









































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>ids<td>Collection<td style=text-align:center>-><td>メッセージID のコレクション<tr><td>startMsg<td>Integer<td style=text-align:center>-><td>先頭メッセージのシーケンス番号<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>最後のメッセージのシーケンス番号<tr><td>options<td>Object<td style=text-align:center>-><td>メッセージ管理オプション<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>次のコレクションを格納したオブジェクト:<br><ul><li><a href=/docs/ja/API/EmailObjectClass#email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88>Email オブジェクト</a> のコレクション<li>見つからなかったメッセージの ID または番号のコレクション</ul></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-17>説明<a href=#説明-17 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMails()</code> 関数は、<code>Email</code> オブジェクトのコレクションを格納したオブジェクトを返します。</p>
<p><strong>第一シンタックス:</strong></p>
<p><em><strong>.getMails( ids { ; options } ) -> result</strong></em></p>
<p>第一シンタックスを使用すると、メッセージID に基づいてメッセージを取得することができます。</p>
<p><em>ids</em> 引数として、取得するメッセージID のコレクションを渡します。 これらの ID は <a href=#getmail><code>.getMail()</code></a> で取得することができます。</p>
<p>任意の <em>options</em> 引数を渡すと、返されるメッセージのパートを定義することができます。 利用可能なプロパティについては、以下の <strong>オプション</strong> の表を参照ください。</p>
<p><strong>第二シンタックス:</strong></p>
<p><em><strong>.getMails( startMsg ; endMsg { ; options } ) -> result</strong></em></p>
<p>第二シンタックスを使用すると、連続したレンジに基づいてメッセージを取得することができます。 渡される値はメールボックス内でのメッセージの位置を表します。</p>
<p><em>startMsg</em> には、連続したレンジの最初のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最初のメッセージが連続レンジの先頭メッセージとして扱われます。</p>
<p><em>endMsg</em> には、連続レンジに含める最後のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>endMsg</em> &lt;= 0) を渡した場合、メールボックスの最後のメッセージが連続レンジの最終メッセージとして扱われます。</p>
<p>任意の <em>options</em> 引数を渡すと、返されるメッセージのパートを定義することができます。</p>
<p><strong>Options</strong></p>




















<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>updateSeen<td>Boolean<td>true 時には、指定されたメッセージを "既読" にします。 false 時にはメッセージの状態は変化しません。 デフォルト値: true<tr><td>withBody<td>Boolean<td>true を渡すと指定されたメッセージの本文を返します。 false 時には、メッセージヘッダーのみが返されます。 デフォルト値: true</table>
<blockquote>
<ul>
<li><a href=#selectbox><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMails()</code> は <a href=#selectbox><code>.selectBox()</code></a> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値-3>戻り値<a href=#戻り値-3 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMails()</code> は、以下のコレクションを格納したオブジェクトを返します。</p>




















<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>list<td>Collection<td><a href=/docs/ja/API/EmailObjectClass#email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88><code>Email</code></a> オブジェクトのコレクション。 Email オブジェクトが見つからない場合、空のコレクションが返されます。<tr><td>notFound<td>Collection<td>使用したシンタックスによって返されるものが異なります:<br><ul><li>第一シンタックス - 指定した ID のうち、存在しなかったメッセージの ID のコレクション<li>第二シンタックス - startMsg と endMsg の間の番号のうち、存在しなかったメッセージのシーケンス番号のコレクション</ul>すべてのメッセージが見つかった場合には、空のコレクションが返されます。</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-10>例題<a href=#例題-10 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>直近の 20件のメールを、"既読" ステータスを変更せずに取得します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //create transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  If($boxInfo.mailCount>0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // 直近20件のメッセージのヘッダーを、"既読" にせずに取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        New object("withBody";False;"updateSeen";False))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    For each($mail;$result.list)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End for each</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmimeasblob>.getMIMEAsBlob()<a href=#getmimeasblob class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>



































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>メッセージのシーケンス番号<tr><td>msgID<td>Text<td style=text-align:center>-><td>メッセージの固有ID<tr><td>updateSeen<td>Boolean<td style=text-align:center>-><td>true 時には、メールボックス内でメッセージを "既読" にします。 false 時にはメッセージの状態は変化しません。<tr><td>戻り値<td>BLOB<td style=text-align:center>&lt;-<td>メールサーバーから返された MIME文字列の BLOB</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-18>説明<a href=#説明-18 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMIMEAsBlob()</code> 関数は、
<code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメッセージの MIMEコンテンツを格納した BLOB を返します。</p>
<p>最初の引数として、次のいずれかを渡すことができます:</p>
<ul>
<li><em>msgNumber</em> に、取得するメッセージのシーケンス番号 (<em>倍長整数</em>) を渡します。</li>
<li><em>msgID</em>に、取得するメッセージの固有ID (<em>テキスト</em>) を渡します。</li>
</ul>
<p>任意の <em>updateSeen</em> 引数を渡すと、メールボックス内でメッセージが "既読" とマークされるかどうかを指定します。 以下のものを渡すことができます:</p>
<ul>
<li><strong>True</strong> - メッセージは "既読" とマークされます (このメッセージが読まれたことを表します)</li>
<li><strong>False</strong> - メッセージの "既読" ステータスは変化しません。</li>
</ul>
<blockquote>
<ul>
<li><em>msgNumber</em> または <em>msgID</em> 引数が存在しないメッセージを指定した場合、関数は空の BLOB を返します。</li>
<li><a href=#selectbox><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMIMEAsBlob()</code> は <code>.selectBox()</code> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値-4>戻り値<a href=#戻り値-4 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.getMIMEAsBlob()</code> は <code>BLOB</code> を返します。この BLOB はデータベースにアーカイブしたり、<code>MAIL Convert from MIME</code> コマンドを使用して <a href=/docs/ja/API/EmailObjectClass#email-object><code>Email</code> オブジェクト</a> へと変換したりすることができます。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-11>例題<a href=#例題-11 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $blob : Blob</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // transporter を作成します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // BLOB を取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=host>.host<a href=#host class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R5<td>追加</table>
</div></div></details>
<p><strong>.host</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-19>説明<a href=#説明-19 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.host</code> プロパティは、ホストサーバーの名前または IPアドレスを格納します。 この情報はメール通信 (SMTP、POP3、IMAP) に使用されます。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logfile>.logFile<a href=#logfile class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R5<td>追加</table>
</div></div></details>
<p><strong>.logFile</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-20>説明<a href=#説明-20 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.logFile</code> プロパティは、 メール接続に対して定義された拡張ログファイル (あれば) へのフルパスを格納します。 パスは、カレント Logs フォルダーを基準とした相対パス、あるいは絶対パスを指定できます。</p>
<p><code>SET DATABASE PARAMETER</code> コマンドで有効化される通常のログファイルとは異なり、拡張ログファイルはすべての送信されたメールの MIMEコンテンツを保存し、サイズ制限がありません。 拡張ログファイルの詳細については、以下の章をそれぞれ参照ください:</p>
<ul>
<li><strong>SMTP 接続</strong> - <a href=/docs/ja/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DSMTPLog.txt</a></li>
<li><strong>POP3 接続</strong> - <a href=/docs/ja/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DPOP3Log.txt</a></li>
<li><strong>IMAP 接続</strong> - <a href=/docs/ja/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DIMAPLog.txt</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=move>.move()<a href=#move class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>メッセージの固有ID のコレクション (テキスト)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>メッセージの移動先のメールボックス<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>move処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-21>説明<a href=#説明-21 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.move()</code> 関数は、<em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へと移動します。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><em>msgsIDs</em> には、移動するメッセージの固有ID を格納したコレクション</li>
<li><em>allMsgs</em> には、選択されているメールボックスの全メッセージを移動するための定数 (倍長整数型):</li>
</ul>
<p><em>destinationBox</em> には、メッセージの移動先メールボックスの名称をテキスト値で渡すことができます。</p>
<blockquote>
<p>RFC <a href=https://tools.ietf.org/html/rfc8474 target=_blank rel="noopener noreferrer">8474</a> に準拠している IMAPサーバーでのみ、この関数はサポートされます。</p>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-1-3>例題 1<a href=#例題-1-3 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>選択されたメッセージを移動します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メッセージの固有IDのコレクションを取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // カレントメールボックス内で見つかったメッセージを "documents" メールボックスに移動します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move($mailIds;"documents")</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-2-2>例題 2<a href=#例題-2-2 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>カレントメールボックスの全メッセージを移動します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // カレントメールボックスの全メッセージを "documents" メールボックスに移動します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move(IMAP all;"documents")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=numtoid>.numToID()<a href=#numtoid class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>startMsg<td>Integer<td style=text-align:center>-><td>先頭メッセージのシーケンス番号<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>最後のメッセージのシーケンス番号<tr><td>戻り値<td>Collection<td style=text-align:center>&lt;-<td>固有ID のコレクション</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-22>説明<a href=#説明-22 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.numToID()</code> 関数は、現在選択されているメールボックスにおいて、<em>startMsg</em> および <em>endMsg</em> で指定された連続した範囲のメッセージのシーケンス番号を IMAP固有IDへと変換します。</p>
<p><em>startMsg</em> には、連続したレンジの最初のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最初のメッセージが連続レンジの先頭メッセージとして扱われます。</p>
<p><em>endMsg</em> には、連続レンジに含める最後のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>endMsg</em> &lt;= 0) を渡した場合、メールボックスの最後のメッセージが連続レンジの最終メッセージとして扱われます。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=戻り値-5>戻り値<a href=#戻り値-5 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>メソッドは文字列 (固有ID) のコレクションを返します。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-12>例題<a href=#例題-12 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 最も古い 5通のメッセージID を取得します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // カレントメールボックスからメッセージを削除します</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=removeflags>.removeFlags()<a href=#removeflags class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>リリース<th>内容<tbody><tr><td>20<td>カスタムキーワードをサポート<tr><td>18 R6<td>追加</table>
</div></div></details>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>msgIDs<td>any<td style=text-align:center>-><td>文字列のコレクション: メッセージの固有ID (テキスト型)<br>
テキスト: メッセージの固有ID<br>
倍長整数 (IMAP all): 選択されたメールボックス内の全メッセージ<tr><td>keywords<td>Object<td style=text-align:center>-><td>削除するキーワードフラグ<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>removeFlags処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-23>説明<a href=#説明-23 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.removeFlags()</code> 関数は、<code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを削除します。</p>
<p><code>msgIDs</code> には、以下のいずれかを渡すことができます:</p>
<ul>
<li>指定するメッセージの固有ID を格納した <em>コレクション</em></li>
<li>単一のメッセージの固有ID (<em>テキスト</em>)</li>
<li>以下の定数 (<em>longint</em>) を使用することで、選択されているメールボックスの全メッセージを指定することができます:</li>
</ul>















<table><thead><tr><th>定数<th>値<th>説明<tbody><tr><td>IMAP all<td>1<td>選択されたメールボックスの全メッセージを選択します</table>
<p><code>keywords</code> を使って、<code>msgIDs</code> 引数で指定したメッセージから削除するフラグを定義します。 以下の標準フラグおよびカスタムフラグを使用することができます:</p>








































<table><thead><tr><th>引数<th>型<th>説明<tbody><tr><td>$draft<td>Boolean<td>メッセージの "draft" フラグを削除するには true<tr><td>$seen<td>Boolean<td>メッセージの "seen" フラグを削除するには true<tr><td>$flagged<td>Boolean<td>メッセージの "flagged" フラグを削除するには true<tr><td>$answered<td>Boolean<td>メッセージの "answered" フラグを削除するには true<tr><td>$deleted<td>Boolean<td>メッセージの "deleted" フラグを削除するには true<tr><td><code>&lt;custom flag></code><td>Boolean<td>メッセージのカスタムフラグを削除するには true</table>
<p>カスタムフラグの詳細については、<a href=#addflags>.addFlags()</a> を参照ください。</p>
<blockquote>
<ul>
<li>キーワードが考慮されるためには、その値が true でなければなりません。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-13>例題<a href=#例題-13 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// transporter を作成します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// メールボックスを選択します</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// INBOX の全メッセージを未読にします</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.removeFlags(IMAP all;$flags)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=renamebox>.renameBox()<a href=#renamebox class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>19<td>追加</table>
</div></div></details>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>currentName<td>Text<td style=text-align:center>-><td>カレントメールボックスの名称<tr><td>newName<td>Text<td style=text-align:center>-><td>新しいメールボックス名<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>renameBox処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-24>説明<a href=#説明-24 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.renameBox()</code> 関数は、IMAPサーバー上でメールボックスの名称を変更します。 存在しないメールボックスの名称を変更しようとしたり、すでに使われているメールボックス名に変更しようとしたりすると、エラーが生成されます。</p>
<p><code>currentName</code> には、名称変更するメールボックスの名前を渡します。</p>
<p>メールボックスの新しい名称は <code>newName</code> に渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-14>例題<a href=#例題-14 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>“Invoices” メールボックスを “Bills” に名称変更します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("パスワードを入力してください:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// メールボックスの名称変更</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.renameBox("Invoices"; "Bills")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("メールボックスの名称が変更されました。")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("エラー: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=port>.port<a href=#port class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R4<td>追加</table>
</div></div></details>
<p><strong>.port</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-25>説明<a href=#説明-25 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.port</code> プロパティは、 メール通信に使用されるポート番号を格納します。 <code>SMTP New transporter</code> や <code>POP3 New transporter</code>、 <code>IMAP New transporter</code> のコマンドで <code>transporter</code> オブジェクトを作成する際に使用される <em>server</em> オブジェクトにおいて、 このプロパティが指定されなかった場合に使用されるポートは次のとおりです:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=searchmails>.searchMails()<a href=#searchmails class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>18 R5<td>追加</table>
</div></div></details>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>searchCriteria<td>Text<td style=text-align:center>-><td>検索条件<tr><td>戻り値<td>Collection<td style=text-align:center>&lt;-<td>メッセージ番号のコレクション</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-26>説明<a href=#説明-26 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<blockquote>
<p>この関数は、<a href=https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol target=_blank rel="noopener noreferrer">IMAP プロトコル</a> の仕様に基づいています。</p>
</blockquote>
<p><code>.searchMails()</code> 関数は、カレントメールボックスにおいて <em>searchCriteria</em> の検索条件に合致するメッセージを検索します。 <em>searchCriteria</em> 引数には、一つ以上の検索キーを格納します。</p>
<p><em>searchCriteria</em> はテキスト型の引数で、一つ以上の検索キー (詳細は後述の <a href=#%E5%88%A9%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA%E6%A4%9C%E7%B4%A2%E3%82%AD%E3%83%BC>利用可能な検索キー</a> 参照) を格納し、検索する値を渡します (渡さない場合もあります)。 検索キーは単一または複数の項目からなります。 例:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">SearchKey1 = FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey2 = NOT FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre></div></div>
<blockquote>
<p>文字の大小は通常区別されません。</p>
</blockquote>
<ul>
<li><em>searchCriteria</em> 引数が null 文字列の場合、検索は "すべてを選択" と同等です。</li>
<li>引数が複数の検索キーを格納している場合、それらすべてに合致する和集合 (AND) が検索結果になります。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = FLAGGED FROM "SMITH"</span><br></span></code></pre></div></div>
<p>... この検索結果は \Flagged フラグが設定されていて、かつ Smith から送られたメッセージをすべて返します。</p>
<ul>
<li><strong>OR</strong> および <strong>NOT</strong> 演算子を、以下のように使用することができます:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre></div></div>
<p>... \Seen フラグが設定されている、あるいは \Flagged フラグが設定されているメッセージをすべて返します。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre></div></div>
<p>... \Seen フラグが設定されていないメッセージをすべて返します。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...</span><br></span></code></pre></div></div>
<p>... content-type ヘッダーが "Mixed" を格納しているもののうち、"Text" は格納していないメッセージを返します。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"</span><br></span></code></pre></div></div>
<p>... content-type ヘッダーが "e" を格納しているもののうち、Subject ヘッダーが "o" を格納していないもの、かつ content-type ヘッダーが "Mixed" でないメッセージを返します。</p>
<p>最後の 2例については、最初の検索キーリストのカッコを取り除いてしまうと検索結果が異なることに注意してください。</p>
<ul>
<li><em>searchCriteria</em> 引数には任意の [CHARSET] 指定を含めることができます。 これは "CHARSET" という単語の後に実際の文字コード [CHARSET] (US ASCII, ISO-8859 など) が続きます。 これは <em>searchCriteria</em> 文字列の文字コードを指定します。 そのため、[CHARSET] 指定を使用する場合には <em>searchCriteria</em> 文字列を指定された文字コードへと変換する必要があります (詳細については <code>CONVERT FROM TEXT</code> または <code>Convert to text</code> コマンドを参照ください)。
デフォルトでは、searchCriteria 引数に拡張された文字列が含まれていた場合には4D はそれを Quotable Printable へとエンコードします。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = CHARSET "ISO-8859" BODY "Help"</span><br></span></code></pre></div></div>
<p>... これは、検索条件に iso-8859 文字コードを使用し、必要に応じてサーバーは検索前に検索条件をこの文字コードに変換しなければならない、ということを意味します。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=検索する値の型について>検索する値の型について<a href=#検索する値の型について class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>検索キーによっては、次の型の検索値が必要となる場合があります:</p>
<ul>
<li>
<p><strong>日付値の検索キー</strong>:
date は日付を指定する文字列で、以下のようにフォーマットされている必要があります: <em>date-day+"-"+date-month+"-"+date-year</em>。ここでの date-day は日付の数値 (最大2桁) を意味し、date-month は月の名前 (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) を意味し、date-year は年 (4桁) を意味します。
例: <code>searchCriteria = SENTBEFORE 1-Feb-2000</code> (日付は特殊文字を含まないため、通常は引用符でくくる必要はありません)</p>
</li>
<li>
<p><strong>文字列値の検索キー</strong>: string はあらゆる文字列を含みうるため、引用符でくくらなければなりません。 文字列が特殊文字 (スペース文字など) をまったく含まない場合には、引用符で括る必要はありません。 このような文字列を引用符でくくることは、渡した文字列値が正確に解釈されることを保証します。
例: <code>searchCriteria = FROM "SMITH"</code><br>
文字列を使用するすべての検索キーに対し、フィールドの文字列に検索キーが含まれる場合には検索に合致したとみなされます。 合致は文字の大小を区別しません。</p>
</li>
<li>
<p><strong>field-name 値の検索キー</strong>: field-name はヘッダーフィールドの名称です。
例: <code>searchCriteria = HEADER CONTENT-TYPE "MIXED"</code></p>
</li>
<li>
<p><strong>フラグ値の検索キー</strong>: flag は一つ以上のキーワードを (標準のフラグを含めて) 受け入れます。複数指定する場合にはスペースで区切ります。
例: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p>
</li>
<li>
<p><strong>メッセージセット値の検索キー</strong>: 複数のメッセージを識別します。 メッセージシーケンス番号は、1 から始まりメールボックスのメッセージの総数までの連続した番号です。 個別の番号はカンマで区切ります。コロンは、その前後の番号を含めた連続した番号を指定します。
例:<br>
<code>2,4:7,9,12:*</code> は、15通あるメールボックスの場合に <code>2,4,5,6,7,9,12,13,14,15</code> を指定します。
<code>searchCriteria = 1:5 ANSWERED</code> は、メッセージシーケンス番号 1 から 5番のメッセージのうち、\Answered フラグが設定されているメッセージを検索します。
<code>searchCriteria= 2,4 ANSWERED</code> は、メッセージセレクション (メッセージ番号 2番と4番) のうち、\Answered フラグが設定されているメッセージを検索します。</p>
</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=利用可能な検索キー>利用可能な検索キー<a href=#利用可能な検索キー class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><strong>ALL</strong>: メールボックスの全メッセージ<br>
<strong>ANSWERED</strong>: \Answered フラグが設定されたメッセージ<br>
<strong>UNANSWERED</strong>: \Answered フラグが設定されていないメッセージ<br>
<strong>DELETED</strong>: \Deleted フラグが設定されたメッセージ<br>
<strong>UNDELETED</strong>: \Deleted フラグが設定されていないメッセージ<br>
<strong>DRAFT</strong>: \Draft フラグが設定されているメッセージ<br>
<strong>UNDRAFT</strong>: \Draft フラグが設定されていないメッセージ<br>
<strong>FLAGGED</strong>: \Flagged フラグが設定されているメッセージ<br>
<strong>UNFLAGGED</strong>: \Flagged フラグが設定されていないメッセージ<br>
<strong>RECENT</strong>: \Recent フラグが設定されているメッセージ<br>
<strong>OLD</strong>: \Recent フラグが設定されていないメッセージ<br>
<strong>SEEN</strong>: \Seen フラグが設定されているメッセージ<br>
<strong>UNSEEN</strong>: \Seen フラグが設定されていないメッセージ<br>
<strong>NEW</strong>: \Recent フラグが設定されているが \Seen フラグが設定されていないメッセージ。 これは機能的には “(RECENT UNSEEN)” と同じです。<br>
<em><em>KEYWORD</em> flag</em>**: 指定されたキーワードが設定されているメッセージ<br>
<em><em>UNKEYWORD</em> flag</em>**: 指定されたキーワードが設定されていないメッセージ<br>
<em><em>BEFORE</em> date</em>**: 内部の日付が指定日より前のメッセージ<br>
<em><em>ON</em> date</em>**: 内部の日付が指定日に合致するメッセージ<br>
<em><em>SINCE</em> date</em>**: 内部の日付が指定日より後のメッセージ<br>
<em><em>SENTBEFORE</em> date</em>**: 日付ヘッダーが指定日より前のメッセージ<br>
<em><em>SENTON</em> date</em>**: 日付ヘッダーが指定日に合致するメッセージ<br>
<em><em>SENTSINCE</em> date</em>**: 日付ヘッダーが指定日以降のメッセージ<br>
<em><em>TO</em> string</em>**: TO ヘッダーに指定文字列が含まれているメッセージ<br>
<em><em>FROM</em> string</em>**: FROM ヘッダーに指定文字列が含まれているメッセージ<br>
<em><em>CC</em> string</em>**: CC ヘッダーに指定文字列が含まれているメッセージ<br>
<em><em>BCC</em> string</em>**: BCC ヘッダーに指定文字列が含まれているメッセージ<br>
<em><em>SUBJECT</em> string</em>**: 件名ヘッダーに指定文字列が含まれているメッセージ<br>
<em><em>BODY</em> string</em>**: メッセージ本文に指定文字列が含まれているメッセージ<br>
<em><em>TEXT</em> string</em>**: ヘッダーまたはメッセージ本文に指定文字列が含まれているメッセージ<br>
<strong>HEADER <em>field-name</em> <em>string</em></strong>: 指定フィールド名のヘッダーを持ち、そのフィールド内に指定文字列が含まれているメッセージ<br>
<strong>UID <em>message-UID</em></strong>: 指定された固有識別子に対応する固有識別子を持つメッセージ<br>
<strong>LARGER <em>n</em></strong>: 指定バイト数以上のサイズを持つメッセージ<br>
<strong>SMALLER <em>n</em></strong>: 指定バイト数以下のサイズを持つメッセージ<br>
<strong>NOT <em>search-key</em></strong>: 指定検索キーに合致しないメッセージ<br>
<strong>OR <em>search-key1</em> <em>search-key2</em></strong>: いずれかの検索キーに合致するメッセージ</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=selectbox>.selectBox()<a href=#selectbox class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>リリース<th>内容<tbody><tr><td>20<td><em>id</em>, <em>flags</em>, <em>permanentFlags</em> が返されます。<tr><td>18 R4<td>追加</table>
</div></div></details>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>





























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>メールボックスの名称<tr><td>state<td>Integer<td style=text-align:center>-><td>メールボックスのアクセス状態<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>boxInfo オブジェクト</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-27>説明<a href=#説明-27 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.selectBox()</code> 関数は、 <em>name</em> に指定したメールボックスをカレントメールボックスとして選択します。 この関数を使用するとメールボックスに関する情報を取得することができます。</p>
<blockquote>
<p>カレントメールボックスを変更せずに、メールボックスから情報を取得するには、<a href=#getboxinfo><code>.getBoxInfo()</code></a> を使用します。</p>
</blockquote>
<p><em>name</em> には、アクセスするメールボックスの名前を渡します。 この名称は明確な左から右への階層を表し、特定の区切り文字でレベルを区分けします。 この区切り文字は <a href=#getdelimiter><code>.getDelimiter()</code></a> 関数で調べることができます。</p>
<p>任意の <em>state</em> 引数を渡すと、メールボックスへのアクセスタイプを定義できます。 取りうる値は以下の通りです:</p>




















<table><thead><tr><th>定数<th>値<th>説明<tbody><tr><td>IMAP read only state<td>1<td>選択されたメールボックスは読み取り専用権限でアクセスされます。 新しいメッセージを表す "新着" フラグはそのまま変化しません。<tr><td>IMAP read write state<td>0<td>選択されたメールボックスは読み書き可能権限でアクセスされます。 メッセージは "既読" と判断され、"新着" フラグは失われます。 (デフォルト値)</table>
<blockquote>
<ul>
<li><em>name</em> 引数が存在しないメールボックスを指定した場合、関数はエラーを生成し <strong>Null</strong> を返します。</li>
<li>開いている接続がない場合、<code>.selectBox()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<code>IMAP New transporter</code> 参照) 以上に使用されなかった場合には、<a href=#checkconnection><code>.checkConnection()</code></a> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>返される <code>boxInfo</code> オブジェクトには、以下のプロパティが格納されています:</p>








































<table><thead><tr><th>プロパティ<th>型<th>説明<tbody><tr><td>name<td>Text<td>メールボックスの名称<tr><td>mailCount<td>number<td>メールボックス内のメッセージの数<tr><td>mailRecent<td>number<td>"recent" フラグがついたメッセージの数<tr><td>id<td>text<td>メールボックスの固有ID<tr><td>flags<td>text<td>メールボックスで現在使用されているフラグのリスト (スペース区切り)。<tr><td>permanentFlags<td>text<td>クライアントが永続的に変更可能なフラグ (IMAPサーバーが管理する \Recent フラグを除く) の、スペース区切りのリスト。</table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p><code>permanentFlags</code> の文字列に特別なフラグ * が含まれている場合、それは、サーバーが <a href=#addflags>カスタムフラグ</a> をサポートしていることを意味します。</div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-15>例題<a href=#例題-15 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" // 必須</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=subscribe>.subscribe()<a href=#subscribe class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>19<td>追加</table>
</div></div></details>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>メールボックスの名称<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>subscribe処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-28>説明<a href=#説明-28 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.subscribe()</code> 関数は、IMAPサーバーの購読メールボックスとして任意のメールボックスを追加します。 利用可能なメールボックスが大量にある場合、すべてを取得するのを避けるため、確認したいメールボックスだけを購読することができます。</p>
<p><code>name</code> には、購読するメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-16>例題<a href=#例題-16 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>"Bills" 階層下の "Atlas Corp” メールボックスを購読します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("パスワードを入力してください:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("メールボックスの購読に成功しました。")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("エラー: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=unsubscribe>.unsubscribe()<a href=#unsubscribe class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>19<td>追加</table>
</div></div></details>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>引数<th>型<th style=text-align:center><th>説明<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>メールボックスの名称<tr><td>戻り値<td>Object<td style=text-align:center>&lt;-<td>unsubscribe処理のステータス</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-29>説明<a href=#説明-29 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.unsubscribe()</code> 関数は、指定したメールボックスを購読メールボックスから削除します。 これにより、確認するメールボックスの数を減らせます。</p>
<p><code>name</code> には、購読を解除するメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>















































<table><thead><tr><th>プロパティ<th><th>型<th>説明<tbody><tr><td>success<td><td>Boolean<td>処理が正常に終わった場合には true、それ以外は false<tr><td>statusText<td><td>Text<td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー<tr><td>errors<td><td>Collection<td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)<tr><td><td>[].errcode<td>Number<td>4Dエラーコード<tr><td><td>[].message<td>Text<td>4Dエラーの詳細<tr><td><td>[].componentSignature<td>Text<td>エラーを返した内部コンポーネントの署名</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=例題-17>例題<a href=#例題-17 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p>"Bills" 階層下の "Atlas Corp” メールボックスの購読を解除します:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("パスワードを入力してください:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.unsubscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("メールボックスの購読を解除しました。")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("エラー: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=user>.user<a href=#user class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>履歴</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>リリース<th>内容<tbody><tr><td>17 R4<td>追加</table>
</div></div></details>
<p><strong>.user</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=説明-30>説明<a href=#説明-30 class=hash-link aria-label=見出しへの直接リンク title=見出しへの直接リンク>​</a></h4>
<p><code>.user</code> プロパティは、メールサーバーでの認証に使用されたユーザー名を格納します。</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(21)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>このページへコメントする</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=ドキュメントのナビゲーション><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/ja/API/HTTPRequestClass><div class=pagination-nav__sublabel>前へ</div><div class=pagination-nav__label>HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/ja/API/IncomingMessageClass><div class=pagination-nav__sublabel>次へ</div><div class=pagination-nav__label>IncomingMessage</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#imap-transporter-オブジェクト class="table-of-contents__link toc-highlight">IMAP Transporter オブジェクト</a><li><a href=#4dimaptransporternew class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a><li><a href=#acceptunsecureconnection class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a><li><a href=#addflags class="table-of-contents__link toc-highlight">.addFlags()</a><li><a href=#append class="table-of-contents__link toc-highlight">.append()</a><li><a href=#authenticationmode class="table-of-contents__link toc-highlight">.authenticationMode</a><li><a href=#checkconnection class="table-of-contents__link toc-highlight">.checkConnection()</a><li><a href=#checkconnectiondelay class="table-of-contents__link toc-highlight">.checkConnectionDelay</a><li><a href=#connectiontimeout class="table-of-contents__link toc-highlight">.connectionTimeOut</a><li><a href=#copy class="table-of-contents__link toc-highlight">.copy()</a><li><a href=#createbox class="table-of-contents__link toc-highlight">.createBox()</a><li><a href=#delete class="table-of-contents__link toc-highlight">.delete()</a><li><a href=#deletebox class="table-of-contents__link toc-highlight">.deleteBox()</a><li><a href=#expunge class="table-of-contents__link toc-highlight">.expunge()</a><li><a href=#getboxinfo class="table-of-contents__link toc-highlight">.getBoxInfo()</a><li><a href=#getboxlist class="table-of-contents__link toc-highlight">.getBoxList()</a><li><a href=#getdelimiter class="table-of-contents__link toc-highlight">.getDelimiter()</a><li><a href=#getmail class="table-of-contents__link toc-highlight">.getMail()</a><li><a href=#getmails class="table-of-contents__link toc-highlight">.getMails()</a><li><a href=#getmimeasblob class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a><li><a href=#host class="table-of-contents__link toc-highlight">.host</a><li><a href=#logfile class="table-of-contents__link toc-highlight">.logFile</a><li><a href=#move class="table-of-contents__link toc-highlight">.move()</a><li><a href=#numtoid class="table-of-contents__link toc-highlight">.numToID()</a><li><a href=#removeflags class="table-of-contents__link toc-highlight">.removeFlags()</a><li><a href=#renamebox class="table-of-contents__link toc-highlight">.renameBox()</a><li><a href=#port class="table-of-contents__link toc-highlight">.port</a><li><a href=#searchmails class="table-of-contents__link toc-highlight">.searchMails()</a><li><a href=#selectbox class="table-of-contents__link toc-highlight">.selectBox()</a><li><a href=#subscribe class="table-of-contents__link toc-highlight">.subscribe()</a><li><a href=#unsubscribe class="table-of-contents__link toc-highlight">.unsubscribe()</a><li><a href=#user class="table-of-contents__link toc-highlight">.user</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>コミュニティ</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://x.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>X</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>サポート</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/4d/docs/releases/tag/latest target=_blank rel="noopener noreferrer" class=footer__link-item>Documentation download<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (旧ドキュメント)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>ナレッジベース</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>ダウンロード</a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources</a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>サポートを受ける</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>会社概要</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>4D社について</a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>コンタクト</a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>世界中の4D</a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Careers</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>© 2025 4D SAS - All rights reserved</div></div></div></footer></div>