<!DOCTYPE html><html lang="ja"><head><meta name="docsearch:version" content="19 BETA"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>IMAPTransporter · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="`IMAPTransporter` クラスを使って、IMAP メールサーバーからメッセージを取得することができます。"/><meta name="docsearch:language" content="ja"/><meta property="og:title" content="IMAPTransporter · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/index.html"/><meta property="og:description" content="`IMAPTransporter` クラスを使って、IMAP メールサーバーからメッセージを取得することができます。"/><meta property="og:image" content="https://4d.github.io/docs/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/img/logohome.png"/><link rel="shortcut icon" href="/docs/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/js/code-blocks-buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/ja"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs" target="_self">v19 BETA</a></li><li class=""><a href="https://developer.4d.com/docs/Rx" target="_self">v18 R6</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/img/language.svg" alt="Languages icon"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/API/IMAPTransporterClass.html">English</a></li><li><a href="/docs/de/API/IMAPTransporterClass.html">Deutsch</a></li><li><a href="/docs/es/API/IMAPTransporterClass.html">Español</a></li><li><a href="/docs/fr/API/IMAPTransporterClass.html">Français</a></li><li><a href="/docs/pt/API/IMAPTransporterClass.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>クラス API リファレンス</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">はじめに<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/GettingStarted/installation.html">インストール</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">プロジェクト管理<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Project/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/creating.html">プロジェクトを開発する</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/architecture.html">プロジェクトのアーキテクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/documentation.html">ドキュメンテーション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/compiler.html">Compilation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ランゲージのコンセプト<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/about.html">4D ランゲージについて</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/quick-tour.html">概要</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/data-types.html">データタイプの概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/boolean.html">ブール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/collection.html">コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/date.html">日付</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/null-undefined.html">Null と 未定義</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/number.html">数値 (実数、倍長整数、整数)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/object.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/picture.html">ピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/pointer.html">ポインター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/string.html">文字列</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/time.html">時間</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/variant.html">バリアント</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/variables.html">変数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/arrays.html">配列</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/methods.html">メソッド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/parameters.html">引数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/shared.html">共有オブジェクトと共有コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/classes.html">クラス</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/control-flow.html">制御フロー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/branching.html">分岐構造</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/looping.html">ループ構造</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/ja/Tags/tags.html">変換タグ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/error-handling.html">エラー処理</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/interpreted-compiled.html">インタープリターモードとコンパイル済みモード</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/components.html">コンポーネント</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/plug-ins.html">プラグイン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/identifiers.html">識別子の命名規則</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/overview.html">ORDAとは何か</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/dsmapping.html">データモデルオブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/ordaClasses.html">データモデルクラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/entities.html">データ操作</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/datastores.html">リモートデータストアの利用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/glossary.html">用語集</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">クラス API リファレンス<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/API/overview.html">クラス API の概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ClassClass.html">クラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/CollectionClass.html">コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataClassClass.html">データクラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EntityClass.html">エンティティ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FunctionClass.html">Formula</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ja/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SessionClass.html">セッション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">アクセス権限<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Users/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Users/editing.html">4Dユーザー＆グループの管理</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Preferences<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/general.html">General Page</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/structure.html">Structure Page</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/forms.html">Forms Page</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/methods.html">Methods Page</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/shortcuts.html">Shortcuts Page</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">データベース管理<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/webAdmin.html">Web Administration</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/dataExplorer.html">Web Data Explorer</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/licenses.html">4D ライセンスの管理</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/tls.html">TLS Protocol (HTTPS)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/debugLogFiles.html">Description of log files</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Admin/cli.html">Command Line Interface</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">MSC<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/information.html">情報ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/analysis.html">ログ解析ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/verify.html">検査ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/backup.html">バックアップページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/compact.html">圧縮ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/rollback.html">ロールバックページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/restore.html">復元ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/repair.html">修復ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/MSC/encrypt.html">暗号化ページ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">バックアップと復元<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Backup/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Backup/backup.html">バックアップ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Backup/settings.html">バックアップ設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Backup/log.html">ログファイル (.journal)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Backup/restore.html">復元</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Web サーバー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/webServer.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/webServerConfig.html">バックアップ設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/webServerAdmin.html">データベース管理</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/webServerObject.html">Webサーバーオブジェクト</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Web Development<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/gettingStarted.html">はじめに</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/templates.html">Template pages</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/httpRequests.html">Processing HTTP requests</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/allowProject.html">Allowing project methods</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/errorPages.html">Custom HTTP Error Pages</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/authentication.html">Authentication</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/sessions.html">User sessions</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/WebServer/preemptiveWeb.html">Using preemptive web processes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">REST サーバー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/REST/gettingStarted.html">はじめに</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/configuration.html">サーバー設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/authUsers.html">ユーザーとセッション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/genInfo.html">サーバー情報の取得</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/manData.html">データ操作</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/classFunctions.html">ORDAクラス関数の呼び出し</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/REST_requests.html">RESTリクエストについて</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (general)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/REST/catalog.html">$catalog</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/directory.html">$directory</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/info.html">$info</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/upload.html">$upload</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (dataClass)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/REST/{dataClass}.html">{dataClass}</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/asArray.html">$asArray</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/atomic_$atonce.html">$atomic/$atonce</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/attributes.html">$attributes</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/binary.html">$binary</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/compute.html">$compute</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/distinct.html">$distinct</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/entityset.html">$entityset</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/expand.html">$expand</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/filter.html">$filter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/imageformat.html">$imageformat</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/method.html">$method</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/orderby.html">$orderby</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/querypath.html">$querypath</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/queryplan.html">$queryplan</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/savedfilter.html">$savedfilter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/savedorderby.html">$savedorderby</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/skip.html">$skip</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/timeout.html">$timeout</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/top_$limit.html">$top/$limit</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/REST/version.html">$version</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">クライアント/サーバー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Desktop/clientServer.html">クライアント/サーバー管理</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">フォーム<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/forms.html">4D フォームについて</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/formEditor.html">フォームエディター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/macros.html">フォームエディターマクロ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/objectLibrary.html">オブジェクトライブラリ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/stylesheets.html">スタイルシート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/pictures.html">ピクチャー</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">フォームプロパティ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/jsonReference.html">JSON プロパティリスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/action.html">動作</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/propertiesForm.html">フォームプロパティ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/formSize.html">フォームサイズ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/markers.html">Markers</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/menu.html">メニュー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/print.html">印刷</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormEditor/windowSize.html">ウィンドウサイズ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">フォームオブジェクト<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/formObjectsOverview.html">4D フォームオブジェクトについて</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/buttonOverview.html">ボタン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/buttonGridOverview.html">ボタングリッド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/checkboxOverview.html">チェックボックス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/comboBoxOverview.html">コンボボックス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/dropdownListOverview.html">ドロップダウンリスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/groupBox.html">グループボックス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/inputOverview.html">入力</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/listOverview.html">階層リスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/listboxOverview.html">リストボックス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/pictureButtonOverview.html">ピクチャーボタン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/picturePopupMenuOverview.html">ピクチャーポップアップメニュー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/pluginAreaOverview.html">プラグインエリア</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/progressIndicator.html">進捗インジケーター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/radiobuttonOverview.html">ラジオボタン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/ruler.html">ルーラー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/shapesOverview.html">図形</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/spinner.html">スピナー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/splitters.html">スプリッター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/staticPicture.html">スタティックピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/stepper.html">ステッパー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/subformOverview.html">サブフォーム</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/tabControl.html">タブコントロール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/text.html">テキスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/webAreaOverview.html">Webエリア</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/viewProAreaOverview.html">4D View Pro エリア</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/writeProAreaOverview.html">4D Write Pro エリア</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">フォームオブジェクトプロパティ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesReference.html">JSON プロパティリスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesAction.html">動作</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesAnimation.html">アニメーション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesAppearance.html">アピアランス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesBackgroundAndBorder.html">背景色と境界線</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesCoordinatesAndSizing.html">座標とサイズ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesCrop.html">行列数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesDataSource.html">データソース</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesDisplay.html">表示フォーマット</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesEntry.html">入力</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesFooters.html">フッター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesGridlines.html">グリッド線</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesHeaders.html">ヘッダー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesHelp.html">ヘルプ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesHierarchy.html">階層</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesListBox.html">リストボックス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesObject.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesPicture.html">ピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesPlugIns.html">プラグイン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesPrint.html">印刷</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesRangeOfValues.html">値の範囲</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesResizingOptions.html">リサイズオプション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesScale.html">スケール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesSubform.html">サブフォーム</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesText.html">テキスト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesTextAndPicture.html">テキスト、ピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/FormObjects/propertiesWebArea.html">Webエリア</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">フォームイベント<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Events/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onActivate.html">On Activate</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onAfterEdit.html">On After Edit</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onAfterKeystroke.html">On After Keystroke</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onAfterSort.html">On After Sort</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onAlternativeClick.html">On Alternative Click</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onBeforeDataEntry.html">On Before Data Entry</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onBeforeKeystroke.html">On Before Keystroke</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onBeginDragOver.html">On Begin Drag Over</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onBeginUrlLoading.html">On Begin URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onBoundVariableChange.html">On Bound Variable Change</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onClicked.html">On Clicked</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onCloseBox.html">On Close Box</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onCloseDetail.html">On Close Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onCollapse.html">On Collapse</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onColumnMoved.html">On Column Moved</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onColumnResize.html">On Column Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDataChange.html">On Data Change</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDeactivate.html">On Deactivate</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDeleteAction.html">On Delete Action</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDisplayDetail.html">On Display Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDoubleClicked.html">On Double Clicked</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDragOver.html">On Drag Over</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onDrop.html">On Drop</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onEndUrlLoading.html">On End URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onExpand.html">On Expand</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onFooterClick.html">On Footer Click</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onGettingFocus.html">On Getting focus</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onHeader.html">On Header</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onHeaderClick.html">On Header Click</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onLoad.html">On Load</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onLoadRecord.html">On Load Record</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onLongClick.html">On Long Click</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onLosingFocus.html">On Losing focus</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onMenuSelected.html">On Menu Selected</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onMouseEnter.html">On Mouse Enter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onMouseLeave.html">On Mouse Leave</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onMouseMove.html">On Mouse Move</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onMouseUp.html">On Mouse Up</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onOpenDetail.html">On Open Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onOpenExternalLink.html">On Open External Link</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onOutsideCall.html">On Outside Call</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onPageChange.html">On Page Change</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onPlugInArea.html">On Plug in Area</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onPrintingBreak.html">On Printing Break</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onPrintingDetail.html">On Printing Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onPrintingFooter.html">On Printing Footer</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onResize.html">On Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onRowMoved.html">On Row Moved</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onRowResize.html">On Row Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onScroll.html">On Scroll</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onSelectionChange.html">On Selection Change</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onTimer.html">On Timer</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onUnload.html">On Unload</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onUrlFiltering.html">On URL Filtering</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onUrlLoadingError.html">On URL Loading Error</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onUrlResourceLoading.html">On URL Resource Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onValidate.html">On Validate</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onVpRangeChanged.html">On VP Range Changed</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onVpReady.html">On VP Ready</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Events/onWindowOpeningDenied.html">On Window Opening Denied</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">メニュー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Menus/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Menus/creating.html">メニューとメニューバーの作成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Menus/properties.html">メニュープロパティ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Menus/bars.html">メニューバーの管理</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Menus/sdi.html">Windows での SDIモード</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">アプリケーションビルド<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Desktop/building.html">プロジェクトパッケージのビルド</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/master/docs/API/IMAPTransporterClass.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">IMAPTransporter</h1></header><article><div><span><p><code>IMAPTransporter</code> クラスを使って、IMAP メールサーバーからメッセージを取得することができます。</p>
<h3><a class="anchor" aria-hidden="true" id="imap-transporter-オブジェクト"></a><a href="#imap-transporter-オブジェクト" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP Transporter オブジェクト</h3>
<p>IMAP Transporter オブジェクトは <a href="#imap-new-transporter">IMP New transporter</a> コマンドによってインスタンス化されます。 これらは、次のプロパティや関数を持ちます:</p>
<table>
<thead>
<tr><th></th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    暗号化されていない接続の確立が許可されてれば <strong>true</strong></td></tr>
<tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><p>    <code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを追加します</td></tr>
<tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><p>    <code>destinationBox</code> に指定したメールボックスに、<code>mailObj</code> のメールを追加します</td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    メールサーバーのセッションを開くのに使用される認証モード</td></tr>
<tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a><p>     transporter オブジェクトが保存する情報を使用して接続をチェックします</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    サーバー接続をチェックするまでの最長時間 (秒単位)</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    サーバー接続の確立までに待機する最長時間 (秒単位)</td></tr>
<tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><p>    <em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へとコピーします</td></tr>
<tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><p>    <code>name</code> に指定した名称の新規メールボックスを作成します</td></tr>
<tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>    <code>msgsIDs</code> または <code>allMsgs</code> が指定するメッセージに対して &quot;削除済み&quot; フラグを設定します</td></tr>
<tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><p>    <code>name</code> に指定した名称のメールボックスを IMAPサーバーから完全に削除します</td></tr>
<tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a><p>    &quot;deleted&quot; フラグがつけられたメッセージをすべてIMAP メールサーバーから削除します</td></tr>
<tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><p>    <em>name</em> が指定するメールボックスに対応する <code>boxInfo</code> オブジェクトを返します</td></tr>
<tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><p>    利用可能なメールボックスの情報を mailbox オブジェクトのコレクションとしてを返します</td></tr>
<tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a><p>    メールボックス名で階層レベルを区切るのに使用される文字を返します</td></tr>
<tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><p>    <code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメールを <code>Email</code> オブジェクトとして返します</td></tr>
<tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><p>    <code>Email</code> オブジェクトのコレクションを格納したオブジェクトを返します</td></tr>
<tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><p>    <code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメッセージの MIMEコンテンツを格納した BLOB を返します</td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    ホストサーバーの名前または IPアドレス</td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    メール接続に対して定義された拡張ログファイル (あれば) へのフルパス</td></tr>
<tr><td>[</td></tr>
<tr><td><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object](#move)<p>    <em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へと移動します</td></tr>
<tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><p>    <em>startMsg</em> および <em>endMsg</em> で指定された連続した範囲のメッセージのシーケンス番号を IMAP固有IDへと変換します</td></tr>
<tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><p>    <code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを削除します</td></tr>
<tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><p>    IMAPサーバー上でメールボックスの名称を変更します</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     メール通信に使用されるポート番号</td></tr>
<tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><p>    カレントメールボックスにおいて <em>searchCriteria</em> の検索条件に合致するメッセージを検索します</td></tr>
<tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>    <code>name</code> に指定したメールボックスをカレントメールボックスとして選択します</td></tr>
<tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><p>    IMAPサーバーの購読メールボックスとして任意のメールボックスを追加・削除します</td></tr>
<tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><p>    指定したメールボックスを購読メールボックスから削除します</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     メールサーバーでの認証に使用されたユーザー名</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="imap-new-transporter"></a><a href="#imap-new-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP New transporter</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>メールサーバー情報</td></tr>
<tr><td>戻り値</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-オブジェクト">IMAP transporter オブジェクト</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明"></a><a href="#説明" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>IMAP New transporter</code> コマンドは、<em>server</em> 引数の指定に応じて 新規の IMAP接続を設定します 。戻り値は、新しい <em>IMAP transporter</em> オブジェクトです。 返された transporter オブジェクトは、通常メールの受信に使用されます。</p>
<p><em>server</em> 引数として、以下のプロパティを持つオブジェクトを渡します:</p>
<table>
<thead>
<tr><th><em>server</em></th><th>デフォルト値 (省略時)</th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    暗号化されていない接続の確立が許可されてれば <strong>true</strong></td><td>False</td></tr>
<tr><td>.<strong>accessTokenOAuth2</strong>: Text<p>OAuth 2 認証の資格情報を表すテキスト文字列。 <code>authenticationMode</code> が OAUTH2 の場合のみ使用されます。 <code>accessTokenOAuth2</code> が使用されているが <code>authenticationMode</code> が省略されていた場合、OAuth2 プロトコルが使用されます (サーバーで許可されていれば)。 <em><a href="#imap-transporter-オブジェクト">IMAP transporter</a></em> オブジェクトには返されません。</td><td>なし</td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    メールサーバーのセッションを開くのに使用される認証モード</td><td>サーバーがサポートするもっともセキュアな認証モードが使用されます</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    サーバー接続をチェックするまでの最長時間 (秒単位)</td><td>300</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    サーバー接続の確立までに待機する最長時間 (秒単位)</td><td>30</td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    ホストサーバーの名前または IPアドレス</td><td><em>必須</em></td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    メール接続に対して定義された拡張ログファイル (あれば) へのフルパス</td><td>なし</td></tr>
<tr><td>.<strong>password</strong> : Text<p>サーバーとの認証のためのユーザーパスワード <em><a href="#imap-transporter-オブジェクト">IMAP transporter</a></em> オブジェクトには返されません。</td><td>なし</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     メール通信に使用されるポート番号</td><td>993</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     メールサーバーでの認証に使用されたユーザー名</td><td>なし</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>警告</strong>: 定義されたタイムアウトが、サーバータイムアウトより短いようにしてください。そうでない場合、クライアントタイムアウトは無意味になります。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="戻り値"></a><a href="#戻り値" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p>この関数は、<a href="#imap-transporter-オブジェクト"><strong>IMAP transporter オブジェクト</strong></a> を返します。 返されるプロパティはすべて <strong>読み取り専用</strong> です。</p>
<blockquote>
<p>IMAP接続は、transporter オブジェクトが消去された時点で自動的に閉じられます。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題"></a><a href="#例題" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object
<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
<span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>
<span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">// Logsフォルダーに保存するログファイル</span><span class="hljs-keyword">

var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">
If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"エラーが発生しました: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="4dimaptransporternew"></a><a href="#4dimaptransporternew" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4D.IMAPTransporter.new()</h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>メールサーバー情報</td></tr>
<tr><td>戻り値</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-オブジェクト">IMAP transporter オブジェクト</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-1"></a><a href="#説明-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>4D.IMAPTransporter.new()</code> 関数は、 新規の <code>4D.IMAPTransporter</code>型オブジェクトを作成して返します。 この関数の機能は、<a href="#imap-new-transporter"><code>IMAP New transporter</code></a> コマンドと同一です。</p>
<h2><a class="anchor" aria-hidden="true" id="acceptunsecureconnection"></a><a href="#acceptunsecureconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.acceptUnsecureConnection</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4><a class="anchor" aria-hidden="true" id="説明-2"></a><a href="#説明-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.acceptUnsecureConnection</code> プロパティは、暗号化された接続が不可能な場合に、 暗号化されていない接続の確立が許可されてれば <strong>true</strong> を格納します。</p>
<p>暗号化されていない接続が許可されていない場合には <strong>false</strong> が格納されており、その場合に暗号化された接続が不可能な場合にはエラーが返されます。</p>
<p>使用可能なセキュアなポートは次のとおりです:</p>
<ul>
<li><p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 または 25: STARTTLS アップグレードがされた SMTP (サーバーがサポートしていれば)</li>
</ul></li>
<li><p>IMAP</p>
<ul>
<li>143: IMAP 非暗号化ポート</li>
<li>993: STARTTLS アップグレードがされた IMAP (サーバーがサポートしていれば)</li>
</ul></li>
<li><p>POP3</p>
<ul>
<li>110: POP3 非暗号化ポート</li>
<li>995: STARTTLS アップグレードがされた POP3 (サーバーがサポートしていれば)</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="addflags"></a><a href="#addflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.addFlags()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>文字列のコレクション: メッセージの固有ID (テキスト型)<br> テキスト: メッセージの固有ID<br> 倍長整数 (IMAP all): 選択されたメールボックス内の全メッセージ</td></tr>
<tr><td>keywords</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>追加するキーワードフラグ</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>addFlags処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-3"></a><a href="#説明-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.addFlags()</code> 関数は、 <code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを追加します。</p>
<p><code>msgIDs</code> には、以下のいずれかを渡すことができます:</p>
<ul>
<li><p>指定するメッセージの固有ID を格納した <em>コレクション</em></p></li>
<li><p>単一のメッセージの固有ID (<em>テキスト</em>)</p></li>
<li><p>以下の定数 (<em>longint</em>) を使用することで、選択されているメールボックスの全メッセージを指定することができます:</p>
<table>
<thead>
<tr><th>定数</th><th>結果</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>選択されたメールボックスの全メッセージを選択します</td></tr>
</tbody>
</table>
</li>
</ul>
<p><code>keywords</code> には、<code>msgIDs</code> 引数で指定したメッセージに対して追加するフラグのキーワード値を格納したオブジェクトを渡します。 次のキーワードを渡すことができます:</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>ブール</td><td>メッセージに &quot;draft&quot; フラグを追加するには true</td></tr>
<tr><td>$seen</td><td>ブール</td><td>メッセージに &quot;seen&quot; フラグを追加するには true</td></tr>
<tr><td>$flagged</td><td>ブール</td><td>メッセージに &quot;flagged&quot; フラグを追加するには true</td></tr>
<tr><td>$answered</td><td>ブール</td><td>メッセージに &quot;answered&quot; フラグを追加するには true</td></tr>
<tr><td>$deleted</td><td>ブール</td><td>メッセージに &quot;deleted&quot; フラグを追加するには true</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>false値は無視されます。</li>
<li>キーワードフラグの解釈は、メールクライアントごとに異なる可能性があります。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1"></a><a href="#例題-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// transporter を作成します</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// メールボックスを選択します</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// INBOXの全メッセージを既読に設定します</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="append"></a><a href="#append" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.append()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>mailObj</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>Email オブジェクト</td></tr>
<tr><td>destinationBox</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>Emailオブジェクトを受信するメールボックス</td></tr>
<tr><td>options</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>文字セット情報を格納したオブジェクト</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>delete処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-4"></a><a href="#説明-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.append()</code> 関数は、 <code>destinationBox</code> に指定したメールボックスに、<code>mailObj</code> のメールを追加します。</p>
<p><code>mailObj</code> には、Email オブジェクトを渡します。 メールプロパティに関する包括的な詳細については、<a href="emails.html#email-オブジェクト">Email オブジェクト</a> を参照ください。  <code>.append()</code> 関数は Email オブジェクトの <code>keywords</code> 属性内のキーワードタグをサポートします。</p>
<p>任意の <code>destinationBox</code> には、<code>mailObj</code> が追加されるメールボックスの名前を指定することができます。 省略した場合は、カレントメールボックスが使用されます。</p>
<p>任意の <code>options</code> には、メールの特定部分の文字セットやエンコーディングを定義するオブジェクトを渡すことができます。 次のプロパティを含みます:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>headerCharset</td><td>テキスト</td><td>メールの以下の部分で使用される文字セットとエンコーディング: 件名、添付ファイル名、メール名の属性。 取り得る値: 以下の可能な文字セットテーブルを参照ください。</td></tr>
<tr><td>bodyCharset</td><td>テキスト</td><td>メールの HTML およびテキスト本文コンテンツで使用される文字セットとエンコーディング。 取り得る値: 以下の可能な文字セットテーブルを参照ください。</td></tr>
</tbody>
</table>
<p>使用可能な文字セット:</p>
<table>
<thead>
<tr><th>定数</th><th>結果</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: 可能なら US-ASCII 、次に可能なら Japanese (ISO-2022-JP) &amp; Quoted-printable 、それも不可なら UTF-8 &amp; Quoted-printable</li><li>bodyCharset: 可能なら US-ASCII、次に可能なら Japanese (ISO-2022-JP) &amp; 7-bit、それも不可なら UTF-8 &amp; Quoted-printable</li></ul></td></tr>
<tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr>
<tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: 可能なら US-ASCII、それが不可なら UTF-8 &amp; Quoted-printable (<strong>デフォルト値</strong>)</td></tr>
<tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: 可能な場合は US-ASCII、それ以外は UTF-8 &amp; base64</td></tr>
</tbody>
</table>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-2"></a><a href="#例題-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>Drafts メールボックスにメールを保存します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object

<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)

<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)

<span class="hljs-variable">$msg</span>:=New object
<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span>
<span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span>
<span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span>
<span class="hljs-variable">$msg</span>.keywords:=New object
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span> <span class="hljs-comment">// メッセージに既読フラグをつけます</span>
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span> <span class="hljs-comment">// // メッセージに下書きフラグをつけます</span>

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="authenticationmode"></a><a href="#authenticationmode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.authenticationMode</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.authenticationMode</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="説明-5"></a><a href="#説明-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.authenticationMode</code> プロパティは、 メールサーバーのセッションを開くのに使用される認証モードを格納します。</p>
<p>デフォルトでは、サーバーによってサポートされている最も安全なモードが使用されます。</p>
<p>とりうる値:</p>
<table>
<thead>
<tr><th>結果</th><th>定数</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>CRAM-MD5 プロトコルを使用した認証</td></tr>
<tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>LOGIN プロトコルを使用した認証</td></tr>
<tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>OAuth2 プロトコルを使用した認証</td></tr>
<tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>PLAIN プロトコルを使用した認証</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnection"></a><a href="#checkconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnection()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnection()</strong> : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>transporter オブジェクト接続のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-6"></a><a href="#説明-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.checkConnection()</code> 関数は、  transporter オブジェクトが保存する情報を使用して接続をチェックします。必要なら再接続をし、そのステータスを返します。 この関数を使用して、ユーザーから提供された値が有効かどうかを検証することができます。</p>
<h4><a class="anchor" aria-hidden="true" id="返されるオブジェクト"></a><a href="#返されるオブジェクト" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>返されるオブジェクト</h4>
<p>この関数はメールサーバーにリクエストを送信し、メールステータスを表すオブジェクトを返します。 このオブジェクトには、次のプロパティが格納されることがあります:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>boolean</td><td>チェックが成功した場合には true、それ以外は false</td></tr>
<tr><td>status</td><td></td><td>number</td><td>(SMTPのみ) メールサーバーから返されたコード (メール処理に関係ない問題の場合には 0)</td></tr>
<tr><td>statusText</td><td></td><td>text</td><td>メールサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>collection</td><td>4Dエラースタック (メールサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[ ].errCode</td><td>number</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[ ].message</td><td>text</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[ ].componentSignature</td><td>text</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnectiondelay"></a><a href="#checkconnectiondelay" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnectionDelay</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="説明-7"></a><a href="#説明-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.checkConnectionDelay</code> 関数は、 サーバー接続をチェックするまでの最長時間 (秒単位)を格納します。  関数呼び出しの間隔がこの時間を超過する場合、サーバー接続が確認されます。 プロパティが <em>server</em> オブジェクトによって設定されていない場合は、デフォルトで 300 という値が使用されます。</p>
<blockquote>
<p><strong>警告</strong>: 定義されたタイムアウトが、サーバータイムアウトより短いようにしてください。そうでない場合、クライアントタイムアウトは無意味になります。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="connectiontimeout"></a><a href="#connectiontimeout" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.connectionTimeOut</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="説明-8"></a><a href="#説明-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.connectionTimeOut</code> プロパティは、 サーバー接続の確立までに待機する最長時間 (秒単位)を格納します。 <code>SMTP New transporter</code> や <code>POP3 New transporter</code>、 <code>IMAP New transporter</code> のコマンドで <code>transporter</code> オブジェクトを作成する際に使用される <code>server</code> オブジェクトにおいて、 このプロパティが指定されなかった場合のデフォルトは 30 です。</p>
<h2><a class="anchor" aria-hidden="true" id="copy"></a><a href="#copy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.copy()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>メッセージの固有ID のコレクション (テキスト)</td></tr>
<tr><td>allMsgs</td><td>整数</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ</td></tr>
<tr><td>destinationBox</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メッセージのコピー先のメールボックス</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>copy処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-9"></a><a href="#説明-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.copy()</code> 関数は、 <em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へとコピーします。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><em>msgsIDs</em> には、コピーするメッセージの固有ID を格納したコレクション</li>
<li><em>allMsgs</em> には、選択されているメールボックスの全メッセージをコピーするための定数 (倍長整数型):</li>
</ul>
<p><em>destinationBox</em> には、メッセージのコピー先メールボックスの名称をテキスト値で渡すことができます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-1"></a><a href="#例題-1-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<p>選択されたメッセージをコピーします:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//  メッセージの固有ID のコレクションを取得します</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// 見つかったメッセージを "documents" メールボックスへコピーします</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-1"></a><a href="#例題-2-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>カレントメールボックスの全メッセージをコピーします:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// 全メッセージを "documents" メールボックスへコピーします</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="createbox"></a><a href="#createbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.createBox()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>新規メールボックスの名称</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>createBox処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-10"></a><a href="#説明-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.createBox()</code> 関数は、 <code>name</code> に指定した名称の新規メールボックスを作成します。 IMAPサーバーの階層区切り文字がメールボックス名内に含まれる場合、IMAPサーバーは指定のメールボックスを作成するのに必要な親階層を作成します。</p>
<p>たとえば、&quot;/&quot; が階層区切り文字として使われるサーバーにおいて、&quot;Projects/IMAP/Doc&quot; を作成しようとした場合:</p>
<ul>
<li>&quot;Projects&quot; &amp; &quot;IMAP&quot; がすでに存在する場合は &quot;Doc&quot; メールボックスのみを作成します。</li>
<li>“Projects” のみが存在する場合は、&quot;IMAP&quot; &amp; &quot;Doc&quot; メールボックスを作成します。</li>
<li>いずれも存在しない場合には、&quot;Projects&quot; &amp; “IMAP” &amp; &quot;Doc&quot; メールボックスをそれぞれ作成します。</li>
</ul>
<p><code>name</code> には、新しいメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-3"></a><a href="#例題-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>新しい “Invoices” メールボックスを作成します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスワードを入力してください:"</span>)<span class="hljs-keyword">
If</span>(OK=<span class="hljs-number">1</span>)
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"メールボックスが作成できました。"</span>)<span class="hljs-keyword">
Else</span>
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"エラー: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="delete"></a><a href="#delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.delete()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>メッセージの固有ID のコレクション (テキスト)</td></tr>
<tr><td>allMsgs</td><td>整数</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>delete処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-11"></a><a href="#説明-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.delete()</code> 関数は、 <code>msgsIDs</code> または <code>allMsgs</code> が指定するメッセージに対して &quot;削除済み&quot; フラグを設定します。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><code>msgsIDs</code> には、削除するメッセージの固有ID を格納したコレクション</li>
<li><code>allMsgs</code> には、選択されているメールボックスの全メッセージを削除するための定数 (倍長整数型):</li>
</ul>
<p>この関数を実行しても、メールが実際に削除される訳ではありません。 &quot;削除済み&quot; フラグがつけられたメッセージも引き続き <a href="#searchmails">.searchMails()</a> 関数によって検索可能です。 フラグがつけられたメッセージは、<a href="#expunge"><code>.expunge()</code></a> を実行したときか、別のメールボックスを選択したとき、あるいは(<a href="#imap-new-transporter">IMAP New transporter</a> で作成された) <a href="#imap-transporter-オブジェクト">transporter オブジェクト</a> が消去されたときにのみ、IMAPサーバーから削除されます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-2"></a><a href="#例題-1-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<p>選択されたメッセージを削除します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">// メッセージの固有ID のコレクションを取得します</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)

  <span class="hljs-comment">// 選択されたメッセージを削除します</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-2"></a><a href="#例題-2-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>カレントメールボックスの全メッセージを削除します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)

  <span class="hljs-comment">// カレントメールボックスの全メッセージを削除します</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="deletebox"></a><a href="#deletebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.deleteBox()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>削除するメールボックスの名称</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>deleteBox処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-12"></a><a href="#説明-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.deleteBox()</code> 関数は、 <code>name</code> に指定した名称のメールボックスを IMAPサーバーから完全に削除します。 存在しないメールボックス、または INBOX を削除しようとして場合には、エラーが生成されます。</p>
<p><code>name</code> には、削除するメールボックスの名前を渡します。</p>
<blockquote>
<ul>
<li>子メールボックスを持つ親メールボックスが &quot;\Noselect&quot; 属性を持っている場合、そのメールボックスは削除できません。</li>
<li>削除されるメールボックス内のメッセージもすべて削除されます。</li>
<li>メールボックス削除の可否はメールサーバーに依存します。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-4"></a><a href="#例題-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>&quot;Bills&quot; メールボックスの階層から、&quot;Nova Orion Industries&quot; の子メールボックスを削除します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスワードを入力してください:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// delete mailbox</span>
<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"メールボックスが削除されました。"</span>)<span class="hljs-keyword">
    Else</span>
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"エラー: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="expunge"></a><a href="#expunge" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.expunge()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.expunge()</strong> : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>expunge処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-13"></a><a href="#説明-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.expunge()</code> 関数は、 &quot;deleted&quot; フラグがつけられたメッセージをすべてIMAP メールサーバーから削除します 。&quot;deleted&quot; フラグは <a href="#delete"><code>.delete()</code></a> または <a href="#addflags"><code>.addFlags()</code></a> 関数によって設定可能です。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-5"></a><a href="#例題-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$ids </span>: Collection

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// transporter を作成します</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// メールボックスを選択します</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// INBOX の既読メッセージに削除フラグを立てます</span>
<span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)

<span class="hljs-comment">// "deleted" フラグがついたメッセージをすべて消去します</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxinfo"></a><a href="#getboxinfo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxInfo()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>name が任意に</td></tr>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メールボックスの名称</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>boxInfo オブジェクト</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-14"></a><a href="#説明-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getBoxInfo()</code> 関数は、 <em>name</em> が指定するメールボックスに対応する <code>boxInfo</code> オブジェクトを返します。 この関数は、<a href="#selectbox"><code>.selectBox()</code></a> と同じ情報を返しますが、カレントメールボックスは変えません。</p>
<p>任意の <em>name</em> パラメーターには、アクセスするメールボックスの名称を渡します。 この名称は明確な左から右への階層を表し、特定の区切り文字でレベルを区分けします。 この区切り文字は <a href="#getdelimiter"><code>.getDelimiter()</code></a> 関数で調べることができます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>返される <code>boxInfo</code> オブジェクトには、以下のプロパティが格納されています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>text</td><td>メールボックスの名称</td></tr>
<tr><td>mailCount</td><td>number</td><td>メールボックス内のメッセージの数</td></tr>
<tr><td>mailRecent</td><td>number</td><td>(新しいメッセージであることを表す) &quot;recent&quot; フラグがついたメッセージの数</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-6"></a><a href="#例題-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)
<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX には "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" 件の最近のメールがあります。"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxlist"></a><a href="#getboxlist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxList()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
<tr><td>v19</td><td><code>isSubscribed</code> を追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>parameters</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>引数のオブジェクト</td></tr>
<tr><td>戻り値</td><td>コレクション</td><td style="text-align:center">&lt;-</td><td>mailbox オブジェクトのコレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-15"></a><a href="#説明-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getBoxList()</code> 関数は、 利用可能なメールボックスの情報を mailbox オブジェクトのコレクションとしてを返します。 この関数を使用すると、IMAPメールサーバー上にあるメッセージの一覧をローカルで管理することができるようになります。</p>
<p>任意の <code>parameters</code> パラメーターには、返されるメールボックスをフィルターするための値を格納したオブジェクトを渡すことができます。 以下のものを渡すことができます:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>isSubscribed</td><td>ブール</td><td><li><strong>True</strong>: 購読しているメールボックスのみを返します。</li><li> <strong>False</strong>: すべての利用可能なメールボックスを返します</li></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="戻り値-1"></a><a href="#戻り値-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p>返されるコレクションの各オブジェクトには、以下のプロパティが格納されています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>[].name</td><td>text</td><td>メールボックスの名称</td></tr>
<tr><td>[].selectable</td><td>boolean</td><td>アクセス権でメールボックスを選択できるかどうかを表します: <ul><li>true - メールボックスは選択可能</li><li>false - メールボックスは選択不可能</li></ul></td></tr>
<tr><td>[].inferior</td><td>boolean</td><td>アクセス権でメールボックス内に下の階層レベルを作成できるかどうかを表します: <ul><li>true - 下の階層レベルは作成可能</li><li>false - 下の階層レベルは作成不可能</li></ul></td></tr>
<tr><td>[].interesting</td><td>boolean</td><td>サーバーがメールボックスに “interesting” のマーク付けをしているかどうかを表します: <ul><li>true - メールボックスはサーバーから &quot;interesting&quot; のマーク付けをされています。 たとえば、メールボックスには新着メッセージが入っている場合が考えられます。</li><li>false - メールボックスはサーバーから &quot;interesting&quot; のマーク付けをされていません。</li></ul></td></tr>
</tbody>
</table>
<p>アカウントにメールボックスが一つもない場合、空のコレクションが返されます。</p>
<blockquote>
<ul>
<li>開いている接続がない場合、<code>.getBoxList()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<code>IMAP New transporter</code> 参照) 以上に使用されなかった場合には、<code>.checkConnection( )</code> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-7"></a><a href="#例題-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"新規メールが届いています: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getdelimiter"></a><a href="#getdelimiter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getDelimiter()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getDelimiter()</strong> : Text</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>テキスト</td><td style="text-align:center">&lt;-</td><td>階層区切り文字</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-16"></a><a href="#説明-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getDelimiter()</code> 関数は、 メールボックス名で階層レベルを区切るのに使用される文字を返します。</p>
<p>この区切り文字は以下のように使用することができます:</p>
<ul>
<li>下層レベルのメールボックスを作成する</li>
<li>メールボックスの階層内での上層・下層レベルを検索する</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="戻り値-2"></a><a href="#戻り値-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p>メールボックス名の区切り文字</p>
<blockquote>
<ul>
<li>開いている接続がない場合、<code>.getDelimiter()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<a href="#checkconnectiondelay">IMAP New transporter</a> 参照) 以上に使用されなかった場合には、<a href="#checkconnection"><code>.checkConnection()</code></a> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-8"></a><a href="#例題-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"新規メールが届いています: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmail"></a><a href="#getmail" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMail()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>整数</td><td style="text-align:center">-&gt;</td><td>メッセージのシーケンス番号</td></tr>
<tr><td>msgID</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メッセージの固有ID</td></tr>
<tr><td>options</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>メッセージ管理オプション</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td><a href="/docs/ja/API/EmailObjectClass.html#email-オブジェクト">Email オブジェクト</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-17"></a><a href="#説明-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getMail()</code> 関数は、 <code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメールを <code>Email</code> オブジェクトとして返します。 この関すを使用すると、メールのコンテンツをローカルで管理できるようになります。</p>
<p>最初の引数として、次のいずれかを渡すことができます:</p>
<ul>
<li><em>msgNumber</em> に、取得するメッセージのシーケンス番号 (<em>倍長整数</em>) を渡します。</li>
<li><em>msgID</em>に、取得するメッセージの固有ID (<em>テキスト</em>) を渡します。</li>
</ul>
<p>任意の <em>options</em> 引数として、メッセージの扱い方を定義する追加のオブジェクトを渡すことができます。 次のプロパティを利用することができます:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>boolean</td><td>true 時には、メールボックス内でメッセージを &quot;既読&quot; にします。 false 時にはメッセージの状態は変化しません。 デフォルト値: true</td></tr>
<tr><td>withBody</td><td>boolean</td><td>true を渡すとメッセージ本文を返します。 false 時には、メッセージヘッダーのみが返されます。 デフォルト値: true</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li><em>msgID</em> 引数が存在しないメッセージを指定した場合、関数はエラーを生成し <strong>Null</strong> を返します。</li>
<li><a href="#selectbox"><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMail()</code> は <a href="#selectbox"><code>.selectBox()</code></a> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="戻り値-3"></a><a href="#戻り値-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p><code>.getMail()</code> は、以下の IMAP特有のプロパティを持つ <a href="/docs/ja/API/EmailObjectClass.html#email-オブジェクト"><code>Email</code> オブジェクト</a>を返します: <em>id</em>、<em>receivedAt</em>、および <em>size</em>。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-9"></a><a href="#例題-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>ID = 1のメッセージを取得します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">// transporter を作成します</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">// ID = 1 の Emailオブジェクトを取得します</span>
 <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmails"></a><a href="#getmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMails()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>ids</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>メッセージID のコレクション</td></tr>
<tr><td>startMsg</td><td>整数</td><td style="text-align:center">-&gt;</td><td>先頭メッセージのシーケンス番号</td></tr>
<tr><td>endMsg</td><td>整数</td><td style="text-align:center">-&gt;</td><td>最後のメッセージのシーケンス番号</td></tr>
<tr><td>options</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>メッセージ管理オプション</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>次のコレクションを格納したオブジェクト:<br><ul><li><a href="/docs/ja/API/EmailObjectClass.html#email-オブジェクト">Email オブジェクト</a> のコレクション</li><li>見つからなかったメッセージの ID または番号のコレクション</li></ul></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-18"></a><a href="#説明-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getMails()</code> 関数は、 <code>Email</code> オブジェクトのコレクションを格納したオブジェクトを返します。</p>
<p><strong>第一シンタックス:</strong></p>
<p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p>
<p>第一シンタックスを使用すると、メッセージID に基づいてメッセージを取得することができます。</p>
<p><em>ids</em> 引数として、取得するメッセージID のコレクションを渡します。 これらの ID は <a href="#getmail"><code>.getMail()</code></a> で取得することができます。</p>
<p>任意の <em>options</em> 引数を渡すと、返されるメッセージのパートを定義することができます。 利用可能なプロパティについては、以下の <strong>オプション</strong> の表を参照ください。</p>
<p><strong>第二シンタックス:</strong></p>
<p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p>
<p>第二シンタックスを使用すると、連続したレンジに基づいてメッセージを取得することができます。 渡される値はメールボックス内でのメッセージの位置を表します。</p>
<p><em>startMsg</em> には、連続したレンジの最初のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最初のメッセージが連続レンジの先頭メッセージとして扱われます。</p>
<p><em>endMsg</em> には、連続レンジに含める最後のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最後のメッセージが連続レンジの最終メッセージとして扱われます。</p>
<p>任意の <em>options</em> 引数を渡すと、返されるメッセージのパートを定義することができます。</p>
<p><strong>オプション</strong></p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>ブール</td><td>true 時には、指定されたメッセージを &quot;既読&quot; にします。 false 時にはメッセージの状態は変化しません。 デフォルト値: true</td></tr>
<tr><td>withBody</td><td>ブール</td><td>true を渡すと指定されたメッセージの本文を返します。 false 時には、メッセージヘッダーのみが返されます。 デフォルト値: true</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li><a href="#selectbox"><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMails()</code> は <a href="#selectbox"><code>.selectBox()</code></a> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="戻り値-4"></a><a href="#戻り値-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p><code>.getMails()</code> は、以下のコレクションを格納したオブジェクトを返します。</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>list</td><td>コレクション</td><td><a href="/docs/ja/API/EmailObjectClass.html#email-オブジェクト"><code>Email</code></a> オブジェクトのコレクション。 Email オブジェクトが見つからない場合、空のコレクションが返されます。</td></tr>
</tbody>
</table>
<p>|notFound |コレクション| 次の要素のコレクション:<br><ul><li>第一シンタックス - 指定した ID のうち、存在しなかったメッセージの ID</li><li>第二シンタックス - startMsg と endMsg の間の番号のうち、存在しなかったメッセージの番号</li></ul>すべてのメッセージが見つかった場合には、空のコレクションが返されます。|</p>
<h4><a class="anchor" aria-hidden="true" id="例題-10"></a><a href="#例題-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>直近の 20件のメールを、&quot;既読&quot; ステータスを変更せずに取得します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//create transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">

  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)
        <span class="hljs-comment">// 直近20件のメッセージのヘッダーを、"既読" にせずに取得します</span>
    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\
<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">
    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)
        <span class="hljs-comment">// ...</span><span class="hljs-keyword">
    End for each</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmimeasblob"></a><a href="#getmimeasblob" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMIMEAsBlob()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>整数</td><td style="text-align:center">-&gt;</td><td>メッセージのシーケンス番号</td></tr>
<tr><td>msgID</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メッセージの固有ID</td></tr>
<tr><td>updateSeen</td><td>ブール</td><td style="text-align:center">-&gt;</td><td>true 時には、メールボックス内でメッセージを &quot;既読&quot; にします。 false 時にはメッセージの状態は変化しません。</td></tr>
<tr><td>戻り値</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>メールサーバーから返された MIME文字列の BLOB</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-19"></a><a href="#説明-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getMIMEAsBlob()</code> 関数は、 <code>IMAP_transporter</code> が指定するメールボックス内の、<em>msgNumber</em> または <em>msgID</em> に対応するメッセージの MIMEコンテンツを格納した BLOB を返します。</p>
<p>最初の引数として、次のいずれかを渡すことができます:</p>
<ul>
<li><em>msgNumber</em> に、取得するメッセージのシーケンス番号 (<em>倍長整数</em>) を渡します。</li>
<li><em>msgID</em>に、取得するメッセージの固有ID (<em>テキスト</em>) を渡します。</li>
</ul>
<p>任意の <em>updateSeen</em> 引数を渡すと、メールボックス内でメッセージが &quot;既読&quot; とマークされるかどうかを指定します。 以下のものを渡すことができます:</p>
<ul>
<li><strong>True</strong> - メッセージは &quot;既読&quot; とマークされます (このメッセージが読まれたことを表します)</li>
<li><strong>False</strong> - メッセージの &quot;既読&quot; ステータスは変化しません。</li>
</ul>
<blockquote>
<ul>
<li><em>msgNumber</em> または <em>msgID</em> 引数が存在しないメッセージを指定した場合、関数は空の BLOB を返します。</li>
<li><a href="#selectbox"><code>.selectBox()</code></a> によって選択されたメールボックスがない場合、エラーが生成されます。</li>
<li>開いている接続がない場合、<code>.getMIMEAsBlob()</code> は <code>.selectBox()</code> で最後に指定されたメールボックスへの接続を開きます。</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="戻り値-5"></a><a href="#戻り値-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p><code>.getMIMEAsBlob()</code> は <code>BLOB</code> を返します。この BLOB はデータベースにアーカイブしたり、<code>MAIL Convert from MIME</code> コマンドを使用して <a href="/docs/ja/API/EmailObjectClass.html#email-object"><code>Email</code> オブジェクト</a> へと変換したりすることができます。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-11"></a><a href="#例題-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">// transporter を作成します</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">// BLOB を取得します</span>
 <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="host"></a><a href="#host" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.host</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.host</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="説明-20"></a><a href="#説明-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.host</code> プロパティは、 ホストサーバーの名前または IPアドレスを格納します。 この情報はメール通信 (SMTP、POP3、IMAP) に使用されます。</p>
<h2><a class="anchor" aria-hidden="true" id="logfile"></a><a href="#logfile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.logFile</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.logFile</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="説明-21"></a><a href="#説明-21" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.logFile</code> プロパティは、 メール接続に対して定義された拡張ログファイル (あれば) へのフルパスを格納します。 パスは、カレント Logs フォルダーを基準とした相対パス、あるいは絶対パスを指定できます。</p>
<p><code>SET DATABASE PARAMETER</code> コマンドで有効化される通常のログファイルとは異なり、拡張ログファイルはすべての送信されたメールの MIMEコンテンツを保存し、サイズ制限がありません。 拡張ログファイルの詳細については、以下の章をそれぞれ参照ください:</p>
<ul>
<li><strong>SMTP 接続</strong> - <a href="/docs/ja/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li>
<li><strong>POP3 接続</strong> - <a href="/docs/ja/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li>
<li><strong>IMAP 接続</strong> - <a href="/docs/ja/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="move"></a><a href="#move" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.move()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>メッセージの固有ID のコレクション (テキスト)</td></tr>
<tr><td>allMsgs</td><td>整数</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: 選択されたメールボックスの全メッセージ</td></tr>
<tr><td>destinationBox</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メッセージの移動先のメールボックス</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>move処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-22"></a><a href="#説明-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.move()</code> 関数は、 <em>msgsIDs</em> または <em>allMsgs</em> で定義されたメッセージを IMAP サーバーの <em>destinationBox</em> へと移動します。</p>
<p>以下のものを渡すことができます:</p>
<ul>
<li><em>msgsIDs</em> には、移動するメッセージの固有ID を格納したコレクション</li>
<li><em>allMsgs</em> には、選択されているメールボックスの全メッセージを移動するための定数 (倍長整数型):</li>
</ul>
<p><em>destinationBox</em> には、メッセージの移動先メールボックスの名称をテキスト値で渡すことができます。</p>
<blockquote>
<p>RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a> に準拠している IMAPサーバーでのみ、この関数はサポートされます。</p>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-3"></a><a href="#例題-1-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<p>選択されたメッセージを移動します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// メッセージの固有IDのコレクションを取得します</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// カレントメールボックス内で見つかったメッセージを "documents" メールボックスに移動します</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-3"></a><a href="#例題-2-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>カレントメールボックスの全メッセージを移動します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// カレントメールボックスの全メッセージを "documents" メールボックスに移動します</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="numtoid"></a><a href="#numtoid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.numToID()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>startMsg</td><td>整数</td><td style="text-align:center">-&gt;</td><td>先頭メッセージのシーケンス番号</td></tr>
<tr><td>endMsg</td><td>整数</td><td style="text-align:center">-&gt;</td><td>最後のメッセージのシーケンス番号</td></tr>
<tr><td>戻り値</td><td>コレクション</td><td style="text-align:center">&lt;-</td><td>固有ID のコレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-23"></a><a href="#説明-23" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.numToID()</code> 関数は、現在選択されているメールボックスにおいて、 <em>startMsg</em> および <em>endMsg</em> で指定された連続した範囲のメッセージのシーケンス番号を IMAP固有IDへと変換します 。</p>
<p><em>startMsg</em> には、連続したレンジの最初のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最初のメッセージが連続レンジの先頭メッセージとして扱われます。</p>
<p><em>endMsg</em> には、連続レンジに含める最後のメッセージの番号に対応する <em>倍長整数</em> の値を渡します。 負の値 (<em>startMsg</em> &lt;= 0) を渡した場合、メールボックスの最後のメッセージが連続レンジの最終メッセージとして扱われます。</p>
<h4><a class="anchor" aria-hidden="true" id="戻り値-6"></a><a href="#戻り値-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>戻り値</h4>
<p>メソッドは文字列 (固有ID) のコレクションを返します。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-12"></a><a href="#例題-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">// メールボックスを選択します</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// 最も古い 5通のメッセージID を取得します</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)

  <span class="hljs-comment">// カレントメールボックスからメッセージを削除します</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="removeflags"></a><a href="#removeflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.removeFlags()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>文字列のコレクション: メッセージの固有ID (テキスト型)<br> テキスト: メッセージの固有ID<br> 倍長整数 (IMAP all): 選択されたメールボックス内の全メッセージ</td></tr>
<tr><td>keywords</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>削除するキーワードフラグ</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>removeFlags処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-24"></a><a href="#説明-24" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.removeFlags()</code> 関数は、 <code>msgIDs</code> のメッセージに対して、<code>keywords</code> で指定したフラグを削除します。</p>
<p><code>msgIDs</code> には、以下のいずれかを渡すことができます:</p>
<ul>
<li><p>指定するメッセージの固有ID を格納した <em>コレクション</em></p></li>
<li><p>単一のメッセージの固有ID (<em>テキスト</em>)</p></li>
<li><p>以下の定数 (<em>longint</em>) を使用することで、選択されているメールボックスの全メッセージを指定することができます:</p>
<table>
<thead>
<tr><th>定数</th><th>結果</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>選択されたメールボックスの全メッセージを選択します</td></tr>
</tbody>
</table>
</li>
</ul>
<p><code>keywords</code> には、<code>msgIDs</code> 引数で指定したメッセージから削除するフラグのキーワード値を格納したオブジェクトを渡します。 次のキーワードを渡すことができます:</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>ブール</td><td>メッセージの &quot;draft&quot; フラグを削除するには true</td></tr>
<tr><td>$seen</td><td>ブール</td><td>メッセージの &quot;seen&quot; フラグを削除するには true</td></tr>
<tr><td>$flagged</td><td>ブール</td><td>メッセージの &quot;flagged&quot; フラグを削除するには true</td></tr>
<tr><td>$answered</td><td>ブール</td><td>メッセージの &quot;answered&quot; フラグを削除するには true</td></tr>
<tr><td>$deleted</td><td>ブール</td><td>メッセージの &quot;deleted&quot; フラグを削除するには true</td></tr>
</tbody>
</table>
<p>false値は無視されます。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-13"></a><a href="#例題-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// transporter を作成します</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// メールボックスを選択します</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// INBOX の全メッセージを未読にします</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="renamebox"></a><a href="#renamebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.renameBox()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>currentName</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>カレントメールボックスの名称</td></tr>
<tr><td>newName</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>新しいメールボックス名</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>renameBox処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-25"></a><a href="#説明-25" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.renameBox()</code> 関数は、 IMAPサーバー上でメールボックスの名称を変更します。 存在しないメールボックスの名称を変更しようとしたり、すでに使われているメールボックス名に変更しようとしたりすると、エラーが生成されます。</p>
<p><code>currentName</code> には、名称変更するメールボックスの名前を渡します。</p>
<p>メールボックスの新しい名称は <code>newName</code> に渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-14"></a><a href="#例題-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>“Invoices” メールボックスを “Bills” に名称変更します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスワードを入力してください:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// メールボックスの名称変更</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"メールボックスの名称が変更されました。"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"エラー: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
 End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="port"></a><a href="#port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.port</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.port</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="説明-26"></a><a href="#説明-26" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.port</code> プロパティは、  メール通信に使用されるポート番号を格納します。 <code>SMTP New transporter</code> や <code>POP3 New transporter</code>、 <code>IMAP New transporter</code> のコマンドで <code>transporter</code> オブジェクトを作成する際に使用される <em>server</em> オブジェクトにおいて、 このプロパティが指定されなかった場合に使用されるポートは次のとおりです:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="searchmails"></a><a href="#searchmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.searchMails()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>searchCriteria</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>検索条件</td></tr>
<tr><td>戻り値</td><td>コレクション</td><td style="text-align:center">&lt;-</td><td>メッセージ番号のコレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-27"></a><a href="#説明-27" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<blockquote>
<p>この関数は、<a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">IMAP プロトコル</a> の仕様に基づいています。</p>
</blockquote>
<p><code>.searchMails()</code> 関数は、 カレントメールボックスにおいて <em>searchCriteria</em> の検索条件に合致するメッセージを検索します。 <em>searchCriteria</em> 引数には、一つ以上の検索キーを格納します。</p>
<p><em>searchCriteria</em> はテキスト型の引数で、一つ以上の検索キー (詳細は後述の <a href="#利用可能な検索キー">利用可能な検索キー</a> 参照) を格納し、検索する値を渡します (渡さない場合もあります)。 検索キーは単一または複数の項目からなります。 たとえば:</p>
<pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED
<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED
<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT
</code></pre>
<blockquote>
<p>文字の大小は通常区別されません。</p>
</blockquote>
<ul>
<li><em>searchCriteria</em> 引数が null 文字列の場合、検索は &quot;すべてを選択&quot; と同等です。</li>
<li>引数が複数の検索キーを格納している場合、それらすべてに合致する和集合 (AND) が検索結果になります。</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span>
</code></pre>
<p>... この検索結果は \Flagged フラグが設定されていて、かつ Smith から送られたメッセージをすべて返します。</p>
<ul>
<li><strong>OR</strong> および <strong>NOT</strong> 演算子を、以下のように使用することができます:</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED
</code></pre>
<p>... \Seen フラグが設定されている、あるいは \Flagged フラグが設定されているメッセージをすべて返します。</p>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN
</code></pre>
<p>... \Seen フラグが設定されていないメッセージをすべて返します。</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span>
</code></pre>
<p>... content-type ヘッダーが &quot;Mixed&quot; を格納しているもののうち、&quot;Text&quot; は格納していないメッセージを返します。</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"
</code></pre>
<p>... content-type ヘッダーが &quot;e&quot; を格納しているもののうち、Subject ヘッダーが &quot;o&quot;を格納していないもの、かつ content-type ヘッダーが&quot;Mixed&quot; でないメッセージを返します。</p>
<p>最後の 2例については、最初の検索キーリストのカッコを取り除いてしまうと検索結果が異なることに注意してください。</p>
<ul>
<li><em>searchCriteria</em> 引数には任意の [CHARSET] 指定を含めることができます。 これは &quot;CHARSET&quot; という単語の後に実際の文字コード [CHARSET] (US ASCII, ISO-8859 など) が続きます。 これは <em>searchCriteria</em> 文字列の文字コードを指定します。 そのため、[CHARSET] 指定を使用する場合には <em>searchCriteria</em> 文字列を指定された文字コードへと変換する必要があります (詳細については <code>CONVERT FROM TEXT</code> または <code>Convert to text</code> コマンドを参照ください)。 デフォルトでは、searchCriteria 引数に拡張された文字列が含まれていた場合には4D はそれを Quotable Printable へとエンコードします。</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span>
</code></pre>
<p>... これは、検索条件に iso-8859 文字コードを使用し、必要に応じてサーバーは検索前に検索条件をこの文字コードに変換しなければならない、ということを意味します。</p>
<h4><a class="anchor" aria-hidden="true" id="検索する値の型について"></a><a href="#検索する値の型について" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>検索する値の型について</h4>
<p>検索キーによっては、次の型の検索値が必要となる場合があります:</p>
<ul>
<li><p><strong>日付値の検索キー</strong>: date は日付を指定する文字列で、以下のようにフォーマットされている必要があります: <em>date-day+&quot;-&quot;+date-month+&quot;-&quot;+date-year</em>。ここでの date-day は日付の数値 (最大2桁) を意味し、date-month は月の名前 (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) を意味し、date-year は年 (4桁) を意味します。 例: <code>searchCriteria = SENTBEFORE 1-Feb-2000</code> (日付は特殊文字を含まないため、通常は引用符でくくる必要はありません)</p></li>
<li><p><strong>文字列値の検索キー</strong>: string はあらゆる文字列を含みうるため、引用符でくくらなければなりません。 文字列が特殊文字 (スペース文字など) をまったく含まない場合には、引用符で括る必要はありません。 このような文字列を引用符でくくることは、渡した文字列値が正確に解釈されることを保証します。 例: <code>searchCriteria = FROM &quot;SMITH&quot;</code><br /> 文字列を使用するすべての検索キーに対し、フィールドの文字列に検索キーが含まれる場合には検索に合致したとみなされます。 合致は文字の大小を区別しません。</p></li>
<li><p><strong>field-name 値の検索キー</strong>: field-name はヘッダーフィールドの名称です。 例: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li>
<li><p><strong>フラグ値の検索キー</strong>: flag は一つ以上のキーワードを (標準のフラグを含めて) 受け入れます。複数指定する場合にはスペースで区切ります。 例: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li>
<li><p><strong>メッセージセット値の検索キー</strong>: 複数のメッセージを識別します。 メッセージシーケンス番号は、1 から始まりメールボックスのメッセージの総数までの連続した番号です。 個別の番号はカンマで区切ります。コロンは、その前後の番号を含めた連続した番号を指定します。 例:<br /> <code>2,4:7,9,12:*</code> は、15通あるメールボックスの場合に <code>2,4,5,6,7,9,12,13,14,15</code> を指定します。 <code>searchCriteria = 1:5 ANSWERED</code> は、メッセージシーケンス番号 1 から 5番のメッセージのうち、\Answered フラグが設定されているメッセージを検索します。 <code>searchCriteria= 2,4 ANSWERED</code> は、メッセージセレクション (メッセージ番号 2番と4番) のうち、\Answered フラグが設定されているメッセージを検索します。</p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="利用可能な検索キー"></a><a href="#利用可能な検索キー" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>利用可能な検索キー</h4>
<p><strong>ALL</strong>: メールボックスの全メッセージ<br>
<strong>ANSWERED</strong>: \Answered フラグが設定されたメッセージ<br>
<strong>UNANSWERED</strong>: \Answered フラグが設定されていないメッセージ<br>
<strong>DELETED</strong>: \Deleted フラグが設定されたメッセージ<br>
<strong>UNDELETED</strong>: \Deleted フラグが設定されていないメッセージ<br>
<strong>DRAFT</strong>: \Draft フラグが設定されているメッセージ<br>
<strong>UNDRAFT</strong>: \Draft フラグが設定されていないメッセージ<br>
<strong>FLAGGED</strong>: \Flagged フラグが設定されているメッセージ<br>
<strong>UNFLAGGED</strong>: \Flagged フラグが設定されていないメッセージ<br>
<strong>RECENT</strong>: \Recent フラグが設定されているメッセージ<br>
<strong>OLD</strong>: \Recent フラグが設定されていないメッセージ<br>
<strong>SEEN</strong>: \Seen フラグが設定されているメッセージ<br>
<strong>UNSEEN</strong>: \Seen フラグが設定されていないメッセージ<br>
<strong>NEW</strong>: \Recent フラグが設定されているが \Seen フラグが設定されていないメッセージ。 これは機能的には “(RECENT UNSEEN)” と同じです。<br>
<strong>KEYWORD</strong> <flag>: 指定されたキーワードが設定されているメッセージ<br>
<strong>UNKEYWORD</strong> <flag>: 指定されたキーワードが設定されていないメッセージ<br>
<strong>BEFORE</strong> <date>: 内部の日付が指定日より前のメッセージ<br>
<strong>ON</strong> <date>: 内部の日付が指定日に合致するメッセージ<br>
<strong>SINCE</strong> <date>: 内部の日付が指定日より後のメッセージ<br>
<strong>SENTBEFORE</strong> <date>: 日付ヘッダーが指定日より前のメッセージ<br>
<strong>SENTON</strong> <date>: 日付ヘッダーが指定日に合致するメッセージ<br>
<strong>SENTSINCE</strong> <date>: 日付ヘッダーが指定日以降のメッセージ<br>
<strong>TO</strong> <string>: TO ヘッダーに指定文字列が含まれているメッセージ<br>
<strong>FROM</strong> <string>: FROM ヘッダーに指定文字列が含まれているメッセージ<br>
<strong>CC</strong> <string>: CC ヘッダーに指定文字列が含まれているメッセージ<br>
<strong>BCC</strong> <string>: BCC ヘッダーに指定文字列が含まれているメッセージ<br>
<strong>SUBJECT</strong> <string>: 件名ヘッダーに指定文字列が含まれているメッセージ<br>
<strong>BODY</strong> <string>: メッセージ本文に指定文字列が含まれているメッセージ<br>
<strong>TEXT</strong> <string>: ヘッダーまたはメッセージ本文に指定文字列が含まれているメッセージ<br>
<strong>HEADER</strong> &lt;field-name&gt; <string>: 指定フィールド名のヘッダーを持ち、そのフィールド内に指定文字列が含まれているメッセージ<br>
<strong>UID</strong> <message UID>: 指定された固有識別子に対応する固有識別子を持つメッセージ<br>
<strong>LARGER</strong> <n>: 指定バイト数以上のサイズを持つメッセージ<br>
<strong>SMALLER</strong> <n>: 指定バイト数以下のサイズを持つメッセージ<br>
<strong>NOT</strong> &lt;search-key&gt;: 指定検索キーに合致しないメッセージ<br>
<strong>OR</strong> &lt;search-key1&gt; &lt;search-key2&gt;: いずれかの検索キーに合致するメッセージ</p>
<h2><a class="anchor" aria-hidden="true" id="selectbox"></a><a href="#selectbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.selectBox()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メールボックスの名称</td></tr>
<tr><td>state</td><td>整数</td><td style="text-align:center">-&gt;</td><td>メールボックスのアクセス状態</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>boxInfo オブジェクト</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-28"></a><a href="#説明-28" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.selectBox()</code> 関数は、 <code>name</code> に指定したメールボックスをカレントメールボックスとして選択します。 この関数を使用するとメールボックスに関する情報を取得することができます。</p>
<blockquote>
<p>カレントメールボックスを変更せずに、メールボックスから情報を取得するには、<a href="#getboxinfo"><code>.getBoxInfo()</code></a> を使用します。</p>
</blockquote>
<p><code>name</code> には、アクセスするメールボックスの名前を渡します。 この名称は明確な左から右への階層を表し、特定の区切り文字でレベルを区分けします。 この区切り文字は <a href="#getdelimiter"><code>.getDelimiter()</code></a> 関数で調べることができます。</p>
<p>任意の <code>state</code> 引数を渡すと、メールボックスへのアクセスタイプを定義できます。 取りうる値は以下の通りです:</p>
<table>
<thead>
<tr><th>定数</th><th>結果</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>IMAP read only state</td><td>1</td><td>選択されたメールボックスは読み取り専用権限でアクセスされます。 新しいメッセージを表す &quot;新着&quot; フラグはそのまま変化しません。</td></tr>
<tr><td>IMAP read write state</td><td>0</td><td>選択されたメールボックスは読み書き可能権限でアクセスされます。 メッセージは &quot;既読&quot; と判断され、&quot;新着&quot; フラグは失われます。 (デフォルト値)</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>name 引数が存在しないメールボックスを指定した場合、関数はエラーを生成し <strong>Null</strong> を返します。</li>
<li>開いている接続がない場合、<code>.selectBox()</code> は接続を開きます。</li>
<li>接続が指定された時間 (<code>IMAP New transporter</code> 参照) 以上に使用されなかった場合には、<a href="#checkconnection"><code>.checkConnection()</code></a> 関数が自動的に呼び出されます。</li>
</ul>
</blockquote>
<p><strong>返されるオブジェクト</strong></p>
<p>返される <code>boxInfo</code> オブジェクトには、以下のプロパティが格納されています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td>メールボックスの名称</td></tr>
<tr><td>mailCount</td><td>number</td><td>メールボックス内のメッセージの数</td></tr>
<tr><td>mailRecent</td><td>number</td><td>&quot;recent&quot; フラグがついたメッセージの数</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-15"></a><a href="#例題-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object
 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">// 必須</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword">

 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="subscribe"></a><a href="#subscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.subscribe()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メールボックスの名称</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>subscribe処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-29"></a><a href="#説明-29" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.subscribe()</code> 関数は、 IMAPサーバーの購読メールボックスとして任意のメールボックスを追加・削除します。 利用可能なメールボックスが大量にある場合、すべてを取得するのを避けるため、確認したいメールボックスだけを購読することができます。</p>
<p><code>name</code> には、購読するメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-16"></a><a href="#例題-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>&quot;Bills&quot; 階層下の &quot;Atlas Corp” メールボックスを購読します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスワードを入力してください:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"メールボックスの購読に成功しました。"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"エラー: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="unsubscribe"></a><a href="#unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.unsubscribe()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>参照</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>テキスト</td><td style="text-align:center">-&gt;</td><td>メールボックスの名称</td></tr>
<tr><td>戻り値</td><td>オブジェクト</td><td style="text-align:center">&lt;-</td><td>unsubscribe処理のステータス</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-30"></a><a href="#説明-30" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.unsubscribe()</code> 関数は、 指定したメールボックスを購読メールボックスから削除します。 これにより、確認するメールボックスの数を減らせます。</p>
<p><code>name</code> には、購読を解除するメールボックスの名前を渡します。</p>
<p><strong>返されるオブジェクト</strong></p>
<p>この関数は、IMAP ステータスを表すオブジェクトを返します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>ブール</td><td>処理が正常に終わった場合には true、それ以外は false</td></tr>
<tr><td>statusText</td><td></td><td>テキスト</td><td>IMAPサーバーから返されたステータスメッセージ、または 4Dエラースタック内に返された最後のエラー</td></tr>
<tr><td>errors</td><td></td><td>コレクション</td><td>4Dエラースタック (IMAPサーバーレスポンスが受信できた場合には返されません)</td></tr>
<tr><td></td><td>[].errcode</td><td>数値</td><td>4Dエラーコード</td></tr>
<tr><td></td><td>[].message</td><td>テキスト</td><td>4Dエラーの詳細</td></tr>
<tr><td></td><td>[].componentSignature</td><td>テキスト</td><td>エラーを返した内部コンポーネントの署名</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-17"></a><a href="#例題-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>&quot;Bills&quot; 階層下の &quot;Atlas Corp” メールボックスの購読を解除します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスワードを入力してください:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"メールボックスの購読を解除しました。"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"エラー: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="user"></a><a href="#user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.user</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.user</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="説明-31"></a><a href="#説明-31" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.user</code> プロパティは、  メールサーバーでの認証に使用されたユーザー名を格納します。</p>
<style> h2 { background: #d9ebff;}</style>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ja/API/FunctionClass.html"><span class="arrow-prev">← </span><span>Formula</span></a><a class="docs-next button" href="/docs/ja/API/MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#imap-new-transporter">IMAP New transporter</a></li><li><a href="#4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#addflags">.addFlags()</a></li><li><a href="#append">.append()</a></li><li><a href="#authenticationmode">.authenticationMode</a></li><li><a href="#checkconnection">.checkConnection()</a></li><li><a href="#checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#connectiontimeout">.connectionTimeOut</a></li><li><a href="#copy">.copy()</a></li><li><a href="#createbox">.createBox()</a></li><li><a href="#delete">.delete()</a></li><li><a href="#deletebox">.deleteBox()</a></li><li><a href="#expunge">.expunge()</a></li><li><a href="#getboxinfo">.getBoxInfo()</a></li><li><a href="#getboxlist">.getBoxList()</a></li><li><a href="#getdelimiter">.getDelimiter()</a></li><li><a href="#getmail">.getMail()</a></li><li><a href="#getmails">.getMails()</a></li><li><a href="#getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#host">.host</a></li><li><a href="#logfile">.logFile</a></li><li><a href="#move">.move()</a></li><li><a href="#numtoid">.numToID()</a></li><li><a href="#removeflags">.removeFlags()</a></li><li><a href="#renamebox">.renameBox()</a></li><li><a href="#port">.port</a></li><li><a href="#searchmails">.searchMails()</a></li><li><a href="#selectbox">.selectBox()</a></li><li><a href="#subscribe">.subscribe()</a></li><li><a href="#unsubscribe">.unsubscribe()</a></li><li><a href="#user">.user</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2021 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ja","version:19 BETA"]}
              });
            </script></body></html>
