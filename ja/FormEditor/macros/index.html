<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-19-R8 plugin-docs plugin-id-default docs-doc-id-FormEditor/macros">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">フォームエディターマクロ | 4D Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://4d.github.io/docs/ja/FormEditor/macros"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="19-R8"><meta data-rh="true" name="docusaurus_tag" content="docs-default-19-R8"><meta data-rh="true" name="docsearch:version" content="19-R8"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-19-R8"><meta data-rh="true" property="og:title" content="フォームエディターマクロ | 4D Docs"><meta data-rh="true" name="description" content="4D のフォームエディターはマクロをサポートしています。 1つ以上のアクションを実行するための指示をマクロと呼びます。 呼び出されると、マクロは登録された指示を実行し、自動的に指定のアクションをおこないます。"><meta data-rh="true" property="og:description" content="4D のフォームエディターはマクロをサポートしています。 1つ以上のアクションを実行するための指示をマクロと呼びます。 呼び出されると、マクロは登録された指示を実行し、自動的に指定のアクションをおこないます。"><link data-rh="true" rel="icon" href="/docs/ja/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://4d.github.io/docs/ja/FormEditor/macros"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/FormEditor/macros" hreflang="en"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/fr/FormEditor/macros" hreflang="fr"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/es/FormEditor/macros" hreflang="es"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/ja/FormEditor/macros" hreflang="ja"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/pt/FormEditor/macros" hreflang="pt"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/FormEditor/macros" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJ04C0M3CU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/ja/opensearch.xml"><link rel="stylesheet" href="/docs/ja/assets/css/styles.6766d5fb.css">
<link rel="preload" href="/docs/ja/assets/js/runtime~main.0adf2639.js" as="script">
<link rel="preload" href="/docs/ja/assets/js/main.0ac862ff.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/ja/"><div class="navbar__logo"><img src="/docs/ja/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/ja/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">4D ドキュメンテーション</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/ja/GettingStarted/installation">v19 R8 BETA</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/ja/FormEditor/macros">v19 R8 BETA</a></li><li><a class="dropdown__link" href="/docs/ja/19-R7/FormEditor/macros">v19 R7</a></li><li><a class="dropdown__link" href="/docs/ja/19/FormEditor/macros">v19</a></li><li><a class="dropdown__link" href="/docs/ja/18/GettingStarted/installation">v18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/docs/FormEditor/macros" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/fr/FormEditor/macros" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/docs/es/FormEditor/macros" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs/ja/FormEditor/macros" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li><li><a href="/docs/pt/FormEditor/macros" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードとライトモードを切り替える (現在は ライトモード)" aria-label="ダークモードとライトモードを切り替える (現在は ライトモード)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="トップに戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/docs/ja/"><img src="/docs/ja/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/ja/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>4D ドキュメンテーション</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ja/GettingStarted/installation">はじめに</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ja/Project/overview">コア開発</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ja/ServerWindow/overview">管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ja/Extensions/overview">拡張機能</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ja/WebServer/overview">Web アプリ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/ja/Desktop/clientServer">デスクトップアプリ</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/Desktop/clientServer">クライアント/サーバー</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ja/FormEditor/forms">フォーム</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ja/FormEditor/forms">4D フォームについて</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ja/FormEditor/stylesheets">スタイルシート</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ja/FormEditor/pictures">ピクチャー</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ja/FormEditor/overview">フォームエディター</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ja/FormEditor/overview">フォームエディター</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ja/FormEditor/macros">フォームエディターマクロ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ja/FormEditor/objectLibrary">オブジェクトライブラリ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/FormEditor/jsonReference">フォームプロパティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/FormObjects/formObjectsOverview">フォームオブジェクト</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/FormObjects/propertiesReference">フォームオブジェクトプロパティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/Events/overview">フォームイベント</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/Menus/overview">メニュー</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/Desktop/user-settings">ユーザー設定</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ja/Desktop/building">アプリケーションビルド</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://developer.4d.com/go-mobile/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">モバイルアプリ</a></div></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリスト"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/docs/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">デスクトップアプリ</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">フォーム</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">フォームエディター</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">フォームエディターマクロ</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">バージョン: v19 R8 BETA</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページ上で</button></div><div class="theme-doc-markdown markdown"><header><h1>フォームエディターマクロ</h1></header><p>4D のフォームエディターはマクロをサポートしています。 1つ以上のアクションを実行するための指示をマクロと呼びます。 呼び出されると、マクロは登録された指示を実行し、自動的に指定のアクションをおこないます。</p><p>たとえば、定期レポートに特定のフォーマットが指定されている場合 (例: テキストによってフォントカラーが赤や緑であるなど)、マクロを作成してフォントカラーの設定を自動でおこなうことができます。 4Dフォームエディターのマクロでは、次のことがおこなえます:</p><ul><li>4Dコードを作成・実行する</li><li>ダイアログを表示する</li><li>オブジェクトを選択する</li><li>フォームやフォームオブジェクトおよびそれらのプロパティを追加・編集・削除する</li><li>プロジェクトファイルを編集する (更新・削除)</li></ul><p>フォームエディター用のカスタム機能を定義するため、マクロコードは <a href="/docs/ja/Concepts/classes">クラス関数</a> と <a href="/docs/ja/FormObjects/propertiesReference">JSON のフォームオブジェクトプロパティ</a> を使用できます。</p><p>ホストプロジェクトおよび、プロジェクト内のコンポーネントにてマクロを定義することができます。 通常は開発用のコンポーネントにマクロをインストールして使用します。</p><p>マクロが呼び出されると、指定されている既存の動作はマクロによってオーバーライドされます。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例題">例題<a href="#例題" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p>フォームの左上に &quot;Hello World&quot; アラートボタンを追加するマクロを作成します。</p><ol><li>プロジェクトの <code>Sources</code> フォルダー内に配置された <code>formMacros.json</code> ファイルに、次のように書きます:</li></ol><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;macros&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;Add Hello World button&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AddButton&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><p>次に、<code>AddButton</code> という名前の 4Dクラスを作成します。</p></li><li><p><code>AddButton</code> クラスに次の関数を定義します:</p></li></ol><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Function onInvoke($editor : Object)-&gt;$result : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var $btnHello : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // &quot;Hello&quot; ボタンを作成します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $btnHello:=New object(&quot;type&quot;; &quot;button&quot;; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;text&quot;; &quot;Hello World!&quot;; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;method&quot;; New object(&quot;source&quot;; &quot;ALERT(\&quot;Hello World!\&quot;)&quot;); \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;events&quot;; New collection(&quot;onClick&quot;); \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;width&quot;; 120; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;height&quot;; 20; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;top&quot;; 0; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;left&quot;; 0)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 現在のページにボタンを追加します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $editor.editor.currentPage.objects.btnHello:=$btnHello  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // フォームエディター上で新規作成したボタンを選択します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $editor.editor.currentSelection.clear() //unselect elements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $editor.editor.currentSelection.push(&quot;btnHello&quot;)    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4D に変更内容を通知します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=New object(&quot;currentSelection&quot;; $editor.editor.currentSelection;\  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;currentPage&quot;; $editor.editor.currentPage)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>マクロを呼び出します: <img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY8AAADICAYAAAAQsG2HAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAABSbSURBVHhe7d2/69xG/sfx/S9Sf6tNaXAVCE4RAuHbRKSIr0x86UJ812VxDP4GLsbct/HXRVIkRdYcBJtcedd8wEcgEC/kXKSwwXDf/DK2iRM7pMiVc3rPaKSZ0Uif1Vq7s6N9Fg8+H2mkkfbD6P1ajezd2S+//KIAABiC8AAADEZ4AAAGIzwAAIMRHgCAwQgPAMBghAcAYDDCAwAw2Frh8dVXXwF7JTZOAezO2uHx66+/AnuB8ADSIzyQHcIDSG9weFy++dtWxI4r3KIBCMIDSI/wQHYIDyA9wgPZkfF479499fDhQ/Xo0SP1+PFj9eTJk+j4AbAdhAeyI+NR3L59W/3www86QAgPYLcID2RHxuO1a9fU0dGRDpAHDx7ou4/Y+AGwHYQHsiPj8cqVKzpA5HeZwiI8gN3aaXhc+Ozr6HoRO65wi4axVMVspma1uVqswm32mZx/5JxXCzXP7rWkIePx0qVL6urVq+rmzZt66urnn3+Ojh8A27Gz8HjtrfPq5MmT6k9/+1e0PXZc4RYNwy++q8VczeYLtWpttwsdQdBrk33EpvtNj4zHixcvquVySXgAiewkPGxwvH35s2i7iB1XuEXDCItoyqJKeKRAeADpjRYeMiUVm5ZaJzhE7LjCLRpGX3iY34uivBuZFWop7Xo6qJnmKpbBfsumfb5YVW3hflVfXv9Nn1qxUIu5239pWUTuisLzj61f6b5s30VZJL2pumIZ7HtYCA8gvdHCo3jjD+q551/wAmTd4BCx4wq3aBh+8fWnrUyRbULALNcF3XuuUBVku2+rzSnwZQiYPmP9+9u5hX1ZBGGiBfvE1gf9tNq99YeH8ADSGy08/nzjR/XSK6frABkSHCJ2XOEWDcMU8PpdeH1XYNucAqsDwW13C3q7GNdtwd2Kpot5uE9s2R6v/D36LKZ93Nb66vjenVDnfoeH8ADSG/WZhw0QCY0hwSFixxVu0TD6imjQNig8zFRREx7+fka4T/tc5E5Iir792exrdZ1/vC8Jrq6wO1SEB5De6A/MbYAMCQ4RO65wi4bRV0TDNlm2xbfkhYJpqwt8X1st1n9wLtLPvCjvOtY9x/71TQh17Xd4CA8gvdHDY1Ox4wq3aBh9RbSjmJdBIO/g/f8TYrZ1H37XIdParxSdtjJ3Mk27s671zMKSPqp9Kq1wkGcedXtR3wHFjnWICA8gvQzDYyyRoBlJMzWGbSA8gPQIj7HDQ09bpfpPi4eB8ADSIzxGCw/7fzO2czeDBuEBpHfA4YFcER5AeoQHskN4AOkRHsgO4QGkR3ggO4QHkN7g8Ii1b5NbNABBeADpER7IDuEBpEd4IDuEB5Ae4YHsEB5AeoQHskN4AOkRHsgO4QGkl2F4dH0qbbjdNlTH7vhUW/P9G0M/nmSsj0nZ0md17SHCA0gv0/BIVSTNsefR7+qoguXYcwvPf6zXk/LvsluEB5Ae4TGIObZ8B0jrbkd/73ixxrkRHk+L8ADSm1Z4BF/g1HynRlP0zZcrVX0sm+1lW/u1ryI+FWaPLT+lH7tePlHXrnfOzTsf2V7a7XLJ/YIp51y8Y3e+Jr9tvlj4x54wwgNIbxLPPExBNevr4qoLqy2mpq0pylUf9ns3qm/uq9v1cuGEg1UV+rJP7wuf5Fi6r6bd3db2afoP1kfPxR7btPW9Jtu22fOWPBEeQHrTufPQhdUv+E2BjxXsIcuR9XVgdBxHn48fct6dxjrH7ntNzvHj/UwX4QGkR3istRxbX01VyXRTXcSd9sj5tPs4ZpnwiCI8gPQm9MxD1tuwKHmFt6dAr7XcsT6c7vLa5ffg+UWsj95l00f3a2ramLYiPIBdmvAD83UL9DrLXevl7sO9MwjavfOx01bm7qFZPubYna+pVIWX4IE54QHsUobhgUNHeADpER7IDuEBpEd4IDuEB5Ae4YHsEB5AeoQHskN4AOkRHsgO4QGkR3ggO4QHkB7hgewQHkB6hAeyQ3gA6REeyA7hAaRHeCA7hAeQHuGB7BAeQHqEB7JDeADpZRwe8om29tNmS953W+wH+fTc1keyyyfhyqfp6k/LPYxPwR0b4QGkl2d4VB9TXn/PRbVu4S7vTNfHt5dsUDjrmi+oOly3bt1Sp0+fVvfv34+2H4fwANLLMDzMHcf+FOCe8NAhVwTf9+EuH65z585tHCCEB5BefuHRKsihvi9XMr8XhXzrnvQRLpfbVHc1M80ep+pj4X75kkxHyXq7bSm4y2gFnXcn4p5XKXJc/y4lsn3reHnZNEAIDyC9PMOj9/lGUGS9ZVPs/a+NDZedfcti74WELdb6G/xMgW/tE5Cvh7X9d4dBx3HdsJF186Yvt9+cnTlzRp09ezba1oXwANI7yDuPeFvJe/df0cV7SJ+BOuzkLqSjj67jOkG5LO+OFsuuvvJ0/fp1derUKf0MJNbehfAA0pvgM48hhT5Y7gymIX2GqkJfF3673tmv87g2JMpt69Aot3NCxd8+H5sGhyA8gPQyDI+SnjYKAqQsqOZfWwXhorftKvSx5cg/r+3dL2xrkykmOV+/37CP2HGr6alguqoo7HSav20uJDA2DQ5BeADp5RkeQr9bd6Z53HfiVbhoZaHtLvSRwh/2e+y0lXmW0Wxrt3HoPoPjhH1Gj2vXh9uFfeXn7t270fXrIDyA9PINDxwswgNIj/BAdggPID3CA9khPID0CA9kh/AA0iM8kB3CA0iP8EB2CA8gPcID2SE8gPQID2SH8ADSIzyQHcIDSI/wQHYIDyC9vQ+PO3fuABrhAewP7jyQHcIDSI/wQHYIDyA9wgPZITyA9AgPZIfwANIjPJAdwgNIj/BAdggPID3CA9khPID0CA9kh/AA0iM8kB3CA0gvw/BYqmI2U7PaXC1W4TaYMsIDSC/T8GgCY7WYq9l8oVat7Y7j94N8EB5AetmHx+YhQHjkivAA0ptceCwLZ0qrWFbbrNRi3qwvyqLjTX3Z7VYLNa/XF2qp98W+ITyA9CY8beVstyycIIm0x5bLfeaLVdWGfUJ4AOlN4IF5cIcgQVG3VWFQ3VH4YRCEhXfXUWkFDvYB4QGkN4FpK4cOgKIKE5mq8rfTdyllKBRLWY6Fh90X+4zwANKbVnjIXYedwtJh0N5OAsTcgYT9yHJ4d4J9RHgA6U0rPNwH4/NCFfbOw5vKau4u6ofr0QfmznrsFcIDSC/D8MChIzyA9AgPZIfwANIjPJAdwgNIj/BAdggPID3CA9khPID0CA9kh/AA0iM8kB3CA0iP8EB2CA8gPcID2SE8gPQID2SH8ADS2/vwuHPnDqARHsD+4M4D2SE8gPQID2SH8ADSIzyQHcIDSG9weFy++dtWxI4r3KIBCMIDSI/wQHYIDyA9wgPZITyA9AgPZIfwANIjPJAdwgNIj/BAdggPIL2dhseFz76Orhex4wq3aBhLVcxmalYsI22/qtVirmazuVqs2m07s1qo+SbnoPcrX5s1X6hV53Zd/cvfJ/Hr3zLCA0hvZ+Hx2lvn1cmTJ9Wf/vavaHvsuMItGoYpjvN5rEBWwbLz4jlCwY4EwrIo1NLdZi2EB4Dt20l42OB4+/Jn0XYRO65wi4ZhimNRlAGyWPlty6K8IykSFM+nLdgrtZjPVLGMtQ1FeADYvtHCQ6akYtNS6wSHiB1XuEXDsMVRfrrvzKUA2/VN8VwWzjSQO9XlTBHNFwtnn2r/RRlEdbsTUt7UUlEeX7a3yyV9DP8cbDjYbVohofuUvoL1NdOfBGZzTKf/ztcyTYQHkN5o4VG88Qf13PMveAGybnCI2HGFWzSMpnBKMNSFWAqofkYQFm7LXS+/N/v6z0lMWx00cjdTF/ag77LNBEt4THfZBEfrLslVn7tZNucjYeCfU9OH279pi7+WaSI8gPRGC48/3/hRvfTK6TpAhgSHiB1XuEXDcAqnU3SbIHELa0kXf/uuv71fq89w//B4dV+V6J1GuE/Rc1dRim4z4Jw6X8s0ER5AeqM+87ABIqExJDhE7LjCLRqGWxyrqaqlW0CDwloXZTutVa3fODxiQbDJPq5w/3DdMf0THoQHsGOjPzC3ATIkOETsuMItGkZQHKs7i+iUjrTZwqqLuN1PtumbtnKLr7ts9mtPQfXts8a0Vcmcgxsy4XH7z4lpK8ID2KXRw2NTseMKt2gYYSGV4txVdE3hlnCZldsU7j/vdaazog/M6/6DZR1CVZ+iejZSP5jvnMZq9rGFvsWbYut6xhFZ7nwt00R4AOllGB5bsNbUEvYF4QGkR3iU9F2D99wA+4zwANI70PBwprM07jpyQngA6XHngewQHkB6hAeyQ3gA6REeyA7hAaRHeCA7hAeQ3uDwiLVvk1s0AEF4AOkRHsgO4QGkR3ggO4QHkB7hgewQHkB6hAeyQ3gA6REeyA7hAaSXYXj4n1ArvI879z56fajw02uxjwgPIL1MwyP8ePIyROzXxj4VwmMXbt26pU6fPq3u378fbT8O4QGkN4HwKI32keqEx66cO3du4wAhPID0phEe1afktr/D3P/0XK9dvrq2Ne3l911/wZPQdzbucSrutxVikE0DhPAA0pt2eEhhb01nSXsZBp1fTxv2HawP+pSA6fxmQBzrzJkz6uzZs9G2LoQHkN6EwiMSANVXxvrfH97evwmAoM37Wli3/6KaIit/565jY9evX1enTp3Sz0Bi7V0IDyC9CT7zaLevFnMdANGA6Lpr8fp0w8n0J4Fkf9rjYH2bBocgPID0JhAesuxOHbXDQzSF3mxfF/2u4HGfZXhTW9XyvCjvOtrHwfEkMDYNDkF4AOllGh52KsmdTnLbnQCot/MDoijM3YiIB4+5I9HbRIJCP0wf5Z8HH6a7d+9G16+D8ADSyzA8npYbEJvjQXk6hAeQHuGxCT1txYPyVAgPID3CYxA7lfX0dy7YHOEBpHeA4YHcER5AeoQH9pqMPQDbE6u76yA8sNfcsQdgXIQHJovwALZnp+Fx+eZvO/V/q3/jgDH2gPHZa4rwwGQx9oDx2WuK8MBkMfaA8dlrSq6ve/fuqYcPH6pHjx6px48fqydPnkRzIER4YK8x9oDx2WtKri9x+/Zt/U/eJUAID0wCYw8Yn72m5Pq6du2aOjo60gHy4MEDffcRy4EQ4YG9xtgDxmevKbm+rly5ogNEfpcprAmHx1/UCfmk2xf/Emn7t1q8+ayazZ5VL3/abkN+9jU8Xn+xeww2ZKx2jcWutqHrXe4262zvk9d04qK7LtLHxVfXeN2hvnPpaht+/lifvabk+rp06ZK6evXq4E9ryDQ8nlXP/FfXgJPPnmLQ7bP/+evX6qVXfqf+9x8/Rttdexken75bjr9X1YnoGHSNWTT7+rLcbdbZPhAGg7zO8np65s1/1uvkzZm7vJ6+c3ma1xsT7rdpP9Nmrym5vjb9qJ9sw+PEi5FBrAd/eVEzWPbea2+dXytA9jE8bAE9vpD2Fa6utqHrXe4262wf0KH4rlpUy/L6TrxZrqsD5Z/q5WMDM6bvXJ7m9caE+23az7TZa+ogw+PlT+Xnq+r1er0d2P5g0dML+m4knGaQ7Zs2c7tu9pVgmtm+q3df/nZd+2OIdQJk/8LDKaBBsdWc8fJMWXi9wtXXVusqdsF6b1za68Ddpm/7rvHqhoN7Pbn9O9dcZ5/m2M111H0ux/4dLrrb2qAO+quX5WdzPuaNpLtcXf/HnPfLb5ZvQqu24XdZebDX1IGGRzBHKwNCX8jhwLLc9abwtweGGXz+IA2OYfvYaO4Xof/+3e9V8cYfo21i78KjHmey7BZb4Y8X//lbX5vLbGeLl8/ty9m3HItmzLrrw987xrF3bPeaKvepXufrZQjobb0x39enaYsXe3+/Y/8O9m/d6t/dJ+y/q80u9593/Rrl9bphOSH2mjrY8HAvZG/Qu4NFD4Dg4tMDJjYogn0j29XH0W3TfWeyC29f/qt67vkX9DOQWLvYt/AIp6p08XPf0dbBIuJjtdVWr1tzfTX2vGDR5+DuG27fMY6ddZoNCCco7Gv2Xntvn+FrCM5lw7/DWv33tpU2PW9n+ymw19Thhod95ye3tvWAdNq9geK8S4wMoHbfpd6BZph3Th0XIjqtExxi/8ZeULS1aoz0Fca+tnrdmuvXGr/923eGR3Wer5fjum6XdS++699l9fYZvobgXDb6O5jZgmP7720rbXrezvZTYK+pAw6PUnVnEb1FljY7UPWgsfv1TVuFg8e5yCIDT4TvRtFPAmOd4BB7Nfbc8VQLi1ozXswbCzue+tpc4RiMrTd99Y/f9vbHjWPDvB7/3Mz+/hROX5/uscNlf7/+v4PzGr3+3b95SdcAt/+uY9vlTc57Wuw1ddjhoQdSOKhtu70QSq1/WmkGkX33aAZTZLDowWW3c9qq0DLc42Md7//9/6PrQ/s09uQdauxNgi6A3jy5GReth8F9bbWughWs98ZlqW/aqrV9rP+Gfj1BSMprr1+j1dln+BqC5QF/B/PQ3WxbF/ygj/BfWOpz1evN+YbLG5/3hNhr6sDCA4eEsQeMz15ThAcmi7EHjM9eU4QHJouxB4zPXlOEByaLsQeMz15ThAcmi7EHjM9eU4QHJouxB4zPXlOEByaLsQeMz15TOw0PYJcYe8D2EB6YLMYesD07CQ8AwPRsNTxi5Ltu5cDy3bfyHbjyVYZyEsC2XbhwQZ0/f1698847+ud7772n3n///ei2APpt9TvMYx4+fKhu376tjo6O9IHlO3AlvYBt++ijj9QHH3ygB/2HH36oPv74Y/XJJ59EtwXQT+q31HGp5w8ePNh+eDx69Ejf4sgBJbHklgfYhS+++EJ9/vnn6saNG/qnLH/55ZfRbQH0k/otdVzqudT1J0+eRGt+aOPwkHSSA0lSya2OHBjYhe+++059++236ptvvtFk+fvvv49uC6Cf1G+ZSZJ6LnV96+EhBxByMCEPWYBd+Omnn6I/AQxna7it6bF6H7NxeAAADhfhAQAYjPAAAAxGeAAABiM8AACDER4AgMEIDwDAYIQHAGAwwgMAMBjhAQAYjPAAAAxGeAAABiM8AAAD/aL+Ax2mKNiNOHf/AAAAAElFTkSuQmCC" width="399" height="200" class="img_ev3q"> <img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJ4AAABACAYAAADrsc4kAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAT1SURBVHhe7ZsxixRJFMc78ZMczCcQzYyEE/sCDfwIBgbiTXKCsSAHiiA4MMFhaLQccpeNIKK3iJool2y4xyl6G7gowm7gvutX09Xz6vWrtseZnppp/w0/Zrrm1Zsq6rdV1VqTjcdjAmDVQDyQBIgHkgDxQBIgHkiCKd5vd+/S5MoV+vvcOfrn1Cl6d/Kke+V7LufPrXoAtKUm3p9XrzrJ3h8/HoU/5zhdF4C2BOI9unTJFC0Gx8v6ALSlEo9nMJZpL8/p8Nkz+vLpEx1sb9PemTM14SSY+cC34MTjPZtfXlm6NpcXj+thzwfmxYnHDwxepC+fP5dqTa+jg4PqMw9f8p7r68QANOHE46dVL9HhixdOLH8dPn8eSPb+xAlXzq++jOvrxJvK9luiX18SXXxINH59ZMb0iVT9deLJp1i3xyvl41e+958xH2/dcp99vHmzKuP6OvEmwoPw82Oinx4Q/XDviI7dIbr2VzEgRmwfSNlfJx7/O52Ui+FLl+2dPVstxfzK91zO9XXiTYT/8n/8fTYI2fX/3KsV2wdS9rc24x08ferE8hffc3mWZQC0Roumqe3xrMuLJ2P8e2bnwgXa2traeHiP4//ys19eUXb5sVuGrNg+EOvv/v7+QrQWTz7Vxi5OJi8p3psix+7ubi/gPY4bjBsf6PwfZMb0Cd1fS6R5aS2e/Hc86+JyOeNJ3p0+Tbs7O2anwPrDM58lzyK0Fo/x/3NR2+M9eeLKY+L9e/++2SGwGSQXj2n6v1pLvDe3b5udWZwR5dmAhpO25RIZ0yY+ZJRnlI9kmZFjlFOWj0RMG5raotuc06gW0w1rIR4TO50ixePltduZLjZITYPn0YP4tXiFlmoypEHR98FwUpVNhoPgvh1NbdFt/g7FY6zzeJyMn17dg0Tne7rYILURSQ/i1+IVLNpgSJPyniXLh0VZJeOEhoM5czqa2qLb/J2KZ8HJuJFW45dPbJBUeTkbcduyarD0IMbi9ZLqkWL591IG+b4gmnP63Xk+KNsWb8ugEDtsM8Sr4GSrFW82mCFygMRAFkvkdPmT5fq9EMMNvKgvmO3zijrl7DcqBHKxwVLclHP62WxJjreFZ9WgX2LG7RqIFyAHKVKuZhqHE0IPsIwPZ5L6g0SJl0tI5vd1wf6uMafug2pLIJeMLWbZHOJVrKd41pIk6zbHR8UrxRjx/k7OZoUQwf6uMafug2pLVLzVAvECYgMhy/l9+LRpx4TxgUimuAzv7eSyzkzrz/aSszI7p/xufR/Wqy210XYtH4gXoActUu4GuuVSW4u38s9wMqi9Fs9ms/1dSTSn7oO652W8rIeHiwY42erEA6sC4oEkQDyQhLUVz5/Jd8leH5mN7xP6NwhWTJ/Q/bVEmpeFxZNn8jkZn9vi81v8V9JHYr9BsGL7QKy/lkzzsLB48kw+J/Nn8q0v6wOx3yBYsX2gq/4uLB5Pv1WjWDw+Hn3jg/llfSDorz8Ojv7OzcLiBWfyWbwlnclfV7r6DcK60lV/FxevoDqTXyRb1pn8daaL3yCsM130dynieTiZ9SUAaCAeSALEA0mAeCAJEA8kAeKBJEA8kASIB5IA8UASIB5IAsQDSYB4IAkQDyQB4oEkQDyQBIgHkrB08QBoi+WQpLV4ACwTiAeSAPFAEiAeSALEA0mAeCAJEA8kAeKBJEA8kASIBxIwpv8BX+lYcYVry+cAAAAASUVORK5CYII=" width="158" height="64" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="フォームエディターでマクロを呼び出す">フォームエディターでマクロを呼び出す<a href="#フォームエディターでマクロを呼び出す" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p>4Dプロジェクトにマクロが定義されていると、フォームエディターのコンテキストメニューを使ってマクロを呼び出すことができます:</p><p><img loading="lazy" src="/docs/ja/assets/images/macroSelect-236540cd38c3b4cff8386601ab80700a.png" width="589" height="394" class="img_ev3q"></p><p>このメニューは <code>formMacros.json</code> <a href="#%E3%83%9E%E3%82%AF%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%A0%B4%E6%89%80">マクロ定義ファイル</a> をもとに作成されています。 マクロメニュー項目は ABC順に表示されます。</p><p>このメニューは、フォームエディター内で右クリックにより開くことができます。 選択オブジェクトがある状態や、フォームオブジェクトの上でマクロを呼び出した場合は、それらのオブジェクト名がマクロの <a href="#oninvoke"><code>onInvoke</code></a> 関数の <code>$editor.currentSelection</code> や <code>$editor.target</code> パラメーターに受け渡されます。</p><p>1つのマクロによって複数の処理を実行することができます。 マクロで実行した処理は、フォームエディターの <strong>取り消し</strong> 機能でもとに戻すことができます。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="マクロファイルの場所">マクロファイルの場所<a href="#マクロファイルの場所" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p>4Dフォームエディターマクロは、プロジェクトあるいはコンポーネントごとに 1つの JSONファイルによって定義されます: <code>FormMacros.json</code>。</p><p>このファイルは、ホストまたはコンポーネントプロジェクトの <strong>Project</strong> &gt; <strong>Sources</strong> フィルダーに配置しなければなりません:</p><p><img loading="lazy" src="data:image/png;base64,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" width="233" height="256" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="マクロの宣言">マクロの宣言<a href="#マクロの宣言" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p><code>formMacros.json</code> ファイルの構造は次の通りです:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;macros&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">macroName</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">className</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">customProperty</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>JSONファイルの説明です:</p><table><thead><tr><th>属性</th><th></th><th></th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>macros</td><td></td><td></td><td>object</td><td>定義されたマクロのリスト</td></tr><tr><td></td><td><code>&lt;macroName&gt;</code></td><td></td><td>object</td><td>マクロ定義</td></tr><tr><td></td><td></td><td>class</td><td>string</td><td>マクロクラス名</td></tr><tr><td></td><td></td><td><code>&lt;customProperty&gt;</code></td><td>any</td><td>(任意) コンストラクターによって取得するカスタム値</td></tr></tbody></table><p>カスタムプロパティはマクロの <a href="#class-constructor">constructor</a> 関数に受け渡されます。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例題-1">例題<a href="#例題-1" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h3><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;macros&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token string-property property" style="color:#36acaa">&quot;Open Macros file&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OpenMacro&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token string-property property" style="color:#36acaa">&quot;Align to Right on Target Object&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AlignOnTarget&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;myParam&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;right&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token string-property property" style="color:#36acaa">&quot;Align to Left on Target Object&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AlignOnTarget&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;myParam&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;left&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="マクロのインスタンス化">マクロのインスタンス化<a href="#マクロのインスタンス化" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p>プロジェクトおよびコンポーネントにおいてインスタンス化するマクロは、それぞれ <a href="/docs/ja/Concepts/classes">4Dクラス</a> として宣言する必要があります。</p><p>クラスの名称は、<code>formMacros.json</code> ファイルで <a href="#%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%AE%E5%AE%A3%E8%A8%80">class</a> 属性に定義した名前と同一でなくてはなりません。</p><p>マクロは、アプリケーションの起動時にインスタンス化されます。 そのため、関数の追加やパラメーターの編集など、マクロクラスになんらかの変更を加えた場合には、それらを反映するにはアプリケーションを再起動する必要があります。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="マクロ関数">マクロ関数<a href="#マクロ関数" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h2><p>マクロクラスは、1つの <code>Class constructor</code> のほかに、<code>onInvoke()</code> および <code>onError()</code> という 2つの関数を持つことができます。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="class-constructor">Class constructor<a href="#class-constructor" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="class-constructormacro--object">Class constructor($macro : Object)<a href="#class-constructormacro--object" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><table><thead><tr><th>引数</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>$macro</td><td>Object</td><td><code>formMacros.json</code> ファイルのマクロ宣言オブジェクト</td></tr></tbody></table><p><a href="/docs/ja/Concepts/classes#class-constructor">Class constructor</a> 関数が定義されている場合、マクロはそれによってインスタンス化されます。</p><p>アプリケーションの起動時にクラスがインスタンス化される際に、このコンストラクターが呼び出されます。</p><p><a href="#%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%AE%E5%AE%A3%E8%A8%80">マクロの宣言</a> に追加したカスタムプロパティは、クラスコンストラクターが引数として受け取ります。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例題-2">例題<a href="#例題-2" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><p><code>formMacros.json</code> ファイルに次のようなマクロ宣言をした場合:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;macros&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token string-property property" style="color:#36acaa">&quot;最後に選択したオブジェクトを基準に左揃え&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;class&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AlignOnTarget&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token string-property property" style="color:#36acaa">&quot;myParam&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;left&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以下のように書くことができます:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// クラス &quot;AlignOnTarget&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class constructor($macro : Object)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This.myParameter:=$macro.myParam // left    ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="oninvoke">onInvoke()<a href="#oninvoke" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="oninvokeeditor--object---result--object">onInvoke($editor : Object) -&gt; $result : Object<a href="#oninvokeeditor--object---result--object" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><table><thead><tr><th>引数</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>$editor</td><td>Object</td><td>フォームプロパティを格納する Form Editor Macro Proxy オブジェクト</td></tr><tr><td>$result</td><td>Object</td><td>マクロによって変更されたフォームプロパティ (任意)</td></tr></tbody></table><p>マクロが呼び出されるたびに、<code>onInvoke</code> 関数が自動的に実行されます。</p><p>呼び出しの際、関数は <code>$editor.editor</code> プロパティに、フォームの全要素とそれらの現在値のコピーを受け取ります。 つまり、これらのプロパティに対して、任意の処理を実行することができます。</p><p>マクロによってオブジェクトを変更・追加・削除した場合、操作を反映させるには最後に結果のプロパティを <code>$result</code> に返します。 返されたプロパティは解析され、フォームに対して変更が適用されます。 戻り値に含まれるプロパティが少ないほど、この処理にかかる時間も削減されます。</p><p><em>$editor</em> 引数にて渡されるプロパティは次の通りです:</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>$editor.editor.form</td><td>Object</td><td>フォーム全体</td></tr><tr><td>$editor.editor.file</td><td>File</td><td>フォームファイルの Fileオブジェクト</td></tr><tr><td>$editor.editor.name</td><td>String</td><td>フォームの名称</td></tr><tr><td>$editor.editor.table</td><td>number</td><td>フォームのテーブル番号。プロジェクトフォームの場合は 0。</td></tr><tr><td>$editor.editor.currentPageNumber</td><td>number</td><td>現在のページの番号</td></tr><tr><td>$editor.editor.currentPage</td><td>Object</td><td>現在のページ (フォームオブジェクトおよび入力順序を格納)</td></tr><tr><td>$editor.editor.currentSelection</td><td>Collection</td><td>選択されているオブジェクトの名称のコレクション</td></tr><tr><td>$editor.editor.formProperties</td><td>Object</td><td>カレントフォームのプロパティ</td></tr><tr><td>$editor.editor.target</td><td>string</td><td>マクロ呼び出し時にマウスカーソルが置かれているオブジェクトの名称</td></tr></tbody></table><p>マクロによる変更をフォームに反映させたい場合に、<code>$result</code> オブジェクトに渡せるプロパティの一覧です。 いずれのプロパティも任意です:</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>currentPage</td><td>Object</td><td>マクロによって変更されたオブジェクトを含む currentPage</td></tr><tr><td>currentSelection</td><td>Collection</td><td>マクロによって変更された currentSelection</td></tr><tr><td>formProperties</td><td>Object</td><td>マクロによって変更された formProperties</td></tr><tr><td>editor.groups</td><td>Object</td><td>マクロによって変更されたグループ情報</td></tr><tr><td>editor.views</td><td>Object</td><td>マクロによって変更されたビュー情報</td></tr><tr><td>editor.activeView</td><td>String</td><td>有効なビュー名</td></tr></tbody></table><p>たとえば、currentPage と editor.groups の内容が変わった場合には、戻り値を次のように設定します:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=New object(&quot;currentPage&quot;; $editor.editor.currentPage ; \ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;editor&quot;; New object(&quot;groups&quot;; $editor.editor.form.editor.groups))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="method-属性"><code>method</code> 属性<a href="#method-属性" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><p>フォームオブジェクトの <code>method</code> 属性を操作する場合、属性値は2通りの方法で定義できます:</p><ul><li><p><a href="/docs/ja/FormObjects/propertiesAction#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89">メソッドファイル名あるいはパスを指定する文字列</a> の使用</p></li><li><p>次の構造を持つオブジェクトの使用:</p></li></ul><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td>source</td><td>文字列</td><td>メソッドコード</td></tr></tbody></table><p>後者の場合、4D は &quot;objectMethods&quot; フォルダー内に当該オブジェクト名を冠したファイルを作成し、<code>source</code> 属性に指定したメソッドコードを格納します。 この機能はマクロコードの場合にのみ有効です。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="currentpageobjects-の-4did-プロパティ"><code>currentPage.objects</code> の <code>$4dId</code> プロパティ<a href="#currentpageobjects-の-4did-プロパティ" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><p><code>$4dId</code> プロパティは、現在のページにある各オブジェクトについて一意のIDを定義します。 このキーは<code>$result.currentPage</code> の変更を反映させるのに使用されます:</p><ul><li>フォーム上および <code>$result</code> 内のオブジェクトの両方で <code>$4dId</code> キーが存在しない場合、そのオブジェクトは作成されます。</li><li>フォーム上で存在する <code>$4dId</code> キーが、<code>$result</code> 内には存在しない場合、当該オブジェクトは削除されます。</li><li>フォーム上および <code>$result</code> 内のオブジェクトの両方で <code>$4dId</code> キーが存在する場合、そのオブジェクトは変更されます。</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例題-3">例題<a href="#例題-3" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><p>選択されているオブジェクトに対して、フォントカラーを赤に、フォントスタイルをイタリックに変更するマクロ関数を定義します。</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Function onInvoke($editor : Object)-&gt;$result : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var $name : Text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If ($editor.editor.currentSelection.length&gt;0)       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 選択されている各オブジェクトの stroke 属性を red に、style 属性を italic に設定します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        For each ($name; $editor.editor.currentSelection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $editor.editor.currentPage.objects[$name].stroke:=&quot;red&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $editor.editor.currentPage.objects[$name].fontStyle:=&quot;italic&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        End for each </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ALERT(&quot;フォームオブジェクトを選択してください。&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4Dに変更を通知します</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=New object(&quot;currentPage&quot;; $editor.editor.currentPage)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="onerror">onError()<a href="#onerror" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="onerroreditor--object-resultmacro--object--error--collection">onError($editor : Object; $resultMacro : Object ; $error : Collection)<a href="#onerroreditor--object-resultmacro--object--error--collection" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><table><thead><tr><th>引数</th><th></th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>$editor</td><td></td><td>Object</td><td><a href="#oninvoke">onInvoke</a> に渡されたオブジェクト</td></tr><tr><td>$resultMacro</td><td></td><td>Object</td><td><a href="#oninvoke">onInvoke</a> によって返されたオブジェクト</td></tr><tr><td>$error</td><td></td><td>Collection</td><td>エラースタック</td></tr><tr><td></td><td>[].errCode</td><td>Number</td><td>エラーコード</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>エラーの詳細</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>内部コンポーネントのシグネチャー</td></tr></tbody></table><p>マクロの実行時にエラーが発生した場合、<code>onError</code> 関数が実行されます。</p><p>マクロの実行時に発生したエラーが、マクロの取り消しを不可能にする内容の場合、マクロは実行されません。 たとえば次のような場合が該当します:</p><ul><li>読み取り専用ファイルのスクリプトを変更・削除しようとしたとき</li><li>同じ内部ID を持つオブジェクトを複数作成しようとしたとき</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例題-4">例題<a href="#例題-4" class="hash-link" aria-label="見出しへの直接リンク" title="見出しへの直接リンク">​</a></h4><p>マクロクラス定義に、次のような汎用的なエラーコードを書くことができます:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Function onError($editor : Object; $resultMacro : Object; $error : Collection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var $obj : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var $txt : Text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $txt:=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For each ($obj; $error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $txt:=$txt+$obj.message+&quot; \n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End for each </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ALERT($txt)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20FormEditor%2Fmacros.md%20(19-R8)&amp;body=Please%20enter%20your%20comment%3A" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページへコメントする</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントのナビゲーション"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/ja/FormEditor/overview"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">フォームエディター</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ja/FormEditor/objectLibrary"><div class="pagination-nav__sublabel">開発中</div><div class="pagination-nav__label">オブジェクトライブラリ</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#例題" class="table-of-contents__link toc-highlight">例題</a></li><li><a href="#フォームエディターでマクロを呼び出す" class="table-of-contents__link toc-highlight">フォームエディターでマクロを呼び出す</a></li><li><a href="#マクロファイルの場所" class="table-of-contents__link toc-highlight">マクロファイルの場所</a></li><li><a href="#マクロの宣言" class="table-of-contents__link toc-highlight">マクロの宣言</a><ul><li><a href="#例題-1" class="table-of-contents__link toc-highlight">例題</a></li></ul></li><li><a href="#マクロのインスタンス化" class="table-of-contents__link toc-highlight">マクロのインスタンス化</a></li><li><a href="#マクロ関数" class="table-of-contents__link toc-highlight">マクロ関数</a><ul><li><a href="#class-constructor" class="table-of-contents__link toc-highlight">Class constructor</a></li><li><a href="#oninvoke" class="table-of-contents__link toc-highlight">onInvoke()</a></li><li><a href="#onerror" class="table-of-contents__link toc-highlight">onError()</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">コミュニティ</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">デベロッパー・センター</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">サポート</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (旧ドキュメント)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">ナレッジベース</a></li><li class="footer__item"><a href="https://us.4d.com/product-download/Feature-Release" target="_blank" rel="noopener noreferrer" class="footer__link-item">ダウンロード<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">サポートを受ける<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">会社概要</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D社について<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">コンタクト<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">世界中の4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/ja/assets/js/runtime~main.0adf2639.js"></script>
<script src="/docs/ja/assets/js/main.0ac862ff.js"></script>
</body>
</html>