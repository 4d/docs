<!DOCTYPE html><html lang="ja"><head><meta name="docsearch:version" content="19 R6 BETA"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>マクロの作成と利用 · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="メソッド内でマクロコマンドを利用することができます。 マクロを利用すれば、コードの入力にかかる時間を大幅に短縮することができます。"/><meta name="docsearch:language" content="ja"/><meta property="og:title" content="マクロの作成と利用 · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/index.html"/><meta property="og:description" content="メソッド内でマクロコマンドを利用することができます。 マクロを利用すれば、コードの入力にかかる時間を大幅に短縮することができます。"/><meta property="og:image" content="https://4d.github.io/docs/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/img/logohome.png"/><link rel="shortcut icon" href="/docs/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/alpha/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/js/code-blocks-buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/ja"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs" target="_self">v19 R6 BETA</a></li><li class=""><a href="https://developer.4d.com/docs/Rx" target="_self">v19 R5</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/img/language.svg" alt="Languages icon"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/code-editor/creating-using-macros.html">English</a></li><li><a href="/docs/de/code-editor/creating-using-macros.html">Deutsch</a></li><li><a href="/docs/es/code-editor/creating-using-macros.html">Español</a></li><li><a href="/docs/fr/code-editor/creating-using-macros.html">Français</a></li><li><a href="/docs/pt/code-editor/creating-using-macros.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>コードの扱い方</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">プロジェクト管理<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Project/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/architecture.html">プロジェクトのアーキテクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/documentation.html">ドキュメンテーション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Project/compiler.html">コンパイル</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ランゲージのコンセプト<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/about.html">4D ランゲージについて</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/quick-tour.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/operators.html">演算子</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/data-types.html">データタイプの概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/boolean.html">ブール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/collection.html">コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/date.html">日付</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/null-undefined.html">Null と 未定義</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/number.html">数値 (実数、倍長整数、整数)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/object.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/picture.html">ピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/pointer.html">ポインター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/string.html">文字列</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/time.html">時間</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/variant.html">バリアント</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/variables.html">変数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/arrays.html">配列</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/methods.html">メソッド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/parameters.html">引数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/shared.html">共有オブジェクトと共有コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/classes.html">クラス</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/control-flow.html">制御フロー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/branching.html">分岐構造</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/looping.html">ループ構造</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/error-handling.html">エラー処理</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/interpreted-compiled.html">インタープリターモードとコンパイル済みモード</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/components.html">コンポーネント</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/plug-ins.html">プラグイン</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Concepts/identifiers.html">識別子の命名規則</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/overview.html">ORDAとは何か</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/dsmapping.html">データモデルオブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/ordaClasses.html">データモデルクラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/entities.html">データ操作</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/datastores.html">リモートデータストアの利用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/ORDA/glossary.html">用語集</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">クラス API リファレンス<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/API/overview.html">クラス API の概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/BlobClass.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ClassClass.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/CollectionClass.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataClassClass.html">DataClass</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EntityClass.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/FunctionClass.html">Formula</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/HTTPRequestClass.html">HTTPRequest</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SessionClass.html">Session</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/SystemWorkerClass.html">SystemWorker</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">コードの扱い方<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/code-editor/overview.html">4D コードについて</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/code-editor/write-class-method.html">コードエディター</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/code-editor/find-replace.html">検索と置換</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ja/code-editor/creating-using-macros.html">マクロの作成と利用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Tags/tags.html">変換タグ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">デバッガー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Debugging/basics.html">画面の説明</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Debugging/debugger.html">デバッガー</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Debugging/breakpoints.html">ブレークポイントとキャッチコマンド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Debugging/debugging-remote.html">リモートマシンからのデバッグ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Debugging/debugLogFiles.html">ログファイルの詳細</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">設定<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/settings/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/general.html">一般ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/interface.html">インターフェースページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/compiler.html">コンパイラーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/database.html">データベースページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/backup.html">バックアップページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/client-server.html">クライアント-サーバーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/web.html">Web ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/sql.html">SQL ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/php.html">PHP ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/security.html">セキュリティページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/settings/compatibility.html">互換性ページ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">環境設定<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/general.html">一般ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/structure.html">ストラクチャーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/forms.html">フォームページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/methods.html">メソッドページ</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/Preferences/shortcuts.html">ショートカットページ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/master/docs/code-editor/creating-using-macros.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">マクロの作成と利用</h1></header><article><div><span><p>メソッド内でマクロコマンドを利用することができます。 マクロを利用すれば、コードの入力にかかる時間を大幅に短縮することができます。</p>
<h2><a class="anchor" aria-hidden="true" id="マクロとは"></a><a href="#マクロとは" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>マクロとは</h2>
<p>マクロコマンドは 4Dコードのパーツで、どのデータベースが開かれているかにかかわらず、あらゆるメソッドのどんな場所にでも挿入することができます。 マクロにはすべてのタイプの 4Dテキスト、コマンド、定数、さらにマクロ実行時のメソッドコンテキストにより値が置換される特別なタグを記述することができます。 たとえば、マクロに <code>&lt;method_name/&gt;;</code> というタグを記述しておくと、マクロ挿入時にこのタグはカレントのプロジェクトメソッド名に置換されます。</p>
<p>マクロは 1つ以上の XMLフォーマットのテキストファイルに格納されます。 マクロはコードエディターリスト、またはエディター内のコンテキストメニュー、さらに自動補完機能から呼び出すことが可能です。</p>
<p>4Dマクロは XMLフォーマットで記述されます。 4Dが提供するデフォルトのマクロファイルをそのまま使用することも、変更することもできます。</p>
<h2><a class="anchor" aria-hidden="true" id="マクロの場所"></a><a href="#マクロの場所" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>マクロの場所</h2>
<p>4D は <strong>Macros v2</strong> という名前のフォルダーからマクロを読み込みます。 マクロは XMLファイルとしてこのフォルダーに配置しなければなりません。</p>
<p>&quot;Macros v2&quot; フォルダーは以下の場所に配置できます:</p>
<ul>
<li>マシンのアクティブ4Dフォルダー。 この場合、マクロはすべてのデータベースで共有されます。 <strong>注:</strong> アクティブ4Dフォルダーの位置は OS により異なります。 詳細については、<em>4Dランゲージリファレンス</em> マニュアルの <a href="https://doc.4d.com/4Dv19R4/4D/19-R4/Get-4D-folder.301-5739515.ja.html">Get 4D folder</a> コマンドの説明を参照ください。</li>
<li>データベースストラクチャーファイルと同階層。 マクロは、このストラクチャーにのみ読み込まれます。</li>
<li>コンポーネントの場合: データベースの <strong>Components</strong> フォルダーと同階層。 この場合マクロは、コンポーネントがインストールされている場合のみ利用できます。</li>
</ul>
<p>これら 3つの場所は同時に利用可能です。各場所に &quot;Macros v2&quot; フォルダーをインストールできます。 マクロは以下の順番でロードされます: 4Dフォルダー、ストラクチャーファイル、コンポーネント1 ... コンポーネントX。</p>
<h2><a class="anchor" aria-hidden="true" id="デフォルトマクロ"></a><a href="#デフォルトマクロ" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>デフォルトマクロ</h2>
<p>4D は、以前のバージョンの 4D におけるキーワードリストに対応するマクロをデフォルトで提供しています。 このマクロは 4Dを初回起動する際、マシンのアクティブ4Dフォルダー内の &quot;Macros v2&quot; フォルダーに作成される<em>Macros.xml</em> ファイルに含まれます。</p>
<p>このファイルを変更することができます。また、フォルダー内に別のマクロファイルを追加することもできます (後述参照)。 このフォルダーに問題が発生した場合は、フォルダーを削除すると次回の 4D起動時に新たに作成されます。</p>
<h2><a class="anchor" aria-hidden="true" id="カスタマイズしたマクロを追加する"></a><a href="#カスタマイズしたマクロを追加する" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>カスタマイズしたマクロを追加する</h2>
<p>標準のテキストエディターやプログラムを使用して、&quot;Macros.xml&quot; ファイルにカスタマイズしたマクロを追加できます。 またフォルダー内に、カスタマイズしたマクロを記述した XMLファイルを追加することもできます。</p>
<p>ローカルモードでは、4D を使用中にマクロファイルを開くことができます。 利用可能なマクロのリストは 4Dがアクティブになるたびに更新されます。 たとえば、テキストエディターを最前面にしてマクロファイルを更新し、その後メソッドの編集に戻ると、新しいマクロがコードエディターで利用可能になっています。</p>
<p>空およびエラーのあるマクロは表示されません。</p>
<h3><a class="anchor" aria-hidden="true" id="カスタマイズしたマクロのシンタックスを検証する"></a><a href="#カスタマイズしたマクロのシンタックスを検証する" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>カスタマイズしたマクロのシンタックスを検証する</h3>
<p>4Dのマクロコマンドファイルは XML標準に準拠していなければなりません。 つまりXML宣言 <code>&lt;?xml version=&quot;1.0&quot; ...?&gt;</code> とドキュメント宣言 <code>&lt;!DOCTYPE macros SYSTEM &quot;http://www.4d.com/dtd/2007/macros.dtd&quot;&gt;</code> 文がマクロファイルの先頭になければならず、そうでない場合、マクロは読み込まれません。 異なるタイプの XMLエンコーディングがサポートされています。 しかし、Mac/PC (UTF-8) 互換のエンコーディングを使用することが推奨されます。 4D はマクロファイルを検証するための DTD を提供しています。 ファイルは以下の場所にあります:</p>
<ul>
<li>Windows: \Resources\DTD\macros.dtd</li>
<li>macOS: :Contents:Resources:DTD:macros.dtd</li>
</ul>
<p>マクロファイルに宣言文が含まれない場合や検証に失敗する場合、マクロはロードされません。</p>
<h2><a class="anchor" aria-hidden="true" id="4dマクロのシンタックス"></a><a href="#4dマクロのシンタックス" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4Dマクロのシンタックス</h2>
<p>4Dマクロは &quot;要素&quot; と呼ばれるカスタマイズされた XMLタグを使用して構築されます。</p>
<p>いくつかのタグは定義の開始と終了を表し (<code>&lt;tag&gt;</code> と <code>&lt;/tag&gt;</code> のようなペア)、その他のタグは実行コンテキストにより置換されます (<code>&lt;tag/&gt;</code>)。</p>
<p>XML仕様に準拠し、いくつかのタグは属性を含むことがあります。 明示されない限り属性の指定は任意であり、省略された場合はデフォルト値が使用されます。 要素および属性のシンタックスは以下の通りです:</p>
<ul>
<li>開始および終了タグのペア: <code>&lt;tag attribute=&quot;value&quot;&gt; &lt;/tag&gt;</code></li>
<li>置換されるタグ: <code>&lt;tag attribute=&quot;value&quot;/&gt;</code></li>
</ul>
<p>要素に複数の属性を指定できる場合、スペースで区切って記述します:<br>
<tag attribute1="value" attribute2="value" attribute3="value"></p>
<p>利用可能なタグのリストと利用モードは以下の通りです:</p>
<table>
<thead>
<tr><th><strong>要素タグ</strong></th><th><strong>説明</strong></th></tr>
</thead>
<tbody>
<tr><td><code>&lt;macros&gt; &lt;/macros&gt;</code></td><td>マクロファイルの開始と終了 (必須)。</td></tr>
<tr><td><code>&lt;macro&gt; &lt;/macro&gt;</code></td><td>マクロとその属性の定義の開始と終了。</td></tr>
<tr><td></td><td><em>属性</em>:</td></tr>
<tr><td></td><td>- name: メニューやコードエディターリストに表示されるマクロの名前** (必須)。</td></tr>
<tr><td></td><td>- type_ahead_text: タイプアヘッド (自動補完) 機能<em>を使用してマクロを呼び出すために入力する文字列</em>*。</td></tr>
<tr><td></td><td>- in_menu: コンテキストメニュー*からマクロを呼び出すことを許可するかを指定するブール値。 値は &quot;true&quot; (デフォルト) または &quot;false&quot;。</td></tr>
<tr><td></td><td>- type_ahead: タイプアヘッド (自動補完) 機能*を使用してマクロを呼び出すことを許可するかを指定するブール値。 値は &quot;true&quot; (デフォルト) または &quot;false&quot;。</td></tr>
<tr><td></td><td>- method_event: メソッドごとの現在の処理フェーズ (作成、閉じる等) に応じてマクロの自動呼出しを実行するために使用します。 値 = &quot;on_load&quot;: マクロはメソッドを開くたびに実行されます, &quot;on_save&quot;: マクロはメソッドが保存されるたびに実行されます (メソッドを閉じるまたはファイル＞保存コマンドを使用して保存する), &quot;on_create&quot;: マクロはメソッドが作成されるたびに実行されます, &quot;on_close&quot;: マクロはメソッドが閉じられるたびに実行されます。</td></tr>
<tr><td></td><td>&quot;on_save&quot; と &quot;on_close&quot; は組み合わせて使用できます — 言い換えれば、これらのイベントは更新されたメソッドが閉じられるときに両方とも生成されます。 他方、&quot;on_create&quot; と &quot;on_load&quot; が連続して実行されることはありません。 この属性は、たとえばメソッド作成時にデフォルトのフォーマット (ヘッダーエリアのコメント等) を適用したり、メソッドを閉じる際にタイムスタンプを記録するために使用することができます。</td></tr>
<tr><td></td><td>- version: マクロ用にテキスト選択の新しいモードを有効化するために使用します (後述の &quot;code&gt;&lt;method&gt;</code>タグについて&quot; 参照)。 新しいモードを有効にするには &quot;2&quot; を指定します。 この属性を省略するか version=&quot;1&quot; を指定すると、以前のモードが保持されます。</td></tr>
<tr><td></td><td>- in_toolbar: ツールバーのマクロボタンメニューにマクロを表示するかどうかを指定するブール値。 値=&quot;true&quot; (デフォルト) または &quot;false&quot;。</td></tr>
<tr><td><code>&lt;selection/&gt;</code></td><td>マクロが挿入される時点で選択されていたテキストを使用して、タグが置換されます。 選択テキストは空の場合もあります。</td></tr>
<tr><td><code>&lt;text&gt; &lt;/text&gt;</code></td><td>メソッドに挿入されるコードの開始と終了タグ。 コードの先頭と最後には改行が追加されます。</td></tr>
<tr><td><code>&lt;method&gt; &lt;/method&gt;</code></td><td>プロジェクトメソッド名とその引数 (オプション) の開始と終了。 マクロが呼び出されたとき、メソッドが実行されます。 (&quot;param1;param2;...&quot;) の形式で引数を渡せます。 この引数は、呼び出されたメソッド内で $1, $2...変数に渡されます。 このタグに関する追加情報は後述の &quot;<code>&lt;method&gt;</code> タグについて&quot; を参照ください。</td></tr>
<tr><td><code>&lt;caret/&gt;</code></td><td>マクロが挿入された後のコード中の挿入ポイントの場所。</td></tr>
<tr><td><code>&lt;user_4D/&gt;</code></td><td>カレント4Dユーザー名で置換されるタグ。</td></tr>
<tr><td><code>&lt;user_os/&gt;</code></td><td>カレントのシステムユーザー名で置換されるタグ。</td></tr>
<tr><td><code>&lt;method_name/&gt;</code></td><td>カレントのプロジェクトメソッド名で置換されるタグ。</td></tr>
<tr><td><code>&lt;method_path/&gt;</code></td><td>カレントプロジェクトメソッドのフルパス名で置換されるタグ。</td></tr>
<tr><td><code>&lt;date/&gt;</code></td><td>カレントの日付で置換されるタグ。</td></tr>
<tr><td></td><td><em>属性</em>:</td></tr>
<tr><td></td><td>- format: 4D の日付フォーマット。 フォーマットが設定されていない場合、デフォルトのフォーマットが使用されます。 値 = 4Dフォーマットの数字 (0 - 8)。</td></tr>
<tr><td><code>&lt;time/&gt;</code></td><td>カレントの時間で置換されるタグ。</td></tr>
<tr><td></td><td><em>属性</em>:</td></tr>
<tr><td></td><td>- format: 4D の時間フォーマット。 フォーマットが設定されていない場合、デフォルトのフォーマットが使用されます。 値 = 4Dフォーマットの数字 (0 - 6)。</td></tr>
<tr><td><code>&lt;clipboard/&gt;</code></td><td>クリップボードの内容で置換されるタグ。</td></tr>
<tr><td></td><td><em>属性</em>:</td></tr>
<tr><td></td><td>- index: ペーストするクリップボード。 値 = クリップボード番号 (0 - 9)。</td></tr>
</tbody>
</table>
<ul>
<li><ul>
<li>マクロは、コードエディターのコンテキストメニューやタイプアヘッド機能を使用して呼び出すことができます (後述参照)。</li>
</ul></li>
<li>** XML言語仕様に準拠するには、拡張文字 (アクセント文字や引用符など) を使用してはなりません。</li>
</ul>
<p>以下はマクロ定義の例です:</p>
<table>
<thead>
<tr><th><strong>マクロの内容</strong></th><th><strong>コメント</strong></th></tr>
</thead>
<tbody>
<tr><td><code>&lt;?xml version=&quot;1.0&quot;...?&gt;</code></td><td>XML宣言</td></tr>
<tr><td><code>&lt;!DOCTYPE macros SYSTEM&gt;</code></td><td>ドキュメント宣言</td></tr>
<tr><td><code>&lt;macros&gt;</code></td><td>マクロXMLファイルの開始</td></tr>
<tr><td><code>&lt;macro name=&quot;RecordLoop&quot;&gt;</code></td><td>マクロ定義の開始と名前</td></tr>
<tr><td><code>&lt;text&gt;</code></td><td>マクロコードの開始</td></tr>
<tr><td>For($i;1;Records in selection(<code>&lt;Selection/&gt;</code>))</td><td><code>&lt;Selection/&gt;</code> タグは、マクロ挿入時に 4Dメソッド内で選択されているコードにより置換されます (たとえばテーブル名)</td></tr>
<tr><td>SAVE RECORD(<code>&lt;Selection/&gt;</code>)</td><td></td></tr>
<tr><td>NEXT RECORD(<code>&lt;Selection/&gt;</code>)</td><td></td></tr>
<tr><td>End for</td><td></td></tr>
<tr><td><code>&lt;/text&gt;</code></td><td>マクロコードの終了</td></tr>
<tr><td><code>&lt;/macro&gt;</code></td><td>マクロ定義の終了</td></tr>
<tr><td><code>&lt;/macros&gt;</code></td><td>マクロXMLファイルの終了</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="method-タグについて"></a><a href="#method-タグについて" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>&lt;method&gt;</code> タグについて</h2>
<p><code>&lt;method&gt;</code> タグを使用すると、4Dプロジェクトメソッドを実行するマクロコマンドを作成して使用することができます。 これにより開発者はコンポーネントにマクロコマンドを添付して配布し、洗練された機能を提供することが可能になります。 たとえば、以下のマクロはカレントのメソッド名を引数にとり、<em>MyMethod</em> メソッドを実行します:</p>
<p><code>&lt;method&gt;MyMethod(&quot;&lt;method_name/&gt;&quot;)&lt;/method&gt;</code></p>
<p>呼び出されたメソッドコードは新規プロセスで実行されます。 このプロセスはメソッド実行後に消失します。</p>
<blockquote>
<p>呼び出されたメソッドの実行が終了するまでストラクチャープロセスは停止されます。 メソッドの実行は素早く終了し、アプリケーションをブロックするリスクがないことを確認しなければなりません。 ブロックしてしまった場合には、<strong>Ctrl+F8</strong> (Windows) または <strong>Command+F8</strong> (macOS) でこのプロセスをアボートできます。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="マクロを呼び出す"></a><a href="#マクロを呼び出す" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>マクロを呼び出す</h2>
<p>デフォルトでマクロはコードエディターのコンテキストメニューまたはツールバー、自動補完機能、またはコードエディターウィンドウ下部のマクロリストから呼び出すことができます。</p>
<p>各マクロごとにコンテキストメニューや自動補完機能を使用した呼び出しを禁止できる点に留意してください。</p>
<h3><a class="anchor" aria-hidden="true" id="コンテキストメニューとツールバー"></a><a href="#コンテキストメニューとツールバー" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>コンテキストメニューとツールバー</h3>
<p>デフォルトでは、すべてのマクロをコードエディターのコンテキストメニュー (<strong>マクロ挿入</strong> 階層コマンド) またはツールバーの <strong>マクロ</strong> ボタンから呼び出すことができます。</p>
<p><code>&lt;macro&gt;</code> タグの <em>in_menu</em> 属性を使用して、マクロをこのメニューに表示するかどうかを指定できます。</p>
<p>コンテキストメニュー内で、マクロは &quot;Macros.xml&quot; ファイル (および追加の XMLファイル) に記述された順番で表示されます。 つまりファイルを編集することでこの順番を変更できます。</p>
<h3><a class="anchor" aria-hidden="true" id="自動補完"></a><a href="#自動補完" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>自動補完</h3>
<p>デフォルトでは、すべてのマクロは自動補完 (タイプアヘッド) 機能からアクセスできます (<a href="/docs/ja/code-editor/write-class-method.html">コードエディター</a> 参照)。 <code>&lt;macro&gt;</code> タグの <em>type_ahead</em> 属性を使用して、特定のマクロをこの動作の対象から外すことができます。</p>
<p><strong>注:</strong> マクロに <code>&lt;selection/&gt;</code> タグが含まれている場合、このマクロは自動補完ポップアップウィンドウには表示されません。</p>
<h3><a class="anchor" aria-hidden="true" id="コードエディターリスト"></a><a href="#コードエディターリスト" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>コードエディターリスト</h3>
<p>コードエディターのリストにマクロを表示させることができます (<a href="/docs/ja/code-editor/write-class-method.html">コードエディター</a> 参照)。 リスト中でマクロをダブルクリックし、呼び出すことができます。 特定のマクロをこのリストから除外することはできません。</p>
<h2><a class="anchor" aria-hidden="true" id="互換性に関する注意"></a><a href="#互換性に関する注意" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>互換性に関する注意</h2>
<p>マクロのサポートは 4Dのバージョンごとに変わることがあります。 カスタマイズされたマクロを管理しつつ、異なるバージョンの互換性を保持するために、4Dは以前のバージョンのマクロを取り除くことはしません。 最新機能を使用したい場合は、適切にバージョンを調整する必要があります。</p>
<h3><a class="anchor" aria-hidden="true" id="method-の選択テキスト変数"></a><a href="#method-の選択テキスト変数" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>method の選択テキスト変数</h3>
<p>選択されたテキストは <a href="https://doc.4d.com/4dv19/help/command/ja/page997.html">GET MACRO PARAMETER</a> と <a href="https://doc.4d.com/4dv19/help/command/ja/page998.html">SET MACRO PARAMETER</a> コマンドを使用して管理することが推奨されます。 これらのコマンドを使用すると、ホストプロジェクトとコンポーネント間でテキストを相互に交換することができ、マクロの管理専用のコンポーネントを作成することができます。 マクロでこのモードを有効にするには、macro 要素内で version 属性に値 2 を指定しなければなりません。 この場合、4D は旧式の _textSel, _textReplace 等の定義済み変数を管理しなくなり、<a href="https://doc.4d.com/4dv19/help/command/ja/page997.html">GET MACRO PARAMETER</a> と <a href="https://doc.4d.com/4dv19/help/command/ja/page998.html">SET MACRO PARAMETER</a> が利用可能になります。 属性は以下のように定義します:</p>
<p><code>&lt;macro name=&quot;MyMacro&quot; version=&quot;2&quot;&gt;</code><br/> <code>--- マクロテキスト ---</code><br/> <code>&lt;/macro&gt;</code></p>
<p>この属性を指定しない場合、以前のモードが保持されます。</p>
<h3><a class="anchor" aria-hidden="true" id="xml標準に関連する非互換性"></a><a href="#xml標準に関連する非互換性" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XML標準に関連する非互換性</h3>
<p>マクロファイルは XML標準に準拠しなければならず、厳密なシンタックスルールが適用されます。 以前のバージョンで作成されたマクロコードの場合、これにより非互換が発生することがあり、また XMLファイルの読み込みが妨げられる可能性があります。 異常な動作が起こるのは以下のケースです:</p>
<ul>
<li>以前のバージョンの 4Dでは <code>&lt;macro&gt;</code> 要素内で &quot;// my comment&quot; 形式のコメントが許可されていました。これは XMLのシンタックスに適合していません。 このような行は標準の <code>&quot;&lt;!-- my comment --&gt;&quot;</code> 形式に書きなおさなければなりません。</li>
<li>インタープロセス変数名を表す <code>&lt;&gt;</code> 記号はエンコードされなければなりません。 たとえば、<em>&lt;&gt;params</em> 変数は <code>&amp;&lt;&gt;params</code>と書かなければなりません。</li>
<li>以前のバージョンの 4D ではルート要素である <code>&lt;macros&gt;</code> を省略できました。 現在このタグは必須です。このタグがない場合、ファイルをロードできません。</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ja/code-editor/find-replace.html"><span class="arrow-prev">← </span><span>検索と置換</span></a><a class="docs-next button" href="/docs/ja/Tags/tags.html"><span>変換タグ</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#マクロとは">マクロとは</a></li><li><a href="#マクロの場所">マクロの場所</a></li><li><a href="#デフォルトマクロ">デフォルトマクロ</a></li><li><a href="#カスタマイズしたマクロを追加する">カスタマイズしたマクロを追加する</a><ul class="toc-headings"><li><a href="#カスタマイズしたマクロのシンタックスを検証する">カスタマイズしたマクロのシンタックスを検証する</a></li></ul></li><li><a href="#4dマクロのシンタックス">4Dマクロのシンタックス</a></li><li><a href="#method-タグについて"><code>&lt;method&gt;</code> タグについて</a></li><li><a href="#マクロを呼び出す">マクロを呼び出す</a><ul class="toc-headings"><li><a href="#コンテキストメニューとツールバー">コンテキストメニューとツールバー</a></li><li><a href="#自動補完">自動補完</a></li><li><a href="#コードエディターリスト">コードエディターリスト</a></li></ul></li><li><a href="#互換性に関する注意">互換性に関する注意</a><ul class="toc-headings"><li><a href="#method-の選択テキスト変数">method の選択テキスト変数</a></li><li><a href="#xml標準に関連する非互換性">XML標準に関連する非互換性</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ja","version:19 R6 BETA"]}
              });
            </script></body></html>