---
id: log
title: ログファイル (.journal)
---

A continuously-used application is always recording changes, additions or deletions. 定期的にデータをバックアップすることは重要ですが、バックアップだけでは (予期しない障害の場合に)、前回のバックアップ以降に入力されたデータを回復することができません。 この必要性に対応するため、4D は専用ツールであるログファイルを提供しています。 This file allows ensuring permanent security of data.

また、4D は常にメモリー上のデータキャッシュを使用して作業をおこなっています。 Any changes made to the application data are stored temporarily in the cache before being written to the hard disk. これにより、アプリケーションの処理速度が向上します。実際、メモリーへのアクセスは、ハードディスクへのアクセスよりも高速です。 If an incident occurs in the application before the data stored in the cache could be written to the disk, you must include the current log file in order to restore the application entirely.

Finally, 4D has functions that analyze the contents of the log file, making it possible to rollback the operations carried out on the application data. これらの機能は MSC にて提供されています ([ログ解析](MSC/analysis.md) ページおよび [ロールバック](MSC/rollback.md) ページ参照)。

## ログファイルについて

The log file generated by 4D contains a description of all operations performed on the data of journaled tables, which are logged sequentially. デフォルトでは、すべてのテーブルのデータログが取られています (つまりログファイルに含まれています)。しかし、**ログファイルに含める** のプロパティを選択解除することによって特定のテーブルをログに含めないようにすることもできます。

As such, each operation performed by a user causes two simultaneous actions: the first one in the data file (instruction is executed normally) and the second one in the log file (the description of the operation is recorded). ログファイルは個別に作成され、ユーザーの作業を妨げたり作業速度を低下させることはありません。 An application can only work with one log file at a time. ログファイルには、次の操作が記録されます:

- データファイルの開閉
- プロセス (コンテキスト) の開閉
- レコードまたは BLOB の追加
- レコードの変更
- レコードの削除
- トランザクションの作成や終了

これらのアクションについての詳細は、MSC の [ログ解析](MSC/analysis.md) ページを参照ください。

ログファイルは 4D により管理されます。 It takes into account all operations that affect the data file equally, regardless of any manipulations performed by a user, a 4D method, the SQL engine, plug-ins, or from a Web browser or a mobile applicaton.

The following illustration sums up how the log file works:

![](assets/en/Backup/backup05.png)


The current log file is automatically saved with the current data file. This mechanism has two distinct advantages:

- Its avoids saturating the disk volume where the log file is stored. Without a backup, the log file would get bigger and bigger with use, and would eventually use all available disk space. For each data file backup, 4D or 4D Server closes the current log file and immediately starts a new, empty file, thereby avoiding the risk of saturation. The old log file is then archived and eventually destroyed depending on the mechanism for managing the backup sets.
- It keeps log files corresponding to backups in order to be able to parse or repair an application at a later point in time. The integration of a log file can only be done in the application to which it corresponds. It is important, in order to be able to properly integrate a log file into a backup, to have backups and log files archived simultaneously.


## Creating the log file

By default, any application project created with 4D uses a log file (option set in the **General** page of the Preferences). ログファイルには *data.journal* のように名前が付けられ、Data フォルダーに置かれます。

You can find out if your application uses a log file at any time: just check whether the **Use Log** option is selected on the **Backup/Configuration** page of the Settings. If you deselected this option, or if you use an application without a log file and wish to set up a backup strategy with a log file, you will have to create one.

To create a log file:

1. On the **Backup/Configuration** page of the Structure Settings, check the **Use Log** option. The program displays a standard open/new file dialog box. By default, the log file is named *data.journal*.

2. Keep the default name or rename it, and then select the file location. If you have at least two hard drives, it is recommended that you place the log file on a disk other than the one containing the application project. If the application hard drive is lost, you can still recall your log file.

3. Click **Save**. The disk and the name of the open log file are now displayed in the **Use Log** area of the dialog box. You can click on this area in order to display a pop-up menu containing the log path on the disk.

4. Validate the Settings dialog box.

In order for you to be able to create a log file directly, the data must be in one of the following situations:

- The data file is blank,
- You just performed a backup and no changes have yet been made to the data.

In all other cases, when you validate the Settings dialog box, an alert dialog box will appear to inform you that it is necessary to perform a backup. If you click **OK**, the backup begins immediately, then the log file is activated. If you click **Cancel**, the request is saved but the creation of the log file is postponed and it will actually be created only after the next backup of the application. This precaution is indispensable because, in order to restore an application after any incidents, you will need a copy of the application into which the operations recorded in the log file will be integrated.

Without having to do anything else, all operations performed on the data are logged in this file and it will be used in the future when the application is opened.

You must create another log file if you create a new data file. You must set or create another log file if you open another data file that is not linked to a log file (or if the log file is missing).



## Stopping a log file

If you would like to stop logging operations to the current log file, simply deselect the **Use Log** option on the **Backup/Configuration** page of the Settings.

4D then displays an alert message to remind you that this action prevents you from taking advantage of the security that the log file provides:

![](assets/en/Backup/backup06.png)

If you click **Stop**, the current log file is immediately closed (the Settings dialog box does not need to be validated afterwards).

If you wish to close the current log file because it is too large, you might consider performing a data file backup, which will cause the log file to be backed up as well.

> **4D Server:** The `New log file` command automatically closes the current log file and starts a new one. If for some reason the log file becomes unavailable during a working session, error 1274 is generated and 4D Server does not allow users to write data anymore. When the log file is available again, it is necessary to do a backup.