<!doctype html>
<html>
<head>

  <meta charset="utf-8"/>
  <title>Marked in the browser</title>
  <script src="marked.js"></script>
  <script src="highlight.pack.js"></script>
  <script src="4d.min.js"></script>
  <link rel="stylesheet" type="text/css" href="styles/github.css">
  <script src="menu/menu.js"></script>
  <link rel="stylesheet" type="text/css" href="menu/menu.css">

  <script>

    var currentFile = document.location.href
    function setCurrentFile(inFilePath) {
      currentFile = "file:///" + inFilePath
    }


    function changeRoot(newRoot)
    {

      var base = document.createElement("base");
      base.href = newRoot;
      var head = document.getElementsByTagName('head')[0];
      var actualBases = head.getElementsByTagName("base");

      if(actualBases.length > 0)
      {
        actualBases[0] = base;
      }
      else
      {
        head.appendChild(base);
      }
    }

    function refresh(content)
    {
      document.getElementById('content').innerHTML = marked(content);
      var matches = document.querySelectorAll("code");
      hljs.configure({languages: []});

      for(let i = 0; i < matches.length; ++i)
      {
        hljs.highlightBlock(matches[i]);
      }
	 }
	</script>

</head>

<body ondragstart="return false;" ondrop="return false;">

	<div id="content">
[Value](#value2)

## Value2

# test
```4d
var $test : 4D.test
$0:=(This.value)*(This.value)
例えば()
$nextHigh:=ds.Employee(1).getNextWithHigherSalary()
Form.comp.city:=$cityManager.City.getCityName(Form.comp.zipcode)
If(False)

End if

```

	</div>
<script>refresh(document.getElementById('content').innerHTML)</script>
</body>

<div id="menu">
<div class="contextualMenu">
	<ul class="menu-options">
	</ul>
  </div>
</div>

<textarea id="clipboard"></textarea>

<script>
function clickOrigin(e){
    var target = e.target;
    var tag = {};
    tag.tagType = target.tagName.toLowerCase();
    tag.tagClass = target.className.split(' ');
    tag.id = target.id;
    tag.parent = target.parentNode.tagName.toLowerCase();
    return tag;
}

var tagsToIdentify = ['img','a'];

document.body.onclick = function(e){
    elem = clickOrigin(e);

    for (i=0;i<tagsToIdentify.length;i++){
        if (elem.tagType == tagsToIdentify[i] && elem.parent == 'a'){
            return false; // or do something else.
        }
        else if (elem.tagType == tagsToIdentify[i]){
          let href = e.srcElement.href
          console.log(href)
          console.log(currentFile)
          if(href.includes(currentFile)) {
            window.location.replace(e.srcElement.hash) 
          }
            return false; // or do something else.
        }
    }
    return true;
};

</script>


</html>