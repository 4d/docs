<!DOCTYPE html><html lang="fr"><head><meta name="docsearch:version" content="19 R2"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>IMAPTransporter · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="La classe `IMAPTransporter` vous permet de récupérer des messages à partir d&#x27;un serveur de messagerie IMAP."/><meta name="docsearch:language" content="fr"/><meta property="og:title" content="IMAPTransporter · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/Rx/index.html"/><meta property="og:description" content="La classe `IMAPTransporter` vous permet de récupérer des messages à partir d&#x27;un serveur de messagerie IMAP."/><meta property="og:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><link rel="shortcut icon" href="/docs/Rx/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/Rx/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/Rx/js/code-blocks-buttons.js"></script><script src="/docs/Rx/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/Rx/css/main.css"/><script src="/docs/Rx/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/Rx/fr"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R3 BETA</a></li><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs/Rx" target="_self">v19 R2</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/Rx/img/language.svg" alt="Languages icon"/>Français</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/Rx/en/API/IMAPTransporterClass.html">English</a></li><li><a href="/docs/Rx/ja/API/IMAPTransporterClass.html">日本語</a></li><li><a href="/docs/Rx/de/API/IMAPTransporterClass.html">Deutsch</a></li><li><a href="/docs/Rx/es/API/IMAPTransporterClass.html">Español</a></li><li><a href="/docs/Rx/pt/API/IMAPTransporterClass.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Classes API</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Prise en main<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/GettingStarted/installation.html">Installation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Gestion de projet<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Project/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Project/creating.html">Working with a project</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Project/architecture.html">Architecture of a project</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Project/documentation.html">Documenter un projet</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Project/compiler.html">Compilation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Concepts du langage 4D<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/about.html">À propos du Langage 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/quick-tour.html">Tour d&#x27;horizon</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/data-types.html">Types de données</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/boolean.html">Booléen</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/collection.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/date.html">Date</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/null-undefined.html">Null et Indefinie</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/number.html">Numérique (Réel, Entier, Entier long)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/object.html">Object</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/picture.html">Image</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/pointer.html">Pointeur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/string.html">Chaine</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/time.html">Heure</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/variant.html">Variant</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/variables.html">Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/arrays.html">Tableaux</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/methods.html">Méthodes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/parameters.html">Paramètres</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/shared.html">Objets et collections partagés</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/classes.html">Classes</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/control-flow.html">Conditions et boucles</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/branching.html">Structures conditionnelles</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/looping.html">Structures répétitives (ou &quot;boucles&quot;)</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Tags/tags.html">Balises de transformation</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/error-handling.html">Gestion des erreurs</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/interpreted-compiled.html">Modes interprété et compilé</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/components.html">Composants</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/plug-ins.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Concepts/identifiers.html">Identifiants</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/overview.html">Que signifie ORDA ?</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/dsmapping.html">Objets Data Model</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/ordaClasses.html">Classes du modèle de données</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/entities.html">Travailler avec des données</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/datastores.html">Utiliser un datastore distant</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/ORDA/glossary.html">Glossaire</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Classes API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/overview.html">Aperçu - API des classes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/BlobClass.html">Blob</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/ClassClass.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/CollectionClass.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/DataClassClass.html">DataClass</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/EntityClass.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/FunctionClass.html">Formula</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Rx/fr/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/SessionClass.html">Session</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Débogage<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Debugging/basics.html">Basics</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Debugging/debugger.html">Débogueur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Debugging/breakpoints.html">Points d&#x27;arrêt et points d&#x27;arrêt sur commande</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Debugging/debugging-remote.html">Débogage depuis des machines distantes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Préférences<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/general.html">Page Général</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/structure.html">Page Structure</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/forms.html">Page Formulaires</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/methods.html">Page Méthodes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Preferences/shortcuts.html">Page Raccourcis</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Administration<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/webAdmin.html">Administration Web</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/dataExplorer.html">Explorateur de données Web</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/licenses.html">Gestion des licences 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/tls.html">Protocole TLS (HTTPS)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/cli.html">Interface de ligne de commande</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Admin/debugLogFiles.html">Description des fichiers historiques</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Droits d&#x27;accès<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Users/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Users/editing.html">Gestion des groupes et utilisateurs 4D</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">CSM<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/information.html">Page informations</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/analysis.html">Page Analyse d&#x27;activités</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/verify.html">Page Vérification</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/backup.html">Page Sauvegarde</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/compact.html">Page compactage</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/rollback.html">Page Retour en arrière</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/restore.html">Page restitution</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/repair.html">Page Réparation</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/MSC/encrypt.html">Page chiffrement</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Sauvegarde et restitution<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Backup/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Backup/backup.html">Sauvegarde</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Backup/settings.html">Paramètres de sauvegarde</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Backup/log.html">Fichier d&#x27;historique (.journal)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Backup/restore.html">Restitution</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Serveur Web<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/webServer.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/webServerConfig.html">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/webServerAdmin.html">Administration</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/webServerObject.html">Objet Serveur Web</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Développement Web<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/gettingStarted.html">Prise en main</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/templates.html">Template pages</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/httpRequests.html">Processing HTTP requests</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/allowProject.html">Allowing project methods</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/errorPages.html">Custom HTTP Error Pages</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/authentication.html">Authentification</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/sessions.html">User sessions</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/WebServer/preemptiveWeb.html">Using preemptive web processes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Serveur REST<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/gettingStarted.html">Prise en main</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/configuration.html">Configuration du serveur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/authUsers.html">Sessions et utilisateurs</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/genInfo.html">Obtenir des informations du serveur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/manData.html">Manipulation des données</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/classFunctions.html">Appeler des fonctions de classe ORDA</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/REST_requests.html">A propos des requêtes REST</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (general)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/catalog.html">$catalog</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/directory.html">$directory</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/info.html">$info</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/upload.html">$upload</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (dataClass)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/{dataClass}.html">{dataClass}</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/asArray.html">$asArray</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/atomic_$atonce.html">$atomic/$atonce</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/attributes.html">$attributes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/binary.html">$binary</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/compute.html">$compute</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/distinct.html">$distinct</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/entityset.html">$entityset</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/expand.html">$expand</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/filter.html">$filter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/imageformat.html">$imageformat</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/method.html">$method</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/orderby.html">$orderby</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/querypath.html">$querypath</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/queryplan.html">$queryplan</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/savedfilter.html">$savedfilter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/savedorderby.html">$savedorderby</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/skip.html">$skip</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/timeout.html">$timeout</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/top_$limit.html">$top/$limit</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/REST/version.html">$version</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Client/Server<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Desktop/clientServer.html">Client/Server Management</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Formulaires<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/forms.html">A propos des formulaires 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/formEditor.html">Éditeur de formulaire</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/macros.html">Form Editor Macros</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/objectLibrary.html">Bibliothèques d&#x27;objets</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/stylesheets.html">Feuilles de style (style sheets)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/pictures.html">Images</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Propriétés des formulaires<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/jsonReference.html">Liste de propriétés JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/action.html">Action</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/propertiesForm.html">Propriétés des formulaires</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/formSize.html">Form Size</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/markers.html">Markers</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/menu.html">Menu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/print.html">Imprimer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormEditor/windowSize.html">Window Size</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Objets formulaires<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/formObjectsOverview.html">A propos des objets formulaires 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/buttonOverview.html">Bouton</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/buttonGridOverview.html">Grille de boutons</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/checkboxOverview.html">Case à cocher</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/comboBoxOverview.html">Combo Box</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/dropdownListOverview.html">Liste déroulante</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/groupBox.html">Zone de groupe</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/inputOverview.html">Input</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/listOverview.html">Liste hiérarchique</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/listboxOverview.html">List Box</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/pictureButtonOverview.html">Bouton image</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/picturePopupMenuOverview.html">Pop-up menu image</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/pluginAreaOverview.html">Zone de plug-in</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/progressIndicator.html">Indicateurs de progression</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/radiobuttonOverview.html">Bouton radio</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/ruler.html">Règle</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/shapesOverview.html">Formes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/spinner.html">Spinner</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/splitters.html">Séparateur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/staticPicture.html">Image statique</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/stepper.html">Stepper</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/subformOverview.html">Sous-formulaire</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/tabControl.html">Onglets</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/text.html">Texte</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/webAreaOverview.html">Zone Web</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/viewProAreaOverview.html">Zone 4D View Pro</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/writeProAreaOverview.html">Zone 4D Write Pro</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Propriétés des objets formulaire<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesReference.html">Liste de propriétés JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesAction.html">Action</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesAnimation.html">Animation</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesAppearance.html">Apparence</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesBackgroundAndBorder.html">Fond et bordure</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesCoordinatesAndSizing.html">Coordonnées et dimensions</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesCrop.html">Découpage</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesDataSource.html">Source de données</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesDisplay.html">Affichage</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesEntry.html">Saisie</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesFooters.html">Pieds</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesGridlines.html">Quadrillage</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesHeaders.html">En-têtes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesHelp.html">Aide</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesHierarchy.html">Hiérarchie</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesListBox.html">List Box</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesObject.html">Objets</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesPicture.html">Image</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesPlugIns.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesPrint.html">Imprimer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesRangeOfValues.html">Plage de valeurs</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesResizingOptions.html">Options de redimensionnement</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesScale.html">Echelle</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesSubform.html">Sous-formulaire</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesText.html">Texte</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesTextAndPicture.html">Texte et Image</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/FormObjects/propertiesWebArea.html">Zone Web</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Evénements formulaire<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onActivate.html">Sur activation</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onAfterEdit.html">Sur après modification</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onAfterKeystroke.html">Sue après frappe clavier</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onAfterSort.html">Sur après tri</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onAlternativeClick.html">Sur clic alternatif</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onBeforeDataEntry.html">Sur avant saisie</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onBeforeKeystroke.html">Sur avant frappe clavier</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onBeginDragOver.html">Sur début survol</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onBeginUrlLoading.html">On Begin URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onBoundVariableChange.html">On Bound Variable Change</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onClicked.html">Sur clic</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onCloseBox.html">On Close Box</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onCloseDetail.html">Sur fermeture corps</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onCollapse.html">Sur contracter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onColumnMoved.html">Sur déplacement colonne</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onColumnResize.html">Sur redimensionnement colonne</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDataChange.html">Sur données modifiées</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDeactivate.html">On Deactivate</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDeleteAction.html">Sur action suppression</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDisplayDetail.html">Sur affichage corps</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDoubleClicked.html">Sur double clic</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDragOver.html">Sur glisser</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onDrop.html">Sur déposer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onEndUrlLoading.html">On End URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onExpand.html">Sur déployer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onFooterClick.html">Sur clic pied</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onGettingFocus.html">On getting focus</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onHeader.html">Sur entête</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onHeaderClick.html">Sur clic entête</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onLoad.html">On Load</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onLoadRecord.html">Sur chargement ligne</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onLongClick.html">Sur clic long</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onLosingFocus.html">Sur perte focus</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onMenuSelected.html">Sur menu sélectionné</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onMouseEnter.html">Sur début survol</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onMouseLeave.html">Sur fin survol</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onMouseMove.html">Sur survol</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onMouseUp.html">On Mouse Up</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onOpenDetail.html">Sur ouverture corps</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onOpenExternalLink.html">On Open External Link</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onOutsideCall.html">Sur appel extérieur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onPageChange.html">Sur changement page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onPlugInArea.html">Sur appel zone du plug in</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onPrintingBreak.html">On Printing Break</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onPrintingDetail.html">On Printing Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onPrintingFooter.html">On Printing Footer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onResize.html">Sur redimensionnement</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onRowMoved.html">Sur déplacement ligne</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onRowResize.html">On Row Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onScroll.html">Sur défilement</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onSelectionChange.html">Sur nouvelle sélection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onTimer.html">Sur minuteur</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onUnload.html">On Unload</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onUrlFiltering.html">On URL Filtering</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onUrlLoadingError.html">On URL Loading Error</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onUrlResourceLoading.html">On URL Resource Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onValidate.html">Sur validation</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onVpRangeChanged.html">On VP Range Changed</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onVpReady.html">On VP Ready</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Events/onWindowOpeningDenied.html">On Window Opening Denied</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Menus<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Menus/overview.html">Aperçu</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Menus/creating.html">Créer des menus et des barres de menus</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Menus/properties.html">Propriétés des menus</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Menus/bars.html">Barres de menus</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Menus/sdi.html">Mode SDI sous Windows</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Build application<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/fr/Desktop/building.html">Générer un package projet</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/Rx/docs/API/IMAPTransporterClass.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">IMAPTransporter</h1></header><article><div><span><p>La classe <code>IMAPTransporter</code> vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP.</p>
<h3><a class="anchor" aria-hidden="true" id="objet-imap-transporter"></a><a href="#objet-imap-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objet IMAP Transporter</h3>
<p>Les objets IMAP Transporter sont instanciés avec la commande <a href="#imap-new-transporter">IMAP New transporter</a>. Leurs propriétés et fonctions sont les suivantes :</p>
<table>
<thead>
<tr><th></th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> if 4D is allowed to establish an unencrypted connection</td></tr>
<tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><p>    ajoute des flags (drapeaux) aux <code>msgIDs</code> pour les <code>keywords</code> définis</td></tr>
<tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><p>    ajoute l'objet <code>mailObj</code> à la boîte <code>destinationBox</code></td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    the authentication mode used to open the session on the mail server</td></tr>
<tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a><p>     checks the connection using information stored in the transporter object</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    durée maximale (en secondes) autorisée avant vérification de la connexion au serveur</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    the maximum wait time (in seconds) allowed to establish a connection to the server</td></tr>
<tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><p>    copie les messages définis dans <em>msgsIDs</em> ou <em>allMsgs</em> dans la <em>destinationBox</em> sur le serveur IMAP</td></tr>
<tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><p>    crée une nouvelle mailbox avec le <code>name</code> passé en paramètre</td></tr>
<tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>    associe le marqueur &quot;deleted&quot; aux messages désignés par <code>msgsIDs</code> ou <code>allMsgs</code></td></tr>
<tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><p>    supprime définitivement la boîte de réception nommée <code>name</code> sur le serveur IMAP</td></tr>
<tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a><p>    supprime tous les messages marqués &quot;deleted&quot; du serveur de messagerie IMAP.</td></tr>
<tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><p>    retourne un objet <code>boxInfo</code> correspondant à la boîte de réception courante ou à la boîte nommée <em>name</em></td></tr>
<tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><p>    retourne une collection de boites de réception décrivant toutes les boites de réception disponibles</td></tr>
<tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a><p>    retourne le caractère utilisé pour délimiter les niveaux de hiérarchie dans le nom de la boite de réception</td></tr>
<tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><p>    retourne l'objet <code>Email</code> correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boite de réception désignée par <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><p>    retourne un objet contenant une collection d'objets <code>Email</code></td></tr>
<tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><p>    retourne un BLOB avec le contenu MIME du message correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boîte de réception désignée par le <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    the name or the IP address of the host server</td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    the path of the extended log file defined (if any) for the mail connection</td></tr>
<tr><td>[</td></tr>
<tr><td><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object](#move)<p>    déplace les messages définis dans <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP</td></tr>
<tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><p>    convertit les numéros de séquence en IDs uniques IMAP pour les messages de la plage séquentielle désignée par <em>startMsg</em> et <em>endMsg</em></td></tr>
<tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><p>    supprime des flags (drapeaux) des <code>msgIDs</code> pour les <code>keywords</code> définis</td></tr>
<tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><p>    renomme une mailbox sur le serveur IMAP</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     the port number used for mail transactions</td></tr>
<tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><p>    recherche les messages qui correspondent aux critères de recherche <em>searchCriteria</em> dans la boîte de réception courante</td></tr>
<tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>    sélectionne la mailbox <em>name</em> comme étant la mailbox courante</td></tr>
<tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><p>    permet d'ajouter la mailbox spécifiée à l'ensemble des mailboxes auxquelles vous avez &quot;souscrit&quot; sur le serveur IMAP</td></tr>
<tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><p>    supprime la mailbox spécifiée de l'ensemble des mailboxes auxquelles vous avez &quot;souscrit&quot; sur le serveur IMAP</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     the user name used for authentication on the mail server</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="imap-new-transporter"></a><a href="#imap-new-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP New transporter</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr>
<tr><td>Résultat</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objet IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La commande <code>IMAP New transporter</code> configure une nouvelle connexion IMAP en fonction du paramètre <em>server</em> et retourne un nouvel objet <em>transporter</em>. L'objet transporteur retourné sera alors utilisé pour la réception d'emails.</p>
<p>Dans le paramètre <em>server</em>, passez un objet contenant les propriétés suivantes :</p>
<table>
<thead>
<tr><th><em>server</em></th><th>Valeur par défaut (si omise)</th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> if 4D is allowed to establish an unencrypted connection</td><td>Faux</td></tr>
<tr><td>.<strong>accessTokenOAuth2</strong> : Text<p>Chaîne représentant les informations d'autorisation OAuth2. Il est utilisé uniquement avec OAUTH2 <code>authenticationMode</code>. Si <code>accessTokenOAuth2</code> est utilisé mais que <code>authenticationMode</code> est omis, le protocole OAuth 2 est utilisé (si le serveur l'autorise). Non retourné en objet <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>aucune</td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    the authentication mode used to open the session on the mail server</td><td>le mode d'authentification le plus sûr pris en charge par le serveur est utilisé</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    durée maximale (en secondes) autorisée avant vérification de la connexion au serveur</td><td>300</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    the maximum wait time (in seconds) allowed to establish a connection to the server</td><td>30</td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    the name or the IP address of the host server</td><td><em>obligatoire</em></td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    the path of the extended log file defined (if any) for the mail connection</td><td>aucune</td></tr>
<tr><td>.<strong>password</strong> : Text<p>Mot de passe de l'utilisateur pour l'authentification sur le serveur. Non retourné en objet <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>aucune</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     the port number used for mail transactions</td><td>993</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     the user name used for authentication on the mail server</td><td>aucune</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="résultat"></a><a href="#résultat" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p>La fonction retourne un <a href="#imap-transporter-object"><strong>objet IMAP transporter</strong></a>. Toutes les propriétés retournées sont en <strong>lecture seule</strong>.</p>
<blockquote>
<p>La connexion IMAP est automatiquement fermée lorsque l'objet transporteur est détruit.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="exemple"></a><a href="#exemple" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object
<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
<span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>
<span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log à sauvegarder dans le dossier Logs</span><span class="hljs-keyword">

var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">
If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="4dimaptransporternew"></a><a href="#4dimaptransporternew" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4D.IMAPTransporter.new()</h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr>
<tr><td>Résultat</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objet IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-1"></a><a href="#description-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>4D.IMAPTransporter.new()</code> crée et retourne un nouvel objet de type <code>4D.IMAPTransporter</code>. Elle est identique à la commande <a href="#imap-new-transporter"><code>IMAP New transporter</code></a> (raccourci).</p>
<h2><a class="anchor" aria-hidden="true" id="acceptunsecureconnection"></a><a href="#acceptunsecureconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.acceptUnsecureConnection</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4><a class="anchor" aria-hidden="true" id="description-2"></a><a href="#description-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.acceptUnsecureConnection</code> property contains <strong>True</strong> if 4D is allowed to establish an unencrypted connection when encrypted connection is not possible.</p>
<p>Elle contient <strong>False</strong> si les connexions non chiffrées ne sont pas autorisées, auquel cas une erreur est retournée lorsque la connexion chiffrée n'est pas possible.</p>
<p>Ports sécurisés disponibles :</p>
<ul>
<li><p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur le prend en charge.</li>
</ul></li>
<li><p>IMAP</p>
<ul>
<li>143 : Port IMAP non chiffré</li>
<li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prend en charge</li>
</ul></li>
<li><p>POP3</p>
<ul>
<li>110 : Port POP3 non chiffré</li>
<li>995: POP3 with STARTTLS upgrade if supported by the server.</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="addflags"></a><a href="#addflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.addFlags()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d'un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr>
<tr><td>keywords</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mots-clés de flags à ajouter</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération addFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-3"></a><a href="#description-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.addFlags()</code> ajoute des flags (drapeaux) aux <code>msgIDs</code> pour les <code>keywords</code> définis.</p>
<p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p>
<ul>
<li><p>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</p></li>
<li><p>l'ID unique (<em>texte</em>) d'un seul message ou</p></li>
<li><p>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</p>
<table>
<thead>
<tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr>
</tbody>
</table>
</li>
</ul>
<p>Le paramètre <code>keywords</code> vous permet de passer un objet avec des valeurs de mots-clés pour les flags spécifiques à ajouter à <code>msgIDs</code>. Vous pouvez utiliser les mots-clés suivants :</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booléen</td><td>True pour ajouter le marqueur &quot;draft&quot; au message</td></tr>
<tr><td>$seen</td><td>Booléen</td><td>True pour ajouter le marqueur &quot;seen&quot; au message</td></tr>
<tr><td>$flagged</td><td>Booléen</td><td>True pour ajouter le marqueur &quot;flagged&quot; au message</td></tr>
<tr><td>$answered</td><td>Booléen</td><td>True pour ajouter le marqueur &quot;répondu&quot; au message</td></tr>
<tr><td>$deleted</td><td>Booléen</td><td>True pour ajouter le marqueur &quot;supprimé&quot; au message</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Les valeurs à faux sont ignorées.</li>
<li>L'interprétation des indicateurs de mots-clés peut varier selon le client de messagerie.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-1"></a><a href="#exemple-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Créer transporteur</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Sélectionner la boîte de messagerie</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Marquer tous les messages de la boite de réception (INBOX) comme étant lus/vus</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="append"></a><a href="#append" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.append()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>mailObj</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet email</td></tr>
<tr><td>destinationBox</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Mailbox devant recevoir l'objet email</td></tr>
<tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet contenant les informations de charset</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-4"></a><a href="#description-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.append()</code> ajoute l'objet <code>mailObj</code> à la boîte <code>destinationBox</code>.</p>
<p>Dans le paramètre <code>mailObj</code>, passez un objet email. Dans le paramètre <code>mailObj</code>, passez un objet email. La fonction <code>.append()</code> prend en charge les marqueurs de mots-clés dans l'attribut <code>keywords</code> des objets email.</p>
<p>Le paramètre optionnel <code>destinationBox</code> vous permet de passer le nom de la boîte de réception dans laquelle l'objet <code>mailObj</code> sera ajouté. S'il est omis, la mailbox courante sera utilisée.</p>
<p>Dans le paramètre optionnel <code>options</code>, vous pouvez passer un objet permettant de définir le charset et l'encodage des différentes parties de l'email. Propriétés disponibles :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>headerCharset</td><td>Texte</td><td>Charset et encodage utilisés pour les parties de mail suivantes : le sujet, les noms de fichiers joints et le nom du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr>
<tr><td>bodyCharset</td><td>Texte</td><td>Charset et encodage utilisés pour le contenu html et le texte du body du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr>
</tbody>
</table>
<p>Charsets possibles :</p>
<table>
<thead>
<tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr>
</thead>
<tbody>
<tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset : US-ASCII si possible, japonais (ISO-2022-JP) &amp; Quoted-printable si possible, sinon UTF-8 &amp; Quoted-printable</li><li>bodyCharset : US-ASCII si possible, japonais (ISO-2022-JP) et 7 bits si possible, sinon UTF-8 et Quoted-printable</li></ul></td></tr>
<tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr>
<tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; Quoted-printable (<strong>valeur par défaut</strong>)</td></tr>
<tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; base64</td></tr>
</tbody>
</table>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-2"></a><a href="#exemple-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Pour enregistrer un email dans la boîte Drafts :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object

<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)

<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)

<span class="hljs-variable">$msg</span>:=New object
<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span>
<span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span>
<span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span>
<span class="hljs-variable">$msg</span>.keywords:=New object
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marquer le message comme étant lu</span>
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marquer le message comme brouillon</span>

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="authenticationmode"></a><a href="#authenticationmode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.authenticationMode</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.authenticationMode</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="description-5"></a><a href="#description-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.authenticationMode</code> property contains the authentication mode used to open the session on the mail server.</p>
<p>Par défaut, le mode le plus sécurisé pris en charge par le serveur est utilisé.</p>
<p>Valeurs possibles :</p>
<table>
<thead>
<tr><th>Valeur</th><th>Constantes</th><th>Commentaire</th></tr>
</thead>
<tbody>
<tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentification à l'aide du protocole CRAM-MD5</td></tr>
<tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentification à l'aide du protocole LOGIN</td></tr>
<tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentification à l'aide du protocole OAuth2</td></tr>
<tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentification à l'aide du protocole PLAIN</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnection"></a><a href="#checkconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnection()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnection()</strong> : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Status of the transporter object connection</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-6"></a><a href="#description-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.checkConnection()</code> function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. This function allows you to verify that the values provided by the user are valid and consistent.</p>
<h4><a class="anchor" aria-hidden="true" id="objet-retourné"></a><a href="#objet-retourné" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objet retourné</h4>
<p>The function sends a request to the mail server and returns an object describing the mail status. Cet objet peut avoir les propriétés suivantes :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>boolean</td><td>Vrai si la vérification a été effectuée avec succès, sinon Faux</td></tr>
<tr><td>status</td><td></td><td>number</td><td>(SMTP uniquement) Code du statut retourné par le serveur de messagerie (0 en cas de problème non lié au traitement du mail)</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur de messagerie, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur de messagerie est reçue)</td></tr>
<tr><td></td><td>[ ].errCode</td><td>number</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[ ].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[ ].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnectiondelay"></a><a href="#checkconnectiondelay" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnectionDelay</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="description-7"></a><a href="#description-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La propriété <code>.checkConnectionDelay</code> contient la durée maximale (en secondes) autorisée avant vérification de la connexion au serveur.  Si cette durée est dépassée entre deux appels de méthodes, la connexion au serveur sera vérifiée. Par défaut, si la propriété n'a pas été définie dans l'objet <em>server</em>, la valeur est de 300.</p>
<blockquote>
<p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="connectiontimeout"></a><a href="#connectiontimeout" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.connectionTimeOut</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="description-8"></a><a href="#description-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.connectionTimeOut</code> property contains the maximum wait time (in seconds) allowed to establish a connection to the server. Par défaut, si la propriété n'a pas été définie dans l'objet server (utilisé pour créer l'objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), la valeur utilisée est 30.</p>
<h2><a class="anchor" aria-hidden="true" id="copy"></a><a href="#copy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.copy()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr>
<tr><td>destinationBox</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Boîte de réception recevant les messages copiés</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de copie</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-9"></a><a href="#description-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.copy()</code> copie les messages définis dans <em>msgsIDs</em> ou <em>allMsgs</em> dans la <em>destinationBox</em> sur le serveur IMAP.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à copier, ou</li>
<li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour copier tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages copiés.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-1-1"></a><a href="#exemple-1-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 1</h4>
<p>Pour copier une sélection de messages :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtenir la collection des IDs uniques de message</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// copier les messages identifiés dans la boîte de réception "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="exemple-2-1"></a><a href="#exemple-2-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 2</h4>
<p>Pour copier tous les messages de la boîte de réception courante :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>

 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// copier les messages dans la boîte de réception "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="createbox"></a><a href="#createbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.createBox()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la nouvelle mailbox</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de création de mailbox</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-10"></a><a href="#description-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.createBox()</code> crée une nouvelle mailbox avec le <code>name</code> passé en paramètre. Si le caractère séparateur de hiérarchie du serveur IMAP apparaît dans le nom de la mailbox, le serveur IMAP créera tous les boîtes parentes nécessaires pour créer la boîte donnée.</p>
<p>Par exemple, si vous essayez de créer &quot;Projects/IMAP/Doc&quot; dans un serveur dont le &quot;/&quot; est le caractère séparateur de hiérarchie, les éléments suivants seront créés :</p>
<ul>
<li>Uniquement la boîte &quot;Doc&quot; si &quot;Projects&quot; &amp; &quot;IMAP&quot; existent déjà.</li>
<li>Les boîtes &quot;IMAP&quot; &amp; &quot;Doc&quot; si seule “Projects” existe déjà.</li>
<li>Les boîtes &quot;Projects&quot; &amp; “IMAP” &amp; &quot;Doc&quot; si elles n'existent pas déjà.</li>
</ul>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à créer.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-3"></a><a href="#exemple-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Pour créer une nouvelle boîte “Invoices” :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">
If</span>(OK=<span class="hljs-number">1</span>)
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">
End for each</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="delete"></a><a href="#delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.delete()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de suppression</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-11"></a><a href="#description-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.delete()</code> associe le marqueur &quot;deleted&quot; aux messages désignés par <code>msgsIDs</code> ou <code>allMsgs</code>.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <code>msgsIDs</code>, une collection contenant les ID uniques des messages spécifiques à supprimer, ou</li>
<li>dans le paramètre <code>allMsgs</code>, la constante <code>IMAP all</code> (integer) pour supprimer tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>L'exécution de cette fonction ne supprime pas réellement les messages. Les messages ayant le marqueur &quot;deleted&quot; peuvent toujours être trouvés par la fonction <a href="#searchmails">.searchMails()</a>. Les messages marqués sont supprimés du serveur IMAP uniquement avec <a href="#expunge"><code>.expunge()</code></a> ou en sélectionnant une autre boîte de réception ou lorsque l'objet <a href="#imap-transporter-object">transporter</a> (créé avec <a href="#imap-new-transporter">IMAP New transporter</a>) est détruit.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-1-2"></a><a href="#exemple-1-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 1</h4>
<p>Pour supprimer une sélection de messages :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//obtenir la collection d'IDs unique des messages</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)

  <span class="hljs-comment">// Supprimer les messages sélectionnés</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="exemple-2-2"></a><a href="#exemple-2-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 2</h4>
<p>Pour supprimer tous les messages de la boîte de réception courante :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//selection de la boîte</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)

  <span class="hljs-comment">// suppression de tous les messages de la boîte courante</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="deletebox"></a><a href="#deletebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.deleteBox()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception à supprimer</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de suppression de boîte</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-12"></a><a href="#description-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.deleteBox()</code> supprime définitivement la boîte de réception nommée <code>name</code> sur le serveur IMAP. Si vous tentez de supprimer la boîte INBOX ou une boîte de réception qui n'existe pas, une erreur sera générée.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer.</p>
<blockquote>
<ul>
<li>La fonction ne peut pas supprimer une boîte de réception contenant des boîtes &quot;enfant&quot; si la boîte &quot;parente&quot; dispose de l'attribute &quot;\Noselect&quot;.</li>
<li>Tous les messages présents dans la boîte seront également supprimés.</li>
<li>La possibilité de supprimer une boîte de réception dépend du serveur de messagerie.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-4"></a><a href="#exemple-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Vous souhaitez supprimer la boîte enfant &quot;Nova Orion Industries&quot; à l'intérieur de la boîte &quot;Bills&quot; :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// delete mailbox</span>
<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">
    Else</span>
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
End if</span><span class="hljs-keyword">
    Else</span>
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="expunge"></a><a href="#expunge" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.expunge()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.expunge()</strong> : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération expunge</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-13"></a><a href="#description-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.expunge()</code> supprime tous les messages marqués &quot;deleted&quot; du serveur de messagerie IMAP. Le marqueur &quot;deleted&quot; peut être fixé avec les fonctions <a href="#delete"><code>.delete()</code></a> ou <a href="#addflags"><code>.addFlags()</code></a>.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-5"></a><a href="#exemple-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$ids </span>: Collection

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Creation du transporter</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Sélection de la boîte</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Chercher et sélectionner les messages lus dans INBOX</span>
<span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)

<span class="hljs-comment">// Purger tous les messages marqués deleted</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxinfo"></a><a href="#getboxinfo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxInfo()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td><em>name</em> est optionnel</td></tr>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-14"></a><a href="#description-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getBoxInfo()</code> retourne un objet <code>boxInfo</code> correspondant à la boîte de réception courante ou à la boîte nommée <em>name</em>. Cette fonction retourne les mêmes informations que <a href="#selectbox"><code>.selectBox()</code></a> mais sans modifier la boite de réception courante.</p>
<p>Dans le paramètre optionnel <em>name</em> passez le nom de la boite de réception à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l'aide de la fonction <a href="#getdelimiter"><code>.getDelimiter()</code></a>.</p>
<p>Si la boîte de réception nommée <em>name</em> n'est pas sélectionnable ou n'existe pas, la fonction génère une erreur et retourne <strong>null</strong>.</p>
<p><strong>Objet retourné</strong></p>
<p>L'objet <code>boxInfo</code> contient les propriété suivantes :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td>Nom de la boîte de réception</td></tr>
<tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Nombre de messages portant le marqueur &quot;récent&quot; (indiquant les nouveaux messages)</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-6"></a><a href="#exemple-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)
<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxlist"></a><a href="#getboxlist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxList()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
<tr><td>v19</td><td>Ajout paramètre <code>isSubscribed</code></td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>parameters</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet de paramètre</td></tr>
<tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection d'objets mailbox</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-15"></a><a href="#description-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getBoxList()</code> retourne une collection de boites de réception décrivant toutes les boites de réception disponibles. Cette fonction vous permet de gérer localement les listes de messages situés sur le serveur de messagerie IMAP.</p>
<p>Dans le paramètre optionnel <code>parameters</code>, passez un objet contenant des valeurs de filtrage des boîtes de réception retournées. Vous pouvez passer :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>isSubscribed</td><td>Booléen</td><td><li><strong>True</strong> pour retourner uniquement les boîtes auxquelles vous êtes abonné</li><li> <strong>False</strong> pour retourner toutes les boîtes de réception disponibles</li></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="résultat-1"></a><a href="#résultat-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p>Chaque objet de la collection retournée contient les propriétés suivantes :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>[].name</td><td>Texte</td><td>Nom de la boîte de réception</td></tr>
<tr><td>[].selectable</td><td>boolean</td><td>Indique si les droits d'accès permettent ou non à la boite de réception d'être sélectionnée : <ul><li>vrai - la boite de réception peut être sélectionnée</li><li>faux - la boite de réception ne peut pas être sélectionnée</li></ul></td></tr>
<tr><td>[].inferior</td><td>boolean</td><td>Indique si les droits d'accès permettent ou non la création d'une hiérarchie inférieure dans la boite de réception : <ul><li>vrai - un niveau inférieur peut être créé</li><li>faux - un niveau inférieur ne peut pas être créé</li></ul></td></tr>
<tr><td>[].interesting</td><td>boolean</td><td>Indique si la boite de réception a été marquée comme &quot;intéressante&quot; par le serveur : <ul><li>vrai - la boite de réception a été marquée comme &quot;intéressante&quot; par le serveur. Par exemple, elle peut contenir de nouveaux messages.</li><li>faux - la boite de réception n'a pas été marquée comme &quot;intéressante&quot; par le serveur.</li></ul></td></tr>
</tbody>
</table>
<p>Si le compte ne contient pas de boites de réception, une collection vide est retournée.</p>
<blockquote>
<ul>
<li>Si aucune connexion n'est ouverte, <code>.getBoxList()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis le délai de connexion (voir <code>IMAP New transporter</code>), la fonction <code>.checkConnection( )</code> est automatiquement appelée.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="exemple-7"></a><a href="#exemple-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getdelimiter"></a><a href="#getdelimiter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getDelimiter()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getDelimiter()</strong> : Text</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Résultat</td><td>Texte</td><td style="text-align:center">&lt;-</td><td>Caractère de délimitation de hiérarchie</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-16"></a><a href="#description-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getDelimiter()</code> retourne le caractère utilisé pour délimiter les niveaux de hiérarchie dans le nom de la boite de réception.</p>
<p>Le délimiteur est un caractère pouvant être utilisé pour :</p>
<ul>
<li>créer des boites de réception de niveau inférieur</li>
<li>rechercher des niveaux inférieurs ou supérieurs dans la hiérarchie de la boite de réception</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="résultat-2"></a><a href="#résultat-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p>Caractère de délimitation des noms de boites de réception.</p>
<blockquote>
<ul>
<li>Si aucune connexion n'est ouverte, <code>.getDelimiter()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis le <a href="#checkconnectiondelay">délai de connexion</a>, la fonction</li>
</ul>
</blockquote>
<p>`.checkConnection( )<code></a> est automatiquement appelée.</li></p>
  </ul>
</blockquote>
<p><h4 spaces-before="0">Exemple</h4></p>
<pre><code class="4d"> var $transporter : 4D.IMAPTransporter
 $transporter:=IMAP New transporter($server)
<p>$boxList:=$transporter.getBoxList()</p>
<p>For each($box;$boxList)
If($box.interesting)
$split:=Split string($box.name;$transporter.getDelimiter())
ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])
End if
End for each
`</pre></p>
<blockquote>
<pre><code class="hljs">## .getMail()

&lt;details&gt;&lt;summary&gt;Historique&lt;/summary&gt;
</code></pre>
</blockquote>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du message</td></tr>
<tr><td>msgID</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>ID unique du message</td></tr>
<tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Instructions sur la gestion du message</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td><a href="/docs/Rx/fr/API/EmailObjectClass.html#email-object">Objet email</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-17"></a><a href="#description-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getMail()</code> retourne l'objet <code>Email</code> correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boite de réception désignée par <code>IMAP_transporter</code>. Cette fonction vous permet de gérer localement le contenu de l'email.</p>
<p>Dans le premier paramètre, vous pouvez passer soit :</p>
<ul>
<li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li>
<li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID unique du message à récupérer.</li>
</ul>
<p>Le paramètre facultatif <em>options</em> vous permet de passer un objet définissant des instructions supplémentaires pour la gestion de votre message. Les propriétés suivantes sont disponibles :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>boolean</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message n'est pas marqué comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr>
<tr><td>withBody</td><td>boolean</td><td>Passez Vrai pour retourner le corps du message. Si Faux, seul l'en-tête du message est retourné. Valeur par défaut : Vrai</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>msgID</em> désigne un message non existant,</li>
<li>Si aucune boite de réception n'est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée,</li>
<li>Si aucune connexion n'est ouverte, <code>.getMail()</code> ouvrira une connexion avec la dernière boite de réception spécifiée par <a href="#selectbox"><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="résultat-3"></a><a href="#résultat-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p><code>.getMail()</code> retourne un <a href="/docs/Rx/fr/API/EmailObjectClass.html#objet-email"><code>objet Email</code></a> avec les propriétés IMAP supplémentaires suivantes : <em>id</em>, <em>receivedAt</em> et <em>size</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="exemple-8"></a><a href="#exemple-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Vous souhaitez lire le message avec ID = 1 :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//creation du transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//selection de la mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//récupération de l'objet Email d'ID 1</span>
 <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmails"></a><a href="#getmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMails()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'identifiants de messages</td></tr>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du premier message</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr>
<tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Instructions sur la gestion du message</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet contenant :<br><ul><li>une collection d'<a href="/docs/Rx/fr/API/EmailObjectClass.html#objet-email">objets Email</a> et</li><li>une collection d'identifiants ou de numéros des messages manquants, le cas échéant</li></ul></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-18"></a><a href="#description-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getMails()</code> retourne un objet contenant une collection d'objets <code>Email</code>.</p>
<p><strong>Première syntaxe :</strong></p>
<p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p>
<p>La première syntaxe vous permet de récupérer des messages en fonction de leurs identifiants.</p>
<p>Dans le paramètre <em>ids</em>, passez une collection d'identifiants des messages à retourner. Vous pouvez obtenir les ID à l'aide de <a href="#getmail"><code>.getMail()</code></a>.</p>
<p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner. Pour une description détaillée des propriétés disponibles, reportez-vous au tableau <strong>Options</strong> ci-dessous.</p>
<p><strong>Deuxième syntaxe :</strong></p>
<p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p>
<p>La deuxième syntaxe vous permet de récupérer des messages en fonction d'une plage séquentielle. Les valeurs passées représentent la position des messages dans la boite de réception.</p>
<p>Dans le paramètre <em>startMsg</em> passez une valeur <em>entier</em> correspondant au numéro du premier message dans une plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p>
<p>Dans le paramètre <em>endMsg</em> passez une valeur <em>entier long</em> correspondant au numéro du dernier message à inclure dans une plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p>
<p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner.</p>
<p><strong>Options</strong></p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>Booléen</td><td>Si Vrai, les messages sont marqués comme &quot;seen&quot; (lus) dans la boite de réception. Si Faux, les messages ne sont pas marqués comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr>
<tr><td>withBody</td><td>Booléen</td><td>Passez Vrai pour retourner le corps des messages spécifiés. Si Faux, seuls les en-tête des messages sont retournés. Valeur par défaut : Vrai</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Si aucune boite de réception n'est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée.</li>
<li>S'il n'y a pas de connexion ouverte, <code>.getMails()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l'aide de <a href="#selectbox"><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="résultat-4"></a><a href="#résultat-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p><code>.getMails()</code> retourne un objet contenant les collections suivantes :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>liste</td><td>Collection</td><td>Collection d'objets <a href="/docs/Rx/fr/API/EmailObjectClass.html#email-object"><code>Email</code></a>. Si aucun objet Email n'est trouvé, une collection vide est retournée.</td></tr>
<tr><td>notFound</td><td>Collection</td><td>Collection de :<br><ul><li>première syntaxe - IDs de messages passés antérieurement qui n'existent pas</li><li>deuxième syntaxe - numéros de séquence des messages entre startMsg et endMsg qui n'existent pas</li></ul>Une collection vide est retournée si tous les messages sont trouvés.</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-9"></a><a href="#exemple-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Vous souhaitez récupérer les 20 emails les plus récents sans modifier le statut &quot;seen&quot; :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//create transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">

  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)
        <span class="hljs-comment">// récupérer les en-têtes des 20 derniers messages sans les marquer comme lus</span>
    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\
<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">
    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)
        <span class="hljs-comment">// ...</span><span class="hljs-keyword">
    End for each</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmimeasblob"></a><a href="#getmimeasblob" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMIMEAsBlob()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du message</td></tr>
<tr><td>msgID</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>ID unique du message</td></tr>
<tr><td>updateSeen</td><td>Booléen</td><td style="text-align:center">-&gt;</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message demeure inchangé.</td></tr>
<tr><td>Résultat</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob de la chaine MIME retournée par le serveur mail</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-19"></a><a href="#description-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.getMIMEAsBlob()</code> retourne un BLOB avec le contenu MIME du message correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boîte de réception désignée par le <code>IMAP_transporter</code>.</p>
<p>Dans le premier paramètre, vous pouvez passer soit :</p>
<ul>
<li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li>
<li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID unique du message à récupérer.</li>
</ul>
<p>Le paramètre optionnel <em>updateSeen</em> vous permet d'indiquer si le message est marqué comme &quot;seen&quot; (lu) dans la boîte de réception. Vous pouvez passer :</p>
<ul>
<li><strong>Vrai</strong> - pour marquer le message comme &quot;seen&quot; (indiquant que le message a été lu)</li>
<li><strong>Faux</strong> - pour ne pas modifier le statut &quot;seen&quot; du message</li>
</ul>
<blockquote>
<ul>
<li>La fonction retourne un BLOB vide si <em>msgNumber</em> ou msgID désigne un message inexistant,</li>
<li>Si aucune boite de réception n'est sélectionnée avec la fonction <a href="#selectbox"><code>.selectBox()</code></a>, une erreur est générée,</li>
<li>S'il n'y a pas de connexion ouverte,<code>.getMIMEAsBlob()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l'aide de <code>.selectBox()</code>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="résultat-5"></a><a href="#résultat-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p><code>.getMIMEAsBlob()</code> retourne un <code>BLOB</code> qui peut être archivé dans une base de données ou converti en un objet <a href="/docs/Rx/fr/API/EmailObjectClass.html#objet-email"><code>Email</code></a> avec la commande <code>MAIL Convert from MIME</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="exemple-10"></a><a href="#exemple-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//créer transporteur</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//obtenir BLOB</span>
 <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="host"></a><a href="#host" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.host</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.host</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="description-20"></a><a href="#description-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.host</code> property contains the name or the IP address of the host server. Utilisée pour les échanges de courrier (SMTP, POP3, IMAP).</p>
<h2><a class="anchor" aria-hidden="true" id="logfile"></a><a href="#logfile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.logFile</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.logFile</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="description-21"></a><a href="#description-21" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.logFile</code> property contains the path of the extended log file defined (if any) for the mail connection. Elle peut être relative (au dossier Logs courant) ou absolue.</p>
<p>Contrairement aux fichiers log habituels (activés via la commande <code>SET DATABASE PARAMETER</code>), les fichiers log étendus stockent le contenu MIME de tous les emails envoyés et n'ont pas de limite de taille. Pour plus d'informations sur les fichiers log étendus, reportez-vous à :</p>
<ul>
<li><strong>Connexions SMTP</strong> - <a href="/docs/Rx/fr/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li>
<li><strong>Connexions POP3</strong> - <a href="/docs/Rx/fr/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li>
<li><strong>Connexions IMAP</strong> - <a href="/docs/Rx/fr/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="move"></a><a href="#move" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.move()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée</td></tr>
<tr><td>destinationBox</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Boîte de réception recevant les messages déplacés</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de déplacement</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-22"></a><a href="#description-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.move()</code> déplace les messages définis dans <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à déplacer, ou</li>
<li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour déplacer tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages déplacés.</p>
<blockquote>
<p>Cette fonction est uniquement prise en charge par les serveurs IMAP compatibles avec RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-1-3"></a><a href="#exemple-1-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 1</h4>
<p>Pour déplacer une sélection de messages :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtenir la collection d'IDs uniques des messages</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// déplacer les messages de la boite de réception courante vers la boite de réception "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="exemple-2-3"></a><a href="#exemple-2-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple 2</h4>
<p>Pour déplacer tous les messages de la boîte de réception courante :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// déplacer tous les messages de la boite de réception courante vers la boite de réception "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="numtoid"></a><a href="#numtoid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.numToID()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du premier message</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr>
<tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection d'identifiants de messages uniques</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-23"></a><a href="#description-23" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.numToID()</code> convertit les numéros de séquence en IDs uniques IMAP pour les messages de la plage séquentielle désignée par <em>startMsg</em> et <em>endMsg</em> dans la boîte de réception courante.</p>
<p>Dans le paramètre <em>startMsg</em>, passez une valeur integer correspondant au numéro du premier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p>
<p>Dans le paramètre <em>endMsg</em>, passez une valeur integer correspondant au numéro du dernier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p>
<h4><a class="anchor" aria-hidden="true" id="résultat-6"></a><a href="#résultat-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Résultat</h4>
<p>La fonction retourne une collection de chaînes (IDs uniques).</p>
<h4><a class="anchor" aria-hidden="true" id="exemple-11"></a><a href="#exemple-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//sélectionner la boite de réception</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtenir les IDs des 5 derniers messages reçus</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)

  <span class="hljs-comment">//supprimer les messages de la boite de réception courante</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="removeflags"></a><a href="#removeflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.removeFlags()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d'un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr>
<tr><td>keywords</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mots-clés de flags à supprimer</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération removeFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-24"></a><a href="#description-24" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.removeFlags()</code> supprime des flags (drapeaux) des <code>msgIDs</code> pour les <code>keywords</code> définis.</p>
<p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p>
<ul>
<li><p>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</p></li>
<li><p>l'ID unique (<em>texte</em>) d'un seul message ou</p></li>
<li><p>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</p>
<table>
<thead>
<tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr>
</tbody>
</table>
</li>
</ul>
<p>Le paramètre <code>keywords</code> vous permet de passer un objet avec des valeurs de mots-clés pour les flags spécifiques à supprimer des <code>msgIDs</code>. Vous pouvez utiliser les mots-clés suivants :</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booléen</td><td>True pour supprimer le marqueur &quot;draft&quot; du message</td></tr>
<tr><td>$seen</td><td>Booléen</td><td>True pour supprimer le marqueur &quot;seen&quot; du message</td></tr>
<tr><td>$flagged</td><td>Booléen</td><td>True pour supprimer le marqueur &quot;flagged&quot; du message</td></tr>
<tr><td>$answered</td><td>Booléen</td><td>True pour supprimer le marqueur &quot;answered&quot; du message</td></tr>
<tr><td>$deleted</td><td>Booléen</td><td>True pour supprimer le marqueur &quot;deleted&quot; du message</td></tr>
</tbody>
</table>
<p>Les valeurs à faux sont ignorées.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-12"></a><a href="#exemple-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Créer le transporteur</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Sélectionner la boite de réception</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Marquer tous les messages de la boite de réception comme étant non vus</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="renamebox"></a><a href="#renamebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.renameBox()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>currentName</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom actuel de la boîte de réception</td></tr>
<tr><td>newName</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nouveau nom de la boîte de réception</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération renaming</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-25"></a><a href="#description-25" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.renameBox()</code> renomme une mailbox sur le serveur IMAP. Essayer de renommer une mailbox qui n'existe pas ou de renommer une mailbox avec un nom qui est déjà utilisé génère une erreur.</p>
<p>Dans le paramètre <code>currentName</code>, passez le nom de la mailbox à renommer.</p>
<p>Passez le nouveau nom de la mailbox dans e paramètre <code>newName</code>.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-13"></a><a href="#exemple-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Pour renommer la mailbox “Invoices” en “Bills”:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// renommer la boite de réception</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
 End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="port"></a><a href="#port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.port</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.port</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="description-26"></a><a href="#description-26" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.port</code> property contains  the port number used for mail transactions. Par défaut, si la propriété <em>port</em> n'a pas été définie dans l'objet <em>server</em> (utilisé pour créer l'objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), le port utilisé est :</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="searchmails"></a><a href="#searchmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.searchMails()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>searchCriteria</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Critère(s) de recherche</td></tr>
<tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection de numéros de messages</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-27"></a><a href="#description-27" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<blockquote>
<p>Cette fonction est basée sur la spécification du <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">protocole IMAP</a>.</p>
</blockquote>
<p>La fonction <code>.searchMails()</code> recherche les messages qui correspondent aux critères de recherche <em>searchCriteria</em> dans la boîte de réception courante. Le paramètre <em>searchCriteria</em> contient un ou plusieurs mots-clés de recherche.</p>
<p><em>searchCriteria</em> est un paramètre texte listant un ou plusieurs critères de recherche (voir <a href="#mots-cles-de-recherche-autorises">Mots-clés de recherche autorisés</a> ci-dessous) associés ou non à des valeurs à rechercher. Un critère de recherche peut être composé d'un ou plusieurs éléments. Par exemple :</p>
<pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED
<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED
<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT
</code></pre>
<blockquote>
<p>La correspondance n'est généralement pas sensible à la casse</p>
</blockquote>
<ul>
<li>Si <em>searchCriteria</em> est une chaîne vide, la recherche sera équivalente à un &quot;tout sélectionner&quot;.</li>
<li>Si <em>searchCriteria</em> contient plusieurs mots-clés de recherche, le résultat est l'intersection (fonction ET) de tous les messages qui correspondent à ces critères.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span>
</code></pre>
<p>... retourne tous les messages comportant le marqueur \Flagged ET envoyés par Smith.</p>
<ul>
<li>Vous pouvez utiliser les opérateurs <strong>OR</strong> ou <strong>NOT</strong> comme suit :</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED
</code></pre>
<p>... retourne tous les messages comportant le marqueur \Seen OU \Flagged</p>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN
</code></pre>
<p>... retourne tous les messages ne comportant pas le marqueur \Seen.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span>
</code></pre>
<p>... retourne les messages dont l'en-tête content-type contient “Mixed” et ne contient pas “Text”.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"
</code></pre>
<p>... retourne les messages dont l'en-tête content-type contient “ e ” et dont l'en-tête Subject ne contient pas “ o ” et dont l'en-tête content-type n'est pas “ Mixed ”.</p>
<p>A noter que dans les deux derniers exemples, le résultat de la recherche est différent lorsque vous enlevez les parenthèses de la première liste de mots-clés.</p>
<ul>
<li>Le paramètre <em>searchCriteria</em> peut inclure optionnellement l'instruction [CHARSET]. Cette instruction est composée du mot &quot;CHARSET&quot; suivi d'un jeu de caractères défini [CHARSET] (US ASCII, ISO-8859). Elle indique le codage de caractères utilisé dans la chaine <em>searchCriteria</em>. Par conséquent, vous devez convertir la chaîne <em>searchCriteria</em> dans le jeu de caractères spécifié si vous utilisez l'instruction [CHARSET] (voir les commandes <code>CONVERT FROM TEXT</code> ou <code>Convert to text</code>). Par défaut, 4D encode la chaîne de critères searchCriteria en &quot;Quotable Printable&quot; si elle contient des caractères étendus.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span>
</code></pre>
<p>signifie que le critère de recherche utilise le jeu de caractères iso-8859 et que le serveur devra convertir la chaîne avant la recherche, si nécessaire.</p>
<h4><a class="anchor" aria-hidden="true" id="types-de-valeurs-de-recherche"></a><a href="#types-de-valeurs-de-recherche" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Types de valeurs de recherche</h4>
<p>Les mots-clés de recherche peuvent traiter des valeurs des types suivants :</p>
<ul>
<li><p><strong>Valeurs de type date</strong> : Les valeurs de type date sont placées dans des chaînes formatées de la manière suivante : <em>date-day+&quot;-&quot;+date-month+&quot;-&quot;+date-year</em> où date-day indique la date du jour dans le mois (2 caractères maxi), date-month indique le mois (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) et date-year indique l’année sur 4 chiffres. Exemple : <code>searchCriteria = SENTBEFORE 1-Feb-2020</code>(il n’est généralement pas nécessaire de mettre une date entre guillemets puisqu’elle ne contient pas de caractères spéciaux)</p></li>
<li><p>**Valeurs de type chaîne ** : Les valeurs de type chaîne peuvent contenir tout type de caractère et doivent être placées entre des guillemets. Toutefois, si la chaîne ne contient pas de caractères spéciaux (des espaces par exemple), les guillemets ne sont pas obligatoires. Dans tous les cas, les guillemets vous permettent de vous assurer que la chaîne sera correctement interprétée. Exemple : <code>searchCriteria = FROM &quot;SMITH&quot;</code> Les recherches basées sur des chaînes de caractères sont du type “contient” : si le champ d’un message contient au moins la chaîne recherchée, le message est trouvé. La recherche ne tient pas compte de la casse des caractères.</p></li>
<li><p><strong>Noms de champs</strong> : Les valeurs de type nom de champ contiennent le nom d’un champ d’en-tête. Exemple : <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li>
<li><p><strong>Marqueurs</strong> : Les valeurs de type marqueur (flags) acceptent un ou plusieurs mots-clés (y compris des marqueurs standard) séparés par des espaces. Exemple : <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li>
<li><p><strong>Ensemble de messages</strong> : Les valeurs de ce type désignent un ensemble de messages. Elles contiennent une liste de numéros de messages dans un ordre croissant, de 1 au nombre total de messages dans la boîte aux lettres. Les numéros sont séparés par des virgules ; un deux-points (:) indique un intervalle (inclusif) de numéros. Exemples : <code>2,4:7,9,12:*</code> représente les messages <code>2,4,5,6,7,9,12,13,14,15</code> pour une mailbox contenant 15 messages. <code>searchCriteria = 1:5 ANSWERED</code> recherche, parmi les messages 1 à 5, ceux qui comportent le marqueur \Answered. <code>searchCriteria= 2,4 ANSWERED</code> recherche, parmi les messages 2 et 4, ceux qui comportent le marqueur \Answered.</p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="mots-clés-de-recherche-autorisés"></a><a href="#mots-clés-de-recherche-autorisés" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mots-clés de recherche autorisés</h4>
<p><strong>ALL</strong>: Tous les messages de la boîte de réception.<br>
<strong>ANSWERED</strong>: Messages comportant le marqueur \Answered.<br>
<strong>UNANSWERED</strong>: Messages ne comportant pas le marqueur \Answered.<br>
<strong>DELETED</strong>: Messages comportant le marqueur \Deleted.<br>
<strong>UNDELETED</strong>: Messages ne comportant pas le marqueur \Deleted.<br>
<strong>DRAFT</strong>: Messages comportant le marqueur \Draft.<br>
<strong>UNDRAFT</strong>: Messages ne comportant pas le marqueur \Draft.<br>
<strong>FLAGGED</strong>: Messages comportant le marqueur \Flagged.<br>
<strong>UNFLAGGED</strong>: Messages ne comportant pas le marqueur \Flagged.<br>
<strong>RECENT</strong>: Messages comportant le marqueur \Recent.<br>
<strong>OLD</strong>: Messages ne comportant pas le marqueur \Recent.<br>
<strong>SEEN</strong>: Messages comportant le marqueur \Seen.<br>
<strong>UNSEEN</strong>: Messages ne comportant pas le marqueur \Seen.<br>
<strong>NEW</strong>: Messages comportant le marqueur \Recent et pas le marqueur \Seen. Equivaut à “(RECENT UNSEEN)”.<br>
<strong>KEYWORD marqueur</strong> <flag>: Messages comportant le marqueur spécifié.<br>
<strong>UNKEYWORD marqueur</strong> <flag>: Messages ne comportant pas le marqueur spécifié.<br>
<strong>BEFORE date</strong> <date>: Messages dont la date interne est antérieure à la date spécifiée.<br>
<strong>ON date</strong> <date>: Messages dont la date interne est égale à la date spécifiée.<br>
<strong>SINCE date</strong> <date>: Messages dont la date interne est égale ou postérieure à la date spécifiée.<br>
<strong>SENTBEFORE date</strong> <date>: Messages dont l’en-tête Date est antérieur à la date spécifiée.<br>
<strong>SENTON date</strong> <date>: Messages dont l’en-tête Date est égal à la date spécifiée.<br>
<strong>SENTSINCE</strong> <date>: Messages whose Date header is within or later than the specified date.<br>
<strong>TO</strong> <string>: Messages that contain the specified string in the TO header.<br>
<strong>FROM</strong> <string>: Messages that contain the specified string in the FROM header.<br>
<strong>CC</strong> <string>: Messages that contain the specified string in the CC header.<br>
<strong>BCC</strong> <string>: Messages that contain the specified string in the BCC header.<br>
<strong>SUBJECT</strong> <string>: Messages that contain the specified string in the Subject header.<br>
<strong>BODY</strong> <string>: Messages that contain the specified string in the message body.<br>
<strong>TEXT</strong> <string>: Messages that contain the specified string in the header or in the message body.<br>
<strong>HEADER</strong> &lt;field-name&gt; <string>: Messages that have a header with the specified field-name and that contain the specified string in the field-body.<br>
<strong>UID</strong> <message UID>: Messages with unique identifiers corresponding to the specified unique identifier set.<br>
<strong>LARGER</strong> <n>: Messages with a size larger than the specified number of bytes.<br>
<strong>SMALLER</strong> <n>: Messages with a size smaller than the specified number of bytes.<br>
<strong>NOT</strong> &lt;search-key&gt;: Messages that do not match the specified search key.<br>
<strong>OU</strong> &lt;search-key1&gt; &lt;search-key2&gt;: Messages that match either search key.</p>
<h2><a class="anchor" aria-hidden="true" id="selectbox"></a><a href="#selectbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.selectBox()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr>
<tr><td>state</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Statut de l'accès à la boite de réception</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-28"></a><a href="#description-28" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.selectBox()</code> sélectionne la mailbox <em>name</em> comme étant la mailbox courante. Cette fonction vous permet de récupérer des informations sur la boite de réception.</p>
<blockquote>
<p>Pour lire les informations à partir d'une mailbox sans changer la mailbox courante, utilisez <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>Dans le paramètre <em>name</em> passez le nom de la mailbox à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l'aide de la fonction <a href="#getdelimiter"><code>.getDelimiter()</code></a>.</p>
<p>Le paramètre optionnel <em>state</em> définit le type d'accès à la mailbox. Les valeurs possibles sont les suivantes :</p>
<table>
<thead>
<tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr>
</thead>
<tbody>
<tr><td>IMAP read only state</td><td>1</td><td>La mailbox sélectionnée est accessible avec les privilèges de lecture seule. Les messages contenant un marqueur &quot;recent&quot; (indication de nouveaux messages) restent inchangés.</td></tr>
<tr><td>IMAP read write state</td><td>0</td><td>La mailbox sélectionnée est accessible avec des privilèges de lecture et d'écriture. Les messages sont considérés &quot;seen&quot; et perdent le marqueur &quot;recent&quot; (indication des nouveaux messages). (Valeur par défaut)</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>name</em> désigne une mailbox inexistante.</li>
<li>Si aucune connexion n'est ouverte, <code>.selectBox()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis le délai de connexion (voir <code>IMAP New transporter</code>), la fonction <a href="#checkconnection"><code>.checkConnection( )</code></a> est automatiquement appelée.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>L'objet <code>boxInfo</code> contient les propriété suivantes :</p>
<table>
<thead>
<tr><th>Propriété</th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td>Nom de la boîte de réception</td></tr>
<tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Nombre de messages avec le marqueur &quot;recent&quot;</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-14"></a><a href="#exemple-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object
 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword">

 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="subscribe"></a><a href="#subscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.subscribe()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération subscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-29"></a><a href="#description-29" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.subscribe()</code> permet d'ajouter la mailbox spécifiée à l'ensemble des mailboxes auxquelles vous avez &quot;souscrit&quot; sur le serveur IMAP. Ainsi, vous pouvez contrôler la taille de la liste des boîtes de réception disponibles en souscrivant uniquement à celles que vous souhaitez généralement consulter.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à ajouter (subscribe) à la liste de mailboxes auxquelles vous avez &quot;souscrit&quot;.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-15"></a><a href="#exemple-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Pour souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span><span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="unsubscribe"></a><a href="#unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.unsubscribe()</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texte</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr>
<tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération unsubscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="description-30"></a><a href="#description-30" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>La fonction <code>.unsubscribe()</code> supprime la mailbox spécifiée de l'ensemble des mailboxes auxquelles vous avez &quot;souscrit&quot; sur le serveur IMAP. Elle vous permet de réduire le nombre de mailboxes que vous consultez régulièrement.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer (unsubscribe) de la liste de mailboxes auxquelles vous avez &quot;souscrit&quot;.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>
<table>
<thead>
<tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr>
<tr><td>statusText</td><td></td><td>Texte</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr>
<tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texte</td><td>Description de l'erreur 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texte</td><td>Signature du composant interne qui a retourné l'erreur</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="exemple-16"></a><a href="#exemple-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h4>
<p>Pour ne plus souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span><span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="user"></a><a href="#user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.user</h2>
<p><details><summary>Historique</summary></p>
<table>
<thead>
<tr><th>Version</th><th>Modifications</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Ajout</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.user</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="description-31"></a><a href="#description-31" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h4>
<p>The <code>.user</code> property contains  the user name used for authentication on the mail server.</p>
<style> h2 { background: #d9ebff;}</style>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/Rx/fr/API/FunctionClass.html"><span class="arrow-prev">← </span><span>Formula</span></a><a class="docs-next button" href="/docs/Rx/fr/API/MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#imap-new-transporter">IMAP New transporter</a></li><li><a href="#4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#addflags">.addFlags()</a></li><li><a href="#append">.append()</a></li><li><a href="#authenticationmode">.authenticationMode</a></li><li><a href="#checkconnection">.checkConnection()</a></li><li><a href="#checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#connectiontimeout">.connectionTimeOut</a></li><li><a href="#copy">.copy()</a></li><li><a href="#createbox">.createBox()</a></li><li><a href="#delete">.delete()</a></li><li><a href="#deletebox">.deleteBox()</a></li><li><a href="#expunge">.expunge()</a></li><li><a href="#getboxinfo">.getBoxInfo()</a></li><li><a href="#getboxlist">.getBoxList()</a></li><li><a href="#getdelimiter">.getDelimiter()</a></li><li><a href="#getmails">.getMails()</a></li><li><a href="#getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#host">.host</a></li><li><a href="#logfile">.logFile</a></li><li><a href="#move">.move()</a></li><li><a href="#numtoid">.numToID()</a></li><li><a href="#removeflags">.removeFlags()</a></li><li><a href="#renamebox">.renameBox()</a></li><li><a href="#port">.port</a></li><li><a href="#searchmails">.searchMails()</a></li><li><a href="#selectbox">.selectBox()</a></li><li><a href="#subscribe">.subscribe()</a></li><li><a href="#unsubscribe">.unsubscribe()</a></li><li><a href="#user">.user</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/Rx/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:fr","version:19 R2"]}
              });
            </script></body></html>