<!DOCTYPE html><html lang="ja"><head><meta name="docsearch:version" content="19 R4"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Formulas and Functions · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## フォーミュラの使い方"/><meta name="docsearch:language" content="ja"/><meta property="og:title" content="Formulas and Functions · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/Rx/index.html"/><meta property="og:description" content="## フォーミュラの使い方"/><meta property="og:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><link rel="shortcut icon" href="/docs/Rx/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/Rx/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/Rx/js/code-blocks-buttons.js"></script><script src="/docs/Rx/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/Rx/css/main.css"/><script src="/docs/Rx/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/Rx/ja"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R5 BETA</a></li><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs/Rx" target="_self">v19 R4</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/Rx/img/language.svg" alt="Languages icon"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/Rx/en/ViewPro/formulas.html">English</a></li><li><a href="/docs/Rx/de/ViewPro/formulas.html">Deutsch</a></li><li><a href="/docs/Rx/es/ViewPro/formulas.html">Español</a></li><li><a href="/docs/Rx/fr/ViewPro/formulas.html">Français</a></li><li><a href="/docs/Rx/pt/ViewPro/formulas.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>4D View Pro</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Extensions<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Extensions/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Extensions/develop-components.html">Developing Components</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Extensions/develop-plug-ins.html">Developing Plug-ins</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">4D View Pro<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ViewPro/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ViewPro/configuring.html">Configuring 4D View Pro Areas</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Rx/ja/ViewPro/formulas.html">Formulas and Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ViewPro/method-list.html">Method List</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/Rx/docs/ViewPro/formulas.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Formulas and Functions</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="フォーミュラの使い方"></a><a href="#フォーミュラの使い方" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>フォーミュラの使い方</h2>
<p>スプレッドシートのフォーミュラとは、セルの値を計算する式のことです。</p>
<h3><a class="anchor" aria-hidden="true" id="フォーミュラの入力"></a><a href="#フォーミュラの入力" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>フォーミュラの入力</h3>
<p>4D View Pro エリアにフォーミュラを入力するには:</p>
<ol>
<li>フォーミュラを入力するセルを選択します。</li>
<li>= (等号) を入力します。</li>
<li>フォーミュラを入力し、<strong>Enter</strong>キーを入力します。</li>
</ol>
<p>フォーミュラ入力の際には、次のショートカットを使うことができます:</p>
<ul>
<li>フォーミュラにセル参照を入力する代わりに、参照するセルをクリックします:</li>
</ul>
<p><img src="/docs/Rx/assets/en/ViewPro/formulas.PNG" alt=""></p>
<ul>
<li>入力したい関数の頭文字を入力します。 すると、利用可能な関数と参照の一覧がポップアップメニューに表示され、必要な要素を選択することができます:</li>
</ul>
<p><img src="/docs/Rx/assets/en/ViewPro/formula2.PNG" alt=""></p>
<p>また、命名フォーミュラを作成すると、その名前で呼び出すことが可能です。 この場合、<a href="/docs/Rx/ja/ViewPro/method-list.html#vp-add-formula-name">VP ADD FORMULA NAME</a> コマンドを使用して命名フォーミュラを入力します。</p>
<h3><a class="anchor" aria-hidden="true" id="演算子とオペランド"></a><a href="#演算子とオペランド" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>演算子とオペランド</h3>
<p>すべてのフォーミュラはオペランドと演算子から成り立っています:</p>
<ul>
<li><strong>演算子</strong>: 後述の <a href="#値と演算子">値と演算子</a> 参照。</li>
<li><strong>オペランド</strong> は、いくつかのカテゴリーに分けられます:
<ul>
<li><a href="#値と演算子">値</a> (5つのデータ型がサポートされています)</li>
<li><a href="#セル参照">他のセルへの参照</a> (相対参照、絶対参照、ミックス参照、あるいは名前での参照)</li>
<li><a href="#ビルトインファンクション">標準のスプレッドシートファンクション (関数)</a></li>
<li>4Dフォーミュラに基づく <a href="#4dファンクション">4Dファンクション</a> (4D変数、フィールド、メソッド、コマンド、式が利用可能です)</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="値と演算子"></a><a href="#値と演算子" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>値と演算子</h2>
<p>4D View Pro は 5つのデータ型をサポートします。 それぞれのデータ型について、特定の定数と演算子がサポートされています。</p>
<table>
<thead>
<tr><th>データ型</th><th>値</th><th>演算子</th></tr>
</thead>
<tbody>
<tr><td><a href="/docs/Rx/ja/Concepts/number.html">数値</a></td><td>1.2<br>1.2 E3<br>1.2E-3<br>10.3x</td><td>+ (加法)<br>- (減法)<br>* (乗法)<br>/ (除法)<br>^ (べき乗、数値を自身に対してかける回数)<br>% (パーセント -- 演算子の前の数値を100で割る)</td></tr>
<tr><td><a href="/docs/Rx/ja/Concepts/date.html">日付</a></td><td>10/24/2017</td><td>+ (日付 + 日数 -&gt; 日付)<br>+ (日付 + 時間 -&gt; 日付 + その日の時間)<br>- (日付 - 日数 -&gt; 日付)<br>- (日付 - 日付 -&gt; 2つの日付間の日数)</td></tr>
<tr><td><a href="/docs/Rx/ja/Concepts/time.html">時間</a></td><td>10:12:10</td><td>経過時間演算子:<p>+ (加法)<br>- (減法)<br>* (経過時間 * 数値 -&gt; 経過時間)<br>/ (経過時間 / 数値 -&gt; 経過時間)</td></tr>
<tr><td><a href="/docs/Rx/ja/Concepts/string.html">String</a></td><td>'Sophie' または &quot;Sophie&quot;</td><td>&amp; (連結)</td></tr>
<tr><td><a href="/docs/Rx/ja/Concepts/boolean.html">ブール</a></td><td>TRUE または FALSE</td><td>-</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="比較演算子"></a><a href="#比較演算子" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>比較演算子</h3>
<p>同じ型の 2つのオペランドに対して以下の演算子を使用することができます:</p>
<table>
<thead>
<tr><th>演算子</th><th>比較</th></tr>
</thead>
<tbody>
<tr><td>=</td><td>等しい</td></tr>
<tr><td>&lt;&gt;</td><td>異なる</td></tr>
<tr><td>&gt;</td><td>大きい</td></tr>
<tr><td>&lt;</td><td>小さい</td></tr>
<tr><td>&gt;=</td><td>以上</td></tr>
<tr><td>&lt;=</td><td>以下</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="演算子の優先順位"></a><a href="#演算子の優先順位" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>演算子の優先順位</h3>
<p>以下は演算子を優先度順に並べたものです (優先度が高い方が上):</p>
<table>
<thead>
<tr><th>演算子</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>()</td><td>カッコ (グループ化)</td></tr>
<tr><td>-</td><td>否定</td></tr>
<tr><td>+</td><td>追加</td></tr>
<tr><td>%</td><td>パーセント</td></tr>
<tr><td>^</td><td>べき乗</td></tr>
<tr><td>* と /</td><td>乗法と除法</td></tr>
<tr><td>+ と -</td><td>加法と減法</td></tr>
<tr><td>&amp;</td><td>連結</td></tr>
<tr><td>=  &gt; &lt; &gt;= &lt;= &lt;&gt;</td><td>比較</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="セル参照"></a><a href="#セル参照" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>セル参照</h2>
<p>フォーミュラ (式) は多くの場合、セルアドレスを使って他のセルを参照します。 このような式を他のセルにコピーすることも可能です。 たとえば、C8 に入力された以下の式では、すぐ上にある 2つのセルの値を足して結果を表示します。</p>
<pre><code class="hljs"><span class="hljs-section">= C6 + C7</span>
</code></pre>
<p>この式はセル C6 と C7 を参照します。 つまり、式内で使用する値については他のセルを参照するよう、4D View Pro に指示しています。</p>
<p>こういった式を別のセルにコピーあるいは移動させた場合、式内のセルアドレスは参照の仕方によって連動して変化したり変化しなかったりします。</p>
<ul>
<li>参照が変化するものは <strong>相対参照</strong> と呼ばれ、式が入っているセルを基準として、相対的にどれだけ上下左右に離れているかでセルを参照します。</li>
<li>常に特定のセルを参照するものは <strong>絶対参照</strong> と呼ばれます。</li>
<li>また、複合参照といって、特定の行あるいはカラムに参照を固定することもできます。</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="参照の記法"></a><a href="#参照の記法" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照の記法</h3>
<p>セル座標 ( <code>C5</code> など) のみを使用すると、4D View Pro はそれを相対参照として解釈します。 文字と数字の前に $ (ドル) 記号を入れることで、参照を絶対参照にすることができます (例: <code>$C$5</code>)。</p>
<p>ドル記号を文字あるいは数字の前だけに入れることで相対参照と絶対参照を組み合わせることができます (例: <code>$C5</code>、<code>C$5</code>)。 複合参照を使用すると、行かカラムを絶対参照として指定しながら、もう片方については相対的に参照させることが可能になります。</p>
<p>素早くかつ正確に絶対参照を指定するには、セルを命名し、その名前をセルアドレス代わりに使用する方法があります。 命名セルへの参照は常に絶対参照です。 命名セルまたは命名セルレンジを作成・編集するには、<a href="/docs/Rx/ja/ViewPro/method-list.html#vp-add-range-name"><code>VP ADD RANGE NAME</code></a> メソッドを使用します。</p>
<p>以下の表は異なる記法による効果をまとめたものです:</p>
<table>
<thead>
<tr><th>例題</th><th>参照タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>C5</td><td>相対</td><td>参照は相対的にセル C5 を指しており、参照が最初に使用されたセルが位置の基準となります。</td></tr>
<tr><td>$C$5</td><td>絶対</td><td>参照は絶対参照です。 どこで使用されるかにかかわらず、常にセル C5 を参照します。</td></tr>
<tr><td>$C5</td><td>Mixed</td><td>常にカラム C を参照しますが、行の参照は相対的で、参照が最初に使用されたセルを基準に決まります。</td></tr>
<tr><td>C$5</td><td>Mixed</td><td>常に 5行目を参照しますが、カラムの参照は相対的で、参照が最初に使用されたセルを基準に決まります。</td></tr>
<tr><td>セル名</td><td>絶対</td><td>参照は絶対参照です。 どこで使用されるかにかかわらず、常に <a href="/docs/Rx/ja/ViewPro/method-list.html#vp-add-range-name">命名されたセルまたはレンジ</a> を参照します。</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="ビルトインファンクション"></a><a href="#ビルトインファンクション" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ビルトインファンクション</h2>
<p>スプレッドシートのファンクションとは、セルの値を計算する規定のフォーミュラのことで、関数とも呼ばれます。 入力したい関数の頭文字を入力すると、利用可能な関数と参照の一覧がポップアップメニューに表示され、必要な要素を選択することができます:</p>
<p><img src="/docs/Rx/assets/en/ViewPro/vpFormula2.PNG" alt=""></p>
<p>詳細や例題については <a href="https://www.grapecity.com/spreadjs/docs/v14/online/FormulaFunctions.html"><strong>SpreadJS's extented list of functions</strong></a> (英文) を参照ください。</p>
<h2><a class="anchor" aria-hidden="true" id="4dファンクション"></a><a href="#4dファンクション" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4Dファンクション</h2>
<p>4D View Pro では、<a href="/docs/Rx/ja/API/FunctionClass.html">4Dフォーミュラ</a> を実行する <strong>4Dカスタムファンクション</strong> を定義・使用することができます。 4Dカスタムファンクションを使用すると、4D View Pro ドキュメントの可能性が広がり、4Dデータベースとの強力な連携が可能になります。</p>
<p>4Dカスタムファンクションを使用すると、4D View Pro のフォーミュラ内で以下が利用可能になります:</p>
<ul>
<li>4Dプロセス変数</li>
<li>フィールド</li>
<li>プロジェクトメソッド</li>
<li>4Dランゲージコマンド</li>
<li>または、有効な 4D式</li>
</ul>
<p>4Dカスタムファンクションは、4D View Pro エリアから <a href="#引数">引数</a> を受け取り、値を返すことができます。</p>
<p>これらのカスタムファンクションは <a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-custom-functions"><code>VP SET CUSTOM FUNCTIONS</code></a> メソッドを使って宣言します。 例:</p>
<pre><code class="hljs css language-4d">o:=New object

<span class="hljs-comment">// 4D View Pro におけるファンクション名: "DRIVERS_LICENCE"</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=New object

<span class="hljs-comment">// プロセス変数</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicence)

<span class="hljs-comment">// テブルフィールド</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>([Users]DriverLicence)

<span class="hljs-comment">// プロジェクトメソッド</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicenceState)

<span class="hljs-comment">// 4Dコマンド</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Choose</span>(DriverLicence; <span class="hljs-string">"Obtained"</span>; <span class="hljs-string">"Failed"</span>))

<span class="hljs-comment">//4D式と引数</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(ds.Users.<span class="hljs-function">get</span>(<span class="hljs-variable">$1</span>).DriverLicence)
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters:=New collection
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>; <span class="hljs-string">"ID"</span>; <span class="hljs-string">"type"</span>; Is longint))
</code></pre>
<blockquote>
<p><a href="https://blog.4d.com/4d-view-pro-use-4d-formulas-in-your-spreadsheet/">4D View Pro: Use 4D formulas in your spreadsheet (英文ブログ記事)</a> も参照ください。</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="hello-world-例題"></a><a href="#hello-world-例題" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hello World 例題</h3>
<p>4Dプロジェクトメソッドを使って、4D View Pro エリアのセルに &quot;Hello World&quot; と表示させます。</p>
<ol>
<li>&quot;myMethod&quot; プロジェクトメソッドを作成し、次のコードを書きます:</li>
</ol>
<pre><code class="hljs css language-4d"> #DECLARE-&gt;<span class="hljs-variable">$hw Text</span>
 <span class="hljs-variable">$hw</span>:=<span class="hljs-string">"Hello World"</span>

</code></pre>
<ol start="2">
<li>4D View Pro エリアが設置されたフォームを開く前に、以下のコードを実行します:</li>
</ol>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">  Case of</span>
    :(Form event code=On Load)<span class="hljs-keyword">
       var</span> <span class="hljs-variable">$o </span>: Object
       <span class="hljs-variable">$o</span>:=New object
  <span class="hljs-comment">// "myMethod" メソッドから "vpHello" ファンクションを定義します</span>
       <span class="hljs-variable">$o</span>.vpHello:=New object
       <span class="hljs-variable">$o</span>.vpHello.formula:=<span class="hljs-function">Formula</span>(myMethod)
<span class="hljs-function">       VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>;<span class="hljs-variable">$o</span>)<span class="hljs-keyword">
 End case</span>
</code></pre>
<ol start="3">
<li><p>4D View Pro エリアのセルに次を入力します:</p>
<p><img src="/docs/Rx/assets/en/ViewPro/vpProjMeth1.PNG" alt=""></p>
<p>すると、4D によって &quot;myMethod &quot;が呼び出され、セルの表示は次のようになります:</p>
<p><img src="/docs/Rx/assets/en/ViewPro/vpProjMeth2.PNG" alt=""></p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="引数"></a><a href="#引数" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引数</h3>
<p>プロジェクトのメソッドを呼び出す 4Dファンクションには、以下のシンタックスで引数を渡すことができます:</p>
<pre><code class="hljs">=METHODNAME(param1,param2,...,paramN)
</code></pre>
<p><em>methodName</em> はこれらの引数を $1, $2...$N に受け取ります。</p>
<p>引数を渡さない場合でも ( ) の使用は必須です:</p>
<pre><code class="hljs">=METHODWITHOUTNAME()
</code></pre>
<p><a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> メソッドを使用して宣言したファンクションの <em>parameters</em> コレクションを使って、引数の名前、型、数を宣言することができます。 オプションとして、<em>minParams</em> および <em>maxParams</em> プロパティにより、ユーザーから渡される引数の数を制御することができます。</p>
<p>サポートされている引数の型の詳細については、<a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> メソッドの説明を参照ください。</p>
<blockquote>
<p>引数を宣言していない場合には、メソッドに値を順番に渡すことができ ($1、$2... に受け取られます)、それらの型は自動的に変換されます。 <em>jstype</em> の日付は、4Dコードでは 2つのプロパティを持つ <a href="/docs/Rx/ja/Concepts/object.html">オブジェクト</a> として渡されます:<br>
|プロパティ|    型|   説明| |---|---|---| |value|   Date|   日付| |time |Real|  時間 (秒単位)|</p>
</blockquote>
<p>4Dプロジェクトメソッドは、$0 を介して 4D View Pro のセルフォーミュラに値を返すこともできます。 以下のデータ型の戻り値がサポートされています:</p>
<ul>
<li><p><a href="/docs/Rx/ja/Concepts/string.html">テキスト</a> (4D View Pro 内で文字列に変換)</p></li>
<li><p><a href="/docs/Rx/ja/Concepts/number.html">実数</a>/<a href="/docs/Rx/ja/Concepts/number.html">倍長整数</a> (4D View Pro 内で数値に変換)</p></li>
<li><p><a href="/docs/Rx/ja/Concepts/date.html">日付</a> (4D View Pro 内で JS日付型に変換 - 時間、分、秒 = 0)</p></li>
<li><p><a href="/docs/Rx/ja/Concepts/time.html">時間</a> (4D View Pro 内で JS日付型に変換 - 日付は基準日、つまり 1899年12月30日)</p></li>
<li><p><a href="/docs/Rx/ja/Concepts/boolean.html">ブール</a> (4D View Pro 内でブールに変換)</p></li>
<li><p><a href="/docs/Rx/ja/Concepts/picture.html">ピクチャー</a> (jpg,png,gif,bmp,svg, その他のタイプは png に変換) の場合、URI (data:image/png;base64,xxxx) が作成され、フォーミュラを実行した 4D View Pro のセルにおいて背景として使用されます。</p></li>
<li><p>次の 2つのプロパティを持つ <a href="/docs/Rx/ja/Concepts/object.html">オブジェクト</a> (日付と時間の受け渡しを可能にします):</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>value</td><td>日付</td><td>日付値</td></tr>
<tr><td>time</td><td>実数</td><td>数値 (秒単位)</td></tr>
</tbody>
</table>
</li>
</ul>
<p>4Dメソッドが何も返さない場合は、自動的に空の文字列が返されます。</p>
<p>以下の場合は、4D View Pro セルにエラーが返されます:</p>
<ul>
<li>4Dメソッドが上記以外のデータ型を返した場合。</li>
<li>4Dメソッドの実行中にエラーが発生した場合 (ユーザーが &quot;中止&quot; ボタンをクリックした場合)。</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="例題"></a><a href="#例題" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$o </span>: Object

<span class="hljs-variable">$o</span>.BIRTH_INFORMATION:=New object
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.formula:=<span class="hljs-function">Formula</span>(BirthInformation)
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters:=New collection
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"First name"</span>;<span class="hljs-string">"type"</span>;Is text))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Birthday"</span>;<span class="hljs-string">"type"</span>;Is date))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Time of birth"</span>;<span class="hljs-string">"type"</span>;Is time))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.summary:=<span class="hljs-string">"渡された情報に基づきフォーマットされた文字列を返します"</span>

<span class="hljs-function">VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>; <span class="hljs-variable">$o</span>)
</code></pre>
<p><img src="/docs/Rx/assets/en/ViewPro/params.PNG" alt=""></p>
<h2><a class="anchor" aria-hidden="true" id="互換性"></a><a href="#互換性" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>互換性</h2>
<p>4D View Pro エリアでフィールドやメソッドをファンクションとして宣言する場合、代わりの方法も利用可能です。 これらの方法は、互換性のために維持されており、特定のケースで使用することができます。 しかしながら、<a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-custom-functions"><code>VP SET CUSTOM FUNCTIONS</code></a> の使用が推奨されます。</p>
<h3><a class="anchor" aria-hidden="true" id="仮想ストラクチャーを使ったフィールド参照"></a><a href="#仮想ストラクチャーを使ったフィールド参照" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>仮想ストラクチャーを使ったフィールド参照</h3>
<p>4D View Pro では、データベースの仮想ストラクチャーを使用して 4Dフィールドを参照することができます。 つまり、*引数とともに <a href="https://doc.4d.com/4dv19/help/command/ja/page601.html"><code>SET TABLE TITLES</code></a> や <a href="https://doc.4d.com/4dv19/help/command/ja/page602.html"><code>SET FIELD TITLES</code></a> コマンドで宣言されている場合です。 この代替方法は、アプリケーションがすでに仮想ストラクチャーに依存している場合に便利です (そうでない場合は、<a href="#4dファンクション"><code>VP SET CUSTOM FUNCTIONS</code> の使用</a> が推奨されます)。</p>
<blockquote>
<p><strong>警告</strong>: 仮想ストラクチャーと <code>VP SET CUSTOM FUNCTIONS</code> を同時に使用することはできません。 <code>VP SET CUSTOM FUNCTIONS</code> が呼び出されると、4D View Pro エリアは <code>SET TABLE TITLES</code> や <code>SET FIELD TITLES</code> コマンドに基づく機能を無視します。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="要件"></a><a href="#要件" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>要件</h4>
<ul>
<li>フィールドは、データベースの仮想ストラクチャーに属していること。 つまり、*引数とともに <a href="https://doc.4d.com/4dv19/help/command/ja/page601.html"><code>SET TABLE TITLES</code></a> や <a href="https://doc.4d.com/4dv19/help/command/ja/page602.html"><code>SET FIELD TITLES</code></a> コマンドで宣言されていなくてはなりません。</li>
<li>テーブルとフィールド名は ECMA 準拠であること (<a href="https://www.ecma-international.org/ecma-262/5.1/#sec-7.6">ECMA Script standard</a> 参照)。</li>
<li>フィールドの型が 4D View Pro でサポートされていること (前述参照)。</li>
</ul>
<p>準拠していないフィールドがフォーミュラに呼び出されると、4D View Pro セルにエラーが返されます。</p>
<h4><a class="anchor" aria-hidden="true" id="フォーミュラでの仮想フィールドの使用"></a><a href="#フォーミュラでの仮想フィールドの使用" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>フォーミュラでの仮想フィールドの使用</h4>
<p>フォーミュラ内に仮想フィールドへの参照を挿入するには、次のシンタックスを使います:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">TABLENAME_FIELDNAME</span><span class="hljs-params">()</span></span>
</code></pre>
<p>たとえば、&quot;People&quot; テーブルの &quot;Name&quot; フィールドを仮想ストラクチャーで宣言した場合、以下のようなファンクションを呼び出すことができます:</p>
<pre><code class="hljs">=PEOPLE_NAME()
=<span class="hljs-built_in">LEN</span>(PEOPLE_NAME())
</code></pre>
<blockquote>
<p>フィールドが [4Dメソッド] と同名の場合は、フィールド名が優先されます。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-1"></a><a href="#例題-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>4D の仮想フィールドを使用して、4D View Pro エリアのセル内に人の名前を表示します:</p>
<ol>
<li>&quot;Employee&quot; テーブルと &quot;L_Name&quot; フィールドを作成します:</li>
</ol>
<p><img src="/docs/Rx/assets/en/ViewPro/vpFieldMeth1.PNG" alt=""></p>
<ol start="2">
<li><p>次のコードを実行して、仮想ストラクチャーを初期化します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-number">1</span>)
<span class="hljs-function">    ARRAY LONGINT</span>(<span class="hljs-variable">$tableNum</span>;<span class="hljs-number">1</span>)
    <span class="hljs-variable">$tableTitles{1}</span>:=<span class="hljs-string">"Emp"</span>
    <span class="hljs-variable">$tableNum{1}</span>:=<span class="hljs-number">2</span>
<span class="hljs-function">    SET TABLE TITLES</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-variable">$tableNum</span>;*)

<span class="hljs-function">    ARRAY TEXT</span>(<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-number">1</span>)
<span class="hljs-function">    ARRAY LONGINT</span>(<span class="hljs-variable">$fieldNum</span>;<span class="hljs-number">1</span>)
    <span class="hljs-variable">$fieldTitles{1}</span>:=<span class="hljs-string">"Name"</span>
    <span class="hljs-variable">$fieldNum{1}</span>:=<span class="hljs-number">2</span> <span class="hljs-comment">// ラストネーム</span>
<span class="hljs-function">    SET FIELD TITLES</span>([Employee];<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-variable">$fieldNum</span>;*)
</code></pre></li>
<li><p>4D View Pro エリアのセルに &quot;=e&quot; と入力します&quot;:</p></li>
</ol>
<p><img src="/docs/Rx/assets/en/ViewPro/vpFieldMeth2.PNG" alt=""></p>
<ol start="4">
<li>(Tabキーを使用して) EMP_NAME を選択し、閉じる &quot;)&quot; を入力します。</li>
</ol>
<p><img src="/docs/Rx/assets/en/ViewPro/vpFieldMeth3.PNG" alt=""></p>
<ol start="5">
<li>セルを確定すると、カレントの従業員の名前が表示されます:</li>
</ol>
<p><img src="/docs/Rx/assets/en/ViewPro/vpFieldMeth4.PNG" alt=""></p>
<blockquote>
<p>[Employee] テーブルはカレントレコードを持っている必要があります。</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="許可されたメソッドの宣言"></a><a href="#許可されたメソッドの宣言" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>許可されたメソッドの宣言</h3>
<p>4D View Pro のフォーミュラ内にて 4Dプロジェクトメソッドを直接呼び出すことができます。 セキュリティ上の理由から、ユーザーによって呼び出し可能なメソッドは <a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> によって明示的に宣言されなくてはなりません。</p>
<h4><a class="anchor" aria-hidden="true" id="要件-1"></a><a href="#要件-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>要件</h4>
<p>4D View Pro フォーミュラ内で呼び出すには、プロジェクトメソッドは以下の条件を満たしている必要があります:</p>
<ul>
<li><strong>許可されている</strong>: <a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> によって明示的に宣言されていること。</li>
<li><strong>実行可能</strong>: メソッドがホストデータベースに属している、あるいはロードされたコンポーネントに属しており当該メソッドの &quot;コンポーネントとホストデータベース間で共有&quot; オプションが有効化されていること (<a href="/docs/Rx/ja/Concepts/components.html#プロジェクトメソッドの共有">プロジェクトメソッドの共有</a> 参照)。</li>
<li>既存の 4D View Pro ファンクションと <strong>競合していない</strong>: 4D View Pro ビルトインファンクションと同じ名前のプロジェクトメソッドを呼び出した場合、ファンクションの方が呼び出されます。</li>
</ul>
<blockquote>
<p><a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> および <a href="/docs/Rx/ja/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> コマンドのいずれもがセッション中に実行されていない場合、4D View Pro カスタムファンクションには 4D の汎用的な <code>SET ALLOWED METHODS</code> コマンドで許可されたメソッドが使用できます。 この場合、プロジェクトメソッド名は JavaScript の字句文法に則ってなければなりません (<a href="https://www.ecma-international.org/ecma-262/5.1/#sec-7.6">ECMA Script standard</a> 参照)。 ストラクチャー設定のグローバルなフィルタリングオプション (セキュリティページ ＞ データアクセス権) はいずれの場合でも無視されます。</p>
</blockquote>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/Rx/ja/ViewPro/configuring.html"><span class="arrow-prev">← </span><span>前へ</span></a><a class="docs-next button" href="/docs/Rx/ja/ViewPro/method-list.html"><span>次へ</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#フォーミュラの使い方">フォーミュラの使い方</a><ul class="toc-headings"><li><a href="#フォーミュラの入力">フォーミュラの入力</a></li><li><a href="#演算子とオペランド">演算子とオペランド</a></li></ul></li><li><a href="#値と演算子">値と演算子</a><ul class="toc-headings"><li><a href="#比較演算子">比較演算子</a></li><li><a href="#演算子の優先順位">演算子の優先順位</a></li></ul></li><li><a href="#セル参照">セル参照</a><ul class="toc-headings"><li><a href="#参照の記法">参照の記法</a></li></ul></li><li><a href="#ビルトインファンクション">ビルトインファンクション</a></li><li><a href="#4dファンクション">4Dファンクション</a><ul class="toc-headings"><li><a href="#hello-world-例題">Hello World 例題</a></li><li><a href="#引数">引数</a></li></ul></li><li><a href="#互換性">互換性</a><ul class="toc-headings"><li><a href="#仮想ストラクチャーを使ったフィールド参照">仮想ストラクチャーを使ったフィールド参照</a></li><li><a href="#許可されたメソッドの宣言">許可されたメソッドの宣言</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/Rx/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ja","version:19 R4"]}
              });
            </script></body></html>