<!DOCTYPE html><html lang="ja"><head><meta name="docsearch:version" content="19 R5"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>DataClass · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[データクラス](/docs/Rx/ja/ORDA/dsmapping.html#データクラス) はデータベーステーブルへのオブジェクトインターフェースを提供します。 4Dアプリケーション内のデータクラスはすべて、`ds` [データストア](/docs/Rx/ja/ORDA/dsmapping.html#データストア) のプロパティとして利用可能です。"/><meta name="docsearch:language" content="ja"/><meta property="og:title" content="DataClass · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/Rx/index.html"/><meta property="og:description" content="[データクラス](/docs/Rx/ja/ORDA/dsmapping.html#データクラス) はデータベーステーブルへのオブジェクトインターフェースを提供します。 4Dアプリケーション内のデータクラスはすべて、`ds` [データストア](/docs/Rx/ja/ORDA/dsmapping.html#データストア) のプロパティとして利用可能です。"/><meta property="og:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><link rel="shortcut icon" href="/docs/Rx/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/Rx/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/Rx/js/code-blocks-buttons.js"></script><script src="/docs/Rx/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/Rx/css/main.css"/><script src="/docs/Rx/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/Rx/ja"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R6 BETA</a></li><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs/Rx" target="_self">v19 R5</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/Rx/img/language.svg" alt="Languages icon"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/Rx/en/API/DataClassClass.html">English</a></li><li><a href="/docs/Rx/de/API/DataClassClass.html">Deutsch</a></li><li><a href="/docs/Rx/es/API/DataClassClass.html">Español</a></li><li><a href="/docs/Rx/fr/API/DataClassClass.html">Français</a></li><li><a href="/docs/Rx/pt/API/DataClassClass.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>クラス API リファレンス</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">プロジェクト管理<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Project/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Project/architecture.html">プロジェクトのアーキテクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Project/documentation.html">ドキュメンテーション</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Project/compiler.html">コンパイル</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ランゲージのコンセプト<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/about.html">4D ランゲージについて</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/quick-tour.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/operators.html">演算子</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/data-types.html">データタイプの概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/boolean.html">ブール</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/collection.html">コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/date.html">日付</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/null-undefined.html">Null と 未定義</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/number.html">数値 (実数、倍長整数、整数)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/object.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/picture.html">ピクチャー</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/pointer.html">ポインター</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/string.html">文字列</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/time.html">時間</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/variant.html">バリアント</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/variables.html">変数</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/arrays.html">配列</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/methods.html">メソッド</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/parameters.html">引数</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/shared.html">共有オブジェクトと共有コレクション</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/classes.html">クラス</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/control-flow.html">制御フロー</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/branching.html">分岐構造</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/looping.html">ループ構造</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/error-handling.html">エラー処理</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/interpreted-compiled.html">インタープリターモードとコンパイル済みモード</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/components.html">コンポーネント</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/plug-ins.html">プラグイン</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Concepts/identifiers.html">識別子の命名規則</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/overview.html">ORDAとは何か</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/dsmapping.html">データモデルオブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/ordaClasses.html">データモデルクラス</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/entities.html">データ操作</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/datastores.html">リモートデータストアの利用</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/ORDA/glossary.html">用語集</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">クラス API リファレンス<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/overview.html">クラス API の概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/BlobClass.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/ClassClass.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/CollectionClass.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Rx/ja/API/DataClassClass.html">DataClass</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/EntityClass.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/FunctionClass.html">Formula</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/SessionClass.html">Session</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/SystemWorkerClass.html">SystemWorker</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">コードエディター<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/code-editor/navigation.html">ナビゲーションドロップダウン</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">デバッガー<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Debugging/basics.html">画面の説明</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Debugging/debugger.html">デバッガー</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Debugging/breakpoints.html">ブレークポイントとキャッチコマンド</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Debugging/debugging-remote.html">リモートマシンからのデバッグ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Debugging/debugLogFiles.html">ログファイルの詳細</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">変換タグ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Tags/tags.html">変換タグ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">設定<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/general.html">一般ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/interface.html">インターフェースページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/compiler.html">コンパイラーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/database.html">データベースページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/backup.html">バックアップページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/client-server.html">クライアント-サーバーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/web.html">Web ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/sql.html">SQL ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/php.html">PHP ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/security.html">セキュリティページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/settings/compatibility.html">互換性ページ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">環境設定<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/general.html">一般ページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/structure.html">ストラクチャーページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/forms.html">フォームページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/methods.html">メソッドページ</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/ja/Preferences/shortcuts.html">ショートカットページ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/Rx/docs/API/DataClassClass.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">DataClass</h1></header><article><div><span><p><a href="/docs/Rx/ja/ORDA/dsmapping.html#データクラス">データクラス</a> はデータベーステーブルへのオブジェクトインターフェースを提供します。 4Dアプリケーション内のデータクラスはすべて、<code>ds</code> <a href="/docs/Rx/ja/ORDA/dsmapping.html#データストア">データストア</a> のプロパティとして利用可能です。</p>
<h3><a class="anchor" aria-hidden="true" id="概要"></a><a href="#概要" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>概要</h3>
<table>
<thead>
<tr><th></th></tr>
</thead>
<tbody>
<tr><td><a href="#attributename"><strong><em>.attributeName</em></strong> : DataClassAttribute</a><p>    プロパティとして直接利用可能なオブジェクト</td></tr>
<tr><td><a href="#all"><strong>.all</strong> ( { <em>settings</em> : Object } ) : 4D.EntitySelection</a><p>    データクラスの全エンティティをエンティティセレクションとして返します</td></tr>
<tr><td><a href="#clearremotecache"><strong>.clearRemoteCache()</strong></a><p>    データクラスの ORDAキャッシュを空にします</td></tr>
<tr><td><a href="#fromcollection"><strong>.fromCollection</strong>( <em>objectCol</em> : Collection { ; <em>settings</em> : Object } ) : 4D.EntitySelection</a><p>    <em>objectCol</em> 引数のオブジェクトのコレクションに基づいてデータクラスのエンティティを更新あるいは作成し、対応するエンティティセレクションを返します</td></tr>
<tr><td><a href="#get"><strong>.get</strong>( <em>primaryKey</em> : Integer { ; <em>settings</em> : Object } ) : 4D.Entity<br><strong>.get</strong>( <em>primaryKey</em> : Text { ; <em>settings</em> : Object } ) : 4D.Entity</a><p>    <em>primaryKey</em> に渡したプライマリーキーに合致するエンティティを返します</td></tr>
<tr><td><a href="#getcount"><strong>.getCount()</strong> : Integer </a><p>     データクラスに含まれる総エンティティ数を返します</td></tr>
<tr><td><a href="#getdatastore"><strong>.getDataStore()</strong> : cs.DataStore</a><p>    指定したデータクラスが属しているデータストアを返します</td></tr>
<tr><td><a href="#getinfo"><strong>.getInfo()</strong> : Object </a><p>    データクラスの情報を提供するオブジェクトを返します</td></tr>
<tr><td><a href="#getremotecache"><strong>.getRemoteCache</strong>() : Object </a><p>    データクラスの ORDAキャッシュの内容を記述したオブジェクトを返します</td></tr>
<tr><td><a href="#new"><strong>.new()</strong> : 4D.Entity </a><p>    メモリ内にデータクラスに空のエンティティを新規作成しそれを返します</td></tr>
<tr><td><a href="#newselection"><strong>.newSelection</strong>( { <em>keepOrder</em> : Integer } ) : 4D.EntitySelection </a><p>    追加可能な、空の新規エンティティセレクションをメモリ内に作成します</td></tr>
<tr><td><a href="#query"><strong>.query</strong>( <em>queryString</em> : Text { ; <em>...value</em> : any } { ; <em>querySettings</em> : Object } ) : 4D.EntitySelection <br><strong>.query</strong>( <em>formula</em> : Object { ; <em>querySettings</em> : Object } ) : 4D.EntitySelection </a><p>    <em>queryString</em> または <em>formula</em> と任意の <em>value</em> 引数で指定した検索条件に合致するエンティティを検索します</td></tr>
<tr><td><a href="#setremotecachesettings"><strong>.setRemoteCacheSettings</strong>(<em>settings</em> : Object) </a><p>    データクラスの ORDAキャッシュについて、タイムアウトと最大サイズを指定します</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="attributename"></a><a href="#attributename" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.<em>attributeName</em></h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong><em>.attributeName</em></strong> : DataClassAttribute</p>
<h4><a class="anchor" aria-hidden="true" id="説明"></a><a href="#説明" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p>データクラスの属性は、データクラスの プロパティとして直接利用可能なオブジェクト です。</p>
<p>戻り値は <a href="/docs/Rx/ja/API/DataClassAttributeClass.html"><code>DataClassAttribute</code></a> クラスのオブジェクトです。 これらのオブジェクトが持つプロパティを読み取ることによって、データクラス属性に関する情報が取得できます。</p>
<blockquote>
<p>データクラス属性オブジェクトを編集することは可能ですが、元となるデータベースストラクチャーは変更されません。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-1"></a><a href="#例題-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$salary</span>:=ds.Employee.salary <span class="hljs-comment">// Employeeデータクラスの salary属性を返します</span>
<span class="hljs-variable">$compCity</span>:=ds.Company[<span class="hljs-string">"city"</span>] <span class="hljs-comment">// Companyデータクラスの city属性を返します</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2"></a><a href="#例題-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>以下のストラクチャーを前提とします:</p>
<p><img src="/docs/Rx/assets/en/API/dataclassAttribute.png" alt=""></p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$firstnameAtt</span>;<span class="hljs-variable">$employerAtt</span>;<span class="hljs-variable">$employeesAtt </span>: Object

 <span class="hljs-variable">$firstnameAtt</span>:=ds.Employee.firstname
  <span class="hljs-comment">//{name:firstname,kind:storage,fieldType:0,type:string,fieldNumber:2,indexed:true,</span>
  <span class="hljs-comment">//keyWordIndexed:false,autoFilled:false,mandatory:false,unique:false}</span>

 <span class="hljs-variable">$employerAtt</span>:=ds.Employee.employer
  <span class="hljs-comment">//{name:employer,kind:relatedEntity,relatedDataClass:Company,</span>
  <span class="hljs-comment">//fieldType:38,type:Company,inverseName:employees}</span>
  <span class="hljs-comment">//38=Is object</span>

 <span class="hljs-variable">$employeesAtt</span>:=ds.Company.employees
  <span class="hljs-comment">//{name:employees,kind:relatedEntities,relatedDataClass:Employee,</span>
  <span class="hljs-comment">//fieldType:42,type:EmployeeSelection,inverseName:employer}</span>
  <span class="hljs-comment">//42=Is collection</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-3"></a><a href="#例題-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 3</h4>
<p>以下のテーブルプロパティを前提とします:</p>
<p><img src="/docs/Rx/assets/en/API/dataclassAttribute2.png" alt=""></p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$sequenceNumberAtt </span>: Object
 <span class="hljs-variable">$sequenceNumberAtt</span>=ds.Employee.sequenceNumber
  <span class="hljs-comment">//{name:sequenceNumber,kind:storage,fieldType:0,type:string,fieldNumber:13,</span>
  <span class="hljs-comment">//indexed:true,keyWordIndexed:false,autoFilled:true,mandatory:false,unique:true}</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="all"></a><a href="#all" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.all()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td><em>settings</em> パラメーターをサポート</td></tr>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.all</strong> ( { <em>settings</em> : Object } ) : 4D.EntitySelection</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>settings</td><td>Object</td><td style="text-align:center">-&gt;</td><td>ビルドオプション: context</td></tr>
<tr><td>戻り値</td><td>4D.EntitySelection</td><td style="text-align:center">&lt;-</td><td>データクラスの全エンティティの参照</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-1"></a><a href="#説明-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.all()</code> 関数はデータストアをクエリして、 データクラスの全エンティティをエンティティセレクションとして返します。</p>
<p>エンティティはデフォルトの順番で返され、通常は作成順になっています。 ただし、エンティティ削除後に新規追加した場合には、デフォルトの順番は作成順を反映しない点に留意が必要です。</p>
<p>エンティティが見つからない場合、空のエンティティセレクションが返されます。</p>
<p>この関数には、レイジーローディングが適用されます。</p>
<p><strong>settings</strong></p>
<p>任意の <em>settings</em> パラメーターには、追加オプションを格納したオブジェクトを渡すことができます。 以下のプロパティがサポートされています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>context</td><td>Text</td><td>エンティティセレクションに適用されている最適化コンテキストのラベル。 エンティティセレクションを扱うコードはこのコンテキストを使うことで最適化の恩恵を受けます。 この機能は <a href="/docs/Rx/ja/ORDA/entities.html#クライアント/サーバーの最適化">ORDA のクライアント/サーバー処理</a>を想定して設計されています。</td></tr>
</tbody>
</table>
<blockquote>
<p>データクラス内の総エンティティ数を知るには、<code>ds.myClass.all().length</code> 式よりも最適化された <a href="#getcount"><code>getCount()</code></a> 関数を使用することが推奨されます。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題"></a><a href="#例題" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$allEmp </span>: cs.EmployeeSelection
 <span class="hljs-variable">$allEmp</span>:=ds.Employee.<span class="hljs-function">all</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="clearremotecache"></a><a href="#clearremotecache" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.clearRemoteCache()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.clearRemoteCache()</strong>
| 引数 | タイプ |  | 説明                |
| -- | --- |::| ----------------- |
|    |     |  | このコマンドは引数を必要としません |</p>
<h4><a class="anchor" aria-hidden="true" id="説明-2"></a><a href="#説明-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.clearRemoteCache()</code> 関数は、 データクラスの ORDAキャッシュを空にします。</p>
<blockquote>
<p>この関数は <code>timeout</code> および <code>maxEntries</code> の値をリセットしません。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-4"></a><a href="#例題-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$ds </span>: 4D.DataStoreImplementation<span class="hljs-keyword">
var</span> <span class="hljs-variable">$persons </span>: cs.PersonsSelection<span class="hljs-keyword">
var</span> <span class="hljs-variable">$p </span>: cs.PersonsEntity<span class="hljs-keyword">
var</span> <span class="hljs-variable">$cache </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$info </span>: Collection<span class="hljs-keyword">
var</span> <span class="hljs-variable">$text </span>: Text

<span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>; <span class="hljs-string">"www.myserver.com"</span>); <span class="hljs-string">"myDS"</span>)

<span class="hljs-variable">$persons</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">all</span>()
<span class="hljs-variable">$text</span>:=<span class="hljs-string">""</span><span class="hljs-keyword">
For each</span> (<span class="hljs-variable">$p</span>; <span class="hljs-variable">$persons</span>)
    <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$p</span>.firstname+<span class="hljs-string">" lives in "</span>+<span class="hljs-variable">$p</span>.address.city+<span class="hljs-string">" / "</span><span class="hljs-keyword">
End for each</span>

<span class="hljs-variable">$cache</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">getRemoteCache</span>()

<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">clearRemoteCache</span>()
<span class="hljs-comment">// Persons データクラスのキャッシュ = {timeout:30;maxEntries:30000;stamp:255;entries:[]}</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="fromcollection"></a><a href="#fromcollection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.fromCollection()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td><em>settings</em> パラメーターをサポート</td></tr>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.fromCollection</strong>( <em>objectCol</em> : Collection { ; <em>settings</em> : Object } ) : 4D.EntitySelection</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>objectCol</td><td>コレクション</td><td style="text-align:center">-&gt;</td><td>エンティティにマップするオブジェクトのコレクション</td></tr>
<tr><td>settings</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>ビルドオプション: context</td></tr>
<tr><td>戻り値</td><td>4D.EntitySelection</td><td style="text-align:center">&lt;-</td><td>コレクションから作成したエンティティセレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-3"></a><a href="#説明-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.fromCollection()</code> 関数は、 <em>objectCol</em> 引数のオブジェクトのコレクションに基づいてデータクラスのエンティティを更新あるいは作成し、対応するエンティティセレクションを返します。</p>
<p><em>objectCol</em> パラメーターには、データクラスの既存エンティティを更新、または新規エンティティを作成するためのオブジェクトのコレクションを渡します。 プロパティ名は、データクラスの属性名と同一である必要があります。 プロパティ名がデータクラスに存在しない場合、それは無視されます。 コレクション内で属性値が定義されていない場合、その値は null になります。</p>
<p>コレクションのオブジェクト要素とエンティティのマッピングは、<strong>属性名</strong> と <strong>型の合致</strong> をもって行われます。 オブジェクトプロパティがエンティティ属性と同じ名前であっても、型が合致しない場合には、エンティティの属性は空のままです。</p>
<p><strong>作成モードと更新モード</strong></p>
<p><em>objectCol</em> 引数の各オブジェクトついて:</p>
<ul>
<li>オブジェクトがブール型の &quot;__NEW&quot; プロパティを含み、それが <strong>false</strong> に設定されている場合(あるいは &quot;__NEW&quot; プロパティが含まれていない場合)、オブジェクトの対応する値でエンティティが更新あるいは作成されます。 プライマリーキーに関するチェックはおこなわれません:
<ul>
<li>プライマリーキーが指定されていて実在する場合、エンティティは更新されます。 この場合、プライマリーキーはそのまま、あるいは &quot;__KEY&quot; プロパティを (プライマリーキー値とともに) 使って指定することができます。</li>
<li>そのまま指定したプライマリーキーが実在しない場合、エンティティは作成されます。</li>
<li>プライマリーキーを指定していない場合、エンティティは作成され、標準のデータベースのルールに基づいてプライマリーキー値が割り当てられます。</li>
</ul></li>
<li>オブジェクトがブール型の &quot;__NEW&quot; プロパティを含み、それが <strong>true</strong> に設定されている場合、オブジェクトの対応する値でエンティティが作成されます。 プライマリーキーに関するチェックがおこなわれます:
<ul>
<li>そのまま指定したプライマリーキーが実在する場合、エラーが返されます。</li>
<li>そのまま指定したプライマリーキーが実在しない場合、エンティティは作成されます。</li>
<li>プライマリーキーを指定していない場合、エンティティは作成され、標準のデータベースのルールに基づいてプライマリーキー値が割り当てられます。</li>
</ul></li>
</ul>
<blockquote>
<p>値を格納している&quot;__KEY&quot; プロパティは、&quot;__NEW&quot; プロパティが <strong>false</strong> に設定 (あるいは省略) されていて、かつ対応するエンティティが存在する場合のみ、考慮されます。 それ以外の場合には、&quot;__KEY&quot; プロパティ値は無視されるため、プライマリーキーの値はそのまま渡さなければなりません。</p>
</blockquote>
<p><strong>リレートエンティティ</strong></p>
<p><em>objectCol</em> 引数のオブジェクトは、一つ以上のリレートエンティティに対応するオブジェクトをネストすることができます。これはエンティティ間のリンクを作成・更新するのに有用です。</p>
<p>リレートエンティティに相当するネストされたオブジェクトは、リレートエンティティのプライマリーキー値を格納した &quot;__KEY&quot; プロパティあるいはプライマリーキー属性を格納している必要があります。 ”__KEY” プロパティを使用すると、プライマリーキー属性名に依存する必要がありません。</p>
<blockquote>
<p>この機構によって、リレートエンティティの中身を作成・更新することはできません。</p>
</blockquote>
<p><strong>記号</strong></p>
<p>&quot;__STAMP&quot; プロパティが指定された場合、データストアのスタンプとのチェックがおこなわれ、エラーが返されることがあります (&quot;与えられたスタンプはテーブルXXX のレコード# XXのカレントのものと合致しません&quot;)。 詳細については <a href="/docs/Rx/ja/ORDA/entities.html#エンティティロッキング">エンティティロッキング</a> を参照ください。</p>
<p><strong>settings</strong></p>
<p>任意の <em>settings</em> パラメーターには、追加オプションを格納したオブジェクトを渡すことができます。 以下のプロパティがサポートされています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>context</td><td>Text</td><td>エンティティセレクションに適用されている最適化コンテキストのラベル。 エンティティセレクションを扱うコードはこのコンテキストを使うことで最適化の恩恵を受けます。 この機能は <a href="/docs/Rx/ja/ORDA/entities.html#クライアント/サーバーの最適化">ORDA のクライアント/サーバー処理</a>を想定して設計されています。</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-1"></a><a href="#例題-1-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<p>既存のエンティティを更新します。 __NEW プロパティはなく、従業員のプライマリーキーは属性に実在の値を指定して渡します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.ID:=<span class="hljs-number">668</span> <span class="hljs-comment">// Employeeテーブルの実在する主キー</span>
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"Arthur"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span>
 <span class="hljs-variable">$emp</span>.employer:=<span class="hljs-function">New object</span>(<span class="hljs-string">"ID"</span>;<span class="hljs-number">121</span>) <span class="hljs-comment">// リレートデータクラス Company の実在する主キー</span>
  <span class="hljs-comment">// リレートデータクラス Company に実在する別の主キーを指定すれば、会社を変更することができます</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-1"></a><a href="#例題-2-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>既存のエンティティを更新します。 __NEW プロパティはなく、従業員のプライマリーキーは __KEY プロパティに実在の値を指定して渡します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.__KEY:=<span class="hljs-number">1720</span> <span class="hljs-comment">// Employeeテーブルの実在する主キー</span>
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"John"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Boorman"</span>
 <span class="hljs-variable">$emp</span>.employer:=<span class="hljs-function">New object</span>(<span class="hljs-string">"ID"</span>;<span class="hljs-number">121</span>) <span class="hljs-comment">// リレートデータクラス Company の実在する主キー</span>
  <span class="hljs-comment">// リレートデータクラス Company に実在する別の主キーを指定すれば、会社を変更することができます</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-3-1"></a><a href="#例題-3-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 3</h4>
<p>単純に、コレクションから新しいエンティティを作成します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"Victor"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Hugo"</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-4-1"></a><a href="#例題-4-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 4</h4>
<p>新規エンティティを作成します。 __NEW プロパティは true で、従業員のプライマリーキーは指定しません:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"Mary"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Smith"</span>
 <span class="hljs-variable">$emp</span>.employer:=<span class="hljs-function">New object</span>(<span class="hljs-string">"__KEY"</span>;<span class="hljs-number">121</span>) <span class="hljs-comment">// リレートデータクラス Company の実在する主キー</span>
 <span class="hljs-variable">$emp</span>.__NEW:=<span class="hljs-literal">True</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)






</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-5"></a><a href="#例題-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 5</h4>
<p>新規エンティティを作成します。 __NEW プロパティはなく、従業員のプライマリーキー属性を指定しますが、その値は実在しません:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.ID:=<span class="hljs-number">10000</span> <span class="hljs-comment">// 実在しない主キー</span>
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"Françoise"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Sagan"</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-6"></a><a href="#例題-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 6</h4>
<p>2つのエンティティが同じプライマリーキーを持つ場合、最初のエンティティは作成・保存されますが、2つめのエンティティの処理は失敗します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$empsCollection </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$emp</span>; <span class="hljs-variable">$emp2 </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection

 <span class="hljs-variable">$empsCollection</span>:=New collection
 <span class="hljs-variable">$emp</span>:=New object
 <span class="hljs-variable">$emp</span>.ID:=<span class="hljs-number">10001</span> <span class="hljs-comment">// 実在しない主キー</span>
 <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-string">"Simone"</span>
 <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span>
 <span class="hljs-variable">$emp</span>.__NEW:=<span class="hljs-literal">True</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp</span>)

 <span class="hljs-variable">$emp2</span>:=New object
 <span class="hljs-variable">$emp2</span>.ID:=<span class="hljs-number">10001</span> <span class="hljs-comment">// 上と同じ主キー</span>
 <span class="hljs-variable">$emp2</span>.firstName:=<span class="hljs-string">"Marc"</span>
 <span class="hljs-variable">$emp2</span>.lastName:=<span class="hljs-string">"Smith"</span>
 <span class="hljs-variable">$emp2</span>.__NEW:=<span class="hljs-literal">True</span>
 <span class="hljs-variable">$empsCollection</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$emp2</span>)
 <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">fromCollection</span>(<span class="hljs-variable">$empsCollection</span>)
  <span class="hljs-comment">// 最初のエンティティは作成されます</span>
  <span class="hljs-comment">// 2つめのエンティティは重複キーエラーになります</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="参照"></a><a href="#参照" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照</h4>
<p><a href="/docs/Rx/ja/API/EntitySelectionClass.html#tocollection"><strong>.toCollection()</strong></a></p>
<h2><a class="anchor" aria-hidden="true" id="get"></a><a href="#get" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.get()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.get</strong>( <em>primaryKey</em> : Integer { ; <em>settings</em> : Object } ) : 4D.Entity<br><strong>.get</strong>( <em>primaryKey</em> : Text { ; <em>settings</em> : Object } ) : 4D.Entity</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>primaryKey</td><td>整数または文字列</td><td style="text-align:center">-&gt;</td><td>取得するエンティティのプライマリーキー値</td></tr>
<tr><td>settings</td><td>オブジェクト</td><td style="text-align:center">-&gt;</td><td>ビルドオプション: context</td></tr>
<tr><td>戻り値</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>指定したプライマリーキーに合致するエンティティ</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-4"></a><a href="#説明-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.get()</code> 関数はデータクラスをクエリして、 <em>primaryKey</em> に渡したプライマリーキーに合致するエンティティを返します。</p>
<p><em>primaryKey</em> には、取得したいエンティティのプライマリーキーの値を渡します。 値の型は、データストアで設定されたプライマリーキーの型 (倍長整数あるいはテキスト) と合致している必要があります。 <a href="/docs/Rx/ja/API/EntityClass.html#getkey"><code>.getKey()</code></a> 関数に <code>dk key as string</code> 引数を渡すと、プライマリーキーの値が常にテキスト型で返されるように指定することができます。</p>
<p><em>primaryKey</em> 引数のプライマリーキーを持つエンティティが見つからない場合、<strong>Null</strong> エンティティが返されます。</p>
<p>この関数にはレイジーローディングが適用され、リレートデータは必要な時にのみディスクから読み込まれます。</p>
<p><strong>settings</strong></p>
<p>任意の <em>settings</em> パラメーターには、追加オプションを格納したオブジェクトを渡すことができます。 以下のプロパティがサポートされています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>context</td><td>Text</td><td>エンティティに適用されている自動の最適化コンテキストのラベル。 エンティティを読み込む以降のコードは、このコンテキストを使うことで最適化の恩恵を受けます。 この機能は <a href="/docs/Rx/ja/ORDA/entities.html#クライアント/サーバーの最適化">ORDA のクライアント/サーバー処理</a>を想定して設計されています。</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-2"></a><a href="#例題-1-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmployeeEntity<span class="hljs-keyword">  
 var</span> <span class="hljs-variable">$entity2 </span>: cs.InvoiceEntity
 <span class="hljs-variable">$entity</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">167</span>) <span class="hljs-comment">// プライマリーキーの値が 167のエンティティを返します</span>
 <span class="hljs-variable">$entity2</span>:=ds.Invoice.<span class="hljs-function">get</span>(<span class="hljs-string">"DGGX20030"</span>) <span class="hljs-comment">// プライマリーキーの値が "DGGX20030" のエンティティを返します</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-2"></a><a href="#例題-2-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p><em>context</em> プロパティの使用について紹介します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$e1</span>; <span class="hljs-variable">$e2</span>; <span class="hljs-variable">$e3</span>; <span class="hljs-variable">$e4 </span>: cs.EmployeeEntity<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$settings2 </span>: Object

 <span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"context"</span>;<span class="hljs-string">"detail"</span>)
 <span class="hljs-variable">$settings2</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"context"</span>;<span class="hljs-string">"summary"</span>)

 <span class="hljs-variable">$e1</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">1</span>;<span class="hljs-variable">$settings</span>)
<span class="hljs-function"> completeAllData</span>(<span class="hljs-variable">$e1</span>) <span class="hljs-comment">// completeAllData メソッドにおいて最適化がトリガーされ、"detail" コンテキストが割り当てられます</span>

 <span class="hljs-variable">$e2</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">2</span>;<span class="hljs-variable">$settings</span>)
<span class="hljs-function"> completeAllData</span>(<span class="hljs-variable">$e2</span>) <span class="hljs-comment">// completeAllData メソッドには、"detail" コンテキストに付随する最適化が適用されます</span>

 <span class="hljs-variable">$e3</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">3</span>;<span class="hljs-variable">$settings2</span>)
<span class="hljs-function"> completeSummary</span>(<span class="hljs-variable">$e3</span>) <span class="hljs-comment">// completeSummary メソッドにおいて最適化がトリガーされ、"summary" コンテキストが割り当てられます</span>

 <span class="hljs-variable">$e4</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">4</span>;<span class="hljs-variable">$settings2</span>)
<span class="hljs-function"> completeSummary</span>(<span class="hljs-variable">$e4</span>) <span class="hljs-comment">// completeSummary メソッドには、"summary" コンテキストに付随する最適化が適用されます</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getcount"></a><a href="#getcount" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getCount()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getCount()</strong> : Integer</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>result</td><td>整数</td><td>&lt;-</td><td>データクラスに含まれる全エンティティ数</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-5"></a><a href="#説明-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getCount()</code> 関数は、  データクラスに含まれる総エンティティ数を返します。</p>
<p>トランザクション内でこの関数を使用した場合、トランザクション中に作成されたエンティティは考慮されます。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-7"></a><a href="#例題-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$ds </span>: 4D.DataStoreImplementation<span class="hljs-keyword">
var</span> <span class="hljs-variable">$number </span>: Integer

<span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>; <span class="hljs-string">"www.myserver.com"</span>); <span class="hljs-string">"myDS"</span>)

<span class="hljs-variable">$number</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">getCount</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getdatastore"></a><a href="#getdatastore" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getDataStore()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getDataStore()</strong> : cs.DataStore</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>cs.DataStore</td><td style="text-align:center">&lt;-</td><td>データクラスが属しているデータストア</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-6"></a><a href="#説明-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getDataStore()</code> 関数は、 指定したデータクラスが属しているデータストアを返します。</p>
<p>返されるデータストアは次のいずれかです:</p>
<ul>
<li><code>ds</code> コマンドによって返されるメインデータストア</li>
<li><code>Open datastore</code> コマンドを使用して開かれたリモートデータストア</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="例題-8"></a><a href="#例題-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p><strong><em>SearchDuplicate</em></strong> プロジェクトメソッドは、任意のデータクラス内の重複した値を検索します。</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$pet </span>: cs.CatsEntity
 <span class="hljs-variable">$pet</span>:=ds.Cats.<span class="hljs-function">all</span>().<span class="hljs-function">first</span>() <span class="hljs-comment">// エンティティを取得します</span>
<span class="hljs-function"> SearchDuplicate</span>(<span class="hljs-variable">$pet</span>;<span class="hljs-string">"Dogs"</span>)
</code></pre>
<pre><code class="hljs css language-4d">  <span class="hljs-comment">// SearchDuplicate メソッド</span>
  <span class="hljs-comment">// SearchDuplicate(entity_to_search;dataclass_name)</span>

 #<span class="hljs-function">DECLARE </span>(<span class="hljs-variable">$pet </span>: Object ; <span class="hljs-variable">$dataClassName </span>: Text)<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$dataStore</span>; <span class="hljs-variable">$duplicates </span>: Object  

 <span class="hljs-variable">$dataStore</span>:=<span class="hljs-variable">$pet</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">getDataStore</span>()
 <span class="hljs-variable">$duplicates</span>:=<span class="hljs-variable">$dataStore</span>[<span class="hljs-variable">$dataClassName</span>].<span class="hljs-function">query</span>(<span class="hljs-string">"name=:1"</span>;<span class="hljs-variable">$pet</span>.name)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getinfo"></a><a href="#getinfo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getInfo()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19 R3</td><td>exposed プロパティを追加</td></tr>
<tr><td>v17 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getInfo()</strong> : Object</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>オブジェクト</td><td>&lt;-</td><td>データクラスの情報</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-7"></a><a href="#説明-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getInfo()</code> 関数は、 データクラスの情報を提供するオブジェクトを返します。 このメソッドは汎用的なコードを書くのに有用です。</p>
<p><strong>返されるオブジェクト</strong></p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>exposed</td><td>ブール</td><td>データクラスが REST に公開されていれば true</td></tr>
<tr><td>name</td><td>Text</td><td>データクラスの名称</td></tr>
<tr><td>primaryKey</td><td>テキスト</td><td>データクラスのプライマリーキー属性の名称</td></tr>
<tr><td>tableNumber</td><td>整数</td><td>内部的な 4Dテーブル番号</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="例題-1-3"></a><a href="#例題-1-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<pre><code class="hljs css language-4d"> #<span class="hljs-function">DECLARE </span>(<span class="hljs-variable">$entity </span>: Object)<span class="hljs-keyword">  
 var</span> <span class="hljs-variable">$status </span>: Object

<span class="hljs-function"> computeEmployeeNumber</span>(<span class="hljs-variable">$entity</span>) <span class="hljs-comment">// エンティティに対する何らかの操作</span>

 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()
<span class="hljs-function"> if</span>(<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"テーブル "</span>+<span class="hljs-variable">$entity</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">getInfo</span>().name+<span class="hljs-string">" のレコードが更新されました。"</span>)<span class="hljs-keyword">
 End if</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-3"></a><a href="#例題-2-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$settings </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$es </span>: cs.ClientsSelection

 <span class="hljs-variable">$settings</span>:=New object
 <span class="hljs-variable">$settings</span>.parameters:=<span class="hljs-function">New object</span>(<span class="hljs-string">"receivedIds"</span>;<span class="hljs-function">getIds</span>())
 <span class="hljs-variable">$settings</span>.attributes:=<span class="hljs-function">New object</span>(<span class="hljs-string">"pk"</span>;ds.Clients.<span class="hljs-function">getInfo</span>().primaryKey)
 <span class="hljs-variable">$es</span>:=ds.Clients.<span class="hljs-function">query</span>(<span class="hljs-string">":pk in :receivedIds"</span>;<span class="hljs-variable">$settings</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-3-2"></a><a href="#例題-3-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 3</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$pk </span>: Text<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$dataClassAttribute </span>: Object

 <span class="hljs-variable">$pk</span>:=ds.Employee.<span class="hljs-function">getInfo</span>().primaryKey
 <span class="hljs-variable">$dataClassAttribute</span>:=ds.Employee[<span class="hljs-variable">$pk</span>] <span class="hljs-comment">// 必要に応じてプライマリーキー属性へのアクセスが可能です</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="参照-1"></a><a href="#参照-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照</h4>
<p><a href="/docs/Rx/ja/API/DataClassAttributeClass.html#exposed">DataClassAttribute.exposed</a></p>
<h2><a class="anchor" aria-hidden="true" id="getremotecache"></a><a href="#getremotecache" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getRemoteCache()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getRemoteCache</strong>() : Object</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>result</td><td>オブジェクト</td><td>&lt;-</td><td>データクラスの ORDAキャッシュの内容を記述したオブジェクト。</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>上級者向け:</strong> この機能は、特定の構成のため、ORDAのデフォルト機能をカスタマイズする必要がある開発者向けです。 ほとんどの場合、使用する必要はないでしょう。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="説明-8"></a><a href="#説明-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.getRemoteCache()</code> 関数は、 データクラスの ORDAキャッシュの内容を記述したオブジェクトを返します。</p>
<p>4D のシングルユーザーアプリケーションからこの関数を呼び出した場合、<code>Null</code> が返されます。</p>
<p>戻り値のオブジェクトには、以下のプロパティが格納されています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>maxEntries</td><td>整数</td><td>エントリーコレクションの最大数</td></tr>
<tr><td>stamp</td><td>整数</td><td>キャッシュのスタンプ</td></tr>
<tr><td>timeout</td><td>整数</td><td>キャッシュの新しいエントリーが期限切れとなるまでの残り時間。</td></tr>
<tr><td>entries</td><td>コレクション</td><td>キャッシュ内の各エンティティにつき、1つのエントリーオブジェクトを格納します。</td></tr>
</tbody>
</table>
<p>エントリーコレクション内の各エントリーオブジェクトは、以下のプロパティを持ちます:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>data</td><td>Object</td><td>エントリーのデータを格納するオブジェクト</td></tr>
<tr><td>expired</td><td>ブール</td><td>エントリーが期限切れの場合に true</td></tr>
<tr><td>key</td><td>テキスト</td><td>エンティティのプライマリーキー</td></tr>
</tbody>
</table>
<p>各エントリーの <code>data</code> オブジェクトは、以下のプロパティを持ちます:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>__KEY</td><td>String</td><td>エンティティのプライマリーキー</td></tr>
<tr><td>__STAMP</td><td>倍長整数</td><td>データベース内のエンティティのタイムスタンプ</td></tr>
<tr><td>__TIMESTAMP</td><td>String</td><td>データベース内のエンティティのスタンプ (形式: YYYY-MM-DDTHH:MM:SS:ms:Z)</td></tr>
<tr><td>dataClassAttributeName</td><td>バリアント</td><td>データクラス属性に対応するデータがキャッシュに存在する場合、それはデータベースと同じ型のプロパティに返されます。</td></tr>
</tbody>
</table>
<p>リレートエンティティに関するデータは、data オブジェクトのキャッシュに保存されます。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-9"></a><a href="#例題-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>次の例で、<code>$ds.Persons.all()</code> は、先頭エンティティをそのすべての属性とともにロードします。 その後リクエストの最適化がおこなわれ、<code>firstname</code> と <code>address.city</code> のみがロードされます。</p>
<p><code>address.city</code> は、<code>Persons</code> データクラスのキャッシュにロードされることに注意してください。</p>
<p><code>Address</code> データクラスの先頭エンティティだけがキャッシュに格納されます。 先頭エンティティは、ループの最初の繰り返しでロードされます。</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$ds </span>: 4D.DataStoreImplementation<span class="hljs-keyword">
var</span> <span class="hljs-variable">$persons </span>: cs.PersonsSelection<span class="hljs-keyword">
var</span> <span class="hljs-variable">$p </span>: cs.PersonsEntity<span class="hljs-keyword">
var</span> <span class="hljs-variable">$cachePersons</span>; <span class="hljs-variable">$cacheAddress </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$text </span>: Text

<span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>; <span class="hljs-string">"www.myserver.com"</span>); <span class="hljs-string">"myDS"</span>)

<span class="hljs-variable">$persons</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">all</span>()

<span class="hljs-variable">$text</span>:=<span class="hljs-string">""</span><span class="hljs-keyword">
For each</span> (<span class="hljs-variable">$p</span>; <span class="hljs-variable">$persons</span>)
    <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$p</span>.firstname+<span class="hljs-string">" lives in "</span>+<span class="hljs-variable">$p</span>.address.city+<span class="hljs-string">" / "</span><span class="hljs-keyword">
End for each</span>

<span class="hljs-variable">$cachePersons</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">getRemoteCache</span>()
<span class="hljs-variable">$cacheAddress</span>:=<span class="hljs-variable">$ds</span>.Adress.<span class="hljs-function">getRemoteCache</span>()
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="参照-2"></a><a href="#参照-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照</h4>
<p><a href="#setremotecachesettings">.setRemoteCacheSettings()</a><br/><a href="#clearremotecache">.clearRemoteCache()</a></p>
<h2><a class="anchor" aria-hidden="true" id="new"></a><a href="#new" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.new()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.new()</strong> : 4D.Entity</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>戻り値</td><td>4D.Entity</td><td>&lt;-</td><td>データクラスの新規エンティティ</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-9"></a><a href="#説明-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.new()</code> 関数は、 メモリ内にデータクラスに空のエンティティを新規作成しそれを返します。</p>
<p>エンティティオブジェクトはメモリ内に作成されますが、<a href="/docs/Rx/ja/API/EntityClass.html#save"><code>.save( )</code></a> 関数が呼び出されるまでデータベースには保存されません。 エンティティを保存する前に削除した場合、復元することはできません。</p>
<p><strong>4D Server</strong>: クライアント/サーバーにおいては、対応するテーブルのプライマリーキーが自動インクリメントであった場合、エンティティがサーバー側に保存されたときに計算されます。</p>
<p>エンティティの全属性は <strong>null</strong> 値で初期化されます。</p>
<blockquote>
<p>4Dデータベースのストラクチャーレベルで <strong>ヌル値を空値にマップ</strong> オプションが選択されていれば、属性はデフォルト値で初期化されます。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="例題-10"></a><a href="#例題-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<p>以下のコードは &quot;Log&quot; データクラスに新しいエンティティを作成し、&quot;info&quot; 属性に情報を記録します:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.LogEntity
 <span class="hljs-variable">$entity</span>:=ds.Log.<span class="hljs-function">new</span>() <span class="hljs-comment">// 参照を作成します</span>
 <span class="hljs-variable">$entity</span>.info:=<span class="hljs-string">"New entry"</span> <span class="hljs-comment">// 情報を格納します</span>
 <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>() <span class="hljs-comment">// エンティティを保存します</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="newselection"></a><a href="#newselection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.newSelection()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.newSelection</strong>( { <em>keepOrder</em> : Integer } ) : 4D.EntitySelection</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>keepOrder</td><td>整数</td><td>-&gt;</td><td><code>dk keep ordered</code>: 順列ありのエンティティセレクションを作成します<br><code>dk non ordered</code> (あるいは省略時): 順列なしのエンティティセレクションを作成します</td></tr>
<tr><td>戻り値</td><td>4D.EntitySelection</td><td>&lt;-</td><td>データクラスの空の新規エンティティセレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-10"></a><a href="#説明-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.newSelection()</code> 関数は、データクラスに紐づいた 追加可能な、空の新規エンティティセレクションをメモリ内に作成します。</p>
<blockquote>
<p>追加可能なエンティティセレクションについての詳細は <a href="/docs/Rx/ja/ORDA/entities.html#共有可能追加可能なエンティティセレクション">共有可能/追加可能なエンティティセレクション</a> を参照ください。</p>
</blockquote>
<p>順列ありのエンティティセレクションを作成するには、<em>keepOrder</em> に <code>dk keep ordered</code> セレクターを渡します。 この引数を省略した場合のデフォルト、あるいは <code>dk non ordered</code> セレクターを渡した場合には、関数は順列なしのエンティティセレクションを返します。 順列なしのエンティティセレクションの方が速いですが、エンティティの位置に頼ることはできません。 詳細については、<a href="/docs/Rx/ja/ORDA/dsmapping.html#エンティティセレクションの順列あり順列なし">エンティティセレクションの順列あり/順列なし</a> を参照ください。</p>
<p>作成された時点では、エンティティセレクションにエンティティは含まれていません(<code>mySelection.length</code> は0を返します)。 あとから <a href="/docs/Rx/ja/API/EntitySelectionClass.html#add"><code>add()</code></a> 関数を呼び出すことで、エンティティセレクションを徐々にビルドしていくことができます。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-11"></a><a href="#例題-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$USelection</span>; <span class="hljs-variable">$OSelection </span>: cs.EmployeeSelection
 <span class="hljs-variable">$USelection</span>:=ds.Employee.<span class="hljs-function">newSelection</span>() <span class="hljs-comment">// 順列なしの空のエンティティセレクションを作成します</span>
 <span class="hljs-variable">$OSelection</span>:=ds.Employee.<span class="hljs-function">newSelection</span>(dk keep ordered) <span class="hljs-comment">// 順列ありの空のエンティティセレクションを作成します</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="query"></a><a href="#query" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.query()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v17 R6</td><td>Formula パラメーターをサポート</td></tr>
<tr><td>v17 R5</td><td>値のプレースホルダーをサポート</td></tr>
<tr><td>v17</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.query</strong>( <em>queryString</em> : Text { ; <em>...value</em> : any } { ; <em>querySettings</em> : Object } ) : 4D.EntitySelection <br><strong>.query</strong>( <em>formula</em> : Object { ; <em>querySettings</em> : Object } ) : 4D.EntitySelection</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>queryString</td><td>テキスト</td><td>-&gt;</td><td>検索条件 (文字列)</td></tr>
<tr><td>formula</td><td>オブジェクト</td><td>-&gt;</td><td>検索条件 (フォーミュラオブジェクト)</td></tr>
<tr><td>value</td><td>any</td><td>-&gt;</td><td>プレースホルダー用の値</td></tr>
<tr><td>querySettings</td><td>オブジェクト</td><td>-&gt;</td><td>クエリオプション: parameters, attributes, args, allowFormulas, context, queryPath, queryPlan</td></tr>
<tr><td>戻り値</td><td>4D.EntitySelection</td><td>&lt;-</td><td><em>queryString</em> または <em>formula</em> に渡した検索条件に合致するエンティティから構成された新しいエンティティセレクション</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="説明-11"></a><a href="#説明-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.query()</code> 関数は、データクラスの全エンティティから、 <em>queryString</em> または <em>formula</em> と任意の <em>value</em> 引数で指定した検索条件に合致するエンティティを検索します。 戻り値は、見つかったエンティティをすべて格納する <code>EntitySelection</code> 型の新しいオブジェクトです。 この関数には、レイジーローディングが適用されます。</p>
<p>エンティティが見つからない場合、空のエンティティセレクションが返されます。</p>
<p><strong>queryString 引数</strong></p>
<p><em>queryString</em> 引数には、以下のシンタックスを使用します:</p>
<pre><code class="hljs css language-4d">attributePath|formula 比較演算子 値   
    {論理演算子 attributePath|formula 比較演算子 値}   
    {order by attributePath {desc | asc}}
</code></pre>
<p>詳細は以下の通りです:</p>
<ul>
<li><strong>attributePath</strong>: クエリの実行対象となる属性パス。 この引数は、単純な名前 (&quot;country&quot; など) のほか、あらゆる有効な属性パス (&quot;country.name&quot; など) の形をとることができます。 属性パスが <code>Collection</code> 型である場合、すべてのオカレンスを管理するには[ ] 記法を使用してください (例: &quot;children[ ].age&quot; など)。</li>
</ul>
<blockquote>
<p><em>&quot;.&quot;, &quot;[ ]&quot;, や &quot;=&quot;, &quot;&gt;&quot;, &quot;#&quot;..., などの特殊文字はクエリ文字列の中で正しく評価されないため、これらが含まれた属性名を直接使用することはできません。 このような属性をクエリするには、プレースホルダーの使用を検討します。これにより、属性パス内で使用できる文字の範囲が広がります (後述の</em> <strong>プレースホルダーの使用</strong> <em>参照)。</em></p>
</blockquote>
<ul>
<li><p><strong>formula</strong>: テキストまたはオブジェクト形式で渡された有効なフォーミュラ。 フォーミュラは処理されるエンティティごとに評価され、ブール値を返さなくてはなりません。 処理中のエンティティはフォーミュラ内において <code>This</code> で参照されます。</p>
<ul>
<li><strong>テキスト</strong>: フォーミュラ文字列の前に <code>eval( )</code> ステートメントが必要です。これにより、クエリが式を正しく解釈します。 例: <em>&quot;eval(length(This.lastname) &gt;=30)&quot;</em></li>
<li><strong>オブジェクト</strong>: <a href="/docs/Rx/ja/API/FunctionClass.html">フォーミュラオブジェクト</a> は <strong>プレースホルダー</strong> (後述参照) を使って受け渡します。 このフォーミュラは、<a href="/docs/Rx/ja/API/FunctionClass.html#formula"><code>Formula</code></a> または <a href="/docs/Rx/ja/API/FunctionClass.html#formula-from-string"><code>Formula from string</code></a> コマンドによって作成されたものでなくてはなりません。</li>
</ul></li>
</ul>
<blockquote>
<ul>
<li>4Dフォーミュラは、<code>&amp;</code> および <code>|</code> 記号のみを論理演算子としてサポートすることに留意が必要です。</li>
<li>フォーミュラ以外にも検索条件がある場合、クエリエンジンの最適化によってほかの検索条件 (たとえばインデックス属性) の処理が優先される場合があり、その場合はエンティティのサブセットのみがフォーミュラの評価対象となります。</li>
</ul>
</blockquote>
<pre><code class="hljs">クエリに使用するフォーミュラは $1 に引数を受け取ることができます。 詳細については後述の **フォーミュラ引数** を参照ください。
</code></pre>
<blockquote>
<ul>
<li>フォーミュラが複雑な場合など、<code>queryString</code> パラメーターを使わずに、<code>formula</code> パラメーターにオブジェクトを直接渡すこともできます。 後述の <strong>フォーミュラ引数</strong> を参照ください。</li>
<li>セキュリティのため、 <code>query()</code> 関数内のフォーミュラ使用を禁止することができます。 <code>querySettings</code> パラメーターの説明を参照ください。</li>
</ul>
</blockquote>
<ul>
<li><p><strong>比較演算子</strong>: <em>attributePath</em> 引数と <em>value</em> 引数の比較に使用する記号 以下の記号がサポートされます:</p>
<table>
<thead>
<tr><th>比較</th><th>記号</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>等しい</td><td>=, ==</td><td>一致するデータを取得します。ワイルドカード (@) をサポートし、文字の大小/アクセントの有無は区別しません。</td></tr>
<tr><td></td><td>===, IS</td><td>一致するデータを取得します。ワイルドカード (@) は標準の文字として認識され、文字の大小/アクセント記号の有無は区別しません。</td></tr>
<tr><td>等しくない</td><td>#, !=</td><td>ワイルドカード (@) をサポートします</td></tr>
<tr><td></td><td>!==, IS NOT</td><td>ワイルドカード (@) は標準の文字として認識されます</td></tr>
<tr><td>小さい</td><td>&lt;</td><td></td></tr>
<tr><td>大きい</td><td>&gt;</td><td></td></tr>
<tr><td>以下</td><td>&lt;=</td><td></td></tr>
<tr><td>以上</td><td>&gt;=</td><td></td></tr>
<tr><td>含まれる</td><td>IN</td><td>コレクション、あるいは複数の値のうち、どれか一つの値と等しいデータを取得します。ワイルドカード (@) をサポートします。</td></tr>
<tr><td>宣言に Not 条件を適用</td><td>NOT</td><td>複数の演算子が含まれる宣言の前に NOT を使用する場合にはカッコをつける必要があります。</td></tr>
<tr><td>キーワードを含む</td><td>%</td><td>キーワードは、文字列あるいはピクチャー型の属性内で使用されるものが対象です。</td></tr>
</tbody>
</table>
</li>
<li><p><strong>値</strong>: コレクションの各要素、あるいはエンティティセレクションの各エンティティのプロパティのカレント値に対して比較する値。 <strong>プレースホルダー</strong> (後述の <strong>プレースホルダーの使用</strong> 参照) か、あるいはデータ型プロパティと同じ型の式を使用することができます。<p><p> 定数値を使用する場合、以下の原則に従う必要があります:</p>
<ul>
<li><strong>テキスト</strong> テキスト型の定数値の場合は単一引用符つき、あるいはなしでも渡すことができます(後述の <strong>引用符を使用する</strong> 参照)。 文字列中の文字列を検索する (&quot;含まれる&quot; クエリ) には、ワイルドカード記号 (@) を使用して検索文字列を指定します (例: &quot;@Smith@&quot;)。 また以下のキーワードはテキスト定数においては使用できません: true, false。</li>
<li><strong>ブール</strong> 型の定数値: <strong>true</strong> または <strong>false</strong> (文字の大小を区別します)</li>
<li><strong>数値</strong> 型の定数値: 浮動小数点は '.' (ピリオド) で区切られます。</li>
<li><strong>日付</strong> 型の定数値: &quot;YYYY-MM-DD&quot; フォーマット。</li>
<li><strong>null</strong> 定数値: &quot;null&quot; キーワードを使用した場合、<strong>null</strong> と <strong>undefined</strong> プロパティの両方が検索されます。</li>
<li>IN 記号を使用したクエリの場合、<em>値</em> はコレクションか、attributePath の型に合致する、[ ] でくくられたカンマ区切りの値である必要があります (文字列においては、<code>&quot;</code> の記号は <code>\</code> でエスケープする必要があります)。</li>
</ul></li>
<li><p><strong>論理演算子</strong>: 複数の条件をクエリ内で結合させるのに使用します(任意)。 以下の論理演算子のいずれか一つを使用できます (名前あるいは記号のどちらかを渡します):</p>
<table>
<thead>
<tr><th>結合</th><th>記号</th></tr>
</thead>
<tbody>
<tr><td>AND</td><td>&amp;, &amp;&amp;, and</td></tr>
<tr><td>OR</td><td>|,||, or</td></tr>
</tbody>
</table>
</li>
<li><p><strong>order by attributePath</strong>: クエリに &quot;order by attributePath&quot; ステートメントを追加することで、結果をソートすることができます。 カンマで区切ることで、複数の order by ステートメントを使用することもできます (例: order by <em>attributePath1</em> desc, <em>attributePath2</em> asc)。 デフォルトの並び順は昇順です。 並び順を指定するには、降順の場合は 'desc'、昇順の場合は 'asc' を追加します。</p></li>
</ul>
<blockquote>
<p>このステートメントを使用した場合、順序ありエンティティセレクションが返されます (詳細については <a href="/docs/Rx/ja/ORDA/dsmapping.html#エンティティセレクションの順列あり順列なし">エンティティセレクションの順列あり/順列なし</a> を参照ください)。</p>
</blockquote>
<p><strong>引用符を使用する</strong></p>
<p>クエリ内で引用符を使用する場合、クエリ内においては単一引用符 ' ' を使用し、クエリ全体をくくるには二重引用符 &quot; &quot; を使用します。クオートを混同するとエラーが返されます。 たとえば:</p>
<pre><code class="hljs css language-4d"><span class="hljs-string">"employee.name = 'smith' AND employee.firstname = 'john'"</span>
</code></pre>
<blockquote>
<p>単一引用符 (') は、クエリ文字列を分解してしまうため、検索値としてはサポートされていません。 たとえば、&quot;comp.name = 'John's pizza' &quot; はエラーを生成します。 単一引用符を含む値を検索するには、プレースホルダーを使用します (後述参照)。</p>
</blockquote>
<p><strong>カッコの使用</strong></p>
<p>クエリ内でカッコを使用すると、計算に優先順位をつけることができます。 たとえば、以下のようにクエリを整理することができます:</p>
<pre><code class="hljs css language-4d"><span class="hljs-string">"(employee.age &gt;= 30 OR employee.age &lt;= 65) AND (employee.salary &lt;= 10000 OR employee.status = 'Manager')"</span>
</code></pre>
<p><strong>プレースホルダーの使用</strong></p>
<p>4D では、<em>queryString</em> 引数内の <em>attributePath</em>、<em>formula</em> および <em>値</em> にプレースホルダーを使用することができます。 プレースホルダーとは、クエリ文字列に挿入するパラメーターで、クエリ文字列が評価される時に他の値で置き換えられるものです。 プレースホルダーの値はクエリ開始時に一度だけ評価されます。各要素に対して毎回評価されるわけではありません。</p>
<p>プレースホルダーには二つの種類があります。<strong>インデックスプレースホルダー</strong> および <strong>命名プレースホルダー</strong> です:</p>
<table>
<thead>
<tr><th></th><th>インデックスプレースホルダー</th><th>命名プレースホルダー</th></tr>
</thead>
<tbody>
<tr><td>定義</td><td><em>queryString</em> には、すべての種類の引数を混ぜて渡すことができます。 <em>queryString</em> 引数は、<em>attributePath</em> と <em>formula</em> と <em>値</em> に以下のものを含めることができます:</td><td><code>:paramName</code> (例: myparam など) という形でパラメーターが挿入され、その値は <em>querySettings</em> 引数の attributes または parameters オブジェクトで提供されます。</td></tr>
<tr><td>例題</td><td><code>$r:=class.query(&quot;:1=:2&quot;;&quot;city&quot;;&quot;Chicago&quot;)</code></td><td><code>$o.attributes:=New object(&quot;att&quot;;&quot;city&quot;)</code><br> <code>$o.parameters:=New object(&quot;name&quot;;&quot;Chicago&quot;)</code><br> <code>$r:=class.query(&quot;:att=:name&quot;;$o)</code></td></tr>
</tbody>
</table>
<p><em>queryString</em> には、すべての種類の引数を混ぜて渡すことができます。 <em>queryString</em> 引数は、<em>attributePath</em> と <em>formula</em> と <em>値</em> に以下のものを含めることができます:</p>
<ul>
<li>定数値 (プレースホルダーを使用しない)</li>
<li>インデックスプレースホルダーや命名プレースホルダー</li>
</ul>
<p>以下の理由から、クエリでのプレースホルダーの使用が<strong>推奨されます</strong>:</p>
<ol>
<li><p>悪意あるコードの挿入を防ぎます: ユーザーによって値が代入された変数をクエリ文字列として直接使用した場合、余計なクエリ引数を入力することでユーザーがクエリ条件を変更する可能性があります。 たとえば、以下のようなクエリ文字列を考えます:</p>
<pre><code class="hljs css language-4d"> <span class="hljs-variable">$vquery</span>:=<span class="hljs-string">"status = 'public' &amp; name = "</span>+myname <span class="hljs-comment">// ユーザーが自分の名前を入力します</span>
 <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$col</span>.<span class="hljs-function">query</span>(<span class="hljs-variable">$vquery</span>)
</code></pre>
<p>非公開のデータがフィルタリングされているため、このクエリは一見安全なように見えます。 しかしながら、もしユーザーが <em>myname</em> に <em>smith OR status='private'</em> のような入力をした場合、クエリ文字列は解釈時に変更され、非公開データも返してしまう可能性があります。</p>
<p>プレースホルダーを使用した場合、セキュリティ条件を上書きすることは不可能です:</p>
<pre><code class="hljs css language-4d"> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$col</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"status='public' &amp; name=:1"</span>;myname)
</code></pre>
<p>この場合、ユーザーが <em>myname</em> エリアに <em>smith OR status='private'</em> と入力した場合でも、それはクエリ文字列とはみなされず、値として渡されるだけです。 &quot;smith OR status='private' &quot; という名前の人物を検索したところで、結果は失敗に終わるだけです。</p></li>
<li><p>フォーマットや文字の問題を心配する必要がありません。これは、<em>attributePath</em> や <em>値</em> がたとえば &quot;.&quot;、&quot;[' ...などの英数字でない文字を格納している可能性がある場合にとくに有用です。</p></li>
<li><p>クエリに変数や式を使用することができます。 例:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$result</span>:=<span class="hljs-variable">$col</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"address.city = :1 &amp; name =:2"</span>;<span class="hljs-variable">$city</span>;<span class="hljs-variable">$myVar</span>+<span class="hljs-string">"@"</span>)
<span class="hljs-variable">$result2</span>:=<span class="hljs-variable">$col</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"company.name = :1"</span>;<span class="hljs-string">"John's Pizzas"</span>)
</code></pre></li>
</ol>
<p><strong>null値の検索</strong></p>
<p>null値を検索する場合、プレースホルダーシンタックスは使用できません。なぜならクエリエンジンは null を予期せぬ比較値としてみなすからです。 たとえば、以下のクエリを実行した場合:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$vSingles</span>:=ds.Person.<span class="hljs-function">query</span>(<span class="hljs-string">"spouse = :1"</span>;<span class="hljs-literal">Null</span>) <span class="hljs-comment">// 機能しません</span>
</code></pre>
<p>この場合 4D は null値を、引数の評価 (別のクエリから渡された属性など) に起因するエラーと解釈するため、期待した結果は得られません。 このようなクエリをおこなうには、直接的なシンタックスを使用する必要があります:</p>
<pre><code class="hljs css language-4d"> <span class="hljs-variable">$vSingles</span>:=ds.Person.<span class="hljs-function">query</span>(<span class="hljs-string">"spouse = null"</span>) <span class="hljs-comment">// 正しいシンタックス</span>
</code></pre>
<p><strong>コレクション要素とクエリ条件のリンク</strong></p>
<p>プロパティを複数持つオブジェクト要素からなりたっているコレクションが、さらに親オブジェクトの属性値である場合に、当該コレクションに特定要素が存在するかを条件に親オブジェクトを検出したいケースを考えます。AND 演算子で結合された複数のクエリ条件を使用して検索するだけでは、異なるコレクション要素がそれぞれ検索条件に合致するプロパティ値を持つ場合にも当該親オブジェクトが検出されてしまいます。 これを避けるには、すべての条件に合致するコレクション要素のみが検出されるよう、クエリ条件をコレクション要素にリンクする必要があります。</p>
<p>たとえば、以下のような 2件のエンティティがあるとき:</p>
<pre><code class="hljs">エンティティ<span class="hljs-number">1</span>:
ds<span class="hljs-selector-class">.People</span><span class="hljs-selector-class">.name</span>: <span class="hljs-string">"martin"</span>
ds<span class="hljs-selector-class">.People</span><span class="hljs-selector-class">.places</span>:
    { <span class="hljs-string">"locations"</span> : [ {
                <span class="hljs-string">"kind"</span>:<span class="hljs-string">"home"</span>,
                <span class="hljs-string">"city"</span>:<span class="hljs-string">"paris"</span>
            } ] }

エンティティ<span class="hljs-number">2</span>:
ds<span class="hljs-selector-class">.People</span><span class="hljs-selector-class">.name</span>: <span class="hljs-string">"smith"</span>
ds<span class="hljs-selector-class">.People</span><span class="hljs-selector-class">.places</span>:
    { <span class="hljs-string">"locations"</span> : [ {
                <span class="hljs-string">"kind"</span>:<span class="hljs-string">"home"</span>,
                <span class="hljs-string">"city"</span>:<span class="hljs-string">"lyon"</span>
            } , {
                <span class="hljs-string">"kind"</span>:<span class="hljs-string">"office"</span>,
                <span class="hljs-string">"city"</span>:<span class="hljs-string">"paris"</span>
            } ] }
</code></pre>
<p>&quot;locations&quot; 属性に、&quot;kind=home&quot; かつ &quot;city=paris&quot; である要素を持つ人を探したいとします。 以下のように書いた場合:</p>
<pre><code class="hljs css language-4d">ds.People.<span class="hljs-function">query</span>(<span class="hljs-string">"places.locations[].kind= :1 and places.locations[].city= :2"</span>;<span class="hljs-string">"home"</span>;<span class="hljs-string">"paris"</span>)
</code></pre>
<p>... クエリは &quot;martin&quot; と &quot;smith&quot; の<strong>両方</strong>を返します。なぜなら &quot;smith&quot; も &quot;kind=home&quot; である &quot;location&quot; 要素を持っており、&quot;city=paris&quot; である &quot;location&quot; 要素をも持っているからです (ですがこれら 2つは異なる要素です)。</p>
<p>検索条件に合致する属性が同一のコレクション要素に含まれるエンティティのみを取得するには、<strong>クエリ条件をリンク</strong> します。 クエリ条件をリンクするには:</p>
<ul>
<li>リンクする最初のクエリ条件にてパスの [] 内に文字を追加し、同様に他のクエリ条件でも同じ文字を追加します。 例: <code>locations[a].city and locations[a].kind</code>。 ローマ字であればどの文字でも使用可能です (文字の大小は区別されません)。</li>
<li>同じクエリ内に、異なるリンク条件を追加するには、別の文字を使用します。 単一のクエリ内では、最大で 26組のリンク条件を使用することができます。</li>
</ul>
<p>上記の 2件のエンティティにおいて、以下のように書いた場合:</p>
<pre><code class="hljs css language-4d">ds.People.<span class="hljs-function">query</span>(<span class="hljs-string">"places.locations[a].kind= :1 and places.locations[a].city= :2"</span>;<span class="hljs-string">"home"</span>;<span class="hljs-string">"paris"</span>)
</code></pre>
<p>... クエリは、&quot;kind=home&quot; かつ &quot;city=paris&quot; である &quot;locations&quot; 要素を持つエンティティ &quot;martin&quot; のみを返します。 &quot;home&quot; と&quot;paris&quot; が同じコレクション要素内にない &quot;smith&quot; は、クエリの結果に含まれません。</p>
<p><strong>N対Nリレーションのクエリ</strong></p>
<p>ORDA は、N対Nリレーションにおけるクエリを容易にするための特別な構文を提供します。 このような場合には、<code>AND</code> 演算子を使って同じ属性の異なる値を検索する必要があるかもしれません。 たとえば、以下のようなストラクチャーの場合を考えます:</p>
<p><img src="/docs/Rx/assets/en/API/manytomany.png" alt="alt-text"></p>
<p>俳優 A と俳優 B の <em>両方</em> が出演している映画をすべて検索したいとします。 <code>AND</code> 演算子を使った単純なクエリを書いても、うまくいきません:</p>
<pre><code class="hljs css language-4d"><span class="hljs-comment">// 無効なコード</span>
<span class="hljs-variable">$es</span>:=ds.Movie.<span class="hljs-function">query</span>(<span class="hljs-string">"roles.actor.lastName = :1 AND roles.actor.lastName = :2"</span>;<span class="hljs-string">"Hanks"</span>;<span class="hljs-string">"Ryan"</span>)  
<span class="hljs-comment">// $es is empty</span>
</code></pre>
<p>基本的に、この問題はクエリの内部ロジックに関連しています。 値が &quot;A&quot; と &quot;B&quot; の両方である属性を検索することはできません。</p>
<p><strong>比較演算子</strong>: <em>attributePath</em> 引数と <em>value</em> 引数の比較に使用する記号 以下の記号がサポートされます:</p>
<pre><code class="hljs css language-4d"><span class="hljs-string">"relationAttribute.attribute = :1 AND relationAttribute{x}.attribute = :2 [AND relationAttribute{y}.attribute...]"</span>
</code></pre>
<p><strong>{x}</strong> は、リレーション属性のために新たな参照を作成するよう、ORDA に指示します。 すると、ORDA は必要なビットマップ操作を内部で実行します。 <strong>x</strong> は <strong>0 以外</strong> の任意の数であることに注意してください ({1}、{2}、{1540}...)。 ORDA は、各クラスインデックス用の一意な参照をクエリ内においてのみ必要とします。</p>
<p>この例では、次のようになります:</p>
<pre><code class="hljs css language-4d"><span class="hljs-comment">// 有効なコード</span>
<span class="hljs-variable">$es</span>:=ds.Movie.<span class="hljs-function">query</span>(<span class="hljs-string">"roles.actor.lastName = :1 AND roles.actor{2}.lastName = :2"</span>;<span class="hljs-string">"Hanks"</span>;<span class="hljs-string">"Ryan"</span>)  
<span class="hljs-comment">// $es には映画が格納されます (You've Got Mail, Sleepless in Seattle, Joe Versus the Volcano)</span>
</code></pre>
<p><strong>formula 引数</strong></p>
<p><em>queryString</em> 引数にフォーミュラを挿入 (上記参照) する代わりに、formula オブジェクトをブール検索条件として直接渡すことができます。 トークナイズの利点を生かせる、コードが検索しやすく読みやすい、などといった面から、クエリにおけるフォーミュラオブジェクトの使用は <strong>推奨</strong> されています。</p>
<p>このフォーミュラは、<a href="/docs/Rx/ja/API/FunctionClass.html#formula"><code>Formula</code></a> または <a href="/docs/Rx/ja/API/FunctionClass.html#formula-from-string"><code>Formula from string</code></a> コマンドによって作成されたものでなくてはなりません。 この場合において:</p>
<ul>
<li>フォーミュラは処理されるエンティティごとに評価され、true または false を返さなくてはなりません。 クエリの実行中、フォーミュラの結果がブール値でなかった場合、それは false であるとみなされます。</li>
<li>処理中のエンティティはフォーミュラ内において <code>This</code> で参照されます。</li>
<li><code>Formula</code> オブジェクトが <strong>null</strong> の場合、エラー1626 (&quot;テキストまたはフォーミュラが必要です&quot;) が生成されます。</li>
</ul>
<blockquote>
<p>セキュリティのため、 <code>query()</code> 関数内のフォーミュラ使用を禁止することができます。 <em>querySettings</em> パラメーターの説明を参照ください。</p>
</blockquote>
<p><strong>フォーミュラに引数を渡す</strong></p>
<p><code>query()</code> クラス関数によって呼び出されるフォーミュラは、引数を受け取ることができます:</p>
<ul>
<li>引数は、<em>querySettings</em> 引数の <strong>args</strong> プロパティ (オブジェクト) を通して渡さなければなりません。</li>
<li>フォーミュラは <strong>args</strong> オブジェクトを <strong>$1</strong> に受け取ります。</li>
</ul>
<p>以下の短いコードは、引数をフォーミュラに渡す仕組みを示しています:</p>
<pre><code class="hljs css language-4d"> <span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"args"</span>;<span class="hljs-function">New object</span>(<span class="hljs-string">"exclude"</span>;<span class="hljs-string">"-"</span>)) <span class="hljs-comment">// 引数を渡すための args オブジェクト</span>
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"eval(checkName($1.exclude))"</span>;<span class="hljs-variable">$settings</span>) <span class="hljs-comment">// $1 が args を受け取ります</span>
</code></pre>
<p>さらなる使用例は、例題3にて紹介されています。</p>
<p><strong>4D Server</strong>: クライアント/サーバーにおいては、フォーミュラはサーバー上で実行されます。 このコンテキストにおいては、<code>querySettings.args</code> オブジェクトのみがフォーミュラに送信されます。</p>
<p><strong>querySettings 引数</strong></p>
<p><em>querySettings</em> 引数は、追加のオプションを格納したオブジェクトです。 以下のオブジェクトプロパティがサポートされています:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>parameters</td><td>オブジェクト</td><td><em>queryString</em> または <em>formula</em> に <strong>値の命名プレースホルダー</strong> を使用した場合に渡すオブジェクト。 値は、プロパティ/値のペアで表現されます。プロパティは、<em>queryString</em> または <em>formula</em> に値の代わりに挿入されたプレースホルダー名 (&quot;:placeholder&quot;など) で、値は、実際に比較される値です。 インデックスプレースホルダー (value引数として値を直接渡す方法) と命名プレースホルダーは、同じクエリ内で同時に使用することができます。</td></tr>
<tr><td>attributes</td><td>オブジェクト</td><td><em>queryString</em> または <em>formula</em> に <strong>属性パスの命名プレースホルダー</strong> を使用した場合に渡すオブジェクト。 属性パスは、プロパティ/値のペアで表現されます。プロパティは、<em>queryString</em> または <em>formula</em> に属性パスの代わりに挿入されたプレースホルダー名 (&quot;:placeholder&quot;など) で、値は、属性パスを表す文字列または文字列のコレクションです。 値には、データクラスのスカラー属性・リレート属性・オブジェクトフィールド内のプロパティへの属性パスを指定することができます。<p><table><tr><th>タイプ</th><th>説明</th></tr><tr><td>String</td><td>ドット記法を使用して表現された attributePath (例: &quot;name&quot; または &quot;user.address.zipCode&quot;)</td></tr><tr><td>文字列のコレクション</td><td>コレクションの各要素が attributePath の階層を表します (例: [&quot;name&quot;] または [&quot;user&quot;,&quot;address&quot;,&quot;zipCode&quot;])。 コレクションを使用することで、ドット記法に準じていない名前の属性に対してもクエリすることができます (例: [&quot;4Dv17.1&quot;,&quot;en/fr&quot;])。</td></tr></table>インデックスプレースホルダー (<em>value</em> 引数として値を直接渡す方法) と命名プレースホルダーは、同じクエリ内で同時に使用することができます。</td></tr>
<tr><td>args</td><td>オブジェクト</td><td>フォーミュラに渡す引数。 <strong>args</strong> オブジェクトは、フォーミュラ内の $1 が受け取るので、その値は <em>$1.property</em> という形で利用可能です (例題3 参照)。</td></tr>
<tr><td>allowFormulas</td><td>ブール</td><td>クエリ内でフォーミュラの呼び出しを許可するには true (デフォルト)。 フォーミュラ実行を禁止するには false を渡します。 false に設定されているときに、フォーミュラが <code>query()</code> に渡された場合、エラーが発生します (1278 - フォーミュラはこのメンバーメソッドでは許可されていません)。</td></tr>
<tr><td>context</td><td>テキスト</td><td>エンティティセレクションに適用されている自動の最適化コンテキストのラベル。 エンティティセレクションを扱うコードはこのコンテキストを使うことで最適化の恩恵を受けます。 この機能はクライアント/サーバー処理を想定して設計されています。詳細な情報については、<a href="entities.md#クライアントサーバーの最適化"><strong>クライアント/サーバーの最適化</strong></a> の章を参照ください。</td></tr>
<tr><td>queryPlan</td><td>ブール</td><td>戻り値のエンティティコレクションに、実行する直前のクエリの詳細 (クエリプラン) を含めるかどうかを指定します。 返されるプロパティは、クエリプラン あるいはサブクエリ (複合クエリの場合) を格納したオブジェクトです。 このオプションはアプリケーションの開発フェーズにおいて有用です。 このオプションは通常 queryPath と組み合わせて使用されます。 省略時のデフォルト: false。 <strong>注:</strong> このプロパティは <code>entitySelection.query()</code> および <code>dataClass.query()</code> 関数においてのみサポートされます。</td></tr>
<tr><td>queryPath</td><td>ブール</td><td>戻り値のエンティティコレクションに、実際に実行されたクエリの詳細を含めるかどうかを指定します。 返されたプロパティは、クエリで実際に使用されたパス (通常は queryPlan と同一ですが、エンジンがクエリを最適化した場合には異なる場合があります)、処理時間と検出レコード数を格納したオブジェクトです。 このオプションはアプリケーションの開発フェーズにおいて有用です。 省略時のデフォルト: false。 <strong>注:</strong> このプロパティは <code>entitySelection.query()</code> および <code>dataClass.query()</code> 関数においてのみサポートされます。</td></tr>
</tbody>
</table>
<p><strong>queryPlan と queryPath について</strong></p>
<p><code>queryPlan</code>/<code>queryPath</code> に格納される情報には、クエリの種類 (インデックスあるいはシーケンシャル)、必要なサブクエリおよびその連結演算子が含まれます。 クエリパスには、見つかったエンティティの数と各検索条件を実行するににかかった時間も含まれます。 この情報は、アプリケーションの開発中に解析することで有効に活用できます。 一般的には、クエリプランとクエリパスの詳細は同一になるはずですが、4D はパフォーマンスの向上のために、動的な最適化をクエリ実行時に実装することがあるからです。 たとえば、その方が早いと判断した場合には、4Dエンジンはインデックス付きクエリをシーケンシャルなものへと動的に変換することがあります。 これは検索されているエンティティの数が少ないときに起こりえます。</p>
<p>たとえば、以下のクエリを実行した場合:</p>
<pre><code class="hljs css language-4d"> <span class="hljs-variable">$sel</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"salary &lt; :1 and employer.name = :2 or employer.revenues &gt; :3"</span>;\  
 <span class="hljs-number">50000</span>;<span class="hljs-string">"Lima West Kilo"</span>;<span class="hljs-number">10000000</span>;<span class="hljs-function">New object</span>(<span class="hljs-string">"queryPath"</span>;<span class="hljs-literal">True</span>;<span class="hljs-string">"queryPlan"</span>;<span class="hljs-literal">True</span>))
</code></pre>
<p>queryPlan:</p>
<pre><code class="hljs css language-4d">{Or:[{And:[{item:[index : Employee.salary ] &lt; <span class="hljs-number">50000</span>},  
    {item:Join on Table : Company  :  Employee.employerID = Company.ID,  
    subquery:[{item:[index : Company.name ] = Lima West Kilo}]}]},  
    {item:Join on Table : Company  :  Employee.employerID = Company.ID,  
    subquery:[{item:[index : Company.revenues ] &gt; <span class="hljs-number">10000000</span>}]}]}
</code></pre>
<p>queryPath:</p>
<pre><code class="hljs css language-4d">{steps:[{description:OR,time:<span class="hljs-number">63</span>,recordsfounds:<span class="hljs-number">1388132</span>,  
    steps:[{description:AND,time:<span class="hljs-number">32</span>,recordsfounds:<span class="hljs-number">131</span>,  
    steps:[{description:[index : Employee.salary ] &lt; <span class="hljs-number">50000</span>,time:<span class="hljs-number">16</span>,recordsfounds:<span class="hljs-number">728260</span>},{description:Join on Table : Company  :  Employee.employerID = Company.ID,time:<span class="hljs-number">0</span>,recordsfounds:<span class="hljs-number">131</span>,  
    steps:[{steps:[{description:[index : Company.name ] = Lima West Kilo,time:<span class="hljs-number">0</span>,recordsfounds:<span class="hljs-number">1</span>}]}]}]},{description:Join on Table : Company  :  Employee.employerID = Company.ID,time:<span class="hljs-number">31</span>,recordsfounds:<span class="hljs-number">1388132</span>,  
    steps:[{steps:[{description:[index : Company.revenues ] &gt; <span class="hljs-number">10000000</span>,time:<span class="hljs-number">0</span>,recordsfounds:<span class="hljs-number">933</span>}]}]}]}]}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-1-4"></a><a href="#例題-1-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 1</h4>
<p>この例題では、様々なクエリの例を紹介します。</p>
<p>文字列のクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Customer.<span class="hljs-function">query</span>(<span class="hljs-string">"firstName = 'S@'"</span>)
</code></pre>
<p>NOT節を用いたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"not(firstName=Kim)"</span>)
</code></pre>
<p>日付のクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"birthDate &gt; :1"</span>;<span class="hljs-string">"1970-01-01"</span>)
<span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"birthDate &lt;= :1"</span>;Current date<span class="hljs-number">-10950</span>)
</code></pre>
<p>値のインデックスプレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Customer.<span class="hljs-function">query</span>(<span class="hljs-string">"(firstName = :1 or firstName = :2) and (lastName = :3 or lastName = :4)"</span>;<span class="hljs-string">"D@"</span>;<span class="hljs-string">"R@"</span>;<span class="hljs-string">"S@"</span>;<span class="hljs-string">"K@"</span>)
</code></pre>
<p>リレートデータクラス対して値のインデックスプレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1 and manager.lastName = :2"</span>;<span class="hljs-string">"M@"</span>;<span class="hljs-string">"S@"</span>)
</code></pre>
<p>降順の order by ステートメントを含んだ、インデックスプレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Student.<span class="hljs-function">query</span>(<span class="hljs-string">"nationality = :1 order by campus.name desc, lastname"</span>;<span class="hljs-string">"French"</span>)
</code></pre>
<p>値の命名プレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$querySettings </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$managedCustomers </span>: cs.CustomerSelection
<span class="hljs-variable">$querySettings</span>:=New object
<span class="hljs-variable">$querySettings</span>.parameters:=<span class="hljs-function">New object</span>(<span class="hljs-string">"userId"</span>;<span class="hljs-number">1234</span>;<span class="hljs-string">"extraInfo"</span>;<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Smith"</span>))
<span class="hljs-variable">$managedCustomers</span>:=ds.Customer.<span class="hljs-function">query</span>(<span class="hljs-string">"salesperson.userId = :userId and name = :extraInfo.name"</span>;<span class="hljs-variable">$querySettings</span>)
</code></pre>
<p>値の命名プレースホルダーと、値のインデックスプレースホルダーの両方を使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$querySettings </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$managedCustomers </span>: cs.CustomerSelection
<span class="hljs-variable">$querySettings</span>.parameters:=<span class="hljs-function">New object</span>(<span class="hljs-string">"userId"</span>;<span class="hljs-number">1234</span>)
<span class="hljs-variable">$managedCustomers</span>:=ds.Customer.<span class="hljs-function">query</span>(<span class="hljs-string">"salesperson.userId = :userId and name=:1"</span>;<span class="hljs-string">"Smith"</span>;<span class="hljs-variable">$querySettings</span>)
</code></pre>
<p>queryPlan および queryPath オブジェクトを返すクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"(firstName = :1 or firstName = :2) and (lastName = :3 or lastName = :4)"</span>;<span class="hljs-string">"D@"</span>;<span class="hljs-string">"R@"</span>;<span class="hljs-string">"S@"</span>;<span class="hljs-string">"K@"</span>;<span class="hljs-function">New object</span>(<span class="hljs-string">"queryPlan"</span>;<span class="hljs-literal">True</span>;<span class="hljs-string">"queryPath"</span>;<span class="hljs-literal">True</span>))

  <span class="hljs-comment">// 戻り値のエンティティセレクションから以下のプロパティを取得できます</span><span class="hljs-keyword">
var</span> <span class="hljs-variable">$queryPlan</span>; <span class="hljs-variable">$queryPath </span>: Object
<span class="hljs-variable">$queryPlan</span>:=<span class="hljs-variable">$entitySelection</span>.queryPlan
<span class="hljs-variable">$queryPath</span>:=<span class="hljs-variable">$entitySelection</span>.queryPath
</code></pre>
<p>コレクション型の属性パスを用いたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"extraInfo.hobbies[].name = :1"</span>;<span class="hljs-string">"horsebackriding"</span>)
</code></pre>
<p>コレクション型の属性パスとクエリ条件をリンクしたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"extraInfo.hobbies[a].name = :1 and extraInfo.hobbies[a].level=:2"</span>;<span class="hljs-string">"horsebackriding"</span>;<span class="hljs-number">2</span>)
</code></pre>
<p>コレクション型の属性パスとクエリ条件を、複数リンクしたクエリ:</p>
<pre><code class="hljs css language-4d">$entitySelection:=ds.Employee.query("extraInfo.hobbies[a].name = :1 and
    extraInfo.hobbies[a].level = :2 and extraInfo.hobbies[b].name = :3 and
    extraInfo.hobbies[b].level = :4";"horsebackriding";2;"Tennis";5)
</code></pre>
<p>オブジェクト型の属性パスを用いたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"extra.eyeColor = :1"</span>;<span class="hljs-string">"blue"</span>)
</code></pre>
<p>IN節を用いたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"firstName in :1"</span>;<span class="hljs-function">New collection</span>(<span class="hljs-string">"Kim"</span>;<span class="hljs-string">"Dixie"</span>))
</code></pre>
<p>NOT (IN) 節を用いたクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$entitySelection</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"not (firstName in :1)"</span>;<span class="hljs-function">New collection</span>(<span class="hljs-string">"John"</span>;<span class="hljs-string">"Jane"</span>))
</code></pre>
<p>属性パスのインデックスプレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$es </span>: cs.EmployeeSelection
<span class="hljs-variable">$es</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">":1 = 1234 and :2 = 'Smith'"</span>;<span class="hljs-string">"salesperson.userId"</span>;<span class="hljs-string">"name"</span>)
  <span class="hljs-comment">// salesperson はリレートエンティティです</span>
</code></pre>
<p>属性パスのインデックスプレースホルダーを、値の命名プレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$es </span>: cs.EmployeeSelection<span class="hljs-keyword">
var</span> <span class="hljs-variable">$querySettings </span>: Object
<span class="hljs-variable">$querySettings</span>:=New object
<span class="hljs-variable">$querySettings</span>.parameters:=<span class="hljs-function">New object</span>(<span class="hljs-string">"customerName"</span>;<span class="hljs-string">"Smith"</span>)
<span class="hljs-variable">$es</span>:=ds.Customer.<span class="hljs-function">query</span>(<span class="hljs-string">":1 = 1234 and :2 = :customerName"</span>;<span class="hljs-string">"salesperson.userId"</span>;<span class="hljs-string">"name"</span>;<span class="hljs-variable">$querySettings</span>)
  <span class="hljs-comment">// salesperson はリレートエンティティです</span>
</code></pre>
<p>属性パスと値のインデックスプレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$es </span>: cs.EmployeeSelection
<span class="hljs-variable">$es</span>:=ds.Clients.<span class="hljs-function">query</span>(<span class="hljs-string">":1 = 1234 and :2 = :3"</span>;<span class="hljs-string">"salesperson.userId"</span>;<span class="hljs-string">"name"</span>;<span class="hljs-string">"Smith"</span>)
  <span class="hljs-comment">// salesperson はリレートエンティティです</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-2-4"></a><a href="#例題-2-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 2</h4>
<p>この例題では、属性パスの命名プレースホルダーを使用するクエリを紹介します。</p>
<p>2件のエンティティをもつ Employee データクラスを前提に考えます:</p>
<p>エンティティ1:</p>
<pre><code class="hljs css language-4d">name: <span class="hljs-string">"Marie"</span>
number: <span class="hljs-number">46</span>
softwares:{
<span class="hljs-string">"Word 10.2"</span>: <span class="hljs-string">"Installed"</span>,
<span class="hljs-string">"Excel 11.3"</span>: <span class="hljs-string">"To be upgraded"</span>,
<span class="hljs-string">"Powerpoint 12.4"</span>: <span class="hljs-string">"Not installed"</span>
}
</code></pre>
<p>エンティティ2:</p>
<pre><code class="hljs css language-4d">name: <span class="hljs-string">"Sophie"</span>
number: <span class="hljs-number">47</span>
softwares:{
<span class="hljs-string">"Word 10.2"</span>: <span class="hljs-string">"Not installed"</span>,
<span class="hljs-string">"Excel 11.3"</span>: <span class="hljs-string">"To be upgraded"</span>,
<span class="hljs-string">"Powerpoint 12.4"</span>: <span class="hljs-string">"Not installed"</span>
}
</code></pre>
<p>属性パスの命名プレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$querySettings </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$es </span>: cs.EmployeeSelection
 <span class="hljs-variable">$querySettings</span>:=New object
 <span class="hljs-variable">$querySettings</span>.attributes:=<span class="hljs-function">New object</span>(<span class="hljs-string">"attName"</span>;<span class="hljs-string">"name"</span>;<span class="hljs-string">"attWord"</span>;<span class="hljs-function">New collection</span>(<span class="hljs-string">"softwares"</span>;<span class="hljs-string">"Word 10.2"</span>))
 <span class="hljs-variable">$es</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">":attName = 'Marie' and :attWord = 'Installed'"</span>;<span class="hljs-variable">$querySettings</span>)
  <span class="hljs-comment">//$es.length=1 (Employee Marie)</span>
</code></pre>
<p>属性パスと値の命名プレースホルダーを使用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$querySettings </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$es </span>: cs.EmployeeSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$name </span>: Text
 <span class="hljs-variable">$querySettings</span>:=New object
  <span class="hljs-comment">// 値の命名プレースホルダー</span>
  <span class="hljs-comment">// ユーザーに検索する名前を入力してもらいます</span>
 <span class="hljs-variable">$name</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"検索する名前を入力してください:"</span>)<span class="hljs-keyword">
 If</span>(OK=<span class="hljs-number">1</span>)
    <span class="hljs-variable">$querySettings</span>.parameters:=<span class="hljs-function">New object</span>(<span class="hljs-string">"givenName"</span>;<span class="hljs-variable">$name</span>)
  <span class="hljs-comment">// 属性パスの命名プレースホルダー</span>
    <span class="hljs-variable">$querySettings</span>.attributes:=<span class="hljs-function">New object</span>(<span class="hljs-string">"attName"</span>;<span class="hljs-string">"name"</span>)
    <span class="hljs-variable">$es</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">":attName= :givenName"</span>;<span class="hljs-variable">$querySettings</span>)<span class="hljs-keyword">
 End if</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="例題-3-3"></a><a href="#例題-3-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題 3</h4>
<p>この例題では、クエリにおいて、引数あり・引数なしでフォーミュラを使用する様々な方法を紹介します。</p>
<p><code>eval()</code> を使い、テキストとしてフォーミュラを <em>queryString</em> パラメーターに渡すクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"eval(length(This.lastname) &gt;=30) and nationality='French'"</span>)
</code></pre>
<p>プレースホルダーを使い、<code>Formula</code>オブジェクトとしてフォーミュラを渡すクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$formula </span>: Object
 <span class="hljs-variable">$formula</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Length</span>(<span class="hljs-literal">This</span>.lastname)&gt;=<span class="hljs-number">30</span>)
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">":1 and nationality='French'"</span>;<span class="hljs-variable">$formula</span>)
</code></pre>
<p><code>Formula</code> オブジェクトのみを検索条件として渡したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$formula </span>: Object
 <span class="hljs-variable">$formula</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Length</span>(<span class="hljs-literal">This</span>.lastname)&gt;=<span class="hljs-number">30</span>)
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-variable">$formula</span>)
</code></pre>
<p>フォーミュラを複数適用したクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$formula1</span>; <span class="hljs-variable">$1</span>; <span class="hljs-variable">$formula2 </span>;<span class="hljs-variable">$0 </span>: Object
 <span class="hljs-variable">$formula1</span>:=<span class="hljs-variable">$1</span>
 <span class="hljs-variable">$formula2</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Length</span>(<span class="hljs-literal">This</span>.firstname)&gt;=<span class="hljs-number">30</span>)
 <span class="hljs-variable">$0</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">":1 and :2 and nationality='French'"</span>;<span class="hljs-variable">$formula1</span>;<span class="hljs-variable">$formula2</span>)
</code></pre>
<p><em>queryString</em> のテキストフォーミュラが引数を受け取るクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$settings </span>: Object
 <span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>()
 <span class="hljs-variable">$settings</span>.args:=<span class="hljs-function">New object</span>(<span class="hljs-string">"filter"</span>;<span class="hljs-string">"-"</span>)
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"eval(checkName($1.filter)) and nationality=:1"</span>;<span class="hljs-string">"French"</span>;<span class="hljs-variable">$settings</span>)
</code></pre>
<pre><code class="hljs css language-4d">  <span class="hljs-comment">// checkName メソッド</span>
 #<span class="hljs-function">DECLARE</span>(<span class="hljs-variable">$exclude </span>: Text) -&gt; <span class="hljs-variable">$result </span>: Boolean
 <span class="hljs-variable">$result</span>:=(<span class="hljs-function">Position</span>(<span class="hljs-variable">$exclude</span>;<span class="hljs-literal">This</span>.lastname)=<span class="hljs-number">0</span>)
</code></pre>
<p>同じ <strong><em>checkName</em></strong> メソッドを <code>Formula</code> オブジェクトに格納してプレースホルダーで渡し、引数を受け取るクエリ:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$formula </span>: Object
 <span class="hljs-variable">$formula</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">checkName</span>(<span class="hljs-variable">$1</span>.filter))
 <span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>()
 <span class="hljs-variable">$settings</span>.args:=<span class="hljs-function">New object</span>(<span class="hljs-string">"filter"</span>;<span class="hljs-string">"-"</span>)
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">":1 and nationality=:2"</span>;<span class="hljs-variable">$formula</span>;<span class="hljs-string">"French"</span>;<span class="hljs-variable">$settings</span>)
 <span class="hljs-variable">$settings</span>.args.filter:=<span class="hljs-string">"*"</span> <span class="hljs-comment">// $formula オブジェクトは更新せずに引数を変更します</span>
 <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-string">":1 and nationality=:2"</span>;<span class="hljs-variable">$formula</span>;<span class="hljs-string">"French"</span>;<span class="hljs-variable">$settings</span>)
</code></pre>
<p>ユーザーがクエリを入力する場合などに、フォーミュラを禁止する場合:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.StudentsSelection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$settings </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$queryString </span>: Text
 <span class="hljs-variable">$queryString</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Enter your query:"</span>)
<span class="hljs-function"> if</span>(OK=<span class="hljs-number">1</span>)
    <span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"allowFormulas"</span>;<span class="hljs-literal">False</span>)
    <span class="hljs-variable">$es</span>:=ds.Students.<span class="hljs-function">query</span>(<span class="hljs-variable">$queryString</span>;<span class="hljs-variable">$settings</span>) <span class="hljs-comment">// $queryString にフォーミュラが格納されていた場合にはエラーが生成されます</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="参照-3"></a><a href="#参照-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照</h4>
<p>エンティティセレクションの <a href="/docs/Rx/ja/API/EntitySelectionClass.html#query"><code>.query()</code></a></p>
<h2><a class="anchor" aria-hidden="true" id="setremotecachesettings"></a><a href="#setremotecachesettings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.setRemoteCacheSettings()</h2>
<p><details><summary>履歴</summary></p>
<table>
<thead>
<tr><th>バージョン</th><th>内容</th></tr>
</thead>
<tbody>
<tr><td>v19 R5</td><td>追加</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.setRemoteCacheSettings</strong>(<em>settings</em> : Object)</p>
<table>
<thead>
<tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>settings</td><td>オブジェクト</td><td>-&gt;</td><td>データクラスの ORDAキャッシュについて、タイムアウトと最大サイズを指定するオブジェクト</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>上級者向け:</strong> この機能は、特定の構成のため、ORDAのデフォルト機能をカスタマイズする必要がある開発者向けです。 ほとんどの場合、使用する必要はないでしょう。</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="説明-12"></a><a href="#説明-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>説明</h4>
<p><code>.setRemoteCacheSettings()</code> 関数は、 データクラスの ORDAキャッシュについて、タイムアウトと最大サイズを指定します。</p>
<p><em>settings</em> には、以下のプロパティを持つオブジェクトを渡します:</p>
<table>
<thead>
<tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr>
</thead>
<tbody>
<tr><td>timeout</td><td>整数</td><td>タイムアウト (秒単位)</td></tr>
<tr><td>maxEntries</td><td>整数</td><td>エンティティの最大数</td></tr>
</tbody>
</table>
<p><code>timeout</code> は、データクラスの ORDAキャッシュのタイムアウトを設定します (デフォルトは 30秒)。 タイムアウトを過ぎると、キャッシュ内のデータクラスのエンティティは期限切れとみなされます。 これは、次のことを意味します:</p>
<ul>
<li>データはまだ存在します</li>
<li>次にそのデータが必要になったときには、サーバーに要求します</li>
<li>エンティティの最大数に達すると、4D は期限切れのデータを自動的に削除します</li>
</ul>
<p><code>timeout</code> プロパティを設定すると、すでにキャッシュに存在するエンティティに新しいタイムアウトが設定されます。 これは頻繁に変更されないデータを扱う場合、つまり、サーバーへの新たな要求が必要ない場合に便利です。</p>
<p><code>maxEntries</code> は、ORDAキャッシュ内のエンティティの最大数を設定します。 デフォルトは 30,000 です。</p>
<p>最小エントリー数は 300 のため、<code>maxEntries</code> の値は 300以上でなくてはなりません。 それ以外の場合は無視され、最大エントリー数は 300 に設定されます。</p>
<p><code>timeout</code> および <code>maxEntries</code> として有効なプロパティが渡されない場合、キャッシュはデフォルト値または以前に設定された値のまま変更されません。</p>
<p>エンティティが保存されると、キャッシュ内で更新され、タイムアウトに達すると期限切れとなります。</p>
<h4><a class="anchor" aria-hidden="true" id="例題-12"></a><a href="#例題-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>例題</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$ds </span>: 4D.DataStoreImplementation

<span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>; <span class="hljs-string">"www.myserver.com"</span>); <span class="hljs-string">"myDS"</span>)

<span class="hljs-variable">$ds</span>.Buildings.<span class="hljs-function">setRemoteCacheSettings</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"timeout"</span>; <span class="hljs-number">60</span>; <span class="hljs-string">"maxEntries"</span>; <span class="hljs-number">350</span>))
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="参照-4"></a><a href="#参照-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参照</h4>
<p><a href="#clearremotecache">.clearRemoteCache()</a><br/><a href="#clearremotecache">.getRemoteCache()</a></p>
<style> h2 { background: #d9ebff;}</style>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/Rx/ja/API/CryptoKeyClass.html"><span class="arrow-prev">← </span><span class="function-name-prevnext">CryptoKey</span></a><a class="docs-next button" href="/docs/Rx/ja/API/DataClassAttributeClass.html"><span class="function-name-prevnext">DataClassAttribute</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#attributename">.<em>attributeName</em></a></li><li><a href="#all">.all()</a></li><li><a href="#clearremotecache">.clearRemoteCache()</a></li><li><a href="#fromcollection">.fromCollection()</a></li><li><a href="#get">.get()</a></li><li><a href="#getcount">.getCount()</a></li><li><a href="#getdatastore">.getDataStore()</a></li><li><a href="#getinfo">.getInfo()</a></li><li><a href="#getremotecache">.getRemoteCache()</a></li><li><a href="#new">.new()</a></li><li><a href="#newselection">.newSelection()</a></li><li><a href="#query">.query()</a></li><li><a href="#setremotecachesettings">.setRemoteCacheSettings()</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/Rx/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                appId: 'OJ04C0M3CU',
                apiKey: '5f22ebbb9382abafeadc3e86ca47d4af',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ja","version:19 R5"]}
              });
            </script></body></html>