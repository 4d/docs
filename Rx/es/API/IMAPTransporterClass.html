<!DOCTYPE html><html lang="es"><head><meta name="docsearch:version" content="19 R3"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>IMAPTransporter · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The `IMAPTransporter` class allows you to retrieve messages from a IMAP email server."/><meta name="docsearch:language" content="es"/><meta property="og:title" content="IMAPTransporter · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/Rx/index.html"/><meta property="og:description" content="The `IMAPTransporter` class allows you to retrieve messages from a IMAP email server."/><meta property="og:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/Rx/img/logohome.png"/><link rel="shortcut icon" href="/docs/Rx/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/Rx/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/Rx/js/code-blocks-buttons.js"></script><script src="/docs/Rx/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/Rx/css/main.css"/><script src="/docs/Rx/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/Rx/es"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R5 BETA</a></li><li class=""><a href="https://developer.4d.com/docs/Rx" target="_self">v19 R4</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/Rx/img/language.svg" alt="Languages icon"/>Español</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/Rx/en/API/IMAPTransporterClass.html">English</a></li><li><a href="/docs/Rx/ja/API/IMAPTransporterClass.html">日本語</a></li><li><a href="/docs/Rx/de/API/IMAPTransporterClass.html">Deutsch</a></li><li><a href="/docs/Rx/fr/API/IMAPTransporterClass.html">Français</a></li><li><a href="/docs/Rx/pt/API/IMAPTransporterClass.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Clases API</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Gestión de proyecto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Project/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Project/architecture.html">Arquitectura de un proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Project/documentation.html">Documentar un proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Project/compiler.html">Compilación</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Conceptos del lenguaje 4D<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/about.html">Acerca del lenguaje 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/quick-tour.html">Un recorrido rápido</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/operators.html">Operators</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/data-types.html">Tipos de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/boolean.html">Booleano</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/collection.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/date.html">Fecha</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/null-undefined.html">Null e indefinido</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/number.html">Número (Real, Entero largo, Entero)</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/object.html">Objeto</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/picture.html">Imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/pointer.html">Puntero</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/string.html">Cadena</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/time.html">Hora</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/variant.html">Variant</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/variables.html">Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/arrays.html">Arrays</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/methods.html">Métodos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/parameters.html">Parámetros</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/shared.html">Objetos y colecciones compartidos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/classes.html">Clases</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/control-flow.html">Condiciones y bucles</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/branching.html">Estructuras condicionales</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/looping.html">Estructuras repetitivas (bucles)</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Tags/tags.html">Etiquetas de transformación</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/error-handling.html">Gestión de errores</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/interpreted-compiled.html">Modos interpretado y compilado</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/components.html">Componentes</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/plug-ins.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Concepts/identifiers.html">Identificadores</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/overview.html">¿Qué es ORDA?</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/dsmapping.html">Objeto del modelo de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/ordaClasses.html">Clases del modelo de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/entities.html">Trabajar con los datos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/datastores.html">Utilizar un almacén de datos remoto</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/ORDA/glossary.html">Glosario</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Clases API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/overview.html">Generalidades - API de clases</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/BlobClass.html">Blob</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/ClassClass.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/CollectionClass.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/DataClassClass.html">DataClass</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/EntityClass.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/FunctionClass.html">Formula</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Rx/es/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/SessionClass.html">Sesión</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/SystemWorkerClass.html">SystemWorker</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Editor de código<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/code-editor/navigation.html">Navigation dropdown</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Depuración<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Debugging/basics.html">Básicos</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Debugging/debugger.html">Depurador</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Debugging/breakpoints.html">Breakpoints and Command Catching</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Debugging/debugging-remote.html">Debugging from remote machines</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Debugging/debugLogFiles.html">Description of log files</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Settings<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/general.html">General page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/interface.html">Interface page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/compiler.html">Compiler page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/database.html">Database page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/backup.html">Backup page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/client-server.html">Client-server page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/web.html">Web page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/sql.html">SQL page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/php.html">PHP page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/security.html">Security page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/settings/compatibility.html">Compatibility page</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Preferencias<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/general.html">Página general</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/structure.html">Structure Page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/forms.html">Página formulario</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/methods.html">Methods Page</a></li><li class="navListItem"><a class="navItem" href="/docs/Rx/es/Preferences/shortcuts.html">Shortcuts Page</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/Rx/docs/API/IMAPTransporterClass.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">IMAPTransporter</h1></header><article><div><span><p>The <code>IMAPTransporter</code> class allows you to retrieve messages from a IMAP email server.</p>
<h3><a class="anchor" aria-hidden="true" id="imap-transporter-object"></a><a href="#imap-transporter-object" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP Transporter object</h3>
<p>IMAP Transporter objects are instantiated with the <a href="#imap-new-transporter">IMAP New transporter</a> command. They provide the following properties and functions:</p>
<table>
<thead>
<tr><th></th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> si se permite a 4D establecer una conexión no cifrada</td></tr>
<tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><p>    añade banderas a los <code>msgIDs</code> para las <code>keywords</code></td></tr>
<tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><p>    añade el objeto <code>mailObj</code> a la caja <code>destinationBox</code></td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    el modo de autenticación utilizado para abrir la sesión en el servidor de correo</td></tr>
<tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a><p>     comprueba la conexión utilizando la información almacenada en el objeto transporter</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    duración máxima (en segundos) permitida antes de verificar la conexión al servidor</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor</td></tr>
<tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><p>    copia los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP</td></tr>
<tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><p>    crea un buzón con el <code>name</code> pasado</td></tr>
<tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>    asocia el marcador &quot;deleted&quot; a los mensajes designados por <code>msgsIDs</code> o <code>allMsgs</code></td></tr>
<tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><p>    permanently removes the mailbox with the given <code>name</code> from the IMAP server</td></tr>
<tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a><p>    removes all messages with the &quot;deleted&quot; flag from the IMAP mail server.</td></tr>
<tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><p>    returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em></td></tr>
<tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><p>    returns a collection of mailboxes describing all of the available mailboxes</td></tr>
<tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a><p>    returns the character used to delimit levels of hierarchy in the mailbox name</td></tr>
<tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><p>    returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><p>    returns an object containing a collection of <code>Email</code> objects</td></tr>
<tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><p>    returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    el nombre o la dirección IP del servidor local</td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    la ruta del archivo de registro extendido definido (si existe) para la conexión de correo</td></tr>
<tr><td><a href="#move"><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><p>    moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr>
<tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><p>    converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em></td></tr>
<tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><p>    removes flags from the <code>msgIDs</code> for the specified <code>keywords</code></td></tr>
<tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><p>    changes the name of a mailbox on the IMAP server</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     el número de puerto utilizado para las transacciones de correo</td></tr>
<tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><p>    searches for messages that match the given <em>searchCriteria</em> in the current mailbox</td></tr>
<tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>    selects the <em>name</em> mailbox as the current mailbox</td></tr>
<tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><p>    allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes</td></tr>
<tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><p>    removes a mailbox from a set of subscribed mailboxes</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     el nombre de usuario utilizado para la autenticación en el servidor de correo</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="imap-new-transporter"></a><a href="#imap-new-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP New transporter</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr>
<tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objeto IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción"></a><a href="#descripción" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>El comando <code>IMAP New transporter</code> configura una nueva conexión IMAP según el parámetro <em>server</em> y devuelve un nuevo objeto <em>transporter</em>. El objeto transportador devuelto se utilizará normalmente para recibir correos electrónicos.</p>
<p>En el parámetro <em>server</em>, pase un objeto que contenga las siguientes propiedades:</p>
<table>
<thead>
<tr><th><em>server</em></th><th>Valor por defecto (si se omite)</th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> si se permite a 4D establecer una conexión no cifrada</td><td>False</td></tr>
<tr><td>.<strong>accessTokenOAuth2</strong>: Text<br/>.<strong>accessTokenOAuth2</strong>: Object<p>Text string or token object representing OAuth2 authorization credentials. Used only with OAUTH2 <code>authenticationMode</code>. If <code>accessTokenOAuth2</code> is used but <code>authenticationMode</code> is omitted, the OAuth 2 protocol is used (if allowed by the server). Not returned in <em><a href="#imap-transporter-object">IMAP transporter</a></em> object.</td><td>ninguno</td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    el modo de autenticación utilizado para abrir la sesión en el servidor de correo</td><td>the most secure authentication mode supported by the server is used</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    duración máxima (en segundos) permitida antes de verificar la conexión al servidor</td><td>300</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor</td><td>30</td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    el nombre o la dirección IP del servidor local</td><td><em>obligatorio</em></td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    la ruta del archivo de registro extendido definido (si existe) para la conexión de correo</td><td>ninguno</td></tr>
<tr><td>.<strong>password</strong> : Text<p>Contraseña del usuario para la autenticación en el servidor. Not returned in <em><a href="#imap-transporter-object">IMAP transporter</a></em> object.</td><td>ninguno</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     el número de puerto utilizado para las transacciones de correo</td><td>993</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     el nombre de usuario utilizado para la autenticación en el servidor de correo</td><td>ninguno</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>Warning</strong>: Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado"></a><a href="#resultado" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>La función devuelve un <a href="#imap-transporter-object"><strong>IMAP transporter</strong></a>. Todas las propiedades devueltas son <strong>de sólo lectura</strong>.</p>
<blockquote>
<p>The IMAP connection is automatically closed when the transporter object is destroyed.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo"></a><a href="#ejemplo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object
<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
<span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>
<span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log to save in the Logs folder</span><span class="hljs-keyword">

var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">
If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="4dimaptransporternew"></a><a href="#4dimaptransporternew" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4D.IMAPTransporter.new()</h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr>
<tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objeto IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-1"></a><a href="#descripción-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>4D.IMAPTransporter.new()</code> crea y devuelve un nuevo objeto del tipo <code>4D.IMAPTransporter</code>. Es idéntico al comando <a href="#imap-new-transporter"><code>IMAP New transporter</code></a> (acceso directo).</p>
<h2><a class="anchor" aria-hidden="true" id="acceptunsecureconnection"></a><a href="#acceptunsecureconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.acceptUnsecureConnection</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-2"></a><a href="#descripción-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.acceptUnsecureConnection</code> contiene <strong>True</strong> si se permite a 4D establecer una conexión no cifrada cuando la conexión cifrada no es posible.</p>
<p>It contains <strong>False</strong> if unencrypted connections are unallowed, in which case an error in returned when encrypted connection is not possible.</p>
<p>Available secured ports are:</p>
<ul>
<li><p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 or 25: SMTP with STARTTLS upgrade if supported by the server.</li>
</ul></li>
<li><p>IMAP</p>
<ul>
<li>143: IMAP non-encrypted port</li>
<li>993: IMAP with STARTTLS upgrade if supported by the server</li>
</ul></li>
<li><p>POP3</p>
<ul>
<li>110: POP3 non-encrypted port</li>
<li>995: POP3 con actualización STARTTLS si lo soporta el servidor.</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="addflags"></a><a href="#addflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.addFlags()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr>
<tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a añadir</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación addFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-3"></a><a href="#descripción-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.addFlags()</code> añade banderas a los <code>msgIDs</code> para las <code>keywords</code>.</p>
<p>En el parámetro <code>msgIDs</code>, puede pasar:</p>
<ul>
<li><p>una <em>collection</em> contiene los identificadores únicos de mensajes específicos, o</p></li>
<li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li>
<li><p>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr>
</tbody>
</table>
</li>
</ul>
<p>El parámetro <code>keywords</code> le permite pasar un objeto con valores de palabras clave para las banderas específicas que se añadirán a <code>msgIDs</code>. Puede pasar cualquiera de las siguientes palabras claves:</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booleano</td><td>True to add the &quot;draft&quot; flag to the message</td></tr>
<tr><td>$seen</td><td>Booleano</td><td>True to add the &quot;seen&quot; flag to the message</td></tr>
<tr><td>$flagged</td><td>Booleano</td><td>True to add the &quot;flagged&quot; flag to the message</td></tr>
<tr><td>$answered</td><td>Booleano</td><td>True to add the &quot;answered&quot; flag to the message</td></tr>
<tr><td>$deleted</td><td>Booleano</td><td>True to add the &quot;deleted&quot; flag to the message</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Los valores falsos se ignoran.</li>
<li>The interpretation of keyword flags may vary per mail client.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1"></a><a href="#ejemplo-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Create transporter</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Select mailbox</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Mark all messages from INBOX as read/seen</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="append"></a><a href="#append" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.append()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>mailObj</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto Email</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir el objeto Email</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto que contiene información del charset</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Status of the append operation</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-4"></a><a href="#descripción-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.append()</code> añade el objeto <code>mailObj</code> a la caja <code>destinationBox</code>.</p>
<p>En el parámetro <code>mailObj</code>, pase un objeto Email. For a comprehensive description of mail properties, see <a href="/docs/Rx/es/API/EmailObjectClass.html#email-object">Email object</a>. La función <code>.append()</code> soporta los marcadores de palabras clave en el atributo <code>keywords</code> de los objetos email.</p>
<p>El parámetro opcional <code>destinationBox</code> permite pasar el nombre del buzón donde se añadirá el objeto <code>mailObj</code>. Si se omite, se utiliza el buzón actual.</p>
<p>En el parámetro opcional <code>options</code>, puede pasar un objeto para definir el charset y la codificación para partes específicas del correo electrónico. Propiedades disponibles:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>headerCharset</td><td>Texto</td><td>Charset and encoding used for the following parts of the email: subject, attachment filenames, and email name attribute(s). Possible values: See possible charsets table below</td></tr>
<tr><td>bodyCharset</td><td>Texto</td><td>Charset and encoding used for the html and text body contents of the email. Possible values: See possible charsets table below</td></tr>
</tbody>
</table>
<p>Charsets posibles:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; Quoted-printable if possible, otherwise UTF-8 &amp; Quoted-printable</li><li>bodyCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp; Quoted-printable</li></ul></td></tr>
<tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr>
<tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: US-ASCII if possible, otherwise UTF-8 &amp; Quoted-printable (<strong>default value</strong>)</td></tr>
<tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: US-ASCII if possible, otherwise UTF-8 &amp; base64</td></tr>
</tbody>
</table>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2"></a><a href="#ejemplo-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para guardar un correo electrónico en el buzón de borradores:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object

<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)

<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)

<span class="hljs-variable">$msg</span>:=New object
<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span>
<span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span>
<span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span>
<span class="hljs-variable">$msg</span>.keywords:=New object
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//flag the message as read</span>
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//flag the message as a draft</span>

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="authenticationmode"></a><a href="#authenticationmode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.authenticationMode</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.authenticationMode</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-5"></a><a href="#descripción-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.authenticationMode</code> contiene el modo de autenticación utilizado para abrir la sesión en el servidor de correo.</p>
<p>By default, the most secured mode supported by the server is used.</p>
<p>Los valores posibles son:</p>
<table>
<thead>
<tr><th>Valor</th><th>Constantes</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentication using CRAM-MD5 protocol</td></tr>
<tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentication using LOGIN protocol</td></tr>
<tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentication using OAuth2 protocol</td></tr>
<tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentication using PLAIN protocol</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnection"></a><a href="#checkconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnection()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnection()</strong> : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la conexión del objeto transportador</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-6"></a><a href="#descripción-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.checkConnection()</code>  comprueba la conexión utilizando la información almacenada en el objeto transporter, recrea la conexión si es necesario y devuelve el estado. Esta función permite verificar que los valores proporcionados por el usuario son válidos y coherentes.</p>
<h4><a class="anchor" aria-hidden="true" id="objeto-devuelto"></a><a href="#objeto-devuelto" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objeto devuelto</h4>
<p>La función envía una solicitud al servidor de correo y devuelve un objeto que describe el estado del correo. Este objeto puede contener las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>booleano</td><td>True if the check is successful, False otherwise</td></tr>
<tr><td>status</td><td></td><td>number</td><td>(SMTP only) Status code returned by the mail server (0 in case of an issue unrelated to the mail processing)</td></tr>
<tr><td>statusText</td><td></td><td>texto</td><td>Status message returned by the mail server, or last error returned in the 4D error stack</td></tr>
<tr><td>errors</td><td></td><td>colección</td><td>4D error stack (not returned if a mail server response is received)</td></tr>
<tr><td></td><td>[ ].errCode</td><td>number</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[ ].message</td><td>texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[ ].componentSignature</td><td>texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnectiondelay"></a><a href="#checkconnectiondelay" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnectionDelay</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-7"></a><a href="#descripción-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.checkConnectionDelay</code> contiene la duración máxima (en segundos) permitida antes de verificar la conexión al servidor.  Si se supera este tiempo entre dos llamadas al método, se comprobará la conexión con el servidor. Por defecto, si la propiedad no se ha definido en el objeto <em>server&lt;</em>, el valor es de 300.</p>
<blockquote>
<p><strong>Warning</strong>: Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="connectiontimeout"></a><a href="#connectiontimeout" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.connectionTimeOut</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-8"></a><a href="#descripción-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.connectionTimeOut</code> contiene el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor. By default, if the property has not been set in the server object (used to create the transporter object with <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, or <code>IMAP New transporter</code>), the value is 30.</p>
<h2><a class="anchor" aria-hidden="true" id="copy"></a><a href="#copy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.copy()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir mensajes copiados</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de copia</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-9"></a><a href="#descripción-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.copy()</code> copia los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección contiene los IDs únicos de los mensajes específicos a copiar, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para copiar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>El parámetro <em>destinationBox</em> permite pasar un valor texto con el nombre del buzón donde se colocarán las copias de los mensajes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-1"></a><a href="#ejemplo-1-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para copiar una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//get collection of message unique IDs</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// copy found messages to the "documents" mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-1"></a><a href="#ejemplo-2-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para copiar todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>

 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// copy all messages to the "documents" mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="createbox"></a><a href="#createbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.createBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de creación del buzón</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-10"></a><a href="#descripción-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.createBox()</code> crea un buzón con el <code>name</code> pasado. Si el carácter separador de jerarquía del servidor IMAP aparece en otra parte del nombre del buzón, el servidor IMAP creará todos los nombre padre necesarios para crear el buzón dado.</p>
<p>En otras palabras, un intento de crear &quot;Projects/IMAP/Doc&quot; en un servidor en el que &quot;/&quot; es el carácter separador de jerarquía creará:</p>
<ul>
<li>Sólo el buzón &quot;Doc&quot; si &quot;Projects&quot; &amp; &quot;IMAP&quot; ya existen.</li>
<li>Los buzones &quot;IMAP&quot; &amp; &quot;Doc&quot; si sólo existe &quot;Projects&quot;.</li>
<li>Los buzones &quot;Projects&quot; &amp; &quot;IMAP&quot; &amp; &quot;Doc&quot;, si no existen.</li>
</ul>
<p>En el parámetro <code>name</code>, pasa el nombre del nuevo buzón.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-3"></a><a href="#ejemplo-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para crear un nuevo buzón &quot;Invoices&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">
If</span>(OK=<span class="hljs-number">1</span>)
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">
Else</span>
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="delete"></a><a href="#delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.delete()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de eliminación</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-11"></a><a href="#descripción-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.delete()</code> asocia el marcador &quot;deleted&quot; a los mensajes designados por <code>msgsIDs</code> o <code>allMsgs</code>.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <code>msgsIDs</code>, una colección contiene los IDs únicos de los mensajes específicos a eliminar, o</li>
<li>en el parámetro <code>allMsgs</code>, la constante <code>IMAP all</code> (entero) para eliminar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>La ejecución de esta función no elimina realmente los mensajes. Los mensajes con la bandera &quot;delete&quot; pueden seguir siendo encontrados por la función <a href="#searchmails">.searchMails()</a>. Los mensajes marcados se eliminan del servidor IMAP con la función <a href="#expunge"><code>.expunge()</code></a> o al seleccionar otro buzón o cuando se destruye el objeto <a href="#imap-transporter-object">transporter</a> (creado con <a href="#imap-new-transporter">IMAP New transporter</a>).</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-2"></a><a href="#ejemplo-1-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para eliminar una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//get collection of message unique IDs</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)

  <span class="hljs-comment">// Delete selected messages</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-2"></a><a href="#ejemplo-2-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para eliminar todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)

  <span class="hljs-comment">// delete all messages in the current mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="deletebox"></a><a href="#deletebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.deleteBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón a eliminar</td></tr>
</tbody>
</table>
<p>|Result|Object|&lt;-|Status of the mailbox deletion operation|</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-12"></a><a href="#descripción-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.deleteBox()</code> function permanently removes the mailbox with the given <code>name</code> from the IMAP server. Attempting to delete an INBOX or a mailbox that does not exist will generate an error.</p>
<p>In the <code>name</code> parameter, pass the name of the mailbox to delete.</p>
<blockquote>
<ul>
<li>The function cannot delete a mailbox that has child mailboxes if the parent mailbox has the &quot;\Noselect&quot; attribute.</li>
<li>All messages in the deleted mailbox will also be deleted.</li>
<li>The ability to delete a mailbox depends on the mail server.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-4"></a><a href="#ejemplo-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>To delete the &quot;Nova Orion Industries&quot; child mailbox from the &quot;Bills&quot; mailbox hierarchy:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// delete mailbox</span>
<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">
    Else</span>
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="expunge"></a><a href="#expunge" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.expunge()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.expunge()</strong> : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación expunge</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-13"></a><a href="#descripción-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.expunge()</code> function removes all messages with the &quot;deleted&quot; flag from the IMAP mail server. The &quot;deleted&quot; flag can be set with the <a href="#delete"><code>.delete()</code></a> or <a href="#addflags"><code>.addFlags()</code></a> methods.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-5"></a><a href="#ejemplo-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$ids </span>: Collection

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Create transporter</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Select mailbox</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Find and delete all seen messages in INBOX</span>
<span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)

<span class="hljs-comment">// Purge all messages flagged as deleted</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxinfo"></a><a href="#getboxinfo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxInfo()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td><em>name</em> is optional</td></tr>
</tbody>
</table>
<p>|v18 R4|Added| </details></p>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-14"></a><a href="#descripción-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getBoxInfo()</code> function returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em>. This function returns the same information as <a href="#selectbox"><code>.selectBox()</code></a> without changing the current mailbox.</p>
<p>In the optional <em>name</em> parameter, pass the name of the mailbox to access. The name represents an unambiguous left-to-right hierarchy with levels separated by a specific delimiter character. The delimiter can be found with the <a href="#getdelimiter"><code>.getDelimiter()</code></a> function.</p>
<p>If the mailbox <em>name</em> is not selectable or does not exist, the function generates an error and returns <strong>null</strong>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>texto</td><td>Nombre del buzón</td></tr>
<tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Número de mensajes con el marcador &quot;reciente&quot; (que indica los mensajes nuevos)</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-6"></a><a href="#ejemplo-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)
<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxlist"></a><a href="#getboxlist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxList()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
<tr><td>v19</td><td>Add <code>isSubscribed</code> parameter</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>parameters</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Parameter object</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de objetos mailbox</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-15"></a><a href="#descripción-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getBoxList()</code> function returns a collection of mailboxes describing all of the available mailboxes. This function allows you to locally manage the list of messages located on the IMAP mail server.</p>
<p>In the optional <code>parameters</code> parameter, pass an object containing values to filter the returned mailboxes. Puede pasar:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>isSubscribed</td><td>Booleano</td><td><li><strong>True</strong> para devolver sólo los buzones suscritos</li><li> <strong>False</strong> para devolver todos los buzones disponibles</li></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="resultado-1"></a><a href="#resultado-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>Each object of the returned collection contains the following properties:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>[].name</td><td>texto</td><td>Nombre del buzón</td></tr>
<tr><td>[].selectable</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no seleccionar el buzón: <ul><li>true - el buzón puede ser seleccionado</li><li>false - el buzón no puede ser seleccionado</li></ul></td></tr>
<tr><td>[].inferior</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no crear una jerarquía inferior en el buzón: <ul><li>true - se puede crear un nivel inferior</li><li>false - no se puede crear un nivel inferior</li></ul></td></tr>
<tr><td>[].interesting</td><td>booleano</td><td>Indica si el buzón ha sido marcado como &quot;interesante&quot; por el servidor: <ul><li>true - El buzón ha sido marcado como &quot;interesante&quot; por el servidor. Por ejemplo, puede contener mensajes nuevos.</li><li>false - El buzón no ha sido marcado como &quot;interesante&quot; por el servidor.</li></ul></td></tr>
</tbody>
</table>
<p>If the account does not contain any mailboxes, an empty collection is returned.</p>
<blockquote>
<ul>
<li>If there is no open connection, <code>.getBoxList()</code> will open a connection.</li>
<li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <code>.checkConnection( )</code> function is automatically called.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-7"></a><a href="#ejemplo-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getdelimiter"></a><a href="#getdelimiter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getDelimiter()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getDelimiter()</strong> : Text</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Texto</td><td style="text-align:center">&lt;-</td><td>Hierarchy delimiter character</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-16"></a><a href="#descripción-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getDelimiter()</code> function returns the character used to delimit levels of hierarchy in the mailbox name.</p>
<p>The delimiter is a character which can be used to:</p>
<ul>
<li>crear buzones de nivel inferior</li>
<li>buscar más arriba o más abajo en la jerarquía del buzón</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="resultado-2"></a><a href="#resultado-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>Mailbox name delimiter character.</p>
<blockquote>
<ul>
<li>If there is no open connection, <code>.getDelimiter()</code> will open a connection.</li>
<li>If the connection has not been used since the <a href="#checkconnectiondelay">designated connection delay</a>, the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-8"></a><a href="#ejemplo-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmail"></a><a href="#getmail" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMail()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the message</td></tr>
<tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Message handling instructions</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td><a href="/docs/Rx/es/API/EmailObjectClass.html#email-object">Objeto Email</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-17"></a><a href="#descripción-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getMail()</code> function returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>. Esta función le permite manejar localmente el contenido del correo electrónico.</p>
<p>In the first parameter, you can pass either:</p>
<ul>
<li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li>
<li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li>
</ul>
<p>The optional <em>options</em> parameter allows you pass an object defining additional instructions for handling the message. Las siguientes propiedades están disponibles:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>booleano</td><td>Si True, el mensaje se marca como &quot;visto&quot; en el buzón. Si es False, el mensaje no se marca como &quot;visto&quot;. Valor por defecto: True</td></tr>
<tr><td>withBody</td><td>booleano</td><td>Pase True para devolver el cuerpo del mensaje. Si es False, sólo se devuelve el encabezado del mensaje. Valor por defecto: True</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>The function generates an error and returns <strong>Null</strong> if <em>msgID</em> designates a non-existing message,</li>
<li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> function, an error is generated,</li>
<li>If there is no open connection, <code>.getMail()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>`.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-3"></a><a href="#resultado-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMail()</code> returns an <a href="/docs/Rx/es/API/EmailObjectClass.html#email-object"><code>Email</code> object</a> with the following specific IMAP properties: <em>id</em>, <em>receivedAt</em>, and <em>size</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-9"></a><a href="#ejemplo-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>You want to get the message with ID = 1:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//create transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//get Email object with ID 1</span>
 <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmails"></a><a href="#getmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMails()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of message ID</td></tr>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the first message</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the last message</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Message handling instructions</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Object containing:<br><ul><li>a collection of <a href="/docs/Rx/es/API/EmailObjectClass.html#email-object">Email objects</a> and</li><li>a collection of IDs or numbers for missing messages, if any</li></ul></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-18"></a><a href="#descripción-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getMails()</code> function returns an object containing a collection of <code>Email</code> objects.</p>
<p><strong>Primera sintaxis:</strong></p>
<p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p>
<p>The first syntax allows you to retrieve messages based on their IDs.</p>
<p>In the <em>ids</em> parameter, pass a collection of IDs for the messages to return. You can get the IDs with <a href="#getmail"><code>.getMail()</code></a>.</p>
<p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned. See the <strong>Options</strong> table below for a description of the available properties.</p>
<p><strong>Segunda sintaxis:</strong></p>
<p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p>
<p>The second syntax allows you to retrieve messages based on a sequential range. The values passed represent the position of the messages in the mailbox.</p>
<p>In the <em>startMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p>
<p>In the <em>endMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p>
<p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned.</p>
<p><strong>Opciones</strong></p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>Booleano</td><td>Si True, los mensajes especificados se marcan como &quot;vistos&quot; en el buzón. Si False, los mensajes no se marcan como &quot;vistos&quot;. Valor por defecto: True</td></tr>
<tr><td>withBody</td><td>Booleano</td><td>Pase True para devolver el cuerpo de los mensajes específicos. Si False, sólo se devuelve los encabezados de los mensajes. Valor por defecto: True</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated.</li>
<li>If there is no open connection, <code>.getMails()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-4"></a><a href="#resultado-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMails()</code> returns an object containing the following collections:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>lista</td><td>Collection</td><td>Colección de objetos <a href="/docs/Rx/es/API/EmailObjectClass.html#email-object"><code>Email</code></a>. Si no se encuentran objetos Email, se devuelve una colección vacía.</td></tr>
<tr><td>notFound</td><td>Collection</td><td>Collection of:<br><ul><li>first syntax - previously passed message IDs that do not exist</li><li>second syntax - sequence numbers of messages between startMsg and endMsg that do not exist</li></ul>An empty collection is returned if all messages are found.</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-10"></a><a href="#ejemplo-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>You want to retrieve the 20 most recent emails without changing their &quot;seen&quot; status:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//create transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">

  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)
        <span class="hljs-comment">// retrieve the headers of the last 20 messages without marking them as read</span>
    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\
<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">
    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)
        <span class="hljs-comment">// ...</span><span class="hljs-keyword">
    End for each</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmimeasblob"></a><a href="#getmimeasblob" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMIMEAsBlob()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the message</td></tr>
<tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr>
<tr><td>updateSeen</td><td>Booleano</td><td style="text-align:center">-&gt;</td><td>If True, the message is marked &quot;seen&quot; in the mailbox. If False the message is left untouched.</td></tr>
<tr><td>Resultado</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob de la cadena MIME devuelta por el servidor de correo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-19"></a><a href="#descripción-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.getMIMEAsBlob()</code> function returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>.</p>
<p>In the first parameter, you can pass either:</p>
<ul>
<li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li>
<li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li>
</ul>
<p>The optional <em>updateSeen</em> parameter allows you to specify if the message is marked as &quot;seen&quot; in the mailbox. Puede pasar:</p>
<ul>
<li><strong>True</strong> - para marcar el mensaje como &quot;visto&quot; (indicando que el mensaje ha sido leído)</li>
<li><strong>False</strong> - para dejar intacto el estado &quot;visto&quot; del mensaje</li>
</ul>
<blockquote>
<ul>
<li>The function returns an empty BLOB if <em>msgNumber</em> or msgID* designates a non-existing message,</li>
<li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated,</li>
<li>If there is no open connection, <code>.getMIMEAsBlob()</code> will open a connection the last mailbox specified with <code>.selectBox()</code>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-5"></a><a href="#resultado-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMIMEAsBlob()</code> devuelve un <code>BLOB</code> que puede almacenarse en una base de datos o convertirse en un objeto <a href="/docs/Rx/es/API/EmailObjectClass.html#email-object"><code>Email</code></a> con el comando <code>MAIL Convert from MIME</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-11"></a><a href="#ejemplo-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//create transporter</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//get BLOB</span>
 <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="host"></a><a href="#host" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.host</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.host</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-20"></a><a href="#descripción-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.host</code> contiene el nombre o la dirección IP del servidor local. Used for mail transactions (SMTP, POP3, IMAP).</p>
<h2><a class="anchor" aria-hidden="true" id="logfile"></a><a href="#logfile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.logFile</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.logFile</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-21"></a><a href="#descripción-21" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.logFile</code> contiene la ruta del archivo de registro extendido definido (si existe) para la conexión de correo. It can be relative (to the current Logs folder) or absolute.</p>
<p>Unlike regular log files (enabled via the <code>SET DATABASE PARAMETER</code> command), extended log files store MIME contents of all sent mails and do not have any size limit. For more information about extended log files, refer to:</p>
<ul>
<li><strong>SMTP connections</strong> - <a href="Admin/debugLogFiles.md#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li>
<li><strong>POP3 connections</strong> - <a href="Admin/debugLogFiles.md#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li>
<li><strong>IMAP connections</strong> - <a href="Admin/debugLogFiles.md#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="move"></a><a href="#move" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.move()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Mailbox to receive moved messages</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Status of the move operation</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-22"></a><a href="#descripción-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.move()</code> function moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección contiene los IDs únicos de los mensajes específicos a mover, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para mover todos los mensajes del buzón seleccionado.</li>
</ul>
<p>The <em>destinationBox</em> parameter allows you to pass a text value with the name of the mailbox where the messages will be moved.</p>
<blockquote>
<p>This function is only supported by IMAP servers compliant with RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-3"></a><a href="#ejemplo-1-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para mover una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//get collection of message unique IDs</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// Move found messages from the current mailbox to the "documents" mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-3"></a><a href="#ejemplo-2-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para mover todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// move all messages in the current mailbox to the "documents" mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="numtoid"></a><a href="#numtoid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.numToID()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the first message</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Sequence number of the last message</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection of unique IDs</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-23"></a><a href="#descripción-23" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.numToID()</code> function converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em> in the currently selected mailbox.</p>
<p>In the <em>startMsg</em> parameter, pass an integer value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p>
<p>In the <em>endMsg</em> parameter, pass an integer value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p>
<h4><a class="anchor" aria-hidden="true" id="resultado-6"></a><a href="#resultado-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>The function returns a collection of strings (unique IDs).</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-12"></a><a href="#ejemplo-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//select mailbox</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//get IDs for 5 last messages received</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)

  <span class="hljs-comment">//delete the messages from the current mailbox</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="removeflags"></a><a href="#removeflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.removeFlags()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr>
<tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a eliminar</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación removeFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-24"></a><a href="#descripción-24" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.removeFlags()</code> function removes flags from the <code>msgIDs</code> for the specified <code>keywords</code>.</p>
<p>En el parámetro <code>msgIDs</code>, puede pasar:</p>
<ul>
<li><p>una <em>collection</em> contiene los identificadores únicos de mensajes específicos, o</p></li>
<li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li>
<li><p>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr>
</tbody>
</table>
</li>
</ul>
<p>The <code>keywords</code> parameter lets you pass an object with keyword values for specific flags to remove from <code>msgIDs</code>. Puede pasar cualquiera de las siguientes palabras claves:</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booleano</td><td>True para eliminar el marcador &quot;draft&quot; del mensaje</td></tr>
<tr><td>$seen</td><td>Booleano</td><td>True para eliminar el marcador &quot;seen&quot; del mensaje</td></tr>
<tr><td>$flagged</td><td>Booleano</td><td>True para eliminar el marcador &quot;flagged&quot; del mensaje</td></tr>
<tr><td>$answered</td><td>Booleano</td><td>True para eliminar el marcador &quot;answered&quot; del mensaje</td></tr>
<tr><td>$deleted</td><td>Booleano</td><td>True para eliminar el marcador &quot;deleted&quot; del mensaje</td></tr>
</tbody>
</table>
<p>Note que los valores falsos se ignoran.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-13"></a><a href="#ejemplo-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Create transporter</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Select mailbox</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Mark all messages from INBOX as unseen</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="renamebox"></a><a href="#renamebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.renameBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>currentName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo actual</td></tr>
<tr><td>newName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nuevo nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación renombrar</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-25"></a><a href="#descripción-25" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.renameBox()</code> function changes the name of a mailbox on the IMAP server. Attempting to rename a mailbox from a mailbox name that does not exist or to a mailbox name that already exists will generate an error.</p>
<p>In the <code>currentName</code> parameter, pass the name of the mailbox to be renamed.</p>
<p>Pass the new name for the mailbox in the <code>newName</code> parameter.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-14"></a><a href="#ejemplo-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para cambiar el nombre de su buzón de &quot;Invoices&quot; a &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// rename mailbox</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
 End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="port"></a><a href="#port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.port</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.port</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-26"></a><a href="#descripción-26" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.port</code> contiene  el número de puerto utilizado para las transacciones de correo. By default, if the <em>port</em> property has not been set in the <em>server</em> object (used to create the transporter object with <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), the port used is:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="searchmails"></a><a href="#searchmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.searchMails()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>searchCriteria</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Criterio de búsqueda</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection of message numbers</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-27"></a><a href="#descripción-27" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<blockquote>
<p>This function is based upon the specification for the <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">IMAP protocol</a>.</p>
</blockquote>
<p>The <code>.searchMails()</code> function searches for messages that match the given <em>searchCriteria</em> in the current mailbox. <em>searchCriteria</em> consists of one or more search keys.</p>
<p><em>searchCriteria</em> is a text parameter listing one or more search keys (see <a href="#authorized-search-keys">Authorized search-keys</a> below) associated or not with values to look for. A search key may be a single or multiple items. Por ejemplo:</p>
<pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED
<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED
<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT
</code></pre>
<blockquote>
<p>Matching is usually not case-sensitive</p>
</blockquote>
<ul>
<li>If the <em>searchCriteria</em> is a null string, the search will be equivalent to a “select all”.</li>
<li>If the <em>searchCriteria</em> includes multiple search keys, the result is the intersection (AND function) of all the messages that match those keys.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span>
</code></pre>
<p>... returns all messages with \Flagged flag set AND sent by Smith.</p>
<ul>
<li>You can use the <strong>OR</strong> or <strong>NOT</strong> operators as follows:</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED
</code></pre>
<p>... returns all messages with \Seen flag set OR \Flagged flag set</p>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN
</code></pre>
<p>... returns all messages with \Seen flag not set.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span>
</code></pre>
<p>... returns message whose content-type header contains “Mixed” and does not contain “Text”.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"
</code></pre>
<p>... returns message whose content-type header contains “ e ” and whose Subject header does not contain “ o ” and whose content-type header is not “ Mixed ”.</p>
<p>As concerns the last two examples, notice that the result of the search is different when you remove the parentheses of the first search key list.</p>
<ul>
<li>The <em>searchCriteria</em> may include the optional [CHARSET] specification. This consists of the &quot;CHARSET&quot; word followed by a registered [CHARSET] (US ASCII, ISO-8859). It indicates the charset of the <em>searchCriteria</em> string. Therefore, you must convert the <em>searchCriteria</em> string into the specified charset if you use the [CHARSET] specification (see the <code>CONVERT FROM TEXT</code> or <code>Convert to text</code> commands). By default, 4D encodes in Quotable Printable the searchCriteria string if it contains extended characters.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span>
</code></pre>
<p>... means the search criteria uses the charset iso-8859 and the server will have to convert the search criteria before searching, if necessary.</p>
<h4><a class="anchor" aria-hidden="true" id="search-value-types"></a><a href="#search-value-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Search value types</h4>
<p>Search-keys may request the value to search for:</p>
<ul>
<li><p><strong>Search-keys with a field-name value</strong>: the field-name is the name of a header field. Ejemplo: <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (una fecha no suele necesitar comillas, ya que no contiene caracteres especiales)</p></li>
<li><p><strong>Search-keys with a string value</strong>: the string may contain any character and must be quoted. If the string does not contain any special characters, like the space character for instance, it does not need to be quoted. Quoting such strings will ensure that your string value will be correctly interpreted. Ejemplo: <code>criterios de búsqueda = FROM &quot;SMITH&quot;</code> Para todas las llaves de búsqueda que utilizan cadenas, un mensaje coincide con la llave si la cadena es una subcadena del campo. Matching is not case-sensitive.</p></li>
<li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li>
<li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li>
<li><p><strong>Search-keys with a message set value</strong>: Identifies a set of messages. For message sequence numbers, these are consecutive numbers from 1 to the total number of messages in the mailbox. A comma delimits individual numbers; a colon delimits between two numbers inclusive. Ejemplos: <code>2,4:7,9,12:*</code> es <code>2,4,5,6,7,9,12,13,14,15</code> para un buzón con 15 mensajes. <code>searchCriteria = 1:5 ANSWERED</code> search in message selection from message sequence number 1 to 5 for messages which have the \Answered flag set. <code>searchCriteria= 2,4 ANSWERED</code> search in the message selection (message numbers 2 and 4) for messages which have the \Answered flag set.</p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="teclas-de-búsqueda-disponibles"></a><a href="#teclas-de-búsqueda-disponibles" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Teclas de búsqueda disponibles</h4>
<p><strong>ALL</strong>: All messages in the mailbox.<br>
<strong>ANSWERED</strong>: Messages with the \Answered flag set.<br>
<strong>UNANSWERED</strong>: Messages that do not have the \Answered flag set.<br>
<strong>DELETED</strong>: Messages with the \Deleted flag set.<br>
<strong>UNDELETED</strong>: Messages that do not have the \Deleted flag set.<br>
<strong>DRAFT</strong>: Messages with the \Draft flag set.<br>
<strong>UNDRAFT</strong>: Messages that do not have the \Draft flag set.<br>
<strong>FLAGGED</strong>: Messages with the \Flagged flag set.<br>
<strong>UNFLAGGED</strong>: Messages that do not have the \Flagged flag set.<br>
<strong>RECENT</strong>: Messages that have the \Recent flag set.<br>
<strong>OLD</strong>: Messages that do not have the \Recent flag set.<br>
<strong>SEEN</strong>: Messages that have the \Seen flag set.<br>
<strong>UNSEEN</strong>: Messages that do not have the \Seen flag set.<br>
<strong>NEW</strong>: Messages that have the \Recent flag set but not the \Seen flag. This is functionally equivalent to “(RECENT UNSEEN)”.<br>
***KEYWORD ***flag******: Messages with the specified keyword set.<br>
***UNKEYWORD ***flag******: Messages that do not have the specified keyword set.<br>
***BEFORE ***date******: Messages whose internal date is earlier than the specified date.<br>
***ON ***date******: Messages whose internal date is within the specified date.<br>
***SINCE ***date******: Messages whose internal date is within or later than the specified date.<br>
***SENTBEFORE ***date******: Messages whose Date header is earlier than the specified date.<br>
***SENTON ***date******: Messages whose Date header is within the specified date.<br>
***SENTSINCE ***date******: Messages whose Date header is within or later than the specified date.<br>
***TO ***string******: Messages that contain the specified string in the TO header.<br>
***FROM ***string******: Messages that contain the specified string in the FROM header.<br>
***CC ***string******: Messages that contain the specified string in the CC header.<br>
***BCC ***string******: Messages that contain the specified string in the BCC header.<br>
***SUBJECT ***string******: Messages that contain the specified string in the Subject header.<br>
***BODY ***string******: Messages that contain the specified string in the message body.<br>
***TEXT ***string******: Messages that contain the specified string in the header or in the message body.<br>
***HEADER <em>field-name</em> ***string******: Messages that have a header with the specified field-name and that contain the specified string in the field-body.<br>
***UID ***message-UID******: Messages with unique identifiers corresponding to the specified unique identifier set.<br>
***LARGER ***n******: Messages with a size larger than the specified number of bytes.<br>
***SMALLER ***n******: Messages with a size smaller than the specified number of bytes.<br>
***NOT ***search-key******: Messages that do not match the specified search key.<br>
***OR <em>search-key1</em> ***search-key2******: Messages that match either search key.</p>
<h2><a class="anchor" aria-hidden="true" id="selectbox"></a><a href="#selectbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.selectBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>state</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Estado de acceso al buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-28"></a><a href="#descripción-28" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.selectBox()</code> function selects the <em>name</em> mailbox as the current mailbox. Esta función permite recuperar la información sobre el buzón.</p>
<blockquote>
<p>To get the information from a mailbox without changing the current mailbox, use <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>In the <em>name</em> parameter, pass the name of the mailbox to access. The name represents an unambiguous left-to-right hierarchy with levels separated by a specific delimiter character. The delimiter can be found with the <a href="#getdelimiter"><code>.getDelimiter()</code></a> function.</p>
<p>The optional <em>state</em> parameter defines the type of access to the mailbox. Los valores posibles son:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP read only state</td><td>1</td><td>The selected mailbox is accessed with read only privileges. Messages with a &quot;recent&quot; flag (indicating new messages) remain unchanged.</td></tr>
<tr><td>IMAP read write state</td><td>0</td><td>The selected mailbox is accessed with read and write privileges. Messages are considered &quot;seen&quot; and lose the &quot;recent&quot; flag (indicating new messages). (Valor por defecto)</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>The function generates an error and returns <strong>Null</strong> if <em>name</em> designates a non-existing mailbox.</li>
<li>If there is no open connection, <code>.selectBox()</code> will open a connection.</li>
<li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td>Nombre del buzón</td></tr>
<tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Número de mensajes con la bandera &quot;recent&quot;</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-15"></a><a href="#ejemplo-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object
 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword">

 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="subscribe"></a><a href="#subscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.subscribe()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación subscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-29"></a><a href="#descripción-29" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.subscribe()</code> function allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes. As such, you can choose to narrow down a large list of available mailboxes by subscribing to those you usually want to see.</p>
<p>In the <code>name</code> parameter, pass the name of the mailbox to add (subscribe) to your &quot;subscribed&quot; mailboxes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-16"></a><a href="#ejemplo-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para suscribirse al buzón &quot;Atlas Corp&quot; en la jerarquía &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="unsubscribe"></a><a href="#unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.unsubscribe()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación unsubscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-30"></a><a href="#descripción-30" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.unsubscribe()</code> function removes a mailbox from a set of subscribed mailboxes. This allows you reduce the number of mailboxes you usually see.</p>
<p>In the <code>name</code> parameter, pass the name of the mailbox to remove (unsubscribe) from your active mailboxes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Description of the 4D error</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-17"></a><a href="#ejemplo-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para desuscribirse del buzón &quot;Atlas Corp&quot; en la jerarquía &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="user"></a><a href="#user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.user</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.user</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-31"></a><a href="#descripción-31" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.user</code> contiene  el nombre de usuario utilizado para la autenticación en el servidor de correo.</p>
<style> h2 { background: #d9ebff;}</style>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/Rx/es/API/FunctionClass.html"><span class="arrow-prev">← </span><span>Formula</span></a><a class="docs-next button" href="/docs/Rx/es/API/MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#imap-new-transporter">IMAP New transporter</a></li><li><a href="#4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#addflags">.addFlags()</a></li><li><a href="#append">.append()</a></li><li><a href="#authenticationmode">.authenticationMode</a></li><li><a href="#checkconnection">.checkConnection()</a></li><li><a href="#checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#connectiontimeout">.connectionTimeOut</a></li><li><a href="#copy">.copy()</a></li><li><a href="#createbox">.createBox()</a></li><li><a href="#delete">.delete()</a></li><li><a href="#deletebox">.deleteBox()</a></li><li><a href="#expunge">.expunge()</a></li><li><a href="#getboxinfo">.getBoxInfo()</a></li><li><a href="#getboxlist">.getBoxList()</a></li><li><a href="#getdelimiter">.getDelimiter()</a></li><li><a href="#getmail">.getMail()</a></li><li><a href="#getmails">.getMails()</a></li><li><a href="#getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#host">.host</a></li><li><a href="#logfile">.logFile</a></li><li><a href="#move">.move()</a></li><li><a href="#numtoid">.numToID()</a></li><li><a href="#removeflags">.removeFlags()</a></li><li><a href="#renamebox">.renameBox()</a></li><li><a href="#port">.port</a></li><li><a href="#searchmails">.searchMails()</a></li><li><a href="#selectbox">.selectBox()</a></li><li><a href="#subscribe">.subscribe()</a></li><li><a href="#unsubscribe">.unsubscribe()</a></li><li><a href="#user">.user</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/Rx/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:es","version:19 R3"]}
              });
            </script></body></html>