<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-19 plugin-docs plugin-id-default docs-doc-id-API/EmailObjectClass">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Email | 4D Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://4d.github.io/docs/19/API/EmailObjectClass"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="19"><meta data-rh="true" name="docusaurus_tag" content="docs-default-19"><meta data-rh="true" name="docsearch:version" content="19"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-19"><meta data-rh="true" property="og:title" content="Email | 4D Docs"><meta data-rh="true" name="description" content="Creating, sending or receiving emails in 4D is done by handling an Email object."><meta data-rh="true" property="og:description" content="Creating, sending or receiving emails in 4D is done by handling an Email object."><link data-rh="true" rel="icon" href="/docs/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://4d.github.io/docs/19/API/EmailObjectClass"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/19/API/EmailObjectClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/fr/19/API/EmailObjectClass" hreflang="fr"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/es/19/API/EmailObjectClass" hreflang="es"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/ja/19/API/EmailObjectClass" hreflang="ja"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/pt/19/API/EmailObjectClass" hreflang="pt"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/19/API/EmailObjectClass" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJ04C0M3CU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.a14572c6.css">
<link rel="preload" href="/docs/assets/js/runtime~main.a8bcdca6.js" as="script">
<link rel="preload" href="/docs/assets/js/main.af747107.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/19/GettingStarted/installation">v19</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/API/EmailObjectClass">v20 R4 BETA</a></li><li><a class="dropdown__link" href="/docs/20-R3/API/EmailObjectClass">v20 R3</a></li><li><a class="dropdown__link" href="/docs/20/API/EmailObjectClass">v20</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/19/API/EmailObjectClass">v19</a></li><li><a class="dropdown__link" href="/docs/18/GettingStarted/installation">v18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/19/API/EmailObjectClass" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/docs/fr/19/API/EmailObjectClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/docs/es/19/API/EmailObjectClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs/ja/19/API/EmailObjectClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/docs/pt/19/API/EmailObjectClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/docs/"><img src="/docs/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>4D Documentation</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/GettingStarted/installation">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Project/overview">Project Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Concepts/about">4D Language Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/ORDA/overview">ORDA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/19/API/overview">Class API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/overview">Class functions and commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/ClassClass">Class</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/CollectionClass">Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/19/API/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/EntityClass">Entity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/FunctionClass">Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/POP3TransporterClass">POP3Transporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/SMTPTransporterClass">SMTPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/19/API/ZipFolderClass">ZIPFolder</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Preferences/overview">Preferences</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Admin/webAdmin">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Users/overview">Access Rights</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/MSC/overview">MSC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Backup/overview">Backup and Restore</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/WebServer/overview">Web Server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/WebServer/gettingStarted">Web Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/REST/gettingStarted">REST Server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Desktop/clientServer">Client/Server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/FormEditor/forms">Forms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/FormEditor/jsonReference">Form Properties</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/FormObjects/formObjectsOverview">Form Objects</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/FormObjects/propertiesReference">Form Object Properties</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Events/overview">Form Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Menus/overview">Menus</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/19/Desktop/building">Build application</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Class API Reference</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Email</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v19</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Email</h1></header><p>Creating, sending or receiving emails in 4D is done by handling an <code>Email</code> object.</p><p><code>Email</code> objects are created when receiving mails through a <em>transporter</em> class function:</p><ul><li>IMAP - <a href="/docs/19/API/IMAPTransporterClass#getmail"><code>.getMail()</code></a> and <a href="/docs/19/API/IMAPTransporterClass#getmails"><code>.getMails()</code></a> functions to get emails from an IMAP server</li><li>POP3 - <a href="/docs/19/API/POP3TransporterClass#getmail"><code>.getMail()</code></a> function to get an email from a POP3 server.</li></ul><blockquote><p>You can also create a new, blank <code>Email</code> object and then fill it with <a href="#email-object">Email object properties</a>.</p></blockquote><p>You send <code>Email</code> objects using the SMTP <a href="/docs/19/API/SMTPTransporterClass#send"><code>.send()</code></a> function.</p><p><a href="#mail-convert-from-mime"><code>MAIL Convert from MIME</code></a> and <a href="#mail-convert-to-mime"><code>MAIL Convert to MIME</code></a> commands can be used to convert <code>Email</code> objects to and from MIME contents.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="email-object">Email Object<a href="#email-object" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Email objects provide the following properties:</p><blockquote><p>4D follows the <a href="https://jmap.io/spec-mail.html" target="_blank" rel="noopener noreferrer">JMAP specification</a> to format the Email object.</p></blockquote><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#attachments"><strong>.attachments</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->collection of <code>4D.MailAttachment</code> object(s)</td></tr><tr><td><a href="#bcc"><strong>.bcc</strong> : Text<br><strong>.bcc</strong> : Object<br><strong>.bcc</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->Blind Carbon Copy (BCC) hidden email recipient <a href="#email-addresses">addresse(s)</a> of the email</td></tr><tr><td><a href="#bodystructure"><strong>.bodyStructure</strong> : Object</a> <!-- --> <!-- --> <!-- --> <em>EmailBodyPart</em> object, i.e. the full MIME structure of the message body (optional)</td></tr><tr><td><a href="#bodyvalues"><strong>.bodyValues</strong> : Object</a> <!-- --> <!-- --> <!-- --> <em>EmailBodyValue</em> object, containing an object for each \&lt;partID<!-- -->&gt;<!-- --> of <code>bodyStructure</code> (optional)</td></tr><tr><td><a href="#cc"><strong>.cc</strong> : Text<br><strong>.cc</strong> : Object<br><strong>.cc</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->Carbon Copy (CC) additional email recipient <a href="#email-addresses">addresse(s)</a> of the email</td></tr><tr><td><a href="#comments"><strong>.comments</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->additional comments header</td></tr><tr><td><a href="#from"><strong>.from</strong> : Text<br><strong>.from</strong> : Object<br><strong>.from</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->Originating <a href="#email-addresses">address(es)</a> of the email</td></tr><tr><td><a href="#headers"><strong>.headers</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->collection of <code>EmailHeader</code> objects, in the order they appear in the message</td></tr><tr><td><a href="#htmlbody"><strong>.htmlBody</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->HTML representation of the email message (default charset is UTF-8) (optional, SMTP only)</td></tr><tr><td><a href="#id"><strong>.id</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->unique ID from the IMAP server</td></tr><tr><td><a href="#inreplyto"><strong>.inReplyTo</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->message identifier(s) of the original message(s) to which the current message is a reply</td></tr><tr><td><a href="#keywords"><strong>.keywords</strong> : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->set of keywords as an object, where each property name is a keyword and each value is true</td></tr><tr><td><a href="#messageid"><strong>.messageId</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->message identifier header (&quot;message-id&quot;)</td></tr><tr><td><a href="#receivedat"><strong>.receivedAt</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->timestamp of the email&#x27;s arrival on the IMAP server in ISO 8601 UTC format (ex: 2020-09-13T16:11:53Z)</td></tr><tr><td><a href="#references"><strong>.references</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->Collection of all message-ids of messages in the preceding reply chain</td></tr><tr><td><a href="#replyto"><strong>.replyTo</strong> : Text<br><strong>.replyTo</strong> : Object<br><strong>.replyTo</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <a href="#email-addresses">addresse(s)</a> for responses</td></tr><tr><td><a href="#sendat"><strong>.sendAt</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->Email timestamp in ISO 8601 UTC format</td></tr><tr><td><a href="#sender"><strong>.sender</strong> : Text<br><strong>.sender</strong> : Object<br><strong>.sender</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->email source <a href="#email-addresses">addresse(s)</a> of the email</td></tr><tr><td><a href="#size"><strong>.size</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->size (expressed in bytes) of the Email object returned by the IMAP server</td></tr><tr><td><a href="#subject"><strong>.subject</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->description of topic</td></tr><tr><td><a href="#textbody"><strong>.textBody</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->Plain text representation of the email message (default charset is UTF-8) (optional, SMTP only)</td></tr><tr><td><a href="#to"><strong>.to</strong> : Text<br><strong>.to</strong> : Object<br><strong>.to</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->primary recipient <a href="#email-addresses">addresse(s)</a> of the email</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="email-addresses">Email Addresses<a href="#email-addresses" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>All properties that contain email addresses (<a href="#from"><code>from</code></a>, <a href="#cc"><code>cc</code></a>, <a href="#bcc"><code>bcc</code></a>, <a href="#to"><code>to</code></a>, <a href="#sender"><code>sender</code></a>, <a href="#replyto"><code>replyTo</code></a>) accept a value of text, object, or collection type.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="text">Text<a href="#text" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><ul><li>single email: &quot;<a href="mailto:somebody@domain.com" target="_blank" rel="noopener noreferrer">somebody@domain.com</a>&quot;</li><li>single display name+email: &quot;Somebody <a href="mailto:somebody@domain.com" target="_blank" rel="noopener noreferrer">somebody@domain.com</a>&quot;</li><li>several emails: &quot;Somebody <a href="mailto:somebody@domain.com" target="_blank" rel="noopener noreferrer">somebody@domain.com</a>,<a href="mailto:me@home.org" target="_blank" rel="noopener noreferrer">me@home.org</a>&quot;</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="object">Object<a href="#object" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>An object with two properties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Display name (can be null)</td></tr><tr><td>email</td><td>Text</td><td>Email address</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="collection">Collection<a href="#collection" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>A collection of address objects.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="handling-body-part">Handling body part<a href="#handling-body-part" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The <a href="#textbody"><code>textBody</code></a> and <a href="#htmlbody"><code>htmlBody</code></a> properties are only used with the <a href="/docs/19/API/SMTPTransporterClass#send">SMTP.send()</a> function to allow sending simple mails. When both property are filled, the MIME content-type multipart/alternative is used. The email client should then recognize the multipart/alternative part and display the text part or html part as necessary.</p><p><a href="#bodystructure"><code>bodyStructure</code></a> and <a href="#bodyvalues"><code>bodyValues</code></a> are used for <a href="/docs/19/API/SMTPTransporterClass">SMTP</a> when the <a href="/docs/19/API/email-object">Email object</a> is built from a MIME document, e.g. when generated by the <code>MAIL Convert from MIME</code> command. In this case, both <code>bodyStructure</code> and <code>bodyValues</code> properties must be passed together, and it is not recommended to use <code>textBody</code> and <code>htmlBody</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-of-bodystructure-and-bodyvalues-objects">Example of bodyStructure and bodyValues objects<a href="#example-of-bodystructure-and-bodyvalues-objects" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;bodyStructure&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;multipart/mixed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;subParts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;partId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;p0001&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text/plain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;partId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;p0002&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text/html&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property" style="color:#36acaa">&quot;bodyValues&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;p0001&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;I have the most brilliant plan. Let me tell you all about it.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;p0002&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;style type=\&quot;text/css\&quot;&gt;div{font-size:16px}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;I have the most brilliant plan. Let me tell you all about it.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="attachments">.attachments<a href="#attachments" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.attachments</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.attachments</code> property contains a collection of <code>4D.MailAttachment</code> object(s).</p><p>Attachment objects are defined through the <a href="/docs/19/API/MailAttachmentClass#mail-new-attachment"><code>MAIL New attachment</code></a> command. Attachment objects have specific <a href="/docs/19/API/MailAttachmentClass">properties and functions</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bcc">.bcc<a href="#bcc" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.bcc</strong> : Text<br><strong>.bcc</strong> : Object<br><strong>.bcc</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-1">Description<a href="#description-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.bcc</code> property contains the Blind Carbon Copy (BCC) hidden email recipient <a href="#email-addresses">addresse(s)</a> of the email.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bodystructure">.bodyStructure<a href="#bodystructure" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.bodyStructure</strong> : Object</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-2">Description<a href="#description-2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.bodyStructure</code> property contains the <em>EmailBodyPart</em> object, i.e. the full MIME structure of the message body (optional). See <a href="#handling-body-part">Handling body part</a> section.</p><p>The <code>.bodyStructure</code> object contains the following properties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Value</th></tr></thead><tbody><tr><td>partID</td><td>Text</td><td>Identifies the part uniquely within the email</td></tr><tr><td>type</td><td>Text</td><td>(mandatory) Value of the Content-Type header field of the part</td></tr><tr><td>charset</td><td>Text</td><td>Value of the charset parameter of the Content-Type header field</td></tr><tr><td>encoding</td><td>Text</td><td>If <code>isEncodingProblem=true</code>, the Content-Transfer-Encoding value is added (by default undefined)</td></tr><tr><td>disposition</td><td>Text</td><td>Value of the Content-Disposition header field of the part</td></tr><tr><td>language</td><td>Collection of texts</td><td>List of language tags, as defined in <a href="https://tools.ietf.org/html/rfc3282" target="_blank" rel="noopener noreferrer">RFC3282</a>, in the Content-Language header field of the part, if present.</td></tr><tr><td>location</td><td>Text</td><td>URI, as defined in <a href="https://tools.ietf.org/html/rfc2557" target="_blank" rel="noopener noreferrer">RFC2557</a>, in the Content-Location header field of the part, if present.</td></tr><tr><td>subParts</td><td>Collection of objects</td><td>Body parts of each child (collection of <em>EmailBodyPart</em> objects)</td></tr><tr><td>headers</td><td>Collection of objects</td><td>List of all header fields in the part, in the order they appear in the message (collection of <em>EmailHeader</em> objects, see <a href="#headers-">headers</a> property)</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bodyvalues">.bodyValues<a href="#bodyvalues" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.bodyValues</strong> : Object</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-3">Description<a href="#description-3" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.bodyValues</code> property contains the <em>EmailBodyValue</em> object, containing an object for each \&lt;partID<!-- -->&gt;<!-- --> of <code>bodyStructure</code> (optional). See <a href="#handling-body-part">Handling body part</a> section.</p><p>The <code>.bodyValues</code> object contains the following properties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Value</th></tr></thead><tbody><tr><td><em>partID</em>.value</td><td>text</td><td>Value of the body part</td></tr><tr><td><em>partID</em>.isEncodingProblem</td><td>boolean</td><td>True if malformed sections are found while decoding the charset, or unknown charset, or unknown content transfer-encoding. False by default</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cc">.cc<a href="#cc" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.cc</strong> : Text<br><strong>.cc</strong> : Object<br><strong>.cc</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-4">Description<a href="#description-4" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.cc</code> property contains the Carbon Copy (CC) additional email recipient <a href="#email-addresses">addresse(s)</a> of the email.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="comments">.comments<a href="#comments" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.comments</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-5">Description<a href="#description-5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.comments</code> property contains an additional comments header.</p><p>Comments only appear within the header section of the message (keeping the message&#x27;s body untouched).</p><p>For specific formatting requirements, please consult the <a href="https://tools.ietf.org/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC#5322</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="from">.from<a href="#from" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.from</strong> : Text<br><strong>.from</strong> : Object<br><strong>.from</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-6">Description<a href="#description-6" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.from</code> property contains the Originating <a href="#email-addresses">address(es)</a> of the email.</p><p>Each email you send out has both the <a href="#sender">sender</a> and <strong>from</strong> addresses:</p><ul><li>the sender domain is what the receiving email server gets when opening the session,</li><li>the from address is what the recipient(s) will see.</li></ul><p>For better deliverability, it is recommended to use the same from and sender addresses.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="headers">.headers<a href="#headers" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.headers</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-7">Description<a href="#description-7" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.headers</code> property contains a collection of <code>EmailHeader</code> objects, in the order they appear in the message. This property allows users to add extended (registered) headers or user-defined (not registered, starting with &quot;X&quot;) headers.</p><blockquote><p>If an <code>EmailHeader</code> object property defines a header such as &quot;from&quot; or &quot;cc&quot; which is already set as a property at the mail level, the <code>EmailHeader</code> property is ignored.</p></blockquote><p>Every object of the headers collection can contain the following properties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Value</th></tr></thead><tbody><tr><td>[].name</td><td>text</td><td>(mandatory) Header field name as defined in <a href="https://tools.ietf.org/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC#5322</a>. If null or undefined, the header field is not added to the MIME header.</td></tr><tr><td>[].value</td><td>text</td><td>Header field values as defined in <a href="https://tools.ietf.org/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC#5322</a></td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="htmlbody">.htmlBody<a href="#htmlbody" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.htmlBody</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-8">Description<a href="#description-8" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.htmlBody</code> property contains the HTML representation of the email message (default charset is UTF-8) (optional, SMTP only). See <a href="#handling-body-part">Handling body part</a> section.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="id">.id<a href="#id" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.id</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-9">Description<a href="#description-9" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p><a href="/docs/19/API/IMAPTransporterClass">IMAP transporter</a> only.</p><p>The <code>.id</code> property contains the unique ID from the IMAP server.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="inreplyto">.inReplyTo<a href="#inreplyto" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.inReplyTo</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-10">Description<a href="#description-10" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.inReplyTo</code> property contains the message identifier(s) of the original message(s) to which the current message is a reply.</p><p>For specific formatting requirements, please consult the <a href="https://tools.ietf.org/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC#5322</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="keywords">.keywords<a href="#keywords" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.keywords</strong> : Object</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-11">Description<a href="#description-11" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.keywords</code> property contains a set of keywords as an object, where each property name is a keyword and each value is true.</p><p>This property is the &quot;keywords&quot; header (see <a href="https://tools.ietf.org/html/rfc4021" target="_blank" rel="noopener noreferrer">RFC#4021</a>).</p><table><thead><tr><th>Property</th><th>Type</th><th>Value</th></tr></thead><tbody><tr><td>.\&lt;keyword<!-- -->&gt;</td><td>boolean</td><td>Keyword to set (value must be true)</td></tr></tbody></table><p>Reserved keywords:</p><ul><li>$draft - Indicates a message is a draft</li><li>$seen - Indicates a message has been read</li><li>$flagged - Indicates a message needs special attention (e.g., Urgent)</li><li>$answered - Indicates a message has been replied to</li><li>$deleted - Indicates a message to delete</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> $mail.keywords[&quot;$flagged&quot;]:=True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mail.keywords[&quot;4d&quot;]:=True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="messageid">.messageId<a href="#messageid" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.messageId</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-12">Description<a href="#description-12" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.messageId</code> property contains a message identifier header (&quot;message-id&quot;).</p><p>This header is usually &quot;lettersOrNumbers@domainname&quot;, e.g. &quot;<a href="mailto:abcdef.123456@4d.com" target="_blank" rel="noopener noreferrer">abcdef.123456@4d.com</a>&quot;. This unique ID is used in particular on forums or public mailing lists. In general, mail servers automatically add this header to the messages they send.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="receivedat">.receivedAt<a href="#receivedat" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.receivedAt</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-13">Description<a href="#description-13" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p><a href="/docs/19/API/IMAPTransporterClass">IMAP transporter</a> only.</p><p>The <code>.receivedAt</code> property contains the timestamp of the email&#x27;s arrival on the IMAP server in ISO 8601 UTC format (ex: 2020-09-13T16:11:53Z).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">.references<a href="#references" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.references</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-14">Description<a href="#description-14" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.references</code> property contains the Collection of all message-ids of messages in the preceding reply chain.</p><p>For specific formatting requirements, please consult the <a href="https://tools.ietf.org/html/rfc5322" target="_blank" rel="noopener noreferrer">RFC#5322</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="replyto">.replyTo<a href="#replyto" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.replyTo</strong> : Text<br><strong>.replyTo</strong> : Object<br><strong>.replyTo</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-15">Description<a href="#description-15" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.replyTo</code> property contains the <a href="#email-addresses">addresse(s)</a> for responses.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sendat">.sendAt<a href="#sendat" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.sendAt</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-16">Description<a href="#description-16" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.sendAt</code> property contains the Email timestamp in ISO 8601 UTC format.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sender">.sender<a href="#sender" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.sender</strong> : Text<br><strong>.sender</strong> : Object<br><strong>.sender</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-17">Description<a href="#description-17" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.sender</code> property contains the email source <a href="#email-addresses">addresse(s)</a> of the email.</p><p>Each email you send out has both the <strong>sender</strong> and <strong><a href="#from">from</a></strong> addresses:</p><ul><li>the sender domain is what the receiving email server gets when opening the session,</li><li>the from address is what the recipient(s) will see.</li></ul><p>For better deliverability, it is recommended to use the same from and sender addresses.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="size">.size<a href="#size" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.size</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-18">Description<a href="#description-18" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p><a href="/docs/19/API/IMAPTransporterClass">IMAP transporter</a> only.</p><p>The <code>.size</code> property contains the size (expressed in bytes) of the Email object returned by the IMAP server.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="subject">.subject<a href="#subject" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.subject</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-19">Description<a href="#description-19" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.subject</code> property contains the description of topic.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="textbody">.textBody<a href="#textbody" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.textBody</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-20">Description<a href="#description-20" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.textBody</code> property contains the Plain text representation of the email message (default charset is UTF-8) (optional, SMTP only). See <a href="#handling-body-part">Handling body part</a> section.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="to">.to<a href="#to" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><strong>.to</strong> : Text<br><strong>.to</strong> : Object<br><strong>.to</strong> : Collection</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-21">Description<a href="#description-21" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>.to</code> property contains the primary recipient <a href="#email-addresses">addresse(s)</a> of the email.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mail-convert-from-mime">MAIL Convert from MIME<a href="#mail-convert-from-mime" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>History</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18</td><td>Added</td></tr></tbody></table></div></div></details><p><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Blob ) : Object<br><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>mime</td><td>Blob, Text</td><td align="center">-&gt;</td><td>Email in MIME</td></tr><tr><td>Result</td><td>Object</td><td align="center">&lt;-</td><td>Email object</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-22">Description<a href="#description-22" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>MAIL Convert from MIME</code> command converts a MIME document into a valid email object.</p><blockquote><p>4D follows the <a href="https://jmap.io/spec-mail.html" target="_blank" rel="noopener noreferrer">JMAP specification</a> to format the returned email object.</p></blockquote><p>Pass in <em>mime</em> a valid MIME document to convert. It can be provided by any mail server or application. You can pass a BLOB or a text <em>mime</em> parameter. If the MIME comes from a file, it is recommended to use a BLOB parameter to avoid issues related to charset and line break conversions.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="returned-object">Returned object<a href="#returned-object" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Email object.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-1">Example 1<a href="#example-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>You want to load a mail template saved as MIME in a text document and send an email:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $mime: Blob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $mail;$server;$transporter;$status: Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mime:=File(&quot;/PACKAGE/Mails/templateMail.txt&quot;).getContent())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail:=MAIL Convert from MIME($mime)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.to:=&quot;smith@mail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.subject:=&quot;Hello world&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.host:=&quot;smtp.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.port:=465</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.password:=&quot;XXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=SMTP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.send($mail)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-2">Example 2<a href="#example-2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>In this example, you send directly a 4D Write Pro document containing pictures:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $mime: Blob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $email;$server;$transporter;$status: Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Mime export of the 4D Write Pro document</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WP EXPORT VARIABLE(WParea;$mime;wk mime html)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// convert 4D Write Pro Mime variable in mail object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$email:=MAIL Convert from MIME($mime)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fill your mail object headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$email.subject:=&quot;4D Write Pro HTML body&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$email.from:=&quot;YourEmail@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$email.to:=&quot;RecipientEmail@mail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.host:=&quot;smtp.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.port:=465</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.user:=&quot;YourEmail@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.password:=&quot;XXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=SMTP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.send($email)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mail-convert-to-mime">MAIL Convert to MIME<a href="#mail-convert-to-mime" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>History</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr><tr><td>v17 R5</td><td>Modified</td></tr></tbody></table></div></div></details><p><strong>MAIL Convert to MIME</strong>( <em>mail</em> : Object { ; <em>options</em> : Object } ) : Text</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>mail</td><td>Object</td><td align="center">-&gt;</td><td>Email object</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Charset and encoding mail options</td></tr><tr><td>Result</td><td>Text</td><td align="center">&lt;-</td><td>Email object converted to MIME</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-23">Description<a href="#description-23" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The <code>MAIL Convert to MIME</code> command converts an email object into MIME text. This command is called internally by <a href="/docs/19/API/SMTPTransporterClass#send">SMTP_transporter.send( )</a> to format the email object before sending it. It can be used to analyze the MIME format of the object.</p><p>In <em>mail</em>, pass the content and the structure details of the email to convert. This includes information such as the email addresses (sender and recipient(s)), the message itself, and the type of display for the message.</p><blockquote><p>4D follows the <a href="https://jmap.io/spec-mail.html" target="_blank" rel="noopener noreferrer">JMAP specification</a> to format the email object.</p></blockquote><p>In <em>options</em>, you can set a specific charset and encoding configuration for the mail. The following properties are available:</p><table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset and encoding used for the following parts of the email: subject, attachment filenames, and email name attribute(s). Possible values:<table><tr><th>Constant</th><th>Value</th><th>Comment</th></tr><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li><i>headerCharset</i>: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; Quoted-printable if possible, otherwise UTF-8 &amp; Quoted-printable</li><li><i>bodyCharset</i>: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp; Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li><i>headerCharset</i>: ISO-8859-1 &amp; Quoted-printable</li><li><i>bodyCharset</i>: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td><i>headerCharset</i> &amp; <i>bodyCharset</i>: US-ASCII if possible, otherwise UTF-8 &amp; Quoted-printable (<strong>default value</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td><i>headerCharset</i> &amp; <i>bodyCharset</i>: US-ASCII if possible, otherwise UTF-8 &amp; base64</td></tr></table></td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset and encoding used for the html and text body contents of the email. Possible values: Same as for headerCharset (see above)</td></tr></tbody></table><p>If the <em>options</em> parameter is omitted, the mail mode UTF8 configuration is used for header and body parts.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example-3">Example<a href="#example-3" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $mail: Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $mime: Text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Creation of a mail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.from:=&quot;tsales@massmarket.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.subject:=&quot;Terrific Sale! This week only!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.textBody:=&quot;Text format email&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.htmlBody:=&quot;&lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.to:=New collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.to.push(New object (&quot;email&quot;;&quot;noreply@4d.com&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mail.to.push(New object (&quot;email&quot;;&quot;test@4d.com&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// transform the mail object in MIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$mime:=MAIL Convert to MIME($mail)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Contents of $mime:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// MIME-Version: 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Date: Thu, 11 Oct 2018 15:42:25 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Message-ID: &lt;7CA5D25B2B5E0047A36F2E8CB30362E2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Sender: tsales@massmarket.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// From: tsales@massmarket.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// To: noreply@4d.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// To: test@4d.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Content-Type: multipart/alternative; boundary=&quot;E0AE5773D5E95245BBBD80DD0687E218&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Subject: Terrific Sale! This week only!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// --E0AE5773D5E95245BBBD80DD0687E218</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Content-Type: text/plain; charset=&quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Content-Transfer-Encoding: quoted-printable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Text format email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// --E0AE5773D5E95245BBBD80DD0687E218</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Content-Type: text/html; charset=&quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Content-Transfer-Encoding: quoted-printable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// &lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// --E0AE5773D5E95245BBBD80DD0687E218--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FEmailObjectClass.md%20(19)&amp;body=Please%20enter%20your%20comment%3A" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Comment on this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/19/API/DataStoreClass"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DataStore</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/19/API/EntityClass"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Entity</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#email-object" class="table-of-contents__link toc-highlight">Email Object</a></li><li><a href="#email-addresses" class="table-of-contents__link toc-highlight">Email Addresses</a></li><li><a href="#handling-body-part" class="table-of-contents__link toc-highlight">Handling body part</a></li><li><a href="#attachments" class="table-of-contents__link toc-highlight">.attachments</a></li><li><a href="#bcc" class="table-of-contents__link toc-highlight">.bcc</a></li><li><a href="#bodystructure" class="table-of-contents__link toc-highlight">.bodyStructure</a></li><li><a href="#bodyvalues" class="table-of-contents__link toc-highlight">.bodyValues</a></li><li><a href="#cc" class="table-of-contents__link toc-highlight">.cc</a></li><li><a href="#comments" class="table-of-contents__link toc-highlight">.comments</a></li><li><a href="#from" class="table-of-contents__link toc-highlight">.from</a></li><li><a href="#headers" class="table-of-contents__link toc-highlight">.headers</a></li><li><a href="#htmlbody" class="table-of-contents__link toc-highlight">.htmlBody</a></li><li><a href="#id" class="table-of-contents__link toc-highlight">.id</a></li><li><a href="#inreplyto" class="table-of-contents__link toc-highlight">.inReplyTo</a></li><li><a href="#keywords" class="table-of-contents__link toc-highlight">.keywords</a></li><li><a href="#messageid" class="table-of-contents__link toc-highlight">.messageId</a></li><li><a href="#receivedat" class="table-of-contents__link toc-highlight">.receivedAt</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">.references</a></li><li><a href="#replyto" class="table-of-contents__link toc-highlight">.replyTo</a></li><li><a href="#sendat" class="table-of-contents__link toc-highlight">.sendAt</a></li><li><a href="#sender" class="table-of-contents__link toc-highlight">.sender</a></li><li><a href="#size" class="table-of-contents__link toc-highlight">.size</a></li><li><a href="#subject" class="table-of-contents__link toc-highlight">.subject</a></li><li><a href="#textbody" class="table-of-contents__link toc-highlight">.textBody</a></li><li><a href="#to" class="table-of-contents__link toc-highlight">.to</a></li><li><a href="#mail-convert-from-mime" class="table-of-contents__link toc-highlight">MAIL Convert from MIME</a></li><li><a href="#mail-convert-to-mime" class="table-of-contents__link toc-highlight">MAIL Convert to MIME</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Developer Center</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (Where It All Began)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Knowledgebase</a></li><li class="footer__item"><a href="https://us.4d.com/product-download/Feature-Release" target="_blank" rel="noopener noreferrer" class="footer__link-item">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About 4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D around the world<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.a8bcdca6.js"></script>
<script src="/docs/assets/js/main.af747107.js"></script>
</body>
</html>