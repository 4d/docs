<!DOCTYPE html><html lang="es"><head><meta name="docsearch:version" content="19"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>IMAPTransporter · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="La clase `IMAPTransporter` permite recuperar mensajes de un servidor de correo electrónico IMAP."/><meta name="docsearch:language" content="es"/><meta property="og:title" content="IMAPTransporter · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/19/index.html"/><meta property="og:description" content="La clase `IMAPTransporter` permite recuperar mensajes de un servidor de correo electrónico IMAP."/><meta property="og:image" content="https://4d.github.io/docs/19/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/19/img/logohome.png"/><link rel="shortcut icon" href="/docs/19/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/js/code-blocks-buttons.js"></script><script src="/docs/19/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/19/css/main.css"/><script src="/docs/19/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/19/es"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R5 BETA</a></li><li class=""><a href="https://developer.4d.com/docs/Rx" target="_self">v19 R4</a></li><li class=""><a style="font-weight:bold" href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/19/img/language.svg" alt="Languages icon"/>Español</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/19/en/API/IMAPTransporterClass.html">English</a></li><li><a href="/docs/19/ja/API/IMAPTransporterClass.html">日本語</a></li><li><a href="/docs/19/de/API/IMAPTransporterClass.html">Deutsch</a></li><li><a href="/docs/19/fr/API/IMAPTransporterClass.html">Français</a></li><li><a href="/docs/19/pt/API/IMAPTransporterClass.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Clases API</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Comencemos<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/GettingStarted/installation.html">Instalación</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Gestión de proyecto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Project/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Project/creating.html">Trabajar con un proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Project/architecture.html">Arquitectura de un proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Project/documentation.html">Documentar un proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Project/compiler.html">Compilación</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Conceptos del lenguaje 4D<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/about.html">Acerca del lenguaje 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/quick-tour.html">Un recorrido rápido</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/data-types.html">Tipos de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/blob.html">BLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/boolean.html">Booleano</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/collection.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/date.html">Fecha</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/null-undefined.html">Null e indefinido</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/number.html">Número (Real, Entero largo, Entero)</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/object.html">Objeto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/picture.html">Imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/pointer.html">Puntero</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/string.html">Cadena</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/time.html">Hora</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/variant.html">Variant</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/variables.html">Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/arrays.html">Arrays</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/methods.html">Métodos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/parameters.html">Parámetros</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/shared.html">Objetos y colecciones compartidos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/classes.html">Clases</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Control Flow</h4><ul><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/control-flow.html">Condiciones y bucles</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/branching.html">Estructuras condicionales</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/looping.html">Estructuras repetitivas (bucles)</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/19/es/Tags/tags.html">Etiquetas de transformación</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/error-handling.html">Gestión de errores</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/interpreted-compiled.html">Modos interpretado y compilado</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/components.html">Componentes</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/plug-ins.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Concepts/identifiers.html">Identificadores</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORDA<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/overview.html">¿Qué es ORDA?</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/dsmapping.html">Objeto del modelo de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/ordaClasses.html">Clases del modelo de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/entities.html">Trabajar con los datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/datastores.html">Utilizar un almacén de datos remoto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/ORDA/glossary.html">Glosario</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Clases API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/API/overview.html">Generalidades - API de clases</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/ClassClass.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/CollectionClass.html">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/CryptoKeyClass.html">CryptoKey</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/DataClassClass.html">DataClass</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/DataClassAttributeClass.html">DataClassAttribute</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/DataStoreClass.html">DataStore</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/EmailObjectClass.html">Email</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/EntityClass.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/EntitySelectionClass.html">EntitySelection</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/FileClass.html">File</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/FolderClass.html">Folder</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/FunctionClass.html">Formula</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/19/es/API/IMAPTransporterClass.html">IMAPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/MailAttachmentClass.html">MailAttachment</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/POP3TransporterClass.html">POP3Transporter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/SessionClass.html">Sesión</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/SignalClass.html">Signal</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/SMTPTransporterClass.html">SMTPTransporter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/WebServerClass.html">WebServer</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/ZipArchiveClass.html">ZIPArchive</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/ZipFileClass.html">ZIPFile</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/API/ZipFolderClass.html">ZIPFolder</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Preferencias<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/general.html">Página general</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/structure.html">Structure Page</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/forms.html">Página formulario</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/methods.html">Página Métodos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Preferences/shortcuts.html">Shortcuts Page</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Administración<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/webAdmin.html">Administración Web</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/dataExplorer.html">Explorador de datos Web</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/licenses.html">Gestión de licencias 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/tls.html">Protocolo TLS (HTTPS)</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/cli.html">Interfaz de línea de comando</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Admin/debugLogFiles.html">Descripción de los archivos históricos</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Derechos de acceso<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Users/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Users/editing.html">Gestión de usuarios y grupos 4D</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">CSM<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/information.html">Página de información</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/analysis.html">Página Análisis de actividades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/verify.html">Página Verificación</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/backup.html">Página de respaldo</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/compact.html">Página compactado</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/rollback.html">Página Retroceso</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/restore.html">Página Restauración</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/repair.html">Página Reparación</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/MSC/encrypt.html">Página de cifrado</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Copia de seguridad y restauración<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Backup/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Backup/backup.html">Copia de seguridad</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Backup/settings.html">Parámetros de la copia de seguridad</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Backup/log.html">Archivo de historial (.journal)</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Backup/restore.html">Restaurar</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Servidor Web<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/webServer.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/webServerConfig.html">Configuración</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/webServerAdmin.html">Administración</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/webServerObject.html">Objeto servidor web</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Desarrollo web<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/gettingStarted.html">Comencemos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/templates.html">Páginas de plantillas</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/httpRequests.html">Processing HTTP requests</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/allowProject.html">Permitir métodos proyecto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/errorPages.html">Custom HTTP Error Pages</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/authentication.html">Autenticación</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/sessions.html">Sesiones usuario</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/WebServer/preemptiveWeb.html">Using preemptive web processes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Servidor REST<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/gettingStarted.html">Comencemos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/configuration.html">Configuración del servidor</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/authUsers.html">Usuarios y sesiones</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/genInfo.html">Obtener información del servidor</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/manData.html">Manipulación de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/classFunctions.html">Llamar a las funciones de clase ORDA</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/REST_requests.html">Acerca de las peticiones REST</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (general)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/catalog.html">$catalog</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/directory.html">$directory</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/info.html">$info</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/upload.html">$upload</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API (dataClass)</h4><ul><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/{dataClass}.html">{dataClass}</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/asArray.html">$asArray</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/atomic_$atonce.html">$atomic/$atonce</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/attributes.html">$attributes</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/binary.html">$binary</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/compute.html">$compute</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/distinct.html">$distinct</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/entityset.html">$entityset</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/expand.html">$expand</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/filter.html">$filter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/imageformat.html">$imageformat</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/lock.html">$lock</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/method.html">$method</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/orderby.html">$orderby</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/querypath.html">$querypath</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/queryplan.html">$queryplan</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/savedfilter.html">$savedfilter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/savedorderby.html">$savedorderby</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/skip.html">$skip</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/timeout.html">$timeout</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/top_$limit.html">$top/$limit</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/REST/version.html">$version</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Cliente/Servidor<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Desktop/clientServer.html">Gestión Cliente/Servidor</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Formularios<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/forms.html">Acerca de los formularios 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/formEditor.html">Editor de formularios</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/macros.html">Macros del editor de formularios</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/objectLibrary.html">Librerías de objetos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/stylesheets.html">Hojas de estilo</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/pictures.html">Imágenes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Propiedades de los formularios<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/jsonReference.html">Lista de propiedades JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/action.html">Acción</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/propertiesForm.html">Propiedades de los formularios</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/formSize.html">Tamaño formulario</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/markers.html">Marcadores</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/menu.html">Menú</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/print.html">Imprimir</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormEditor/windowSize.html">Tamaño de la ventana</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Objetos formularios<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/formObjectsOverview.html">Acerca de los objetos formularios 4D</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/buttonOverview.html">Botón</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/buttonGridOverview.html">Rejilla de botones</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/checkboxOverview.html">Casilla a seleccionar</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/comboBoxOverview.html">Combo Box</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/dropdownListOverview.html">Lista desplegable</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/groupBox.html">Área de grupo</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/inputOverview.html">Entrada</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/listOverview.html">Lista jerárquica</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/listboxOverview.html">List Box</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/pictureButtonOverview.html">Botón Imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/picturePopupMenuOverview.html">Menú pop-up imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/pluginAreaOverview.html">Área de plug-in</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/progressIndicator.html">Indicador de progreso</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/radiobuttonOverview.html">Botón radio</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/ruler.html">Regla</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/shapesOverview.html">Formas</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/spinner.html">Spinner</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/splitters.html">Separador</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/staticPicture.html">Imagen estática</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/stepper.html">Stepper</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/subformOverview.html">Subformulario</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/tabControl.html">Pestañas</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/text.html">Texto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/webAreaOverview.html">Área Web</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/viewProAreaOverview.html">Área 4D View Pro</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/writeProAreaOverview.html">Área 4D Write Pro</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Propiedades de los objetos formulario<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesReference.html">Lista de propiedades JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesAction.html">Acción</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesAnimation.html">Animación</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesAppearance.html">Apariencia</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesBackgroundAndBorder.html">Fondo y borde</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesCoordinatesAndSizing.html">Coordenadas y dimensiones</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesCrop.html">Corte</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesDataSource.html">Fuente de datos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesDisplay.html">Visualización</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesEntry.html">Entrada</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesFooters.html">Pies</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesGridlines.html">Rejillas</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesHeaders.html">Encabezados</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesHelp.html">Ayuda</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesHierarchy.html">Jerarquía</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesListBox.html">List Box</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesObject.html">Objetos</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesPicture.html">Imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesPlugIns.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesPrint.html">Imprimir</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesRangeOfValues.html">Rango de valores</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesResizingOptions.html">Opciones de redimensionamiento</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesScale.html">Escala</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesSubform.html">Subformulario</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesText.html">Texto</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesTextAndPicture.html">Texto e Imagen</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/FormObjects/propertiesWebArea.html">Área Web</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Eventos formulario<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onActivate.html">On Activate</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onAfterEdit.html">On After Edit</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onAfterKeystroke.html">On After Keystroke</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onAfterSort.html">On After Sort</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onAlternativeClick.html">On Alternative Click</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onBeforeDataEntry.html">On Before Data Entry</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onBeforeKeystroke.html">On Before Keystroke</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onBeginDragOver.html">On Begin Drag Over</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onBeginUrlLoading.html">On Begin URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onBoundVariableChange.html">On Bound Variable Change</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onClicked.html">On Clicked</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onCloseBox.html">On Close Box</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onCloseDetail.html">On Close Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onCollapse.html">On Collapse</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onColumnMoved.html">On Column Moved</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onColumnResize.html">On Column Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDataChange.html">On Data Change</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDeactivate.html">On Deactivate</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDeleteAction.html">On Delete Action</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDisplayDetail.html">On Display Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDoubleClicked.html">On Double Clicked</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDragOver.html">On Drag Over</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onDrop.html">On Drop</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onEndUrlLoading.html">On End URL Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onExpand.html">On Expand</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onFooterClick.html">On Footer Click</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onGettingFocus.html">On Getting focus</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onHeader.html">On Header</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onHeaderClick.html">On Header Click</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onLoad.html">On Load</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onLoadRecord.html">On Load Record</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onLongClick.html">On Long Click</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onLosingFocus.html">On Losing focus</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onMenuSelected.html">On Menu Selected</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onMouseEnter.html">On Mouse Enter</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onMouseLeave.html">On Mouse Leave</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onMouseMove.html">On Mouse Move</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onMouseUp.html">On Mouse Up</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onOpenDetail.html">On Open Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onOpenExternalLink.html">On Open External Link</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onOutsideCall.html">On Outside Call</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onPageChange.html">On Page Change</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onPlugInArea.html">On Plug in Area</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onPrintingBreak.html">On Printing Break</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onPrintingDetail.html">On Printing Detail</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onPrintingFooter.html">On Printing Footer</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onResize.html">On Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onRowMoved.html">On Row Moved</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onRowResize.html">On Row Resize</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onScroll.html">On Scroll</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onSelectionChange.html">On Selection Change</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onTimer.html">On Timer</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onUnload.html">On Unload</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onUrlFiltering.html">On URL Filtering</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onUrlLoadingError.html">On URL Loading Error</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onUrlResourceLoading.html">On URL Resource Loading</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onValidate.html">On Validate</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onVpRangeChanged.html">On VP Range Changed</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onVpReady.html">On VP Ready</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Events/onWindowOpeningDenied.html">On Window Opening Denied</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Menús<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Menus/overview.html">Generalidades</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Menus/creating.html">Creación de menús y barras de menús</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Menus/properties.html">Propiedades de los menús</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Menus/bars.html">Barras de menús</a></li><li class="navListItem"><a class="navItem" href="/docs/19/es/Menus/sdi.html">Mode SDI bajo Windows</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Build application<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/19/es/Desktop/building.html">Construir un paquete proyecto</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/19/docs/API/IMAPTransporterClass.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">IMAPTransporter</h1></header><article><div><span><p>La clase <code>IMAPTransporter</code> permite recuperar mensajes de un servidor de correo electrónico IMAP.</p>
<h3><a class="anchor" aria-hidden="true" id="objeto-imap-transporter"></a><a href="#objeto-imap-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objeto IMAP Transporter</h3>
<p>Los objetos IMAP Transporter se instancian con el comando <a href="#imap-new-transporter">IMAP New transporter</a>. Ofrecen las siguientes propiedades y funciones:</p>
<table>
<thead>
<tr><th></th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> si se permite a 4D establecer una conexión no cifrada</td></tr>
<tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><p>    añade banderas a los <code>msgIDs</code> para las <code>keywords</code></td></tr>
<tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><p>    añade el objeto <code>mailObj</code> a la caja <code>destinationBox</code></td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    el modo de autenticación utilizado para abrir la sesión en el servidor de correo</td></tr>
<tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a><p>     comprueba la conexión utilizando la información almacenada en el objeto transporter</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    duración máxima (en segundos) permitida antes de verificar la conexión al servidor</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor</td></tr>
<tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><p>    copia los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP</td></tr>
<tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><p>    crea un buzón con el <code>name</code> pasado</td></tr>
<tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>    asocia el marcador &quot;deleted&quot; a los mensajes designados por <code>msgsIDs</code> o <code>allMsgs</code></td></tr>
<tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><p>    selimina definitivamente el buzón llamado <code>name</code> en el servidor IMAP</td></tr>
<tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a><p>    elimina todos los mensajes con el marcador &quot;deleted&quot; del servidor de correo IMAP.</td></tr>
<tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><p>    devuelve un objeto <code>boxInfo</code> correspondiente al buzón de recepción actual o al buzón llamado <em>name</em></td></tr>
<tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><p>    devuelve una colección de bandejas de entrada que describe todas las bandejas de entrada disponibles</td></tr>
<tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a><p>    devuelve el carácter utilizado para delimitar los niveles de jerarquía en el nombre del buzón</td></tr>
<tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><p>    devuelve el objeto <code>Email</code> correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><p>    devuelve un objeto que contiene una colección de objetos <code>Email</code></td></tr>
<tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><p>    devuelve un BLOB con el contenido MIME del mensaje correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code></td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    el nombre o la dirección IP del servidor local</td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    la ruta del archivo de registro extendido definido (si existe) para la conexión de correo</td></tr>
<tr><td>[</td></tr>
<tr><td><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object](#move)<p>    mueve los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em> en el servidor IMAP</td></tr>
<tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><p>    convierte los números de secuencia en IDs únicos IMAP para los mensajes en el rango secuencial designado por <em>startMsg</em> y <em>endMsg</em></td></tr>
<tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><p>    elimina las banderas de los <code>msgIDs</code> para las <code>keywords</code> definidas</td></tr>
<tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><p>    cambia el nombre de un buzón en el servidor IMAP</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     el número de puerto utilizado para las transacciones de correo</td></tr>
<tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><p>    busca los mensajes que coincidan con el <em>searchCriteria</em> en el buzón actual</td></tr>
<tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>    selects the <em>name</em> mailbox as the current mailbox</td></tr>
<tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><p>    allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes</td></tr>
<tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><p>    removes a mailbox from a set of subscribed mailboxes</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     el nombre de usuario utilizado para la autenticación en el servidor de correo</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="imap-new-transporter"></a><a href="#imap-new-transporter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IMAP New transporter</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>servidor</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr>
<tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objeto IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción"></a><a href="#descripción" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>El comando <code>IMAP New transporter</code> configura una nueva conexión IMAP según el parámetro <em>server</em> y devuelve un nuevo objeto <em>transporter</em>. El objeto transportador devuelto se utilizará normalmente para recibir correos electrónicos.</p>
<p>En el parámetro <em>server</em>, pase un objeto que contenga las siguientes propiedades:</p>
<table>
<thead>
<tr><th><em>server</em></th><th>Valor por defecto (si se omite)</th></tr>
</thead>
<tbody>
<tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a><p>    <strong>True</strong> si se permite a 4D establecer una conexión no cifrada</td><td>False</td></tr>
<tr><td>.<strong>accessTokenOAuth2</strong>: Text<p>Cadena de texto que representa las credenciales de autorización OAuth 2. Sólo se utiliza con OAUTH2 <code>authenticationMode</code>. Si se utiliza <code>accessTokenOAuth2</code> pero se omite <code>authenticationMode</code>, se utiliza el protocolo OAuth 2 (si el servidor lo permite). No se devuelve en el objeto <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>ninguno</td></tr>
<tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a><p>    el modo de autenticación utilizado para abrir la sesión en el servidor de correo</td><td>se utiliza el modo de autenticación más seguro soportado por el servidor</td></tr>
<tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a><p>    duración máxima (en segundos) permitida antes de verificar la conexión al servidor</td><td>300</td></tr>
<tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a><p>    el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor</td><td>30</td></tr>
<tr><td><a href="#host"><strong>.host</strong> : Text</a><p>    el nombre o la dirección IP del servidor local</td><td><em>obligatorio</em></td></tr>
<tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a><p>    la ruta del archivo de registro extendido definido (si existe) para la conexión de correo</td><td>ninguno</td></tr>
<tr><td>.<strong>password</strong> : Text<p>Contraseña del usuario para la autenticación en el servidor. No se devuelve en el objeto <em><a href="#imap-transporter-object">IMAP transporter</a></em>.</td><td>ninguno</td></tr>
<tr><td><a href="#port"><strong>.port</strong> : Integer</a><p>     el número de puerto utilizado para las transacciones de correo</td><td>993</td></tr>
<tr><td><a href="#user"><strong>.user</strong> : Text</a><p>     el nombre de usuario utilizado para la autenticación en el servidor de correo</td><td>ninguno</td></tr>
</tbody>
</table>
<blockquote>
<p><strong>Atención</strong>: asegúrese de que el tiempo de espera definido sea menor que el tiempo de espera del servidor, de lo contrario el tiempo de espera del cliente será inútil.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado"></a><a href="#resultado" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>La función devuelve un <a href="#imap-transporter-object"><strong>IMAP transporter</strong></a>. Todas las propiedades devueltas son <strong>de sólo lectura</strong>.</p>
<blockquote>
<p>La conexión IMAP se cierra automáticamente cuando se destruye el objeto transportador.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo"></a><a href="#ejemplo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object
<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
<span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>
<span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log a guardar en la carpeta Logs</span><span class="hljs-keyword">

var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">
If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="4dimaptransporternew"></a><a href="#4dimaptransporternew" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4D.IMAPTransporter.new()</h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>server</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr>
<tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#imap-transporter-object">Objeto IMAP Transporter</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-1"></a><a href="#descripción-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>4D.IMAPTransporter.new()</code> crea y devuelve un nuevo objeto del tipo <code>4D.IMAPTransporter</code>. Es idéntico al comando <a href="#imap-new-transporter"><code>IMAP New transporter</code></a> (acceso directo).</p>
<h2><a class="anchor" aria-hidden="true" id="acceptunsecureconnection"></a><a href="#acceptunsecureconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.acceptUnsecureConnection</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-2"></a><a href="#descripción-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.acceptUnsecureConnection</code> contiene <strong>True</strong> si se permite a 4D establecer una conexión no cifrada cuando la conexión cifrada no es posible.</p>
<p>Contiene <strong>False</strong> si no se permiten las conexiones no cifradas, en cuyo caso se devuelve un error cuando no es posible la conexión cifrada.</p>
<p>Los puertos seguros disponibles son:</p>
<ul>
<li><p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 o 25: SMTP con actualización STARTTLS si lo soporta el servidor.</li>
</ul></li>
<li><p>IMAP</p>
<ul>
<li>143: Puerto IMAP no encriptado</li>
<li>993: IMAP con actualización STARTTLS si lo soporta el servidor</li>
</ul></li>
<li><p>POP3</p>
<ul>
<li>110: Puerto POP3 no encriptado</li>
<li>995: POP3 con actualización STARTTLS si lo soporta el servidor.</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="addflags"></a><a href="#addflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.addFlags()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr>
<tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a añadir</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación addFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-3"></a><a href="#descripción-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.addFlags()</code> añade banderas a los <code>msgIDs</code> para las <code>keywords</code>.</p>
<p>En el parámetro <code>msgIDs</code>, puede pasar:</p>
<ul>
<li><p>una <em>collection</em> contiene los identificadores únicos de mensajes específicos, o</p></li>
<li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li>
<li><p>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr>
</tbody>
</table>
</li>
</ul>
<p>El parámetro <code>keywords</code> le permite pasar un objeto con valores de palabras clave para las banderas específicas que se añadirán a <code>msgIDs</code>. Puede pasar cualquiera de las siguientes palabras claves:</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booleano</td><td>True para añadir el marcador &quot;draft&quot; al mensaje</td></tr>
<tr><td>$seen</td><td>Booleano</td><td>True para añadir el marcador &quot;seen&quot; al mensaje</td></tr>
<tr><td>$flagged</td><td>Booleano</td><td>True para añadir el marcador &quot;flagged&quot; al mensaje</td></tr>
<tr><td>$answered</td><td>Booleano</td><td>True para añadir el marcador &quot;answered&quot; al mensaje</td></tr>
<tr><td>$deleted</td><td>Booleano</td><td>True para añadir el marcador &quot;deleted&quot; al mensaje</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Los valores falsos se ignoran.</li>
<li>La interpretación de los indicadores de palabras claves puede variar según el cliente de correo.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1"></a><a href="#ejemplo-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Crear transportador</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Seleccionar buzón de correo</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Marcar todos los mensajes de INBOX como leídos/vistos</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="append"></a><a href="#append" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.append()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>mailObj</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto Email</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir el objeto Email</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto que contiene información del charset</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-4"></a><a href="#descripción-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.append()</code> añade el objeto <code>mailObj</code> a la caja <code>destinationBox</code>.</p>
<p>En el parámetro <code>mailObj</code>, pase un objeto Email. Para una descripción completa de las propiedades del correo, ver <a href="/docs/19/es/API/EmailObjectClass.html#email-object">objeto Email</a>. La función <code>.append()</code> soporta los marcadores de palabras clave en el atributo <code>keywords</code> de los objetos email.</p>
<p>El parámetro opcional <code>destinationBox</code> permite pasar el nombre del buzón donde se añadirá el objeto <code>mailObj</code>. Si se omite, se utiliza el buzón actual.</p>
<p>En el parámetro opcional <code>options</code>, puede pasar un objeto para definir el charset y la codificación para partes específicas del correo electrónico. Propiedades disponibles:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>headerCharset</td><td>Texto</td><td>Charset y codificación utilizados para las siguientes partes del correo electrónico: asunto, nombres de archivos adjuntos y atributo(s) del nombre del correo electrónico. Valores posibles: ver la tabla de charsets posibles a continuación</td></tr>
<tr><td>bodyCharset</td><td>Texto</td><td>Charset y codificación utilizados para el contenido html y el texto del cuerpo del correo electrónico. Valores posibles: ver la tabla de charsets posibles a continuación</td></tr>
</tbody>
</table>
<p>Charsets posibles:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII si es posible, japonés (ISO-2022-JP) &amp; Quoted-printable si es posible, de lo contrario UTF-8 &amp; Quoted-printable</li><li>bodyCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp; Quoted-printable</li></ul></td></tr>
<tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr>
<tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: US-ASCII si es posible, de lo contrario UTF-8 &amp; Quoted-printable (<strong>valor por defecto</strong>)</td></tr>
<tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: US-ASCII si es posible, de lo contrario UTF-8 &amp; base64</td></tr>
</tbody>
</table>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2"></a><a href="#ejemplo-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para guardar un correo electrónico en el buzón de borradores:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object

<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)

<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)

<span class="hljs-variable">$msg</span>:=New object
<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span>
<span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span>
<span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span>
<span class="hljs-variable">$msg</span>.keywords:=New object
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marcar el mensaje como leído</span>
<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marcar el mensaje como borrador</span>

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="authenticationmode"></a><a href="#authenticationmode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.authenticationMode</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.authenticationMode</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-5"></a><a href="#descripción-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.authenticationMode</code> contiene el modo de autenticación utilizado para abrir la sesión en el servidor de correo.</p>
<p>Por defecto, se utiliza el modo más seguro soportado por el servidor.</p>
<p>Los valores posibles son:</p>
<table>
<thead>
<tr><th>Valor</th><th>Constantes</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Autenticación utilizando el protocolo CRAM-MD5</td></tr>
<tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Autenticación utilizando el protocolo LOGIN</td></tr>
<tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Autenticación utilizando el protocolo OAuth2</td></tr>
<tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Autenticación utilizando el protocolo PLAIN</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnection"></a><a href="#checkconnection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnection()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnection()</strong> : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la conexión del objeto transportador</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-6"></a><a href="#descripción-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.checkConnection()</code>  comprueba la conexión utilizando la información almacenada en el objeto transporter, recrea la conexión si es necesario y devuelve el estado. Esta función permite verificar que los valores proporcionados por el usuario son válidos y coherentes.</p>
<h4><a class="anchor" aria-hidden="true" id="objeto-devuelto"></a><a href="#objeto-devuelto" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objeto devuelto</h4>
<p>La función envía una solicitud al servidor de correo y devuelve un objeto que describe el estado del correo. Este objeto puede contener las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>booleano</td><td>True si la verificación es exitosa, False en caso contrario</td></tr>
<tr><td>status</td><td></td><td>number</td><td>(sólo SMTP) Código de estado devuelto por el servidor de correo (0 en caso de un problema no relacionado con el procesamiento del correo)</td></tr>
<tr><td>statusText</td><td></td><td>texto</td><td>Mensaje de estado devuelto por el servidor de correo, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>colección</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor de correo)</td></tr>
<tr><td></td><td>[ ].errCode</td><td>number</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[ ].message</td><td>texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[ ].componentSignature</td><td>texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="checkconnectiondelay"></a><a href="#checkconnectiondelay" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.checkConnectionDelay</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-7"></a><a href="#descripción-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.checkConnectionDelay</code> contiene la duración máxima (en segundos) permitida antes de verificar la conexión al servidor.  Si se supera este tiempo entre dos llamadas al método, se comprobará la conexión con el servidor. Por defecto, si la propiedad no se ha definido en el objeto <em>server&lt;</em>, el valor es de 300.</p>
<blockquote>
<p><strong>Atención</strong>: asegúrese de que el tiempo de espera definido sea menor que el tiempo de espera del servidor, de lo contrario el tiempo de espera del cliente será inútil.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="connectiontimeout"></a><a href="#connectiontimeout" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.connectionTimeOut</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-8"></a><a href="#descripción-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.connectionTimeOut</code> contiene el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor. Por defecto, si la propiedad no se ha definido en el objeto servidor (utilizado para crear el objeto transportador con <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, o <code>IMAP New transporter</code>), el valor es 30.</p>
<h2><a class="anchor" aria-hidden="true" id="copy"></a><a href="#copy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.copy()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir mensajes copiados</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de copia</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-9"></a><a href="#descripción-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.copy()</code> copia los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección contiene los IDs únicos de los mensajes específicos a copiar, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para copiar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>El parámetro <em>destinationBox</em> permite pasar un valor texto con el nombre del buzón donde se colocarán las copias de los mensajes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-1"></a><a href="#ejemplo-1-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para copiar una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// copiar los mensajes encontrados en el buzón "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-1"></a><a href="#ejemplo-2-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para copiar todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>

 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// copiar los mensajes encontrados en el buzón "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="createbox"></a><a href="#createbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.createBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de creación del buzón</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-10"></a><a href="#descripción-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.createBox()</code> crea un buzón con el <code>name</code> pasado. Si el carácter separador de jerarquía del servidor IMAP aparece en otra parte del nombre del buzón, el servidor IMAP creará todos los nombre padre necesarios para crear el buzón dado.</p>
<p>En otras palabras, un intento de crear &quot;Projects/IMAP/Doc&quot; en un servidor en el que &quot;/&quot; es el carácter separador de jerarquía creará:</p>
<ul>
<li>Sólo el buzón &quot;Doc&quot; si &quot;Projects&quot; &amp; &quot;IMAP&quot; ya existen.</li>
<li>Los buzones &quot;IMAP&quot; &amp; &quot;Doc&quot; si sólo existe &quot;Projects&quot;.</li>
<li>Los buzones &quot;Projects&quot; &amp; &quot;IMAP&quot; &amp; &quot;Doc&quot;, si no existen.</li>
</ul>
<p>En el parámetro <code>name</code>, pasa el nombre del nuevo buzón.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-3"></a><a href="#ejemplo-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para crear un nuevo buzón &quot;Invoices&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">
If</span>(OK=<span class="hljs-number">1</span>)
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">
Else</span>
<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="delete"></a><a href="#delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.delete()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de eliminación</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-11"></a><a href="#descripción-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.delete()</code> asocia el marcador &quot;deleted&quot; a los mensajes designados por <code>msgsIDs</code> o <code>allMsgs</code>.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <code>msgsIDs</code>, una colección contiene los IDs únicos de los mensajes específicos a eliminar, o</li>
<li>en el parámetro <code>allMsgs</code>, la constante <code>IMAP all</code> (entero) para eliminar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>La ejecución de esta función no elimina realmente los mensajes. Los mensajes con la bandera &quot;delete&quot; pueden seguir siendo encontrados por la función <a href="#searchmails">.searchMails()</a>. Los mensajes marcados se eliminan del servidor IMAP con la función <a href="#expunge"><code>.expunge()</code></a> o al seleccionar otro buzón o cuando se destruye el objeto <a href="#imap-transporter-object">transporter</a> (creado con <a href="#imap-new-transporter">IMAP New transporter</a>).</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-2"></a><a href="#ejemplo-1-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para eliminar una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)

  <span class="hljs-comment">// Borrar los mensajes seleccionados</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-2"></a><a href="#ejemplo-2-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para eliminar todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)

  <span class="hljs-comment">// Borrar los mensajes seleccionados en el buzón actual</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="deletebox"></a><a href="#deletebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.deleteBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón a eliminar</td></tr>
</tbody>
</table>
<p>|Result|Object|&lt;-|Estado de la operación de eliminación del buzón|</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-12"></a><a href="#descripción-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.deleteBox()</code> selimina definitivamente el buzón llamado <code>name</code> en el servidor IMAP. Intentar eliminar un INBOX o un buzón que no existe generará un error.</p>
<p>En el parámetro <code>name</code>, pase el nombre del buzón a eliminar.</p>
<blockquote>
<ul>
<li>La función no puede eliminar un buzón que tiene buzones hijos si el buzón padre tiene el atributo &quot;\Noselect&quot;.</li>
<li>Todos los mensajes del buzón eliminado también se borrarán.</li>
<li>La posibilidad de eliminar un buzón depende del servidor de correo.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-4"></a><a href="#ejemplo-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para eliminar el buzón secundario &quot;Nova Orion Industries&quot; del interior del buzón &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// eliminar buzón</span>
<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">
    Else</span>
<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="expunge"></a><a href="#expunge" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.expunge()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.expunge()</strong> : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación expunge</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-13"></a><a href="#descripción-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.expunge()</code> elimina todos los mensajes con el marcador &quot;deleted&quot; del servidor de correo IMAP. El marcador &quot;deleted&quot; puede establecerse con los métodos <a href="#delete"><code>.delete()</code></a> o <a href="#addflags"><code>.addFlags()</code></a>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-5"></a><a href="#ejemplo-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
var</span> <span class="hljs-variable">$ids </span>: Collection

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Crear transportador</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Seleccionar buzón</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Buscar y eliminar todos los mensajes vistos en INBOX</span>
<span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)

<span class="hljs-comment">// Purgar todos los mensajes marcados como borrados</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxinfo"></a><a href="#getboxinfo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxInfo()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td><em>name</em> es opcional</td></tr>
</tbody>
</table>
<p>|v18 R4|Added| </details></p>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-14"></a><a href="#descripción-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getBoxInfo()</code> devuelve un objeto <code>boxInfo</code> correspondiente al buzón de recepción actual o al buzón llamado <em>name</em>. Esta función devuelve la misma información que <a href="#selectbox"><code>.selectBox()</code></a> sin cambiar el buzón actual.</p>
<p>En el parámetro opcional <em>name</em>, pase el nombre del buzón a acceder. El nombre representa una jerarquía inequívoca de izquierda a derecha, con niveles separados por un carácter delimitador específico. El delimitador se puede recuperar con la función <a href="#getdelimiter"><code>.getDelimiter()</code></a>.</p>
<p>Si el buzón <em>name</em> no es seleccionable o no existe, la función genera un error y devuelve <strong>null</strong>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>texto</td><td>Nombre del buzón</td></tr>
<tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Número de mensajes con el marcador &quot;reciente&quot; (que indica los mensajes nuevos)</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-6"></a><a href="#ejemplo-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)
<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getboxlist"></a><a href="#getboxlist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getBoxList()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
<tr><td>v19</td><td>Adición parámetro <code>isSubscribed</code></td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>parameters</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto de parámetro</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de objetos mailbox</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-15"></a><a href="#descripción-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getBoxList()</code> devuelve una colección de bandejas de entrada que describe todas las bandejas de entrada disponibles. Esta función permite gestionar localmente la lista de mensajes localizados en el servidor de correo IMAP.</p>
<p>En el parámetro opcional <code>parameters</code>, pase un objeto que contenga valores para filtrar los buzones devueltos. Puede pasar:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>isSubscribed</td><td>Booleano</td><td><li><strong>True</strong> para devolver sólo los buzones suscritos</li><li> <strong>False</strong> para devolver todos los buzones disponibles</li></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="resultado-1"></a><a href="#resultado-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>Cada objeto de la colección devuelta contiene las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>[].name</td><td>texto</td><td>Nombre del buzón</td></tr>
<tr><td>[].selectable</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no seleccionar el buzón: <ul><li>true - el buzón puede ser seleccionado</li><li>false - el buzón no puede ser seleccionado</li></ul></td></tr>
<tr><td>[].inferior</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no crear una jerarquía inferior en el buzón: <ul><li>true - se puede crear un nivel inferior</li><li>false - no se puede crear un nivel inferior</li></ul></td></tr>
<tr><td>[].interesting</td><td>booleano</td><td>Indica si el buzón ha sido marcado como &quot;interesante&quot; por el servidor: <ul><li>true - El buzón ha sido marcado como &quot;interesante&quot; por el servidor. Por ejemplo, puede contener mensajes nuevos.</li><li>false - El buzón no ha sido marcado como &quot;interesante&quot; por el servidor.</li></ul></td></tr>
</tbody>
</table>
<p>Si la cuenta no contiene buzones, se devuelve una colección vacía.</p>
<blockquote>
<ul>
<li>Si no hay ninguna conexión abierta, <code>.getBoxList()</code> abrirá una conexión.</li>
<li>Si la conexión no se ha utilizado desde el retraso de conexión designado (ver <code>IMAP New transporter</code>), se llama automáticamente a la función <code>.checkConnection( )</code>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-7"></a><a href="#ejemplo-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getdelimiter"></a><a href="#getdelimiter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getDelimiter()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getDelimiter()</strong> : Text</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>Resultado</td><td>Texto</td><td style="text-align:center">&lt;-</td><td>Carácter delimitador de jerarquía</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-16"></a><a href="#descripción-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getDelimiter()</code> devuelve el carácter utilizado para delimitar los niveles de jerarquía en el nombre del buzón.</p>
<p>El delimitador es un carácter que puede utilizarse para:</p>
<ul>
<li>crear buzones de nivel inferior</li>
<li>buscar más arriba o más abajo en la jerarquía del buzón</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="resultado-2"></a><a href="#resultado-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>Carácter delimitador del nombre del buzón.</p>
<blockquote>
<ul>
<li>Si no hay ninguna conexión abierta, <code>getDelimiter()</code> abrirá una conexión.</li>
<li>Si la conexión no se ha utilizado desde el <a href="#checkconnectiondelay">retraso de conexión</a> designado, la función <a href="#checkconnection"><code>.checkConnection()</code></a> se llama automáticamente.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-8"></a><a href="#ejemplo-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

 <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword">

 For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">
    If</span>(<span class="hljs-variable">$box</span>.interesting)
       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())
<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">
    End if</span><span class="hljs-keyword">
 End for each</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmail"></a><a href="#getmail" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMail()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del mensaje</td></tr>
<tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Instrucciones sobre el manejo de mensajes</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td><a href="/docs/19/es/API/EmailObjectClass.html#email-object">Objeto Email</a></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-17"></a><a href="#descripción-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getMail()</code> devuelve el objeto <code>Email</code> correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por <code>IMAP_transporter</code>. Esta función le permite manejar localmente el contenido del correo electrónico.</p>
<p>En el primer parámetro, puede pasar:</p>
<ul>
<li><em>msgNumber</em>, un valor <em>integer</em> indicando el número de secuencia del mensaje a recuperar o</li>
<li><em>msgID</em>, un valor <em>text</em> indicando el ID único del mensaje a recuperar.</li>
</ul>
<p>El parámetro opcional <em>options</em> permite pasar un objeto que define las instrucciones adicionales para la gestión del mensaje. Las siguientes propiedades están disponibles:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>booleano</td><td>Si True, el mensaje se marca como &quot;visto&quot; en el buzón. Si es False, el mensaje no se marca como &quot;visto&quot;. Valor por defecto: True</td></tr>
<tr><td>withBody</td><td>booleano</td><td>Pase True para devolver el cuerpo del mensaje. Si es False, sólo se devuelve el encabezado del mensaje. Valor por defecto: True</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>La función genera un error y devuelve <strong>Null</strong> si <em>msgID</em> designa un mensaje inexistente,</li>
<li>Si no se selecciona ningún buzón con la función <a href="#selectbox"><code>.selectBox()</code></a>, se genera un error,</li>
<li>Si no hay ninguna conexión abierta, <code>.getMail()</code> abrirá una conexión con el último buzón especificado por <a href="#selectbox"><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-3"></a><a href="#resultado-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMail()</code> devuelve un <a href="/docs/19/es/API/EmailObjectClass.html#objet-email"><code>objet Email</code></a> con las propiedades IMAP adicionales siguientes: <em>id</em>, <em>receivedAt</em> y <em>size</em>.</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-9"></a><a href="#ejemplo-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Quiere obtener el mensaje con ID = 1:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//crear transportador</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//obtener el objeto Email con ID 1</span>
 <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmails"></a><a href="#getmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMails()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores de mensajes</td></tr>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del primer mensaje</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del último mensaje</td></tr>
<tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Instrucciones sobre la gestión de mensajes</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto que contiene:<br><ul><li>una colección de <a href="/docs/19/es/API/EmailObjectClass.html#email-object">objetos Email</a> y</li><li>una colección de identificadores o números para los mensajes que faltan, si los hay</li></ul></td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-18"></a><a href="#descripción-18" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getMails()</code> devuelve un objeto que contiene una colección de objetos <code>Email</code>.</p>
<p><strong>Primera sintaxis:</strong></p>
<p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p>
<p>La primera sintaxis permite recuperar los mensajes en función de sus identificadores.</p>
<p>En el parámetro <em>ids</em>, pase una colección de IDs para los mensajes a devolver. Puede obtener los IDs con <a href="#getmail"><code>.getMail()</code></a>.</p>
<p>El parámetro opcional <em>options</em> permite definir las partes de los mensajes a devolver. Consulte la tabla <strong>Opciones</strong> a continuación para obtener una descripción de las propiedades disponibles.</p>
<p><strong>Segunda sintaxis:</strong></p>
<p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p>
<p>La segunda sintaxis permite recuperar los mensajes en función de un rango secuencial. Los valores pasados representan la posición de los mensajes en el buzón.</p>
<p>En el parámetro <em>startMsg</em>, pase un valor <em>entero</em> correspondiente al número del primer mensaje en un rango secuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;= 0), se utilizará el primer mensaje del buzón como inicio de la secuencia.</p>
<p>En el parámetro <em>endMsg</em>, pase un valor <em>entero</em> correspondiente al número del último mensaje a incluir en un rango secuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;= 0), se utilizará el último mensaje del buzón como fin de secuencia.</p>
<p>El parámetro opcional <em>options</em> permite definir las partes de los mensajes a devolver.</p>
<p><strong>Opciones</strong></p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>updateSeen</td><td>Booleano</td><td>Si True, los mensajes especificados se marcan como &quot;vistos&quot; en el buzón. Si False, los mensajes no se marcan como &quot;vistos&quot;. Valor por defecto: True</td></tr>
<tr><td>withBody</td><td>Booleano</td><td>Pase True para devolver el cuerpo de los mensajes específicos. Si False, sólo se devuelve los encabezados de los mensajes. Valor por defecto: True</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Si no se selecciona ningún buzón con el comando <a href="#selectbox"><code>.selectBox()</code></a>, se genera un error.</li>
<li>Si no hay ninguna conexión abierta, <code>.getMails()</code> abrirá una conexión con el último buzón especificado por <a href="#selectbox"><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-4"></a><a href="#resultado-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMails()</code> devuelve un objeto que contiene las siguientes colecciones:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>lista</td><td>Collection</td><td>Colección de objetos <a href="/docs/19/es/API/EmailObjectClass.html#email-object"><code>Email</code></a>. Si no se encuentran objetos Email, se devuelve una colección vacía.</td></tr>
</tbody>
</table>
<p>|notFound |Collection| Colección de:<br><ul><li>primera sintaxis - IDs de mensajes pasados previamente que no existen</li><li>segunda sintaxis - números de secuencia de los mensajes entre startMsg y endMsg que no existen</li></ul>Se devuelve una colección vacía si se encuentran todos los mensajes.|</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-10"></a><a href="#ejemplo-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Quiere recuperar los 20 correos electrónicos más recientes sin cambiar el estado &quot;visto&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//crear transportador</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">

  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)
        <span class="hljs-comment">// recuperar los encabezados de los últimos 20 mensajes sin marcarlos como leídos</span>
    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\
<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">
    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)
        <span class="hljs-comment">// ...</span><span class="hljs-keyword">
    End for each</span><span class="hljs-keyword">
 End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="getmimeasblob"></a><a href="#getmimeasblob" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.getMIMEAsBlob()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del mensaje</td></tr>
<tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr>
<tr><td>updateSeen</td><td>Booleano</td><td style="text-align:center">-&gt;</td><td>Si True, el mensaje se marca como &quot;visto&quot; en el buzón. Si False, el mensaje se deja igual.</td></tr>
<tr><td>Resultado</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob de la cadena MIME devuelta por el servidor de correo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-19"></a><a href="#descripción-19" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.getMIMEAsBlob()</code> devuelve un BLOB con el contenido MIME del mensaje correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code>.</p>
<p>En el primer parámetro, puede pasar:</p>
<ul>
<li><em>msgNumber</em>, un valor <em>integer</em> indicando el número de secuencia del mensaje a recuperar o</li>
<li><em>msgID</em>, un valor <em>text</em> indicando el ID único del mensaje a recuperar.</li>
</ul>
<p>El parámetro opcional <em>updateSeen</em> permite indicar si el mensaje está marcado como &quot;visto&quot; en el buzón. Puede pasar:</p>
<ul>
<li><strong>True</strong> - para marcar el mensaje como &quot;visto&quot; (indicando que el mensaje ha sido leído)</li>
<li><strong>False</strong> - para dejar intacto el estado &quot;visto&quot; del mensaje</li>
</ul>
<blockquote>
<ul>
<li>La función devuelve un BLOB vacío si <em>msgNumber</em> o msgID* designa un mensaje inexistente,</li>
<li>Si no se selecciona ningún buzón con el comando <a href="#selectbox"><code>.selectBox()</code></a>, se genera un error,</li>
<li>Si no hay ninguna conexión abierta, <code>.getMIMEAsBlob()</code> abrirá una conexión con el último buzón especificado por <code>.selectBox()</code>.</li>
</ul>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="resultado-5"></a><a href="#resultado-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p><code>.getMIMEAsBlob()</code> devuelve un <code>BLOB</code> que puede almacenarse en una base de datos o convertirse en un objeto <a href="/docs/19/es/API/EmailObjectClass.html#email-object"><code>Email</code></a> con el comando <code>MAIL Convert from MIME</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-11"></a><a href="#ejemplo-11" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

  <span class="hljs-comment">//crear transportador</span>
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)

  <span class="hljs-comment">//obtener BLOB</span>
 <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="host"></a><a href="#host" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.host</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.host</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-20"></a><a href="#descripción-20" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.host</code> contiene el nombre o la dirección IP del servidor local. Se utiliza para las transacciones de correo (SMTP, POP3, IMAP).</p>
<h2><a class="anchor" aria-hidden="true" id="logfile"></a><a href="#logfile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.logFile</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.logFile</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-21"></a><a href="#descripción-21" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.logFile</code> contiene la ruta del archivo de registro extendido definido (si existe) para la conexión de correo. Puede ser relativo (a la carpeta actual Logs) o absoluto.</p>
<p>A diferencia de los archivos de registro clásicos (habilitados mediante el comando <code>SET DATABASE PARAMETER</code>), los archivos de registro extendidos almacenan el contenido MIME de todos los correos enviados y no tienen ningún límite de tamaño. Para más información sobre los archivos de registro extendidos, consulte:</p>
<ul>
<li><strong>Conexiones SMTP</strong> - <a href="/docs/19/es/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li>
<li>**Conexiones POP3 ** - <a href="/docs/19/es/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li>
<li><strong>Conexiones IMAP</strong> - <a href="/docs/19/es/Admin/debugLogFiles.html#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="move"></a><a href="#move" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.move()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr>
<tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzón seleccionado</td></tr>
<tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir mensajes desplazados</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de desplazamiento</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-22"></a><a href="#descripción-22" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.move()</code> mueve los mensajes definidos en <em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em> en el servidor IMAP.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección contiene los IDs únicos de los mensajes específicos a mover, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para mover todos los mensajes del buzón seleccionado.</li>
</ul>
<p>El parámetro <em>destinationBox</em> permite pasar un valor texto con el nombre del buzón donde los mensajes serán desplazados.</p>
<blockquote>
<p>Esta función sólo la soportan los servidores IMAP que cumplen con el RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-1-3"></a><a href="#ejemplo-1-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 1</h4>
<p>Para mover una selección de mensajes:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)

  <span class="hljs-comment">// Mover los mensajes encontrados del buzón actual al buzón "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-2-3"></a><a href="#ejemplo-2-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo 2</h4>
<p>Para mover todos los mensajes del buzón actual:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">// mover todos los mensajes del buzón actual al buzón "documents"</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="numtoid"></a><a href="#numtoid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.numToID()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del primer mensaje</td></tr>
<tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del último mensaje</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de identificadores de mensajes únicos</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-23"></a><a href="#descripción-23" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.numToID()</code> convierte los números de secuencia en IDs únicos IMAP para los mensajes en el rango secuencial designado por <em>startMsg</em> y <em>endMsg</em> en el buzón actualmente seleccionado.</p>
<p>En el parámetro <em>startMsg</em>, pase un valor entero correspondiente al número del primer mensaje en un rango secuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;= 0), se utilizará el primer mensaje del buzón como inicio de la secuencia.</p>
<p>En el parámetro <em>endMsg</em>, pase un valor entero correspondiente al número del último mensaje a incluir en un rango secuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;= 0), se utilizará el último mensaje del buzón como fin de secuencia.</p>
<h4><a class="anchor" aria-hidden="true" id="resultado-6"></a><a href="#resultado-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resultado</h4>
<p>La función devuelve una colección de cadenas (IDs únicos).</p>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-12"></a><a href="#ejemplo-12" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">
 var</span> <span class="hljs-variable">$mailIds </span>: Collection

 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span>
 <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>

 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)

  <span class="hljs-comment">//seleccionar buzón</span>
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)

  <span class="hljs-comment">//obtener los ID de los 5 últimos mensajes recibidos</span>
 <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)

  <span class="hljs-comment">//eliminar los mensajes del buzón actual</span>
 <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="removeflags"></a><a href="#removeflags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.removeFlags()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R6</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr>
<tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a eliminar</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación removeFlags</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-24"></a><a href="#descripción-24" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.removeFlags()</code> elimina las banderas de los <code>msgIDs</code> para las <code>keywords</code> definidas.</p>
<p>En el parámetro <code>msgIDs</code>, puede pasar:</p>
<ul>
<li><p>una <em>collection</em> contiene los identificadores únicos de mensajes específicos, o</p></li>
<li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li>
<li><p>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr>
</tbody>
</table>
</li>
</ul>
<p>El parámetro <code>keywords</code> le permite pasar un objeto con valores de palabras clave para las banderas específicas a eliminar de los <code>msgIDs</code>. Puede pasar cualquiera de las siguientes palabras claves:</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>$draft</td><td>Booleano</td><td>True para eliminar el marcador &quot;draft&quot; del mensaje</td></tr>
<tr><td>$seen</td><td>Booleano</td><td>True para eliminar el marcador &quot;seen&quot; del mensaje</td></tr>
<tr><td>$flagged</td><td>Booleano</td><td>True para eliminar el marcador &quot;flagged&quot; del mensaje</td></tr>
<tr><td>$answered</td><td>Booleano</td><td>True para eliminar el marcador &quot;answered&quot; del mensaje</td></tr>
<tr><td>$deleted</td><td>Booleano</td><td>True para eliminar el marcador &quot;deleted&quot; del mensaje</td></tr>
</tbody>
</table>
<p>Note que los valores falsos se ignoran.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-13"></a><a href="#ejemplo-13" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object

<span class="hljs-variable">$options</span>:=New object
<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span>

<span class="hljs-comment">// Crear transportador</span>
<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// Seleccionar buzón</span>
<span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)

<span class="hljs-comment">// Marcar todos los mensajes de INBOX como no vistos</span>
<span class="hljs-variable">$flags</span>:=New object
<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="renamebox"></a><a href="#renamebox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.renameBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>currentName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo actual</td></tr>
<tr><td>newName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nuevo nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación renombrar</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-25"></a><a href="#descripción-25" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La función <code>.renameBox()</code> cambia el nombre de un buzón en el servidor IMAP. Si se intenta renombrar un buzón desde un nombre de buzón que no existe o a un nombre de buzón que ya existe, se generará un error.</p>
<p>En el parámetro <code>currentName</code>, pase el nombre del buzón a renombrar.</p>
<p>Pase el nuevo nombre del buzón en el parámetro <code>newName</code>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-14"></a><a href="#ejemplo-14" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para cambiar el nombre de su buzón de &quot;Invoices&quot; a &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-comment">// renombrar buzón</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
 End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="port"></a><a href="#port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.port</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.port</strong> : Integer</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-26"></a><a href="#descripción-26" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.port</code> contiene  el número de puerto utilizado para las transacciones de correo. Por defecto, si la propiedad <em>port</em> no se ha definido en el objeto <em>server</em> (utilizado para crear el objeto transportador con <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), el puerto utilizado es:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="searchmails"></a><a href="#searchmails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.searchMails()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R5</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>searchCriteria</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Criterio de búsqueda</td></tr>
<tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de números de mensajes</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-27"></a><a href="#descripción-27" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<blockquote>
<p>Esta función se basa en la especificación del <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">protocolo IMAP</a>.</p>
</blockquote>
<p>La función <code>.searchMails()</code> busca los mensajes que coincidan con el <em>searchCriteria</em> en el buzón actual. El parámetro <em>searchCriteria</em> contiene una o varias palabras clave de búsqueda.</p>
<p><em>searchCriteria</em> is a text parameter listing one or more search keys (see <a href="#authorized-search-keys">Authorized search-keys</a> below) associated or not with values to look for. A search key may be a single or multiple items. Por ejemplo:</p>
<pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED
<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED
<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT
</code></pre>
<blockquote>
<p>Las coincidencias no suelen diferenciar entre mayúsculas y minúsculas</p>
</blockquote>
<ul>
<li>If the <em>searchCriteria</em> is a null string, the search will be equivalent to a “select all”.</li>
<li>If the <em>searchCriteria</em> includes multiple search keys, the result is the intersection (AND function) of all the messages that match those keys.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span>
</code></pre>
<p>... returns all messages with \Flagged flag set AND sent by Smith.</p>
<ul>
<li>You can use the <strong>OR</strong> or <strong>NOT</strong> operators as follows:</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED
</code></pre>
<p>... returns all messages with \Seen flag set OR \Flagged flag set</p>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN
</code></pre>
<p>... returns all messages with \Seen flag not set.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span>
</code></pre>
<p>... returns message whose content-type header contains “Mixed” and does not contain “Text”.</p>
<pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"
</code></pre>
<p>... returns message whose content-type header contains “ e ” and whose Subject header does not contain “ o ” and whose content-type header is not “ Mixed ”.</p>
<p>As concerns the last two examples, notice that the result of the search is different when you remove the parentheses of the first search key list.</p>
<ul>
<li>The <em>searchCriteria</em> may include the optional [CHARSET] specification. This consists of the &quot;CHARSET&quot; word followed by a registered [CHARSET] (US ASCII, ISO-8859). It indicates the charset of the <em>searchCriteria</em> string. Therefore, you must convert the <em>searchCriteria</em> string into the specified charset if you use the [CHARSET] specification (see the <code>CONVERT FROM TEXT</code> or <code>Convert to text</code> commands). By default, 4D encodes in Quotable Printable the searchCriteria string if it contains extended characters.</li>
</ul>
<pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span>
</code></pre>
<p>... means the search criteria uses the charset iso-8859 and the server will have to convert the search criteria before searching, if necessary.</p>
<h4><a class="anchor" aria-hidden="true" id="search-value-types"></a><a href="#search-value-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Search value types</h4>
<p>Search-keys may request the value to search for:</p>
<ul>
<li><p><strong>Search-keys with a field-name value</strong>: the field-name is the name of a header field. Ejemplo: <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (una fecha no suele necesitar comillas, ya que no contiene caracteres especiales)</p></li>
<li><p><strong>Search-keys with a string value</strong>: the string may contain any character and must be quoted. If the string does not contain any special characters, like the space character for instance, it does not need to be quoted. Quoting such strings will ensure that your string value will be correctly interpreted. Ejemplo: <code>criterios de búsqueda = FROM &quot;SMITH&quot;</code> Para todas las llaves de búsqueda que utilizan cadenas, un mensaje coincide con la llave si la cadena es una subcadena del campo. Matching is not case-sensitive.</p></li>
<li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li>
<li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li>
<li><p><strong>Search-keys with a message set value</strong>: Identifies a set of messages. For message sequence numbers, these are consecutive numbers from 1 to the total number of messages in the mailbox. A comma delimits individual numbers; a colon delimits between two numbers inclusive. Ejemplos: <code>2,4:7,9,12:*</code> es <code>2,4,5,6,7,9,12,13,14,15</code> para un buzón con 15 mensajes. <code>searchCriteria = 1:5 ANSWERED</code> search in message selection from message sequence number 1 to 5 for messages which have the \Answered flag set. <code>searchCriteria= 2,4 ANSWERED</code> search in the message selection (message numbers 2 and 4) for messages which have the \Answered flag set.</p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="teclas-de-búsqueda-disponibles"></a><a href="#teclas-de-búsqueda-disponibles" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Teclas de búsqueda disponibles</h4>
<p><strong>ALL</strong>: All messages in the mailbox.<br>
<strong>ANSWERED</strong>: Messages with the \Answered flag set.<br>
<strong>UNANSWERED</strong>: Messages that do not have the \Answered flag set.<br>
<strong>DELETED</strong>: Messages with the \Deleted flag set.<br>
<strong>UNDELETED</strong>: Messages that do not have the \Deleted flag set.<br>
<strong>DRAFT</strong>: Messages with the \Draft flag set.<br>
<strong>UNDRAFT</strong>: Messages that do not have the \Draft flag set.<br>
<strong>FLAGGED</strong>: Messages with the \Flagged flag set.<br>
<strong>UNFLAGGED</strong>: Messages that do not have the \Flagged flag set.<br>
<strong>RECENT</strong>: Messages that have the \Recent flag set.<br>
<strong>OLD</strong>: Messages that do not have the \Recent flag set.<br>
<strong>SEEN</strong>: Messages that have the \Seen flag set.<br>
<strong>UNSEEN</strong>: Messages that do not have the \Seen flag set.<br>
<strong>NEW</strong>: Messages that have the \Recent flag set but not the \Seen flag. This is functionally equivalent to &quot;(RECENT UNSEEN)&quot;.<br>
***KEYWORD ***flag******: Messages with the specified keyword set.<br>
***UNKEYWORD ***flag******: Messages that do not have the specified keyword set.<br>
***BEFORE ***date******: Messages whose internal date is earlier than the specified date.<br>
***ON ***date******: Messages whose internal date is within the specified date.<br>
***SINCE ***date******: Messages whose internal date is within or later than the specified date.<br>
***SENTBEFORE ***date******: Messages whose Date header is earlier than the specified date.<br>
***SENTON ***date******: Messages whose Date header is within the specified date.<br>
***SENTSINCE ***date******: Messages whose Date header is within or later than the specified date.<br>
***TO ***string******: Messages that contain the specified string in the TO header.<br>
***FROM ***string******: Messages that contain the specified string in the FROM header.<br>
***CC ***string******: Messages that contain the specified string in the CC header.<br>
***BCC ***string******: Messages that contain the specified string in the BCC header.<br>
***SUBJECT ***string******: Messages that contain the specified string in the Subject header.<br>
***BODY ***string******: Messages that contain the specified string in the message body.<br>
***TEXT ***string******: Messages that contain the specified string in the header or in the message body.<br>
***HEADER <em>field-name</em> ***string******: Messages that have a header with the specified field-name and that contain the specified string in the field-body.<br>
***UID ***message-UID******: Messages with unique identifiers corresponding to the specified unique identifier set.<br>
***LARGER ***n******: Messages with a size larger than the specified number of bytes.<br>
***SMALLER ***n******: Messages with a size smaller than the specified number of bytes.<br>
***NOT ***search-key******: Messages that do not match the specified search key.<br>
***OR <em>search-key1</em> ***search-key2******: Messages that match either search key.</p>
<h2><a class="anchor" aria-hidden="true" id="selectbox"></a><a href="#selectbox" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.selectBox()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v18 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>state</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Estado de acceso al buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-28"></a><a href="#descripción-28" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.selectBox()</code> function selects the <em>name</em> mailbox as the current mailbox. Esta función permite recuperar la información sobre el buzón.</p>
<blockquote>
<p>To get the information from a mailbox without changing the current mailbox, use <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>In the <em>name</em> parameter, pass the name of the mailbox to access. The name represents an unambiguous left-to-right hierarchy with levels separated by a specific delimiter character. The delimiter can be found with the <a href="#getdelimiter"><code>.getDelimiter()</code></a> function.</p>
<p>The optional <em>state</em> parameter defines the type of access to the mailbox. Los valores posibles son:</p>
<table>
<thead>
<tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr>
</thead>
<tbody>
<tr><td>IMAP read only state</td><td>1</td><td>The selected mailbox is accessed with read only privileges. Messages with a &quot;recent&quot; flag (indicating new messages) remain unchanged.</td></tr>
<tr><td>IMAP read write state</td><td>0</td><td>The selected mailbox is accessed with read and write privileges. Messages are considered &quot;seen&quot; and lose the &quot;recent&quot; flag (indicating new messages). (Valor por defecto)</td></tr>
</tbody>
</table>
<blockquote>
<ul>
<li>The function generates an error and returns <strong>Null</strong> if <em>name</em> designates a non-existing mailbox.</li>
<li>If there is no open connection, <code>.selectBox()</code> will open a connection.</li>
<li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>
<table>
<thead>
<tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td>Nombre del buzón</td></tr>
<tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr>
<tr><td>mailRecent</td><td>number</td><td>Número de mensajes con la bandera &quot;recent&quot;</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-15"></a><a href="#ejemplo-15" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object
 <span class="hljs-variable">$server</span>:=New object
 <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span>
 <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span>
 <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword">

 var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter
 <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)
 <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="subscribe"></a><a href="#subscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.subscribe()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación subscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-29"></a><a href="#descripción-29" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.subscribe()</code> function allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes. As such, you can choose to narrow down a large list of available mailboxes by subscribing to those you usually want to see.</p>
<p>In the <code>name</code> parameter, pass the name of the mailbox to add (subscribe) to your &quot;subscribed&quot; mailboxes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-16"></a><a href="#ejemplo-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para suscribirse al buzón &quot;Atlas Corp&quot; en la jerarquía &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="unsubscribe"></a><a href="#unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.unsubscribe()</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v19</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>
<table>
<thead>
<tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr>
<tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación unsubscribe</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="descripción-30"></a><a href="#descripción-30" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>The <code>.unsubscribe()</code> function removes a mailbox from a set of subscribed mailboxes. This allows you reduce the number of mailboxes you usually see.</p>
<p>In the <code>name</code> parameter, pass the name of the mailbox to remove (unsubscribe) from your active mailboxes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>
<table>
<thead>
<tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr>
</thead>
<tbody>
<tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr>
<tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores de 4D</td></tr>
<tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)</td></tr>
<tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr>
<tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr>
<tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="ejemplo-17"></a><a href="#ejemplo-17" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo</h4>
<p>Para desuscribirse del buzón &quot;Atlas Corp&quot; en la jerarquía &quot;Bills&quot;:</p>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">
var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object

<span class="hljs-variable">$options</span>:=New object

<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">

If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span>
<span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>
<span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>

<span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)

<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span>
<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">

If</span> (<span class="hljs-variable">$status</span>.success)
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">
   Else</span>
<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">
   End if</span><span class="hljs-keyword">
End if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="user"></a><a href="#user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>.user</h2>
<p><details><summary>Histórico</summary></p>
<table>
<thead>
<tr><th>Versión</th><th>Modificaciones</th></tr>
</thead>
<tbody>
<tr><td>v17 R4</td><td>Añadidos</td></tr>
</tbody>
</table>
<p></details></p>
<p><strong>.user</strong> : Text</p>
<h4><a class="anchor" aria-hidden="true" id="descripción-31"></a><a href="#descripción-31" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Descripción</h4>
<p>La propiedad <code>.user</code> contiene  el nombre de usuario utilizado para la autenticación en el servidor de correo.</p>
<style> h2 { background: #d9ebff;}</style>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/19/es/API/FunctionClass.html"><span class="arrow-prev">← </span><span>Formula</span></a><a class="docs-next button" href="/docs/19/es/API/MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#imap-new-transporter">IMAP New transporter</a></li><li><a href="#4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#addflags">.addFlags()</a></li><li><a href="#append">.append()</a></li><li><a href="#authenticationmode">.authenticationMode</a></li><li><a href="#checkconnection">.checkConnection()</a></li><li><a href="#checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#connectiontimeout">.connectionTimeOut</a></li><li><a href="#copy">.copy()</a></li><li><a href="#createbox">.createBox()</a></li><li><a href="#delete">.delete()</a></li><li><a href="#deletebox">.deleteBox()</a></li><li><a href="#expunge">.expunge()</a></li><li><a href="#getboxinfo">.getBoxInfo()</a></li><li><a href="#getboxlist">.getBoxList()</a></li><li><a href="#getdelimiter">.getDelimiter()</a></li><li><a href="#getmail">.getMail()</a></li><li><a href="#getmails">.getMails()</a></li><li><a href="#getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#host">.host</a></li><li><a href="#logfile">.logFile</a></li><li><a href="#move">.move()</a></li><li><a href="#numtoid">.numToID()</a></li><li><a href="#removeflags">.removeFlags()</a></li><li><a href="#renamebox">.renameBox()</a></li><li><a href="#port">.port</a></li><li><a href="#searchmails">.searchMails()</a></li><li><a href="#selectbox">.selectBox()</a></li><li><a href="#subscribe">.subscribe()</a></li><li><a href="#unsubscribe">.unsubscribe()</a></li><li><a href="#user">.user</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/19/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:es","version:19"]}
              });
            </script></body></html>