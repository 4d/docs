<!DOCTYPE html><html lang="de"><head><meta name="docsearch:version" content="19 R4 BETA"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Formulas and Functions · 4D Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Using formulas"/><meta name="docsearch:language" content="de"/><meta property="og:title" content="Formulas and Functions · 4D Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://4d.github.io/docs/index.html"/><meta property="og:description" content="## Using formulas"/><meta property="og:image" content="https://4d.github.io/docs/img/logohome.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://4d.github.io/docs/img/logohome.png"/><link rel="shortcut icon" href="/docs/img/4d.gif"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script type="text/javascript" src="/docs/alpha/js/comment.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/docs/js/code-blocks-buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/de"><h2 class="headerTitle">4D Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://developer.4d.com/docs" target="_self">v19 R5 BETA</a></li><li class=""><a href="https://developer.4d.com/docs/Rx" target="_self">v19 R4</a></li><li class=""><a href="https://developer.4d.com/docs/19" target="_self">v19</a></li><li class=""><a href="https://developer.4d.com/docs/18" target="_self">v18</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/docs/img/language.svg" alt="Languages icon"/>Deutsch</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/ViewPro/formulas.html">English</a></li><li><a href="/docs/ja/ViewPro/formulas.html">日本語</a></li><li><a href="/docs/es/ViewPro/formulas.html">Español</a></li><li><a href="/docs/fr/ViewPro/formulas.html">Français</a></li><li><a href="/docs/pt/ViewPro/formulas.html">Português</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>4D View Pro</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Extensions<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/de/Extensions/overview.html">Überblick</a></li><li class="navListItem"><a class="navItem" href="/docs/de/Extensions/develop-components.html">Developing Components</a></li><li class="navListItem"><a class="navItem" href="/docs/de/Extensions/develop-plug-ins.html">Developing Plug-ins</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">4D View Pro<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/de/ViewPro/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/de/ViewPro/configuring.html">Configuring 4D View Pro Areas</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/de/ViewPro/formulas.html">Formulas and Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/de/ViewPro/method-list.html">Method List</a></li><li class="navListItem"><a class="navItem" href="/docs/de/ViewPro/advanced-programming.html">Advanced programming with Javascript</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/4D/docs/edit/master/docs/ViewPro/formulas.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Formulas and Functions</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="using-formulas"></a><a href="#using-formulas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using formulas</h2>
<p>A spreadsheet formula is an expression that calculates the value of a cell.</p>
<h3><a class="anchor" aria-hidden="true" id="entering-formulas"></a><a href="#entering-formulas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Entering formulas</h3>
<p>To enter a formula in a 4D View Pro area:</p>
<ol>
<li>Select the cell into which you will enter the formula or function.</li>
<li>Enter = (the equal sign).</li>
<li>Type the formula and hit the <strong>Enter</strong> key.</li>
</ol>
<p>When writing a formula, you can use different shortcuts:</p>
<ul>
<li>click on a cell to enter its reference in the formula:</li>
</ul>
<p><img src="/docs/assets/en/ViewPro/formulas.PNG" alt=""></p>
<ul>
<li>type the first letter of a function to enter. A pop-up menu listing the available functions and references appears, allowing you to select the desired elements:</li>
</ul>
<p><img src="/docs/assets/en/ViewPro/formula2.PNG" alt=""></p>
<p>You can also create named formulas that can be called via their name. To do so, enter these formulas using the <a href="/docs/de/ViewPro/method-list.html#vp-add-formula-name">VP ADD FORMULA NAME</a> command.</p>
<h3><a class="anchor" aria-hidden="true" id="operators-and-operands"></a><a href="#operators-and-operands" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operators and Operands</h3>
<p>All formulas have operands and operators:</p>
<ul>
<li><strong>Operators</strong>: see <a href="#values-and-operators">Values and operators</a> below.</li>
<li><strong>Operands</strong> include several categories:
<ul>
<li><a href="#values-and-operators">values</a> (5 data types are supported)</li>
<li><a href="#cell-references">references to other cells</a> (relative, absolute, mixed or by name)</li>
<li><a href="#using-functions">standard spreadsheet functions</a></li>
<li><a href="#4d-functions">4D functions</a> based upon 4D formulas and providing access to 4D variables, fields, methods, commands, or expressions.</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="values-and-operators"></a><a href="#values-and-operators" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Values and operators</h2>
<p>4D View Pro supports five types of data. For each data type, specific literal values and operators are supported.</p>
<table>
<thead>
<tr><th>Data types</th><th>Values</th><th>Operatoren</th></tr>
</thead>
<tbody>
<tr><td><a href="/docs/de/Concepts/number.html">Zahl</a></td><td>1.2<br>1.2 E3<br>1.2E-3<br>10.3x</td><td>+ (addition)<br>- (subtraction)<br>* (multiplication)<br>/ (division)<br>^ (exponent, the number of times to multiply a number by itself)<br>% (percentage -- divide the number before the operator by one hundred)</td></tr>
<tr><td><a href="/docs/de/Concepts/date.html">Datum</a></td><td>10/24/2017</td><td>+ (date + number of days -&gt; date)<br>+ (date + time -&gt; date + time of day)<br>- (date - number of days -&gt; date)<br>- (date - date -&gt; number of days between the two)</td></tr>
<tr><td><a href="/docs/de/Concepts/time.html">Zeit</a></td><td>10:12:10</td><td>Duration operators:<p>+ (addition)<br>- (subtraction)<br>* (duration * number -&gt; duration)<br>/ (duration / number -&gt; duration)</td></tr>
<tr><td><a href="/docs/de/Concepts/string.html">String</a></td><td>'Sophie' or &quot;Sophie&quot;</td><td>&amp; (concatenation)</td></tr>
<tr><td><a href="/docs/de/Concepts/boolean.html">Boolean</a></td><td>TRUE or FALSE</td><td>-</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="comparison-operators"></a><a href="#comparison-operators" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Comparison operators</h3>
<p>The following operators can be used with two operands of the same type:</p>
<table>
<thead>
<tr><th>Operator</th><th>Comparison</th></tr>
</thead>
<tbody>
<tr><td>=</td><td>equal to</td></tr>
<tr><td>&lt;&gt;</td><td>different than</td></tr>
<tr><td>&gt;</td><td>greater than</td></tr>
<tr><td>&lt;</td><td>less than</td></tr>
<tr><td>&gt;=</td><td>greater than or equal to</td></tr>
<tr><td>&lt;=</td><td>less than or equal to</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="operator-precedence"></a><a href="#operator-precedence" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operator precedence</h3>
<p>List of operators from most to least important:</p>
<table>
<thead>
<tr><th>Operator</th><th>Beschreibung</th></tr>
</thead>
<tbody>
<tr><td>()</td><td>Parenthesis (for grouping)</td></tr>
<tr><td>-</td><td>Negate</td></tr>
<tr><td>+</td><td>Plus</td></tr>
<tr><td>%</td><td>Percent</td></tr>
<tr><td>^</td><td>Exponent</td></tr>
<tr><td>* and /</td><td>Multiply and divide</td></tr>
<tr><td>+ and -</td><td>Add and Subtract</td></tr>
<tr><td>&amp;</td><td>Concatenate</td></tr>
<tr><td>=  &gt; &lt; &gt;= &lt;= &lt;&gt;</td><td>Compare</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="cell-references"></a><a href="#cell-references" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cell references</h2>
<p>Formulas often refer to other cells by cell addresses. You can copy these formulas into other cells. For example, the following formula, entered in cell C8, adds the values in the two cells above it and displays the result.</p>
<pre><code class="hljs"><span class="hljs-section">= C6 + C7</span>
</code></pre>
<p>This formula refers to cells C6 and C7. That is, 4D View Pro is instructed to refer to these other cells for values to use in the formula.</p>
<p>When you copy or move these formulas to new locations, each cell address in that formula will either change or stay the same, depending on how it is typed.</p>
<ul>
<li>A reference that changes is called a <strong>relative reference</strong>, and refers to a cell by how far left/right and up/down it is from the cell with the formula.</li>
<li>A reference that always points to a particular cell is called an <strong>absolute reference</strong>.</li>
<li>You can also create a mixed reference which always points to a fixed row or column.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="reference-notation"></a><a href="#reference-notation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference Notation</h3>
<p>If you use only cell coordinates, for example, <code>C5</code>, 4D View Pro interprets the reference as relative. You may make the reference an absolute reference by putting a dollar sign in front of the letter and the number, as in <code>$C$5</code>.</p>
<p>You can mix absolute and relative references by inserting a dollar sign in front of the letter or the number alone, for example, <code>$C5</code> or <code>C$5</code>. A mixed reference allows you to specify either the row or the column as absolute, while allowing the other portion of the address to refer relatively.</p>
<p>A convenient, fast and accurate way to specify an absolute reference is to name the cell and use that name in place of the cell address. A reference to a named cell is always absolute. You can create or modify named cells or named cell ranges using the <a href="/docs/de/ViewPro/method-list.html#vp-add-range-name"><code>VP ADD RANGE NAME</code></a> method.</p>
<p>The following table shows the effect of the different notations:</p>
<table>
<thead>
<tr><th>Beispiel</th><th>Type of reference</th><th>Beschreibung</th></tr>
</thead>
<tbody>
<tr><td>C5</td><td>Relative</td><td>Reference is to the relative location of cell C5, depending on the location of the cell in which the reference is first used</td></tr>
<tr><td>$C$5</td><td>Absolute</td><td>Reference is absolute. Will always refer to cell C5 no matter where it is used.</td></tr>
<tr><td>$C5</td><td>Mixed</td><td>Reference is always to column C, but the row reference is relative to the location of the cell in which the reference is first used.</td></tr>
<tr><td>C$5</td><td>Mixed</td><td>Reference is always to row 5, but the column reference is relative to the location of the cell in which the reference is first used</td></tr>
<tr><td>Cell name</td><td>Absolute</td><td>Reference is absolute. Will always refer to the <a href="/docs/de/ViewPro/method-list.html#vp-add-range-name">named cell or range</a> no matter where the reference is used.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="built-in-functions"></a><a href="#built-in-functions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Built-in functions</h2>
<p>Spreadsheet functions are preset formulas used to calculate cell values. When you type the first letter of the function to enter, a pop-up menu listing the available functions and references appears, allowing you to select the desired elements:</p>
<p><img src="/docs/assets/en/ViewPro/vpFormula2.PNG" alt=""></p>
<p>See <a href="https://www.grapecity.com/spreadjs/docs/v14/online/FormulaFunctions.html"><strong>SpreadJS's extented list of functions</strong></a> for details and examples.</p>
<h2><a class="anchor" aria-hidden="true" id="4d-functions"></a><a href="#4d-functions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4D functions</h2>
<p>4D View Pro allows you to define and call <strong>4D custom functions</strong>, which execute <a href="/docs/de/API/FunctionClass.html">4D formulas</a>. Using 4D custom functions extends the possibilities of your 4D View Pro documents and allows powerful interactions with the 4D database.</p>
<p>4D custom functions provide access, from within your 4D View Pro formulas, to:</p>
<ul>
<li>4D process variables,</li>
<li>fields,</li>
<li>project methods,</li>
<li>4D language commands,</li>
<li>or any valid 4D expression.</li>
</ul>
<p>4D custom functions can receive <a href="#parameters">parameters</a> from the 4D View Pro area, and return values.</p>
<p>You declare all your functions using the <a href="/docs/de/ViewPro/method-list.html#vp-set-custom-functions"><code>VP SET CUSTOM FUNCTIONS</code></a> method. Beispiele:</p>
<pre><code class="hljs css language-4d">o:=New object

<span class="hljs-comment">//Name of the function in 4D View Pro: "DRIVERS_LICENCE"</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=New object

<span class="hljs-comment">//process variable</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicence)

<span class="hljs-comment">//table field</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>([Users]DriverLicence)

<span class="hljs-comment">//project method</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicenceState)

<span class="hljs-comment">//4D command</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Choose</span>(DriverLicence; <span class="hljs-string">"Obtained"</span>; <span class="hljs-string">"Failed"</span>))

<span class="hljs-comment">//4D expression and parameter</span>
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(ds.Users.<span class="hljs-function">get</span>(<span class="hljs-variable">$1</span>).DriverLicence)
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters:=New collection
<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>; <span class="hljs-string">"ID"</span>; <span class="hljs-string">"type"</span>; Is longint))
</code></pre>
<blockquote>
<p><strong>See also</strong> <a href="https://blog.4d.com/4d-view-pro-use-4d-formulas-in-your-spreadsheet/">4D View Pro: Use 4D formulas in your spreadsheet (blog post)</a></p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="hello-world-example"></a><a href="#hello-world-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hello World example</h3>
<p>We want to print &quot;Hello World&quot; in a 4D View Pro area cell using a 4D project method:</p>
<ol>
<li>Create a &quot;myMethod&quot; project method with the following code:</li>
</ol>
<pre><code class="hljs css language-4d"> #DECLARE-&gt;<span class="hljs-variable">$hw Text</span>
 <span class="hljs-variable">$hw</span>:=<span class="hljs-string">"Hello World"</span>

</code></pre>
<ol start="2">
<li>Execute the following code before opening any form that contains a 4D View Pro area:</li>
</ol>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">  Case of</span>
    :(Form event code=On Load)<span class="hljs-keyword">
       var</span> <span class="hljs-variable">$o </span>: Object
       <span class="hljs-variable">$o</span>:=New object
  <span class="hljs-comment">// Define "vpHello" function from the "myMethod" method</span>
       <span class="hljs-variable">$o</span>.vpHello:=New object
       <span class="hljs-variable">$o</span>.vpHello.formula:=<span class="hljs-function">Formula</span>(myMethod)
<span class="hljs-function">       VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>;<span class="hljs-variable">$o</span>)<span class="hljs-keyword">
 End case</span>
</code></pre>
<ol start="3">
<li><p>Edit the content of a cell in a 4D View Pro area and type:</p>
<p><img src="/docs/assets/en/ViewPro/vpProjMeth1.PNG" alt=""></p>
<p>&quot;myMethod&quot; is then called by 4D and the cell displays:</p>
<p><img src="/docs/assets/en/ViewPro/vpProjMeth2.PNG" alt=""></p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="parameter"></a><a href="#parameter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameter</h3>
<p>Parameters can be passed to 4D functions that call project methods using the following syntax:</p>
<pre><code class="hljs">=METHODNAME(param1,param2,...,paramN)
</code></pre>
<p>These parameters are received in <em>methodName</em> in $1, $2...$N.</p>
<p>Note that the ( ) are mandatory, even if no parameters are passed:</p>
<pre><code class="hljs">=METHODWITHOUTNAME()
</code></pre>
<p>You can declare the name, type, and number of parameters through the <em>parameters</em> collection of the function you declared using the <a href="/docs/de/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> method. Optionally, you can control the number of parameters passed by the user through <em>minParams</em> and <em>maxParams</em> properties.</p>
<p>For more information on supported incoming parameter types, please refer to the <a href="/docs/de/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> method description.</p>
<blockquote>
<p>If you do not declare parameters, values can be sequentially passed to methods (they will be received in $1, $2...) and their type will be automatically converted. Dates in <em>jstype</em> will be passed as <a href="/docs/de/Concepts/object.html">object</a> in 4D code with two properties:<br>
|Property|    Type|   Description| |---|---|---| |value|   Date|   Date value| |time |Real|  Time in seconds|</p>
</blockquote>
<p>4D project methods can also return values in the 4D View Pro cell formula via $0. The following data types are supported for returned parameters:</p>
<ul>
<li><p><a href="/docs/de/Concepts/string.html">text</a> (converted to string in 4D View Pro)</p></li>
<li><p><a href="/docs/de/Concepts/number.html">real</a>/<a href="/docs/de/Concepts/number.html">longint</a> (converted to number in 4D View Pro)</p></li>
<li><p><a href="/docs/de/Concepts/date.html">date</a> (converted to JS Date type in 4D View Pro - hour, minute, sec = 0)</p></li>
<li><p><a href="/docs/de/Concepts/time.html">time</a> (converted to JS Date type in 4D View Pro - date in base date, i.e. 12/30/1899)</p></li>
<li><p><a href="/docs/de/Concepts/boolean.html">boolean</a> (converted to bool in 4D View Pro)</p></li>
<li><p><a href="/docs/de/Concepts/picture.html">picture</a> (jpg,png,gif,bmp,svg other types converted into png) creates a URI (data:image/png;base64,xxxx) and then used as the background in 4D View Pro in the cell where the formula is executed</p></li>
<li><p><a href="/docs/de/Concepts/object.html">object</a> with the following two properties (allowing passing a date and time):</p>
<table>
<thead>
<tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr>
</thead>
<tbody>
<tr><td>value</td><td>Datum</td><td>Datumswert</td></tr>
<tr><td>time</td><td>Zahl</td><td>Time in seconds</td></tr>
</tbody>
</table>
</li>
</ul>
<p>If the 4D method returns nothing, an empty string is automatically returned.</p>
<p>An error is returned in the 4D View Pro cell if:</p>
<ul>
<li>the 4D method returns another type other than those listed above,</li>
<li>an error occurred during 4D method execution (when user clicks on &quot;abort&quot; button).</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="beispiel"></a><a href="#beispiel" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Beispiel</h4>
<pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$o </span>: Object

<span class="hljs-variable">$o</span>.BIRTH_INFORMATION:=New object
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.formula:=<span class="hljs-function">Formula</span>(BirthInformation)
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters:=New collection
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"First name"</span>;<span class="hljs-string">"type"</span>;Is text))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Birthday"</span>;<span class="hljs-string">"type"</span>;Is date))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Time of birth"</span>;<span class="hljs-string">"type"</span>;Is time))
<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.summary:=<span class="hljs-string">"Returns a formatted string from given information"</span>

<span class="hljs-function">VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>; <span class="hljs-variable">$o</span>)
</code></pre>
<p><img src="/docs/assets/en/ViewPro/params.PNG" alt=""></p>
<h2><a class="anchor" aria-hidden="true" id="compatibility"></a><a href="#compatibility" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compatibility</h2>
<p>Alternate solutions are available to declare fields or methods as functions in your 4D View Pro areas. These solutions are maintained for compatibility reasons and can be used in specific cases. However, using the <a href="/docs/de/ViewPro/method-list.html#vp-set-custom-functions"><code>VP SET CUSTOM FUNCTIONS</code></a> method is recommended.</p>
<h3><a class="anchor" aria-hidden="true" id="referencing-fields-using-the-virtual-structure"></a><a href="#referencing-fields-using-the-virtual-structure" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Referencing fields using the virtual structure</h3>
<p>4D View Pro allows you to reference 4D fields using the virtual structure of the database, i.e. declared through the <a href="https://doc.4d.com/4dv19/help/command/en/page601.html"><code>SET TABLE TITLES</code></a> and/or <a href="https://doc.4d.com/4dv19/help/command/en/page602.html"><code>SET FIELD TITLES</code></a> commands with the * parameter. This alternate solution could be useful if your application already relies on a virtual structure (otherwise, <a href="#4d-functions">using <code>VP SET CUSTOM FUNCTIONS</code></a> is recommended).</p>
<blockquote>
<p><strong>WARNING:</strong> You cannot use the virtual structure and <code>VP SET CUSTOM FUNCTIONS</code> simultaneously. As soon as <code>VP SET CUSTOM FUNCTIONS</code> is called, the functions based upon <code>SET TABLE TITLES</code> and <code>SET FIELD TITLES</code> commands are ignored in the 4D View Pro area.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="requirements"></a><a href="#requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h4>
<ul>
<li>The field must belong to the virtual structure of the database, i.e. it must be declared through the <a href="https://doc.4d.com/4dv19/help/command/en/page601.html"><code>SET TABLE TITLES</code></a> and/or <a href="https://doc.4d.com/4dv19/help/command/en/page602.html"><code>SET FIELD TITLES</code></a> commands with the * parameter (see example),</li>
<li>Table and field names must be ECMA compliant (see <a href="https://www.ecma-international.org/ecma-262/5.1/#sec-7.6">ECMA Script standard</a>),</li>
<li>The field type must be supported by 4D View Pro (see above).</li>
</ul>
<p>An error is returned in the 4D View Pro cell if the formula calls a field which is not compliant.</p>
<h4><a class="anchor" aria-hidden="true" id="calling-a-virtual-field-in-a-formula"></a><a href="#calling-a-virtual-field-in-a-formula" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Calling a virtual field in a formula</h4>
<p>To insert a reference to a virtual field in a formula, enter the field with the following syntax:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">TABLENAME_FIELDNAME</span><span class="hljs-params">()</span></span>
</code></pre>
<p>For example, if you declared the &quot;Name&quot; field of the &quot;People&quot; table in the virtual structure, you can call the following functions:</p>
<pre><code class="hljs">=PEOPLE_NAME()
=<span class="hljs-built_in">LEN</span>(PEOPLE_NAME())
</code></pre>
<blockquote>
<p>If a field has the same name as a [4D method], it takes priority over the method.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="beispiel-1"></a><a href="#beispiel-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Beispiel</h4>
<p>We want to print the name of a person in a 4D View Pro area cell using a 4D virtual field:</p>
<ol>
<li>Create an &quot;Employee&quot; table with a &quot;L_Name&quot; field:</li>
</ol>
<p><img src="/docs/assets/en/ViewPro/vpFieldMeth1.PNG" alt=""></p>
<ol start="2">
<li><p>Execute the following code to initialize a virtual structure:</p>
<pre><code class="hljs css language-4d"><span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-number">1</span>)
<span class="hljs-function">ARRAY LONGINT</span>(<span class="hljs-variable">$tableNum</span>;<span class="hljs-number">1</span>)
<span class="hljs-variable">$tableTitles{1}</span>:=<span class="hljs-string">"Emp"</span>
<span class="hljs-variable">$tableNum{1}</span>:=<span class="hljs-number">2</span>
<span class="hljs-function">SET TABLE TITLES</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-variable">$tableNum</span>;*)

<span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-number">1</span>)
<span class="hljs-function">ARRAY LONGINT</span>(<span class="hljs-variable">$fieldNum</span>;<span class="hljs-number">1</span>)
<span class="hljs-variable">$fieldTitles{1}</span>:=<span class="hljs-string">"Name"</span>
<span class="hljs-variable">$fieldNum{1}</span>:=<span class="hljs-number">2</span> <span class="hljs-comment">//last name</span>
<span class="hljs-function">SET FIELD TITLES</span>([Employee];<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-variable">$fieldNum</span>;*)
</code></pre></li>
<li><p>Edit the content of a cell in the 4D View Pro area and enter &quot;=e&quot;:</p></li>
</ol>
<p><img src="/docs/assets/en/ViewPro/vpFieldMeth2.PNG" alt=""></p>
<ol start="4">
<li>Select EMP_NAME (use the Tab key) and enter the closing ).</li>
</ol>
<p><img src="/docs/assets/en/ViewPro/vpFieldMeth3.PNG" alt=""></p>
<ol start="5">
<li>Validate the field to display the name of the current employee:</li>
</ol>
<p><img src="/docs/assets/en/ViewPro/vpFieldMeth4.PNG" alt=""></p>
<blockquote>
<p>The [Employee] table must have a current record.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="declaring-allowed-methods"></a><a href="#declaring-allowed-methods" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Declaring allowed methods</h3>
<p>You can call directly 4D project methods from within your 4D View Pro formulas. For security reasons, you must declare explicitly methods that can be called by the user with the <a href="/docs/de/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> method.</p>
<h4><a class="anchor" aria-hidden="true" id="requirements-1"></a><a href="#requirements-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h4>
<p>To be called in a 4D View Pro formula, a project method must be:</p>
<ul>
<li><strong>Allowed</strong>: it was explicitly declared using the <a href="/docs/de/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> method.</li>
<li><strong>Runnable</strong>: it belongs to the host project or a loaded component with the &quot;Shared by components and host project&quot; option enabled (see <a href="/docs/de/Concepts/components.html#sharing-of-project-methods">Sharing of project methods</a>).</li>
<li><strong>Not in conflict</strong> with an existing 4D View Pro spreadsheet function: if you call a project method with the same name as a 4D View Pro built-in function, the function is called.</li>
</ul>
<blockquote>
<blockquote>
<blockquote>
<p>If neither the <a href="/docs/de/ViewPro/method-list.html#vp-set-custom-functions">VP SET CUSTOM FUNCTIONS</a> nor the <a href="/docs/de/ViewPro/method-list.html#vp-set-allowed-methods">VP SET ALLOWED METHODS</a> method has been executed during the session, 4D View Pro custom functions rely on allowed methods defined by 4D's generic <code>SET ALLOWED METHODS</code> command. In this case, the project method names must comply with JavaScript Identifier Grammar (see <a href="https://www.ecma-international.org/ecma-262/5.1/#sec-7.6">ECMA Script standard</a>). The global filtering option in the Settings dialog box (see <em>Data Access</em>) is ignored in all cases.</p>
</blockquote>
</blockquote>
</blockquote>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/de/ViewPro/configuring.html"><span class="arrow-prev">← </span><span>Configuring 4D View Pro Areas</span></a><a class="docs-next button" href="/docs/de/ViewPro/method-list.html"><span>Method List</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#using-formulas">Using formulas</a><ul class="toc-headings"><li><a href="#entering-formulas">Entering formulas</a></li><li><a href="#operators-and-operands">Operators and Operands</a></li></ul></li><li><a href="#values-and-operators">Values and operators</a><ul class="toc-headings"><li><a href="#comparison-operators">Comparison operators</a></li><li><a href="#operator-precedence">Operator precedence</a></li></ul></li><li><a href="#cell-references">Cell references</a><ul class="toc-headings"><li><a href="#reference-notation">Reference Notation</a></li></ul></li><li><a href="#built-in-functions">Built-in functions</a></li><li><a href="#4d-functions">4D functions</a><ul class="toc-headings"><li><a href="#hello-world-example">Hello World example</a></li><li><a href="#parameter">Parameter</a></li></ul></li><li><a href="#compatibility">Compatibility</a><ul class="toc-headings"><li><a href="#referencing-fields-using-the-virtual-structure">Referencing fields using the virtual structure</a></li><li><a href="#declaring-allowed-methods">Declaring allowed methods</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://www.4d.com" class="nav-home"><img src="/docs/img/logohome.png" alt="4D Documentation"/></a><div><h5>Community</h5><a href="https://developer.4D.com">4D Developer Center</a><a href="https://blog.4d.com/">4D Blog</a><a href="https://discuss.4d.com">4D Forum</a><a href="https://www.facebook.com/4Dsoftware/">Facebook</a><a href="https://twitter.com/4Dsoftware">Twitter</a><a href="https://www.youtube.com/user/4Dsoftware">Youtube</a><a href="https://github.com/4D/">GitHub</a></div><div><h5>Support</h5><a href="https://doc.4d.com/">4D Doc Center <i>(Where It All Began)</i></a><a href="http://kb.4d.com/">Knowledge Base</a><a href="https://us.4d.com/product-download">Downloads</a><a href="https://us.4d.com/resources">Resources</a><a href="https://us.4d.com/4d-technical-support">Get Support</a></div><div><h5>Company</h5><a href="https://us.4d.com/about-us">About 4D</a><a href="https://us.4d.com/contact-us">Contact us</a><a href="https://us.4d.com/4d-around-the-world">4D around the world</a><a href="https://us.4d.com/careers">Careers</a></div></section><section class="copyright">© 2022 4D SAS - All rights reserved</section><section class="copyright"><a class="cp2" href="https://us.4d.com/terms-and-conditions">Terms &amp; Conditions</a> | <a class="cp2" href="https://us.4d.com/legal-notices">Legal Notices</a> | <a class="cp2" href="https://us.4d.com/data-policy">Data Policy</a> | <a class="cp2" href="https://us.4d.com/cookies-policy">Cookie Policy</a> | <a class="cp2" href="https://us.4d.com/license-0">Product license</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2f94e2c8270ac2b1db0c23691592fb10',
                indexName: '4d',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:de","version:19 R4 BETA"]}
              });
            </script></body></html>