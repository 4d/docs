"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[20600],{603905:(t,e,a)=>{a.d(e,{Zo:()=>s,kt:()=>u});var n=a(667294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function p(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var m=n.createContext({}),o=function(t){var e=n.useContext(m),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},s=function(t){var e=o(t.components);return n.createElement(m.Provider,{value:e},t.children)},d={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},c=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,m=t.parentName,s=p(t,["components","mdxType","originalType","parentName"]),c=o(a),u=r,k=c["".concat(m,".").concat(u)]||c[u]||d[u]||l;return a?n.createElement(k,i(i({ref:e},s),{},{components:a})):n.createElement(k,i({ref:e},s))}));function u(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,i=new Array(l);i[0]=c;var p={};for(var m in e)hasOwnProperty.call(e,m)&&(p[m]=e[m]);p.originalType=t,p.mdxType="string"==typeof t?t:r,i[1]=p;for(var o=2;o<l;o++)i[o]=a[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},922885:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>p,default:()=>c,frontMatter:()=>i,metadata:()=>m,toc:()=>s});a(667294);var n=a(603905);function r(){return r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},r.apply(this,arguments)}function l(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}const i={id:"MailAttachmentClass",title:"MailAttachment"},p=void 0,m={unversionedId:"API/MailAttachmentClass",id:"version-20-R5/API/MailAttachmentClass",title:"MailAttachment",description:"Attachment objects allow referencing files within a Email object. Attachment objects are created using the MAIL New attachment command.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R5/API/MailAttachmentClass.md",sourceDirName:"API",slug:"/API/MailAttachmentClass",permalink:"/docs/fr/API/MailAttachmentClass",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FMailAttachmentClass.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"MailAttachmentClass",title:"MailAttachment"},sidebar:"docs",previous:{title:"IMAPTransporter",permalink:"/docs/fr/API/IMAPTransporterClass"},next:{title:"POP3Transporter",permalink:"/docs/fr/API/POP3TransporterClass"}},o={},s=[{value:"Objet Attachment",id:"objet-attachment",level:3},{value:"MAIL New attachment",id:"mail-new-attachment",level:2},{value:"Description",id:"description",level:4},{value:"Exemple 1",id:"exemple-1",level:4},{value:"Exemple 2",id:"exemple-2",level:4},{value:"4D.MailAttachment.new()",id:"4dmailattachmentnew",level:2},{value:"Description",id:"description-1",level:4},{value:".cid",id:"cid",level:2},{value:"Description",id:"description-2",level:4},{value:".disposition",id:"disposition",level:2},{value:"Description",id:"description-3",level:4},{value:".getContent()",id:"getcontent",level:2},{value:"Description",id:"description-4",level:4},{value:".name",id:"name",level:2},{value:"Description",id:"description-5",level:4},{value:".path",id:"path",level:2},{value:"Description",id:"description-6",level:4},{value:".platformPath",id:"platformpath",level:2},{value:"Description",id:"description-7",level:4},{value:".size",id:"size",level:2},{value:"Description",id:"description-8",level:4},{value:".type",id:"type",level:2},{value:"Description",id:"description-9",level:4}],d={toc:s};function c(t){var{components:e}=t,a=l(t,["components"]);return(0,n.kt)("wrapper",r({},d,a,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Attachment objects allow referencing files within a ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"Email"))," object. Attachment objects are created using the ",(0,n.kt)("a",r({parentName:"p"},{href:"#mail-new-attachment"}),(0,n.kt)("inlineCode",{parentName:"a"},"MAIL New attachment"))," command."),(0,n.kt)("h3",r({},{id:"objet-attachment"}),"Objet Attachment"),(0,n.kt)("p",null,"Les objets Attachment fournissent les propri\xe9t\xe9s et fonctions suivantes en lecture seule :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null})))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#cid"}),(0,n.kt)("strong",{parentName:"a"},".cid")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp; the ID of the attachment")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#disposition"}),(0,n.kt)("strong",{parentName:"a"},".disposition")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the value of the ",(0,n.kt)("inlineCode",{parentName:"td"},"Content-Disposition")," header")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getcontent"}),(0,n.kt)("strong",{parentName:"a"},".getContent()")," : 4D.Blob"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;returns the contents of the attachment object in a ",(0,n.kt)("inlineCode",{parentName:"td"},"4D.Blob")," object")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#name"}),(0,n.kt)("strong",{parentName:"a"},".name")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the name and extension of the attachment")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#path"}),(0,n.kt)("strong",{parentName:"a"},".path")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the POSIX path of the attachment file, if it exists")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#platformpath"}),(0,n.kt)("strong",{parentName:"a"},".platformPath")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the path of the attachment file expressed with the current platform syntax")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#size"}),(0,n.kt)("strong",{parentName:"a"},".size")," : Integer"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the value of the ",(0,n.kt)("inlineCode",{parentName:"td"},"size")," header of the attachment file")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#type"}),(0,n.kt)("strong",{parentName:"a"},".type")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;the ",(0,n.kt)("inlineCode",{parentName:"td"},"content-type")," of the attachment file")))),(0,n.kt)("h2",r({},{id:"mail-new-attachment"}),"MAIL New attachment"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19 R2"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Accepte 4D.File, 4D.ZipFile, 4D.Blob"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"MAIL New attachment"),"( ",(0,n.kt)("em",{parentName:"p"},"file")," : 4D.File { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"MAIL New attachment"),"( ",(0,n.kt)("em",{parentName:"p"},"zipFile")," : 4D.ZipFile { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"MAIL New attachment"),"( ",(0,n.kt)("em",{parentName:"p"},"blob")," : 4D.Blob { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"MAIL New attachment"),"( ",(0,n.kt)("em",{parentName:"p"},"path")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"file"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.File"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fichier joint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"zipFile"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.ZipFile"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fichier Zip joint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"blob"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.Blob"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Blob contenant la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"path"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Chemin de la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom + extension utilis\xe9s par le client de messagerie pour d\xe9signer la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"cid"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'ID de la pi\xe8ce jointe (messages HTML uniquement) ou " " si aucun cid n\'est requis')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Valeur de l'en-t\xeate content-type")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"disposition"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Valeur de l\'en-t\xeate content-disposition : "inline" ou "attachment"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.MailAttachment"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet pi\xe8ce jointe")))),(0,n.kt)("h4",r({},{id:"description"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"MAIL New attachment")," command allows you to create an attachment object that you can add to an ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass#email-object"}),"Email object"),"."),(0,n.kt)("p",null,"Pour d\xe9finir l'objet attachment, vous pouvez utiliser :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"a ",(0,n.kt)("em",{parentName:"li"},"file"),", pass a ",(0,n.kt)("inlineCode",{parentName:"li"},"4D.File")," object containing the attachment file."),(0,n.kt)("li",{parentName:"ul"},"a ",(0,n.kt)("em",{parentName:"li"},"zipfile"),", pass a ",(0,n.kt)("inlineCode",{parentName:"li"},"4D.ZipFile")," object containing the attachment file."),(0,n.kt)("li",{parentName:"ul"},"a ",(0,n.kt)("em",{parentName:"li"},"blob"),", pass a ",(0,n.kt)("inlineCode",{parentName:"li"},"4D.Blob")," object containing the attachment itself."),(0,n.kt)("li",{parentName:"ul"},"a ",(0,n.kt)("em",{parentName:"li"},"path"),", pass a ",(0,n.kt)("strong",{parentName:"li"},"text")," value containing the path of the attachment file, expressed with the system syntax. Vous pouvez passer un nom de chemin complet ou un simple nom de fichier (auquel cas 4D recherchera le fichier dans le m\xeame r\xe9pertoire que le fichier du projet).")),(0,n.kt)("p",null,"The optional ",(0,n.kt)("em",{parentName:"p"},"name")," parameter lets you pass the name and extension to be used by the mail client to designate the attachment. If ",(0,n.kt)("em",{parentName:"p"},"name")," is omitted and:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"vous avez pass\xe9 un chemin d'acc\xe8s au fichier, le nom et l'extension du fichier sont utilis\xe9s,"),(0,n.kt)("li",{parentName:"ul"},"vous avez pass\xe9 un BLOB, un nom al\xe9atoire sans extension est automatiquement g\xe9n\xe9r\xe9.")),(0,n.kt)("p",null,"The optional ",(0,n.kt)("em",{parentName:"p"},"cid")," parameter lets you pass an internal ID for the attachment. This ID is the value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"Content-Id")," header, it will be used in HTML messages only. The cid associates the attachment with a reference defined in the message body using an HTML tag such as ",(0,n.kt)("inlineCode",{parentName:"p"},'\\<img src="cid:ID">'),". Cela signifie que le contenu de la pi\xe8ce jointe (par exemple, une image) doit \xeatre affich\xe9 dans le message sur le client de messagerie. Le r\xe9sultat final peut varier en fonction du client de messagerie. You can pass an empty string in ",(0,n.kt)("em",{parentName:"p"},"cid")," if you do not want to use this parameter."),(0,n.kt)("p",null,"You can use the optional ",(0,n.kt)("em",{parentName:"p"},"type")," parameter to explicitly set the ",(0,n.kt)("inlineCode",{parentName:"p"},"content-type"),' of the attachment file. Par exemple, vous pouvez passer une cha\xeene d\xe9finissant un type MIME ("video/mpeg"). Cette valeur de content-type sera d\xe9finie pour la pi\xe8ce jointe, quelle que soit son extension. For more information about MIME types, please refer to the ',(0,n.kt)("a",r({parentName:"p"},{href:"https://en.wikipedia.org/wiki/MIME"}),"MIME type page on Wikipedia"),"."),(0,n.kt)("p",null,"By default, if the ",(0,n.kt)("em",{parentName:"p"},"type")," parameter is omitted or contains an empty string, the ",(0,n.kt)("inlineCode",{parentName:"p"},"content-type")," of the attachment file is based on its extension. Les r\xe8gles suivantes sont appliqu\xe9es pour les principaux types MIME :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Extension"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Content Type"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"jpg, jpeg"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"image/jpeg")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"png"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"image/png")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"gif"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"image/gif")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"pdf"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/pdf")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"doc"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/msword")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"xls"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/vnd.ms-excel")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ppt"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/vnd.ms-powerpoint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"zip"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/zip")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"gz"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/gzip")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"json"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/json")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"js"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/javascript")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ps"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/postscript")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"xml"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/xml")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"htm, html"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text/html")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mp3"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"audio/mpeg")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"td"},"other")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"application/octet-stream")))),(0,n.kt)("p",null,"The optional ",(0,n.kt)("em",{parentName:"p"},"disposition")," parameter lets you pass the ",(0,n.kt)("inlineCode",{parentName:"p"},"content-disposition"),' header of the attachment. Vous pouvez passer l\'une des constantes suivantes du th\xe8me de constantes "Mail" :'),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constante"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail disposition attachment"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"attachment"'),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'D\xe9finissez la valeur de l\'en-t\xeate Content-disposition sur "attachment", ce qui signifie que le fichier joint doit \xeatre fourni sous forme de lien dans le message.')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail disposition inline"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"inline"'),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'D\xe9finissez la valeur de l\'en-t\xeate Content-disposition sur "inline", ce qui signifie que la pi\xe8ce jointe doit \xeatre rendue dans le contenu du message, \xe0 l\'emplacement du "cid". Le rendu d\xe9pend du client de messagerie.')))),(0,n.kt)("p",null,"By default, if the ",(0,n.kt)("em",{parentName:"p"},"disposition")," parameter is omitted:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"if the ",(0,n.kt)("em",{parentName:"li"},"cid")," parameter is used, the ",(0,n.kt)("inlineCode",{parentName:"li"},"Content-disposition"),' header is set to "inline",'),(0,n.kt)("li",{parentName:"ul"},"if the ",(0,n.kt)("em",{parentName:"li"},"cid")," parameter is not passed or empty, the ",(0,n.kt)("inlineCode",{parentName:"li"},"Content-disposition"),' header is set to "attachment".')),(0,n.kt)("h4",r({},{id:"exemple-1"}),"Exemple 1"),(0,n.kt)("p",null,"Vous souhaitez envoyer un e-mail avec un fichier s\xe9lectionn\xe9 par l'utilisateur comme pi\xe8ce jointe et une image int\xe9gr\xe9e dans le corps HTML :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'$doc:=Select document("";"*";"Please select a file to attach";0)\nIf (OK=1) //If a document was selected\n\nC_OBJECT($email;$server;$transporter)\n\n$server:=New object\n$server.host:="smtp.mail.com"\n$server.user:="test_user@mail.com"\n$server.password:="p@ssw@rd"\n$transporter:=SMTP New transporter($server)\n\n$email:=New object\n$email.from:="test_user@mail.com"\n$email.to:="test_user@mail.com"\n$email.subject:="This is a test message with attachments"\n\n//add a link to download file\n$email.attachments:=New collection(MAIL New attachment(Document))\n//insert an inline picture (use a cid)\n$email.attachments[1]:=MAIL New attachment("c:\\\\Pictures\\\\4D.jpg";"";"4D")\n\n$email.htmlBody:="<html>"+\\\n"<body>Hello World!"+\\\n"<img src=\'cid:4D\' >"+\\\n"</body>"+\\\n"</head>"+\\\n"</html>"\n\n$transporter.send($email) //send mail\n\nEnd if\n')),(0,n.kt)("h4",r({},{id:"exemple-2"}),"Exemple 2"),(0,n.kt)("p",null,"Vous voulez envoyer un e-mail avec une zone 4D Write Pro en pi\xe8ce jointe :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'C_BLOB($blob)\nWP EXPORT VARIABLE(WPArea;$blob;wk docx)\n\nC_OBJECT($email;$server;$transporter)\n\n$server:=New object\n$server.host:="smtp.mail.com"\n$server.user:="user@mail.com"\n$server.password:="p@ssw@rd"\n$transporter:=SMTP New transporter($server)\n\n$email:=New object\n$email.from:="user@mail.com"\n$email.to:="customer@mail.com"\n$email.subject:="New annual report"\n$email.textBody:="Please find enclosed our latest annual report."\n$email.attachments:=New collection(MAIL New attachment($blob;"Annual report.docx"))\n\n$transporter.send($email)\n')),(0,n.kt)("h2",r({},{id:"4dmailattachmentnew"}),"4D.MailAttachment.new()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19 R2"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Accepte 4D.File, 4D.ZipFile, 4D.Blob"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"4D.MailAttachment.new"),"( ",(0,n.kt)("em",{parentName:"p"},"file")," : 4D.File { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"4D.MailAttachment.new"),"( ",(0,n.kt)("em",{parentName:"p"},"zipFile")," : 4D.ZipFile { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"4D.MailAttachment.new"),"( ",(0,n.kt)("em",{parentName:"p"},"blob")," : 4D.Blob { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},"4D.MailAttachment.new"),"( ",(0,n.kt)("em",{parentName:"p"},"path")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"name")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"cid")," : Text{ ; ",(0,n.kt)("em",{parentName:"p"},"type")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"disposition")," :Text } } } } ) : 4D.MailAttachment"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"file"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.File"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fichier joint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"zipFile"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.ZipFile"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fichier Zip joint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"blob"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.Blob"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Blob contenant la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"path"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Chemin de la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom + extension utilis\xe9s par le client de messagerie pour d\xe9signer la pi\xe8ce jointe")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"cid"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'ID de la pi\xe8ce jointe (messages HTML uniquement) ou " " si aucun cid n\'est requis')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Valeur de l'en-t\xeate content-type")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"disposition"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Valeur de l\'en-t\xeate content-disposition : "inline" ou "attachment"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.MailAttachment"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet pi\xe8ce jointe")))),(0,n.kt)("h4",r({},{id:"description-1"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.MailAttachment.new()")," function creates and returns a new object of the ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.MailAttachment")," type. It is identical to the ",(0,n.kt)("a",r({parentName:"p"},{href:"#mail-new-attachment"}),(0,n.kt)("inlineCode",{parentName:"a"},"MAIL New attachment"))," command (shortcut)."),(0,n.kt)("h2",r({},{id:"cid"}),".cid"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".cid")," : Text"),(0,n.kt)("h4",r({},{id:"description-2"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".cid")," property contains  the ID of the attachment. Cette propri\xe9t\xe9 est utilis\xe9e uniquement dans les messages HTML. Si cette propri\xe9t\xe9 est manquante, le fichier est g\xe9r\xe9 comme une simple pi\xe8ce jointe (lien)."),(0,n.kt)("h2",r({},{id:"disposition"}),".disposition"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".disposition")," : Text"),(0,n.kt)("h4",r({},{id:"description-3"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".disposition")," property contains the value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"Content-Disposition")," header. ."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},'"inline" : la pi\xe8ce jointe est rendue dans le contenu du message, \xe0 l\'emplacement "cid". Le rendu d\xe9pend du client de messagerie.'),(0,n.kt)("li",{parentName:"ul"},'"attachment" : la pi\xe8ce jointe est fournie sous forme de lien dans le message.')),(0,n.kt)("h2",r({},{id:"getcontent"}),".getContent()"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getContent()")," : 4D.Blob"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.Blob"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Contenu de la pi\xe8ce jointe")))),(0,n.kt)("h4",r({},{id:"description-4"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".getContent()")," function returns the contents of the attachment object in a ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.Blob")," object. You can use this method with attachment objects received by the ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass#mail-convert-from-mime"}),(0,n.kt)("inlineCode",{parentName:"a"},"MAIL Convert from MIME"))," command."),(0,n.kt)("h2",r({},{id:"name"}),".name"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".name")," : Text"),(0,n.kt)("h4",r({},{id:"description-5"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".name")," property contains the name and extension of the attachment.  By default, it is the name of the file, unless another name was specified in the ",(0,n.kt)("a",r({parentName:"p"},{href:"#mail-new-attachment"}),(0,n.kt)("inlineCode",{parentName:"a"},"MAIL New attachment"))," command."),(0,n.kt)("h2",r({},{id:"path"}),".path"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".path")," : Text"),(0,n.kt)("h4",r({},{id:"description-6"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".path")," property contains the POSIX path of the attachment file, if it exists."),(0,n.kt)("h2",r({},{id:"platformpath"}),".platformPath"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".platformPath")," : Text"),(0,n.kt)("h4",r({},{id:"description-7"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".platformPath")," property returns the path of the attachment file expressed with the current platform syntax."),(0,n.kt)("h2",r({},{id:"size"}),".size"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".size")," : Integer"),(0,n.kt)("h4",r({},{id:"description-8"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".size")," property contains the value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"size")," header of the attachment file. The ",(0,n.kt)("inlineCode",{parentName:"p"},".size")," property is returned when the MIME message defines a size header in the attachment part."),(0,n.kt)("h2",r({},{id:"type"}),".type"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".type")," : Text"),(0,n.kt)("h4",r({},{id:"description-9"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},".type")," property contains the ",(0,n.kt)("inlineCode",{parentName:"p"},"content-type")," of the attachment file. If this type is not explicitly passed to the ",(0,n.kt)("a",r({parentName:"p"},{href:"#mail-new-attachment"}),(0,n.kt)("inlineCode",{parentName:"a"},"MAIL New attachment"))," command, the ",(0,n.kt)("inlineCode",{parentName:"p"},"content-type")," is based on its file extension."))}c.isMDXComponent=!0}}]);