"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["33962"],{148008:function(e,n,s){s.r(n),s.d(n,{metadata:()=>r,contentTitle:()=>a,default:()=>u,assets:()=>i,toc:()=>l,frontMatter:()=>c});var r=JSON.parse('{"id":"commands-legacy/receive-packet","title":"RECEIVE PACKET","description":"RECEIVE PACKET ( {docRef ;} r\xe9ceptVar ; stopCar | nbOctets )","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R7/commands-legacy/receive-packet.md","sourceDirName":"commands-legacy","slug":"/commands/receive-packet","permalink":"/docs/fr/commands/receive-packet","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Freceive-packet.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"receive-packet","title":"RECEIVE PACKET","slug":"/commands/receive-packet","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"RECEIVE BUFFER","permalink":"/docs/fr/commands/receive-buffer"},"next":{"title":"RECEIVE RECORD","permalink":"/docs/fr/commands/receive-record"}}'),t=s("785893"),d=s("250065");let c={id:"receive-packet",title:"RECEIVE PACKET",slug:"/commands/receive-packet",displayed_sidebar:"docs"},a=void 0,i={},l=[{value:"Description",id:"description",level:4},{value:"Exemple 1",id:"exemple-1",level:4},{value:"Exemple 2",id:"exemple-2",level:4},{value:"Exemple 3",id:"exemple-3",level:4},{value:"Exemple 4",id:"exemple-4",level:4},{value:"Variables et ensembles syst\xe8me",id:"variables-et-ensembles-syst\xe8me",level:4},{value:"Voir aussi",id:"voir-aussi",level:4},{value:"Propri\xe9t\xe9s",id:"propri\xe9t\xe9s",level:4}];function o(e){let n={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," ( {",(0,t.jsx)(n.em,{children:"docRef"})," ;} ",(0,t.jsx)(n.em,{children:"r\xe9ceptVar"})," ; stopCar | nbOctets )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Param\xe8tre"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"docRef"}),(0,t.jsx)(n.td,{children:"Time"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Num\xe9ro de r\xe9f\xe9rence de document ou canal courant (port s\xe9rie ou document)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"r\xe9ceptVar"}),(0,t.jsx)(n.td,{children:"Text, Blob"}),(0,t.jsx)(n.td,{children:"\u2190"}),(0,t.jsx)(n.td,{children:"Variable devant recevoir les donn\xe9es"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"stopCar | nbOctets"}),(0,t.jsx)(n.td,{children:"Cha\xeene, Entier long"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Caract\xe8re(s) au(x)quel(s) stopper la r\xe9ception des donn\xe9es ou Nombre d'octets \xe0 recevoir"})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["La commande ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," lit des caract\xe8res depuis un port s\xe9rie ou un document."]}),"\n",(0,t.jsxs)(n.p,{children:["Si ",(0,t.jsx)(n.em,{children:"docRef"})," est sp\xe9cifi\xe9, la commande r\xe9cup\xe8re des donn\xe9es depuis un document ouvert par la fonction ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/open-document",children:"Open document"}),", ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/create-document",children:"Create document"})," ou ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/append-document",children:"Append document"}),". Si ",(0,t.jsx)(n.em,{children:"docRef"})," est omis, la commande r\xe9cup\xe8re des donn\xe9es depuis un port s\xe9rie ou un document ouvert par la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-channel",children:"SET CHANNEL"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Dans tous les cas, les caract\xe8res lus sont retourn\xe9s dans la variable ",(0,t.jsx)(n.em,{children:"r\xe9ceptVar"}),", qui doit \xeatre une variable de type Texte, Alpha ou BLOB. Si les donn\xe9es ont \xe9t\xe9 envoy\xe9es par la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/send-packet",children:"SEND PACKET"}),", le type doit correspondre \xe0 celui du paquet envoy\xe9."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Si le paquet re\xe7u est de type BLOB, la commande ne tient pas compte du jeu de caract\xe8res \xe9ventuellement d\xe9fini par la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/use-character-set",children:"USE CHARACTER SET"}),". Le BLOB est retourn\xe9 sans aucune modification."]}),"\n",(0,t.jsxs)(n.li,{children:["Si le paquet re\xe7u est de type texte, la commande ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," prend en charge les BOM (Byte Order Mark). Dans ce cas, si le jeu de caract\xe8res courant est de type Unicode (UTF-8, UTF-16 ou UTF-32), 4D tente d\u2019identifier une BOM parmi les premiers octets re\xe7us. Si elle est d\xe9tect\xe9e, elle est filtr\xe9e de la variable ",(0,t.jsx)(n.em,{children:"r\xe9ceptVar"})," et 4D utilise le jeu de caract\xe8res qu\u2019elle d\xe9finit au lieu du jeu de caract\xe8res courant."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Si vous voulez recevoir un nombre pr\xe9d\xe9fini d'octets, passez ce nombre dans le param\xe8tre ",(0,t.jsx)(n.em,{children:"nbOctets"}),". Si la variable ",(0,t.jsx)(n.em,{children:"r\xe9ceptVar"})," est de type Texte, vous pouvez lire en un seul appel jusqu'\xe0 2 Go de texte (limite th\xe9orique)."]}),"\n",(0,t.jsxs)(n.p,{children:["Si vous voulez recevoir des donn\xe9es jusqu'\xe0 ce qu'une cha\xeene de caract\xe8res (comportant un ou plusieurs caract\xe8res) soit lue, passez-la dans le param\xe8tre ",(0,t.jsx)(n.em,{children:"stopCar"})," (la cha\xeene n'est pas retourn\xe9e dans ",(0,t.jsx)(n.em,{children:"r\xe9ceptVar"}),").",(0,t.jsx)(n.br,{}),"\nDans ce cas, si la cha\xeene de caract\xe8res sp\xe9cifi\xe9e par ",(0,t.jsx)(n.em,{children:"stopCar"})," n'est pas trouv\xe9e :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["lorsque ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," lit un document, l'ex\xe9cution de la commande se terminera \xe0 la fin du document."]}),"\n",(0,t.jsxs)(n.li,{children:["lorsque ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," lit des donn\xe9es en provenance du port s\xe9rie, la commande s'ex\xe9cutera ind\xe9finiment jusqu'\xe0 ce que le d\xe9lai d'attente (s'il est fix\xe9) soit \xe9coul\xe9 (cf. la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-timeout",children:"SET TIMEOUT"}),") ou que l'utilisateur interrompe la r\xe9ception (voir ci-dessous)."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Pendant l'ex\xe9cution d'un ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"}),", l'utilisateur peut interrompre l'op\xe9ration en appuyant sur les touches ",(0,t.jsx)(n.strong,{children:"Ctrl"}),"+",(0,t.jsx)(n.strong,{children:"Alt"}),"+",(0,t.jsx)(n.strong,{children:"Maj"})," (sous Windows) ou ",(0,t.jsx)(n.strong,{children:"Commande"}),"+",(0,t.jsx)(n.strong,{children:"Option"}),"+",(0,t.jsx)(n.strong,{children:"Maj"})," (sous Mac OS). Cette interruption g\xe9n\xe8re une erreur -9994 que vous pouvez intercepter \xe0 l'aide d'une m\xe9thode install\xe9e par la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/on-err-call",children:"ON ERR CALL"}),". G\xe9n\xe9ralement, vous devez g\xe9rer les interruptions d'une r\xe9ception uniquement lors d'une communication s\xe9rie."]}),"\n",(0,t.jsxs)(n.p,{children:["Lors de la lecture d'un document, le premier ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," commence par lire le d\xe9but du document. La lecture des paquets suivants d\xe9bute au caract\xe8re situ\xe9 imm\xe9diatement apr\xe8s le dernier octet lu."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note :"})," Ce fonctionnement est valide avec un document ouvert par ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-channel",children:"SET CHANNEL"}),". Cependant, pour un document ouvert par ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/open-document",children:"Open document"}),", ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/create-document",children:"Create document"})," ou ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/append-document",children:"Append document"}),", vous pouvez aussi utiliser les commandes ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/get-document-position",children:"Get document position"})," et ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-document-position",children:"SET DOCUMENT POSITION"}),"pour conna\xeetre et modifier la position \xe0 laquelle, dans le document, la prochaine \xe9criture (",(0,t.jsx)(n.a,{href:"/docs/fr/commands/send-packet",children:"SEND PACKET"}),") ou lecture (",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"}),") aura lieu."]}),"\n",(0,t.jsxs)(n.p,{children:["En cas de tentative de lecture apr\xe8s la fin d'un document, ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," retourne les donn\xe9es lues jusqu'\xe0 ce point et la variable syst\xe8me OK prend la valeur 1. Les ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"})," suivants retourneront une cha\xeene vide et OK prendra la valeur z\xe9ro."]}),"\n",(0,t.jsx)(n.h4,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,t.jsx)(n.p,{children:"L'exemple suivant lit 20 caract\xe8res depuis un port s\xe9rie et les place dans la variable R\xe9cupVingt :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:"\xa0RECEIVE PACKET(R\xe9cupVingt;20)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,t.jsxs)(n.p,{children:["L'exemple suivant lit des donn\xe9es depuis le document r\xe9f\xe9renc\xe9 par la variable MonDoc et les place dans la variable ",(0,t.jsx)(n.em,{children:"vData"}),". La commande r\xe9cup\xe8re les donn\xe9es jusqu'\xe0 ce qu'elle rencontre un retour chariot :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:"\xa0RECEIVE PACKET(MonDoc;vData;Char(Carriage return))\n"})}),"\n",(0,t.jsx)(n.h4,{id:"exemple-3",children:"Exemple 3"}),"\n",(0,t.jsxs)(n.p,{children:["L'exemple suivant lit des donn\xe9es du document r\xe9f\xe9renc\xe9 par la variable MonDoc et les place dans la variable ",(0,t.jsx)(n.em,{children:"vData"}),". La commande r\xe9cup\xe8re les donn\xe9es jusqu'\xe0 ce qu'elle rencontre une balise HTML de fin de tableau (",(0,t.jsx)(n.em,{}),") :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0RECEIVE PACKET(MonDoc;vData;"")\n'})}),"\n",(0,t.jsx)(n.h4,{id:"exemple-4",children:"Exemple 4"}),"\n",(0,t.jsx)(n.p,{children:"L'exemple suivant lit des donn\xe9es d'un document et les place dans des champs. Les donn\xe9es sont stock\xe9es dans des champs de longueur fixe. La m\xe9thode fait appel \xe0 une sous-routine pour \xe9liminer les espaces superflus (situ\xe9s derri\xe8re les valeurs). Le code de la sous-routine est pr\xe9sent\xe9 apr\xe8s la m\xe9thode :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:"\xa0$Doc :=Open document(\"\";\"TEXT\")\xa0// Ouverture d'un document de type Texte\n\xa0If(OK=1)\xa0// Si le document est ouvert\u2026\n\xa0\xa0\xa0\xa0Repeat\xa0// Boucle jusqu'\xe0 ce qu'il n'y ait plus de donn\xe9es\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0RECEIVE PACKET($Doc;$Var1;15)\xa0// Lecture de 15 caract\xe8res\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0RECEIVE PACKET($Doc;$Var2;15)\xa0// M\xeame chose pour le second champ\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(OK=1)\xa0// Si ce n'est pas la fin du document\u2026\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CREATE RECORD([Personnes])\xa0// Cr\xe9er un nouvel enregistrement\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[Personnes]Pr\xe9nom:=Elimine($Var1)\xa0// Sauvegarder le pr\xe9nom\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[Personnes]Nom:=Elimine($Var2)\xa0// Sauvegarder le nom\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0SAVE RECORD([Personnes])\xa0// Sauvegarder l'enregistrement\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0Until(OK=0)\n\xa0\xa0\xa0\xa0CLOSE DOCUMENT($Doc)\xa0// Fermeture du document\n\xa0End if\n"})}),"\n",(0,t.jsx)(n.p,{children:"Les espaces superflus derri\xe8re les valeurs sont \xe9limin\xe9s par la m\xe9thode suivante, appel\xe9e Elimine :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:"\xa0For($i;Length($1);1;-1)\xa0// Boucle sur la fin de la cha\xeene d'o\xf9 d\xe9marrer\n\xa0\xa0\xa0\xa0If($1[[$i]]#\" \")\xa0// Si ce n'est pas un espace\u2026\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$i :=-$i \xa0// Forcer la boucle \xe0 stopper\n\xa0\xa0\xa0\xa0End if\n\xa0End for\n\xa0$0:=Delete string($1;-$i;Length($1))\xa0// Suppression des espaces\n"})}),"\n",(0,t.jsx)(n.h4,{id:"variables-et-ensembles-syst\xe8me",children:"Variables et ensembles syst\xe8me"}),"\n",(0,t.jsxs)(n.p,{children:["Apr\xe8s un appel \xe0 ",(0,t.jsx)(n.strong,{children:"RECEIVE PACKET"}),", la variable syst\xe8me OK prend la valeur 1 si le paquet est re\xe7u sans erreur. Sinon, OK prend la valeur 0."]}),"\n",(0,t.jsx)(n.h4,{id:"voir-aussi",children:"Voir aussi"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/fr/commands/get-document-position",children:"Get document position"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/receive-buffer",children:"RECEIVE BUFFER"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/send-packet",children:"SEND PACKET"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-document-position",children:"SET DOCUMENT POSITION"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/set-timeout",children:"SET TIMEOUT"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/use-character-set",children:"USE CHARACTER SET"})]}),"\n",(0,t.jsx)(n.h4,{id:"propri\xe9t\xe9s",children:"Propri\xe9t\xe9s"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Num\xe9ro de commande"}),(0,t.jsx)(n.td,{children:"104"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Thread safe"}),(0,t.jsx)(n.td,{children:"\u2713"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Modifie les variables"}),(0,t.jsx)(n.td,{children:"OK"})]})]})]})]})}function u(e={}){let{wrapper:n}={...(0,d.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return c}});var r=s(667294);let t={},d=r.createContext(t);function c(e){let n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);