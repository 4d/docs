"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[47498],{603905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>m});var n=t(667294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=n.createContext({}),l=function(e){var r=n.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},c=function(e){var r=l(e.components);return n.createElement(p.Provider,{value:r},e.children)},d={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},u=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(t),m=a,v=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return t?n.createElement(v,i(i({ref:r},c),{},{components:t})):n.createElement(v,i({ref:r},c))}));function m(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var p in r)hasOwnProperty.call(r,p)&&(s[p]=r[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},234279:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>p,toc:()=>c});t(667294);var n=t(603905);function a(){return a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a.apply(this,arguments)}function o(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const i={id:"advanced-programming",title:"Programmation avanc\xe9e avec Javascript"},s=void 0,p={unversionedId:"ViewPro/advanced-programming",id:"version-20-R4/ViewPro/advanced-programming",title:"Programmation avanc\xe9e avec Javascript",description:"Une zone 4D View Pro est un objet de formulaire de zone Web qui utilise le moteur de rendu Web int\xe9gr\xe9. As such, it behaves just like any other web area, and you can get it to execute Javascript code by calling the WA Evaluate Javascript 4D command.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R4/ViewPro/advanced-programming.md",sourceDirName:"ViewPro",slug:"/ViewPro/advanced-programming",permalink:"/docs/fr/ViewPro/advanced-programming",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20ViewPro%2Fadvanced-programming.md%20(20-R4)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R4",frontMatter:{id:"advanced-programming",title:"Programmation avanc\xe9e avec Javascript"},sidebar:"docs",previous:{title:"Classes",permalink:"/docs/fr/ViewPro/classes"},next:{title:"4D Write Pro Interface",permalink:"/docs/fr/WritePro/writeprointerface"}},l={},c=[{value:"Exemple concret : masquer le ruban",id:"exemple-concret--masquer-le-ruban",level:2},{value:"Appeler des m\xe9thodes JavaScript de SpreadJS",id:"appeler-des-m\xe9thodes-javascript-de-spreadjs",level:2},{value:"Exemple",id:"exemple",level:4},{value:"D\xe9p\xf4t 4D View Pro Tips",id:"d\xe9p\xf4t-4d-view-pro-tips",level:2}],d={toc:c};function u(e){var{components:r}=e,t=o(e,["components"]);return(0,n.kt)("wrapper",a({},d,t,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Une zone 4D View Pro est un ",(0,n.kt)("a",a({parentName:"p"},{href:"/docs/fr/FormObjects/webAreaOverview"}),"objet de formulaire de zone Web")," qui utilise le ",(0,n.kt)("a",a({parentName:"p"},{href:"/docs/fr/FormObjects/propertiesWebArea#use-embedded-web-rendering-engine"}),"moteur de rendu Web int\xe9gr\xe9"),". As such, it behaves just like any other web area, and you can get it to execute Javascript code by calling the ",(0,n.kt)("a",a({parentName:"p"},{href:"https://doc.4d.com/4dv20/help/command/en/page1029.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"WA Evaluate Javascript"))," 4D command."),(0,n.kt)("p",null,"Since 4D View Pro is powered by the ",(0,n.kt)("a",a({parentName:"p"},{href:"https://developer.mescius.com/spreadjs"}),"SpreadJS spreadsheet solution"),", you can also call SpreadJS Javascript methods in 4D View Pro areas."),(0,n.kt)("h2",a({},{id:"exemple-concret--masquer-le-ruban"}),"Exemple concret : masquer le ruban"),(0,n.kt)("p",null,"4D View Pro \xe9tant une zone Web, vous pouvez s\xe9lectionner un \xe9l\xe9ment de page Web et modifier son comportement \xe0 l'aide de Javascript. L'exemple suivant permet de masquer le ",(0,n.kt)("a",a({parentName:"p"},{href:"/docs/fr/ViewPro/configuring#ribbon"}),"ruban")," spreadJS :"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{className:"language-4d"}),"//M\xe9thode objet du bouton\n\nvar $js; $answer : Text\n\n$js:=\"document.getElementsByClassName('ribbon')[0].setAttribute('style','display: none');\"\n\n$js+=\"window.dispatchEvent(new Event('resize'));\"\n\n$answer:=WA Evaluate JavaScript(*; \"ViewProArea\"; $js)\n")),(0,n.kt)("h2",a({},{id:"appeler-des-m\xe9thodes-javascript-de-spreadjs"}),"Appeler des m\xe9thodes JavaScript de SpreadJS"),(0,n.kt)("p",null,"Vous pouvez exploiter la biblioth\xe8que de m\xe9thodes Javascript de SpreadJS et les appeler directement pour g\xe9rer vos feuilles de calcul."),(0,n.kt)("p",null,"4D has a built-in ",(0,n.kt)("inlineCode",{parentName:"p"},"Utils.spread")," property that gives access to the spreadsheet document (also called workbook) inside the 4D View Pro area, making it simpler to call the SpreadJS ",(0,n.kt)("a",a({parentName:"p"},{href:"https://developer.mescius.com/spreadjs/api/modules/GC.Data"}),"Workbook methods"),"."),(0,n.kt)("h4",a({},{id:"exemple"}),"Exemple"),(0,n.kt)("p",null,"Le code suivant annule la derni\xe8re action dans la feuille de calcul :"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'WA Evaluate JavaScript(*; "ViewProArea"; "Utils.spread.undoManager().undo()")\n')),(0,n.kt)("h2",a({},{id:"d\xe9p\xf4t-4d-view-pro-tips"}),"D\xe9p\xf4t 4D View Pro Tips"),(0,n.kt)("p",null,(0,n.kt)("a",a({parentName:"p"},{href:"https://github.com/4d-depot/4D-View-Pro-Tips"}),"4D-View-Pro-Tips")," est un d\xe9p\xf4t GitHub qui contient un projet rempli de fonctions utiles pour vous permettre de g\xe9rer les images flottantes, de trier les colonnes ou les lignes, de cr\xe9er une culture personnalis\xe9e, et bien plus encore ! N'h\xe9sitez pas \xe0 le cloner et \xe0 l'exp\xe9rimenter !"))}u.isMDXComponent=!0}}]);