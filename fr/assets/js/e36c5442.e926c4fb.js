"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["15407"],{671845:function(e,s,n){n.r(s),n.d(s,{default:()=>h,frontMatter:()=>d,metadata:()=>t,assets:()=>a,toc:()=>o,contentTitle:()=>l});var t=JSON.parse('{"id":"API/OutgoingMessageClass","title":"OutgoingMessage","description":"La classe 4D.OutgoingMessage vous permet de construire des messages qui seront renvoy\xe9s par les fonctions de votre application en r\xe9ponse aux requ\xeates REST. Lorsque la r\xe9ponse est de type 4D.OutgoingMessage, le serveur REST ne renvoie pas un objet mais une instance d\'objet de la classe OutgoingMessage.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R8/API/OutgoingMessageClass.md","sourceDirName":"API","slug":"/API/OutgoingMessageClass","permalink":"/docs/fr/20-R8/API/OutgoingMessageClass","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FOutgoingMessageClass.md%20(20-R8)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R8","frontMatter":{"id":"OutgoingMessageClass","title":"OutgoingMessage"},"sidebar":"docs","previous":{"title":"MailAttachment","permalink":"/docs/fr/20-R8/API/MailAttachmentClass"},"next":{"title":"POP3Transporter","permalink":"/docs/fr/20-R8/API/POP3TransporterClass"}}'),r=n("785893"),i=n("250065");let d={id:"OutgoingMessageClass",title:"OutgoingMessage"},l=void 0,a={},o=[{value:"Exemple",id:"exemple",level:3},{value:"Objet OutgoingMessage",id:"objet-outgoingmessage",level:3},{value:".body",id:"body",level:2},{value:"Description",id:"description",level:4},{value:".headers",id:"headers",level:2},{value:"Description",id:"description-1",level:4},{value:".setBody()",id:"setbody",level:2},{value:"Description",id:"description-2",level:4},{value:".setHeader()",id:"setheader",level:2},{value:"Description",id:"description-3",level:4},{value:".setStatus()",id:"setstatus",level:2},{value:"Description",id:"description-4",level:4},{value:".status",id:"status",level:2},{value:"Description",id:"description-5",level:4}];function c(e){let s={a:"a",admonition:"admonition",br:"br",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["La classe ",(0,r.jsx)(s.code,{children:"4D.OutgoingMessage"})," vous permet de construire des messages qui seront renvoy\xe9s par les fonctions de votre application en r\xe9ponse aux ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/REST/REST_requests",children:"requ\xeates REST"}),". Lorsque la r\xe9ponse est de type ",(0,r.jsx)(s.code,{children:"4D.OutgoingMessage"}),", le serveur REST ne renvoie pas un objet mais une instance d'objet de la classe ",(0,r.jsx)(s.code,{children:"OutgoingMessage"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Typiquement, cette classe peut \xeatre utilis\xe9e dans des fonctions personnalis\xe9es de ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/WebServer/http-request-handler#function-configuration",children:"HTTP request handler"})," ou dans des fonctions d\xe9clar\xe9es avec le mot-cl\xe9 ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/ORDA/ordaClasses#onhttpget-keyword",children:(0,r.jsx)(s.code,{children:"onHttpGet"})})," et con\xe7ues pour g\xe9rer des requ\xeates HTTP GET. Ces requ\xeates sont utilis\xe9es, par exemple, pour impl\xe9menter des fonctionnalit\xe9s telles que le t\xe9l\xe9chargement de fichier, la g\xe9n\xe9ration et le t\xe9l\xe9chargement d'images ainsi que la r\xe9ception de tout content-type via un navigateur."]}),"\n",(0,r.jsxs)(s.p,{children:["Une instance de cette classe est construite sur 4D Server et peut \xeatre envoy\xe9e au navigateur via le ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/REST/gettingStarted",children:"serveur REST 4D"})," uniquement. Cette classe permet d'utiliser d'autres technologies que HTTP (par exemple, mobile)."]}),"\n",(0,r.jsxs)(s.details,{children:[(0,r.jsx)(s.summary,{children:"Historique"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Release"}),(0,r.jsx)(s.th,{children:"Modifications"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"20 R7"}),(0,r.jsx)(s.td,{children:"Classe ajout\xe9e"})]})})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"exemple",children:"Exemple"}),"\n",(0,r.jsxs)(s.p,{children:["Dans cet exemple, une fonction ",(0,r.jsx)(s.code,{children:"getFile()"})," est impl\xe9ment\xe9e dans la ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/ORDA/ordaClasses#datastore-class",children:"Datastore class"})," et peut \xeatre ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/ORDA/ordaClasses#onhttpget-keyword",children:"appel\xe9e"})," par une requ\xeate REST. Le but est de retourner un fichier ",(0,r.jsx)(s.strong,{children:"testFile.pdf"})," en r\xe9ponse \xe0 la requ\xeate :"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-4d",children:'Class extends DataStoreImplementation\n\nexposed onHTTPGet Function getFile() : 4D.OutgoingMessage\n	\n	var $result:=4D.OutgoingMessage.new()\n	var $file:=File("/RESOURCES/testFile.pdf")\n	\n	$result.setBody($file.getContent())  // contenu binaire\n	$result.setHeader("Content-Type"; "application/pdf")\n	return $result\n'})}),"\n",(0,r.jsx)(s.h3,{id:"objet-outgoingmessage",children:"Objet OutgoingMessage"}),"\n",(0,r.jsx)(s.p,{children:"Les objets 4D.OutgoingMessage fournissent les propri\xe9t\xe9s et fonctions suivantes :"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsx)(s.tr,{children:(0,r.jsx)(s.th,{})})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#body",children:[(0,r.jsx)(s.strong,{children:"body"})," : any"]}),(0,r.jsx)(s.br,{}),"le body du message sortant"]})}),(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#headers",children:[(0,r.jsx)(s.strong,{children:"headers"})," : Object"]}),(0,r.jsx)(s.br,{}),"les headers courants du message sortant sous forme de paires cl\xe9/valeur"]})}),(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#setbody",children:[(0,r.jsx)(s.strong,{children:".setBody"}),"( ",(0,r.jsx)(s.em,{children:"body"})," : any )"]}),(0,r.jsx)(s.br,{}),"d\xe9finit le ",(0,r.jsx)(s.em,{children:"body"})," du message sortant"]})}),(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#setheader",children:[(0,r.jsx)(s.strong,{children:".setHeader"}),"( ",(0,r.jsx)(s.em,{children:"key"})," : Text ; ",(0,r.jsx)(s.em,{children:"value"})," : Text )"]}),(0,r.jsx)(s.br,{}),"fixe la cl\xe9 ",(0,r.jsx)(s.em,{children:"key"})," du header du message sortant avec la ",(0,r.jsx)(s.em,{children:"value"})," fournie"]})}),(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#setstatus",children:[(0,r.jsx)(s.strong,{children:".setStatus"}),"( ",(0,r.jsx)(s.em,{children:"status"})," : Integer )"]}),(0,r.jsx)(s.br,{}),"d\xe9finit la propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:"status"})," \xe0 la valeur ",(0,r.jsx)(s.em,{children:"status"})," pass\xe9e"]})}),(0,r.jsx)(s.tr,{children:(0,r.jsxs)(s.td,{children:[(0,r.jsxs)(s.a,{href:"#status",children:[(0,r.jsx)(s.strong,{children:"status"})," : Integer"]}),(0,r.jsx)(s.br,{}),"le statut courant du message sortant"]})})]})]}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["Un objet 4D.OutgoingMessage est ",(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/Concepts/shared",children:"non partageable"}),"."]})}),"\n",(0,r.jsx)(s.h2,{id:"body",children:".body"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"body"})," : any"]}),"\n",(0,r.jsx)(s.h4,{id:"description",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".body"})," contient le body du message sortant. Les types de donn\xe9es suivants sont pris en charge dans la propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".body"})," :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"text"}),"\n",(0,r.jsx)(s.li,{children:"blob"}),"\n",(0,r.jsx)(s.li,{children:"object"}),"\n",(0,r.jsx)(s.li,{children:"image"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["La propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".body"})," est en lecture-\xe9criture."]}),"\n",(0,r.jsxs)(s.p,{children:["Vous pouvez \xe9galement d\xe9finir la propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".body"})," en utilisant la fonction ",(0,r.jsx)(s.a,{href:"#setbody",children:(0,r.jsx)(s.code,{children:"setBody()"})}),", auquel cas l'en-t\xeate ",(0,r.jsx)(s.code,{children:"content-type"})," est automatiquement d\xe9fini."]}),"\n",(0,r.jsx)(s.h2,{id:"headers",children:".headers"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"headers"})," : Object"]}),"\n",(0,r.jsx)(s.h4,{id:"description-1",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".headers"})," contient les headers courants du message sortant sous forme de paires cl\xe9/valeur."]}),"\n",(0,r.jsxs)(s.p,{children:["La propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".headers"})," est en lecture seule. Pour d\xe9finir un header, utilisez la fonction ",(0,r.jsx)(s.a,{href:"#setheader",children:(0,r.jsx)(s.code,{children:"setHeader()"})}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"setbody",children:".setBody()"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:".setBody"}),"( ",(0,r.jsx)(s.em,{children:"body"})," : any )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Param\xe8tres"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"body"}),(0,r.jsx)(s.td,{children:"any"}),(0,r.jsx)(s.td,{children:"->"}),(0,r.jsx)(s.td,{children:"Body du message sortant"})]})})]}),"\n",(0,r.jsx)(s.h4,{id:"description-2",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La fonction ",(0,r.jsx)(s.code,{children:".setBody()"})," d\xe9finit le ",(0,r.jsx)(s.em,{children:"body"})," du message sortant."]}),"\n",(0,r.jsxs)(s.p,{children:["Les types de donn\xe9es suivants sont pris en charge dans la propri\xe9t\xe9 ",(0,r.jsx)(s.em,{children:"body"})," :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Text"}),"\n",(0,r.jsx)(s.li,{children:"Blob"}),"\n",(0,r.jsx)(s.li,{children:"Object"}),"\n",(0,r.jsx)(s.li,{children:"Image"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Lorsque cette fonction est utilis\xe9e, le header content-type est automatiquement d\xe9fini en fonction du type de ",(0,r.jsx)(s.em,{children:"body"})," :"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Content-Type:text/plain si le body est un texte"}),"\n",(0,r.jsx)(s.li,{children:"Content-Type:application/octet-stream si le body est un Blob"}),"\n",(0,r.jsx)(s.li,{children:"Content-Type:application/json si le body est un objet"}),"\n",(0,r.jsx)(s.li,{children:"Content-Type:image/jpeg, image/gif... si le body est une image"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Si ",(0,r.jsx)(s.em,{children:"body"})," n'est pas un type de valeur pris en charge, une erreur est renvoy\xe9e."]}),"\n",(0,r.jsx)(s.h2,{id:"setheader",children:".setHeader()"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:".setHeader"}),"( ",(0,r.jsx)(s.em,{children:"key"})," : Text ; ",(0,r.jsx)(s.em,{children:"value"})," : Text )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Param\xe8tres"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"key"}),(0,r.jsx)(s.td,{children:"Text"}),(0,r.jsx)(s.td,{children:"->"}),(0,r.jsx)(s.td,{children:"Propri\xe9t\xe9 de header \xe0 d\xe9finir"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"value"}),(0,r.jsx)(s.td,{children:"Text"}),(0,r.jsx)(s.td,{children:"->"}),(0,r.jsx)(s.td,{children:"Valeur de la propri\xe9t\xe9 de header"})]})]})]}),"\n",(0,r.jsx)(s.h4,{id:"description-3",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La fonction ",(0,r.jsx)(s.code,{children:".setHeader()"})," fixe la cl\xe9 ",(0,r.jsx)(s.em,{children:"key"})," du header du message sortant avec la ",(0,r.jsx)(s.em,{children:"value"})," fournie. Si les deux param\xe8tres ne sont pas des valeurs texte, une erreur est g\xe9n\xe9r\xe9e."]}),"\n",(0,r.jsxs)(s.p,{children:["Lorsqu'il renvoie une instance d'objet 4D.OutgoingMessage, 4D d\xe9finit automatiquement certains headers (par exemple ",(0,r.jsx)(s.code,{children:"Set-Cookie"})," avec ",(0,r.jsx)(s.code,{children:"WASID4D=..."})," et ",(0,r.jsx)(s.code,{children:"4DSID__ProjectName_=...."}),")."]}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["Si vous d\xe9finissez une ",(0,r.jsx)(s.em,{children:"value"})," pour la ",(0,r.jsx)(s.em,{children:"key"})," du header \"Content-Type\", assurez-vous d'appeler cette fonction apr\xe8s l'appel \xe0 ",(0,r.jsx)(s.a,{href:"#setbody",children:(0,r.jsx)(s.code,{children:"setBody()"})}),", car ",(0,r.jsx)(s.code,{children:"setBody()"}),' remplit automatiquement ce header. Pour une liste des valeurs du header "Content-Type", veuillez vous r\xe9f\xe9rer \xe0 la documentation de ',(0,r.jsx)(s.a,{href:"/docs/fr/20-R8/commands/web-send-blob",children:(0,r.jsx)(s.code,{children:"WEB SEND BLOB"})}),"."]})}),"\n",(0,r.jsx)(s.h2,{id:"setstatus",children:".setStatus()"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:".setStatus"}),"( ",(0,r.jsx)(s.em,{children:"status"})," : Integer )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Param\xe8tres"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"status"}),(0,r.jsx)(s.td,{children:"Integer"}),(0,r.jsx)(s.td,{children:"->"}),(0,r.jsx)(s.td,{children:"Statut \xe0 d\xe9finir"})]})})]}),"\n",(0,r.jsx)(s.h4,{id:"description-4",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La fonction ",(0,r.jsx)(s.code,{children:".setStatus()"})," d\xe9finit la propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:"status"})," \xe0 la valeur ",(0,r.jsx)(s.em,{children:"status"})," pass\xe9e."]}),"\n",(0,r.jsxs)(s.p,{children:["Si ",(0,r.jsx)(s.em,{children:"status"})," n'est pas un nombre entier, une erreur est g\xe9n\xe9r\xe9e."]}),"\n",(0,r.jsxs)(s.p,{children:["Pour une liste des codes de statut HTTP, veuillez consulter la ",(0,r.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes",children:"liste des codes de statut HTTP"})," sur Wikipedia."]}),"\n",(0,r.jsx)(s.h2,{id:"status",children:".status"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"status"})," : Integer"]}),"\n",(0,r.jsx)(s.h4,{id:"description-5",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["La propri\xe9t\xe9 ",(0,r.jsx)(s.code,{children:".status"})," contient le statut courant du message sortant. Cette propri\xe9t\xe9 peut \xeatre d\xe9finie \xe0 l'aide de la fonction ",(0,r.jsx)(s.a,{href:"setstatus",children:(0,r.jsx)(s.code,{children:"setStatus()"})}),"."]})]})}function h(e={}){let{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,s,n){n.d(s,{Z:function(){return l},a:function(){return d}});var t=n(667294);let r={},i=t.createContext(r);function d(e){let s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);