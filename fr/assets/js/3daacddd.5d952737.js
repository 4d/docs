"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["66594"],{693274:function(e,n,s){s.r(n),s.d(n,{default:()=>u,frontMatter:()=>d,metadata:()=>r,assets:()=>c,toc:()=>l,contentTitle:()=>a});var r=JSON.parse('{"id":"commands-legacy/compact-data-file","title":"Compact data file","description":"Compact data file ( cheminStructure ; cheminDonn\xe9es {; dossierArchive {; options {; m\xe9thode}}} ) : Text","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R7/commands-legacy/compact-data-file.md","sourceDirName":"commands-legacy","slug":"/commands/compact-data-file","permalink":"/docs/fr/commands/compact-data-file","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fcompact-data-file.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"compact-data-file","title":"Compact data file","slug":"/commands/compact-data-file","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"BUILD APPLICATION","permalink":"/docs/fr/commands/build-application"},"next":{"title":"COMPONENT LIST","permalink":"/docs/fr/commands/component-list"}}'),t=s("785893"),i=s("250065");let d={id:"compact-data-file",title:"Compact data file",slug:"/commands/compact-data-file",displayed_sidebar:"docs"},a=void 0,c={},l=[{value:"Description",id:"description",level:4},{value:"Exemple",id:"exemple",level:4},{value:"Variables et ensembles syst\xe8me",id:"variables-et-ensembles-syst\xe8me",level:4},{value:"Voir aussi",id:"voir-aussi",level:4},{value:"Propri\xe9t\xe9s",id:"propri\xe9t\xe9s",level:4}];function o(e){let n={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Compact data file"})," ( ",(0,t.jsx)(n.em,{children:"cheminStructure"})," ; ",(0,t.jsx)(n.em,{children:"cheminDonn\xe9es"})," {; ",(0,t.jsx)(n.em,{children:"dossierArchive"})," {; ",(0,t.jsx)(n.em,{children:"options"})," {; ",(0,t.jsx)(n.em,{children:"m\xe9thode"}),"}}} ) : Text"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Param\xe8tre"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cheminStructure"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Chemin d\u2019acc\xe8s du fichier de structure"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cheminDonn\xe9es"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Chemin d\u2019acc\xe8s du fichier de donn\xe9es"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"dossierArchive"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Chemin d\u2019acc\xe8s du dossier dans lequel placer le fichier de donn\xe9es original"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"options"}),(0,t.jsx)(n.td,{children:"Integer"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Options de compactage"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"m\xe9thode"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Nom de la m\xe9thode 4D de r\xe9tro-appel"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"R\xe9sultat"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2190"}),(0,t.jsx)(n.td,{children:"Chemin d\u2019acc\xe8s complet du dossier contenant le fichier de donn\xe9es original"})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["La commande ",(0,t.jsx)(n.strong,{children:"Compact data file"})," effectue un compactage du fichier de donn\xe9es d\xe9sign\xe9 par le param\xe8tre ",(0,t.jsx)(n.em,{children:"cheminDonn\xe9es"})," associ\xe9 au fichier de structure ",(0,t.jsx)(n.em,{children:"cheminStructure"}),". Pour plus d\u2019informations sur le compactage, reportez-vous au manuel Mode D\xe9veloppement."]}),"\n",(0,t.jsx)(n.p,{children:"Pour assurer la continuit\xe9 du fonctionnement de la base, le nouveau fichier de donn\xe9es compact\xe9 remplace automatiquement le fichier original. Par s\xe9curit\xe9, le fichier original n\u2019est pas modifi\xe9 et est d\xe9plac\xe9 dans un dossier sp\xe9cial nomm\xe9 \u201CReplaced files (compacting) AAAA-MM-JJ HH-MM-SS\u201D o\xf9 AAAA-MM-JJ HH-MM-SS repr\xe9sente la date et l\u2019heure de la sauvegarde. Par exemple : \u201CReplaced files (compacting) 2015-09-27 15-20-35\u201D."}),"\n",(0,t.jsxs)(n.p,{children:["La commande retourne le chemin d\u2019acc\xe8s complet du dossier effectivement cr\xe9\xe9 pour stocker le fichier de donn\xe9es original. Cette commande peut \xeatre ex\xe9cut\xe9e depuis 4D (mode local) ou 4D Server uniquement (proc\xe9dure stock\xe9e). Le fichier de donn\xe9es \xe0 compacter doit correspondre au fichier de structure d\xe9sign\xe9 par ",(0,t.jsx)(n.em,{children:"cheminStructure"}),". En outre, il ne doit PAS \xeatre ouvert au moment de l\u2019ex\xe9cution de la commande, sinon une erreur est g\xe9n\xe9r\xe9e.",(0,t.jsx)(n.br,{}),"\nSi une erreur se produit durant le processus de compactage, les fichiers originaux sont conserv\xe9s \xe0 leur emplacement initial. Si un fichier d\u2019index (fichier .4DIndx) est associ\xe9 au fichier de donn\xe9es, il est \xe9galement compact\xe9. Comme pour le fichier de donn\xe9es, le fichier original est sauvegard\xe9 et la nouvelle version compact\xe9e remplace la pr\xe9c\xe9dente."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Passez dans ",(0,t.jsx)(n.em,{children:"cheminStructure"})," le chemin d\u2019acc\xe8s complet du fichier de structure associ\xe9 au fichier de donn\xe9es que vous souhaitez compacter. Cette information est n\xe9cessaire \xe0 la proc\xe9dure de compactage. Le chemin d\u2019acc\xe8s doit \xeatre exprim\xe9 dans la syntaxe du syst\xe8me d\u2019exploitation. Vous pouvez \xe9galement passer une cha\xeene vide, dans ce cas une bo\xeete de dialogue standard d\u2019ouverture de fichiers appara\xeet, permettant \xe0 l\u2019utilisateur de d\xe9signer le fichier de structure \xe0 utiliser."]}),"\n",(0,t.jsxs)(n.li,{children:["Vous pouvez passer dans ",(0,t.jsx)(n.em,{children:"cheminDonn\xe9es"})," une cha\xeene vide, un nom de fichier ou un chemin d\u2019acc\xe8s complet, exprim\xe9 dans la syntaxe du syst\xe8me d\u2019exploitation. Si vous passez une cha\xeene vide, la bo\xeete de dialogue standard d\u2019ouverture de fichier appara\xeet, permettant \xe0 l\u2019utilisateur de d\xe9signer le fichier de donn\xe9es \xe0 compacter. Ce fichier doit correspondre au fichier de structure d\xe9fini dans le param\xe8tre ",(0,t.jsx)(n.em,{children:"cheminStructure"}),". Si vous passez uniquement un nom de fichier de donn\xe9es, 4D le recherchera au m\xeame niveau que le fichier de structure."]}),"\n",(0,t.jsxs)(n.li,{children:["Le param\xe8tre facultatif ",(0,t.jsx)(n.em,{children:"dossierArchive"})," permet de d\xe9signer l\u2019emplacement du dossier \u201CReplaced files (compacting) Dateheure\u201D destin\xe9 \xe0 recueillir les versions originales des fichiers de donn\xe9es ainsi que des \xe9ventuels fichiers d\u2019index.",(0,t.jsx)(n.br,{}),"\nLa commande retourne le chemin d\u2019acc\xe8s complet du dossier effectivement cr\xe9\xe9.",(0,t.jsx)(n.br,{}),"\n- Si vous omettez ce param\xe8tre, les fichiers d\u2019origine sont automatiquement d\xe9plac\xe9s dans un dossier \u201CReplaced files (compacting) Dateheure\u201D cr\xe9\xe9 \xe0 c\xf4t\xe9 du fichier de structure.",(0,t.jsx)(n.br,{}),"\n- Si vous passez une cha\xeene vide, une bo\xeete de dialogue standard d\u2019ouverture de dossier appara\xeet, permettant \xe0 l\u2019utilisateur de d\xe9signer l\u2019emplacement du dossier \xe0 cr\xe9er.",(0,t.jsx)(n.br,{}),"\n- Si vous passez un chemin d\u2019acc\xe8s (exprim\xe9 dans la syntaxe du syst\xe8me d\u2019exploitation), la commande cr\xe9era le dossier \u201CReplaced files (compacting) Dateheure\u201D \xe0 cet emplacement."]}),"\n",(0,t.jsxs)(n.li,{children:["Le param\xe8tre facultatif ",(0,t.jsx)(n.em,{children:"options"})," permet de d\xe9finir diverses options li\xe9es au compactage. Pour cela, utilisez les constantes suivantes, plac\xe9es dans le th\xe8me ",(0,t.jsx)(n.em,{children:"Maintenance fichier de donn\xe9es"}),". Vous pouvez passer plusieurs options en les cumulant :"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Constante"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Valeur"}),(0,t.jsx)(n.th,{children:"Comment"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Compact address table"}),(0,t.jsx)(n.td,{children:"Entier long"}),(0,t.jsx)(n.td,{children:"131072"}),(0,t.jsx)(n.td,{children:"Forcer la r\xe9\xe9criture de la table d\u2019adresses des enregistrements (ralentit le compactage). A noter que dans ce cas, les num\xe9ros des enregistrements sont r\xe9\xe9crits. Si vous passez uniquement cette option, 4D active automatiquement l\u2019option \u2019Mettre \xe0 jour enregistrements\u2019."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Create process"}),(0,t.jsx)(n.td,{children:"Entier long"}),(0,t.jsx)(n.td,{children:"32768"}),(0,t.jsx)(n.td,{children:"Lorsque cette option est pass\xe9e, le compactage sera asynchrone et vous devrez g\xe9rer les r\xe9sultats \xe0 l\u2019aide de la m\xe9thode de r\xe9tro-appel (voir ci-dessous). 4D n\u2019affichera pas de barre de progression (il est possible de le faire via la m\xe9thode de r\xe9tro-appel). La variable syst\xe8me OK prendra la valeur 1 si le process a \xe9t\xe9 correctement lanc\xe9 et 0 dans les autres cas. Lorsque cette option n\u2019est pas pass\xe9e, la variable OK prendra la valeur 1 si le compactage s\u2019est correctement d\xe9roul\xe9 et sinon 0."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Do not create log file"}),(0,t.jsx)(n.td,{children:"Entier long"}),(0,t.jsx)(n.td,{children:"16384"}),(0,t.jsx)(n.td,{children:"En principe, la commande cr\xe9e un fichier d\u2019historique au format xml (reportez-vous \xe0 la fin de la description de la commande). Vous pouvez annuler ce fonctionnement en passant cette option."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Timestamp log file name"}),(0,t.jsx)(n.td,{children:"Entier long"}),(0,t.jsx)(n.td,{children:"262144"}),(0,t.jsx)(n.td,{children:"Lorsque cette option est pass\xe9e, le nom du fichier d'historique g\xe9n\xe9r\xe9 contiendra la date et l'heure de sa cr\xe9ation, par cons\xe9quent il ne remplacera aucun fichier d'historique \xe9ventuellement d\xe9j\xe0 g\xe9n\xe9r\xe9. Par d\xe9faut, si cette option n'est pas pass\xe9e, le nom du fichier n'est pas horodat\xe9, et chaque nouveau fichier g\xe9n\xe9r\xe9 remplace le pr\xe9c\xe9dent."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Update records"}),(0,t.jsx)(n.td,{children:"Entier long"}),(0,t.jsx)(n.td,{children:"65536"}),(0,t.jsx)(n.td,{children:"Forcer la r\xe9\xe9criture de tous les enregistrements suivant la d\xe9finition courante des champs dans la structure"})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Le param\xe8tre ",(0,t.jsx)(n.em,{children:"m\xe9thode"})," permet de d\xe9signer une m\xe9thode de r\xe9tro-appel qui sera r\xe9guli\xe8rement appel\xe9e durant le compactage si l\u2019option Create process a \xe9t\xe9 pass\xe9e. Dans le cas contraire, la m\xe9thode de r\xe9tro-appel n\u2019est jamais appel\xe9e. Pour plus d\u2019informations sur cette m\xe9thode, reportez-vous \xe0 la description de la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/commands/verify-data-file",children:"VERIFY DATA FILE"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Par d\xe9faut, la commande ",(0,t.jsx)(n.strong,{children:"Compact data file"})," cr\xe9e un fichier d'historique au format xml (si vous n'avez pas pass\xe9 l'option Do not create log file, cf. param\xe8tre ",(0,t.jsx)(n.em,{children:"options"}),"). Son nom est bas\xe9 sur celui du fichier de structure de la base et il est plac\xe9 dans le dossier ",(0,t.jsx)(n.strong,{children:"Logs"})," de cette base. Par exemple, pour un fichier de structure nomm\xe9 \u201CmyDB.4db\u201D, le fichier d\u2019historique sera nomm\xe9 \u201CmyDB_Compact_Log.xml\u201D.",(0,t.jsx)(n.br,{}),"\nSi vous avez pass\xe9 l'option Timestamp log file name, le nom du fichier d'historique inclut la date et l'heure de sa cr\xe9ation sous la forme \"AAAA-MM-JJ HH-MM-SS\", ce qui donne par exemple : \u201CmyDB_Compact_Log_2015-09-27 15-20-35.xml\u201D. Ce principe permet d'\xe9viter que chaque nouveau fichier d'historique \xe9crase le pr\xe9c\xe9dent, mais pourra n\xe9cessiter ult\xe9rieurement une action manuelle afin de supprimer les fichiers superflus.",(0,t.jsx)(n.br,{}),"\nQuelle que soit l'option s\xe9lectionn\xe9e, d\xe8s lors qu'un fichier d'historique est g\xe9n\xe9r\xe9, son chemin est retourn\xe9 dans la variable syst\xe8me ",(0,t.jsx)(n.em,{children:"Document"})," \xe0 l'issue de l'ex\xe9cution de la commande."]}),"\n",(0,t.jsx)(n.h4,{id:"exemple",children:"Exemple"}),"\n",(0,t.jsx)(n.p,{children:"L\u2019exemple suivant (Windows) effectue le compactage d\u2019un fichier de donn\xe9es :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0$ficStruc:=Structure file\n\xa0$ficDonn\xe9es:="C:\\\\Bases\\\\Factures\\\\Janvier\\\\Factures.4dd"\n\xa0$ficOrig:="C:\\\\Bases\\\\Factures\\\\Archives\\\\Janvier\\"\n\xa0$dossierArch:=Compact data file($ficStruc;$ficDonn\xe9es;$ficOrig)\n'})}),"\n",(0,t.jsx)(n.h4,{id:"variables-et-ensembles-syst\xe8me",children:"Variables et ensembles syst\xe8me"}),"\n",(0,t.jsx)(n.p,{children:"Si l\u2019op\xe9ration de compactage s\u2019est d\xe9roul\xe9e correctement, la variable syst\xe8me OK prend la valeur 1, sinon elle prend la valeur 0. Si un fichier d'historique a \xe9t\xe9 g\xe9n\xe9r\xe9, son chemin complet est retourn\xe9 dans la variable syst\xe8me Document."}),"\n",(0,t.jsx)(n.h4,{id:"voir-aussi",children:"Voir aussi"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/fr/commands/table-fragmentation",children:"Table fragmentation"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/commands/verify-data-file",children:"VERIFY DATA FILE"})]}),"\n",(0,t.jsx)(n.h4,{id:"propri\xe9t\xe9s",children:"Propri\xe9t\xe9s"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Num\xe9ro de commande"}),(0,t.jsx)(n.td,{children:"937"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Thread safe"}),(0,t.jsx)(n.td,{children:"\u2713"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Modifie les variables"}),(0,t.jsx)(n.td,{children:"OK, Document"})]})]})]})]})}function u(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return d}});var r=s(667294);let t={},i=r.createContext(t);function d(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);