"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["4972"],{253711:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>i,toc:()=>d,default:()=>u,metadata:()=>s,assets:()=>o,contentTitle:()=>a});var s=JSON.parse('{"id":"ORDA/orda-events","title":"\xc9v\xe8nements d\'entit\xe9","description":"Historique","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R10/ORDA/orda-events.md","sourceDirName":"ORDA","slug":"/ORDA/orda-events","permalink":"/docs/fr/20-R10/ORDA/orda-events","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20ORDA%2Forda-events.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"orda-events","title":"\xc9v\xe8nements d\'entit\xe9"},"sidebar":"docs","previous":{"title":"Travailler avec les donn\xe9es","permalink":"/docs/fr/20-R10/ORDA/entities"},"next":{"title":"Utiliser le marqueur global","permalink":"/docs/fr/20-R10/ORDA/global-stamp"}}'),r=t(785893),l=t(250065);let i={id:"orda-events",title:"\xc9v\xe8nements d'entit\xe9"},a=void 0,o={},d=[{value:"Vue d\u2019ensemble",id:"vue-densemble",level:2},{value:"Niveau de l&#39;\xe9v\xe9nement",id:"niveau-de-l\xe9v\xe9nement",level:3},{value:"Ex\xe9cution en configuration distante",id:"ex\xe9cution-en-configuration-distante",level:3},{value:"Tableau de synth\xe8se",id:"tableau-de-synth\xe8se",level:3},{value:"Param\xe8tre <em>event</em>",id:"param\xe8tre-event",level:2},{value:"Description des fonctions",id:"description-des-fonctions",level:2},{value:"<code>Function event touched</code>",id:"function-event-touched",level:3},{value:"Syntaxe",id:"syntaxe",level:4},{value:"Exemple 1",id:"exemple-1",level:4},{value:"Exemple 2",id:"exemple-2",level:4},{value:"Example 3 (diagram): Client/server with the <code>local</code> keyword:",id:"example-3-diagram-clientserver-with-the-local-keyword",level:4},{value:"Example 4 (diagram): Client/server without the <code>local</code> keyword",id:"example-4-diagram-clientserver-without-the-local-keyword",level:4},{value:"Example 5 (diagram): Qodly application",id:"example-5-diagram-qodly-application",level:4}];function c(e){let n={a:"a",admonition:"admonition",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.details,{children:[(0,r.jsx)(n.summary,{children:"Historique"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Release"}),(0,r.jsx)(n.th,{children:"Modifications"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20 R10"}),(0,r.jsx)(n.td,{children:"ajout \xe9v\xe9nement touched"})]})})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 sont des fonctions qui sont automatiquement invoqu\xe9es par ORDA chaque fois que des entit\xe9s et des attributs d'entit\xe9 sont touch\xe9s (ajout\xe9s, supprim\xe9s ou modifi\xe9s). Vous pouvez \xe9crire des \xe9v\xe9nements tr\xe8s simples, puis les rendre plus sophistiqu\xe9s."}),"\n",(0,r.jsx)(n.p,{children:"Vous ne pouvez pas d\xe9clencher directement l'ex\xe9cution d'une fonction d'\xe9v\xe9nement. Les \xe9v\xe9nements sont appel\xe9s automatiquement par ORDA en fonction des actions de l'utilisateur ou des op\xe9rations effectu\xe9es par le code sur les entit\xe9s et leurs attributs."}),"\n",(0,r.jsx)(n.admonition,{title:"Note de compatibilit\xe9",type:"info",children:(0,r.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 ORDA dans le magasin de donn\xe9es sont \xe9quivalents aux triggers dans la base de donn\xe9es 4D. Cependant, les actions d\xe9clench\xe9es au niveau de la base de donn\xe9es 4D \xe0 l'aide des commandes du langage classique 4D ou des actions standard ne d\xe9clenchent pas les \xe9v\xe9nements ORDA."})}),"\n",(0,r.jsx)(n.h2,{id:"vue-densemble",children:"Vue d\u2019ensemble"}),"\n",(0,r.jsx)(n.h3,{id:"niveau-de-l\xe9v\xe9nement",children:"Niveau de l'\xe9v\xe9nement"}),"\n",(0,r.jsxs)(n.p,{children:["Une fonction d'\xe9v\xe9nement d'entit\xe9 est toujours d\xe9finie dans la ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#entity-class",children:"classe Entity"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Un \xe9v\xe9nement peut \xeatre d\xe9fini au niveau de l'",(0,r.jsx)(n.strong,{children:"entit\xe9"})," et/ou de l'",(0,r.jsx)(n.strong,{children:"attribut"})," (y compris les ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#computed-attributes",children:(0,r.jsx)(n.strong,{children:"attributs calcul\xe9s"})}),"). Dans le premier cas, il sera d\xe9clench\xe9 pour tous les attributs de l'entit\xe9 ; dans l'autre cas, il ne sera d\xe9clench\xe9 que pour l'attribut cibl\xe9."]}),"\n",(0,r.jsx)(n.p,{children:"Pour un m\xeame \xe9v\xe9nement, vous pouvez d\xe9finir diff\xe9rentes fonctions pour diff\xe9rents attributs."}),"\n",(0,r.jsx)(n.p,{children:"Vous pouvez \xe9galement d\xe9finir le m\xeame \xe9v\xe9nement au niveau de l'attribut et de l'entit\xe9. L'\xe9v\xe9nement attribut est appel\xe9 en premier, puis l'\xe9v\xe9nement entit\xe9."}),"\n",(0,r.jsx)(n.h3,{id:"ex\xe9cution-en-configuration-distante",children:"Ex\xe9cution en configuration distante"}),"\n",(0,r.jsx)(n.p,{children:"En g\xe9n\xe9ral, les \xe9v\xe9nements ORDA sont ex\xe9cut\xe9s sur le serveur."}),"\n",(0,r.jsxs)(n.p,{children:["Cependant, dans une configuration client/serveur, la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"touched()"})," peut \xeatre ex\xe9cut\xe9e sur ",(0,r.jsx)(n.strong,{children:"le serveur ou le client"}),", en fonction de l'utilisation du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})}),". Une impl\xe9mentation sp\xe9cifique c\xf4t\xe9 client permet de d\xe9clencher l'\xe9v\xe9nement sur le client."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Les fonctions ORDA ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor",children:(0,r.jsx)(n.code,{children:"constructor()"})})," sont toujours ex\xe9cut\xe9es sur le client."]})}),"\n",(0,r.jsxs)(n.p,{children:["Avec d'autres configurations distantes (i.e. applications Qodly, ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/REST/REST_requests",children:"requ\xeates via l'API REST"}),", ou requ\xeates via ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/commands/open-datastore",children:(0,r.jsx)(n.code,{children:"Open datastore"})}),"), la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"touched()"})," est toujours ex\xe9cut\xe9e ",(0,r.jsx)(n.strong,{children:"c\xf4t\xe9 serveur"}),". Cela signifie que vous devez vous assurer que le serveur peut \"voir\" qu'un attribut a \xe9t\xe9 touch\xe9 pour d\xe9clencher l'\xe9v\xe9nement (voir ci-dessous)."]}),"\n",(0,r.jsx)(n.h3,{id:"tableau-de-synth\xe8se",children:"Tableau de synth\xe8se"}),"\n",(0,r.jsx)(n.p,{children:"Le tableau suivant liste les \xe9v\xe9nements d'entit\xe9 ORDA ainsi que leurs principes."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Ev\xe9nement"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Niveau"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de la fonction"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"(C/S) Ex\xe9cut\xe9 sur"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Instanciation d'entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"client"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut touched"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched <attrName>()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La fonction ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})," n'est pas en soi une fonction d'\xe9v\xe9nement, mais elle est toujours appel\xe9e lorsqu'une nouvelle entit\xe9 est instanci\xe9e."]})}),"\n",(0,r.jsxs)(n.h2,{id:"param\xe8tre-event",children:["Param\xe8tre ",(0,r.jsx)(n.em,{children:"event"})]}),"\n",(0,r.jsxs)(n.p,{children:["Les fonctions d'\xe9v\xe9nement acceptent un seul objet ",(0,r.jsx)(n.em,{children:"event"})," comme param\xe8tre. Lorsque la fonction est appel\xe9e, le param\xe8tre est rempli avec diverses propri\xe9t\xe9s :"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de propri\xe9t\xe9"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Disponibilit\xe9"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"kind"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'Nom de l\'\xe9v\xe9nement ("touched")'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"attributeName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Uniquement pour les \xe9v\xe9nements impliquant un attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom de l'attribut (",(0,r.jsx)(n.em,{children:"ex."}),' "firstname")']})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"dataClassName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom du verre de donn\xe9es (",(0,r.jsx)(n.em,{children:"ex."}),' "Company")']})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"description-des-fonctions",children:"Description des fonctions"}),"\n",(0,r.jsx)(n.h3,{id:"function-event-touched",children:(0,r.jsx)(n.code,{children:"Function event touched"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"{local} Function event touched($event : Object)\n{local} Function event touched <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une valeur est modifi\xe9e dans l'entit\xe9."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est d\xe9clench\xe9e pour des modifications sur n'importe quel attribut de l'entit\xe9."}),"\n",(0,r.jsx)(n.li,{children:"si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est d\xe9clench\xe9e que pour les modifications sur cet attribut."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 d\xe8s que le moteur de 4D Server / 4D d\xe9tecte une modification de la valeur de l'attribut qui peut \xeatre due aux actions suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur avec le ",(0,r.jsxs)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:["mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]})]})," ou en ",(0,r.jsx)(n.strong,{children:"4D mono-utilisateur"})," :\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"l'utilisateur saisit une valeur dans un formulaire 4D,"}),"\n",(0,r.jsxs)(n.li,{children:["le code 4D effectue une assignation avec l'op\xe9rateur ",(0,r.jsx)(n.code,{children:":="}),". L'\xe9v\xe9nement est \xe9galement d\xe9clench\xe9 en cas d'auto-assignation (",(0,r.jsx)(n.code,{children:"$entity.attribute:=$entity.attribute"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]})," : du code 4D effectue une assignation avec l'op\xe9rateur ",(0,r.jsx)(n.code,{children:":="})," est ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/commands/execute-on-server",children:"ex\xe9cut\xe9 sur le serveur"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]}),", une ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://developer.qodly.com/docs",children:"application Qodly"})})," ou ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/commands/open-datastore",children:"datastore distant"})})," : l'entit\xe9 est re\xe7ue sur le serveur 4D lors de l'appel d'une fonction ORDA (sur l'entit\xe9 ou avec l'entit\xe9 en tant que param\xe8tre). Cela signifie que vous devrez peut-\xeatre mettre en place une fonction ",(0,r.jsx)(n.em,{children:"refresh"})," ou ",(0,r.jsx)(n.em,{children:"preview"})," sur l'application distante qui envoie une requ\xeate ORDA au serveur et d\xe9clenche l'\xe9v\xe9nement."]}),"\n",(0,r.jsxs)(n.li,{children:["avec le serveur REST : la valeur est re\xe7ue sur le serveur REST avec une ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/REST/method#methodupdate",children:"requ\xeate REST"})," (",(0,r.jsx)(n.code,{children:"$method=update"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsxs)(n.p,{children:["Si cet \xe9v\xe9nement ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/commands/throw",children:"g\xe9n\xe8re une erreur"}),", il n'arr\xeatera pas l'action en cours."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est \xe9galement d\xe9clench\xe9 :"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["lorsque les attributs sont assign\xe9s par l'\xe9v\xe9nement ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})}),","]}),"\n",(0,r.jsxs)(n.li,{children:["lorsque les attributs sont modifi\xe9s via l'",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/Admin/dataExplorer",children:"Explorateur de donn\xe9es"}),"."]}),"\n"]})]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,r.jsx)(n.p,{children:"You want to uppercase all text attributes of an entity when it is updated."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //ProductsEntity class\nFunction event touched($event : Object)\n	\n	If (Value type(This[$event.attributeName])=Is text)\n		This[$event.attributeName]:=Uppercase(This[$event.attributeName])\n	End if \n"})}),"\n",(0,r.jsx)(n.h4,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,r.jsxs)(n.p,{children:['The "touched" event is useful when it is not possible to write indexed query code in ',(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"Function query()"})})," for a ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#computed-attributes",children:"computed attribute"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["This is the case for example, when your ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," function has to compare the value of different attributes from the same entity with each other. You must use formulas in the returned ORDA query -- which triggers sequential queries."]}),"\n",(0,r.jsx)(n.p,{children:"To fully understand this case, let's examine the following two calculated attributes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function get onGoing() : Boolean\n        return ((This.departureDate<=Current date) & (This.arrivalDate>=Current date))\n\nFunction get sameDay() : Boolean\n        return (This.departureDate=This.arrivalDate)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Even though they are very similar, these functions cannot be associated with identical queries because they do not compare the same types of values. The first compares attributes to a given value, while the second compares attributes to each other."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For the ",(0,r.jsx)(n.em,{children:"onGoing"})," attribute, the ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," function is simple to write and uses indexed attributes:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query onGoing($event : Object) : Object\n    var $operator : Text\n    var $myQuery : Text\n    var $onGoingValue : Boolean\n    var $parameters : Collection\n    $parameters:=New collection()\n\n    $operator:=$event.operator\n    Case of \n            : (($operator="=") | ($operator="==") | ($operator="==="))\n                $onGoingValue:=Bool($event.value)\n            : (($operator="!=") | ($operator="!=="))\n                $onGoingValue:=Not(Bool($event.value))\n            Else \n                return {query: ""; parameters: $parameters}\n    End case \n\n    $myQuery:=($onGoingValue) ? "departureDate <= :1 AND arrivalDate >= :1" : "departureDate > :1 OR arrivalDate < :1"\n        // the ORDA query string uses indexed attributes, it will be indexed\n    $parameters.push(Current date)\n    return {query: $myQuery; parameters: $parameters}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For the ",(0,r.jsx)(n.em,{children:"sameDay"})," attribute, the ",(0,r.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," function requires an ORDA query based on formulas and will be sequential:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query sameDay($event : Object) : Text\n    var $operator : Text\n    var $sameDayValue : Boolean\n\n    $operator:=$event.operator\n    Case of \n        : (($operator="=") | ($operator="==") | ($operator="==="))\n            $sameDayValue:=Bool($event.value)\n        : (($operator="!=") | ($operator="!=="))\n            $sameDayValue:=Not(Bool($event.value))\n        Else \n            return ""\n        End case \n\n    return ($sameDayValue) ? "eval(This.departureDate = This.arrivalDate)" : "eval(This.departureDate != This.arrivalDate)"\n        // the ORDA query string uses a formula, it will not be indexed\n\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Using a ",(0,r.jsx)(n.strong,{children:"scalar"})," ",(0,r.jsx)(n.em,{children:"sameDay"}),' attribute updated when other attributes are "touched" will save time:']}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //BookingEntity class\n\nFunction event touched departureDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate) \n//\n//\nFunction event touched arrivalDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate)\n\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"example-3-diagram-clientserver-with-the-local-keyword",children:["Example 3 (diagram): Client/server with the ",(0,r.jsx)(n.code,{children:"local"})," keyword:"]}),"\n",(0,r.jsx)(n.mermaid,{value:'\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:="Brown"\n   Note over Client: local Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\nNote over Client:$people.lastname is uppercased\n\n    Client->>+Server: $people.apply()\n   \n   Note over Server: The $people entity is received with the lastname attribute uppercased\n'}),"\n",(0,r.jsxs)(n.h4,{id:"example-4-diagram-clientserver-without-the-local-keyword",children:["Example 4 (diagram): Client/server without the ",(0,r.jsx)(n.code,{children:"local"})," keyword"]}),"\n",(0,r.jsx)(n.mermaid,{value:'\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:="Brown"\n\n   Note over Client:$people.lastname is not uppercased\n\n    Client->>+Server: $people.apply()\n\n   Note over Server: Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\n    Server--\x3e>-Client: The $people entity is updated\n\n   Note over Client:$people.lastname is uppercased\n\n'}),"\n",(0,r.jsx)(n.h4,{id:"example-5-diagram-qodly-application",children:"Example 5 (diagram): Qodly application"}),"\n",(0,r.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\nQodly page->>+ Server: Get an entity into the People Qodly source\n\nQodly page->>+Qodly page: The user updates People.lastname\n\nNote over Qodly page: The People Qodly source lastname attribute is not uppercased\n\nQodly page->>+ Server: Function call People.apply()\n\nNote over Server: Function event touched lastname($event : Object) <br> This.lastname:=Uppercase(This.lastname)\n\nServer--\x3e>-Qodly page: The People Qodly source is updated\nNote over Qodly page: The People Qodly source lastname attribute is uppercased\n\n"})]})}function u(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,n,t){t.d(n,{Z:()=>a,a:()=>i});var s=t(667294);let r={},l=s.createContext(r);function i(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);