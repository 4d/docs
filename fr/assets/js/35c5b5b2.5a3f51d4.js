"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[11149],{603905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>k});var n=a(667294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),o=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=o(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=o(a),k=r,N=d["".concat(p,".").concat(k)]||d[k]||m[k]||l;return a?n.createElement(N,i(i({ref:t},u),{},{components:a})):n.createElement(N,i({ref:t},u))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var o=2;o<l;o++)i[o]=a[o];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},986957:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>u});a(667294);var n=a(603905);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r.apply(this,arguments)}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const i={id:"IMAPTransporterClass",title:"IMAPTransporter"},s=void 0,p={unversionedId:"API/IMAPTransporterClass",id:"version-20-R5/API/IMAPTransporterClass",title:"IMAPTransporter",description:"La classe IMAPTransporter vous permet de r\xe9cup\xe9rer des messages \xe0 partir d'un serveur de messagerie IMAP.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R5/API/IMAPTransporterClass.md",sourceDirName:"API",slug:"/API/IMAPTransporterClass",permalink:"/docs/fr/API/IMAPTransporterClass",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"IMAPTransporterClass",title:"IMAPTransporter"},sidebar:"docs",previous:{title:"HTTPRequest",permalink:"/docs/fr/API/HTTPRequestClass"},next:{title:"MailAttachment",permalink:"/docs/fr/API/MailAttachmentClass"}},o={},u=[{value:"Objet IMAP Transporter",id:"objet-imap-transporter",level:3},{value:"IMAP New transporter",id:"imap-new-transporter",level:2},{value:"Description",id:"description",level:4},{value:"R\xe9sultat",id:"r\xe9sultat",level:4},{value:"Exemple",id:"exemple",level:4},{value:"4D.IMAPTransporter.new()",id:"4dimaptransporternew",level:2},{value:"Description",id:"description-1",level:4},{value:".acceptUnsecureConnection",id:"acceptunsecureconnection",level:2},{value:"Description",id:"description-2",level:4},{value:".addFlags()",id:"addflags",level:2},{value:"Description",id:"description-3",level:4},{value:"Exemple",id:"exemple-1",level:4},{value:".append()",id:"append",level:2},{value:"Description",id:"description-4",level:4},{value:"Exemple",id:"exemple-2",level:4},{value:".authenticationMode",id:"authenticationmode",level:2},{value:"Description",id:"description-5",level:4},{value:".checkConnection()",id:"checkconnection",level:2},{value:"Description",id:"description-6",level:4},{value:"Objet retourn\xe9",id:"objet-retourn\xe9",level:4},{value:".checkConnectionDelay",id:"checkconnectiondelay",level:2},{value:"Description",id:"description-7",level:4},{value:".connectionTimeOut",id:"connectiontimeout",level:2},{value:"Description",id:"description-8",level:4},{value:".copy()",id:"copy",level:2},{value:"Description",id:"description-9",level:4},{value:"Exemple 1",id:"exemple-1-1",level:4},{value:"Exemple 2",id:"exemple-2-1",level:4},{value:".createBox()",id:"createbox",level:2},{value:"Description",id:"description-10",level:4},{value:"Exemple",id:"exemple-3",level:4},{value:".delete()",id:"delete",level:2},{value:"Description",id:"description-11",level:4},{value:"Exemple 1",id:"exemple-1-2",level:4},{value:"Exemple 2",id:"exemple-2-2",level:4},{value:".deleteBox()",id:"deletebox",level:2},{value:"Description",id:"description-12",level:4},{value:"Exemple",id:"exemple-4",level:4},{value:".expunge()",id:"expunge",level:2},{value:"Description",id:"description-13",level:4},{value:"Exemple",id:"exemple-5",level:4},{value:".getBoxInfo()",id:"getboxinfo",level:2},{value:"Description",id:"description-14",level:4},{value:"Exemple",id:"exemple-6",level:4},{value:".getBoxList()",id:"getboxlist",level:2},{value:"Description",id:"description-15",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-1",level:4},{value:"Exemple",id:"exemple-7",level:4},{value:".getDelimiter()",id:"getdelimiter",level:2},{value:"Description",id:"description-16",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-2",level:4},{value:"Exemple",id:"exemple-8",level:4},{value:".getMail()",id:"getmail",level:2},{value:"Description",id:"description-17",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-3",level:4},{value:"Exemple",id:"exemple-9",level:4},{value:".getMails()",id:"getmails",level:2},{value:"Description",id:"description-18",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-4",level:4},{value:"Exemple",id:"exemple-10",level:4},{value:".getMIMEAsBlob()",id:"getmimeasblob",level:2},{value:"Description",id:"description-19",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-5",level:4},{value:"Exemple",id:"exemple-11",level:4},{value:".host",id:"host",level:2},{value:"Description",id:"description-20",level:4},{value:".logFile",id:"logfile",level:2},{value:"Description",id:"description-21",level:4},{value:".move()",id:"move",level:2},{value:"Description",id:"description-22",level:4},{value:"Exemple 1",id:"exemple-1-3",level:4},{value:"Exemple 2",id:"exemple-2-3",level:4},{value:".numToID()",id:"numtoid",level:2},{value:"Description",id:"description-23",level:4},{value:"R\xe9sultat",id:"r\xe9sultat-6",level:4},{value:"Exemple",id:"exemple-12",level:4},{value:".removeFlags()",id:"removeflags",level:2},{value:"Description",id:"description-24",level:4},{value:"Exemple",id:"exemple-13",level:4},{value:".renameBox()",id:"renamebox",level:2},{value:"Description",id:"description-25",level:4},{value:"Exemple",id:"exemple-14",level:4},{value:".port",id:"port",level:2},{value:"Description",id:"description-26",level:4},{value:".searchMails()",id:"searchmails",level:2},{value:"Description",id:"description-27",level:4},{value:"Mots-cl\xe9s de recherche autoris\xe9s",id:"mots-cl\xe9s-de-recherche-autoris\xe9s",level:4},{value:"Mots-cl\xe9s de recherche autoris\xe9s",id:"mots-cl\xe9s-de-recherche-autoris\xe9s-1",level:4},{value:".selectBox()",id:"selectbox",level:2},{value:"Description",id:"description-28",level:4},{value:"Exemple",id:"exemple-15",level:4},{value:".subscribe()",id:"subscribe",level:2},{value:"Description",id:"description-29",level:4},{value:"Exemple",id:"exemple-16",level:4},{value:".unsubscribe()",id:"unsubscribe",level:2},{value:"Description",id:"description-30",level:4},{value:"Exemple",id:"exemple-17",level:4},{value:".user",id:"user",level:2},{value:"Description",id:"description-31",level:4}],m={toc:u};function d(e){var{components:t}=e,a=l(e,["components"]);return(0,n.kt)("wrapper",r({},m,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"La classe ",(0,n.kt)("inlineCode",{parentName:"p"},"IMAPTransporter")," vous permet de r\xe9cup\xe9rer des messages \xe0 partir d'un serveur de messagerie IMAP."),(0,n.kt)("h3",r({},{id:"objet-imap-transporter"}),"Objet IMAP Transporter"),(0,n.kt)("p",null,"Les objets IMAP Transporter sont instanci\xe9s avec la commande ",(0,n.kt)("a",r({parentName:"p"},{href:"#imap-new-transporter"}),"IMAP New transporter"),". Leurs propri\xe9t\xe9s et fonctions sont les suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null})))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#acceptunsecureconnection"}),(0,n.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : Boolean"),(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"td"},"True")," si 4D est autoris\xe9 \xe0 \xe9tablir une connexion non chiffr\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#addflags"}),(0,n.kt)("strong",{parentName:"a"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Text ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Longint  ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object"),(0,n.kt)("br",null),"ajoute des flags (drapeaux) aux ",(0,n.kt)("inlineCode",{parentName:"td"},"msgIDs")," pour les ",(0,n.kt)("inlineCode",{parentName:"td"},"keywords")," sp\xe9cifi\xe9s")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#append"}),(0,n.kt)("strong",{parentName:"a"},".append"),"( ",(0,n.kt)("em",{parentName:"a"},"mailObj")," : Object ; ",(0,n.kt)("em",{parentName:"a"},"destinationBox")," : Text ; ",(0,n.kt)("em",{parentName:"a"},"options")," : Object ) : Object"),(0,n.kt)("br",null),"ajoute un ",(0,n.kt)("inlineCode",{parentName:"td"},"mailObj")," \xe0 la bo\xeete ",(0,n.kt)("inlineCode",{parentName:"td"},"destinationBox"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#authenticationmode"}),(0,n.kt)("strong",{parentName:"a"},".authenticationMode")," : Text"),(0,n.kt)("br",null)," le mode d'authentification utilis\xe9 pour ouvrir la session sur le serveur de messagerie")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#checkconnection"}),(0,n.kt)("strong",{parentName:"a"},".checkConnection()")," : Object"),(0,n.kt)("br",null),"v\xe9rifie la connexion en utilisant les informations stock\xe9es dans l'objet transporteur")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#checkconnectiondelay"}),(0,n.kt)("strong",{parentName:"a"},".checkConnectionDelay")," : Integer"),(0,n.kt)("br",null),"la dur\xe9e maximale (en secondes) autoris\xe9e avant v\xe9rification de la connexion au serveur")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#connectiontimeout"}),(0,n.kt)("strong",{parentName:"a"},".connectionTimeOut")," : Integer"),(0,n.kt)("br",null),"le temps d'attente maximum (en secondes) autoris\xe9 pour \xe9tablir une connexion avec le serveur")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#copy"}),(0,n.kt)("strong",{parentName:"a"},".copy"),"( ",(0,n.kt)("em",{parentName:"a"},"msgsIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"a"},"destinationBox")," : Text ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".copy"),"( ",(0,n.kt)("em",{parentName:"a"},"allMsgs")," : Integer ; ",(0,n.kt)("em",{parentName:"a"},"destinationBox")," : Text ) : Object"),(0,n.kt)("br",null),"copie les messages d\xe9finis par ",(0,n.kt)("em",{parentName:"td"},"msgsIDs")," ou ",(0,n.kt)("em",{parentName:"td"},"allMsgs")," vers la ",(0,n.kt)("em",{parentName:"td"},"destinationBox")," sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#createbox"}),(0,n.kt)("strong",{parentName:"a"},".createBox"),"( ",(0,n.kt)("em",{parentName:"a"},"name")," :  Text ) : Object"),(0,n.kt)("br",null),"cr\xe9e une bo\xeete de r\xe9ception avec le ",(0,n.kt)("inlineCode",{parentName:"td"},"name")," pass\xe9 en param\xe8tre")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#delete"}),(0,n.kt)("strong",{parentName:"a"},".delete"),"( ",(0,n.kt)("em",{parentName:"a"},"msgsIDs")," : Collection ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".delete"),"( ",(0,n.kt)("em",{parentName:"a"},"allMsgs")," : Integer ) : Object"),(0,n.kt)("br",null),'associe le marqueur "deleted" aux messages d\xe9finis dans ',(0,n.kt)("inlineCode",{parentName:"td"},"msgsIDs")," ou ",(0,n.kt)("inlineCode",{parentName:"td"},"allMsgs"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#deletebox"}),(0,n.kt)("strong",{parentName:"a"},".deleteBox"),"( ",(0,n.kt)("em",{parentName:"a"},"name")," : Text ) : Object"),(0,n.kt)("br",null),"supprime d\xe9finitivement la bo\xeete de r\xe9ception nomm\xe9e ",(0,n.kt)("inlineCode",{parentName:"td"},"name")," sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#expunge"}),(0,n.kt)("strong",{parentName:"a"},".expunge()")," : Object"),(0,n.kt)("br",null),'supprime tous les messages marqu\xe9s "deleted" du serveur de messagerie IMAP.')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getboxinfo"}),(0,n.kt)("strong",{parentName:"a"},".getBoxInfo"),"( { ",(0,n.kt)("em",{parentName:"a"},"name")," : Text }) : Object"),(0,n.kt)("br",null),"retourne un objet ",(0,n.kt)("inlineCode",{parentName:"td"},"boxInfo")," correspondant \xe0 la bo\xeete de r\xe9ception courante ou \xe0 la bo\xeete de r\xe9ception nomm\xe9e ",(0,n.kt)("em",{parentName:"td"},"name"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getboxlist"}),(0,n.kt)("strong",{parentName:"a"},".getBoxList"),"( { ",(0,n.kt)("em",{parentName:"a"},"parameters")," : Object } ) : Collection"),(0,n.kt)("br",null),"retourne une collection de bo\xeetes aux lettres d\xe9crivant toutes les bo\xeetes aux lettres disponibles")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getdelimiter"}),(0,n.kt)("strong",{parentName:"a"},".getDelimiter()")," : Text"),(0,n.kt)("br",null),"retourne le caract\xe8re utilis\xe9 pour d\xe9limiter les niveaux de hi\xe9rarchie dans le nom de la bo\xeete aux lettres")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getmail"}),(0,n.kt)("strong",{parentName:"a"},".getMail"),"( ",(0,n.kt)("em",{parentName:"a"},"msgNumber"),": Integer { ; ",(0,n.kt)("em",{parentName:"a"},"options")," : Object } ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".getMail"),"( ",(0,n.kt)("em",{parentName:"a"},"msgID"),": Text { ; ",(0,n.kt)("em",{parentName:"a"},"options")," : Object } ) : Object"),(0,n.kt)("br",null),"retourne l'objet ",(0,n.kt)("inlineCode",{parentName:"td"},"Email")," correspondant au ",(0,n.kt)("em",{parentName:"td"},"msgNumber")," ou ",(0,n.kt)("em",{parentName:"td"},"msgID")," dans la boite de r\xe9ception d\xe9sign\xe9e par l'",(0,n.kt)("inlineCode",{parentName:"td"},"IMAP_transporter"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getmails"}),(0,n.kt)("strong",{parentName:"a"},".getMails"),"( ",(0,n.kt)("em",{parentName:"a"},"ids")," : Collection { ; ",(0,n.kt)("em",{parentName:"a"},"options")," : Object } ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".getMails"),"( ",(0,n.kt)("em",{parentName:"a"},"startMsg")," : Integer ; ",(0,n.kt)("em",{parentName:"a"},"endMsg")," : Integer { ; ",(0,n.kt)("em",{parentName:"a"},"options")," : Object } ) : Object"),(0,n.kt)("br",null),"retourne un objet contenant une collection d'objets ",(0,n.kt)("inlineCode",{parentName:"td"},"Email"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#getmimeasblob"}),(0,n.kt)("strong",{parentName:"a"},".getMIMEAsBlob"),"( ",(0,n.kt)("em",{parentName:"a"},"msgNumber")," : Integer { ; ",(0,n.kt)("em",{parentName:"a"},"updateSeen")," : Boolean } ) : Blob",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".getMIMEAsBlob"),"( ",(0,n.kt)("em",{parentName:"a"},"msgID")," : Text { ; ",(0,n.kt)("em",{parentName:"a"},"updateSeen")," : Boolean } ) : Blob"),(0,n.kt)("br",null),"retourne un BLOB avec le contenu MIME du message correspondant au ",(0,n.kt)("em",{parentName:"td"},"msgNumber")," ou ",(0,n.kt)("em",{parentName:"td"},"msgID")," dans la bo\xeete de r\xe9ception d\xe9sign\xe9e par le ",(0,n.kt)("inlineCode",{parentName:"td"},"IMAP_transporter"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#host"}),(0,n.kt)("strong",{parentName:"a"},".host")," : Text"),(0,n.kt)("br",null),"le nom ou l'adresse IP du serveur h\xf4te")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#logfile"}),(0,n.kt)("strong",{parentName:"a"},".logFile")," : Text"),(0,n.kt)("br",null),"le chemin du fichier journal \xe9tendu d\xe9fini (le cas \xe9ch\xe9ant) pour la connexion de messagerie")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#move"}),(0,n.kt)("strong",{parentName:"a"},".move"),"( ",(0,n.kt)("em",{parentName:"a"},"msgsIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"a"},"destinationBox")," : Text ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".move"),"( ",(0,n.kt)("em",{parentName:"a"},"allMsgs")," : Integer ; ",(0,n.kt)("em",{parentName:"a"},"destinationBox")," : Text ) : Object"),(0,n.kt)("br",null),"d\xe9place les messages d\xe9finis par ",(0,n.kt)("em",{parentName:"td"},"msgsIDs")," ou ",(0,n.kt)("em",{parentName:"td"},"allMsgs")," vers la ",(0,n.kt)("em",{parentName:"td"},"destinationBox")," sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#numtoid"}),(0,n.kt)("strong",{parentName:"a"},".numToID"),"( ",(0,n.kt)("em",{parentName:"a"},"startMsg")," : Integer ; ",(0,n.kt)("em",{parentName:"a"},"endMsg")," : Integer ) : Collection"),(0,n.kt)("br",null),"convertit les num\xe9ros de s\xe9quence en identifiants uniques IMAP pour les messages de la plage s\xe9quentielle d\xe9sign\xe9e par ",(0,n.kt)("em",{parentName:"td"},"startMsg")," et ",(0,n.kt)("em",{parentName:"td"},"endMsg"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#removeflags"}),(0,n.kt)("strong",{parentName:"a"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Text ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"a"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"a"},"msgIDs")," : Longint ; ",(0,n.kt)("em",{parentName:"a"},"keywords")," :  Object ) : Object"),(0,n.kt)("br",null),"supprime les flags (drapeaux) des ",(0,n.kt)("inlineCode",{parentName:"td"},"msgIDs")," pour les ",(0,n.kt)("inlineCode",{parentName:"td"},"keywords")," sp\xe9cifi\xe9s")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#renamebox"}),(0,n.kt)("strong",{parentName:"a"},".renameBox"),"( ",(0,n.kt)("em",{parentName:"a"},"currentName")," : Text ; ",(0,n.kt)("em",{parentName:"a"},"newName")," : Text ) : Object"),(0,n.kt)("br",null),"change le nom d'une bo\xeete de r\xe9ception sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#port"}),(0,n.kt)("strong",{parentName:"a"},".port")," : Integer"),(0,n.kt)("br",null),"le num\xe9ro de port utilis\xe9 pour les transactions de courrier")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#searchmails"}),(0,n.kt)("strong",{parentName:"a"},".searchMails"),"( ",(0,n.kt)("em",{parentName:"a"},"searchCriteria")," : Text ) : Collection"),(0,n.kt)("br",null),"recherche les messages qui correspondent aux crit\xe8res de recherche ",(0,n.kt)("em",{parentName:"td"},"searchCriteria")," dans la bo\xeete aux lettres courante")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#selectbox"}),(0,n.kt)("strong",{parentName:"a"},".selectBox"),"( ",(0,n.kt)("em",{parentName:"a"},"name")," : Text { ; ",(0,n.kt)("em",{parentName:"a"},"state")," : Integer } ) : Object"),(0,n.kt)("br",null),"s\xe9lectionne la bo\xeete de r\xe9ception ",(0,n.kt)("em",{parentName:"td"},"name")," comme bo\xeete de r\xe9ception courante")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#subscribe"}),(0,n.kt)("strong",{parentName:"a"},".subscribe"),"( ",(0,n.kt)("em",{parentName:"a"},"name")," : Text ) : Object"),(0,n.kt)("br",null),"permet d'ajouter la bo\xeete sp\xe9cifi\xe9e \xe0 l'ensemble des bo\xeetes auxquelles vous avez \"souscrit\" sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#unsubscribe"}),(0,n.kt)("strong",{parentName:"a"},".unsubscribe"),"( ",(0,n.kt)("em",{parentName:"a"},"name")," : Text ) : Object"),(0,n.kt)("br",null),'supprime la bo\xeete sp\xe9cifi\xe9e de l\'ensemble des bo\xeetes auxquelles vous avez "souscrit"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#user"}),(0,n.kt)("strong",{parentName:"a"},".user")," : Text"),(0,n.kt)("br",null),"le nom d'utilisateur utilis\xe9 pour l'authentification sur le serveur de messagerie")))),(0,n.kt)("h2",r({},{id:"imap-new-transporter"}),"IMAP New transporter"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"IMAP New transporter"),"( ",(0,n.kt)("em",{parentName:"p"},"server")," : Object ) : 4D.IMAPTransporter"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"server"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Informations sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.IMAPTransporter"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#objet-imap-transporter"}),"Objet transporteur IMAP"))))),(0,n.kt)("h4",r({},{id:"description"}),"Description"),(0,n.kt)("p",null,"La commande ",(0,n.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"configure une nouvelle connexion IMAP en fonction du param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"server")," et retourne un nouvel objet ",(0,n.kt)("em",{parentName:"p"},"transporter"),". L'objet transporteur retourn\xe9 sera alors utilis\xe9 pour la r\xe9ception d'emails."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"server"),", passez un objet contenant les propri\xe9t\xe9s suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"th"},"server")),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur par d\xe9faut (si omise)"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#acceptunsecureconnection"}),(0,n.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : Boolean"),(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"td"},"True")," si 4D est autoris\xe9 \xe0 \xe9tablir une connexion non chiffr\xe9e"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"False")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),".",(0,n.kt)("strong",{parentName:"td"},"accessTokenOAuth2")," : Text",(0,n.kt)("br",null),".",(0,n.kt)("strong",{parentName:"td"},"accessTokenOAuth2")," : Object",(0,n.kt)("br",null),"Cha\xeene ou objet token repr\xe9sentant les informations d'autorisation OAuth2. Utilis\xe9 uniquement avec OAUTH2 ",(0,n.kt)("inlineCode",{parentName:"td"},"authenticationMode"),". Si ",(0,n.kt)("inlineCode",{parentName:"td"},"accessTokenOAuth2")," est utilis\xe9 mais que ",(0,n.kt)("inlineCode",{parentName:"td"},"authenticationMode")," est omis, le protocole OAuth 2 est utilis\xe9 (si le serveur l'autorise). Non retourn\xe9 en objet ",(0,n.kt)("em",{parentName:"td"},(0,n.kt)("a",r({parentName:"em"},{href:"#imap-transporter-object"}),"IMAP transporter")),"."),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"aucun")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#authenticationmode"}),(0,n.kt)("strong",{parentName:"a"},".authenticationMode")," : Text"),(0,n.kt)("br",null)," le mode d'authentification utilis\xe9 pour ouvrir la session sur le serveur de messagerie"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"le mode d'authentification le plus s\xfbr pris en charge par le serveur est utilis\xe9")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#checkconnectiondelay"}),(0,n.kt)("strong",{parentName:"a"},".checkConnectionDelay")," : Integer"),(0,n.kt)("br",null),"la dur\xe9e maximale (en secondes) autoris\xe9e avant v\xe9rification de la connexion au serveur"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"300")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#connectiontimeout"}),(0,n.kt)("strong",{parentName:"a"},".connectionTimeOut")," : Integer"),(0,n.kt)("br",null),"le temps d'attente maximum (en secondes) autoris\xe9 pour \xe9tablir une connexion avec le serveur"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"30")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#host"}),(0,n.kt)("strong",{parentName:"a"},".host")," : Text"),(0,n.kt)("br",null),"le nom ou l'adresse IP du serveur h\xf4te"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"td"},"obligatoire"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#logfile"}),(0,n.kt)("strong",{parentName:"a"},".logFile")," : Text"),(0,n.kt)("br",null),"le chemin du fichier journal \xe9tendu d\xe9fini (le cas \xe9ch\xe9ant) pour la connexion de messagerie"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"aucun")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),".",(0,n.kt)("strong",{parentName:"td"},"password")," : Text",(0,n.kt)("br",null),"Mot de passe utilisateur pour l'authentification sur le serveur. Non retourn\xe9 en objet ",(0,n.kt)("em",{parentName:"td"},(0,n.kt)("a",r({parentName:"em"},{href:"#imap-transporter-object"}),"IMAP transporter")),"."),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"aucun")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#port"}),(0,n.kt)("strong",{parentName:"a"},".port")," : Integer"),(0,n.kt)("br",null),"le num\xe9ro de port utilis\xe9 pour les transactions de courrier"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"993")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#user"}),(0,n.kt)("strong",{parentName:"a"},".user")," : Text"),(0,n.kt)("br",null),"le nom d'utilisateur utilis\xe9 pour l'authentification sur le serveur de messagerie"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"aucun")))),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Attention")," : Assurez-vous que le timeout d\xe9fini est inf\xe9rieur au timeout du serveur, sinon le timeout du client sera inutile.")),(0,n.kt)("h4",r({},{id:"r\xe9sultat"}),"R\xe9sultat"),(0,n.kt)("p",null,"La fonction retourne un ",(0,n.kt)("a",r({parentName:"p"},{href:"#objet-imap-transporter"}),(0,n.kt)("strong",{parentName:"a"},"objet transporteur IMAP")),". Toutes les propri\xe9t\xe9s retourn\xe9es sont en ",(0,n.kt)("strong",{parentName:"p"},"lecture seule"),"."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"La connexion IMAP est automatiquement ferm\xe9e lorsque l'objet transporteur est d\xe9truit.")),(0,n.kt)("h4",r({},{id:"exemple"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'$server:=New object\n$server.host:="imap.gmail.com" //Obligatoire\n$server.port:=993\n$server.user:="4d@gmail.com"\n$server.password:="XXXXXXXX"\n$server.logFile:="LogTest.txt" //log \xe0 sauvegarder dans le dossier Logs\n\nvar $transporter : 4D.IMAPTransporter\n $transporter:=IMAP New transporter($server)\n\n$status:=$transporter.checkConnection()\nIf(Not($status.success))\n   ALERT("An error occurred: "+$status.statusText)\nEnd if\n')),(0,n.kt)("h2",r({},{id:"4dimaptransporternew"}),"4D.IMAPTransporter.new()"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"4D.IMAPTransporter.new"),"( ",(0,n.kt)("em",{parentName:"p"},"server")," : Object ) : 4D.IMAPTransporter"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"server"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Informations sur le serveur IMAP")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.IMAPTransporter"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#objet-imap-transporter"}),"Objet transporteur IMAP"))))),(0,n.kt)("h4",r({},{id:"description-1"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.IMAPTransporter.new()")," cr\xe9e et retourne un nouvel objet de type ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.IMAPTransporter"),". Elle est identique \xe0 la commande ",(0,n.kt)("a",r({parentName:"p"},{href:"#imap-new-transporter"}),(0,n.kt)("inlineCode",{parentName:"a"},"IMAP New transporter"))," (raccourci)."),(0,n.kt)("h2",r({},{id:"acceptunsecureconnection"}),".acceptUnsecureConnection"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".acceptUnsecureConnection")," : Boolean"),(0,n.kt)("h4",r({},{id:"description-2"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".acceptUnsecureConnection")," contient ",(0,n.kt)("strong",{parentName:"p"},"True")," si 4D est autoris\xe9 \xe0 \xe9tablir une connexion non chiffr\xe9e lorsqu'une connexion chiffr\xe9e n'est pas possible."),(0,n.kt)("p",null,"Elle contient ",(0,n.kt)("strong",{parentName:"p"},"False")," si les connexions non chiffr\xe9es ne sont pas autoris\xe9es, auquel cas une erreur est retourn\xe9e lorsque la connexion chiffr\xe9e n'est pas possible."),(0,n.kt)("p",null,"Ports s\xe9curis\xe9s disponibles :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"SMTP"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"465: SMTPS"),(0,n.kt)("li",{parentName:"ul"},"587 ou 25 : SMTP avec mise \xe0 niveau STARTTLS si le serveur le prend en charge."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"IMAP"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"143 : Port IMAP non chiffr\xe9"),(0,n.kt)("li",{parentName:"ul"},"993 : IMAP avec mise \xe0 niveau STARTTLS si le serveur le prend en charge"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"POP3"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"110 : Port POP3 non chiffr\xe9"),(0,n.kt)("li",{parentName:"ul"},"995 : POP3 avec mise \xe0 niveau STARTTLS si le serveur le prend en charge.")))),(0,n.kt)("h2",r({},{id:"addflags"}),".addFlags()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"20"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Prise en charge des mots-cl\xe9s personnalis\xe9s (custom keywords)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R6"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Text ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".addFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Longint  ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgIDs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection de cha\xeenes : IDs uniques des messages (texte)",(0,n.kt)("br",null),"Texte : ID unique d'un message",(0,n.kt)("br",null),"Num\xe9rique (IMAP all) : Tous les messages de la bo\xeete s\xe9lectionn\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"keywords"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Mots-cl\xe9s de flags \xe0 ajouter")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration addFlags")))),(0,n.kt)("h4",r({},{id:"description-3"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".addFlags()")," ajoute des flags (drapeaux) aux ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs")," pour les ",(0,n.kt)("inlineCode",{parentName:"p"},"keywords")," sp\xe9cifi\xe9s."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs"),", vous pouvez passer soit :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"une ",(0,n.kt)("em",{parentName:"li"},"collection")," contenant les IDs uniques de messages sp\xe9cifiques, ou"),(0,n.kt)("li",{parentName:"ul"},"l'ID unique (",(0,n.kt)("em",{parentName:"li"},"texte"),") d'un seul message ou"),(0,n.kt)("li",{parentName:"ul"},"la constante suivante (",(0,n.kt)("em",{parentName:"li"},"entier long"),") pour tous les messages de la bo\xeete s\xe9lectionn\xe9e :")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constante"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"IMAP all"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"1"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"S\xe9lectionner tous les messages de la bo\xeete s\xe9lectionn\xe9e")))),(0,n.kt)("p",null,"Le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"keywords")," permet de d\xe9finir les flags \xe0 ajouter aux ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs"),". Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalis\xe9s (la prise en charge des flags personnalis\xe9s d\xe9pend de l'impl\xe9mentation du serveur) :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$draft"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour ajouter le marqueur "draft" au message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$seen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour ajouter le marqueur "seen" au message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$flagged"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour ajouter le marqueur "flagged" au message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$answered"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour ajouter le marqueur "answered" au message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$deleted"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour ajouter le marqueur "deleted" au message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"<custom flag>")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"True pour ajouter le flag personnalis\xe9 au message")))),(0,n.kt)("p",null,"Les noms des flags personnalis\xe9s doivent respecter cette r\xe8gle : le mot-cl\xe9 doit \xeatre une cha\xeene non sensible \xe0 la casse, excluant les caract\xe8res de contr\xf4le et les espaces, et ne peut inclure aucun de ces caract\xe8res : ",(0,n.kt)("inlineCode",{parentName:"p"},'( ) { ] % * " \\')),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Pour qu'un mot-cl\xe9 soit pris en compte, il doit \xeatre \xe0 vrai."),(0,n.kt)("li",{parentName:"ul"},"L'interpr\xe9tation des indicateurs de mots-cl\xe9s peut varier selon le client de messagerie."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-1"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $options;$transporter;$boxInfo;$status : Object\n\n$options:=New object\n$options.host:="imap.gmail.com"\n$options.port:=993\n$options.user:="4d@gmail.com"\n$options.password:="xxxxx"\n\n// Cr\xe9er transporteur\n$transporter:=IMAP New transporter($options)\n\n// S\xe9lectionner la bo\xeete de messagerie\n$boxInfo:=$transporter.selectBox("INBOX")\n\n// Marquer tous les messages de la boite de r\xe9ception (INBOX) comme \xe9tant lus/vus\n$flags:=New object\n$flags["$seen"]:=True\n$status:=$transporter.addFlags(IMAP all;$flags)\n')),(0,n.kt)("h2",r({},{id:"append"}),".append()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R6"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".append"),"( ",(0,n.kt)("em",{parentName:"p"},"mailObj")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," : Text ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mailObj"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet email")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"destinationBox"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Mailbox devant recevoir l'objet email")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"options"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet contenant les informations de charset")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration")))),(0,n.kt)("h4",r({},{id:"description-4"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".append()")," ajoute un ",(0,n.kt)("inlineCode",{parentName:"p"},"mailObj")," \xe0 la bo\xeete ",(0,n.kt)("inlineCode",{parentName:"p"},"destinationBox"),"."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"mailObj"),", passez un objet email. Pour une description d\xe9taill\xe9e des propri\xe9t\xe9s de mail, reportez-vous \xe0 ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass#objet-email"}),"Objet Email"),". La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".append()")," prend en charge les marqueurs de mots-cl\xe9s dans l'attribut ",(0,n.kt)("inlineCode",{parentName:"p"},"keywords")," des objets email."),(0,n.kt)("p",null,"Le param\xe8tre optionnel ",(0,n.kt)("inlineCode",{parentName:"p"},"destinationBox")," vous permet de passer le nom de la bo\xeete de r\xe9ception dans laquelle l'objet ",(0,n.kt)("inlineCode",{parentName:"p"},"mailObj")," sera ajout\xe9. S'il est omis, la mailbox courante sera utilis\xe9e."),(0,n.kt)("p",null,"Dans le param\xe8tre optionnel ",(0,n.kt)("inlineCode",{parentName:"p"},"options"),", vous pouvez passer un objet permettant de d\xe9finir le charset et l'encodage des diff\xe9rentes parties de l'email. Propri\xe9t\xe9s disponibles :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"headerCharset"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Charset et encodage utilis\xe9s pour les parties de mail suivantes : le sujet, les noms de fichiers joints et le nom du mail. Valeurs possibles : voir le tableau des charsets possibles")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"bodyCharset"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Charset et encodage utilis\xe9s pour le contenu html et le texte du body du mail. Valeurs possibles : voir le tableau des charsets possibles")))),(0,n.kt)("p",null,"Charsets possibles :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constante"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail mode ISO2022JP"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"US-ASCII_ISO-2022-JP_UTF8_QP"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("ul",null,(0,n.kt)("li",null,"headerCharset : US-ASCII si possible, Japanese (ISO-2022-JP) & Quoted-printable si possible, sinon UTF-8 & Quoted-printable"),(0,n.kt)("li",null,"bodyCharset : US-ASCII si possible, Japanese (ISO-2022-JP) & 7-bit si possible, sinon UTF-8 & Quoted-printable")))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail mode ISO88591"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ISO-8859-1"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("ul",null,(0,n.kt)("li",null,"headerCharset : ISO-8859-1 & Quoted-printable"),(0,n.kt)("li",null,"bodyCharset : ISO-8859-1 & 8-bit")))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail mode UTF8"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"US-ASCII_UTF8_QP"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"headerCharset & bodyCharset : US-ASCII si possible, sinon UTF-8 & Quoted-printable (",(0,n.kt)("strong",{parentName:"td"},"valeur par d\xe9faut"),")")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mail mode UTF8 in base64"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"US-ASCII_UTF8_B64"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"headerCharset &bodyCharset : US-ASCII si possible, sinon UTF-8 & base64")))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-2"}),"Exemple"),(0,n.kt)("p",null,"Pour enregistrer un email dans la bo\xeete Drafts :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $settings; $status; $msg; $imap: Object\n\n$settings:=New object("host"; "domain.com"; "user"; "xxxx"; "password"; "xxxx"; "port"; 993)\n\n$imap:=IMAP New transporter($settings)\n\n$msg:=New object\n$msg.from:="xxxx@domain.com"\n$msg.subject:="Lorem Ipsum"\n$msg.textBody:="Lorem ipsum dolor sit amet, consectetur adipiscing elit."\n$msg.keywords:=New object\n$msg.keywords["$seen"]:=True //marquer le message comme \xe9tant lu\n$msg.keywords["$draft"]:=True //marquer le message comme brouillon\n\n$status:=$imap.append($msg; "Drafts")\n')),(0,n.kt)("h2",r({},{id:"authenticationmode"}),".authenticationMode"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".authenticationMode")," : Text"),(0,n.kt)("h4",r({},{id:"description-5"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".authenticationMode")," contient  le mode d'authentification utilis\xe9 pour ouvrir la session sur le serveur de messagerie."),(0,n.kt)("p",null,"Par d\xe9faut, le mode le plus s\xe9curis\xe9 pris en charge par le serveur est utilis\xe9."),(0,n.kt)("p",null,"Valeurs possibles :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constantes"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"CRAM-MD5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP authentication CRAM MD5")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole CRAM-MD5")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"LOGIN"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP authentication login")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole LOGIN")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"OAUTH2"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP authentication OAUTH2")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole OAuth2")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"PLAIN"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP authentication plain")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Authentification \xe0 l'aide du protocole PLAIN")))),(0,n.kt)("h2",r({},{id:"checkconnection"}),".checkConnection()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".checkConnection()")," : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de la connexion de l'objet transporteur")))),(0,n.kt)("h4",r({},{id:"description-6"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".checkConnection()")," v\xe9rifie la connexion en utilisant les informations stock\xe9es dans l'objet transporteur, recr\xe9e la connexion si n\xe9cessaire et renvoie le statut. Cette fonction vous permet de v\xe9rifier que les valeurs fournies par l'utilisateur sont valides et coh\xe9rentes."),(0,n.kt)("h4",r({},{id:"objet-retourn\xe9"}),"Objet retourn\xe9"),(0,n.kt)("p",null,"La fonction envoie une requ\xeate au serveur de mail et retourne un objet d\xe9crivant le statut. Cet objet peut avoir les propri\xe9t\xe9s suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si la v\xe9rification a \xe9t\xe9 effectu\xe9e avec succ\xe8s, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"status"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"(SMTP uniquement) Code du statut retourn\xe9 par le serveur de messagerie (0 en cas de probl\xe8me non li\xe9 au traitement du mail)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur de messagerie, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur de messagerie est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"["," ].errCode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"["," ].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"["," ].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h2",r({},{id:"checkconnectiondelay"}),".checkConnectionDelay"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".checkConnectionDelay")," : Integer"),(0,n.kt)("h4",r({},{id:"description-7"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".checkConnectionDelay")," contient la dur\xe9e maximale (en secondes) autoris\xe9e avant v\xe9rification de la connexion au serveur.  Si cette dur\xe9e est d\xe9pass\xe9e entre deux appels de m\xe9thodes, la connexion au serveur sera v\xe9rifi\xe9e. Par d\xe9faut, si la propri\xe9t\xe9 n'a pas \xe9t\xe9 d\xe9finie dans l'objet ",(0,n.kt)("em",{parentName:"p"},"server"),", la valeur est de 300."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Attention")," : Assurez-vous que le timeout d\xe9fini est inf\xe9rieur au timeout du serveur, sinon le timeout du client sera inutile.")),(0,n.kt)("h2",r({},{id:"connectiontimeout"}),".connectionTimeOut"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".connectionTimeOut")," : Integer"),(0,n.kt)("h4",r({},{id:"description-8"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".connectionTimeOut")," contient le temps d'attente maximum (en secondes) autoris\xe9 pour \xe9tablir une connexion avec le serveur. Par d\xe9faut, si la propri\xe9t\xe9 n'a pas \xe9t\xe9 d\xe9finie dans l'objet server (utilis\xe9 pour cr\xe9er l'objet transporteur avec ",(0,n.kt)("inlineCode",{parentName:"p"},"SMTP New transporter"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"), la valeur utilis\xe9e est 30."),(0,n.kt)("h2",r({},{id:"copy"}),".copy()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".copy"),"( ",(0,n.kt)("em",{parentName:"p"},"msgsIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," : Text ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".copy"),"( ",(0,n.kt)("em",{parentName:"p"},"allMsgs")," : Integer ; ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgsIDs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'IDs uniques de messages (texte)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"allMsgs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP all")," : tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"destinationBox"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Bo\xeete de r\xe9ception recevant les messages copi\xe9s")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration de copie")))),(0,n.kt)("h4",r({},{id:"description-9"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".copy()")," copie les messages d\xe9finis par ",(0,n.kt)("em",{parentName:"p"},"msgsIDs")," ou ",(0,n.kt)("em",{parentName:"p"},"allMsgs")," vers la ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," sur le serveur IMAP."),(0,n.kt)("p",null,"Vous pouvez passer :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("em",{parentName:"li"},"msgsIDs"),", une collection contenant les ID uniques des messages sp\xe9cifiques \xe0 copier, ou"),(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("em",{parentName:"li"},"allMsgs"),", la constante ",(0,n.kt)("inlineCode",{parentName:"li"},"IMAP all")," (integer) pour copier tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e.")),(0,n.kt)("p",null,"Le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," vous permet de passer une valeur texte avec le nom de la bo\xeete de r\xe9ception dans laquelle seront plac\xe9s les messages copi\xe9s."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-1-1"}),"Exemple 1"),(0,n.kt)("p",null,"Pour copier une s\xe9lection de messages :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $mailIds : Collection\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Obligatoire\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //s\xe9lectionner la boite de r\xe9ception\n $boxInfo:=$transporter.selectBox("inbox")\n\n  //obtenir la collection des IDs uniques de message\n $mailIds:=$transporter.searchMails("subject \\"4D new feature:\\"")\n\n  // copier les messages identifi\xe9s dans la bo\xeete de r\xe9ception "documents"\n $status:=$transporter.copy($mailIds;"documents")\n')),(0,n.kt)("h4",r({},{id:"exemple-2-1"}),"Exemple 2"),(0,n.kt)("p",null,"Pour copier tous les messages de la bo\xeete de r\xe9ception courante :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Obligatoire\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //s\xe9lectionner la boite de r\xe9ception\n\n $boxInfo:=$transporter.selectBox("inbox")\n\n  // copier les messages dans la bo\xeete de r\xe9ception "documents"\n $status:=$transporter.copy(IMAP all;"documents")\n')),(0,n.kt)("h2",r({},{id:"createbox"}),".createBox()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".createBox"),"( ",(0,n.kt)("em",{parentName:"p"},"name")," :  Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la nouvelle mailbox")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration de cr\xe9ation de mailbox")))),(0,n.kt)("h4",r({},{id:"description-10"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".createBox()")," cr\xe9e une bo\xeete de r\xe9ception avec le ",(0,n.kt)("inlineCode",{parentName:"p"},"name")," pass\xe9 en param\xe8tre. Si le caract\xe8re s\xe9parateur de hi\xe9rarchie du serveur IMAP appara\xeet dans le nom de la mailbox, le serveur IMAP cr\xe9era tous les bo\xeetes parentes n\xe9cessaires pour cr\xe9er la bo\xeete donn\xe9e."),(0,n.kt)("p",null,'Par exemple, si vous essayez de cr\xe9er "Projects/IMAP/Doc" dans un serveur dont le "/" est le caract\xe8re s\xe9parateur de hi\xe9rarchie, les \xe9l\xe9ments suivants seront cr\xe9\xe9s :'),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},'Uniquement la bo\xeete "Doc" si "Projects" & "IMAP" existent d\xe9j\xe0.'),(0,n.kt)("li",{parentName:"ul"},'Les bo\xeetes "IMAP" & "Doc" si seule \u201cProjects\u201d existe d\xe9j\xe0.'),(0,n.kt)("li",{parentName:"ul"},'Les bo\xeetes "Projects" & \u201cIMAP\u201d & "Doc" si elles n\'existent pas d\xe9j\xe0.')),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"name"),", passez le nom de la mailbox \xe0 cr\xe9er."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-3"}),"Exemple"),(0,n.kt)("p",null,"Pour cr\xe9er une nouvelle bo\xeete \u201cInvoices\u201d :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\nIf(OK=1)\n$options.host:="imap.gmail.com"\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n$status:=$transporter.createBox("Invoices")\n\nIf ($status.success)\nALERT("Mailbox creation successful!")\nElse\nALERT("Error: "+$status.statusText)\nEnd if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"delete"}),".delete()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".delete"),"( ",(0,n.kt)("em",{parentName:"p"},"msgsIDs")," : Collection ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".delete"),"( ",(0,n.kt)("em",{parentName:"p"},"allMsgs")," : Integer ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgsIDs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'IDs uniques de messages (texte)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"allMsgs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP all")," : tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration de suppression")))),(0,n.kt)("h4",r({},{id:"description-11"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".delete()"),' associe le marqueur "deleted" aux messages d\xe9finis dans ',(0,n.kt)("inlineCode",{parentName:"p"},"msgsIDs")," ou ",(0,n.kt)("inlineCode",{parentName:"p"},"allMsgs"),"."),(0,n.kt)("p",null,"Vous pouvez passer :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"li"},"msgsIDs"),", une collection contenant les ID uniques des messages sp\xe9cifiques \xe0 supprimer, ou"),(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"li"},"allMsgs"),", la constante ",(0,n.kt)("inlineCode",{parentName:"li"},"IMAP all")," (integer) pour supprimer tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e.")),(0,n.kt)("p",null,'L\'ex\xe9cution de cette fonction ne supprime pas r\xe9ellement les messages. Les messages ayant le marqueur "deleted" peuvent toujours \xeatre trouv\xe9s par la fonction ',(0,n.kt)("a",r({parentName:"p"},{href:"#searchmails"}),".searchMails()"),". Les messages marqu\xe9s sont supprim\xe9s du serveur IMAP avec la fonction ",(0,n.kt)("a",r({parentName:"p"},{href:"#expunge"}),(0,n.kt)("inlineCode",{parentName:"a"},".expunge()"))," ou en s\xe9lectionnant une autre bo\xeete de r\xe9ception ou lorsque l'objet ",(0,n.kt)("a",r({parentName:"p"},{href:"#imap-transporter-object"}),"transporter")," (cr\xe9\xe9 avec ",(0,n.kt)("a",r({parentName:"p"},{href:"#imap-new-transporter"}),"IMAP New transporter"),") est d\xe9truit."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-1-2"}),"Exemple 1"),(0,n.kt)("p",null,"Pour supprimer une s\xe9lection de messages :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $mailIds : Collection\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //select mailbox\n $boxInfo:=$transporter.selectBox("Inbox")\n\n  //get collection of message unique IDs\n $mailIds:=$transporter.searchMails("subject \\"Reports\\"")\n\n  // Delete selected messages\n $status:=$transporter.delete($mailIds)\n')),(0,n.kt)("h4",r({},{id:"exemple-2-2"}),"Exemple 2"),(0,n.kt)("p",null,"Pour supprimer tous les messages de la bo\xeete de r\xe9ception courante :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //select mailbox\n $boxInfo:=$transporter.selectBox("Junk Email")\n\n  // delete all messages in the current mailbox\n $status:=$transporter.delete(IMAP all)\n')),(0,n.kt)("h2",r({},{id:"deletebox"}),".deleteBox()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".deleteBox"),"( ",(0,n.kt)("em",{parentName:"p"},"name")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception \xe0 supprimer")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration de suppression de bo\xeete")))),(0,n.kt)("h4",r({},{id:"description-12"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".deleteBox()")," supprime d\xe9finitivement la bo\xeete de r\xe9ception nomm\xe9e ",(0,n.kt)("inlineCode",{parentName:"p"},"name")," sur le serveur IMAP. Si vous tentez de supprimer la bo\xeete INBOX ou une bo\xeete de r\xe9ception qui n'existe pas, une erreur sera g\xe9n\xe9r\xe9e."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"name"),", passez le nom de la mailbox \xe0 supprimer."),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},'La fonction ne peut pas supprimer une bo\xeete de r\xe9ception contenant des bo\xeetes "enfant" si la bo\xeete "parente" dispose de l\'attribute "\\Noselect".'),(0,n.kt)("li",{parentName:"ul"},"Tous les messages pr\xe9sents dans la bo\xeete seront \xe9galement supprim\xe9s."),(0,n.kt)("li",{parentName:"ul"},"La possibilit\xe9 de supprimer une bo\xeete de r\xe9ception d\xe9pend du serveur de messagerie."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-4"}),"Exemple"),(0,n.kt)("p",null,'Vous souhaitez supprimer la bo\xeete enfant "Nova Orion Industries" \xe0 l\'int\xe9rieur de la bo\xeete "Bills" :'),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw; $name : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\n\nIf(OK=1) $options.host:="imap.gmail.com"\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n// delete mailbox\n$name:="Bills"+$transporter.getDelimiter()+"Nova Orion Industries"\n$status:=$transporter.deleteBox($name)\n\nIf ($status.success)\n ALERT("Mailbox deletion successful!")\n Else\n ALERT("Error: "+$status.statusText)\n End if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"expunge"}),".expunge()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R6"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".expunge()")," : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration expunge")))),(0,n.kt)("h4",r({},{id:"description-13"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".expunge()"),' supprime tous les messages marqu\xe9s "deleted" du serveur de messagerie IMAP. Le marqueur "deleted" peut \xeatre fix\xe9 avec les fonctions ',(0,n.kt)("a",r({parentName:"p"},{href:"#delete"}),(0,n.kt)("inlineCode",{parentName:"a"},".delete()"))," ou ",(0,n.kt)("a",r({parentName:"p"},{href:"#addflags"}),(0,n.kt)("inlineCode",{parentName:"a"},".addFlags()")),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-5"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $options;$transporter;$boxInfo;$status : Object\nvar $ids : Collection\n\n$options:=New object\n$options.host:="imap.gmail.com"\n$options.port:=993\n$options.user:="4d@gmail.com"\n$options.password:="xxxxx"\n\n// Creation du transporter\n$transporter:=IMAP New transporter($options)\n\n// S\xe9lection de la bo\xeete\n$boxInfo:=$transporter.selectBox("INBOX")\n\n// Chercher et s\xe9lectionner les messages lus dans INBOX\n$ids:=$transporter.searchMails("SEEN")\n$status:=$transporter.delete($ids)\n\n// Purger tous les messages marqu\xe9s deleted\n$status:=$transporter.expunge()\n')),(0,n.kt)("h2",r({},{id:"getboxinfo"}),".getBoxInfo()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"20"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"td"},"id")," est renvoy\xe9")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"td"},"name")," est optionnel")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getBoxInfo"),"( { ",(0,n.kt)("em",{parentName:"p"},"name")," : Text }) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet boxInfo")))),(0,n.kt)("h4",r({},{id:"description-14"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getBoxInfo()"),"retourne un objet ",(0,n.kt)("inlineCode",{parentName:"p"},"boxInfo")," correspondant \xe0 la bo\xeete de r\xe9ception courante ou \xe0 la bo\xeete de r\xe9ception nomm\xe9e ",(0,n.kt)("em",{parentName:"p"},"name"),". Cette fonction retourne les m\xeames informations que ",(0,n.kt)("a",r({parentName:"p"},{href:"#selectbox"}),(0,n.kt)("inlineCode",{parentName:"a"},".selectBox()"))," mais sans modifier la boite de r\xe9ception courante."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"name")," passez le nom de la mailbox \xe0 laquelle vous souhaitez acc\xe9der. Le nom doit repr\xe9senter une hi\xe9rarchie claire, de gauche \xe0 droite, avec des niveaux s\xe9par\xe9s par un caract\xe8re d\xe9limiteur sp\xe9cifique. Le d\xe9limiteur peut \xeatre r\xe9cup\xe9r\xe9 \xe0 l'aide de la fonction ",(0,n.kt)("a",r({parentName:"p"},{href:"#getdelimiter"}),(0,n.kt)("inlineCode",{parentName:"a"},".getDelimiter()")),"."),(0,n.kt)("p",null,"Si la bo\xeete de r\xe9ception nomm\xe9e ",(0,n.kt)("em",{parentName:"p"},"name")," n'est pas s\xe9lectionnable ou n'existe pas, la fonction g\xe9n\xe8re une erreur et retourne ",(0,n.kt)("strong",{parentName:"p"},"null"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"L'objet ",(0,n.kt)("inlineCode",{parentName:"p"},"boxInfo")," contient les propri\xe9t\xe9 suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mailCount"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nombre de messages contenus dans la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mailRecent"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Nombre de messages portant le marqueur "r\xe9cent" (indiquant les nouveaux messages)')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"id"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Identifiant unique de la bo\xeete aux lettres")))),(0,n.kt)("h4",r({},{id:"exemple-6"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $transporter : 4D.IMAPTransporter\n $transporter:=IMAP New transporter($server)\n\n $info:=$transporter.getBoxInfo("INBOX")\n ALERT("INBOX contains "+String($info.mailRecent)+" recent emails.")\n')),(0,n.kt)("h2",r({},{id:"getboxlist"}),".getBoxList()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"td"},"isSubscribed")))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getBoxList"),"( { ",(0,n.kt)("em",{parentName:"p"},"parameters")," : Object } ) : Collection"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"parameters"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet de param\xe8tre")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'objets mailbox")))),(0,n.kt)("h4",r({},{id:"description-15"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getBoxList()"),"retourne une collection de bo\xeetes aux lettres d\xe9crivant toutes les bo\xeetes aux lettres disponibles. Cette fonction vous permet de g\xe9rer localement les listes de messages situ\xe9s sur le serveur de messagerie IMAP."),(0,n.kt)("p",null,"Dans le param\xe8tre optionnel ",(0,n.kt)("inlineCode",{parentName:"p"},"parameters"),", passez un objet contenant des valeurs de filtrage des bo\xeetes de r\xe9ception retourn\xe9es. Vous pouvez passer :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"isSubscribed"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("li",null,(0,n.kt)("strong",{parentName:"td"},"True")," pour ne renvoyer que les bo\xeetes auxquelles vous \xeates abonn\xe9"),(0,n.kt)("li",null," ",(0,n.kt)("strong",{parentName:"td"},"False")," pour retourner toutes les bo\xeetes aux lettres disponibles"))))),(0,n.kt)("h4",r({},{id:"r\xe9sultat-1"}),"R\xe9sultat"),(0,n.kt)("p",null,"Chaque objet de la collection retourn\xe9e contient les propri\xe9t\xe9s suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].selectable"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Indique si les droits d'acc\xe8s permettent ou non de s\xe9lectionner la bo\xeete aux lettres : ",(0,n.kt)("ul",null,(0,n.kt)("li",null,"true - la bo\xeete aux lettres peut \xeatre s\xe9lectionn\xe9e"),(0,n.kt)("li",null,"false - la bo\xeete aux lettres ne peut pas \xeatre s\xe9lectionn\xe9e")))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].inferior"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Indique si les droits d'acc\xe8s permettent ou non de cr\xe9er une hi\xe9rarchie inf\xe9rieure dans la bo\xeete aux lettres : ",(0,n.kt)("ul",null,(0,n.kt)("li",null,"true - un niveau inf\xe9rieur peut \xeatre cr\xe9\xe9"),(0,n.kt)("li",null,"false - un niveau inf\xe9rieur ne peut pas \xeatre cr\xe9\xe9")))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].interesting"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Indique si la bo\xeete aux lettres a \xe9t\xe9 marqu\xe9e comme "int\xe9ressante" par le serveur : ',(0,n.kt)("ul",null,(0,n.kt)("li",null,'true - La bo\xeete aux lettres a \xe9t\xe9 marqu\xe9e comme "int\xe9ressante" par le serveur. Par exemple, elle peut contenir de nouveaux messages.'),(0,n.kt)("li",null,'false - La bo\xeete aux lettres n\'a pas \xe9t\xe9 marqu\xe9e comme "int\xe9ressante" par le serveur'),"."))))),(0,n.kt)("p",null,"Si le compte ne contient pas de boites de r\xe9ception, une collection vide est retourn\xe9e."),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Si aucune connexion n'est ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".getBoxList()")," ouvrira une connexion."),(0,n.kt)("li",{parentName:"ul"},"Si la connexion n'a pas \xe9t\xe9 utilis\xe9e depuis le d\xe9lai de connexion (voir ",(0,n.kt)("inlineCode",{parentName:"li"},"IMAP New transporter"),"), la fonction ",(0,n.kt)("inlineCode",{parentName:"li"},".checkConnection( )")," est automatiquement appel\xe9e."))),(0,n.kt)("h4",r({},{id:"exemple-7"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $transporter : 4D.IMAPTransporter\n $transporter:=IMAP New transporter($server)\n\n $boxList:=$transporter.getBoxList()\n\n For each($box;$boxList)\n    If($box.interesting)\n       $split:=Split string($box.name;$transporter.getDelimiter())\n       ALERT("New emails are available in the box: "+$split[$split.length-1])\n    End if\n End for each\n')),(0,n.kt)("h2",r({},{id:"getdelimiter"}),".getDelimiter()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getDelimiter()")," : Text"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Caract\xe8re de d\xe9limitation de hi\xe9rarchie")))),(0,n.kt)("h4",r({},{id:"description-16"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getDelimiter()"),"retourne le caract\xe8re utilis\xe9 pour d\xe9limiter les niveaux de hi\xe9rarchie dans le nom de la bo\xeete aux lettres."),(0,n.kt)("p",null,"Le d\xe9limiteur est un caract\xe8re pouvant \xeatre utilis\xe9 pour :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"cr\xe9er des boites de r\xe9ception de niveau inf\xe9rieur"),(0,n.kt)("li",{parentName:"ul"},"rechercher des niveaux inf\xe9rieurs ou sup\xe9rieurs dans la hi\xe9rarchie de la boite de r\xe9ception")),(0,n.kt)("h4",r({},{id:"r\xe9sultat-2"}),"R\xe9sultat"),(0,n.kt)("p",null,"Caract\xe8re de d\xe9limitation des noms de boites de r\xe9ception."),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Si aucune connexion n'est ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".getDelimiter()")," ouvrira une connexion."),(0,n.kt)("li",{parentName:"ul"},"Si la connexion n'a pas \xe9t\xe9 utilis\xe9e depuis la ",(0,n.kt)("a",r({parentName:"li"},{href:"#checkconnectiondelay"}),"dur\xe9e maximale d\xe9finie"),", la fonction ",(0,n.kt)("a",r({parentName:"li"},{href:"#checkconnection"}),(0,n.kt)("inlineCode",{parentName:"a"},".checkConnection()"))," est automatiquement appel\xe9e."))),(0,n.kt)("h4",r({},{id:"exemple-8"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $transporter : 4D.IMAPTransporter\n $transporter:=IMAP New transporter($server)\n\n $boxList:=$transporter.getBoxList()\n\n For each($box;$boxList)\n    If($box.interesting)\n       $split:=Split string($box.name;$transporter.getDelimiter())\n       ALERT("New emails are available in the box: "+$split[$split.length-1])\n    End if\n End for each\n')),(0,n.kt)("h2",r({},{id:"getmail"}),".getMail()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getMail"),"( ",(0,n.kt)("em",{parentName:"p"},"msgNumber"),": Integer { ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object } ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".getMail"),"( ",(0,n.kt)("em",{parentName:"p"},"msgID"),": Text { ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object } ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgNumber"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgID"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ID unique du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"options"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Instructions sur la gestion du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/EmailObjectClass#objet-email"}),"Objet Email"))))),(0,n.kt)("h4",r({},{id:"description-17"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getMail()")," retourne l'objet ",(0,n.kt)("inlineCode",{parentName:"p"},"Email")," correspondant au ",(0,n.kt)("em",{parentName:"p"},"msgNumber")," ou ",(0,n.kt)("em",{parentName:"p"},"msgID")," dans la boite de r\xe9ception d\xe9sign\xe9e par l'",(0,n.kt)("inlineCode",{parentName:"p"},"IMAP_transporter"),". Cette fonction vous permet de g\xe9rer localement le contenu de l'email."),(0,n.kt)("p",null,"Dans le premier param\xe8tre, vous pouvez passer soit :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"msgNumber"),", une valeur ",(0,n.kt)("em",{parentName:"li"},"integer")," indiquant le num\xe9ro de s\xe9quence du message \xe0 r\xe9cup\xe9rer ou"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"msgID"),", une valeur ",(0,n.kt)("em",{parentName:"li"},"text")," indiquant l'ID unique du message \xe0 r\xe9cup\xe9rer.")),(0,n.kt)("p",null,"Le param\xe8tre facultatif ",(0,n.kt)("em",{parentName:"p"},"options")," vous permet de passer un objet d\xe9finissant des instructions suppl\xe9mentaires pour la gestion de votre message. Les propri\xe9t\xe9s suivantes sont disponibles :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"updateSeen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Si Vrai, le message est marqu\xe9 comme "seen" (lu) dans la boite de r\xe9ception. Si Faux, le message n\'est pas marqu\xe9 comme "seen". Valeur par d\xe9faut : Vrai')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"withBody"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Passez Vrai pour retourner le corps du message. Si Faux, seul l'en-t\xeate du message est retourn\xe9. Valeur par d\xe9faut : Vrai")))),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"La fonction g\xe9n\xe8re une erreur et retourne ",(0,n.kt)("strong",{parentName:"li"},"Null")," si ",(0,n.kt)("em",{parentName:"li"},"msgID")," d\xe9signe un message non existant,"),(0,n.kt)("li",{parentName:"ul"},"Si aucune boite de r\xe9ception n'est s\xe9lectionn\xe9e avec la ",(0,n.kt)("a",r({parentName:"li"},{href:"#selectbox"}),"fonction ",(0,n.kt)("inlineCode",{parentName:"a"},".selectBox()")),", une erreur est g\xe9n\xe9r\xe9e,"),(0,n.kt)("li",{parentName:"ul"},"S'il n'y a pas de connexion ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".getMail()")," ouvrira une connexion avec la derni\xe8re boite de r\xe9ception sp\xe9cifi\xe9e \xe0 l'aide de ",(0,n.kt)("a",r({parentName:"li"},{href:"#selectbox"}),(0,n.kt)("inlineCode",{parentName:"a"},".selectBox()")),"`","."))),(0,n.kt)("h4",r({},{id:"r\xe9sultat-3"}),"R\xe9sultat"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},".getMail()")," retourne un ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass#objet-email"}),"objet ",(0,n.kt)("inlineCode",{parentName:"a"},"Email"))," avec les propri\xe9t\xe9s IMAP suivantes sp\xe9cifiques : ",(0,n.kt)("em",{parentName:"p"},"id"),", ",(0,n.kt)("em",{parentName:"p"},"receivedAt"),", et ",(0,n.kt)("em",{parentName:"p"},"size"),"."),(0,n.kt)("h4",r({},{id:"exemple-9"}),"Exemple"),(0,n.kt)("p",null,"Vous souhaitez lire le message avec ID = 1 :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server : Object\n var $info; $mail; $boxInfo : Variant\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n  //create transporter\n $transporter:=IMAP New transporter($server)\n\n  //select mailbox\n $boxInfo:=$transporter.selectBox("Inbox")\n\n  //get Email object with ID 1\n $mail:=$transporter.getMail(1)\n')),(0,n.kt)("h2",r({},{id:"getmails"}),".getMails()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getMails"),"( ",(0,n.kt)("em",{parentName:"p"},"ids")," : Collection { ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object } ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".getMails"),"( ",(0,n.kt)("em",{parentName:"p"},"startMsg")," : Integer ; ",(0,n.kt)("em",{parentName:"p"},"endMsg")," : Integer { ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object } ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ids"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'identifiants de messages")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"startMsg"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du premier message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"endMsg"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du dernier message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"options"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Instructions sur la gestion du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet contenant :",(0,n.kt)("br",null),(0,n.kt)("ul",null,(0,n.kt)("li",null,"une collection d'","[objets Email]"," (EmailObjectClass.md#objet-email) et"),(0,n.kt)("li",null,"une collection d'ID ou de num\xe9ros pour les messages manquants, le cas \xe9ch\xe9ant")))))),(0,n.kt)("h4",r({},{id:"description-18"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getMails()"),"retourne un objet contenant une collection d'objets ",(0,n.kt)("inlineCode",{parentName:"p"},"Email"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Premi\xe8re syntaxe :")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},".getMails( ids { ; options } ) -> result"))),(0,n.kt)("p",null,"La premi\xe8re syntaxe vous permet de r\xe9cup\xe9rer des messages en fonction de leurs identifiants."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"ids"),", passez une collection d'identifiants des messages \xe0 retourner. Vous pouvez obtenir les ID \xe0 l'aide de ",(0,n.kt)("a",r({parentName:"p"},{href:"#getmail"}),(0,n.kt)("inlineCode",{parentName:"a"},".getMail()")),"."),(0,n.kt)("p",null,"Le param\xe8tre optionnel ",(0,n.kt)("em",{parentName:"p"},"options")," vous permet de d\xe9finir les parties de messages \xe0 retourner. Pour une description d\xe9taill\xe9e des propri\xe9t\xe9s disponibles, reportez-vous au tableau ",(0,n.kt)("strong",{parentName:"p"},"Options")," ci-dessous."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Deuxi\xe8me syntaxe :")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},".getMails( startMsg ; endMsg { ; options } ) -> result"))),(0,n.kt)("p",null,"La deuxi\xe8me syntaxe vous permet de r\xe9cup\xe9rer des messages en fonction d'une plage s\xe9quentielle. Les valeurs pass\xe9es repr\xe9sentent la position des messages dans la boite de r\xe9ception."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"startMsg"),", passez une valeur integer correspondant au num\xe9ro du premier message dans la plage s\xe9quentielle. Si vous passez un nombre n\xe9gatif (",(0,n.kt)("em",{parentName:"p"},"startMsg")," <= 0), le premier message de la bo\xeete de r\xe9ception sera utilis\xe9 comme d\xe9but de la s\xe9quence."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"endMsg"),", passez une valeur integer correspondant au num\xe9ro du dernier message dans la plage s\xe9quentielle. Si vous passez un nombre n\xe9gatif (",(0,n.kt)("em",{parentName:"p"},"endMsg")," <= 0), le dernier message de la bo\xeete de r\xe9ception sera utilis\xe9 comme fin de s\xe9quence."),(0,n.kt)("p",null,"Le param\xe8tre optionnel ",(0,n.kt)("em",{parentName:"p"},"options")," vous permet de d\xe9finir les parties de messages \xe0 retourner."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Options")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"updateSeen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Si Vrai, les messages sont marqu\xe9s comme "seen" (lus) dans la boite de r\xe9ception. Si Faux, les messages ne sont pas marqu\xe9s comme "seen". Valeur par d\xe9faut : Vrai')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"withBody"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Passez Vrai pour retourner le corps des messages sp\xe9cifi\xe9s. Si Faux, seuls les en-t\xeate des messages sont retourn\xe9s. Valeur par d\xe9faut : Vrai")))),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Si aucune boite de r\xe9ception n'est s\xe9lectionn\xe9e avec ",(0,n.kt)("a",r({parentName:"li"},{href:"#selectbox"}),(0,n.kt)("inlineCode",{parentName:"a"},".selectBox()")),", une erreur est g\xe9n\xe9r\xe9e."),(0,n.kt)("li",{parentName:"ul"},"S'il n'y a pas de connexion ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".getMails()")," ouvrira une connexion avec la derni\xe8re boite de r\xe9ception sp\xe9cifi\xe9e \xe0 l'aide de ",(0,n.kt)("a",r({parentName:"li"},{href:"#selectbox"}),(0,n.kt)("inlineCode",{parentName:"a"},"selectBox()")),"."))),(0,n.kt)("h4",r({},{id:"r\xe9sultat-4"}),"R\xe9sultat"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},".getMails()")," retourne un objet contenant les collections suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"liste"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'",(0,n.kt)("a",r({parentName:"td"},{href:"/docs/fr/API/EmailObjectClass#objet-email"}),"objets Email"),". Si aucun objet Email n'est trouv\xe9, une collection vide est retourn\xe9e.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"notFound"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection de :",(0,n.kt)("br",null),(0,n.kt)("ul",null,(0,n.kt)("li",null,"premi\xe8re syntaxe - ID de messages pass\xe9s pr\xe9c\xe9demment qui n'existent pas"),(0,n.kt)("li",null,"deuxi\xe8me syntaxe - num\xe9ros de s\xe9quence des messages entre startMsg et endMsg qui n'existent pas.")),"Une collection vide est renvoy\xe9e si tous les messages ont \xe9t\xe9 trouv\xe9s.")))),(0,n.kt)("h4",r({},{id:"exemple-10"}),"Exemple"),(0,n.kt)("p",null,'Vous souhaitez r\xe9cup\xe9rer les 20 emails les plus r\xe9cents sans modifier le statut "seen" :'),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server,$boxInfo,$result : Object\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n  //create transporter\n $transporter:=IMAP New transporter($server)\n\n  //select mailbox\n $boxInfo:=$transporter.selectBox("INBOX")\n\n  If($boxInfo.mailCount>0)\n  // retrieve the headers of the last 20 messages without marking them as read\n    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\\\n     New object("withBody";False;"updateSeen";False))\n    For each($mail;$result.list)\n    // ...\n    End for each\n End if\n')),(0,n.kt)("h2",r({},{id:"getmimeasblob"}),".getMIMEAsBlob()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".getMIMEAsBlob"),"( ",(0,n.kt)("em",{parentName:"p"},"msgNumber")," : Integer { ; ",(0,n.kt)("em",{parentName:"p"},"updateSeen")," : Boolean } ) : Blob",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".getMIMEAsBlob"),"( ",(0,n.kt)("em",{parentName:"p"},"msgID")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"updateSeen")," : Boolean } ) : Blob"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgNumber"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgID"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ID unique du message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"updateSeen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Si Vrai, le message est marqu\xe9 comme "seen" (lu) dans la boite de r\xe9ception. Si Faux, le message demeure inchang\xe9.')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"BLOB"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Blob de la chaine MIME retourn\xe9e par le serveur mail")))),(0,n.kt)("h4",r({},{id:"description-19"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," retourne un BLOB avec le contenu MIME du message correspondant au ",(0,n.kt)("em",{parentName:"p"},"msgNumber")," ou ",(0,n.kt)("em",{parentName:"p"},"msgID")," dans la bo\xeete de r\xe9ception d\xe9sign\xe9e par le ",(0,n.kt)("inlineCode",{parentName:"p"},"IMAP_transporter"),"."),(0,n.kt)("p",null,"Dans le premier param\xe8tre, vous pouvez passer soit :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"msgNumber"),", une valeur ",(0,n.kt)("em",{parentName:"li"},"integer")," indiquant le num\xe9ro de s\xe9quence du message \xe0 r\xe9cup\xe9rer ou"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"msgID"),", une valeur ",(0,n.kt)("em",{parentName:"li"},"text")," indiquant l'ID unique du message \xe0 r\xe9cup\xe9rer.")),(0,n.kt)("p",null,"Le param\xe8tre optionnel ",(0,n.kt)("em",{parentName:"p"},"updateSeen"),' vous permet d\'indiquer si le message est marqu\xe9 comme "seen" (lu) dans la bo\xeete de r\xe9ception. Vous pouvez passer :'),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Vrai"),' - pour marquer le message comme "seen" (indiquant que le message a \xe9t\xe9 lu)'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Faux"),' - pour ne pas modifier le statut "seen" du message')),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"La fonction retourne un BLOB vide si ",(0,n.kt)("em",{parentName:"li"},"msgNumber")," ou msgID d\xe9signe un message inexistant,"),(0,n.kt)("li",{parentName:"ul"},"Si aucune boite de r\xe9ception n'est s\xe9lectionn\xe9e avec ",(0,n.kt)("a",r({parentName:"li"},{href:"#selectbox"}),(0,n.kt)("inlineCode",{parentName:"a"},".selectBox()")),", une erreur est g\xe9n\xe9r\xe9e,"),(0,n.kt)("li",{parentName:"ul"},"S'il n'y a pas de connexion ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".getMIMEAsBlob()")," ouvrira une connexion avec la derni\xe8re boite de r\xe9ception sp\xe9cifi\xe9e \xe0 l'aide de ",(0,n.kt)("inlineCode",{parentName:"li"},".selectBox()"),"."))),(0,n.kt)("h4",r({},{id:"r\xe9sultat-5"}),"R\xe9sultat"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," renvoie un ",(0,n.kt)("inlineCode",{parentName:"p"},"BLOB")," qui peut \xeatre archiv\xe9 dans une base de donn\xe9es ou converti en un objet ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/fr/API/EmailObjectClass#objet-email"}),(0,n.kt)("inlineCode",{parentName:"a"},"Email"))," avec la commande ",(0,n.kt)("inlineCode",{parentName:"p"},"MAIL Convert from MIME"),"."),(0,n.kt)("h4",r({},{id:"exemple-11"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server : Object\n var $boxInfo : Variant\n var $blob : Blob\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com"\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n  //create transporter\n $transporter:=IMAP New transporter($server)\n\n  //select mailbox\n $boxInfo:=$transporter.selectBox("Inbox")\n\n  //get BLOB\n $blob:=$transporter.getMIMEAsBlob(1)\n')),(0,n.kt)("h2",r({},{id:"host"}),".host"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".host")," : Text"),(0,n.kt)("h4",r({},{id:"description-20"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".host")," contient le nom ou l'adresse IP du serveur h\xf4te. Utilis\xe9e pour les \xe9changes de courrier (SMTP, POP3, IMAP)."),(0,n.kt)("h2",r({},{id:"logfile"}),".logFile"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".logFile")," : Text"),(0,n.kt)("h4",r({},{id:"description-21"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".logFile")," contient le chemin du fichier journal \xe9tendu d\xe9fini (le cas \xe9ch\xe9ant) pour la connexion de messagerie. Le chemin peut \xeatre relatif (au dossier Logs courant) ou absolu."),(0,n.kt)("p",null,"Contrairement aux fichiers log habituels (activ\xe9s via la commande ",(0,n.kt)("inlineCode",{parentName:"p"},"SET DATABASE PARAMETER"),"), les fichiers log \xe9tendus stockent le contenu MIME de tous les emails envoy\xe9s et n'ont pas de limite de taille. Pour plus d'informations sur les fichiers log \xe9tendus, reportez-vous \xe0 :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Connexions SMTP")," - ",(0,n.kt)("a",r({parentName:"li"},{href:"/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DSMTPLog.txt")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Connexions POP3")," - ",(0,n.kt)("a",r({parentName:"li"},{href:"/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DPOP3Log.txt")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Connexions IMAP")," - ",(0,n.kt)("a",r({parentName:"li"},{href:"/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt"}),"4DIMAPLog.txt"))),(0,n.kt)("h2",r({},{id:"move"}),".move()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".move"),"( ",(0,n.kt)("em",{parentName:"p"},"msgsIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," : Text ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".move"),"( ",(0,n.kt)("em",{parentName:"p"},"allMsgs")," : Integer ; ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgsIDs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'IDs uniques de messages (texte)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"allMsgs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"IMAP all")," : tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"destinationBox"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Bo\xeete de r\xe9ception recevant les messages d\xe9plac\xe9s")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration de d\xe9placement")))),(0,n.kt)("h4",r({},{id:"description-22"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".move()")," d\xe9place les messages d\xe9finis par ",(0,n.kt)("em",{parentName:"p"},"msgsIDs")," ou ",(0,n.kt)("em",{parentName:"p"},"allMsgs")," vers la ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," sur le serveur IMAP."),(0,n.kt)("p",null,"Vous pouvez passer :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("em",{parentName:"li"},"msgsIDs"),", une collection contenant les ID uniques des messages sp\xe9cifiques \xe0 d\xe9placer, ou"),(0,n.kt)("li",{parentName:"ul"},"dans le param\xe8tre ",(0,n.kt)("em",{parentName:"li"},"allMsgs"),", la constante ",(0,n.kt)("inlineCode",{parentName:"li"},"IMAP all")," (integer) pour d\xe9placer tous les messages de la bo\xeete de r\xe9ception s\xe9lectionn\xe9e.")),(0,n.kt)("p",null,"Le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"destinationBox")," vous permet de passer une valeur texte avec le nom de la bo\xeete de r\xe9ception dans laquelle seront plac\xe9s les messages d\xe9plac\xe9s."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Cette fonction est uniquement prise en charge par les serveurs IMAP compatibles avec RFC ",(0,n.kt)("a",r({parentName:"p"},{href:"https://tools.ietf.org/html/rfc8474"}),"8474"),".")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-1-3"}),"Exemple 1"),(0,n.kt)("p",null,"Pour d\xe9placer une s\xe9lection de messages :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $mailIds : Collection\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //s\xe9lectionner la boite de r\xe9ception\n $boxInfo:=$transporter.selectBox("inbox")\n\n  //obtenir une collection d\'IDs uniques de messages\n $mailIds:=$transporter.searchMails("subject \\"4D new feature:\\"")\n\n  // d\xe9placer les messages trouv\xe9s de la boite courante vers la boite "documents"\n $status:=$transporter.move($mailIds;"documents")\n')),(0,n.kt)("h4",r({},{id:"exemple-2-3"}),"Exemple 2"),(0,n.kt)("p",null,"Pour d\xe9placer tous les messages de la bo\xeete de r\xe9ception courante :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server;$boxInfo;$status : Object\n var $transporter : 4D.IMAPTransporter\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //s\xe9lectionner la boite de r\xe9ception\n $boxInfo:=$transporter.selectBox("inbox")\n\n  // d\xe9placer tous les messages de la boite courante vers la boite "documents"\n $status:=$transporter.move(IMAP all;"documents")\n')),(0,n.kt)("h2",r({},{id:"numtoid"}),".numToID()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".numToID"),"( ",(0,n.kt)("em",{parentName:"p"},"startMsg")," : Integer ; ",(0,n.kt)("em",{parentName:"p"},"endMsg")," : Integer ) : Collection"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"startMsg"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du premier message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"endMsg"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Num\xe9ro de s\xe9quence du dernier message")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection d'identifiants de messages uniques")))),(0,n.kt)("h4",r({},{id:"description-23"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".numToID()")," convertit les num\xe9ros de s\xe9quence en identifiants uniques IMAP pour les messages de la plage s\xe9quentielle d\xe9sign\xe9e par ",(0,n.kt)("em",{parentName:"p"},"startMsg")," et ",(0,n.kt)("em",{parentName:"p"},"endMsg")," dans la bo\xeete de r\xe9ception courante."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"startMsg")," passez une valeur ",(0,n.kt)("em",{parentName:"p"},"entier")," correspondant au num\xe9ro du premier message dans une plage s\xe9quentielle. Si vous passez un nombre n\xe9gatif (",(0,n.kt)("em",{parentName:"p"},"startMsg")," <= 0), le premier message de la bo\xeete de r\xe9ception sera utilis\xe9 comme d\xe9but de la s\xe9quence."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("em",{parentName:"p"},"endMsg")," passez une valeur ",(0,n.kt)("em",{parentName:"p"},"entier long")," correspondant au num\xe9ro du dernier message \xe0 inclure dans une plage s\xe9quentielle. Si vous passez un nombre n\xe9gatif (",(0,n.kt)("em",{parentName:"p"},"endMsg")," <= 0), le dernier message de la bo\xeete de r\xe9ception sera utilis\xe9 comme fin de s\xe9quence."),(0,n.kt)("h4",r({},{id:"r\xe9sultat-6"}),"R\xe9sultat"),(0,n.kt)("p",null,"La fonction retourne une collection de cha\xeenes (IDs uniques)."),(0,n.kt)("h4",r({},{id:"exemple-12"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $transporter : 4D.IMAPTransporter\n var $server;$boxInfo;$status : Object\n var $mailIds : Collection\n\n $server:=New object\n $server.host:="imap.gmail.com" //Mandatory\n $server.port:=993\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n $transporter:=IMAP New transporter($server)\n\n  //S\xe9lectionner la boite de r\xe9ception\n $boxInfo:=$transporter.selectBox("inbox")\n\n  //obtenir les IDs des 5 derniers messages re\xe7us\n $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)\n\n  //supprimer les messages de la boite courante\n $status:=$transporter.delete($mailIds)\n')),(0,n.kt)("h2",r({},{id:"removeflags"}),".removeFlags()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"20"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Prise en charge des mots-cl\xe9s personnalis\xe9s (custom keywords)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R6"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Collection ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Text ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object",(0,n.kt)("br",null),(0,n.kt)("strong",{parentName:"p"},".removeFlags"),"( ",(0,n.kt)("em",{parentName:"p"},"msgIDs")," : Longint ; ",(0,n.kt)("em",{parentName:"p"},"keywords")," :  Object ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"msgIDs"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection de cha\xeenes : IDs uniques des messages (texte)",(0,n.kt)("br",null),"Texte : ID unique d'un message",(0,n.kt)("br",null),"Num\xe9rique (IMAP all) : Tous les messages de la bo\xeete s\xe9lectionn\xe9e")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"keywords"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Mots-cl\xe9s de flags \xe0 supprimer")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration removeFlags")))),(0,n.kt)("h4",r({},{id:"description-24"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".removeFlags()")," supprime les flags (drapeaux) des ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs")," pour les ",(0,n.kt)("inlineCode",{parentName:"p"},"keywords")," sp\xe9cifi\xe9s."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs"),", vous pouvez passer soit :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"une ",(0,n.kt)("em",{parentName:"li"},"collection")," contenant les IDs uniques de messages sp\xe9cifiques, ou"),(0,n.kt)("li",{parentName:"ul"},"l'ID unique (",(0,n.kt)("em",{parentName:"li"},"texte"),") d'un seul message ou"),(0,n.kt)("li",{parentName:"ul"},"la constante suivante (",(0,n.kt)("em",{parentName:"li"},"entier long"),") pour tous les messages de la bo\xeete s\xe9lectionn\xe9e :")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constante"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"IMAP all"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"1"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"S\xe9lectionner tous les messages de la bo\xeete s\xe9lectionn\xe9e")))),(0,n.kt)("p",null,"Le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"keywords")," vous permet de d\xe9finir les flags \xe0 supprimer des ",(0,n.kt)("inlineCode",{parentName:"p"},"msgIDs"),". Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalis\xe9s :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$draft"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour supprimer le marqueur "draft" du message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$seen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour supprimer le marqueur "seen" du message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$flagged"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour supprimer le marqueur "flagged" du message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$answered"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour supprimer le marqueur "answered" du message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"$deleted"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'True pour supprimer le marqueur "deleted" du message')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("inlineCode",{parentName:"td"},"<custom flag>")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"True pour supprimer le flag personnalis\xe9 du message")))),(0,n.kt)("p",null,"Reportez-vous \xe0 ",(0,n.kt)("a",r({parentName:"p"},{href:"#addflags"}),".addFlags()")," pour plus d'informations sur les flags personnalis\xe9s."),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Pour qu'un mot-cl\xe9 soit pris en compte, il doit \xeatre \xe0 vrai."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-13"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\n\nIf(OK=1) $options.host:="imap.gmail.com"\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n// renommer la boite de r\xe9ception\n$status:=$transporter.renameBox("Invoices"; "Bills")\n\nIf ($status.success)\n   ALERT("Mailbox renaming successful!")\n   Else\n   ALERT("Error: "+$status.statusText)\n End if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"renamebox"}),".renameBox()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".renameBox"),"( ",(0,n.kt)("em",{parentName:"p"},"currentName")," : Text ; ",(0,n.kt)("em",{parentName:"p"},"newName")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"currentName"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom actuel de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"nouveauNom"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la nouvelle mailbox")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration renaming")))),(0,n.kt)("h4",r({},{id:"description-25"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".renameBox()")," change le nom d'une bo\xeete de r\xe9ception sur le serveur IMAP. Essayer de renommer une mailbox qui n'existe pas ou de renommer une mailbox avec un nom qui est d\xe9j\xe0 utilis\xe9 g\xe9n\xe8re une erreur."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"currentName"),", passez le nom de la mailbox \xe0 renommer."),(0,n.kt)("p",null,"Passez le nouveau nom de la mailbox dans e param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"newName"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-14"}),"Exemple"),(0,n.kt)("p",null,"Pour renommer la mailbox \u201cInvoices\u201d en \u201cBills\u201d:"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\n\nIf(OK=1) $options.host:="imap.gmail.com"\n\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n// renommer la boite de r\xe9ception\n$status:=$transporter.renameBox("Invoices"; "Bills")\n\nIf ($status.success)\n   ALERT("Mailbox renaming successful!")\n   Else\n   ALERT("Error: "+$status.statusText)\n End if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"port"}),".port"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".port")," : Integer"),(0,n.kt)("h4",r({},{id:"description-26"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".port")," contient le num\xe9ro de port utilis\xe9 pour les transactions de courrier. Par d\xe9faut, si la propri\xe9t\xe9 ",(0,n.kt)("em",{parentName:"p"},"port")," n'a pas \xe9t\xe9 d\xe9finie dans l'objet ",(0,n.kt)("em",{parentName:"p"},"server")," (utilis\xe9 pour cr\xe9er l'objet transporteur avec ",(0,n.kt)("inlineCode",{parentName:"p"},"SMTP New transporter"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"), le port utilis\xe9 est :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"SMTP")," - 587"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"POP3")," - 995"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"IMAP")," - 993")),(0,n.kt)("h2",r({},{id:"searchmails"}),".searchMails()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R5"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".searchMails"),"( ",(0,n.kt)("em",{parentName:"p"},"searchCriteria")," : Text ) : Collection"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"searchCriteria"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Crit\xe8re(s) de recherche")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection de num\xe9ros de messages")))),(0,n.kt)("h4",r({},{id:"description-27"}),"Description"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Cette fonction est bas\xe9e sur la sp\xe9cification du ",(0,n.kt)("a",r({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol"}),"protocole IMAP"),".")),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".searchMails()")," recherche les messages qui correspondent aux crit\xe8res de recherche ",(0,n.kt)("em",{parentName:"p"},"searchCriteria")," dans la bo\xeete aux lettres courante. ."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"searchCriteria")," est un param\xe8tre texte listant un ou plusieurs crit\xe8res de recherche (voir ",(0,n.kt)("a",r({parentName:"p"},{href:"#mots-cles-de-recherche-autorises"}),"Mots-cl\xe9s de recherche autoris\xe9s")," ci-dessous) associ\xe9s ou non \xe0 des valeurs \xe0 rechercher. Un crit\xe8re de recherche peut \xeatre compos\xe9 d'un ou plusieurs \xe9l\xe9ments. Par exemple :"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),"SearchKey1 = FLAGGED\nSearchKey2 = NOT FLAGGED\nSearchKey3 = FLAGGED DRAFT\n")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"La correspondance n'est g\xe9n\xe9ralement pas sensible \xe0 la casse")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Si ",(0,n.kt)("em",{parentName:"li"},"searchCriteria"),' est une cha\xeene vide, la recherche sera \xe9quivalente \xe0 un "tout s\xe9lectionner".'),(0,n.kt)("li",{parentName:"ul"},"Si ",(0,n.kt)("em",{parentName:"li"},"searchCriteria")," contient plusieurs mots-cl\xe9s de recherche, le r\xe9sultat est l'intersection (fonction ET) de tous les messages qui correspondent \xe0 ces crit\xe8res.")),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),'searchCriteria = FLAGGED FROM "SMITH"\n')),(0,n.kt)("p",null,"... retourne tous les messages avec le marqueur \\Flagged activ\xe9 ET envoy\xe9s par Smith."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Vous pouvez utiliser les op\xe9rateurs ",(0,n.kt)("strong",{parentName:"li"},"OR")," ou ",(0,n.kt)("strong",{parentName:"li"},"NOT")," comme suit :")),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),"searchCriteria = OR SEEN FLAGGED\n")),(0,n.kt)("p",null,"... retourne tous les messages comportant le marqueur \\Seen OU \\Flagged"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),"searchCriteria = NOT SEEN\n")),(0,n.kt)("p",null,"... retourne tous les messages ne comportant pas le marqueur \\Seen."),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),'searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...\n')),(0,n.kt)("p",null,"... retourne les messages dont l'en-t\xeate content-type contient \u201cMixed\u201d et ne contient pas \u201cText\u201d."),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),'searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"\n')),(0,n.kt)("p",null,"... retourne les messages dont l'en-t\xeate content-type contient \u201c e \u201d et dont l'en-t\xeate Subject ne contient pas \u201c o \u201d et dont l'en-t\xeate content-type n'est pas \u201c Mixed \u201d."),(0,n.kt)("p",null,"A noter que dans les deux derniers exemples, le r\xe9sultat de la recherche est diff\xe9rent lorsque vous enlevez les parenth\xe8ses de la premi\xe8re liste de mots-cl\xe9s."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Le param\xe8tre ",(0,n.kt)("em",{parentName:"li"},"searchCriteria")," peut inclure optionnellement l'instruction ","[",'CHARSET]. Cette instruction est compos\xe9e du mot "CHARSET" suivi d\'un jeu de caract\xe8res d\xe9fini ',"[","CHARSET] (US ASCII, ISO-8859). Elle indique le codage de caract\xe8res utilis\xe9 dans la chaine ",(0,n.kt)("em",{parentName:"li"},"searchCriteria"),". Par cons\xe9quent, vous devez convertir la cha\xeene ",(0,n.kt)("em",{parentName:"li"},"searchCriteria")," dans le jeu de caract\xe8res sp\xe9cifi\xe9 si vous utilisez l'instruction ","[","CHARSET] (voir les commandes ",(0,n.kt)("inlineCode",{parentName:"li"},"CONVERT FROM TEXT")," ou ",(0,n.kt)("inlineCode",{parentName:"li"},"Convert to text"),').\nPar d\xe9faut, 4D encode la cha\xeene de crit\xe8res searchCriteria en "Quotable Printable" si elle contient des caract\xe8res \xe9tendus.')),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{}),'searchCriteria = CHARSET "ISO-8859" BODY "Help"\n')),(0,n.kt)("p",null,"... signifie que le crit\xe8re de recherche utilise le jeu de caract\xe8res iso-8859 et que le serveur devra convertir la cha\xeene avant la recherche, si n\xe9cessaire."),(0,n.kt)("h4",r({},{id:"mots-cl\xe9s-de-recherche-autoris\xe9s"}),"Mots-cl\xe9s de recherche autoris\xe9s"),(0,n.kt)("p",null,"Les mots-cl\xe9s de recherche peuvent traiter des valeurs des types suivants :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Valeurs de type date")," : Les valeurs de type date sont plac\xe9es dans des cha\xeenes format\xe9es de la mani\xe8re suivante : ",(0,n.kt)("em",{parentName:"p"},'date-day+"-"+date-month+"-"+date-year')," o\xf9 date-day indique la date du jour dans le mois (2 caract\xe8res maxi), date-month indique le mois (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) et date-year indique l\u2019ann\xe9e sur 4 chiffres.\nExemple : ",(0,n.kt)("inlineCode",{parentName:"p"},"searchCriteria = SENTBEFORE 1-Feb-2020")," (il n\u2019est g\xe9n\xe9ralement pas n\xe9cessaire de mettre une date entre guillemets puisqu\u2019elle ne contient pas de caract\xe8res sp\xe9ciaux)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"*","*","Valeurs de type cha\xeene\n","*","*"," : Les valeurs de type cha\xeene peuvent contenir tout type de caract\xe8re et doivent \xeatre plac\xe9es entre des guillemets. Toutefois, si la cha\xeene ne contient pas de caract\xe8res sp\xe9ciaux (des espaces par exemple), les guillemets ne sont pas obligatoires. Dans tous les cas, les guillemets vous permettent de vous assurer que la cha\xeene sera correctement interpr\xe9t\xe9e.\nExample: ",(0,n.kt)("inlineCode",{parentName:"p"},'searchCriteria = FROM "SMITH"')," For all search keys that use strings, a message matches the key if the string is a substring of the field. La recherche ne tient pas compte de la casse des caract\xe8res.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Noms de champs")," : Les valeurs de type nom de champ contiennent le nom d\u2019un champ d\u2019en-t\xeate.\nExemple : ",(0,n.kt)("inlineCode",{parentName:"p"},'searchCriteria = HEADER CONTENT-TYPE "MIXED"'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Marqueurs")," : Les valeurs de type marqueur (flags) acceptent un ou plusieurs mots-cl\xe9s (y compris des marqueurs standard) s\xe9par\xe9s par des espaces.\nExemple : ",(0,n.kt)("inlineCode",{parentName:"p"},"searchCriteria = KEYWORD \\Flagged \\Draft"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Ensemble de messages")," : Les valeurs de ce type d\xe9signent un ensemble de messages. Elles contiennent une liste de num\xe9ros de messages dans un ordre croissant, de 1 au nombre total de messages dans la bo\xeete aux lettres. Les num\xe9ros sont s\xe9par\xe9s par des virgules ; un deux-points (:) indique un intervalle (inclusif) de num\xe9ros.\nExamples: ",(0,n.kt)("inlineCode",{parentName:"p"},"2,4:7,9,12:*")," is ",(0,n.kt)("inlineCode",{parentName:"p"},"2,4,5,6,7,9,12,13,14,15")," for a mailbox with 15 messages.\n",(0,n.kt)("inlineCode",{parentName:"p"},"searchCriteria = 1:5 ANSWERED")," recherche, parmi les messages 1 \xe0 5, ceux qui comportent le marqueur \\Answered.\n",(0,n.kt)("inlineCode",{parentName:"p"},"searchCriteria= 2,4 ANSWERED")," recherche, parmi les messages 2 et 4, ceux qui comportent le marqueur \\Answered."))),(0,n.kt)("h4",r({},{id:"mots-cl\xe9s-de-recherche-autoris\xe9s-1"}),"Mots-cl\xe9s de recherche autoris\xe9s"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"ALL"),": Tous les messages dans la bo\xeete de r\xe9ception.\\\n",(0,n.kt)("strong",{parentName:"p"},"ANSWERED")," : Messages avec l'indicateur \\Answered activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNANSWERED")," : Messages pour lesquels l'indicateur \\Answered n'est pas activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"DELETED")," : Messages dont l'indicateur \\Deleted est activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNDELETED")," : Messages pour lesquels l'indicateur \\Deleted n'a pas \xe9t\xe9 activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"DRAFT")," : Messages dont l'indicateur \\Draft est activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNDRAFT")," : Messages pour lesquels l'indicateur \\Draft n'est pas activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"FLAGGED")," : Messages avec le drapeau \\Flagged activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNFLAGGED")," : Messages pour lesquels l'indicateur \\Flagged n'est pas activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"RECENT")," : Messages dont l'indicateur \\Recent est activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"OLD")," : Messages pour lesquels l'indicateur \\Recent n'a pas \xe9t\xe9 activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"SEEN")," : Messages pour lesquels l'indicateur \\Seen est activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNSEEN")," : Messages pour lesquels l'indicateur \\Seen n'est pas activ\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"NOUVEAU")," : Messages pour lesquels l'indicateur \\Recent est activ\xe9 mais pas l'indicateur \\Seen. Equivaut \xe0 \u201c(RECENT UNSEEN)\u201d.\\\n",(0,n.kt)("strong",{parentName:"p"},"KEYWORD ",(0,n.kt)("em",{parentName:"strong"},"flag"))," : Messages avec le jeu de mots-cl\xe9s sp\xe9cifi\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"UNKEYWORD ",(0,n.kt)("em",{parentName:"strong"},"flag"))," : Messages ne contenant pas le mot-cl\xe9 sp\xe9cifi\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"BEFORE ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont la date interne est ant\xe9rieure \xe0 la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"ON ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont la date interne est comprise dans la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"SINCE ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont la date interne est ant\xe9rieure ou post\xe9rieure \xe0 la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"SENTBEFORE ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont l'en-t\xeate Date est ant\xe9rieur \xe0 la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"SENTON ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont l'en-t\xeate Date est compris dans la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"SENTSINCE ",(0,n.kt)("em",{parentName:"strong"},"date"))," : Messages dont l'en-t\xeate Date est inf\xe9rieur ou sup\xe9rieur \xe0 la date sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"TO ",(0,n.kt)("em",{parentName:"strong"},"string"))," : Messages contenant la cha\xeene de caract\xe8res sp\xe9cifi\xe9e dans l'en-t\xeate TO.\\\n",(0,n.kt)("strong",{parentName:"p"},"FROM ",(0,n.kt)("em",{parentName:"strong"},"string")),": Messages contenant la cha\xeene sp\xe9cifi\xe9e dans l\u2019en-t\xeate Emetteur.\\\n",(0,n.kt)("strong",{parentName:"p"},"CC ",(0,n.kt)("em",{parentName:"strong"},"string"))," : Messages contenant la cha\xeene sp\xe9cifi\xe9e dans l'en-t\xeate CC.\\\n",(0,n.kt)("strong",{parentName:"p"},"BCC ",(0,n.kt)("em",{parentName:"strong"},"string"))," : Messages contenant la cha\xeene sp\xe9cifi\xe9e dans l'en-t\xeate BCC.\\\n",(0,n.kt)("strong",{parentName:"p"},"SUBJECT ",(0,n.kt)("em",{parentName:"strong"},"string"))," : Messages qui contiennent la cha\xeene sp\xe9cifi\xe9e dans l'en-t\xeate Subject .\\\n",(0,n.kt)("strong",{parentName:"p"},"BODY ",(0,n.kt)("em",{parentName:"strong"},"string"))," : Messages qui contiennent la cha\xeene sp\xe9cifi\xe9e dans le body du message.\\\n",(0,n.kt)("strong",{parentName:"p"},"TEXT ",(0,n.kt)("em",{parentName:"strong"},"cha\xeene"))," : Messages contenant la cha\xeene sp\xe9cifi\xe9e dans l'en-t\xeate ou dans le corps du message.\\\n",(0,n.kt)("strong",{parentName:"p"},"HEADER ",(0,n.kt)("em",{parentName:"strong"},"field-name")," ",(0,n.kt)("em",{parentName:"strong"},"string")),": Messages qui ont un en-t\xeate avec le nom de champ sp\xe9cifi\xe9 et qui contiennent la cha\xeene sp\xe9cifi\xe9e dans le field-body.\\\n",(0,n.kt)("strong",{parentName:"p"},"UID ",(0,n.kt)("em",{parentName:"strong"},"message-UID"))," : Messages avec des identifiants uniques correspondant au jeu d'identifiants uniques sp\xe9cifi\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"LARGER ",(0,n.kt)("em",{parentName:"strong"},"n"))," : Messages dont la taille est sup\xe9rieure au nombre d'octets sp\xe9cifi\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"SMALLER ",(0,n.kt)("em",{parentName:"strong"},"n"))," : Messages dont la taille est inf\xe9rieure au nombre d'octets sp\xe9cifi\xe9.\\\n",(0,n.kt)("strong",{parentName:"p"},"NOT ",(0,n.kt)("em",{parentName:"strong"},"search-key"))," : Messages ne correspondant pas \xe0 la cl\xe9 de recherche sp\xe9cifi\xe9e.\\\n",(0,n.kt)("strong",{parentName:"p"},"OR ",(0,n.kt)("em",{parentName:"strong"},"search-key1")," ",(0,n.kt)("em",{parentName:"strong"},"search-key2"))," : Messages qui correspondent \xe0 l'un des deux mots cl\xe9s de recherche."),(0,n.kt)("h2",r({},{id:"selectbox"}),".selectBox()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"20"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("em",{parentName:"td"},"id"),", ",(0,n.kt)("em",{parentName:"td"},"flags"),", ",(0,n.kt)("em",{parentName:"td"},"permanentFlags")," sont renvoy\xe9s")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"18 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".selectBox"),"( ",(0,n.kt)("em",{parentName:"p"},"name")," : Text { ; ",(0,n.kt)("em",{parentName:"p"},"state")," : Integer } ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"state"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'acc\xe8s \xe0 la boite de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objet boxInfo")))),(0,n.kt)("h4",r({},{id:"description-28"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".selectBox()")," s\xe9lectionne la bo\xeete de r\xe9ception ",(0,n.kt)("em",{parentName:"p"},"name")," comme bo\xeete de r\xe9ception courante. Cette fonction vous permet de r\xe9cup\xe9rer des informations sur la boite de r\xe9ception."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Pour obtenir les informations d'une bo\xeete aux lettres sans modifier la bo\xeete aux lettres courante, utilisez ",(0,n.kt)("a",r({parentName:"p"},{href:"#getboxinfo"}),(0,n.kt)("inlineCode",{parentName:"a"},".getBoxInfo()")),".")),(0,n.kt)("p",null,"Dans le param\xe8tre optionnel ",(0,n.kt)("em",{parentName:"p"},"name")," passez le nom de la boite de r\xe9ception \xe0 laquelle vous souhaitez acc\xe9der. Le nom doit repr\xe9senter une hi\xe9rarchie claire, de gauche \xe0 droite, avec des niveaux s\xe9par\xe9s par un caract\xe8re d\xe9limiteur sp\xe9cifique. Le d\xe9limiteur peut \xeatre r\xe9cup\xe9r\xe9 \xe0 l'aide de la fonction ",(0,n.kt)("a",r({parentName:"p"},{href:"#getdelimiter"}),(0,n.kt)("inlineCode",{parentName:"a"},".getDelimiter()")),"."),(0,n.kt)("p",null,"Le param\xe8tre optionnel ",(0,n.kt)("em",{parentName:"p"},"state")," d\xe9finit le type d'acc\xe8s \xe0 la mailbox. Les valeurs possibles sont les suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Constante"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Valeur"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Commentaire"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"IMAP read only state"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"1"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'La mailbox s\xe9lectionn\xe9e est accessible avec les privil\xe8ges de lecture seule. Les messages contenant un marqueur "recent" (indication de nouveaux messages) restent inchang\xe9s.')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"IMAP read write state"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"0"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'La mailbox s\xe9lectionn\xe9e est accessible avec des privil\xe8ges de lecture et d\'\xe9criture. Les messages sont consid\xe9r\xe9s "seen" et perdent le marqueur "recent" (indication des nouveaux messages). (Valeur par d\xe9faut)')))),(0,n.kt)("blockquote",null,(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"La fonction g\xe9n\xe8re une erreur et retourne ",(0,n.kt)("strong",{parentName:"li"},"Null")," si ",(0,n.kt)("em",{parentName:"li"},"name")," d\xe9signe une mailbox inexistante."),(0,n.kt)("li",{parentName:"ul"},"Si aucune connexion n'est ouverte, ",(0,n.kt)("inlineCode",{parentName:"li"},".selectBox()")," ouvrira une connexion."),(0,n.kt)("li",{parentName:"ul"},"Si la connexion n'a pas \xe9t\xe9 utilis\xe9e depuis la dur\xe9e maximale d\xe9finie (voir ",(0,n.kt)("inlineCode",{parentName:"li"},"IMAP New transporter"),"), la fonction ",(0,n.kt)("a",r({parentName:"li"},{href:"#checkconnection"}),(0,n.kt)("inlineCode",{parentName:"a"},".checkConnection()"))," est automatiquement appel\xe9e."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"L'objet ",(0,n.kt)("inlineCode",{parentName:"p"},"boxInfo")," contient les propri\xe9t\xe9 suivantes :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mailCount"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nombre de messages contenus dans la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"mailRecent"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'Nombre de messages avec le marqueur "recent"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"id"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Identifiant unique de la bo\xeete aux lettres")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"flags"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Liste des flags actuellement utilis\xe9s pour la bo\xeete aux lettres, s\xe9par\xe9s par des espaces")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"permanentFlags"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Liste des flags que le client peut modifier en permanence (\xe0 l'exception de l'indicateur \\Recent, qui est g\xe9r\xe9 par le serveur IMAP), s\xe9par\xe9s par des espaces")))),(0,n.kt)("admonition",r({},{type:"info"}),(0,n.kt)("p",{parentName:"admonition"},"Si la cha\xeene ",(0,n.kt)("inlineCode",{parentName:"p"},"permanentFlags")," comprend le flag sp\xe9cial ","*",", cela signifie que le serveur prend en charge ",(0,n.kt)("a",r({parentName:"p"},{href:"#addflags"}),"les flags personnalis\xe9s"),".")),(0,n.kt)("h4",r({},{id:"exemple-15"}),"Exemple"),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),' var $server; $boxinfo : Object\n $server:=New object\n $server.host:="imap.gmail.com" //Obligatoire\n $server.user:="4d@gmail.com"\n $server.password:="XXXXXXXX"\n\n var $transporter : 4D.IMAPTransporter\n $transporter:=IMAP New transporter($server)\n $boxInfo:=$transporter.selectBox("INBOX")\n')),(0,n.kt)("h2",r({},{id:"subscribe"}),".subscribe()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".subscribe"),"( ",(0,n.kt)("em",{parentName:"p"},"name")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration subscribe")))),(0,n.kt)("h4",r({},{id:"description-29"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".subscribe()")," permet d'ajouter la bo\xeete sp\xe9cifi\xe9e \xe0 l'ensemble des bo\xeetes auxquelles vous avez \"souscrit\" sur le serveur IMAP. Ainsi, vous pouvez contr\xf4ler la taille de la liste des bo\xeetes de r\xe9ception disponibles en souscrivant uniquement \xe0 celles que vous souhaitez g\xe9n\xe9ralement consulter."),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"name"),', passez le nom de la mailbox \xe0 ajouter (subscribe) \xe0 la liste de mailboxes auxquelles vous avez "souscrit".'),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-16"}),"Exemple"),(0,n.kt)("p",null,'Pour souscrire \xe0 la mailbox "Atlas Corp\u201d dans la hi\xe9rarchie "Bills" :'),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw; $name : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\n\nIf(OK=1) $options.host:="imap.gmail.com"\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"\n$status:=$transporter.subscribe($name)\n\nIf ($status.success)\n   ALERT("Mailbox subscription successful!")\n   Else\n   ALERT("Error: "+$status.statusText)\n   End if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"unsubscribe"}),".unsubscribe()"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"19"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".unsubscribe"),"( ",(0,n.kt)("em",{parentName:"p"},"name")," : Text ) : Object"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Param\xe8tres"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"name"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Nom de la bo\xeete de r\xe9ception")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"R\xe9sultat"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Statut de l'op\xe9ration unsubscribe")))),(0,n.kt)("h4",r({},{id:"description-30"}),"Description"),(0,n.kt)("p",null,"La fonction ",(0,n.kt)("inlineCode",{parentName:"p"},".unsubscribe()"),' supprime la bo\xeete sp\xe9cifi\xe9e de l\'ensemble des bo\xeetes auxquelles vous avez "souscrit". Elle vous permet de r\xe9duire le nombre de mailboxes que vous consultez r\xe9guli\xe8rement.'),(0,n.kt)("p",null,"Dans le param\xe8tre ",(0,n.kt)("inlineCode",{parentName:"p"},"name"),', passez le nom de la mailbox \xe0 supprimer (unsubscribe) de la liste de mailboxes auxquelles vous avez "souscrit".'),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Objet retourn\xe9")),(0,n.kt)("p",null,"La fonction retourne un objet d\xe9crivant le statut IMAP :"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propri\xe9t\xe9"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"success"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Boolean"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Vrai si l'op\xe9ration est r\xe9ussie, sinon Faux")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"statusText"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Message du statut retourn\xe9 par le serveur IMAP, ou derni\xe8re erreur retourn\xe9e dans la pile d'erreurs 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Pile d'erreurs 4D (non retourn\xe9e si une r\xe9ponse du serveur IMAP est re\xe7ue)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].errcode"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Code d'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].message"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Description de l'erreur 4D")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"[","].componentSignature"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Signature du composant interne qui a retourn\xe9 l'erreur")))),(0,n.kt)("h4",r({},{id:"exemple-17"}),"Exemple"),(0,n.kt)("p",null,'Pour ne plus souscrire \xe0 la mailbox "Atlas Corp\u201d dans la hi\xe9rarchie "Bills" :'),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'var $pw; $name : text\nvar $options; $transporter; $status : object\n\n$options:=New object\n\n$pw:=Request("Please enter your password:")\n\nIf(OK=1) $options.host:="imap.gmail.com"\n$options.user:="test@gmail.com"\n$options.password:=$pw\n\n$transporter:=IMAP New transporter($options)\n\n$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"\n$status:=$transporter.unsubscribe($name)\n\nIf ($status.success)\n   ALERT("Mailbox unsubscription successful!")\n   Else\n   ALERT("Error: "+$status.statusText)\n   End if\nEnd if\n')),(0,n.kt)("h2",r({},{id:"user"}),".user"),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Historique"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Modifications"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"17 R4"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Ajout"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".user")," : Text"),(0,n.kt)("h4",r({},{id:"description-31"}),"Description"),(0,n.kt)("p",null,"La propri\xe9t\xe9 ",(0,n.kt)("inlineCode",{parentName:"p"},".user")," contient le nom d'utilisateur utilis\xe9 pour l'authentification sur le serveur de messagerie."))}d.isMDXComponent=!0}}]);