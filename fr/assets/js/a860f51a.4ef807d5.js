"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["56524"],{714714:function(e,n,r){r.r(n),r.d(n,{default:()=>u,frontMatter:()=>i,metadata:()=>s,assets:()=>o,toc:()=>c,contentTitle:()=>d});var s=JSON.parse('{"id":"WritePro/commands-legacy/wp-insert-formula","title":"WP INSERT FORMULA","description":"WP INSERT FORMULA ( objCible ; formule ; mode {; miseAjourPlage} )","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R7/WritePro/commands-legacy/wp-insert-formula.md","sourceDirName":"WritePro/commands-legacy","slug":"/WritePro/commands/wp-insert-formula","permalink":"/docs/fr/20-R7/WritePro/commands/wp-insert-formula","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WritePro%2Fcommands-legacy%2Fwp-insert-formula.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"wp-insert-formula","title":"WP INSERT FORMULA","slug":"/WritePro/commands/wp-insert-formula","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"WP INSERT DOCUMENT","permalink":"/docs/fr/20-R7/WritePro/commands/wp-insert-document"},"next":{"title":"WP INSERT PICTURE","permalink":"/docs/fr/20-R7/WritePro/commands/wp-insert-picture"}}'),l=r("785893"),t=r("250065");let i={id:"wp-insert-formula",title:"WP INSERT FORMULA",slug:"/WritePro/commands/wp-insert-formula",displayed_sidebar:"docs"},d=void 0,o={},c=[{value:"Description",id:"description",level:2},{value:"Exemple 1",id:"exemple-1",level:2},{value:"Exemple 2",id:"exemple-2",level:2},{value:"Voir aussi",id:"voir-aussi",level:2}];function a(e){let n={a:"a",br:"br",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"WP INSERT FORMULA"})," ( ",(0,l.jsx)(n.em,{children:"objCible"})," ; ",(0,l.jsx)(n.em,{children:"formule"})," ; ",(0,l.jsx)(n.em,{children:"mode"})," {; ",(0,l.jsx)(n.em,{children:"miseAjourPlage"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Param\xe8tre"}),(0,l.jsx)(n.th,{children:"Type"}),(0,l.jsx)(n.th,{}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"objCible"}),(0,l.jsx)(n.td,{children:"Object"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Plage ou \xe9l\xe9ment ou document 4D Write Pro"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"formule"}),(0,l.jsx)(n.td,{children:"Object"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Objet formule"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"mode"}),(0,l.jsx)(n.td,{children:"Number"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Mode d'insertion"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"miseAjourPlage"}),(0,l.jsx)(n.td,{children:"Number"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Inclut ou exclut le contenu ins\xe9r\xe9 dans la plage"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,l.jsxs)(n.p,{children:["La commande ",(0,l.jsx)(n.strong,{children:"WP INSERT FORMULA"})," ins\xe8re une ",(0,l.jsx)(n.em,{children:"formule"})," dans ",(0,l.jsx)(n.em,{children:"objCible"})," en fonction du ",(0,l.jsx)(n.em,{children:"mode"})," d'insertion sp\xe9cifi\xe9."]}),"\n",(0,l.jsxs)(n.p,{children:["Dans le param\xe8tre ",(0,l.jsx)(n.em,{children:"objCible"}),", vous pouvez passer :"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"une plage, ou"}),"\n",(0,l.jsx)(n.li,{children:"un \xe9l\xe9ment (table / ligne / cellule(s) / paragraphe / corps / en-t\xeate / pied / section / sous-section / image en ligne), ou"}),"\n",(0,l.jsx)(n.li,{children:"un document 4D Write Pro."}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Dans le param\xe8tre ",(0,l.jsx)(n.em,{children:"formule"}),", passez la formule 4D \xe0 \xe9valuer. Vous pouvez passer :"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["soit un ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#objets-formula",children:"objet formula"})," cr\xe9\xe9 par la commande ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#formula",children:"Formula"})})," ou ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#formula-from-string",children:"Formula from string"})}),","]}),"\n",(0,l.jsx)(n.li,{children:"soit un objet contenant deux propri\xe9t\xe9s :"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Propri\xe9t\xe9"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Type"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Description"})})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"name"}),(0,l.jsx)(n.td,{children:"Cha\xeene"}),(0,l.jsx)(n.td,{children:"Nom \xe0 afficher pour la formule dans le document"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"formula"}),(0,l.jsx)(n.td,{children:"Objet"}),(0,l.jsxs)(n.td,{children:["L'",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#objets-formula",children:"objet formula"})," cr\xe9\xe9 par la commande ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#formula",children:"Formula"})})," ou ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/fr/API/FunctionClass/#formula-from-string",children:"Formula from string"})})]})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["Lorsque vous utilisez un objet avec un nom de formule (",(0,l.jsx)(n.em,{children:"name)"}),", ce nom est affich\xe9 dans le document \xe0 la place de la r\xe9f\xe9rence de la formule lorsque les formules sont affich\xe9es en tant que r\xe9f\xe9rence, et dans la bulle d'aide de la formule lorsqu'elles sont affich\xe9es en tant que valeur ou symboles. Si la propri\xe9t\xe9 ",(0,l.jsx)(n.em,{children:"name"})," contient une cha\xeene vide ou est omise, elle est supprim\xe9e de l'objet et la formule est affich\xe9e par d\xe9faut. Pour plus d'informations, voir la page ",(0,l.jsx)(n.em,{children:"G\xe9rer des formules"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Dans le param\xe8tre ",(0,l.jsx)(n.em,{children:"mode"}),", passez l'une des constantes suivantes pour indiquer le mode d'insertion \xe0 utiliser :"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Constante"}),(0,l.jsx)(n.th,{children:"Type"}),(0,l.jsx)(n.th,{children:"Valeur"}),(0,l.jsx)(n.th,{children:"Comment"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk append"}),(0,l.jsx)(n.td,{children:"Entier long"}),(0,l.jsx)(n.td,{children:"2"}),(0,l.jsx)(n.td,{children:"Ins\xe8re le contenu \xe0 la fin de la cible"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk prepend"}),(0,l.jsx)(n.td,{children:"Entier long"}),(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"Le contenu est ins\xe9r\xe9 au d\xe9but de la cible"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk replace"}),(0,l.jsx)(n.td,{children:"Entier long"}),(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"Remplace le contenu de la cible"})]})]})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Si objCible est une plage, vous pouvez utiliser le param\xe8tre optionnel ",(0,l.jsx)(n.em,{children:"miseAjourPlage"})," pour passer l'une des constantes suivantes pour sp\xe9cifier si la ",(0,l.jsx)(n.em,{children:"formule"})," ins\xe9r\xe9e est inclue ou non dans la plage r\xe9sultante :"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Constante"}),(0,l.jsx)(n.th,{children:"Type"}),(0,l.jsx)(n.th,{children:"Valeur"}),(0,l.jsx)(n.th,{children:"Comment"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk exclude from range"}),(0,l.jsx)(n.td,{children:"Entier long"}),(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"Le contenu ins\xe9r\xe9 n'est pas inclus dans la plage mise \xe0 jour"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk include in range"}),(0,l.jsx)(n.td,{children:"Entier long"}),(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"Le contenu ins\xe9r\xe9 est inclus dans la plage mise \xe0 jour (d\xe9faut)"})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["Si vous ne passez pas un param\xe8tre ",(0,l.jsx)(n.em,{children:"rangeUpdate"}),", la ",(0,l.jsx)(n.em,{children:"formule"})," ins\xe9r\xe9e est inclue par d\xe9faut dans la plage r\xe9sultante."]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Si objCible n'est pas une plage, ",(0,l.jsx)(n.em,{children:"rangeUpdate"})," est ignor\xe9."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Note:"})," N'oubliez pas que, lorsqu'il est appel\xe9, l'objet ",(0,l.jsx)(n.em,{children:"formule"})," est \xe9valu\xe9 dans le contexte de la base de donn\xe9es ou du composant qui l'a cr\xe9\xe9."]}),"\n",(0,l.jsx)(n.h2,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,l.jsx)(n.p,{children:"Pour remplacer les formules Date courante avec les chaines format\xe9es :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'\xa0var $_formulas : Collection\n\xa0var $find;$newFormula : Object\n\n\xa0// d\xe9finir la formule \xe0 rechercher\n\xa0$find:=Formula(Current date)\n\xa0\n\xa0\xa0// d\xe9finir la formule de remplacement\n\xa0$newFormula:=Formula(String(Current date;System date long))\n\xa0\n\xa0\xa0// trouver les formules contenues dans le document\n\xa0$_formulas:=WP Get formulas(WriteProArea)\n\xa0\n\xa0\xa0// rechercher la collection \xe0 partir de WP Get formulas\n\xa0$_formulas:=$_formulas.query("formula.source :=1";$find.source)\n\xa0\n\xa0\xa0// puis remplacer chaque formule\n\xa0For each($formula;$_formulas)\n\xa0\xa0\xa0\xa0WP INSERT FORMULA($formula.range;$newFormula;wk replace)\n\xa0End for each\n\n\n'})}),"\n",(0,l.jsx)(n.h2,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,l.jsx)(n.p,{children:"Vous souhaitez utiliser un nom de formule pour le nom du client :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//ajouter des donn\xe9es\n\xa0$data:=New object("customer";New object("lastname";"Smith";"firstname";"John"))\n\xa0WP SET DATA CONTEXT(WPArea;$data)\n\xa0\n\xa0\xa0//cr\xe9er un objet formule avec un nom\n\xa0$o:=New object\n\xa0$o.formula:=Formula(This.data.customer.firstname+" "+This.data.customer.lastname)\n\xa0$o.name:="Customer name"\n\xa0\n\xa0\xa0//ins\xe9rer comme texte\n\xa0$range:=WP Text range(WPArea;wk start text;wk end text)\n\xa0WP SET TEXT($range;"Dear ";wk append)\n\xa0WP INSERT FORMULA($range;$o;wk append)\n'})}),"\n",(0,l.jsx)(n.p,{children:"R\xe9sultat :"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:r(133713).Z+"",width:"119",height:"33"})}),"\n",(0,l.jsx)(n.h2,{id:"voir-aussi",children:"Voir aussi"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.em,{children:"G\xe9rer des formules"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/fr/20-R7/WritePro/commands/wp-compute-formulas",children:"WP COMPUTE FORMULAS"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/fr/20-R7/WritePro/commands/wp-freeze-formulas",children:"WP FREEZE FORMULAS"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/fr/20-R7/WritePro/commands/wp-get-formulas",children:"WP Get formulas"})]})]})}function u(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},133713:function(e,n,r){r.d(n,{Z:function(){return s}});let s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAAhCAIAAABsjKM3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJLSURBVGhD7ZbLbcMwDECzlE+eR3cDGSALeAOP4B16zBQ+d42UpEhKimNFdWKiSPmAJpJIffgsOD3dnONxyxa4ZQvcsgVu2QK3bIFbtsAtW+CWLXDLL3G5XLhV5VjL35/O6dQk0C2/xD7LXwPMK+inhWM74LPMgRcLM7Th42OAmrjUKuskEJ3MkvX9ouEc17EjuwTpbrN8HcN45fbf5T2WARQ9fHHnl0SvhdZGe/Bwuv9kOdNMNxtg6dKlPnX6Yejzu7+WHKE7jRbppscManbjDE9hplGEIvkLR+fGHFwjhvWZSDYmx9wQaGV5ZsUCcjqZlU1r2QI+uNQqDZaXqUeP8BXH7/swgbTjeDlz0zIdlA8NLcyIdxxV03i6y3PgRh6LJVNDvJTTMBSX5Uk5ukDanKdxP2VQY3uL91nGWwoa6bIKkoFmAbF8J7liWc+qhWFqytW4hBEudD1Xh2gRoczNeLAAAKM4i/qtWwBcapXnllkyfpNMBQOYKYFHlulMWgcxj3jWx4VSOo1rPA/DILbrCsrdUm7GegHZV/qtW7zHMprkbvZCWKZhWtR61TIerryi5ZmpPhzSSHxDaFwTUgqMbCmAb4npK4j7GasFdB1prDI2tthnmawW5PdXozjILwum77mX5/P/y3guJlUsgyGARRiHK04tUQrVSTs273txItDBzNhaZWsuLcno4MhH0F9Cpuu493wL+ONSqzQl7SaW9cG4ZQvcsgXn85lLrXKsZSfili1wyxa4ZQvcsgVu2QK3bIFbtsAtH8/t9gPxbrckFSamGwAAAABJRU5ErkJggg=="},250065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return i}});var s=r(667294);let l={},t=s.createContext(l);function i(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);