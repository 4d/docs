"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["44762"],{327730:function(e,s,n){n.r(s),n.d(s,{metadata:()=>i,contentTitle:()=>d,default:()=>u,assets:()=>c,toc:()=>o,frontMatter:()=>l});var i=JSON.parse('{"id":"ORDA/privileges","title":"Privil\xe8ges","description":"La protection des donn\xe9es tout en permettant un acc\xe8s rapide et facile aux utilisateurs autoris\xe9s est un d\xe9fi majeur pour les applications Web. The ORDA security architecture is implemented at the heart of your datastore and allows you to define specific privileges to all user sessions for the various resources in your project (datastore, dataclasses, functions, etc.).","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20/ORDA/privileges.md","sourceDirName":"ORDA","slug":"/ORDA/privileges","permalink":"/docs/fr/20/ORDA/privileges","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20ORDA%2Fprivileges.md%20(20)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20","frontMatter":{"id":"privileges","title":"Privil\xe8ges"},"sidebar":"docs","previous":{"title":"Utiliser un datastore distant","permalink":"/docs/fr/20/ORDA/datastores"},"next":{"title":"Glossaire","permalink":"/docs/fr/20/ORDA/glossary"}}'),t=n("785893"),r=n("250065");let l={id:"privileges",title:"Privil\xe8ges"},d=void 0,c={},o=[{value:"Vue d\u2019ensemble",id:"vue-densemble",level:2},{value:"Resources",id:"resources",level:2},{value:"Actions de permission",id:"actions-de-permission",level:2},{value:"Privil\xe8ges et R\xf4les",id:"privil\xe8ges-et-r\xf4les",level:2},{value:"Exemple",id:"exemple",level:3},{value:"<code>roles.json</code>",id:"rolesjson",level:2},{value:"<code>Roles_Errors.json</code>",id:"roles_errorsjson",level:3},{value:"Initialisation des privil\xe8ges pour le d\xe9ploiement",id:"initialisation-des-privil\xe8ges-pour-le-d\xe9ploiement",level:2}];function a(e){let s={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"La protection des donn\xe9es tout en permettant un acc\xe8s rapide et facile aux utilisateurs autoris\xe9s est un d\xe9fi majeur pour les applications Web. The ORDA security architecture is implemented at the heart of your datastore and allows you to define specific privileges to all user sessions for the various resources in your project (datastore, dataclasses, functions, etc.)."}),"\n",(0,t.jsx)(s.h2,{id:"vue-densemble",children:"Vue d\u2019ensemble"}),"\n",(0,t.jsx)(s.p,{children:"L'architecture de s\xe9curit\xe9 ORDA est bas\xe9e sur les concepts de privil\xe8ges, d'actions de permission (lecture, cr\xe9ation, etc.) et de ressources."}),"\n",(0,t.jsxs)(s.p,{children:["When users get logged, their session is automatically loaded with associated privilege(s). Les privil\xe8ges sont assign\xe9s \xe0 la session en utilisant la fonction ",(0,t.jsx)(s.a,{href:"/docs/fr/20/API/SessionClass#setprivileges",children:(0,t.jsx)(s.code,{children:"session.setPrivileges()"})}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["Chaque requ\xeate utilisateur envoy\xe9e au sein de la session est \xe9valu\xe9e par rapport aux privil\xe8ges d\xe9finis dans le fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," du projet."]}),"\n",(0,t.jsx)(s.p,{children:"Si un utilisateur tente d'ex\xe9cuter une action et ne dispose pas des droits d'acc\xe8s appropri\xe9s, une erreur de privil\xe8ge est g\xe9n\xe9r\xe9e ou, en cas de permission de lecture manquante sur les attributs, ils ne sont pas envoy\xe9s."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"schema",src:n(803863).Z+"",width:"960",height:"540"})}),"\n",(0,t.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsx)(s.p,{children:"You can assign specific permission actions to the following resources in your project:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"le datastore"}),"\n",(0,t.jsx)(s.li,{children:"une dataclass"}),"\n",(0,t.jsx)(s.li,{children:"un attribut (y compris calcul\xe9 et alias)"}),"\n",(0,t.jsx)(s.li,{children:"une fonction de classe du mod\xe8le de donn\xe9es"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Each time a resource is accessed within a session (whatever the way it is accessed), 4D checks that the session has the appropriate permissions, and rejects the access if it is not authorized."}),"\n",(0,t.jsx)(s.p,{children:"Une action de permission d\xe9finie \xe0 un certain niveau est h\xe9rit\xe9e par d\xe9faut aux niveaux inf\xe9rieurs, mais plusieurs niveaux de permissions peuvent \xeatre d\xe9finis :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Une action de permission d\xe9finie au niveau du datastore est automatiquement assign\xe9e \xe0 toutes les dataclass."}),"\n",(0,t.jsx)(s.li,{children:"Une action de permission d\xe9finie au niveau dataclass remplace le param\xe9trage du datastore (le cas \xe9ch\xe9ant). Par d\xe9faut, tous les attributs de la dataclass h\xe9ritent des permissions de la dataclass."}),"\n",(0,t.jsx)(s.li,{children:'Contrairement aux permissions des dataclass, une action de permission d\xe9finie au niveau de l\'attribut ne remplace pas la permission de la dataclass parente, mais y est ajout\xe9e. Par exemple, si vous avez attribu\xe9 le privil\xe8ge "g\xe9n\xe9ral" \xe0 une dataclass et le privil\xe8ge "d\xe9tail" \xe0 un attribut de la dataclass, les deux privil\xe8ges, "g\xe9n\xe9ral" et "d\xe9tail", doivent \xeatre d\xe9finis dans la session afin d\'acc\xe9der \xe0 l\'attribut.'}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"actions-de-permission",children:"Actions de permission"}),"\n",(0,t.jsx)(s.p,{children:"Les actions disponibles sont li\xe9es \xe0 la ressource cible."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Actions"}),(0,t.jsx)(s.th,{children:"datastore"}),(0,t.jsx)(s.th,{children:"dataclass"}),(0,t.jsx)(s.th,{children:"attribut"}),(0,t.jsx)(s.th,{children:"fonction du mod\xe8le de donn\xe9es"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"create"})}),(0,t.jsx)(s.td,{children:"Cr\xe9er une entit\xe9 dans n'importe quelle dataclass"}),(0,t.jsx)(s.td,{children:"Cr\xe9er une entit\xe9 dans cette dataclass"}),(0,t.jsx)(s.td,{children:"Cr\xe9er une entit\xe9 avec une valeur diff\xe9rente de la valeur par d\xe9faut autoris\xe9e pour cet attribut (ignor\xe9 pour les attributs alias)."}),(0,t.jsx)(s.td,{children:"n/a"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"read"})}),(0,t.jsx)(s.td,{children:"Lire les attributs de n'importe quelle dataclass"}),(0,t.jsx)(s.td,{children:"Lire les attributs de cette dataclass"}),(0,t.jsx)(s.td,{children:"Lire ce contenu d'attribut"}),(0,t.jsx)(s.td,{children:"n/a"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"update"})}),(0,t.jsx)(s.td,{children:"Mettre \xe0 jour les attributs dans n'importe quelle dataclass."}),(0,t.jsx)(s.td,{children:"Mettre \xe0 jour les attributs de cette dataclass."}),(0,t.jsx)(s.td,{children:"Mettre \xe0 jour le contenu de cet attribut (ignor\xe9 pour les attributs alias)."}),(0,t.jsx)(s.td,{children:"n/a"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"drop"})}),(0,t.jsx)(s.td,{children:"Supprimer des donn\xe9es dans n'importe quelle dataclass."}),(0,t.jsx)(s.td,{children:"Supprimer des donn\xe9es dans cette dataclass."}),(0,t.jsx)(s.td,{children:"Supprimer une valeur non nulle pour cet attribut (sauf pour les attributs alias et calcul\xe9s)."}),(0,t.jsx)(s.td,{children:"n/a"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"execute"})}),(0,t.jsx)(s.td,{children:"Ex\xe9cuter n'importe quelle fonction du projet (datastore, dataclass, entity selection, entity)"}),(0,t.jsx)(s.td,{children:"Ex\xe9cuter n'importe quelle fonction de dataclass. Les fonctions de dataclass, d'entit\xe9 et d'entity selection sont consid\xe9r\xe9es comme des fonctions de dataclass"}),(0,t.jsx)(s.td,{children:"n/a"}),(0,t.jsx)(s.td,{children:"Ex\xe9cuter cette fonction"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"describe"})}),(0,t.jsx)(s.td,{children:"Toutes les dataclass sont disponibles dans l'API /rest/$catalog"}),(0,t.jsx)(s.td,{children:"Cette dataclass est disponible dans l'API /rest/$catalog"}),(0,t.jsx)(s.td,{children:"Cet attribut est disponible dans l'API /rest/$catalog."}),(0,t.jsx)(s.td,{children:"Cette fonction de dataclass est disponible dans l'API /rest/$catalog"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"promote"})}),(0,t.jsx)(s.td,{children:"n/a"}),(0,t.jsx)(s.td,{children:"n/a"}),(0,t.jsx)(s.td,{children:"n/a"}),(0,t.jsx)(s.td,{children:"Associe un privil\xe8ge donn\xe9 lors de l'ex\xe9cution de la fonction. Le privil\xe8ge est temporairement ajout\xe9 \xe0 la session et supprim\xe9 \xe0 la fin de l'ex\xe9cution de la fonction. Par mesure de s\xe9curit\xe9, seul le process ex\xe9cutant la fonction re\xe7oit le privil\xe8ge, et non toute la session."})]})]})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Notes :"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Un alias peut \xeatre lu d\xe8s que les privil\xe8ges de session permettent l'acc\xe8s \xe0 l'alias lui-m\xeame, m\xeame si les privil\xe8ges de session ne permettent pas l'acc\xe8s aux attributs r\xe9solvant l'alias."}),"\n",(0,t.jsx)(s.li,{children:"Il est possible d'acc\xe9der \xe0 un attribut calcul\xe9 m\xeame s'il n'y a pas de permissions sur les attributs sur lesquels il est construit."}),"\n",(0,t.jsxs)(s.li,{children:["Valeurs par d\xe9faut : dans l'impl\xe9mentation actuelle, seul ",(0,t.jsx)(s.em,{children:"Null"})," est disponible en tant que valeur par d\xe9faut."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Le param\xe9trage des permissions n\xe9cessite d'\xeatre coh\xe9rent, en particulier :"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Les permissions ",(0,t.jsx)(s.strong,{children:"update"})," et ",(0,t.jsx)(s.strong,{children:"drop"})," ont \xe9galement besoin d'une permission ",(0,t.jsx)(s.strong,{children:"read"})," (mais ",(0,t.jsx)(s.strong,{children:"create"})," n'en a pas besoin)"]}),"\n",(0,t.jsxs)(s.li,{children:["La permission ",(0,t.jsx)(s.strong,{children:"promote"})," a \xe9galement besoin de la permission ",(0,t.jsx)(s.strong,{children:"describe"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"privil\xe8ges-et-r\xf4les",children:"Privil\xe8ges et R\xf4les"}),"\n",(0,t.jsxs)(s.p,{children:["Un ",(0,t.jsx)(s.strong,{children:"privil\xe8ge"})," est la capacit\xe9 technique d'ex\xe9cuter des ",(0,t.jsx)(s.strong,{children:"actions"})," sur des ",(0,t.jsx)(s.strong,{children:"ressources"}),", tandis qu'un ",(0,t.jsx)(s.strong,{children:"r\xf4le"}),' est un privil\xe8ge public destin\xe9 \xe0 \xeatre utilis\xe9 par un administrateur. Fondamentalement, un r\xf4le rassemble plusieurs privil\xe8ges pour d\xe9finir un profil utilisateur m\xe9tier. Par exemple, "manageInvoices" pourrait \xeatre un privil\xe8ge tandis que "secr\xe9taire" pourrait \xeatre un r\xf4le (qui inclut "manageInvoices" et d\'autres privil\xe8ges).']}),"\n",(0,t.jsx)(s.p,{children:'Un privil\xe8ge ou un r\xf4le peut \xeatre associ\xe9 \xe0 plusieurs combinaisons "action + ressource". Plusieurs privil\xe8ges peuvent \xeatre associ\xe9s \xe0 une action. Un privil\xe8ge peut inclure d\'autres privil\xe8ges.'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Vous ",(0,t.jsx)(s.strong,{children:"cr\xe9ez"})," des privil\xe8ges et/ou des r\xf4les dans le fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," (voir ci-dessous). Vous ",(0,t.jsx)(s.strong,{children:"configurez"})," leur port\xe9e en les assignant aux actions de permission appliqu\xe9es aux ressources."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Vous ",(0,t.jsx)(s.strong,{children:"autorisez"})," les privil\xe8ges et/ou les r\xf4les pour chaque session utilisateur \xe0 l'aide de la fonction ",(0,t.jsx)(s.a,{href:"/docs/fr/20/API/SessionClass#setprivileges",children:(0,t.jsx)(s.code,{children:".setPrivileges()"})})," de la classe ",(0,t.jsx)(s.code,{children:"Session"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"exemple",children:"Exemple"}),"\n",(0,t.jsx)(s.p,{children:"Pour permettre un r\xf4le dans une session :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-4d",children:'\nexposed Function authenticate($identifier : Text; $password : Text)->$result : Text\n\n    var $user : cs.UsersEntity\n\n    Session.clearPrivileges()\n\n    $result:="Your are authenticated as Guest"\n\n    $user:=ds.Users.query("identifier = :1"; $identifier).first()\n\n    If ($user#Null)\n        If (Verify password hash($password; $user.password))\n            Session.setPrivileges(New object("roles"; $user.role))\n            $result:="Your are authenticated as "+$user.role\n        End if\n    End if\n\n\n'})}),"\n",(0,t.jsx)(s.h2,{id:"rolesjson",children:(0,t.jsx)(s.code,{children:"roles.json"})}),"\n",(0,t.jsxs)(s.p,{children:["Le fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," d\xe9crit l'ensemble des param\xe8tres de s\xe9curit\xe9 du projet."]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["Dans un contexte autre que ",(0,t.jsx)(s.em,{children:"Qodly"})," (cloud), vous devez cr\xe9er ce fichier \xe0 l'emplacement suivant : ",(0,t.jsx)(s.code,{children:"<project folder>/Project/Sources/"}),". Voir la section ",(0,t.jsx)(s.a,{href:"/docs/fr/20/Project/architecture#sources",children:"Architecture"}),"."]})}),"\n",(0,t.jsxs)(s.p,{children:["La syntaxe du fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," est la suivante:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Nom de propri\xe9t\xe9"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Obligatoire"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"privileges"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsxs)(s.td,{children:["Collection d'objets ",(0,t.jsx)(s.code,{children:"privilege"})]}),(0,t.jsx)(s.td,{children:"X"}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges d\xe9finis"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].privilege"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Text"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Nom de privil\xe8ge"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].includes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de noms de privil\xe8ges inclus"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"roles"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsxs)(s.td,{children:["Collection d'objets ",(0,t.jsx)(s.code,{children:"role"})]}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de r\xf4les d\xe9finis"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].role"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Text"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Nom de r\xf4le"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].privileges"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de noms de privil\xe8ges inclus"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"permissions"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Object"}),(0,t.jsx)(s.td,{children:"X"}),(0,t.jsx)(s.td,{children:"Liste d'actions autoris\xe9es"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"allowed"}),(0,t.jsx)(s.td,{}),(0,t.jsxs)(s.td,{children:["Collection d'objets ",(0,t.jsx)(s.code,{children:"permission"})]}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de permissions autoris\xe9es"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].applyTo"}),(0,t.jsx)(s.td,{children:"Text"}),(0,t.jsx)(s.td,{children:"X"}),(0,t.jsxs)(s.td,{children:["Nom de ",(0,t.jsx)(s.a,{href:"#resources",children:"ressource"})," cible"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].type"}),(0,t.jsx)(s.td,{children:"Text"}),(0,t.jsx)(s.td,{children:"X"}),(0,t.jsx)(s.td,{children:'Type de [ressource](#resources) : "datastore", "dataclass", "attribute", "method"'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].read"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].create"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].update"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].drop"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].describe"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].execute"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].promote"}),(0,t.jsx)(s.td,{children:"Collection de cha\xeenes"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"Liste de privil\xe8ges"})]})]})]}),"\n",(0,t.jsx)(s.admonition,{title:"Rappel",type:"caution",children:(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Le nom de privil\xe8ge \"WebAdmin\" est r\xe9serv\xe9 \xe0 l'application. Il est d\xe9conseill\xe9 d'utiliser ce nom pour les privil\xe8ges personnalis\xe9s."}),"\n",(0,t.jsxs)(s.li,{children:["Les noms ",(0,t.jsx)(s.code,{children:"privileges"})," et ",(0,t.jsx)(s.code,{children:"roles"})," sont insensibles \xe0 la casse."]}),"\n"]})}),"\n",(0,t.jsx)(s.h3,{id:"roles_errorsjson",children:(0,t.jsx)(s.code,{children:"Roles_Errors.json"})}),"\n",(0,t.jsxs)(s.p,{children:["Le fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," est analys\xe9 par 4D au d\xe9marrage. Vous devez red\xe9marrer l'application pour que les modifications dans ce fichier soient prises en compte."]}),"\n",(0,t.jsxs)(s.p,{children:["En cas d'erreur(s) lors de l'analyse du fichier ",(0,t.jsx)(s.code,{children:"roles.json"}),", 4D charge le projet mais d\xe9sactive la protection globale d'acc\xe8s - cela permet au d\xe9veloppeur d'acc\xe9der aux fichiers et de corriger l'erreur. An error file named ",(0,t.jsx)(s.code,{children:"Roles_Errors.json"})," is generated in the ",(0,t.jsxs)(s.a,{href:"/docs/fr/20/Project/architecture#logs",children:[(0,t.jsx)(s.code,{children:"Logs"})," folder of the project"]})," and describes the error line(s). This file is automatically deleted when the ",(0,t.jsx)(s.code,{children:"roles.json"})," file no longer contains error(s)."]}),"\n",(0,t.jsxs)(s.p,{children:["It is recommended to check at startup if a ",(0,t.jsx)(s.code,{children:"Roles_Errors.json"})," file exists in the ",(0,t.jsx)(s.a,{href:"/docs/fr/20/Project/architecture#logs",children:"Logs folder"}),", which means that there was a parsing error and that accesses will not limited. Vous pouvez \xe9crire par exemple :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-4d",metastring:'title="/Sources/DatabaseMethods/onStartup.4dm"',children:'If (Not(File("/LOGS/"+"Roles_Errors.json").exists))\n\u2026\nElse // you can prevent the project to open\n ALERT("The roles.json file is malformed or contains inconsistencies, the application will quit.")\n QUIT 4D\nEnd if\n QUIT 4D\nEnd if \n'})}),"\n",(0,t.jsx)(s.h2,{id:"initialisation-des-privil\xe8ges-pour-le-d\xe9ploiement",children:"Initialisation des privil\xe8ges pour le d\xe9ploiement"}),"\n",(0,t.jsxs)(s.p,{children:["Par d\xe9faut, si aucun param\xe8tre sp\xe9cifique n'est d\xe9fini dans le fichier ",(0,t.jsx)(s.code,{children:"roles.json"}),", les acc\xe8s ne sont pas limit\xe9s. Cette configuration vous permet de d\xe9velopper l'application sans avoir \xe0 vous soucier des acc\xe8s."]}),"\n",(0,t.jsxs)(s.p,{children:["Cependant, lorsque l'application est sur le point d'\xeatre d\xe9ploy\xe9e, une bonne pratique consiste \xe0 verrouiller tous les privil\xe8ges, puis \xe0 configurer le fichier pour n'ouvrir que les parties contr\xf4l\xe9es aux sessions autoris\xe9es. Pour verrouiller tous les privil\xe8ges sur toutes les ressources, mettez le fichier ",(0,t.jsx)(s.code,{children:"roles.json"})," suivant dans votre dossier de projet (il inclut des exemples de m\xe9thodes) :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",metastring:'title="/Project/Sources/roles.json"',children:'{\n    "privileges": [\n        {\n            "privilege": "none",\n            "includes": []\n        }\n    ],\n\n    "roles": [],\n\n    "permissions": {\n        "allowed": [{\n            "applyTo": "ds",\n            "type": "datastore",\n            "read": [\n                "none"\n            ],\n            "create": [\n                "none"\n            ],\n            "update": [\n                "none"\n            ],\n            "drop": [\n                "none"\n            ],\n            "execute": [\n                "none"\n            ],\n            "describe": [\n                "none"\n            ],\n            "promote": [\n                "none"\n            ]\n        },\n        {\n            "applyTo": "ds.loginAs",\n            "type": "method",\n            "execute": [\n                    "guest"\n                ]\n        },\n        {\n            "applyTo": "ds.hasPrivilege",\n            "type": "method",\n            "execute": [\n                    "guest"\n                ]\n        },\n        {\n            "applyTo": "ds.clearPrivileges",\n            "type": "method",\n            "execute": [\n                    "guest"\n                ]\n        },\n        {\n            "applyTo": "ds.isGuest",\n            "type": "method",\n            "execute": [\n                    "guest"\n                ]\n        },\n        {\n            "applyTo": "ds.getPrivileges",\n            "type": "method",\n            "execute": [\n                    "guest"\n                ]\n        },\n        {\n            "applyTo": "ds.setAllPrivileges",\n            "type": "method",\n            "execute": [\n                "guest"\n            ]\n    }\n\n        ]\n    }\n}\n'})})]})}function u(e={}){let{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},803863:function(e,s,n){n.d(s,{Z:function(){return i}});let i=n.p+"assets/images/privileges-schema-d5a0ecd16f6a60f344dbb09d12f2e271.png"},250065:function(e,s,n){n.d(s,{Z:function(){return d},a:function(){return l}});var i=n(667294);let t={},r=i.createContext(t);function l(e){let s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);