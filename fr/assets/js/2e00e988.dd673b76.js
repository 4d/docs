"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[93978],{3905:(e,r,t)=>{t.d(r,{Zo:()=>u,kt:()=>m});var n=t(67294);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function i(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=n.createContext({}),d=function(e){var r=n.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):l(l({},r),e)),t},u=function(e){var r=d(e.components);return n.createElement(s.Provider,{value:r},e.children)},p={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},c=n.forwardRef((function(e,r){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=d(t),m=o,h=c["".concat(s,".").concat(m)]||c[m]||p[m]||a;return t?n.createElement(h,l(l({ref:r},u),{},{components:t})):n.createElement(h,l({ref:r},u))}));function m(e,r){var t=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=c;var i={};for(var s in r)hasOwnProperty.call(r,s)&&(i[s]=r[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var d=2;d<a;d++)l[d]=t[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"},24691:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>u});t(67294);var n=t(3905);function o(){return o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},o.apply(this,arguments)}function a(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}const l={id:"error-handling",title:"Gestion des erreurs"},i=void 0,s={unversionedId:"Concepts/error-handling",id:"version-19-R8/Concepts/error-handling",title:"Gestion des erreurs",description:"Le traitement des erreurs consiste \xe0 anticiper les erreurs pouvant survenir dans votre application et \xe0 y r\xe9pondre. 4D fournit un support complet pour la d\xe9tection et la signalisation des erreurs lors de l'ex\xe9cution, ainsi que pour l'analyse de leurs conditions.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-19-R8/Concepts/error-handling.md",sourceDirName:"Concepts",slug:"/Concepts/error-handling",permalink:"/docs/fr/Concepts/error-handling",draft:!1,editUrl:"https://github.com/4D/docs/edit/main/versioned_docs/version-19-R8/Concepts/error-handling.md",tags:[],version:"19-R8",frontMatter:{id:"error-handling",title:"Gestion des erreurs"},sidebar:"docs",previous:{title:'Structures r\xe9p\xe9titives (ou "boucles")',permalink:"/docs/fr/Concepts/looping"},next:{title:"Modes interpr\xe9t\xe9 et compil\xe9",permalink:"/docs/fr/Concepts/interpreted-compiled"}},d={},u=[{value:"Erreur ou statut",id:"erreur-ou-statut",level:2},{value:"Installer une m\xe9thode de gestion des erreurs",id:"installer-une-m\xe9thode-de-gestion-des-erreurs",level:2},{value:"Port\xe9e et composants",id:"port\xe9e-et-composants",level:3},{value:"G\xe9rer les erreurs dans une m\xe9thode",id:"g\xe9rer-les-erreurs-dans-une-m\xe9thode",level:3},{value:"Exemple",id:"exemple",level:4},{value:"Utiliser une m\xe9thode de gestion des erreurs vide",id:"utiliser-une-m\xe9thode-de-gestion-des-erreurs-vide",level:3}],p={toc:u};function c(e){var{components:r}=e,t=a(e,["components"]);return(0,n.kt)("wrapper",o({},p,t,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Le traitement des erreurs consiste \xe0 anticiper les erreurs pouvant survenir dans votre application et \xe0 y r\xe9pondre. 4D fournit un support complet pour la d\xe9tection et la signalisation des erreurs lors de l'ex\xe9cution, ainsi que pour l'analyse de leurs conditions."),(0,n.kt)("p",null,"La gestion des erreurs r\xe9pond \xe0 deux besoins principaux :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"rechercher et corriger les \xe9ventuels bugs et erreurs dans votre code pendant la phase de d\xe9veloppement,"),(0,n.kt)("li",{parentName:"ul"},"d\xe9tecter et r\xe9cup\xe9rer des erreurs inattendues dans les applications d\xe9ploy\xe9es; vous pouvez notamment remplacer les bo\xeetes de dialogue d'erreur syst\xe8me (disque plein, fichier manquant, etc.) par votre propre interface.")),(0,n.kt)("admonition",o({},{title:"Good practice",type:"tip"}),(0,n.kt)("p",{parentName:"admonition"},"It is highly recommended to install a global error-handling method on 4D Server, for all code running on the server. This method would avoid unexpected dialog boxes to be displayed on the server machine (if run with interface), and could log errors in a dedicated file for further analyses.")),(0,n.kt)("h2",o({},{id:"erreur-ou-statut"}),"Erreur ou statut"),(0,n.kt)("p",null,"De nombreuses fonctions de classe 4D, telles que ",(0,n.kt)("inlineCode",{parentName:"p"},"entity.save()")," ou ",(0,n.kt)("inlineCode",{parentName:"p"},"transporter.send()"),", retournent un objet ",(0,n.kt)("em",{parentName:"p"},"status"),". Cet objet permet de stocker les erreurs \"pr\xe9visibles\" dans le contexte d'ex\xe9cution, telles qu'un mot de passe invalide, une entit\xe9 verrouill\xe9e, etc., qui ne stoppe pas l'ex\xe9cution du programme. Cette cat\xe9gorie d'erreurs peut \xeatre g\xe9r\xe9e par du code habituel."),(0,n.kt)("p",null,"D'autres erreurs \"impr\xe9visibles\" peuvent inclure une erreur en \xe9criture sur le disque, une panne de r\xe9seau ou toute interruption inattendue. Cette cat\xe9gorie d'erreurs g\xe9n\xe8re des exceptions et doit \xeatre trait\xe9e par une m\xe9thode de gestion des erreurs."),(0,n.kt)("h2",o({},{id:"installer-une-m\xe9thode-de-gestion-des-erreurs"}),"Installer une m\xe9thode de gestion des erreurs"),(0,n.kt)("p",null,"In 4D, all errors can be caught and handled by specific project methods, named ",(0,n.kt)("strong",{parentName:"p"},"error-handling")," (or ",(0,n.kt)("strong",{parentName:"p"},"error-catching"),") methods."),(0,n.kt)("p",null,"Once installed, error handlers are automatically called in interpreted or compiled mode in case of error in the 4D application or one of its components. A different error handler can be called depending on the execution context (see below)."),(0,n.kt)("p",null,"To ",(0,n.kt)("em",{parentName:"p"},"install")," an error-handling project method, you just need to call the ",(0,n.kt)("a",o({parentName:"p"},{href:"https://doc.4d.com/4dv19/help/command/en/page155.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"ON ERR CALL"))," command with the project method name and (optionnally) scope as parameters. Par exemple :"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("IO_Errors";ek local) //Installs a local error-handling method\n')),(0,n.kt)("p",null,"To stop catching errors for an execution context and give back hand, call ",(0,n.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," with an empty string:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("";ek local) //gives back control for the local process\n')),(0,n.kt)("p",null,"The  ",(0,n.kt)("a",o({parentName:"p"},{href:"https://doc.4d.com/4dv19/help/command/en/page704.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"Method called on error"))," command allows you to know the name of the method installed by ",(0,n.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," for the current process. Cela est particuli\xe8rement utile dans le contexte du code g\xe9n\xe9rique car il vous permet de modifier temporairement puis de restaurer la m\xe9thode de capture d'erreur :"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),' $methCurrent:=Method called on error(ek local)\n ON ERR CALL("NewMethod";ek local)\n  //If the document cannot be opened, an error is generated\n $ref:=Open document("MyDocument")\n  //Reinstallation of previous method\n ON ERR CALL($methCurrent;ek local)\n\n')),(0,n.kt)("h3",o({},{id:"port\xe9e-et-composants"}),"Port\xe9e et composants"),(0,n.kt)("p",null,"An error-handling method can be set for different execution contexts:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"for the ",(0,n.kt)("strong",{parentName:"li"},"current process"),"- a local error handler will be only called for errors that occurred in the current process,"),(0,n.kt)("li",{parentName:"ul"},"for the ",(0,n.kt)("strong",{parentName:"li"},"whole application"),"- a global error handler will be called for all errors that occurred in the application execution context,"),(0,n.kt)("li",{parentName:"ul"},"for the ",(0,n.kt)("strong",{parentName:"li"},"components"),"- it will be called in the host for all errors that occurred in the components.")),(0,n.kt)("p",null,"Exemples :"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("IO_Errors";ek local) //Installs a local error-handling method\nON ERR CALL("globalHandler";ek global) //Installs a global error-handling method\nON ERR CALL("componentHandler";ek errors from components) //Installs an error-handling method for components\n')),(0,n.kt)("p",null,'You can install a global error handler that will serve as "fallback" and specific local error handlers for certain processes. A global error handler is also useful on the server to avoid error dialogs on the server when run with interface.'),(0,n.kt)("p",null,"Vous pouvez d\xe9finir une seule m\xe9thode d'erreur pour l'ensemble de l'application ou diff\xe9rentes m\xe9thodes par module d'application. However, only one method can be installed per execution context."),(0,n.kt)("p",null,'When an error occurs, only one method is called, even if several "concurrent" error handlers are installed:'),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"if the error occurs in the current process, the local handler is called and NOT the global handler;"),(0,n.kt)("li",{parentName:"ul"},'if the error occurs in a component and the component has its own error handler, the error handler of the component is called and NOT the "errors from components" handler of the host application.')),(0,n.kt)("h3",o({},{id:"g\xe9rer-les-erreurs-dans-une-m\xe9thode"}),"G\xe9rer les erreurs dans une m\xe9thode"),(0,n.kt)("p",null,"Within a custom error method, you have access to several pieces of information that will help you identifying the error:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"dedicated system variables:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"Error")," (entier long): Code d'erreur"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"Error method")," (texte) : nom de la m\xe9thode ayant engendr\xe9 l'erreur"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"Error line")," (entier long) : Num\xe9ro de ligne de la m\xe9thode ayant g\xe9n\xe9r\xe9 l'erreur"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"Error formula")," (texte) : formule du code 4D (texte brut) \xe0 l'origine de l'erreur.")))),(0,n.kt)("admonition",o({},{type:"info"}),(0,n.kt)("p",{parentName:"admonition"},"4D automatically maintains a number of variables called ",(0,n.kt)("strong",{parentName:"p"},"system variables"),", meeting different needs. See the ",(0,n.kt)("em",{parentName:"p"},"4D Language Reference manual"),".")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"the ",(0,n.kt)("a",o({parentName:"li"},{href:"https://doc.4d.com/4dv19/help/command/en/page1799.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"Last errors"))," command that returns a collection of the current stack of errors that occurred in the 4D application. You can also use the ",(0,n.kt)("a",o({parentName:"li"},{href:"https://doc.4d.com/4dv19/help/command/en/page1015.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"GET LAST ERROR STACK"))," command that returns the same information as arrays."),(0,n.kt)("li",{parentName:"ul"},"la commande ",(0,n.kt)("inlineCode",{parentName:"li"},"Get call chain")," qui retourne une collection d'objets d\xe9crivant chaque \xe9tape de la cha\xeene d'appel de la m\xe9thode dans le process courant.")),(0,n.kt)("h4",o({},{id:"exemple"}),"Exemple"),(0,n.kt)("p",null,"Voici un syst\xe8me de gestion des erreurs simple :"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'//installer la m\xe9thode de gestion d\'erreur\nON ERR CALL("errorMethod")\n //... ex\xe9cuter le code\n ON ERR CALL("") //redonner le contr\xf4le \xe0 4D\n')),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'// m\xe9thode projet errorMethod\n If(Error#1006) //ceci n\'est pas une interruption g\xe9n\xe9r\xe9e par l\'utilisateur\n    ALERT("L\'erreur "+String(Error)+" s\'est produite". Le code en question est : \\""+Error formula+"\\"")\n End if\n')),(0,n.kt)("h3",o({},{id:"utiliser-une-m\xe9thode-de-gestion-des-erreurs-vide"}),"Utiliser une m\xe9thode de gestion des erreurs vide"),(0,n.kt)("p",null,"Si vous souhaitez cacher la boite de dialogue d'erreur standard, vous pouvez installer une m\xe9thode de gestion d'erreurs vide. La variable syst\xe8me ",(0,n.kt)("inlineCode",{parentName:"p"},"Error")," peut \xeatre test\xe9e dans n'importe quelle m\xe9thode, c'est-\xe0-dire en dehors de la m\xe9thode de gestion d'erreurs :"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("emptyMethod") //emptyMethod exists but is empty\n$doc:=Open document( "myFile.txt")\nIf (Error=-43)\n    ALERT("File not found.")\nEnd if\nON ERR CALL("")\nEnd if\nON ERR CALL.("")\n')))}c.isMDXComponent=!0}}]);