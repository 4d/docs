"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[52044],{603905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>m});var a=t(667294);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,a,n=function(e,r){if(null==e)return{};var t,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var p=a.createContext({}),l=function(e){var r=a.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},c=function(e){var r=l(e.components);return a.createElement(p.Provider,{value:r},e.children)},d={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},u=a.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(t),m=n,v=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return t?a.createElement(v,i(i({ref:r},c),{},{components:t})):a.createElement(v,i({ref:r},c))}));function m(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var p in r)hasOwnProperty.call(r,p)&&(s[p]=r[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},129892:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>p,toc:()=>c});t(667294);var a=t(603905);function n(){return n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},n.apply(this,arguments)}function o(e,r){if(null==e)return{};var t,a,n=function(e,r){if(null==e)return{};var t,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}const i={id:"advanced-programming",title:"Programmation avanc\xe9e avec Javascript"},s=void 0,p={unversionedId:"ViewPro/advanced-programming",id:"version-20-R5/ViewPro/advanced-programming",title:"Programmation avanc\xe9e avec Javascript",description:"A 4D View Pro Area is a Web Area form object that uses the embedded web rendering engine. As such, it behaves just like any other web area, and you can get it to execute Javascript code by calling the WA Evaluate Javascript 4D command.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R5/ViewPro/advanced-programming.md",sourceDirName:"ViewPro",slug:"/ViewPro/advanced-programming",permalink:"/docs/fr/ViewPro/advanced-programming",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20ViewPro%2Fadvanced-programming.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"advanced-programming",title:"Programmation avanc\xe9e avec Javascript"},sidebar:"docs",previous:{title:"Classes",permalink:"/docs/fr/ViewPro/classes"},next:{title:"Commandes",permalink:"/docs/fr/ViewPro/commands"}},l={},c=[{value:"Exemple concret : masquer le ruban",id:"exemple-concret--masquer-le-ruban",level:2},{value:"Appeler des m\xe9thodes JavaScript de SpreadJS",id:"appeler-des-m\xe9thodes-javascript-de-spreadjs",level:2},{value:"Exemple",id:"exemple",level:4},{value:"D\xe9p\xf4t 4D View Pro Tips",id:"d\xe9p\xf4t-4d-view-pro-tips",level:2}],d={toc:c};function u(e){var{components:r}=e,t=o(e,["components"]);return(0,a.kt)("wrapper",n({},d,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"A 4D View Pro Area is a ",(0,a.kt)("a",n({parentName:"p"},{href:"/docs/fr/FormObjects/webAreaOverview"}),"Web Area form object")," that uses the ",(0,a.kt)("a",n({parentName:"p"},{href:"/docs/fr/FormObjects/propertiesWebArea#use-embedded-web-rendering-engine"}),"embedded web rendering engine"),". As such, it behaves just like any other web area, and you can get it to execute Javascript code by calling the ",(0,a.kt)("a",n({parentName:"p"},{href:"https://doc.4d.com/4dv20/help/command/en/page1029.html"}),(0,a.kt)("inlineCode",{parentName:"a"},"WA Evaluate Javascript"))," 4D command."),(0,a.kt)("p",null,"Since 4D View Pro is powered by the ",(0,a.kt)("a",n({parentName:"p"},{href:"https://developer.mescius.com/spreadjs"}),"SpreadJS spreadsheet solution"),", you can also call SpreadJS Javascript methods in 4D View Pro areas."),(0,a.kt)("h2",n({},{id:"exemple-concret--masquer-le-ruban"}),"Exemple concret : masquer le ruban"),(0,a.kt)("p",null,"4D View Pro \xe9tant une zone Web, vous pouvez s\xe9lectionner un \xe9l\xe9ment de page Web et modifier son comportement \xe0 l'aide de Javascript. The following example hides the spreadJS ",(0,a.kt)("a",n({parentName:"p"},{href:"/docs/fr/ViewPro/configuring#ribbon"}),"Ribbon"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",n({parentName:"pre"},{className:"language-4d"}),"//M\xe9thode objet du bouton\n\nvar $js; $answer : Text\n\n$js:=\"document.getElementsByClassName('ribbon')[0].setAttribute('style','display: none');\"\n\n$js+=\"window.dispatchEvent(new Event('resize'));\"\n\n$answer:=WA Evaluate JavaScript(*; \"ViewProArea\"; $js)\n")),(0,a.kt)("h2",n({},{id:"appeler-des-m\xe9thodes-javascript-de-spreadjs"}),"Appeler des m\xe9thodes JavaScript de SpreadJS"),(0,a.kt)("p",null,"Vous pouvez exploiter la biblioth\xe8que de m\xe9thodes Javascript de SpreadJS et les appeler directement pour g\xe9rer vos feuilles de calcul."),(0,a.kt)("p",null,"4D has a built-in ",(0,a.kt)("inlineCode",{parentName:"p"},"Utils.spread")," property that gives access to the spreadsheet document (also called workbook) inside the 4D View Pro area, making it simpler to call the SpreadJS ",(0,a.kt)("a",n({parentName:"p"},{href:"https://developer.mescius.com/spreadjs/api/modules/GC.Data"}),"Workbook methods"),"."),(0,a.kt)("h4",n({},{id:"exemple"}),"Exemple"),(0,a.kt)("p",null,"Le code suivant annule la derni\xe8re action dans la feuille de calcul :"),(0,a.kt)("pre",null,(0,a.kt)("code",n({parentName:"pre"},{className:"language-4d"}),'WA Evaluate JavaScript(*; "ViewProArea"; "Utils.spread.undoManager().undo()")\n')),(0,a.kt)("h2",n({},{id:"d\xe9p\xf4t-4d-view-pro-tips"}),"D\xe9p\xf4t 4D View Pro Tips"),(0,a.kt)("p",null,(0,a.kt)("a",n({parentName:"p"},{href:"https://github.com/4d-depot/4D-View-Pro-Tips"}),"4D-View-Pro-Tips")," is a GitHub repository that contains a project full of useful functions, allowing to manage floating pictures, sort columns or rows, create a custom culture, and much more! N'h\xe9sitez pas \xe0 le cloner et \xe0 l'exp\xe9rimenter !"))}u.isMDXComponent=!0}}]);