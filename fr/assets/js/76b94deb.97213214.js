"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["97844"],{876605:function(e,n,r){r.r(n),r.d(n,{default:()=>m,frontMatter:()=>l,metadata:()=>s,assets:()=>a,toc:()=>o,contentTitle:()=>d});var s=JSON.parse('{"id":"commands-legacy/set-current-printer","title":"SET CURRENT PRINTER","description":"SET CURRENT PRINTER ( nomImpr )","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R7/commands-legacy/set-current-printer.md","sourceDirName":"commands-legacy","slug":"/commands/set-current-printer","permalink":"/docs/fr/20-R7/commands/set-current-printer","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fset-current-printer.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"set-current-printer","title":"SET CURRENT PRINTER","slug":"/commands/set-current-printer","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"Printing page","permalink":"/docs/fr/20-R7/commands/printing-page"},"next":{"title":"SET PRINT MARKER","permalink":"/docs/fr/20-R7/commands/set-print-marker"}}'),t=r("785893"),i=r("250065");let l={id:"set-current-printer",title:"SET CURRENT PRINTER",slug:"/commands/set-current-printer",displayed_sidebar:"docs"},d=void 0,a={},o=[{value:"Description",id:"description",level:4},{value:"Variables et ensembles syst\xe8me",id:"variables-et-ensembles-syst\xe8me",level:4},{value:"Exemple",id:"exemple",level:4},{value:"Voir aussi",id:"voir-aussi",level:4},{value:"Propri\xe9t\xe9s",id:"propri\xe9t\xe9s",level:4}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," ( ",(0,t.jsx)(n.em,{children:"nomImpr"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Param\xe8tre"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"nomImpr"}),(0,t.jsx)(n.td,{children:"Text"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Nom de l\u2019imprimante \xe0 utiliser"})]})})]}),"\n",(0,t.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:["La commande ",(0,t.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," permet de d\xe9signer l\u2019imprimante \xe0 utiliser pour les impressions avec l\u2019application 4D courante."]}),"\n",(0,t.jsxs)(n.p,{children:["Passez dans le param\xe8tre ",(0,t.jsx)(n.em,{children:"nomImpr"})," le nom de l\u2019imprimante \xe0 s\xe9lectionner. Pour obtenir la liste des imprimantes disponibles, utilisez au pr\xe9alable la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/printers-list",children:"PRINTERS LIST"}),".",(0,t.jsx)(n.br,{}),"\nSi vous passez une cha\xeene vide dans ",(0,t.jsx)(n.em,{children:"nomImpr"}),", l\u2019imprimante courante d\xe9finie dans le syst\xe8me sera utilis\xe9e."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," vous permet de d\xe9signer l'imprimante PDF g\xe9n\xe9rique du syst\xe8me afin d'effectuer des impressions PDF. La valeur \xe0 utiliser d\xe9pend de la version de l'OS et de celle de 4D."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Windows 8 et versions pr\xe9c\xe9dentes :"}),(0,t.jsx)(n.br,{}),"\n4D s\u2019appuie sur le pilote PDFCreator pour l\u2019impression de documents PDF sous Windows (cf. section ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/set-printable-margin",children:"SET PRINTABLE MARGIN"}),"). Pour imprimer un document PDF, passez dans le param\xe8tre ",(0,t.jsx)(n.em,{children:"nomImpr"}),' le nom de l\u2019imprimante virtuelle install\xe9e par PDFCreator. Par d\xe9faut, le nom de l\u2019imprimante virtuelle est "PDFCreator". Toutefois, ce nom peut avoir \xe9t\xe9 modifi\xe9 au moment de l\u2019installation du pilote. Pour que 4D recherche et utilise automatiquement le nom de l\u2019imprimante virtuelle, m\xeame s\u2019il a \xe9t\xe9 personnalis\xe9, vous pouvez passer dans ',(0,t.jsx)(n.em,{children:"nomImpr"})," la constante suivante (th\xe8me ",(0,t.jsx)(n.em,{children:"Options d'impression"}),") :"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Constante"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Valeur"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PDFCreator Printer name"}),(0,t.jsx)(n.td,{children:"Cha\xeene"}),(0,t.jsx)(n.td,{children:"PDFCreator"})]})})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A partir de Windows 10 :"}),(0,t.jsx)(n.br,{}),"\nWindows 10 inclut un pilote d'impression PDF natif, permettant \xe0 4D de cr\xe9er directement des PDFs sans qu'il soit n\xe9cessaire d'utiliser un pilote tiers comme PDFCreator.",(0,t.jsx)(n.br,{}),'\nLe nom du pilote est "Microsoft Print to PDF" (cf. exemple pr\xe9sent\xe9 dans la section ',(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/set-printable-margin",children:"SET PRINTABLE MARGIN"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sous macOS et \xe0 partir de Windows 10 (4D v15 R5 64 bits et suivantes) :"}),(0,t.jsx)(n.br,{}),"\nUne constante du th\xe8me ",(0,t.jsx)(n.em,{children:"Options d'impression"})," vous permet de d\xe9signer automatiquement l'imprimante PDF g\xe9n\xe9rique, quelle que soit la plate-forme. Ce principe facilite l'\xe9criture de code g\xe9n\xe9rique.",(0,t.jsx)(n.br,{}),"\n| Constante          | Type   | Valeur             | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |",(0,t.jsx)(n.br,{}),"\n| ------------------ | ------ | ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |",(0,t.jsx)(n.br,{}),"\n| Generic PDF driver | Cha\xeene | _4d_pdf_printer | ",(0,t.jsx)(n.strong,{children:"Note :"})," Cette fonctionnalit\xe9 n'est pas disponible dans les versions 32 bits de 4D.",(0,t.jsx)(n.br,{}),"Sous macOS, d\xe9clare le pilote par d\xe9faut comme imprimante courante. Ce pilote n'est pas visible et ne se trouve pas dans la liste retourn\xe9e par la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/printers-list",children:"PRINTERS LIST"}),". Notez que le chemin d\u2019acc\xe8s pour le document PDF doit \xeatre d\xe9fini en utilisant la commande ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/set-print-option",children:"SET PRINT OPTION"}),", sinon l'erreur 3107 est retourn\xe9e.Sous Windows, d\xe9clare le pilote PDF de Windows (nomm\xe9 \"Microsoft Print to PDF\") comme imprimante courante. Cette constante est disponible sous Windows 10 uniquement, lorsque l'option PDF est install\xe9e. Avec d'autres versions de Windows, ou lorsqu'il n'y a pas de pilote PDF disponible, la commande ne fait rien et la variable syst\xe8me ",(0,t.jsx)(n.em,{children:"OK"})," prend la valeur 0. |"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["La commande ",(0,t.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," doit \xeatre appel\xe9e avant ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/set-print-option",children:"SET PRINT OPTION"})," afin que les options disponibles correspondent \xe0 l'imprimante s\xe9lectionn\xe9e. En revanche, ",(0,t.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," doit \xeatre appel\xe9e apr\xe8s ",(0,t.jsx)(n.em,{children:"_o_PAGE SETUP"})," (le cas \xe9ch\xe9ant), sinon le param\xe9trage d'imprimante n'est pas conserv\xe9."]}),"\n",(0,t.jsxs)(n.p,{children:["Cette commande peut \xeatre utilis\xe9e avec les commandes ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/print-selection",children:"PRINT SELECTION"}),", ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/print-record",children:"PRINT RECORD"}),", ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/print-form",children:"Print form"}),", ",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/qr-report",children:"QR REPORT"})," et s\u2019applique \xe0 toutes les impressions de 4D, y compris en mode D\xe9veloppement.",(0,t.jsx)(n.br,{}),"\nLes commandes d'impression doivent imp\xe9rativement \xeatre appel\xe9es avec le param\xe8tre ",(0,t.jsx)(n.em,{children:">"})," (le cas \xe9ch\xe9ant) afin que le param\xe9trage d\xe9fini soit conserv\xe9."]}),"\n",(0,t.jsx)(n.h4,{id:"variables-et-ensembles-syst\xe8me",children:"Variables et ensembles syst\xe8me"}),"\n",(0,t.jsx)(n.p,{children:"Si la s\xe9lection d\u2019imprimante est correctement effectu\xe9e, la variable syst\xe8me OK prend la valeur 1. Dans le cas contraire (par exemple l\u2019imprimante d\xe9sign\xe9e est introuvable), la variable syst\xe8me OK prend la valeur 0 et l\u2019imprimante courante est inchang\xe9e."}),"\n",(0,t.jsx)(n.h4,{id:"exemple",children:"Exemple"}),"\n",(0,t.jsx)(n.p,{children:"Cr\xe9ation d'un document PDF sous Windows :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0var $pdfpath : Texte\n\xa0$pdfpath:=System folder(Desktop)+"test.pdf"\n\xa0SET CURRENT PRINTER(Driver PDF g\xe9n\xe9rique)\n\xa0SET PRINT OPTION(Destination option;3;$pdfpath)\n\xa0ALL RECORDS([Table_1])\n\xa0PRINT SELECTION([Table_1];*)\n\xa0SET CURRENT PRINTER("")\n'})}),"\n",(0,t.jsx)(n.h4,{id:"voir-aussi",children:"Voir aussi"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/get-current-printer",children:"Get current printer"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"/docs/fr/20-R7/commands/printers-list",children:"PRINTERS LIST"})]}),"\n",(0,t.jsx)(n.h4,{id:"propri\xe9t\xe9s",children:"Propri\xe9t\xe9s"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Num\xe9ro de commande"}),(0,t.jsx)(n.td,{children:"787"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Thread safe"}),(0,t.jsx)(n.td,{children:"\u2717"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Modifie les variables"}),(0,t.jsx)(n.td,{children:"OK"})]})]})]})]})}function m(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},250065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return l}});var s=r(667294);let t={},i=s.createContext(t);function l(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);