"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["1200"],{148925:function(e,n,r){r.r(n),r.d(n,{default:()=>m,frontMatter:()=>l,metadata:()=>t,assets:()=>d,toc:()=>i,contentTitle:()=>a});var t=JSON.parse('{"id":"commands-legacy/execute-method-in-subform","title":"EXECUTE METHOD IN SUBFORM","description":"EXECUTE METHOD IN SUBFORM ( objetSousForm ; nomM\xe9thode {; retour {; param} {; param2 ; ... ; paramN}} )","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R8/commands-legacy/execute-method-in-subform.md","sourceDirName":"commands-legacy","slug":"/commands/execute-method-in-subform","permalink":"/docs/fr/commands/execute-method-in-subform","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fexecute-method-in-subform.md%20(20-R8)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R8","frontMatter":{"id":"execute-method-in-subform","title":"EXECUTE METHOD IN SUBFORM","slug":"/commands/execute-method-in-subform","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"Deactivated","permalink":"/docs/fr/commands/deactivated"},"next":{"title":"FORM Event","permalink":"/docs/fr/commands/form-event"}}'),s=r("785893"),o=r("250065");let l={id:"execute-method-in-subform",title:"EXECUTE METHOD IN SUBFORM",slug:"/commands/execute-method-in-subform",displayed_sidebar:"docs"},a=void 0,d={},i=[{value:"Description",id:"description",level:2},{value:"Exemple 1",id:"exemple-1",level:2},{value:"Exemple 2",id:"exemple-2",level:2},{value:"Variables et ensembles syst\xe8me",id:"variables-et-ensembles-syst\xe8me",level:2},{value:"Propri\xe9t\xe9s",id:"propri\xe9t\xe9s",level:2}];function c(e){let n={br:"br",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"EXECUTE METHOD IN SUBFORM"})," ( ",(0,s.jsx)(n.em,{children:"objetSousForm"})," ; ",(0,s.jsx)(n.em,{children:"nomM\xe9thode"})," {; ",(0,s.jsx)(n.em,{children:"retour"})," {; ",(0,s.jsx)(n.em,{children:"param"}),"} {; ",(0,s.jsx)(n.em,{children:"param2"})," ; ... ; ",(0,s.jsx)(n.em,{children:"paramN"}),"}} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Param\xe8tre"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"objetSousForm"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Nom de l\u2019objet sous-formulaire"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"nomM\xe9thode"}),(0,s.jsx)(n.td,{children:"Object, Text"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Nom de la m\xe9thode projet \xe0 ex\xe9cuter"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"retour"}),(0,s.jsx)(n.td,{children:"*, Variable"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"* si la m\xe9thode ne retourne pas de valeur"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u2190"}),(0,s.jsx)(n.td,{children:"Valeur retourn\xe9e par la m\xe9thode"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"param"}),(0,s.jsx)(n.td,{children:"Expression"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Param\xe8tre(s) \xe0 passer \xe0 la m\xe9thode"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:["La commande ",(0,s.jsx)(n.strong,{children:"EXECUTE METHOD IN SUBFORM"})," permet d\u2019ex\xe9cuter le code d\xe9sign\xe9 dans ",(0,s.jsx)(n.em,{children:"formule"})," dans le contexte de l\u2019objet de sous-formulaire ",(0,s.jsx)(n.em,{children:"objetSousForm"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Le code appel\xe9 peut recevoir de 1 \xe0 N param\xe8tres dans ",(0,s.jsx)(n.em,{children:"param"})," et retourner une valeur dans ",(0,s.jsx)(n.em,{children:"retour"}),". Passez * dans le param\xe8tre ",(0,s.jsx)(n.em,{children:"retour"})," si le code ne retourne pas de param\xe8tres."]}),"\n",(0,s.jsxs)(n.p,{children:["Dans ",(0,s.jsx)(n.em,{children:"formule"}),", le code 4D \xe0 ex\xe9cuter dans le contexte de ",(0,s.jsx)(n.em,{children:"subformObject"})," doit \xeatre d\xe9sign\xe9. Vous pouvez passer soit :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["un objet ",(0,s.jsx)(n.strong,{children:"formula"})," (voir ",(0,s.jsx)(n.em,{children:"Objets Formula"}),"). Les objets formula peuvent encapsuler toute expression ex\xe9cutable, y compris les fonctions et les m\xe9thodes projet ;"]}),"\n",(0,s.jsxs)(n.li,{children:["une ",(0,s.jsx)(n.strong,{children:"cha\xeene"})," contenant le nom d'une m\xe9thode projet."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:'Le contexte d\u2019ex\xe9cution est pr\xe9serv\xe9 dans le code appel\xe9, ce qui signifie que le formulaire courant et l\u2019\xe9v\xe9nement formulaire courant restent d\xe9finis. Si le sous-formulaire provient d\u2019un composant, une m\xe9thode ou fonction appel\xe9e doit appartenir au composant et disposer de la propri\xe9t\xe9 "Partag\xe9e entre les composants et la base h\xf4te".'}),"\n",(0,s.jsxs)(n.p,{children:["Cette commande doit \xeatre appel\xe9e dans le contexte du formulaire parent (contenant l\u2019objet ",(0,s.jsx)(n.em,{children:"objetSousForm"}),"), par exemple via sa m\xe9thode formulaire."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note :"})," Le code n'est pas ex\xe9cut\xe9 si ",(0,s.jsx)(n.em,{children:"objetSousForm"})," ne se trouve pas dans la page courante ou n'est pas encore instanci\xe9."]}),"\n",(0,s.jsx)(n.h2,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,s.jsxs)(n.p,{children:['Soit le formulaire "ContactD\xe9tail" utilis\xe9 comme sous-formulaire dans le formulaire parent "Soci\xe9t\xe9". L\u2019objet sous-formulaire qui contient le formulaire ContactD\xe9tail est nomm\xe9 "ContactSousForm". Imaginons que nous souhaitions modifier l\u2019apparence de certains \xe9l\xe9ments du sous-formulaire en fonction de la valeur de champ(s) de la soci\xe9t\xe9 (par exemple, "nomcontact" doit passer en rouge lorsque [Soci\xe9t\xe9]Ville="New York" et en bleu lorsque [Soci\xe9t\xe9]Ville="San Diego"). Ce m\xe9canisme est mis en oeuvre via la m\xe9thode SetToColor. Pour pouvoir obtenir ce r\xe9sultat, la m\xe9thode SetToColor ne peut pas \xeatre appel\xe9e directement depuis le process de l\u2019\xe9v\xe9nement formulaire "Sur chargement" du formulaire parent Soci\xe9t\xe9 car l\u2019objet "nomcontact" n\u2019appartient pas au formulaire courant, mais au formulaire affich\xe9 dans l\u2019objet sous-formulaire "ContactSousForm". La m\xe9thode doit donc \xeatre ex\xe9cut\xe9e \xe0 l\u2019aide de ',(0,s.jsx)(n.strong,{children:"EXECUTE METHOD IN SUBFORM"})," pour pouvoir fonctionner correctement."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Case of\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:([Soci\xe9t\xe9]Ville="New York")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Red\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:([Soci\xe9t\xe9]Ville="San Diego")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Blue\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Black\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End case\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0EXECUTE METHOD IN SUBFORM("ContactSousForm";Formula(SetToColor);*;$Color)\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.h2,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,s.jsxs)(n.p,{children:["Vous d\xe9veloppez une base de donn\xe9es qui sera utilis\xe9e comme composant. Elle comporte un formulaire projet partag\xe9 (nomm\xe9 par exemple Calendrier) contenant des ",(0,s.jsx)(n.em,{children:"variables dynamiques"})," ainsi qu\u2019une m\xe9thode projet publique permettant de r\xe9gler le calendrier : SetCalendarDate(varDate).",(0,s.jsx)(n.br,{}),'\nSi cette m\xe9thode \xe9tait utilis\xe9e directement dans la m\xe9thode du formulaire Calendrier, vous pourriez l\u2019appeler directement dans l\u2019\xe9v\xe9nement "Sur chargement" :']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:"\xa0SetCalendarDate(Current date)\n"})}),"\n",(0,s.jsx)(n.p,{children:'Mais, dans le contexte de la base h\xf4te, imaginons qu\u2019un formulaire projet contienne deux sous-formulaires "Calendrier", dans des objets sous-formulaire appel\xe9s "Cal1" et "Cal2". Vous devez r\xe9gler la date de Cal1 au 01/01/10 et celle de Cal2 au 05/05/10. Vous ne pouvez pas appeler directement SetCalendarDate car la m\xe9thode ne "saura" pas \xe0 quels formulaire et variables elle devra s\u2019appliquer. Vous devez donc l\u2019appeler via le code suivant :'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0EXECUTE METHOD IN SUBFORM("Cal1";Formula(SetCalendarDate);*;!01/01/20!)\n\xa0EXECUTE METHOD IN SUBFORM(SetCalendarDate);*;!05/05/20!)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"variables-et-ensembles-syst\xe8me",children:"Variables et ensembles syst\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Si cette commande est ex\xe9cut\xe9e correctement, la variable syst\xe8me OK prend la valeur 1, sinon elle prend la valeur 0."}),"\n",(0,s.jsx)(n.h2,{id:"propri\xe9t\xe9s",children:"Propri\xe9t\xe9s"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Num\xe9ro de commande"}),(0,s.jsx)(n.td,{children:"1085"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Thread safe"}),(0,s.jsx)(n.td,{children:"\u2717"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Modifie les variables"}),(0,s.jsx)(n.td,{children:"OK"})]})]})]})]})}function m(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},250065:function(e,n,r){r.d(n,{Z:function(){return a},a:function(){return l}});var t=r(667294);let s={},o=t.createContext(s);function l(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);