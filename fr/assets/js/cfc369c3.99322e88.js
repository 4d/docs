"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["60620"],{605080:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>l,toc:()=>c,default:()=>u,metadata:()=>s,assets:()=>a,contentTitle:()=>d});var s=JSON.parse('{"id":"ORDA/orda-events","title":"\xc9v\xe8nements d\'entit\xe9","description":"Historique","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-21/ORDA/orda-events.md","sourceDirName":"ORDA","slug":"/ORDA/orda-events","permalink":"/docs/fr/ORDA/orda-events","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20ORDA%2Forda-events.md%20(21)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"21","frontMatter":{"id":"orda-events","title":"\xc9v\xe8nements d\'entit\xe9"},"sidebar":"docs","previous":{"title":"Travailler avec les donn\xe9es","permalink":"/docs/fr/ORDA/entities"},"next":{"title":"Utiliser le marqueur global","permalink":"/docs/fr/ORDA/global-stamp"}}'),r=t(474848),i=t(884429);let l={id:"orda-events",title:"\xc9v\xe8nements d'entit\xe9"},d,a={},c=[{value:"Vue d\u2019ensemble",id:"vue-densemble",level:2},{value:"Niveau de l&#39;\xe9v\xe9nement",id:"niveau-de-l\xe9v\xe9nement",level:3},{value:"Ex\xe9cution en configuration distante",id:"ex\xe9cution-en-configuration-distante",level:3},{value:"Tableau de synth\xe8se",id:"tableau-de-synth\xe8se",level:3},{value:"Param\xe8tre <em>event</em>",id:"param\xe8tre-event",level:2},{value:"Objet error",id:"objet-error",level:2},{value:"Propri\xe9t\xe9s de l&#39;objet error",id:"propri\xe9t\xe9s-de-lobjet-error",level:3},{value:"Description des fonctions",id:"description-des-fonctions",level:2},{value:"<code>Function event touched</code>",id:"function-event-touched",level:3},{value:"Syntaxe",id:"syntaxe",level:4},{value:"Exemple 1",id:"exemple-1",level:4},{value:"Exemple 2",id:"exemple-2",level:4},{value:"Exemple 3 (diagramme) : Client/serveur avec le mot-cl\xe9 <code>local</code> :",id:"exemple-3-diagramme--clientserveur-avec-le-mot-cl\xe9-local-",level:4},{value:"Exemple 4 (diagramme) : Client/serveur avec le mot-cl\xe9 <code>local</code>",id:"exemple-4-diagramme--clientserveur-avec-le-mot-cl\xe9-local",level:4},{value:"Exemple 5 (diagramme) : Application Qodly",id:"exemple-5-diagramme--application-qodly",level:4},{value:"<code>Function event validateSave</code>",id:"function-event-validatesave",level:3},{value:"Syntaxe",id:"syntaxe-1",level:4},{value:"Exemple",id:"exemple",level:4},{value:"<code>Function event saving</code>",id:"function-event-saving",level:3},{value:"Syntaxe",id:"syntaxe-2",level:4},{value:"Exemple",id:"exemple-3",level:4},{value:"<code>Function event afterSave</code>",id:"function-event-aftersave",level:3},{value:"Syntaxe",id:"syntaxe-3",level:4},{value:"Exemple",id:"exemple-4",level:4},{value:"<code>Function event validateDrop</code>",id:"function-event-validatedrop",level:3},{value:"Syntaxe",id:"syntaxe-4",level:4},{value:"Exemple",id:"exemple-5",level:4},{value:"<code>Function event dropping</code>",id:"function-event-dropping",level:3},{value:"Syntaxe",id:"syntaxe-5",level:4},{value:"Exemple",id:"exemple-6",level:4},{value:"<code>Function event afterDrop</code>",id:"function-event-afterdrop",level:3},{value:"Syntaxe",id:"syntaxe-6",level:4},{value:"Exemple",id:"exemple-7",level:4}];function o(e){let n={a:"a",admonition:"admonition",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.details,{children:[(0,r.jsx)(n.summary,{children:"Historique"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Release"}),(0,r.jsx)(n.th,{children:"Modifications"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"21"}),(0,r.jsx)(n.td,{children:"\xc9v\xe9nements ajout\xe9s : validateSave / saving / afterSave / validateDrop / dropping / afterDrop"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20 R10"}),(0,r.jsx)(n.td,{children:"ajout \xe9v\xe9nement touched"})]})]})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 sont des fonctions qui sont automatiquement invoqu\xe9es par ORDA chaque fois que des entit\xe9s et des attributs d'entit\xe9 sont touch\xe9s (ajout\xe9s, supprim\xe9s ou modifi\xe9s). Vous pouvez \xe9crire des \xe9v\xe9nements tr\xe8s simples, puis les rendre plus sophistiqu\xe9s."}),"\n",(0,r.jsx)(n.p,{children:"Vous ne pouvez pas d\xe9clencher directement l'ex\xe9cution d'une fonction d'\xe9v\xe9nement. Les \xe9v\xe9nements sont appel\xe9s automatiquement par ORDA en fonction des actions de l'utilisateur ou des op\xe9rations effectu\xe9es par le code sur les entit\xe9s et leurs attributs."}),"\n",(0,r.jsx)(n.admonition,{title:"Article(s) de blog sur le sujet",type:"tip",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://blog.4d.com/orda-handle-an-event-driven-logic-during-database-operations",children:"ORDA - G\xe9rer une logique \xe9v\xe9nementielle lors des actions de persistance des donn\xe9es"})})}),"\n",(0,r.jsx)(n.admonition,{title:"Note de compatibilit\xe9",type:"info",children:(0,r.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 ORDA dans le datastore sont \xe9quivalents aux triggers dans la base de donn\xe9es 4D. Cependant, les actions d\xe9clench\xe9es au niveau de la base de donn\xe9es 4D \xe0 l'aide des commandes du langage classique 4D ou des actions standard ne d\xe9clenchent pas les \xe9v\xe9nements ORDA. Notez \xe9galement que, contrairement aux triggers, les \xe9v\xe9nements d'entit\xe9 ORDA ne verrouillent pas l'ensemble de la table sous-jacente d'une dataclass lors de l'enregistrement ou de la suppression d'entit\xe9s. Plusieurs \xe9v\xe9nements peuvent se d\xe9rouler en parall\xe8le tant qu'ils concernent des entit\xe9s distinctes (c'est-\xe0-dire des enregistrements distincts)."})}),"\n",(0,r.jsx)(n.h2,{id:"vue-densemble",children:"Vue d\u2019ensemble"}),"\n",(0,r.jsx)(n.h3,{id:"niveau-de-l\xe9v\xe9nement",children:"Niveau de l'\xe9v\xe9nement"}),"\n",(0,r.jsxs)(n.p,{children:["Une fonction d'\xe9v\xe9nement d'entit\xe9 est toujours d\xe9finie dans la ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#entity-class",children:"classe Entity"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Un \xe9v\xe9nement peut \xeatre d\xe9fini au niveau de l'",(0,r.jsx)(n.strong,{children:"entit\xe9"})," et/ou de l'",(0,r.jsx)(n.strong,{children:"attribut"})," (y compris les ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#computed-attributes",children:(0,r.jsx)(n.strong,{children:"attributs calcul\xe9s"})}),"). Dans le premier cas, il sera d\xe9clench\xe9 pour tous les attributs de l'entit\xe9 ; dans l'autre cas, il ne sera d\xe9clench\xe9 que pour l'attribut cibl\xe9."]}),"\n",(0,r.jsx)(n.p,{children:"Pour un m\xeame \xe9v\xe9nement, vous pouvez d\xe9finir diff\xe9rentes fonctions pour diff\xe9rents attributs."}),"\n",(0,r.jsx)(n.p,{children:"Vous pouvez \xe9galement d\xe9finir le m\xeame \xe9v\xe9nement au niveau de l'attribut et de l'entit\xe9. L'\xe9v\xe9nement attribut est appel\xe9 en premier, puis l'\xe9v\xe9nement entit\xe9."}),"\n",(0,r.jsx)(n.h3,{id:"ex\xe9cution-en-configuration-distante",children:"Ex\xe9cution en configuration distante"}),"\n",(0,r.jsx)(n.p,{children:"En g\xe9n\xe9ral, les \xe9v\xe9nements ORDA sont ex\xe9cut\xe9s sur le serveur."}),"\n",(0,r.jsxs)(n.p,{children:["Cependant, dans une configuration client/serveur, la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"touched()"})," peut \xeatre ex\xe9cut\xe9e sur ",(0,r.jsx)(n.strong,{children:"le serveur ou le client"}),", en fonction de l'utilisation du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})}),". Une impl\xe9mentation sp\xe9cifique c\xf4t\xe9 client permet de d\xe9clencher l'\xe9v\xe9nement sur le client."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Les fonctions ORDA ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#class-constructor",children:(0,r.jsx)(n.code,{children:"constructor()"})})," sont toujours ex\xe9cut\xe9es sur le client."]})}),"\n",(0,r.jsxs)(n.p,{children:["Avec les autres configurations \xe0 distance (c'est-\xe0-dire les ",(0,r.jsx)(n.a,{href:"https://developer.4d.com/qodly",children:"applications Qodly"}),", les ",(0,r.jsx)(n.a,{href:"/docs/fr/REST/REST_requests",children:"requ\xeates API REST"}),", ou les requ\xeates via ",(0,r.jsx)(n.a,{href:"/docs/fr/commands/open-datastore",children:(0,r.jsx)(n.code,{children:"Open datastore"})}),"), la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"touched()"})," est toujours ex\xe9cut\xe9e ",(0,r.jsx)(n.strong,{children:"c\xf4t\xe9 serveur"}),". Cela signifie que vous devez vous assurer que le serveur peut \"voir\" qu'un attribut a \xe9t\xe9 touch\xe9 pour d\xe9clencher l'\xe9v\xe9nement (voir ci-dessous)."]}),"\n",(0,r.jsx)(n.h3,{id:"tableau-de-synth\xe8se",children:"Tableau de synth\xe8se"}),"\n",(0,r.jsx)(n.p,{children:"Le tableau suivant liste les \xe9v\xe9nements d'entit\xe9 ORDA ainsi que leurs r\xe8gles."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Ev\xe9nement"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Niveau"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de la fonction"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"(C/S) Ex\xe9cut\xe9 sur"}),(0,r.jsx)(n.th,{children:"Peut arr\xeater l'action en renvoyant une erreur"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Instanciation d'entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"client"}),(0,r.jsx)(n.td,{children:"non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut touched"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched <attrName>()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]}),(0,r.jsx)(n.td,{children:"non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]}),(0,r.jsx)(n.td,{children:"non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Avant l'enregistrement d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateSave <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateSave()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Pendant l'enregistrement d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"saving <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"saving()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Apr\xe8s l'enregistrement d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"afterSave()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"non"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Avant la suppression d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateDrop <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateDrop()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Pendant la suppression d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"dropping <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"dropping()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Apr\xe8s la suppression d'une entit\xe9"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"afterDrop()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"non"})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La fonction ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})," n'est pas en soi une fonction d'\xe9v\xe9nement, mais elle est toujours appel\xe9e lorsqu'une nouvelle entit\xe9 est instanci\xe9e."]})}),"\n",(0,r.jsxs)(n.h2,{id:"param\xe8tre-event",children:["Param\xe8tre ",(0,r.jsx)(n.em,{children:"event"})]}),"\n",(0,r.jsxs)(n.p,{children:["Les fonctions d'\xe9v\xe9nement acceptent un seul objet ",(0,r.jsx)(n.em,{children:"event"})," comme param\xe8tre. Lorsque la fonction est appel\xe9e, le param\xe8tre est rempli avec diverses propri\xe9t\xe9s :"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de propri\xe9t\xe9"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Disponibilit\xe9"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Description"}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"kind"'}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'Nom de l\'\xe9v\xe9nement : "touched", "validateSave", "saving", "afterSave", "validateDrop", "dropping", "afterDrop"'}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"attributeName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'Uniquement pour les \xe9v\xe9nements d\xe9finis au niveau des attributs ("validateSave", "saving", "validateDrop", "dropping")'}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom de l'attribut (",(0,r.jsx)(n.em,{children:"ex."}),' "firstname")']}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"dataClassName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom du verre de donn\xe9es (",(0,r.jsx)(n.em,{children:"ex."}),' "Company")']}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"savedAttributes"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Uniquement dans ",(0,r.jsx)(n.a,{href:"#function-event-aftersave",children:(0,r.jsx)(n.code,{children:"afterSave()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Collection de cha\xeenes"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Noms des attributs correctement enregistr\xe9s"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"droppedAttributes"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Uniquement dans ",(0,r.jsx)(n.a,{href:"#function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"afterDrop()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Collection de cha\xeenes"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Noms des attributs correctement supprim\xe9s"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"saveStatus"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Uniquement dans ",(0,r.jsx)(n.a,{href:"#function-event-aftersave",children:(0,r.jsx)(n.code,{children:"afterSave()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"success" si l\'enregistrement a r\xe9ussi, "failed" sinon'}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"dropStatus"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Uniquement dans ",(0,r.jsx)(n.a,{href:"#function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"afterDrop()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"success" si la suppression a r\xe9ussi, "failed" sinon'}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"objet-error",children:"Objet error"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"#summary-table",children:"Certaines fonctions d'\xe9v\xe9nement"})," peuvent renvoyer un ",(0,r.jsx)(n.strong,{children:"objet error"})," pour d\xe9clencher une erreur et arr\xeater l'action en cours."]}),"\n",(0,r.jsxs)(n.p,{children:["Lorsqu'une erreur survient dans un \xe9v\xe9nement, les autres \xe9v\xe9nements sont stopp\xe9s \xe0 la premi\xe8re erreur signal\xe9e et l'action (enregistrement pu suppression) est \xe9galement arr\xeat\xe9e. Cette erreur est envoy\xe9e avant d'autres erreurs potentielles telles que ",(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#save",children:"stamp has changed, entity locked"}),", etc."]}),"\n",(0,r.jsx)(n.h3,{id:"propri\xe9t\xe9s-de-lobjet-error",children:"Propri\xe9t\xe9s de l'objet error"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propri\xe9t\xe9"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Fix\xe9 par le d\xe9veloppeur"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"errCode"}),(0,r.jsx)(n.td,{children:"Integer"}),(0,r.jsxs)(n.td,{children:["Identique \xe0 la commande ",(0,r.jsx)(n.a,{href:"/docs/fr/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})})]}),(0,r.jsx)(n.td,{children:"Oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"message"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["Identique \xe0 la commande ",(0,r.jsx)(n.a,{href:"/docs/fr/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})})]}),(0,r.jsx)(n.td,{children:"Oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"extraDescription"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{children:"Informations libres \xe0 d\xe9finir"}),(0,r.jsx)(n.td,{children:"Oui"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"seriousError"}),(0,r.jsx)(n.td,{children:"Boolean"}),(0,r.jsxs)(n.td,{children:["Utilis\xe9 uniquement avec les \xe9v\xe9nements de validation (voir ci-dessous). ",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"True"})," : cr\xe9e une ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"erreur critique (impr\xe9visible)"})," et d\xe9clenche une exception. Ajoute le statut ",(0,r.jsx)(n.code,{children:"dk status serious validation error"})]}),(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"False"})," : cr\xe9e seulement une ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"erreur silencieuse (pr\xe9visible)"}),". Ajoute le statut ",(0,r.jsx)(n.code,{children:"dk status validation failed"}),"."]})]}),(0,r.jsx)(n.td,{children:"Oui (par d\xe9faut : False)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"componentSignature"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:'Toujours "DBEV"'}),(0,r.jsx)(n.td,{children:"Non"})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Les ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"erreurs critiques"})," sont empil\xe9es dans la collection de la propri\xe9t\xe9 ",(0,r.jsx)(n.code,{children:"errors"})," de l'objet ",(0,r.jsx)(n.strong,{children:"Result"})," renvoy\xe9 par les fonctions ",(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"save()"})})," ou ",(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"drop()"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Dans le cas d'une erreur d\xe9clench\xe9e par un \xe9v\xe9nement ",(0,r.jsx)(n.strong,{children:"validate"}),", la propri\xe9t\xe9 ",(0,r.jsx)(n.code,{children:"seriousError"})," permet de choisir le niveau d'erreur \xe0 g\xe9n\xe9rer :\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Si ",(0,r.jsx)(n.strong,{children:"true"})," : une erreur critique est d\xe9clench\xe9e et doit \xeatre trait\xe9e par le ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"code de traitement des erreurs"}),", par exemple un ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#trycatchend-try",children:'"try catch"'}),". Dans l'objet r\xe9sultat de la fonction appelante, ",(0,r.jsx)(n.code,{children:"status"})," vaut ",(0,r.jsx)(n.code,{children:"dk status serious validation error"})," et ",(0,r.jsx)(n.code,{children:"statusText"})," vaut \"Serious Validation Error\". L'erreur est lev\xe9e \xe0 la fin de l'\xe9v\xe9nement et parvient au client qui demande l'action d'enregistrement/suppression (client REST par exemple)."]}),"\n",(0,r.jsxs)(n.li,{children:["Si ",(0,r.jsx)(n.strong,{children:"false"})," (d\xe9faut) : une ",(0,r.jsx)(n.a,{href:"/docs/fr/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"erreur silencieuse (pr\xe9visible) est g\xe9n\xe9r\xe9e"}),". Elle ne d\xe9clenche aucune exception et n'est pas empil\xe9e dans les erreurs retourn\xe9es par la commande ",(0,r.jsx)(n.a,{href:"/docs/fr/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})}),". Dans l'objet r\xe9sultat de la fonction appelante, ",(0,r.jsx)(n.code,{children:"status"})," vaut ",(0,r.jsx)(n.code,{children:"dk status validation failed"})," et ",(0,r.jsx)(n.code,{children:"statusText"}),' vaut "Mild Validation Error".']}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Dans le cas d'une erreur d\xe9clench\xe9e par un \xe9v\xe9nement ",(0,r.jsx)(n.strong,{children:"saving/dropping"}),", lorsqu'un objet d'erreur est renvoy\xe9, l'erreur est toujours d\xe9finie comme critique, quelle que soit la valeur de la propri\xe9t\xe9 ",(0,r.jsx)(n.code,{children:"seriousError"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"description-des-fonctions",children:"Description des fonctions"}),"\n",(0,r.jsx)(n.h3,{id:"function-event-touched",children:(0,r.jsx)(n.code,{children:"Function event touched"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"{local} Function event touched($event : Object)\n{local} Function event touched <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une valeur est modifi\xe9e dans l'entit\xe9."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est d\xe9clench\xe9e pour des modifications sur n'importe quel attribut de l'entit\xe9."}),"\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est d\xe9clench\xe9e que pour les modifications sur cet attribut."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 d\xe8s que le moteur de 4D Server / 4D d\xe9tecte une modification de la valeur de l'attribut qui peut \xeatre due aux actions suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur avec le ",(0,r.jsxs)(n.a,{href:"/docs/fr/ORDA/ordaClasses#local-functions",children:["mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]})]})," ou en ",(0,r.jsx)(n.strong,{children:"4D mono-utilisateur"})," :\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"l'utilisateur saisit une valeur dans un formulaire 4D,"}),"\n",(0,r.jsxs)(n.li,{children:["le code 4D effectue une assignation avec l'op\xe9rateur ",(0,r.jsx)(n.code,{children:":="}),". L'\xe9v\xe9nement est \xe9galement d\xe9clench\xe9 en cas d'auto-assignation (",(0,r.jsx)(n.code,{children:"$entity.attribute:=$entity.attribute"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]})," : du code 4D effectue une assignation avec l'op\xe9rateur ",(0,r.jsx)(n.code,{children:":="})," est ",(0,r.jsx)(n.a,{href:"/docs/fr/commands/execute-on-server",children:"ex\xe9cut\xe9 sur le serveur"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]}),", une ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://developer.4d.com/qodly",children:"application Qodly"})})," ou ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/fr/commands/open-datastore",children:"datastore distant"})})," : l'entit\xe9 est re\xe7ue sur le serveur 4D lors de l'appel d'une fonction ORDA (sur l'entit\xe9 ou avec l'entit\xe9 en tant que param\xe8tre). Cela signifie que vous devrez peut-\xeatre mettre en place une fonction ",(0,r.jsx)(n.em,{children:"refresh"})," ou ",(0,r.jsx)(n.em,{children:"preview"})," sur l'application distante qui envoie une requ\xeate ORDA au serveur et d\xe9clenche l'\xe9v\xe9nement."]}),"\n",(0,r.jsxs)(n.li,{children:["avec le serveur REST : la valeur est re\xe7ue sur le serveur REST avec une ",(0,r.jsx)(n.a,{href:"/docs/fr/REST/method#methodupdate",children:"requ\xeate REST"})," (",(0,r.jsx)(n.code,{children:"$method=update"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsxs)(n.p,{children:["Si cette fonction ",(0,r.jsx)(n.a,{href:"../commands/throw",children:"g\xe9n\xe8re"})," une erreur, elle n'arr\xeatera pas l'action en cours."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est \xe9galement d\xe9clench\xe9 :"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["lorsque les attributs sont assign\xe9s par l'\xe9v\xe9nement ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})}),","]}),"\n",(0,r.jsxs)(n.li,{children:["lorsque les attributs sont modifi\xe9s via l'",(0,r.jsx)(n.a,{href:"/docs/fr/Admin/dataExplorer",children:"Explorateur de donn\xe9es"}),"."]}),"\n"]})]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,r.jsx)(n.p,{children:"Vous souhaitez mettre en majuscules tous les attributs de texte d'une entit\xe9 lorsqu'elle est mise \xe0 jour."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //ProductsEntity class\nFunction event touched($event : Object)\n	\n	If (Value type(This[$event.attributeName])=Is text)\n		This[$event.attributeName]:=Uppercase(This[$event.attributeName])\n	End if \n"})}),"\n",(0,r.jsx)(n.h4,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,r.jsxs)(n.p,{children:["L'\xe9v\xe9nement \"touched\" est utile quand il n'est pas possible d'\xe9crire un code de requ\xeate index\xe9e dans ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"Function query()"})})," pour un ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#computed-attributes",children:"attribut calcul\xe9"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["C'est le cas, par exemple, lorsque votre fonction ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," doit comparer la valeur de diff\xe9rents attributs de la m\xeame entit\xe9. Vous devez utiliser des formules dans la requ\xeate ORDA renvoy\xe9e, ce qui d\xe9clenche des requ\xeates s\xe9quentielles."]}),"\n",(0,r.jsx)(n.p,{children:"Pour bien comprendre ce cas, examinons les deux attributs calcul\xe9s suivants :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function get onGoing() : Boolean\n        return ((This.departureDate<=Current date) & (This.arrivalDate>=Current date))\n\nFunction get sameDay() : Boolean\n        return (This.departureDate=This.arrivalDate)\n"})}),"\n",(0,r.jsx)(n.p,{children:"M\xeame si elles sont tr\xe8s similaires, ces fonctions ne peuvent pas \xeatre associ\xe9es \xe0 des requ\xeates identiques car elles ne comparent pas les m\xeames types de valeurs. Le premier compare les attributs \xe0 une valeur donn\xe9e, tandis que le second compare les attributs entre eux."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Pour l'attribut ",(0,r.jsx)(n.em,{children:"onGoing"}),", la fonction ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," est simple \xe0 \xe9crire et utilise des attributs index\xe9s :"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query onGoing($event : Object) : Object\n    var $operator : Text\n    var $myQuery : Text\n    var $onGoingValue : Boolean\n    var $parameters : Collection\n    $parameters:=New collection()\n\n    $operator:=$event.operator\n    Case of \n            : (($operator="=") | ($operator="==") | ($operator="==="))\n                $onGoingValue:=Bool($event.value)\n            : (($operator="!=") | ($operator="!=="))\n                $onGoingValue:=Not(Bool($event.value))\n            Else \n                return {query: ""; parameters: $parameters}\n    End case \n\n    $myQuery:=($onGoingValue) ? "departureDate <= :1 AND arrivalDate >= :1" : "departureDate > :1 OR arrivalDate < :1"\n        // la cha\xeene de requ\xeate ORDA utilise des attributs index\xe9s, elle sera index\xe9e\n    $parameters.push(Current date)\n    return {query: $myQuery; parameters: $parameters}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Pour l'attribut ",(0,r.jsx)(n.em,{children:"sameDay"}),", la fonction ",(0,r.jsx)(n.a,{href:"/docs/fr/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," requiert une requ\xeate ORDA bas\xe9e sur des formules et sera s\xe9quentielle :"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query sameDay($event : Object) : Text\n    var $operator : Text\n    var $sameDayValue : Boolean\n\n    $operator:=$event.operator\n    Case of \n        : (($operator="=") | ($operator="==") | ($operator="==="))\n            $sameDayValue:=Bool($event.value)\n        : (($operator="!=") | ($operator="!=="))\n            $sameDayValue:=Not(Bool($event.value))\n        Else \n            return ""\n        End case \n\n    return ($sameDayValue) ? "eval(This.departureDate = This.arrivalDate)" : "eval(This.departureDate != This.arrivalDate)"\n        // la requ\xeate ORDA utilise une formule, elle ne sera pas index\xe9e\n\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["L'utilisation d'un attribut ",(0,r.jsx)(n.strong,{children:"scalaire"})," ",(0,r.jsx)(n.em,{children:"sameDay"}),' mis \xe0 jour lorsque d\'autres attributs sont "touched" permet de gagner du temps :']}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //BookingEntity class\n\nFunction event touched departureDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate) \n//\n//\nFunction event touched arrivalDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate)\n\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"exemple-3-diagramme--clientserveur-avec-le-mot-cl\xe9-local-",children:["Exemple 3 (diagramme) : Client/serveur avec le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})," :"]}),"\n",(0,r.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:=\"Brown\"\n   Note over Client: local Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\nNote over Client:$people.lastname is uppercased\n\n    Client->>+Server: $people.apply()\n   \n   Note over Server: L'entity $people est re\xe7ue avec l'attribut lastname en majuscules\n"}),"\n",(0,r.jsxs)(n.h4,{id:"exemple-4-diagramme--clientserveur-avec-le-mot-cl\xe9-local",children:["Exemple 4 (diagramme) : Client/serveur avec le mot-cl\xe9 ",(0,r.jsx)(n.code,{children:"local"})]}),"\n",(0,r.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:=\"Brown\"\n\n   Note over Client:$people.lastname n'est pas en majuscules\n\n    Client->>+Server: $people.apply()\n\n   Note over Server: Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\n    Server--\x3e>-Client: L'entit\xe9 $people est mise \xe0 jour\n\n   Note over Client:$people.lastname est en majuscules\n\n"}),"\n",(0,r.jsx)(n.h4,{id:"exemple-5-diagramme--application-qodly",children:"Exemple 5 (diagramme) : Application Qodly"}),"\n",(0,r.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\nQodly page->>+ Server: R\xe9cup\xe9rer une entit\xe9 dans la source Qodly People\n\nQodly page->>+Qodly page: L'utilisateur met \xe0 jour People.lastname\n\nNote over Qodly page: L'attribut lastname de la source Qodly People n'est pas en majuscules\n\nQodly page->>+ Server: Appel de fonction People.apply()\n\nNote over Server: Function event touched lastname($event : Object) <br> This.lastname:=Uppercase(This.lastname)\n\nServer--\x3e>-Qodly page: La source Qodly People est mise \xe0 jour\nNote over Qodly page: L'attribut lastname de la source Qodly People est en majuscules\n\n"}),"\n",(0,r.jsx)(n.h3,{id:"function-event-validatesave",children:(0,r.jsx)(n.code,{children:"Function event validateSave"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-1",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event validateSave($event : Object)\nFunction event validateSave <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une entit\xe9 est sur le point d'\xeatre sauvegard\xe9e."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est appel\xe9e pour tout attribut de l'entit\xe9."}),"\n",(0,r.jsxs)(n.li,{children:["si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est appel\xe9e que pour cet attribut. Cette fonction n'est ",(0,r.jsx)(n.strong,{children:"pas"})," ex\xe9cut\xe9e si l'attribut n'a pas \xe9t\xe9 modifi\xe9 dans l'entit\xe9."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 par les fonctions suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"entity.save()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"dataClass.fromCollection()"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Cet \xe9v\xe9nement est d\xe9clench\xe9 ",(0,r.jsx)(n.strong,{children:"avant"})," que l'entit\xe9 ne soit r\xe9ellement sauvegard\xe9e et vous permet de v\xe9rifier la coh\xe9rence des donn\xe9es afin d'interrompre l'action si n\xe9cessaire. Par exemple, vous pouvez v\xe9rifier dans cet \xe9v\xe9nement que \"date de d\xe9part\" < \"date d'arriv\xe9e\"."]}),"\n",(0,r.jsxs)(n.p,{children:["Pour stopper l'action, le code de la fonction doit renvoyer un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Il n'est pas recommand\xe9 de mettre \xe0 jour l'entit\xe9 dans le cadre de cette fonction (en utilisant ",(0,r.jsx)(n.code,{children:"This"}),")."]})}),"\n",(0,r.jsx)(n.h4,{id:"exemple",children:"Exemple"}),"\n",(0,r.jsx)(n.p,{children:"Dans cet exemple, il n'est pas permis de sauvegarder un produit dont la marge est inf\xe9rieure \xe0 50 %. En cas d'attribut de prix non valide, vous renvoyez un objet erreur et arr\xeatez ainsi l'action de sauvegarde."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// ProductsEntity class\n//\n// event validateSave au niveau attribut\nFunction event validateSave margin($event : Object) : Object\n	\nvar $result : Object\n	\n//L\'utilisateur ne peut pas cr\xe9er un produit dont la marge est < 50%\nIf (This.margin<50)\n	$result:={errCode: 1; message: "The validation of this product failed"; \\\n	extraDescription: {info: "The margin of this product ("+String(This.margin)+") is lower than 50%"}; seriousError: False}\nEnd if \nreturn $result\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-saving",children:(0,r.jsx)(n.code,{children:"Function event saving"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-2",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event saving($event : Object)\nFunction event saving <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une entit\xe9 est sur le point d'\xeatre sauvegard\xe9e."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est appel\xe9e pour tout attribut de l'entit\xe9. La fonction est ex\xe9cut\xe9e m\xeame si aucun attribut n'a \xe9t\xe9 touch\xe9 dans l'entit\xe9 (par exemple, dans le cas de l'envoi de donn\xe9es \xe0 une application externe \xe0 chaque fois qu'une sauvegarde est effectu\xe9e)."}),"\n",(0,r.jsxs)(n.li,{children:["Si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est appel\xe9e que pour cet attribut. La fonction n'est ",(0,r.jsx)(n.strong,{children:"pas"})," ex\xe9cut\xe9e si l'attribut n'a pas \xe9t\xe9 touch\xe9 dans l'entit\xe9."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 par les fonctions suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"entity.save()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"dataClass.fromCollection()"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Cet \xe9v\xe9nement est d\xe9clench\xe9 ",(0,r.jsx)(n.strong,{children:"pendant que"})," l'entit\xe9 est sauvegard\xe9e. Si une fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.a,{href:"#function-event-validatesave",children:(0,r.jsx)(n.code,{children:"validateSave()"})})," a \xe9t\xe9 d\xe9finie, la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"saving()"})," est appel\xe9e si aucune erreur n'a \xe9t\xe9 d\xe9clench\xe9e par ",(0,r.jsx)(n.code,{children:"validateSave()"}),". Par exemple, vous pouvez utiliser cet \xe9v\xe9nement pour cr\xe9er un document sur un compte Google Drive."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La logique applicative doit g\xe9n\xe9rer les erreurs qui ne peuvent pas \xeatre d\xe9tect\xe9es lors des \xe9v\xe9nements ",(0,r.jsx)(n.code,{children:"validateSave()"}),", par exemple une erreur de r\xe9seau."]})}),"\n",(0,r.jsx)(n.p,{children:"Lors de l'action de sauvegarde, des erreurs du moteur 4D peuvent \xeatre g\xe9n\xe9r\xe9es (index, le marqueur stamp a chang\xe9, pas assez d'espace sur le disque)."}),"\n",(0,r.jsxs)(n.p,{children:["Pour stopper l'action, le code de la fonction doit renvoyer un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-3",children:"Exemple"}),"\n",(0,r.jsx)(n.p,{children:"Lorsqu'un fichier est sauvegard\xe9 sur le disque, intercepter par exemple les erreurs li\xe9es \xe0 l'espace disque."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"// Classe ProductsEntity\n// Ev\xe9nement save au niveau de l'attribut\nFunction event saving userManualPath($event : Object) : Object\n	\nvar $result : Object\nvar $userManualFile : 4D.File\nvar $fileCreated : Boolean\n	\nIf (This.userManualPath#\"\")\n	$userManualFile:=File(This.userManualPath)\n				\n	// Le fichier du manuel de l'utilisateur est cr\xe9\xe9 sur le disque\n	// Cela peut \xe9chouer s'il n'y a plus d'espace disponible\n	Try\n        // Le contenu du fichier a \xe9t\xe9 g\xe9n\xe9r\xe9 et stock\xe9 dans une carte dans Storage.docMap pr\xe9c\xe9demment\n	    $docInfo:=Storage.docMap.query(\"name = :1\" ; This.name).first()\n        $userManualFile.setContent($docInfo.content)\n	Catch\n		// Il n'y a plus de place sur le disque par exemple\n		$result:={/\n            errCode : 1 ; message : \"Error during the save action for this product\" ; /\n            extraDescription : {info : \"Il n'y a pas d'espace disponible sur le disque pour stocker le manuel de l'utilisateur\"}/\n        }\n	End try\nEnd if \n	\nreturn $result\n\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Le contenu du fichier est g\xe9n\xe9r\xe9 en dehors de l'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"saving"})," car cela peut prendre du temps."]})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-aftersave",children:(0,r.jsx)(n.code,{children:"Function event afterSave"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-3",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event afterSave($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 juste apr\xe8s la sauvegarde d'une entit\xe9 dans le fichier de donn\xe9es, lorsqu'au moins un attribut a \xe9t\xe9 modifi\xe9. Elle n'est pas ex\xe9cut\xe9e si aucun attribut n'a \xe9t\xe9 modifi\xe9 dans l'entit\xe9."}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est utile apr\xe8s la sauvegarde des donn\xe9es pour propager l'action de sauvegarde en dehors de l'application ou pour ex\xe9cuter des t\xe2ches d'administration. Par exemple, il peut \xeatre utilis\xe9 pour envoyer un courriel de confirmation apr\xe8s la sauvegarde des donn\xe9es. Ou, en cas d'erreur lors de l'enregistrement des donn\xe9es, il peut effectuer un retour en arri\xe8re pour restaurer un \xe9tat coh\xe9rent des donn\xe9es."}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Pour \xe9viter les boucles infinies, appeler un ",(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"save()"})})," sur l'entit\xe9 courante (via ",(0,r.jsx)(n.code,{children:"This"}),") dans cette fonction n'est ",(0,r.jsx)(n.strong,{children:"pas autoris\xe9"}),". Cela provoquera une erreur."]}),"\n",(0,r.jsxs)(n.li,{children:["Faire un throw d'un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"})," n'est ",(0,r.jsx)(n.strong,{children:"pas pris en charge"})," par cette fonction."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-4",children:"Exemple"}),"\n",(0,r.jsxs)(n.p,{children:["Si une erreur s'est produite lors de l'\xe9v\xe9nement de sauvegarder ci-dessus, la valeur de l'attribut est r\xe9initialis\xe9e en cons\xe9quence dans l'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"afterSave"})," :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// Classe ProductsEntity\nFunction event afterSave($event : Object)\n	\nIf (($event.status.success=False) && ($event.status.errors=Null))  \n    // $event.status.errors est rempli si l\'erreur provient de l\'\xe9v\xe9nement validateSave\n		\n	// L\'attribut userManualPath n\'a pas \xe9t\xe9 correctement sauvegard\xe9\n	// Sa valeur est r\xe9initialis\xe9e\n	If ($event.savedAttributes.indexOf("userManualPath")=-1)\n		This.userManualPath:="\n		This.status:="KO"\n	End if \n		\nEnd if \n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-validatedrop",children:(0,r.jsx)(n.code,{children:"Function event validateDrop"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-4",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event validateDrop($event : Object)\nFunction event validateDrop <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une entit\xe9 est sur le point d'\xeatre supprim\xe9e."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est appel\xe9e pour tout attribut de l'entit\xe9."}),"\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est appel\xe9e que pour cet attribut."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 par les fonctionnalit\xe9s suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"entity.drop()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"entitySelection.drop()"})})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://doc.4d.com/4Dv20/4D/20.2/Relation-properties.300-6750290.en.html#107320",children:"r\xe8gles de contr\xf4le de la suppression"})," qui peuvent \xeatre d\xe9finies au niveau de la structure de la base de donn\xe9es."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Cet \xe9v\xe9nement est d\xe9clench\xe9 ",(0,r.jsx)(n.strong,{children:"avant"})," que l'entit\xe9 ne soit effectivement supprim\xe9e, ce qui permet de v\xe9rifier la coh\xe9rence des donn\xe9es et, le cas \xe9ch\xe9ant, d'interrompre l'action de suppression."]}),"\n",(0,r.jsxs)(n.p,{children:["Pour stopper l'action, le code de la fonction doit renvoyer un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-5",children:"Exemple"}),"\n",(0,r.jsx)(n.p,{children:"Dans cet exemple, il n'est pas permis de supprimer un produit qui n'est pas libell\xe9 \"TO DELETE\". Dans ce cas, vous renvoyez un objet d'erreur et stoppez ainsi l'action de suppression."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// Classe ProductsEntity\n\nFunction event validateDrop status($event : Object) : Object\n\nvar $result : Objet\n\n// Les produits doivent \xeatre marqu\xe9s TO DELETE pour \xeatre supprimables\nIf (This.status#"TO DELETE")\n    $result:={errCode : 1 ; message : "Vous ne pouvez pas supprimer ce produit" ; \\\n    extraDescription : {info : "Ce produit doit \xeatre marqu\xe9 comme \xe0 supprimer"} ; seriousError : False}\nEnd if \n\nreturn $result\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-dropping",children:(0,r.jsx)(n.code,{children:"Function event dropping"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-5",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event dropping($event : Object)\nFunction event dropping <attributeName>($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une entit\xe9 est supprim\xe9e."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est appel\xe9e pour tout attribut de l'entit\xe9."}),"\n",(0,r.jsx)(n.li,{children:"Si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est appel\xe9e que pour cet attribut."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 par les fonctionnalit\xe9s suivantes :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"entity.drop()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/fr/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"entitySelection.drop()"})})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://doc.4d.com/4Dv20/4D/20.2/Relation-properties.300-6750290.en.html#107320",children:"r\xe8gles de contr\xf4le de la suppression"})," qui peuvent \xeatre d\xe9finies au niveau de la structure de la base de donn\xe9es."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Cet \xe9v\xe9nement est d\xe9clench\xe9 ",(0,r.jsx)(n.strong,{children:"pendant que"})," l'entit\xe9 est effectivement supprim\xe9e. Si une fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.a,{href:"#function-event-validatedrop",children:(0,r.jsx)(n.code,{children:"validateDrop()"})})," a \xe9t\xe9 d\xe9finie, la fonction d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"dropping()"})," est appel\xe9e si aucune erreur n'a \xe9t\xe9 g\xe9n\xe9r\xe9e par ",(0,r.jsx)(n.code,{children:"validateDrop()"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La logique applicative doit g\xe9n\xe9rer les erreurs qui ne peuvent pas \xeatre d\xe9tect\xe9es lors des \xe9v\xe9nements ",(0,r.jsx)(n.code,{children:"validateDrop()"}),", par exemple une erreur de r\xe9seau."]})}),"\n",(0,r.jsxs)(n.p,{children:["Pour stopper l'action, le code de la fonction doit renvoyer un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"exemple-6",children:"Exemple"}),"\n",(0,r.jsxs)(n.p,{children:["Voici un exemple d'\xe9v\xe9nement ",(0,r.jsx)(n.code,{children:"dropping"})," au niveau de l'entit\xe9 :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"// Classe ProductsEntity\nFunction event dropping($event : Object) : Object\n\nvar $result : Object\nvar $userManualFile : 4D.File\n\n$userManualFile:=File(This.userManualPath)\n\n    // Lors de la suppression d'un produit, son manuel d'utilisation est \xe9galement supprim\xe9 sur le disque\n    // Cette action peut \xe9chouer\nTry\n    If ($userManualFile.exists)\n        $userManualFile.delete()\n    End if \nCatch\n    // La suppression du manuel d'utilisation a \xe9chou\xe9\n    $result:={errCode : 1 ; message : \"Drop failed\" ; extraDescription : {info : \"Le manuel de l'utilisateur ne peut pas \xeatre supprim\xe9\"}}\nEnd try\n\nreturn $result\n"})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"Function event afterDrop"})}),"\n",(0,r.jsx)(n.h4,{id:"syntaxe-6",children:"Syntaxe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event afterDrop($event : Object)\n// code\n"})}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 juste apr\xe8s la suppression d'une entit\xe9."}),"\n",(0,r.jsx)(n.p,{children:"Cet \xe9v\xe9nement est utile apr\xe8s la suppression de donn\xe9es pour propager l'action de suppression en dehors de l'application ou pour ex\xe9cuter des t\xe2ches d'administration. Par exemple, il peut \xeatre utilis\xe9 pour envoyer un courriel d'annulation apr\xe8s la suppression de donn\xe9es. Ou, en cas d'erreur lors de la suppression des donn\xe9es, il peut enregistrer une information permettant \xe0 l'administrateur de v\xe9rifier la coh\xe9rence des donn\xe9es."}),"\n",(0,r.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,r.jsx)(n.a,{href:"#event-parameter",children:(0,r.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Pour \xe9viter les boucles infinies, appeler ",(0,r.jsx)(n.a,{href:"/docs/fr/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"drop()"})})," sur l'entit\xe9 courante (\xe0 travers ",(0,r.jsx)(n.code,{children:"This"}),") dans cette fonction n'est ",(0,r.jsx)(n.strong,{children:"pas autoris\xe9"}),". Cela provoquera une erreur."]}),"\n",(0,r.jsxs)(n.li,{children:["Faire un throw d'un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objet erreur"})," n'est ",(0,r.jsx)(n.strong,{children:"pas pris en charge"})," par cette fonction."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["L'entit\xe9 supprim\xe9e est r\xe9f\xe9renc\xe9e par ",(0,r.jsx)(n.code,{children:"This"})," et existe toujours en m\xe9moire."]})}),"\n",(0,r.jsx)(n.h4,{id:"exemple-7",children:"Exemple"}),"\n",(0,r.jsx)(n.p,{children:"Si l'action de suppression a \xe9chou\xe9, le produit doit \xeatre v\xe9rifi\xe9 manuellement :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event afterDrop($event : Object)\n\nvar $status : Object\n\nIf (($event.status.success=False) && ($event.status.errors=Null)) \n        //$event.status.errors est rempli \n        //si l'erreur provient de l'\xe9v\xe9nement validateDrop\n    This.status:=\"Check this product - Drop action failed\"\n    $status:=This.save()\nEnd if \n\n"})})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},884429:function(e,n,t){t.d(n,{R:()=>l,x:()=>d});var s=t(296540);let r={},i=s.createContext(r);function l(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);