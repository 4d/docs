"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["39131"],{589414:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>i,toc:()=>o,default:()=>u,metadata:()=>s,assets:()=>d,contentTitle:()=>a});var s=JSON.parse('{"id":"ORDA/orda-events","title":"\xc9v\xe8nements d\'entit\xe9","description":"Historique","source":"@site/i18n/fr/docusaurus-plugin-content-docs/version-20-R10/ORDA/orda-events.md","sourceDirName":"ORDA","slug":"/ORDA/orda-events","permalink":"/docs/fr/20-R10/ORDA/orda-events","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20ORDA%2Forda-events.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"orda-events","title":"\xc9v\xe8nements d\'entit\xe9"},"sidebar":"docs","previous":{"title":"Travailler avec les donn\xe9es","permalink":"/docs/fr/20-R10/ORDA/entities"},"next":{"title":"Utiliser le marqueur global","permalink":"/docs/fr/20-R10/ORDA/global-stamp"}}'),l=t(474848),r=t(884429);let i={id:"orda-events",title:"\xc9v\xe8nements d'entit\xe9"},a,d={},o=[{value:"Vue d\u2019ensemble",id:"vue-densemble",level:2},{value:"Niveau de l&#39;\xe9v\xe9nement",id:"niveau-de-l\xe9v\xe9nement",level:3},{value:"Ex\xe9cution en configuration distante",id:"ex\xe9cution-en-configuration-distante",level:3},{value:"Tableau de synth\xe8se",id:"tableau-de-synth\xe8se",level:3},{value:"Param\xe8tre <em>event</em>",id:"param\xe8tre-event",level:2},{value:"Description des fonctions",id:"description-des-fonctions",level:2},{value:"<code>Function event touched</code>",id:"function-event-touched",level:3},{value:"Syntaxe",id:"syntaxe",level:4},{value:"Exemple 1",id:"exemple-1",level:4},{value:"Exemple 2",id:"exemple-2",level:4},{value:"Exemple 3 (diagramme) : Client/serveur avec le mot-cl\xe9 <code>local</code> :",id:"exemple-3-diagramme--clientserveur-avec-le-mot-cl\xe9-local-",level:4},{value:"Exemple 4 (diagramme) : Client/serveur avec le mot-cl\xe9 <code>local</code>",id:"exemple-4-diagramme--clientserveur-avec-le-mot-cl\xe9-local",level:4},{value:"Exemple 5 (diagramme) : Application Qodly",id:"exemple-5-diagramme--application-qodly",level:4}];function c(e){let n={a:"a",admonition:"admonition",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.details,{children:[(0,l.jsx)(n.summary,{children:"Historique"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Release"}),(0,l.jsx)(n.th,{children:"Modifications"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"20 R10"}),(0,l.jsx)(n.td,{children:"ajout \xe9v\xe9nement touched"})]})})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 sont des fonctions qui sont automatiquement invoqu\xe9es par ORDA chaque fois que des entit\xe9s et des attributs d'entit\xe9 sont touch\xe9s (ajout\xe9s, supprim\xe9s ou modifi\xe9s). Vous pouvez \xe9crire des \xe9v\xe9nements tr\xe8s simples, puis les rendre plus sophistiqu\xe9s."}),"\n",(0,l.jsx)(n.p,{children:"Vous ne pouvez pas d\xe9clencher directement l'ex\xe9cution d'une fonction d'\xe9v\xe9nement. Les \xe9v\xe9nements sont appel\xe9s automatiquement par ORDA en fonction des actions de l'utilisateur ou des op\xe9rations effectu\xe9es par le code sur les entit\xe9s et leurs attributs."}),"\n",(0,l.jsx)(n.admonition,{title:"Note de compatibilit\xe9",type:"info",children:(0,l.jsx)(n.p,{children:"Les \xe9v\xe9nements d'entit\xe9 ORDA dans le datastore sont \xe9quivalents aux triggers dans la base de donn\xe9es 4D. Cependant, les actions d\xe9clench\xe9es au niveau de la base de donn\xe9es 4D \xe0 l'aide des commandes du langage classique 4D ou des actions standard ne d\xe9clenchent pas les \xe9v\xe9nements ORDA. Notez \xe9galement que, contrairement aux triggers, les \xe9v\xe9nements d'entit\xe9 ORDA ne verrouillent pas l'ensemble de la table sous-jacente d'une dataclass lors de l'enregistrement ou de la suppression d'entit\xe9s. Plusieurs \xe9v\xe9nements peuvent se d\xe9rouler en parall\xe8le tant qu'ils concernent des entit\xe9s distinctes (c'est-\xe0-dire des enregistrements distincts)."})}),"\n",(0,l.jsx)(n.h2,{id:"vue-densemble",children:"Vue d\u2019ensemble"}),"\n",(0,l.jsx)(n.h3,{id:"niveau-de-l\xe9v\xe9nement",children:"Niveau de l'\xe9v\xe9nement"}),"\n",(0,l.jsxs)(n.p,{children:["Une fonction d'\xe9v\xe9nement d'entit\xe9 est toujours d\xe9finie dans la ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#entity-class",children:"classe Entity"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Un \xe9v\xe9nement peut \xeatre d\xe9fini au niveau de l'",(0,l.jsx)(n.strong,{children:"entit\xe9"})," et/ou de l'",(0,l.jsx)(n.strong,{children:"attribut"})," (y compris les ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#computed-attributes",children:(0,l.jsx)(n.strong,{children:"attributs calcul\xe9s"})}),"). Dans le premier cas, il sera d\xe9clench\xe9 pour tous les attributs de l'entit\xe9 ; dans l'autre cas, il ne sera d\xe9clench\xe9 que pour l'attribut cibl\xe9."]}),"\n",(0,l.jsx)(n.p,{children:"Pour un m\xeame \xe9v\xe9nement, vous pouvez d\xe9finir diff\xe9rentes fonctions pour diff\xe9rents attributs."}),"\n",(0,l.jsx)(n.p,{children:"Vous pouvez \xe9galement d\xe9finir le m\xeame \xe9v\xe9nement au niveau de l'attribut et de l'entit\xe9. L'\xe9v\xe9nement attribut est appel\xe9 en premier, puis l'\xe9v\xe9nement entit\xe9."}),"\n",(0,l.jsx)(n.h3,{id:"ex\xe9cution-en-configuration-distante",children:"Ex\xe9cution en configuration distante"}),"\n",(0,l.jsx)(n.p,{children:"En g\xe9n\xe9ral, les \xe9v\xe9nements ORDA sont ex\xe9cut\xe9s sur le serveur."}),"\n",(0,l.jsxs)(n.p,{children:["Cependant, dans une configuration client/serveur, la fonction d'\xe9v\xe9nement ",(0,l.jsx)(n.code,{children:"touched()"})," peut \xeatre ex\xe9cut\xe9e sur ",(0,l.jsx)(n.strong,{children:"le serveur ou le client"}),", en fonction de l'utilisation du mot-cl\xe9 ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,l.jsx)(n.code,{children:"local"})}),". Une impl\xe9mentation sp\xe9cifique c\xf4t\xe9 client permet de d\xe9clencher l'\xe9v\xe9nement sur le client."]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["Les fonctions ORDA ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor",children:(0,l.jsx)(n.code,{children:"constructor()"})})," sont toujours ex\xe9cut\xe9es sur le client."]})}),"\n",(0,l.jsxs)(n.p,{children:["Avec d'autres configurations distantes (i.e. applications Qodly, ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/REST/REST_requests",children:"requ\xeates via l'API REST"}),", ou requ\xeates via ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/commands/open-datastore",children:(0,l.jsx)(n.code,{children:"Open datastore"})}),"), la fonction d'\xe9v\xe9nement ",(0,l.jsx)(n.code,{children:"touched()"})," est toujours ex\xe9cut\xe9e ",(0,l.jsx)(n.strong,{children:"c\xf4t\xe9 serveur"}),". Cela signifie que vous devez vous assurer que le serveur peut \"voir\" qu'un attribut a \xe9t\xe9 touch\xe9 pour d\xe9clencher l'\xe9v\xe9nement (voir ci-dessous)."]}),"\n",(0,l.jsx)(n.h3,{id:"tableau-de-synth\xe8se",children:"Tableau de synth\xe8se"}),"\n",(0,l.jsx)(n.p,{children:"Le tableau suivant liste les \xe9v\xe9nements d'entit\xe9 ORDA ainsi que leurs principes."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Ev\xe9nement"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Niveau"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de la fonction"}),(0,l.jsx)(n.th,{style:{textAlign:"center"},children:"(C/S) Ex\xe9cut\xe9 sur"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Instanciation d'entit\xe9"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,l.jsx)(n.code,{children:"constructor()"})})}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"client"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut touched"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Attribut"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.code,{children:"event touched <attrName>()"})}),(0,l.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,l.jsx)(n.code,{children:"local"})})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"}}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.code,{children:"event touched()"})}),(0,l.jsxs)(n.td,{style:{textAlign:"center"},children:["D\xe9pend du mot-cl\xe9 ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:(0,l.jsx)(n.code,{children:"local"})})]})]})]})]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["La fonction ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,l.jsx)(n.code,{children:"constructor()"})})," n'est pas en soi une fonction d'\xe9v\xe9nement, mais elle est toujours appel\xe9e lorsqu'une nouvelle entit\xe9 est instanci\xe9e."]})}),"\n",(0,l.jsxs)(n.h2,{id:"param\xe8tre-event",children:["Param\xe8tre ",(0,l.jsx)(n.em,{children:"event"})]}),"\n",(0,l.jsxs)(n.p,{children:["Les fonctions d'\xe9v\xe9nement acceptent un seul objet ",(0,l.jsx)(n.em,{children:"event"})," comme param\xe8tre. Lorsque la fonction est appel\xe9e, le param\xe8tre est rempli avec diverses propri\xe9t\xe9s :"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Nom de propri\xe9t\xe9"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Disponibilit\xe9"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.code,{children:"kind"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:'Nom de l\'\xe9v\xe9nement ("touched")'})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.em,{children:"attributeName"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Uniquement pour les \xe9v\xe9nements impliquant un attribut"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,l.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom de l'attribut (",(0,l.jsx)(n.em,{children:"ex."}),' "firstname")']})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.em,{children:"dataClassName"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"Toujours"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,l.jsxs)(n.td,{style:{textAlign:"left"},children:["Nom du verre de donn\xe9es (",(0,l.jsx)(n.em,{children:"ex."}),' "Company")']})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"description-des-fonctions",children:"Description des fonctions"}),"\n",(0,l.jsx)(n.h3,{id:"function-event-touched",children:(0,l.jsx)(n.code,{children:"Function event touched"})}),"\n",(0,l.jsx)(n.h4,{id:"syntaxe",children:"Syntaxe"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:"{local} Function event touched($event : Object)\n{local} Function event touched <attributeName>($event : Object)\n// code\n"})}),"\n",(0,l.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 chaque fois qu'une valeur est modifi\xe9e dans l'entit\xe9."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"si vous avez d\xe9fini la fonction au niveau de l'entit\xe9 (premi\xe8re syntaxe), elle est d\xe9clench\xe9e pour des modifications sur n'importe quel attribut de l'entit\xe9."}),"\n",(0,l.jsx)(n.li,{children:"si vous avez d\xe9fini la fonction au niveau de l'attribut (deuxi\xe8me syntaxe), elle n'est d\xe9clench\xe9e que pour les modifications sur cet attribut."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Cet \xe9v\xe9nement est d\xe9clench\xe9 d\xe8s que le moteur de 4D Server / 4D d\xe9tecte une modification de la valeur de l'attribut qui peut \xeatre due aux actions suivantes :"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["en ",(0,l.jsxs)(n.strong,{children:["client/serveur avec le ",(0,l.jsxs)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#local-functions",children:["mot-cl\xe9 ",(0,l.jsx)(n.code,{children:"local"})]})]})," ou en ",(0,l.jsx)(n.strong,{children:"4D mono-utilisateur"})," :\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"l'utilisateur saisit une valeur dans un formulaire 4D,"}),"\n",(0,l.jsxs)(n.li,{children:["le code 4D effectue une assignation avec l'op\xe9rateur ",(0,l.jsx)(n.code,{children:":="}),". L'\xe9v\xe9nement est \xe9galement d\xe9clench\xe9 en cas d'auto-assignation (",(0,l.jsx)(n.code,{children:"$entity.attribute:=$entity.attribute"}),")."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["en ",(0,l.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,l.jsx)(n.code,{children:"local"})]})," : du code 4D effectue une assignation avec l'op\xe9rateur ",(0,l.jsx)(n.code,{children:":="})," est ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/commands/execute-on-server",children:"ex\xe9cut\xe9 sur le serveur"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["en ",(0,l.jsxs)(n.strong,{children:["client/serveur sans le mot-cl\xe9 ",(0,l.jsx)(n.code,{children:"local"})]}),", une ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"https://developer.qodly.com/docs",children:"application Qodly"})})," ou ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/commands/open-datastore",children:"datastore distant"})})," : l'entit\xe9 est re\xe7ue sur le serveur 4D lors de l'appel d'une fonction ORDA (sur l'entit\xe9 ou avec l'entit\xe9 en tant que param\xe8tre). Cela signifie que vous devrez peut-\xeatre mettre en place une fonction ",(0,l.jsx)(n.em,{children:"refresh"})," ou ",(0,l.jsx)(n.em,{children:"preview"})," sur l'application distante qui envoie une requ\xeate ORDA au serveur et d\xe9clenche l'\xe9v\xe9nement."]}),"\n",(0,l.jsxs)(n.li,{children:["avec le serveur REST : la valeur est re\xe7ue sur le serveur REST avec une ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/REST/method#methodupdate",children:"requ\xeate REST"})," (",(0,l.jsx)(n.code,{children:"$method=update"}),")"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["La fonction re\xe7oit un objet ",(0,l.jsx)(n.a,{href:"#event-parameter",children:(0,l.jsx)(n.em,{children:"event"})})," en param\xe8tre."]}),"\n",(0,l.jsxs)(n.p,{children:["Si cet \xe9v\xe9nement ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/commands/throw",children:"g\xe9n\xe8re une erreur"}),", il n'arr\xeatera pas l'action en cours."]}),"\n",(0,l.jsxs)(n.admonition,{type:"note",children:[(0,l.jsx)(n.p,{children:"Cet \xe9v\xe9nement est \xe9galement d\xe9clench\xe9 :"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["lorsque les attributs sont assign\xe9s par l'\xe9v\xe9nement ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#class-constructor-1",children:(0,l.jsx)(n.code,{children:"constructor()"})}),","]}),"\n",(0,l.jsxs)(n.li,{children:["lorsque les attributs sont modifi\xe9s via l'",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/Admin/dataExplorer",children:"Explorateur de donn\xe9es"}),"."]}),"\n"]})]}),"\n",(0,l.jsx)(n.h4,{id:"exemple-1",children:"Exemple 1"}),"\n",(0,l.jsx)(n.p,{children:"Vous souhaitez mettre en majuscules tous les attributs de texte d'une entit\xe9 lorsqu'elle est mise \xe0 jour."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:"    //ProductsEntity class\nFunction event touched($event : Object)\n	\n	If (Value type(This[$event.attributeName])=Is text)\n		This[$event.attributeName]:=Uppercase(This[$event.attributeName])\n	End if \n"})}),"\n",(0,l.jsx)(n.h4,{id:"exemple-2",children:"Exemple 2"}),"\n",(0,l.jsxs)(n.p,{children:["L'\xe9v\xe9nement \"touched\" est utile quand il n'est pas possible d'\xe9crire un code de requ\xeate index\xe9e dans ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,l.jsx)(n.code,{children:"Function query()"})})," pour un ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#computed-attributes",children:"attribut calcul\xe9"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["C'est le cas, par exemple, lorsque votre fonction ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,l.jsx)(n.code,{children:"query"})})," doit comparer la valeur de diff\xe9rents attributs de la m\xeame entit\xe9. Vous devez utiliser des formules dans la requ\xeate ORDA renvoy\xe9e, ce qui d\xe9clenche des requ\xeates s\xe9quentielles."]}),"\n",(0,l.jsx)(n.p,{children:"Pour bien comprendre ce cas, examinons les deux attributs calcul\xe9s suivants :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:"Function get onGoing() : Boolean\n        return ((This.departureDate<=Current date) & (This.arrivalDate>=Current date))\n\nFunction get sameDay() : Boolean\n        return (This.departureDate=This.arrivalDate)\n"})}),"\n",(0,l.jsx)(n.p,{children:"M\xeame si elles sont tr\xe8s similaires, ces fonctions ne peuvent pas \xeatre associ\xe9es \xe0 des requ\xeates identiques car elles ne comparent pas les m\xeames types de valeurs. Le premier compare les attributs \xe0 une valeur donn\xe9e, tandis que le second compare les attributs entre eux."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Pour l'attribut ",(0,l.jsx)(n.em,{children:"onGoing"}),", la fonction ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,l.jsx)(n.code,{children:"query"})})," est simple \xe0 \xe9crire et utilise des attributs index\xe9s :"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'Function query onGoing($event : Object) : Object\n    var $operator : Text\n    var $myQuery : Text\n    var $onGoingValue : Boolean\n    var $parameters : Collection\n    $parameters:=New collection()\n\n    $operator:=$event.operator\n    Case of \n            : (($operator="=") | ($operator="==") | ($operator="==="))\n                $onGoingValue:=Bool($event.value)\n            : (($operator="!=") | ($operator="!=="))\n                $onGoingValue:=Not(Bool($event.value))\n            Else \n                return {query: ""; parameters: $parameters}\n    End case \n\n    $myQuery:=($onGoingValue) ? "departureDate <= :1 AND arrivalDate >= :1" : "departureDate > :1 OR arrivalDate < :1"\n        // la cha\xeene de requ\xeate ORDA utilise des attributs index\xe9s, elle sera index\xe9e\n    $parameters.push(Current date)\n    return {query: $myQuery; parameters: $parameters}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Pour l'attribut ",(0,l.jsx)(n.em,{children:"sameDay"}),", la fonction ",(0,l.jsx)(n.a,{href:"/docs/fr/20-R10/ORDA/ordaClasses#function-query-attributename",children:(0,l.jsx)(n.code,{children:"query"})})," requiert une requ\xeate ORDA bas\xe9e sur des formules et sera s\xe9quentielle :"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'Function query sameDay($event : Object) : Text\n    var $operator : Text\n    var $sameDayValue : Boolean\n\n    $operator:=$event.operator\n    Case of \n        : (($operator="=") | ($operator="==") | ($operator="==="))\n            $sameDayValue:=Bool($event.value)\n        : (($operator="!=") | ($operator="!=="))\n            $sameDayValue:=Not(Bool($event.value))\n        Else \n            return ""\n        End case \n\n    return ($sameDayValue) ? "eval(This.departureDate = This.arrivalDate)" : "eval(This.departureDate != This.arrivalDate)"\n        // la requ\xeate ORDA utilise une formule, elle ne sera pas index\xe9e\n\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["L'utilisation d'un attribut ",(0,l.jsx)(n.strong,{children:"scalaire"})," ",(0,l.jsx)(n.em,{children:"sameDay"}),' mis \xe0 jour lorsque d\'autres attributs sont "touched" permet de gagner du temps :']}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:"    //BookingEntity class\n\nFunction event touched departureDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate) \n//\n//\nFunction event touched arrivalDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate)\n\n"})}),"\n",(0,l.jsxs)(n.h4,{id:"exemple-3-diagramme--clientserveur-avec-le-mot-cl\xe9-local-",children:["Exemple 3 (diagramme) : Client/serveur avec le mot-cl\xe9 ",(0,l.jsx)(n.code,{children:"local"})," :"]}),"\n",(0,l.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:=\"Brown\"\n   Note over Client: local Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\nNote over Client:$people.lastname is uppercased\n\n    Client->>+Server: $people.apply()\n   \n   Note over Server: L'entity $people est re\xe7ue avec l'attribut lastname en majuscules\n"}),"\n",(0,l.jsxs)(n.h4,{id:"exemple-4-diagramme--clientserveur-avec-le-mot-cl\xe9-local",children:["Exemple 4 (diagramme) : Client/serveur avec le mot-cl\xe9 ",(0,l.jsx)(n.code,{children:"local"})]}),"\n",(0,l.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:=\"Brown\"\n\n   Note over Client:$people.lastname n'est pas en majuscules\n\n    Client->>+Server: $people.apply()\n\n   Note over Server: Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\n    Server--\x3e>-Client: L'entit\xe9 $people est mise \xe0 jour\n\n   Note over Client:$people.lastname est en majuscules\n\n"}),"\n",(0,l.jsx)(n.h4,{id:"exemple-5-diagramme--application-qodly",children:"Exemple 5 (diagramme) : Application Qodly"}),"\n",(0,l.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\nQodly page->>+ Server: R\xe9cup\xe9rer une entit\xe9 dans la source Qodly People\n\nQodly page->>+Qodly page: L'utilisateur met \xe0 jour People.lastname\n\nNote over Qodly page: L'attribut lastname de la source Qodly People n'est pas en majuscules\n\nQodly page->>+ Server: Appel de fonction People.apply()\n\nNote over Server: Function event touched lastname($event : Object) <br> This.lastname:=Uppercase(This.lastname)\n\nServer--\x3e>-Qodly page: La source Qodly People est mise \xe0 jour\nNote over Qodly page: L'attribut lastname de la source Qodly People est en majuscules\n\n"})]})}function u(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},884429:function(e,n,t){t.d(n,{R:()=>i,x:()=>a});var s=t(296540);let l={},r=s.createContext(l);function i(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);