<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-19-R6 plugin-docs plugin-id-default docs-doc-id-API/CollectionClass">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Collection | 4D Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://4d.github.io//docs/fr/../assets/en/logohome.png"><meta data-rh="true" name="twitter:image" content="https://4d.github.io//docs/fr/../assets/en/logohome.png"><meta data-rh="true" property="og:url" content="https://4d.github.io//docs/fr/19-R6/API/CollectionClass"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="19-R6"><meta data-rh="true" name="docusaurus_tag" content="docs-default-19-R6"><meta data-rh="true" name="docsearch:version" content="19-R6"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-19-R6"><meta data-rh="true" property="og:title" content="Collection | 4D Docs"><meta data-rh="true" name="description" content="La classe Collection gère les variables de type Collection."><meta data-rh="true" property="og:description" content="La classe Collection gère les variables de type Collection."><link data-rh="true" rel="icon" href="/docs/fr/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://4d.github.io//docs/fr/19-R6/API/CollectionClass"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/19-R6/API/CollectionClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/fr/19-R6/API/CollectionClass" hreflang="fr"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/es/19-R6/API/CollectionClass" hreflang="es"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/ja/19-R6/API/CollectionClass" hreflang="ja"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/pt/19-R6/API/CollectionClass" hreflang="pt"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/19-R6/API/CollectionClass" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJ04C0M3CU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/fr/opensearch.xml"><link rel="stylesheet" href="/docs/fr/assets/css/styles.7bd82bcd.css">
<link rel="preload" href="/docs/fr/assets/js/runtime~main.47377a59.js" as="script">
<link rel="preload" href="/docs/fr/assets/js/main.6a2a1b9c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/fr/"><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/fr/19-R6/GettingStarted/installation">v19 R6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/fr/API/CollectionClass">v19 R7 BETA</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/fr/19-R6/API/CollectionClass">v19 R6</a></li><li><a class="dropdown__link" href="/docs/fr/19/API/CollectionClass">v19</a></li><li><a class="dropdown__link" href="/docs/fr/18/GettingStarted/installation">v18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Français</a><ul class="dropdown__menu"><li><a href="/docs/19-R6/API/CollectionClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/fr/19-R6/API/CollectionClass" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="fr">Français</a></li><li><a href="/docs/es/19-R6/API/CollectionClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs/ja/19-R6/API/CollectionClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/docs/pt/19-R6/API/CollectionClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/19-R6/GettingStarted/installation">Prise en main</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/fr/19-R6/Project/overview">Core Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/Project/overview">Project Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/Concepts/about">4D Language Concepts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://doc.4d.com/4Dv19R6/4D/19-R6/4D-Language-Reference.100-5910320.en.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">4D Language Reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/ORDA/overview">ORDA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/fr/19-R6/API/overview">Class API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/overview">Aperçu - API des classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/BlobClass">Blob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/ClassClass">Classe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/fr/19-R6/API/CollectionClass">Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/DataClassAttributeClass">DataClassAttribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/EntityClass">Entité (entity)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/FunctionClass">Formula</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/HTTPRequestClass">HTTPRequest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/POP3TransporterClass">POP3Transporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/SMTPTransporterClass">SMTPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/SystemWorkerClass">SystemWorker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/19-R6/API/ZipFolderClass">ZIPFolder</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/code-editor/overview">Handling Code</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/Debugging/basics">Debugging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/settings/overview">Settings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/19-R6/Preferences/overview">Preferences</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/19-R6/ServerWindow/overview">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/19-R6/Extensions/overview">Extensions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/19-R6/WebServer/overview">Web Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/fr/19-R6/Desktop/clientServer">Desktop Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://developer.4d.com/go-mobile/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Mobile Applications</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/fr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Class API Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Collection</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v19 R6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Collection</h1></header><p>La classe Collection gère les variables de type <a href="/docs/fr/19-R6/Concepts/collection">Collection</a>.</p><p>Une collection est initialisée avec :</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#new-collection"><strong>New collection</strong> {( <em>...value</em> : any )} : Collection</a> <!-- --> <!-- --> <!-- --> <!-- --> crée une nouvelle collection vide ou préremplie</td></tr><tr><td><a href="#new-shared-collection"><strong>New shared collection</strong> {( <em>...value</em> : any )} : Collection</a> <!-- --> <!-- --> <!-- --> <!-- --> crée une nouvelle collection partagée vide ou pré-remplie</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple">Exemple<a class="hash-link" href="#exemple" title="Direct link to heading">​</a></h3><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $colVar : Collection //création d&#x27;une variable 4D de type collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $colVar:=New collection ///initialisation de la collection et assignation à la variable 4D</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sommaire">Sommaire<a class="hash-link" href="#sommaire" title="Direct link to heading">​</a></h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#average"><strong>.average</strong>( {<em>propertyPath</em> : Text } ) : Real</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne la moyenne arithmétique des valeurs définies dans la collection</td></tr><tr><td><a href="#clear"><strong>.clear()</strong> : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->supprime tous les éléments de la collection et retourne une collection vide</td></tr><tr><td><a href="#combine"><strong>.combine</strong>( <em>col2</em> : Collection {; <em>index</em> : Integer } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->insère les éléments de <em>col2</em> à la fin ou à la position <em>index</em> de la collection et retourne la collection modifiée</td></tr><tr><td><a href="#concat"><strong>.concat</strong>( <em>value</em> : any { <em>;...valueN</em> } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une nouvelle collection avec le contenu du paramètre <em>value</em> ajouté à la fin de la collection d&#x27;origine</td></tr><tr><td><a href="#copy"><strong>.copy</strong>() : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ) : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ; <em>groupWithCol</em> : Collection ) : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ; <em>groupWithObj</em> : Object ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- --> retourne une copie profonde (deep copy) de la collection</td></tr><tr><td><a href="#count"><strong>.count</strong>( { <em>propertyPath</em> : Text } ) : Real</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne le nombre d&#x27;éléments non null dans la collection</td></tr><tr><td><a href="#countvalues"><strong>.countValues</strong>( <em>value</em> : any {; <em>propertyPath</em> : Text } ) : Real</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne le nombre d&#x27;occurrences de value dans la collection</td></tr><tr><td><a href="#distinct"><strong>.distinct</strong>( {<em>option</em> : Integer} ) : Collection<br><strong>.distinct</strong>( <em>propertyPath</em> : Text {; <em>option</em> : Integer } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->renvoie une collection contenant uniquement les valeurs distinctes (différentes) dans la collection d&#x27;origine</td></tr><tr><td><a href="#equal"><strong>.equal</strong>( <em>collection2</em> : Collection {; <em>option</em> : Integer } ) : Boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->compare la collection avec collection2</td></tr><tr><td><a href="#every"><strong>.every</strong>( { <em>startFrom</em> : Integer ; } <em>formula</em> : 4D.Function { ;<em>...param</em> : any } ) : Boolean<br><strong>.every</strong>( { <em>startFrom</em> : Integer ; } <em>methodName</em> : Text { ;<em>...param</em> : any } ) : Boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne <strong>true</strong> si tous les éléments de la collection ont été évalués à vrai par le test implémenté dans l&#x27;objet <em>formula</em> ou la méthode <em>methodName</em></td></tr><tr><td><a href="#extract"><strong>.extract</strong>( <em>propertyPath</em> : Text { ; <em>option</em> : Integer } ) : Collection<br><strong>.extract</strong>( <em>propertyPath</em> : Text ;  <em>targetPath</em> : Text  { ;...<em>propertyPathN</em> : Text ;... <em>targetPathN</em> : Text } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->crée et retourne une nouvelle collection contenant les valeurs de <em>propertyPath</em> extraites depuis la collection d&#x27;objets d&#x27;origine</td></tr><tr><td><a href="#fill"><strong>.fill</strong>( <em>value</em> : any ) : Collection<br><strong>.fill</strong>( <em>value</em> : any ;  <em>startFrom</em>  : Integer { ; <em>end</em> : Integer } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->remplit les éléments de la collection avec <em>value</em>, optionnellement depuis l&#x27;élément <em>startFrom</em> et jusqu&#x27;à l&#x27;élément <em>end</em> (non inclus), et retourne la collection résultante</td></tr><tr><td><a href="#filter"><strong>.filter</strong>( <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Collection<br><strong>.filter</strong>( <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine pour lesquels le résultat de <em>formula</em> ou <em>methodName</em> est <strong>true</strong></td></tr><tr><td><a href="#find"><strong>.find</strong>( { <em>startFrom</em> : Integer ; }  <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : any<br><strong>.find</strong>( { <em>startFrom</em> : Integer ; }  <em>methodName</em> : Text { ; <em>...param</em> : any } ) : any</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne la première valeur dans la collection pour laquelle le résultat de <em>formula</em> ou <em>methodName</em> retourne <strong>true</strong></td></tr><tr><td><a href="#find"><strong>.findIndex</strong>( { <em>startFrom</em> : Integer ; }  <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Integer<br><strong>.findIndex</strong>( { <em>startFrom</em> : Integer ; }  <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne le numéro, dans la collection, du premier élément pour lequel <em>formula</em> ou <em>methodName</em> retourne <strong>true</strong></td></tr><tr><td><a href="#indexof"><strong>.indexOf</strong>(  <em>toSearch</em> : expression { ; <em>startFrom</em> : Integer } ) : Integer </a> <!-- --> <!-- --> <!-- --> <!-- -->recherche l&#x27;expression <em>toSearch</em> parmi les éléments de la collection et retourne le numéro d&#x27;élément de la première occurrence trouvée, ou -1 si aucune occurrence n&#x27;a été trouvée</td></tr><tr><td><a href="#indices"><strong>.indices</strong>(  <em>queryString</em> : Text { ; <em>...value</em> : any } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne les positions, dans la collection d&#x27;origine, des éléments répondant au(x) critère(s) de recherche de <em>queryString</em></td></tr><tr><td><a href="#insert"><strong>.insert</strong>( <em>index</em> : Integer ; <em>element</em> : any ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- --> insère les éléments de <em>element</em> à la position <em>index</em> de la collection et retourne la collection modifiée</td></tr><tr><td><a href="#join"><strong>.join</strong>( <em>delimiter</em> : Text { ; <em>option</em> : Integer } ) : Text </a> <!-- --> <!-- --> <!-- --> <!-- -->convertit tous les éléments de la collection en textes et les concatène en utilisant comme séparateur la chaîne <em>delimiter</em> spécifiée</td></tr><tr><td><a href="#lastindexof"><strong>.lastIndexOf</strong>( <em>toSearch</em> : expression { ; <em>startFrom</em> : Integer } ) : Integer </a> <!-- --> <!-- --> <!-- --> <!-- -->recherche l&#x27;expression <em>toSearch</em> parmi les éléments de la collection et retourne le numéro d&#x27;élément de la dernière occurrence trouvée</td></tr><tr><td><a href="#length"><strong>.length</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne le nombre d&#x27;éléments dans la collection</td></tr><tr><td><a href="#map"><strong>.map</strong>( <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Collection<br><strong>.map</strong>( <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->crée une nouvelle collection basée sur le résultat de l&#x27;exécution de la fonction 4D <em>formula</em> ou de la méthode <em>methodName</em> sur chaque élément de la collection d&#x27;origine</td></tr><tr><td><a href="#max"><strong>.max</strong>( { <em>propertyPath</em> : Text } ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne l&#x27;élément de la collection ayant la valeur la plus élevée</td></tr><tr><td><a href="#min"><strong>.min</strong>( { <em>propertyPath</em> : Text } ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne l&#x27;élément de la collection ayant la valeur la plus petite</td></tr><tr><td><a href="#orderby"><strong>.orderBy</strong>( ) : Collection<br><strong>.orderBy</strong>( <em>pathStrings</em> : Text ) : Collection<br><strong>.orderBy</strong>( <em>pathObjects</em> : Collection ) : Collection<br><strong>.orderBy</strong>( <em>ascOrDesc</em> : Integer ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine triés selon les critères définis</td></tr><tr><td><a href="#orderbymethod"><strong>.orderByMethod</strong>( <em>formula</em> : 4D.Function { ; ...<em>extraParam</em> : expression } ) : Collection<br><strong>.orderByMethod</strong>( <em>methodName</em> : Text { ; ...<em>extraParam</em> : expression } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine triés selon les critères définis par la fonction 4D <em>formula</em> 4D function ou la méthode <em>methodName</em></td></tr><tr><td><a href="#pop"><strong>.pop()</strong> : any </a> <!-- --> <!-- --> <!-- --> <!-- -->supprime le dernier élément de la collection et le retourne comme résultat de fonction</td></tr><tr><td><a href="#push"><strong>.push</strong>( <em>element</em> : any { ;...<em>elementN</em> } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->ajoute un ou plusieurs <em>element</em>(s) à la fin de la collection et retourne la collection modifiée</td></tr><tr><td><a href="#query"><strong>.query</strong>( <em>queryString</em> : Text ; <em>...value</em> : any ) : Collection<br><strong>.query</strong>( <em>queryString</em> : Text ; <em>querySettings</em> : Object ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne tous les éléments d&#x27;une collection d&#x27;objets qui correspondent aux critères de recherche</td></tr><tr><td><a href="#reduce"><strong>.reduce</strong>( <em>formula</em> : 4D.Function { ; <em>initValue</em> : any { ; <em>...param</em> : expression }} ) : any<br><strong>.reduce</strong>( <em>methodName</em> : Text { ; <em>initValue</em> : any { ; <em>...param</em> : expression }} ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->applique la callback <em>formula</em> ou <em>methodName</em> à un accumulateur et à chaque élément de la collection (de gauche à droite) pour le réduire à une valeur unique</td></tr><tr><td><a href="#remove"><strong>.remove</strong>( <em>index</em> : Integer { ; <em>howMany</em> : Integer } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->supprime un ou plusieurs élément(s) dans la collection à partir de la position spécifiée par <em>index</em> et retourne la collection modifiée</td></tr><tr><td><a href="#resize"><strong>.resize</strong>( <em>size</em> : Integer { ; <em>defaultValue</em> : any } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->redimensionne la collection à la taille définie et retourne la collection redimensionnée</td></tr><tr><td><a href="#reverse"><strong>.reverse( )</strong> : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une copie profonde (deep copy) de la collection avec tous ses éléments en ordre inverse</td></tr><tr><td><a href="#shift"><strong>.shift()</strong> : any</a> <!-- --> <!-- --> <!-- --> <!-- -->supprime le premier élément de la collection et le retourne en résultat</td></tr><tr><td><a href="#slice"><strong>.slice</strong>( <em>startFrom</em> : Integer { ; <em>end</em> : Integer } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne une partie de la collection dans une nouvelle collection</td></tr><tr><td><a href="#some"><strong>.some</strong>( { <em>startFrom</em> : Integer ; } <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Boolean<br><strong>.some</strong>( { <em>startFrom</em> : Integer ; } <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne vrai si au moins un des éléments de la collection a été évalué à vrai par le test implémenté dans l&#x27;objet <em>formula</em> ou la méthode <em>methodName</em></td></tr><tr><td><a href="#sort"><strong>.sort</strong>( <em>formula</em> : 4D.Function { ; <em>...extraParam</em> : any } ) : Collection<br><strong>.sort</strong>( <em>methodName</em> : Text { ; <em>...extraParam</em> : any } ) : Collection </a> <!-- --> <!-- --> <!-- --> <!-- -->trie les éléments de la collection d&#x27;origine et retourne également une référence vers cette collection triée</td></tr><tr><td><a href="#sum"><strong>.sum</strong>( { <em>propertyPath</em> : Text } ) : Real</a> <!-- --> <!-- --> <!-- --> <!-- -->retourne la somme de toutes les valeurs numériques de la collection</td></tr><tr><td><a href="#unshift"><strong>.unshift</strong>( <em>value</em> : any { ;...<em>valueN</em> : any } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->insère la ou les <em>value</em>(s) au début de la collection</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-collection"><code>New collection</code><a class="hash-link" href="#new-collection" title="Direct link to heading">​</a></h2><p><strong>New collection</strong> {( <em>...value</em> : any )} : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Number, Text, Date, Time, Boolean, Object, Collection, Picture, Pointer</td><td align="center">-&gt;</td><td>Valeur(s) de collection</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>New collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a class="hash-link" href="#description" title="Direct link to heading">​</a></h4><p>La commande <code>New collection</code>  crée une nouvelle collection vide ou préremplie et retourne sa référence.</p><p>Si vous ne passez aucun paramètre, <code>New collection</code> crée une collection vide et retourne sa référence.</p><p>Vous devez affecter la référence retournée à une variable 4D de type Collection.</p><blockquote><p>Gardez à l&#x27;esprit que les instructions <code>var : Collection</code> ou <code>C_COLLECTION</code> déclarent une variable de type <code>Collection</code> mais ne créent aucune collection.</p></blockquote><p>En option, vous pouvez préremplir la nouvelle collection en utilisant une ou plusieurs valeur(s) (<em>value</em>(s)) en tant que paramètre(s).</p><p>Sinon, vous pouvez ajouter ou modifier des éléments ultérieurement par affectation. Par exemple :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> myCol[10]:=&quot;My new element&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Si le nouvel indice de l&#x27;élément est au-delà du dernier élément existant de la collection, la collection est automatiquement redimensionnée et tous les nouveaux éléments intermédiaires sont attribués une valeur <strong>null</strong>.</p><p>Vous pouvez passer n&#x27;importe quel nombre de valeurs de n&#x27;importe quel type pris en charge (number, text, date, picture, pointer, object, collection...). Contrairement aux tableaux, les collections peuvent mélanger des données de différents types.</p><p>Vous devez prêter attention aux problèmes de conversion suivants :</p><ul><li>Si vous passez un pointeur, il est conservé &quot;tel quel&quot;; il est évalué à l&#x27;aide de la commande <code>JSON Stringify</code></li><li>Les dates sont stockées sous la forme de date « aaaa-mm-jj » ou des chaînes au format « AAAA-MM-JJTHH: ss.SSSZ: mm » , selon la configuration actuelle « dates à l&#x27;intérieur des objets » de la base de données. Lors de la conversion de dates 4D en texte avant de les stocker dans la collection, par défaut le programme prend en compte le fuseau horaire local. Vous pouvez modifier ce comportement à l&#x27;aide du sélecteur <code>Dates inside objects</code> de la commande <code>SET DATABASE PARAMETER</code>.</li><li>Si vous passez une heure, elle est stockée sous la forme d&#x27;un nombre de millisecondes (Réel).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1">Exemple 1<a class="hash-link" href="#exemple-1" title="Direct link to heading">​</a></h4><p>Vous souhaitez créer une nouvelle collection vide et l&#x27;assigner à une variable collection 4D :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $myCol : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $myCol:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$myCol=[]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2">Exemple 2<a class="hash-link" href="#exemple-2" title="Direct link to heading">​</a></h4><p>Vous souhaitez créer une collection pré-remplie :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $filledColl : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $filledColl:=New collection(33;&quot;mike&quot;;&quot;november&quot;;-&gt;myPtr;Current date)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$filledColl=[33,&quot;mike&quot;,&quot;november&quot;,&quot;-&gt;myPtr&quot;,&quot;2017-03-28T22:00:00.000Z&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3">Exemple 3<a class="hash-link" href="#exemple-3" title="Direct link to heading">​</a></h4><p>Vous souhaitez créer une nouvelle collection puis ajouter un élément :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $coll : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $coll:=New collection(&quot;a&quot;;&quot;b&quot;;&quot;c&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$coll=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $coll[9]:=&quot;z&quot; //ajouter un 10e élément avec la valeur &quot;z&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vcolSize:=$coll.length //10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$coll=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,null,null,null,null,null,null,&quot;z&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-shared-collection"><code>New shared collection</code><a class="hash-link" href="#new-shared-collection" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>New shared collection</strong> {( <em>...value</em> : any )} : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Number, Text, Date, Time, Boolean, Shared object, Shared collection</td><td align="center">-&gt;</td><td>Valeur(s) de la collection partagée</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>New shared collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-1">Description<a class="hash-link" href="#description-1" title="Direct link to heading">​</a></h4><p>La commande <code>New shared collection</code>  crée une nouvelle collection partagée vide ou pré-remplie et retourne sa référence.</p><p>L&#x27;ajout et la modification d&#x27;éléments dans une collection partagée doivent être encadrés par une structure <a href="/docs/fr/19-R6/Concepts/shared#useend-use"><code>Use...End</code></a>, sinon une erreur est générée. La lecture d&#x27;un élement hors <a href="/docs/fr/19-R6/Concepts/shared#useend-use"><code>Use...End</code></a> est toutefois possible.</p><blockquote><p>Pour plus d&#x27;informations sur les collections partagées, reportez-vous à la page <a href="/docs/fr/19-R6/Concepts/shared">Objets et collections partagés</a>.</p></blockquote><p>Si vous ne passez aucun paramètre, <code>New shared collection</code> crée une collection vide et retourne sa référence.</p><p>Vous devez affecter la référence retournée à une variable 4D de type Collection.</p><blockquote><p>Gardez à l&#x27;esprit que les instructions <code>var : Collection</code> ou <code>C_COLLECTION</code> déclarent une variable de type <code>Collection</code> mais ne créent aucune collection.</p></blockquote><p>En option, vous pouvez préremplir la nouvelle collection en utilisant une ou plusieurs valeur(s) (<em>value</em>(s)) en tant que paramètre(s). Sinon, vous pouvez ajouter ou modifier des éléments ultérieurement via l&#x27;assignation en notation objet (cf. exemple).</p><p>Si le nouvel indice de l&#x27;élément est au-delà du dernier élément existant de la collection, la collection est automatiquement redimensionnée et tous les nouveaux éléments intermédiaires prennent la valeur <strong>null</strong>.</p><p>Vous pouvez passer tout nombre de valeurs de n&#x27;importe quel type pris en charge :</p><ul><li>nombre (réel, entier...). Les valeurs numériques sont toujours stockées sous forme de réels.</li><li>text</li><li>boolean</li><li>date</li><li>heure (stockée en nombre de milliseconds - réel)</li><li>Null</li><li>shared object(*)</li><li>shared collection(*)</li></ul><blockquote><p>Contrairement aux collections standard (non partagées), les collections partagées ne prennent pas en charge les images, les pointeurs et les objets ou collections non partagés.</p></blockquote><p>(<!-- -->*<!-- -->)Lorsqu&#x27;un objet partagé ou une collection partagée est ajouté(e) comme élément à une collection partagée, il/elle hérite de son <em>locking identifier</em>. Pour plus d&#x27;informations sur ce point, reportez-vous à <a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer">4D Doc Center</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-4">Exemple<a class="hash-link" href="#exemple-4" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $mySharedCol:=New shared collection(&quot;alpha&quot;;&quot;omega&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Use($mySharedCol)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $mySharedCol[1]:=&quot;beta&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End use</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="average">.average()<a class="hash-link" href="#average" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.average</strong>( {<em>propertyPath</em> : Text } ) : Real</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Real, Undefined</td><td align="center">&lt;-</td><td>Moyenne arithmétique des valeurs de la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-2">Description<a class="hash-link" href="#description-2" title="Direct link to heading">​</a></h4><p>La fonction <code>.average()</code> retourne la moyenne arithmétique des valeurs définies dans la collection.</p><p>Seuls les éléments ayant une valeur numérique sont pris en compte pour le calcul (les autres types d&#x27;éléments sont ignorés).</p><p>Si la collection contient des objets, passez le paramètre <em>propertyPath</em> si vous souhaitez désigner la propriété dont vous voulez connaître la moyenne.</p><p><code>.average()</code> retourne <code>undefined</code> si :</p><ul><li>la collection est vide,</li><li>la collection ne contient pas d&#x27;éléments numériques,</li><li><em>propertyPath</em> n&#x27;est pas trouvé dans la collection.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-1">Exemple 1<a class="hash-link" href="#exemple-1-1" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(10;20;&quot;Monday&quot;;True;6)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vAvg:=$col.average() //12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-1">Exemple 2<a class="hash-link" href="#exemple-2-1" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;salary&quot;;10000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;salary&quot;;50000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Gross&quot;;&quot;salary&quot;;10500))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vAvg:=$col.average(&quot;salary&quot;) //23500</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clear">.clear()<a class="hash-link" href="#clear" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.clear()</strong> : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine dont tous les éléments ont été supprimés</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-3">Description<a class="hash-link" href="#description-3" title="Direct link to heading">​</a></h4><p>La fonction <code>.clear()</code> supprime tous les éléments de la collection et retourne une collection vide.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-5">Exemple<a class="hash-link" href="#exemple-5" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col:=New collection(1;2;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col.clear()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$vSize:=$col.length //$vSize=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="combine">.combine()<a class="hash-link" href="#combine" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.combine</strong>( <em>col2</em> : Collection {; <em>index</em> : Integer } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>col2</td><td>Collection</td><td align="center">-&gt;</td><td>Collection à combiner</td></tr><tr><td>index</td><td>Integer</td><td align="center">-&gt;</td><td>Emplacement où insérer les éléments à combiner (défaut=length+1)</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine incluant les éléments combinés</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-4">Description<a class="hash-link" href="#description-4" title="Direct link to heading">​</a></h4><p>La fonction <code>.combine()</code> insère les éléments de <em>col2</em> à la fin ou à la position <em>index</em> de la collection et retourne la collection modifiée. A la différence de la fonction <code>.insert()</code>, <code>.combine()</code> ajoute chaque valeur de <em>col2</em> dans la collection d&#x27;origine, et non en tant qu&#x27;élément unique de collection.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Par défaut, les éléments de <em>col2</em> sont ajoutés à la fin de la collection d&#x27;origine. Vous pouvez passer dans <em>index</em> le numéro de l&#x27;élément après lequel vous souhaitez que les éléments de <em>col2</em> soient insérés dans la collection.</p><blockquote><p><strong>Attention :</strong> N&#x27;oubliez pas que la numérotation des éléments de collection débute à 0.</p></blockquote><ul><li>Si <em>index</em> &gt; la longueur de la collection, l&#x27;<em>index</em> de départ réel sera fixé à la longueur de la collection.</li><li>Si <em>index</em> &lt; 0, il est recalculé comme <em>index:=index+lenth</em> (il est considéré comme le décalage par rapport à la fin de la collection).</li><li>Si la valeur calculée est négative, <em>index</em> prend la valeur 0.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-6">Exemple<a class="hash-link" href="#exemple-6" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c; $fruits : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection(1;2;3;4;5;6)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$fruits:=New collection(&quot;Orange&quot;;&quot;Banana&quot;;&quot;Apple&quot;;&quot;Grape&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.combine($fruits;3) //[1,2,3,&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;,4,5,6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="concat">.concat()<a class="hash-link" href="#concat" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.concat</strong>( <em>value</em> : any { <em>;...valueN</em> } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Number, Text, Object, Collection, Date, Time, Boolean, Picture</td><td align="center">-&gt;</td><td>Valeur(s) à concaténer. Si <em>value</em> est une collection, tous les éléments de la collection sont ajoutés à la collection d&#x27;origine</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Nouvelle collection contenant les valeurs d&#x27;origine et les valeurs ajoutées</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-5">Description<a class="hash-link" href="#description-5" title="Direct link to heading">​</a></h4><p>La fonction <code>.concat()</code> retourne une nouvelle collection avec le contenu du paramètre <em>value</em> ajouté à la fin de la collection d&#x27;origine.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Si <em>value</em> est une collection, tous ses éléments sont ajoutés comme nouveaux éléments à la fin de la collection d&#x27;origine. Si <em>value</em> n&#x27;est pas une collection, son contenu est ajouté comme nouvel élément.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-7">Exemple<a class="hash-link" href="#exemple-7" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection(1;2;3;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$fruits:=New collection(&quot;Orange&quot;;&quot;Banana&quot;;&quot;Apple&quot;;&quot;Grape&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$fruits.push(New object(&quot;Intruder&quot;;&quot;Tomato&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.concat($fruits) //[1,2,3,4,5,&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;,{&quot;Intruder&quot;:&quot;Tomato&quot;}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.concat(6;7;8) //[1,2,3,4,5,6,7,8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="copy">.copy()<a class="hash-link" href="#copy" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R3</td><td>Nouvelle option <em>ck shared</em>. Nouveaux paramètres <em>groupWith</em></td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.copy</strong>() : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ) : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ; <em>groupWithCol</em> : Collection ) : Collection<br><strong>.copy</strong>( <em>option</em> : Integer ; <em>groupWithObj</em> : Object ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>option</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck resolve pointers</code>: résoudre les pointeurs avant la copie,<br><code>ck shared</code> : retourner une collection partagée</td></tr><tr><td>groupWithCol</td><td>Collection</td><td align="center">-&gt;</td><td>Collection partagée à grouper avec la collection résultante</td></tr><tr><td>groupWithObj</td><td>Object</td><td align="center">-&gt;</td><td>Objet partagé à grouper avec la collection résultante</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Copie de la collection d&#x27;origine (deep copy)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-6">Description<a class="hash-link" href="#description-6" title="Direct link to heading">​</a></h4><p>La fonction <code>.copy()</code>  retourne une copie profonde (deep copy) de la collection. <strong><em>Deep copy</em></strong> signifie que les objets ou les collections présents dans la collection d&#x27;origine sont dupliqués et ne partagent pas leur référence avec la collection qui est retournée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>S&#x27;il est passé, le paramètre <em>option</em> peut contenir l&#x27;une des constantes suivantes (ou les deux) :</p><table><thead><tr><th>option</th><th>Description</th></tr></thead><tbody><tr><td><code>ck resolve pointers</code></td><td>Si la collection d&#x27;origine contient des valeurs de type pointeur, par défaut la copie contient également les pointeurs. Toutefois, vous pouvez résoudre les pointeurs au moment de la copie, en passant ck resolve pointers. Dans ce cas, chaque pointeur contenu dans la collection est évalué lors de la copie et sa valeur déréférencée est utilisée.</td></tr><tr><td><code>ck shared</code></td><td>Par défaut, copy() retourne une collection standard (non partagée), même si la fonction s&#x27;applique à une collection partagée. Passez la constante ck shared pour créer une collection partagée. Dans ce cas, vous pouvez utiliser le paramètre groupWith pour associer la collection partagée avec un(e) autre collection/objet (voir ci-dessous).</td></tr></tbody></table><p>Les paramètres <em>groupWithCol</em> ou <em>groupWithObj</em> vous permettent de désigner une collection ou un objet auquel/à laquelle la collection résultante sera associée.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-2">Exemple 1<a class="hash-link" href="#exemple-1-2" title="Direct link to heading">​</a></h4><p>Nous souhaitons copier la collection standard (non partagée) <em>$lastnames</em> dans l&#x27;objet partagé <em>$sharedObject</em>. Pour ce faire, nous devons créer une copie partagée de la collection (<em>$sharedLastnames</em>).</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $sharedObject : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $lastnames;$sharedLastnames : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $text : Text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$sharedObject:=New shared object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$text:=Document to text(Get 4D folder(Current resources folder)+&quot;lastnames.txt&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$lastnames:=JSON Parse($text) //$lastnames est un collection standard</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$sharedLastnames:=$lastnames.copy(ck shared) //$sharedLastnames est une collection partagée</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//Nous pouvons désormais placer $sharedLastnames dans $sharedObject</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Use($sharedObject)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $sharedObject.lastnames:=$sharedLastnames</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End use</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-2">Exemple 2<a class="hash-link" href="#exemple-2-2" title="Direct link to heading">​</a></h4><p>Nous souhaitons combiner <em>$sharedColl1</em> et <em>$sharedColl2</em>. Etant donné qu&#x27;ils appartiennent à différents groupes partagés, une combinaison directe pourrait générer une erreur. Nous devons effectuer une copie partagée de <em>$sharedColl1</em> et désigner <em>$sharedColl2</em> comme étant un groupe partagé pour la copie.</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $sharedColl1;$sharedColl2;$copyColl : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$sharedColl1:=New shared collection(New shared object(&quot;lastname&quot;;&quot;Smith&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$sharedColl2:=New shared collection(New shared object(&quot;lastname&quot;;&quot;Brown&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//$copyColl appartient au nouveau groupe partagé comme $sharedColl2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $copyColl:=$sharedColl1.copy(ck shared;$sharedColl2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Use($sharedColl2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $sharedColl2.combine($copyColl)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End use</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-1">Exemple 3<a class="hash-link" href="#exemple-3-1" title="Direct link to heading">​</a></h4><p>Nous avons une collection standard (<em>$lastnames</em>) et nous souhaitons la placer dans le <strong>Storage</strong> de l&#x27;application. Pour ce faire, nous devons préalablement créer une copie partagée (<em>$sharedLastnames</em>).</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $lastnames;$sharedLastnames : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $text : Text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$text:=Document to text(Get 4D folder(Current resources folder)+&quot;lastnames.txt&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$lastnames:=JSON Parse($text) //$lastnames est une collection standard</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$sharedLastnames:=$lastnames.copy(ck shared) // copie partagée</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Use(Storage)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Storage.lastnames:=$sharedLastnames</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">End use</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-4-1">Exemple 4<a class="hash-link" href="#exemple-4-1" title="Direct link to heading">​</a></h4><p>Cet exemple illustre l&#x27;utilisation de l&#x27;option <code>ck resolve pointers</code> :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $p : Pointer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $p:=-&gt;$what</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;alpha&quot;;&quot;Hello&quot;;&quot;num&quot;;1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;beta&quot;;&quot;You&quot;;&quot;what&quot;;$p))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col2:=$col.copy()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col2[1].beta:=&quot;World!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT($col[0].alpha+&quot; &quot;+$col2[1].beta) //affiche &quot;Hello World!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $what:=&quot;You!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col3:=$col2.copy(ck resolve pointers)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ALERT($col3[0].alpha+&quot; &quot;+$col3[1].what) //affiche &quot;Hello You!&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="count">.count()<a class="hash-link" href="#count" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.count</strong>( { <em>propertyPath</em> : Text } ) : Real</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Real</td><td align="center">&lt;-</td><td>Nombre d&#x27;éléments dans la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-7">Description<a class="hash-link" href="#description-7" title="Direct link to heading">​</a></h4><p>La fonction <code>.count()</code> retourne le nombre d&#x27;éléments non null dans la collection.</p><p>Si la collection contient des objets, vous pouvez passer le paramètre <em>propertyPath</em>. Dans ce cas, seuls les éléments qui contiennent le <em>propertyPath</em> sont comptabilisés.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-8">Exemple<a class="hash-link" href="#exemple-8" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $count1;$count2 : Real</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(20;30;Null;40)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;salary&quot;;10000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;salary&quot;;50000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Gross&quot;;&quot;salary&quot;;10500))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;lastName&quot;;&quot;Henry&quot;;&quot;salary&quot;;12000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $count1:=$col.count() //$count1=7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $count2:=$col.count(&quot;name&quot;) //$count2=3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="countvalues">.countValues()<a class="hash-link" href="#countvalues" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.countValues</strong>( <em>value</em> : any {; <em>propertyPath</em> : Text } ) : Real</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Text, Number, Boolean, Date, Object, Collection</td><td align="center">-&gt;</td><td>Valeur à compter</td></tr><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Real</td><td align="center">&lt;-</td><td>Nombre d&#x27;occurrences de la valeur</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-8">Description<a class="hash-link" href="#description-8" title="Direct link to heading">​</a></h4><p>La fonction <code>.countValues()</code> retourne le nombre d&#x27;occurrences de value dans la collection.</p><p>Vous pouvez passer dans <em>value</em> :</p><ul><li>une valeur scalaire (texte, numérique, booléen, date),</li><li>une référence d&#x27;objet ou de collection.</li></ul><p>Pour qu&#x27;un élément soit comptabilisé, le type de <em>value</em> doit être égal à celui de l&#x27;élément ; la fonction utilise l&#x27;opérateur d&#x27;égalité.</p><p>Le paramètre optionnel <em>propertyPath</em> vous permet de compter des valeurs à l&#x27;intérieur d&#x27;une collection d&#x27;objets : passez dans <em>propertyPath</em> le chemin de la propriété dont vous souhaitez comptabiliser le nombre de valeurs.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-3">Exemple 1<a class="hash-link" href="#exemple-1-3" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $vCount : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(1;2;5;5;5;3;6;4)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vCount:=$col.countValues(5) // $vCount=3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-3">Exemple 2<a class="hash-link" href="#exemple-2-3" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $vCount : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;age&quot;;5))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;age&quot;;2))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Jones&quot;;&quot;age&quot;;3))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Henry&quot;;&quot;age&quot;;4))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Gross&quot;;&quot;age&quot;;5))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vCount:=$col.countValues(5;&quot;age&quot;) //$vCount=2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-2">Exemple 3<a class="hash-link" href="#exemple-3-2" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $numbers; $letters : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $vCount : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $letters:=New collection(&quot;a&quot;;&quot;b&quot;;&quot;c&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $numbers:=New collection(1;2;$letters;3;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vCount:=$numbers.countValues($letters) //$vCount=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distinct">.distinct()<a class="hash-link" href="#distinct" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.distinct</strong>( {<em>option</em> : Integer} ) : Collection<br><strong>.distinct</strong>( <em>propertyPath</em> : Text {; <em>option</em> : Integer } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>option</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck diacritical</code> : évaluation diacritique (&quot;A&quot; # &quot;a&quot; par exemple)</td></tr><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de l&#x27;attribut dont vous souhaitez obtenir les valeurs distinctes</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Nouvelle collection contenant uniquement les valeurs distinctes</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-9">Description<a class="hash-link" href="#description-9" title="Direct link to heading">​</a></h4><p>La fonction <code>.distinct()</code> renvoie une collection contenant uniquement les valeurs distinctes (différentes) dans la collection d&#x27;origine.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>La collection retournée est automatiquement triée. Les valeurs <strong>Null</strong> ne sont pas renvoyées.</p><p>Par défaut, une évaluation non diacritique est effectuée. Si vous souhaitez que l&#x27;évaluation soit sensible à la casse ou pour différencier des caractères accentués et non-accentués, passez la constante <code>ck diacritical</code> dans le paramètre <em>option</em>.</p><p>Si la collection contient des objets, vous pouvez passer le paramètre <em>propertyPath</em> afin d&#x27;indiquer la propriété d&#x27;objet dont vous souhaitez obtenir les valeurs distinctes.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-9">Exemple<a class="hash-link" href="#exemple-9" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;A&quot;;&quot;B&quot;;&quot;c&quot;;&quot;b&quot;;&quot;b&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;size&quot;;1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;size&quot;;3))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;size&quot;;1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.distinct() //$c2=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,{&quot;size&quot;:1},{&quot;size&quot;:3},{&quot;size&quot;:1}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.distinct(ck diacritical) //$c2=[&quot;a&quot;,&quot;A&quot;,&quot;b&quot;,&quot;B&quot;,&quot;c&quot;,{&quot;size&quot;:1},{&quot;size&quot;:3},{&quot;size&quot;:1}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.distinct(&quot;size&quot;) //$c2=[1,3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="equal">.equal()<a class="hash-link" href="#equal" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.equal</strong>( <em>collection2</em> : Collection {; <em>option</em> : Integer } ) : Boolean</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>collection2</td><td>Collection</td><td align="center">-&gt;</td><td>Collection à comparer</td></tr><tr><td>option</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck diacritical</code> : évaluation diacritique (&quot;A&quot; # &quot;a&quot; par exemple)</td></tr><tr><td>Résultat</td><td>Boolean</td><td align="center">&lt;-</td><td>Vrai si les collections sont identiques, sinon faux</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-10">Description<a class="hash-link" href="#description-10" title="Direct link to heading">​</a></h4><p>La fonction <code>.equal()</code> compare la collection avec collection2 et retourne <strong>true</strong> si elles sont identiques (deep comparison).</p><p>Par défaut, une évaluation non diacritique est effectuée. Si vous souhaitez que l&#x27;évaluation soit sensible à la casse ou pour différencier des caractères accentués et non-accentués, passez la constante <code>ck diacritical</code> dans le paramètre option.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-10">Exemple<a class="hash-link" href="#exemple-10" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $b : Boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;orange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;orange&quot;);2;3;4)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.equal($c2) // false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(New object(&quot;1&quot;;&quot;a&quot;;&quot;b&quot;;&quot;orange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;orange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.equal($c2) // false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;orange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;ORange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.equal($c2) // true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;orange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=New collection(New object(&quot;a&quot;;1;&quot;b&quot;;&quot;ORange&quot;);2;3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.equal($c2;ck diacritical) //false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="every">.every()<a class="hash-link" href="#every" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.every</strong>( { <em>startFrom</em> : Integer ; } <em>formula</em> : 4D.Function { ;<em>...param</em> : any } ) : Boolean<br><strong>.every</strong>( { <em>startFrom</em> : Integer ; } <em>methodName</em> : Text { ;<em>...param</em> : any } ) : Boolean</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter l&#x27;évaluation</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>Mixed</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à <em>formula</em> ou à <em>methodName</em></td></tr><tr><td>Résultat</td><td>Boolean</td><td align="center">&lt;-</td><td>Vrai si tous les éléments sont évalués à vrai</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-11">Description<a class="hash-link" href="#description-11" title="Direct link to heading">​</a></h4><p>La fonction <code>.every()</code> retourne <strong>true</strong> si tous les éléments de la collection ont été évalués à vrai par le test implémenté dans l&#x27;objet <em>formula</em> ou la méthode <em>methodName</em>.</p><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). La callback peut effectuer n&#x27;importe quel test, avec ou sans le(s) paramètre(s) et doit retourner <strong>true</strong> pour chaque élément remplissant le test. Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (booléen) : <strong>true</strong> si l&#x27;évaluation de la valeur de l&#x27;élément est à vrai, <strong>false</strong> sinon.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><p>Dans tous les cas, lorsque la fonction <code>.every()</code> rencontre le premier élément de collection évalué à <strong>false</strong>, elle cesse d&#x27;appeler la fonction de rétroappel et renvoie <strong>false</strong>.</p><p>Par défaut, <code>.every()</code> évalue l&#x27;ensemble de la collection. Optionnellement, vous pouvez passer dans <em>startFrom</em> le numéro de l&#x27;élément auquel démarrer l&#x27;évaluation.</p><ul><li>Si <em>startFrom</em> &gt;= la longueur de la collection, <strong>False</strong> est retourné, ce qui signifie que la collection n&#x27;est pas testée.</li><li>Si <em>startFrom</em> &lt; 0, la fin de la collection est considérée comme point de départ du calcul de la position( <em>startFrom:=startFrom+length</em>).</li><li>Si <em>startFrom</em> = 0, l&#x27;ensemble de la collection est évalué (défaut).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-4">Exemple 1<a class="hash-link" href="#exemple-1-4" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $b : Boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $f : 4D.Function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$f:=Formula($1.value&gt;0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(5;3;1;4;6;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$b:=$c.every($f) //retourne true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$b:=$c.every($f) //retourne false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-4">Exemple 2<a class="hash-link" href="#exemple-2-4" title="Direct link to heading">​</a></h4><p>Cet exemple vérifie que tous les éléments de la collection sont de type réel :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $b : Boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $f : 4D.Function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$f:=Formula(Value type($1.value)=$2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(5;3;1;4;6;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$b:=$c.every($f;Is real) //$b=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=$c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=$c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$b:=$c.every($f;Is real) //$b=false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extract">.extract()<a class="hash-link" href="#extract" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><p>|Version|Modifications|</p><p>|---|---| |v16 R6|Added|</p></div></div></details><p><strong>.extract</strong>( <em>propertyPath</em> : Text { ; <em>option</em> : Integer } ) : Collection<br><strong>.extract</strong>( <em>propertyPath</em> : Text ;  <em>targetPath</em> : Text  { ;...<em>propertyPathN</em> : Text ;... <em>targetPathN</em> : Text } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet dont les valeurs doivent être extraites dans la nouvelle collection</td></tr><tr><td>targetpath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin ou nom de propriété cible</td></tr><tr><td>option</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck keep null</code> : inclure les propriétés null dans la collection retournée (ignorées par défaut). Paramètre ignoré si <em>targetPath</em> est passé.</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Nouvelle collection contenant les valeurs extraites</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-12">Description<a class="hash-link" href="#description-12" title="Direct link to heading">​</a></h4><p>La fonction <code>.extract()</code> crée et retourne une nouvelle collection contenant les valeurs de <em>propertyPath</em> extraites depuis la collection d&#x27;objets d&#x27;origine.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Le contenu de la collection retournée dépend du paramètre <em>targetPath</em> :</p><ul><li><p>Si le paramètre <em>targetPath</em> est omis, <code>.extract()</code> remplit la nouvelle collection avec les valeurs de <em>propertyPath</em> de la collection d&#x27;origine.</p><p>Par défaut, les éléments pour lesquels <em>propertyPath</em> est null ou undefined sont ignorés dans la collection résultante. Vous pouvez passer la constante <code>ck keep null</code> dans le paramètre <em>option</em> pour intégrer ces valeurs comme des éléments null dans la collection retournée.</p></li><li><p>Si un ou plusieurs paramètre(s) <em>targetPath</em> sont passés, <code>.extract()</code> remplit la nouvelle collection avec les propriétés <em>propertyPath</em> et chaque élément de la nouvelle collection est un objet contenant les propriétés <em>targetPath</em> dont les valeurs sont celles des propriétés <em>propertyPath</em> correspondantes. Les valeurs null sont conservées (le paramètre <em>option</em> est ignoré avec cette syntaxe).</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-5">Exemple 1<a class="hash-link" href="#exemple-1-5" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;zip&quot;;5321))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(42)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.extract(&quot;name&quot;) // $c2=[Cleveland,Blountsville]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.extract(&quot;name&quot;;ck keep null) //$c2=[Cleveland,null,Blountsville,null]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-5">Exemple 2<a class="hash-link" href="#exemple-2-5" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;zc&quot;;35060))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;Null;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Adger&quot;;&quot;zc&quot;;35006))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35046))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35045))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.extract(&quot;name&quot;;&quot;City&quot;) //$c2=[{City:null},{City:Cleveland},{City:Blountsville},{City:Adger},{City:Clanton},{City:Clanton}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.extract(&quot;name&quot;;&quot;City&quot;;&quot;zc&quot;;&quot;Zip&quot;) //$c2=[{Zip:35060},{City:null,Zip:35049},{City:Cleveland,Zip:35049},{City:Blountsville,Zip:35031},{City:Adger,Zip:35006},{City:Clanton,Zip:35046},{City:Clanton,Zip:35045}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fill">.fill()<a class="hash-link" href="#fill" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.fill</strong>( <em>value</em> : any ) : Collection<br><strong>.fill</strong>( <em>value</em> : any ;  <em>startFrom</em>  : Integer { ; <em>end</em> : Integer } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Number, Text, Object, Collection, Date, Boolean</td><td align="center">-&gt;</td><td>Valeur de remplissage</td></tr><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de l&#x27;élément de départ (inclus)</td></tr><tr><td>end</td><td>Integer</td><td align="center">-&gt;</td><td>Position de fin (non incluse)</td></tr><tr><td>Résultat</td><td>collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine avec valeurs de remplissage</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-13">Description<a class="hash-link" href="#description-13" title="Direct link to heading">​</a></h4><p>La fonction <code>.fill()</code> remplit les éléments de la collection avec <em>value</em>, optionnellement depuis l&#x27;élément <em>startFrom</em> et jusqu&#x27;à l&#x27;élément <em>end</em> (non inclus), et retourne la collection résultante.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><ul><li>Si <em>startFrom</em> est omis, <em>value</em> est appliquée à tous les éléments de la collection (<em>startFrom</em>=0).</li><li>Si <em>startFrom</em> est passé et <em>end</em> est omis, <em>value</em> est appliquée à tous les éléments de la collection à partir de <em>startFrom</em> jusqu&#x27;au dernier élément (<em>end</em>=length).</li><li>Si les deux paramètres <em>startFrom</em> et <em>end</em> sont passés, <em>value</em> est appliquée aux éléments de la collection à partie de <em>startFrom</em> jusqu&#x27;à l&#x27;élément <em>end</em>.</li></ul><p>En cas d&#x27;incohérence, les règles suivantes sont appliquées :</p><ul><li>Si <em>startFrom</em> &lt; 0, le paramètre est recalculé comme <em>startFrom:=startFrom+length</em> (la fin de la collection est considérée comme point de départ du calcul de la position). Si la valeur recalculée est négative, <em>startFrom</em> prend la valeur 0.</li><li>Si <em>end</em> &lt; 0 , le paramètre est recalculé comme <em>end:=end+length</em>.</li><li>Si <em>end</em> &lt; <em>startFrom</em> (valeurs passées ou recalculées), la fonction ne fait rien.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-11">Exemple<a class="hash-link" href="#exemple-11" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;3;&quot;Lemon&quot;;Null;&quot;&quot;;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.fill(&quot;2&quot;) // $c:=[2,2,2,2,2,2,2,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.fill(&quot;Hello&quot;;5) // $c=[2,2,2,2,2,Hello,Hello,Hello]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.fill(0;1;5) // $c=[2,0,0,0,0,Hello,Hello,Hello]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.fill(&quot;world&quot;;1;-5) //-5+8=3 -&gt; $c=[2,&quot;world&quot;,&quot;world&quot;,0,0,Hello,Hello,Hello]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="filter">.filter()<a class="hash-link" href="#filter" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.filter</strong>( <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Collection<br><strong>.filter</strong>( <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à <em>formula</em> ou à <em>methodName</em></td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Nouvelle collection contenant les éléments filtrés (shallow copy)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-14">Description<a class="hash-link" href="#description-14" title="Direct link to heading">​</a></h4><p>La fonction <code>.filter()</code> retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine pour lesquels le résultat de <em>formula</em> ou <em>methodName</em> est <strong>true</strong>. Cette fonction retourne une <strong><em>shallow copy</em></strong> (copie superficielle), ce qui signifie que les objets ou les collections présents dans les deux collections partagent la même référence. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour filtrer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). La callback peut effectuer n&#x27;importe quel test, avec ou sans le(s) paramètre(s) et doit retourner <strong>true</strong> pour chaque élément remplissant la condition et donc, devant être ajouté à la nouvelle collection. Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (booléen) : <strong>true</strong> si l&#x27;élément doit être conservé car sa la valeur correspond à la condition du filtre, <strong>false</strong> sinon.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-6">Exemple 1<a class="hash-link" href="#exemple-1-6" title="Direct link to heading">​</a></h4><p>Vous voulez obtenir la collection des éléments de type texte dont la longueur est inférieure à 6 :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $col;$colNew : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col:=New collection(&quot;hello&quot;;&quot;world&quot;;&quot;red horse&quot;;66;&quot;tim&quot;;&quot;san jose&quot;;&quot;miami&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$colNew:=$col.filter(Formula((Value type($1.value)=Is text) &amp;&amp; (Length($1.value)&lt;$2)); 6)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$colNew=[&quot;hello&quot;,&quot;world&quot;,&quot;tim&quot;,&quot;miami&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-6">Exemple 2<a class="hash-link" href="#exemple-2-6" title="Direct link to heading">​</a></h4><p>Vous voulez filtrer les éléments de la collection en fonction de leur type :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c;$c2;$c3 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $f : 4D.Function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $f:=Formula(OB Get type($1;&quot;value&quot;)=$2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(5;3;1;4;6;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.filter($f;Is real) // $c2=[5,3,1,4,6,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c3:=$c.filter($f;Is object)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // $c3=[{name:Cleveland,zc:35049},{name:Blountsville,zc:35031}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="find">.find()<a class="hash-link" href="#find" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.find</strong>( { <em>startFrom</em> : Integer ; }  <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : any<br><strong>.find</strong>( { <em>startFrom</em> : Integer ; }  <em>methodName</em> : Text { ; <em>...param</em> : any } ) : any</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter la recherche</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à <em>formula</em> ou à <em>methodName</em></td></tr><tr><td>Résultat</td><td>any</td><td align="center">&lt;-</td><td>Première valeur trouvée (Undefined si non trouvée)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-15">Description<a class="hash-link" href="#description-15" title="Direct link to heading">​</a></h4><p>La fonction <code>find()</code> retourne la première valeur dans la collection pour laquelle le résultat de <em>formula</em> ou <em>methodName</em> retourne <strong>true</strong>.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). La callback peut effectuer n&#x27;importe quel test, avec ou sans le(s) paramètre(s) et doit retourner <strong>true</strong> pour le premier élément remplissant le test. Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (booléen) : <strong>true</strong> si la valeur de l&#x27;élément correspond à la condition de recherche, <strong>false</strong> sinon.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><p>Par défaut, <code>.find()</code> effectue une recherche dans la totalité de la collection. Optionnellement, vous pouvez passer dans <em>startFrom</em> le numéro de l&#x27;élément auquel démarrer la recherche.</p><ul><li>Si <em>startFrom</em> &gt;= la longueur de la collection, -1 est retourné, ce qui signifie que la recherche n&#x27;est pas effectuée.</li><li>Si <em>startFrom</em> &lt; 0, la fin de la collection est considérée comme point de départ du calcul de la position (<em>startFrom:=startFrom+length</em>). <strong>Note</strong> : Même si <em>startFrom</em> est négatif, la recherche est effectuée de la gauche vers la droite.</li><li>Si <em>startFrom</em> = 0, l&#x27;ensemble de la collection est évalué (défaut).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-7">Exemple 1<a class="hash-link" href="#exemple-1-7" title="Direct link to heading">​</a></h4><p>Vous souhaitez obtenir le premier élément de texte dont la taille est inférieure à 5 caractères :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col:=New collection(&quot;hello&quot;;&quot;world&quot;;4;&quot;red horse&quot;;&quot;tim&quot;;&quot;san jose&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$value:=$col.find(Formula((Value type($1.value)=Is text) &amp;&amp; (Length($1.value)&lt;$2)); 5) //$value=&quot;tim&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-7">Exemple 2<a class="hash-link" href="#exemple-2-7" title="Direct link to heading">​</a></h4><p>Vous souhaitez trouver un nom de ville dans une collection :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c2 : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;; &quot;Cleveland&quot;; &quot;zc&quot;; 35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;; &quot;Blountsville&quot;; &quot;zc&quot;; 35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;; &quot;Adger&quot;; &quot;zc&quot;; 35006))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;; &quot;Clanton&quot;; &quot;zc&quot;; 35046))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;; &quot;Clanton&quot;; &quot;zc&quot;; 35045))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.find(Formula($1.value.name=$2); &quot;Clanton&quot;)  //$c2={name:Clanton,zc:35046}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="findindex">.findIndex()<a class="hash-link" href="#findindex" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.findIndex</strong>( { <em>startFrom</em> : Integer ; }  <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Integer<br><strong>.findIndex</strong>( { <em>startFrom</em> : Integer ; }  <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Integer</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter la recherche</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à <em>formula</em> ou à <em>methodName</em></td></tr><tr><td>Résultat</td><td>Integer</td><td align="center">&lt;-</td><td>Numéro du premier élément trouvé (-1 si non trouvé)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-16">Description<a class="hash-link" href="#description-16" title="Direct link to heading">​</a></h4><p>La fonction <code>.findIndex()</code> retourne le numéro, dans la collection, du premier élément pour lequel <em>formula</em> ou <em>methodName</em> retourne <strong>true</strong>.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). La callback peut effectuer n&#x27;importe quel test, avec ou sans le(s) paramètre(s) et doit retourner <strong>true</strong> pour le premier élément remplissant le test. Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (booléen) : <strong>true</strong> si la valeur de l&#x27;élément correspond à la condition de recherche, <strong>false</strong> sinon.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><p>Par défaut, <code>.findIndex()</code> effectue une recherche dans la totalité de la collection. Optionnellement, vous pouvez passer dans <em>startFrom</em> le numéro de l&#x27;élément auquel démarrer la recherche.</p><ul><li>Si <em>startFrom</em> &gt;= la longueur de la collection, -1 est retourné, ce qui signifie que la recherche n&#x27;est pas effectuée.</li><li>Si <em>startFrom</em> &lt; 0, la fin de la collection est considérée comme point de départ du calcul de la position (<em>startFrom:=startFrom+length</em>). <strong>Note</strong> : Même si <em>startFrom</em> est négatif, la recherche est effectuée de la gauche vers la droite.</li><li>Si <em>startFrom</em> = 0, l&#x27;ensemble de la collection est évalué (défaut).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-12">Exemple<a class="hash-link" href="#exemple-12" title="Direct link to heading">​</a></h4><p>Vous souhaitez trouver la position du premier nom de ville dans la collection :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $val2;$val3 : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Adger&quot;;&quot;zc&quot;;35006))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35046))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35045))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$val2:=$c.findIndex(Formula($1.value.name=$2);&quot;Clanton&quot;) // $val2=3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$val3:=$c.findIndex($val2+1;Formula($1.value.name=$2);&quot;Clanton&quot;) //$val3=4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="indexof">.indexOf()<a class="hash-link" href="#indexof" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.indexOf</strong>(  <em>toSearch</em> : expression { ; <em>startFrom</em> : Integer } ) : Integer </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>toSearch</td><td>expression</td><td align="center">-&gt;</td><td>Expression à rechercher dans la collection</td></tr><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter la recherche</td></tr><tr><td>Résultat</td><td>Integer</td><td align="center">&lt;-</td><td>Numéro de la première occurrence de toSearch dans la collection, -1 si non trouvée</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-17">Description<a class="hash-link" href="#description-17" title="Direct link to heading">​</a></h4><p>La fonction <code>.indexOf()</code> recherche l&#x27;expression <em>toSearch</em> parmi les éléments de la collection et retourne le numéro d&#x27;élément de la première occurrence trouvée, ou -1 si aucune occurrence n&#x27;a été trouvée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Dans <em>toSearch</em>, passez l&#x27;expression à rechercher dans la collection. Vous pouvez passer :</p><ul><li>une valeur scalaire (texte, numérique, booléen, date),</li><li>la valeur null,</li><li>une référence d&#x27;objet ou de collection.</li></ul><p><em>toSearch</em> doit correspondre exactement à l&#x27;élément recherché (les mêmes règles que pour l&#x27;opérateur d&#x27;égalité sont appliquées).</p><p>Optionnellement, vous pouvez passer le numéro de l&#x27;élément auquel démarrer la recherche dans <em>startFrom</em>.</p><ul><li>Si <em>startFrom</em> &gt;= la longueur de la collection, -1 est retourné, ce qui signifie que la recherche n&#x27;est pas effectuée.</li><li>Si <em>startFrom</em> &lt; 0, la fin de la collection est considérée comme point de départ du calcul de la position (<em>startFrom:=startFrom+length</em>). <strong>Note</strong> : Même si <em>startFrom</em> est négatif, la recherche est effectuée de la gauche vers la droite.</li><li>Si <em>startFrom</em> = 0, l&#x27;ensemble de la collection est évalué (défaut).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-13">Exemple<a class="hash-link" href="#exemple-13" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $i : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(1;2;&quot;Henry&quot;;5;3;&quot;Albert&quot;;6;4;&quot;Alan&quot;;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $i:=$col.indexOf(3) //$i=4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $i:=$col.indexOf(5;5) //$i=9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $i:=$col.indexOf(&quot;al@&quot;) //$i=5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $i:=$col.indexOf(&quot;Hello&quot;) //$i=-1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="indices">.indices()<a class="hash-link" href="#indices" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.indices</strong>(  <em>queryString</em> : Text { ; <em>...value</em> : any } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>queryString</td><td>Text</td><td align="center">-&gt;</td><td>Critère(s) de recherche</td></tr><tr><td>value</td><td>any</td><td align="center">-&gt;</td><td>Valeur(s) à comparer lors de l&#x27;utilisation de paramètre(s) dans la chaîne</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Numéro(s) d&#x27;élément(s) de la collection répondant au(x) critère(s) de recherche</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-18">Description<a class="hash-link" href="#description-18" title="Direct link to heading">​</a></h4><p>La fonction <code>.indices()</code> fonctionne exactement comme <a href="#query"><code>.query()</code></a> mais retourne les positions, dans la collection d&#x27;origine, des éléments répondant au(x) critère(s) de recherche de <em>queryString</em>, and not elements themselves. Les positions sont retournées dans un ordre croissant.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Le paramètre <em>queryString</em> doit respecter la syntaxe suivante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">propertyPath comparator value {logicalOperator propertyPath comparator value}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour une description détaillée de la construction de recherches à l&#x27;aide des paramètres <em>queryString</em> et <em>value</em> veuillez vous reporter à la description de la fonction <code>dataclass.query()</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-14">Exemple<a class="hash-link" href="#exemple-14" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $icol : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Adger&quot;;&quot;zc&quot;;35006))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35046))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35045))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $icol:=$c.indices(&quot;name = :1&quot;;&quot;Cleveland&quot;) // $icol=[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $icol:=$c.indices(&quot;zc &gt; 35040&quot;) // $icol=[0,3,4]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="insert">.insert()<a class="hash-link" href="#insert" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.insert</strong>( <em>index</em> : Integer ; <em>element</em> : any ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>index</td><td>Integer</td><td align="center">-&gt;</td><td>Où insérer l&#x27;élément</td></tr><tr><td>element</td><td>any</td><td align="center">-&gt;</td><td>Elément à insérer dans la collection</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine incluant l&#x27;élément inséré</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-19">Description<a class="hash-link" href="#description-19" title="Direct link to heading">​</a></h4><p>La fonction <code>.insert()</code>  insère les éléments de <em>element</em> à la position <em>index</em> de la collection et retourne la collection modifiée.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Dans <em>index</em>, passez le numéro de l&#x27;élément après lequel vous souhaitez que le paramètre element soit inséré.</p><blockquote><p><strong>Attention :</strong> N&#x27;oubliez pas que la numérotation des éléments de collection débute à 0.</p></blockquote><ul><li>Si <em>index</em> &gt; la longueur de la collection, l&#x27;<em>index</em> de départ réel sera fixé à la longueur de la collection.</li><li>Si <em>index</em> &lt; 0, il est recalculé comme <em>index:=index+length</em> (la fin de la collection est considérée comme point de départ du calcul de la position).</li><li>Si la valeur recalculée est négative, index prend la valeur 0.</li></ul><p>Vous pouvez passer tout type d&#x27;élément accepté par les collections, y compris une autre collection.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-15">Exemple<a class="hash-link" href="#exemple-15" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;d&quot;) //$col=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.insert(2;&quot;X&quot;) //$col=[&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.insert(-2;&quot;Y&quot;) //$col=[&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;Y&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.insert(-10;&quot;Hi&quot;) //$col=[&quot;Hi&quot;,&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;Y&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="join">.join()<a class="hash-link" href="#join" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.join</strong>( <em>delimiter</em> : Text { ; <em>option</em> : Integer } ) : Text </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>delimiter</td><td>Text</td><td align="center">-&gt;</td><td>Séparateur à utiliser entre les éléments</td></tr><tr><td>option</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck ignore null or empty</code> : ignorer les chaînes null ou vides dans le résultat</td></tr><tr><td>Résultat</td><td>Text</td><td align="center">&lt;-</td><td>Chaîne contenant tous les éléments de la collection, séparés par delimiter</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-20">Description<a class="hash-link" href="#description-20" title="Direct link to heading">​</a></h4><p>La fonction <code>.join()</code> convertit tous les éléments de la collection en textes et les concatène en utilisant comme séparateur la chaîne <em>delimiter</em> spécifiée. La fonction retourne la chaîne résultante.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Par défaut, les éléments null ou vides de la collection sont inclus dans la chaîne résultante. Passez la constante <code>ck ignore null or empty</code> dans le paramètre <em>option</em> si vous souhaitez les exclure de la chaîne résultante.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-16">Exemple<a class="hash-link" href="#exemple-16" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $t1;$t2 : Text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;3;&quot;Paris&quot;;Null;&quot;&quot;;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $t1:=$c.join(&quot;|&quot;) //1|2|3|Paris|null||4|5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $t2:=$c.join(&quot;|&quot;;ck ignore null or empty) //1|2|3|Paris|4|5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lastindexof">.lastIndexOf()<a class="hash-link" href="#lastindexof" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.lastIndexOf</strong>( <em>toSearch</em> : expression { ; <em>startFrom</em> : Integer } ) : Integer </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>toSearch</td><td>expression</td><td align="center">-&gt;</td><td>Elément à chercher dans la collection</td></tr><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter la recherche</td></tr><tr><td>Résultat</td><td>Integer</td><td align="center">&lt;-</td><td>Numéro de la dernière occurrence de toSearch dans la collection, -1 si non trouvé</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-21">Description<a class="hash-link" href="#description-21" title="Direct link to heading">​</a></h4><p>La fonction <code>.lastIndexOf()</code> recherche l&#x27;expression <em>toSearch</em> parmi les éléments de la collection et retourne le numéro d&#x27;élément de la dernière occurrence trouvée, ou -1 si aucune occurrence n&#x27;a été trouvée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Dans <em>toSearch</em>, passez l&#x27;expression à rechercher dans la collection. Vous pouvez passer :</p><ul><li>une valeur scalaire (texte, numérique, booléen, date),</li><li>la valeur null,</li><li>une référence d&#x27;objet ou de collection.</li></ul><p>Optionnellement, vous pouvez passer le numéro de l&#x27;élément auquel démarrer la recherche inversée dans <em>startFrom</em>.</p><p>Optionnellement, vous pouvez passer le numéro de l&#x27;élément auquel démarrer la recherche inversée dans <em>startFrom</em>.</p><ul><li>Si <em>startFrom</em> &gt;= taille de la collection (coll.length-1), l&#x27;ensemble de la collection est évalué (défaut).</li><li>Si <em>startFrom</em> &lt; 0, le paramètre est recalculé comme <em>startFrom:=startFrom+length</em> (la fin de la collection est considérée comme point de départ du calcul de la position). Si la position calculée est négative, -1 est retourné (la collection n&#x27;est pas évaluée). <strong>Note</strong> : Même si <em>startFrom</em> est négatif, la recherche est effectuée de la droite vers la gauche.</li><li>Si <em>startFrom</em> = 0, -1 est retourné, ce qui signifie que la recherche n&#x27;est pas effectuée.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-17">Exemple<a class="hash-link" href="#exemple-17" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $pos1;$pos2;$pos3;$pos4;$pos5 : Integer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=Split string(&quot;a,b,c,d,e,f,g,h,i,j,e,k,e&quot;;&quot;,&quot;) //$col.length=13</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $pos1:=$col.lastIndexOf(&quot;e&quot;) //retourne 12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $pos2:=$col.lastIndexOf(&quot;e&quot;;6) //retourne 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $pos3:=$col.lastIndexOf(&quot;e&quot;;15) //retourne 12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $pos4:=$col.lastIndexOf(&quot;e&quot;;-2) //retourne 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $pos5:=$col.lastIndexOf(&quot;x&quot;) //retourne -1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="length">.length<a class="hash-link" href="#length" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R5</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.length</strong> : Integer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-22">Description<a class="hash-link" href="#description-22" title="Direct link to heading">​</a></h4><p>La propriété <code>.length</code> retourne le nombre d&#x27;éléments dans la collection.</p><p>La propriété <code>.length</code> est initialisée à la création de la collection. Elle est automatiquement mise à jour en cas d&#x27;ajout ou de suppression d&#x27;éléments. Cette propriété est en <strong>lecture seulement</strong> (vous ne pouvez pas l&#x27;utiliser pour modifier la taille de la collection).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-18">Exemple<a class="hash-link" href="#exemple-18" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection //$col.length est initialisée à 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(&quot;one&quot;;&quot;two&quot;;&quot;three&quot;) //$col.length est mise à jour et vaut 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col[4]:=&quot;five&quot; //$col.length vaut 5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vSize:=$col.remove(0;3).length //$vSize=2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="map">.map()<a class="hash-link" href="#map" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.map</strong>( <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Collection<br><strong>.map</strong>( <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à <em>formula</em> ou à <em>methodName</em></td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection de valeurs transformées</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-23">Description<a class="hash-link" href="#description-23" title="Direct link to heading">​</a></h4><p>La fonction <code>.map()</code> crée une nouvelle collection basée sur le résultat de l&#x27;exécution de la fonction 4D <em>formula</em> ou de la méthode <em>methodName</em> sur chaque élément de la collection d&#x27;origine. Optionnellement, vous pouvez passer un ou plusieurs paramètre(s) à <em>formula</em> ou <em>methodName</em> via le paramètre <em>param</em>. <code>.map()</code> retourne toujours une collection de taille égale à celle de la collection d&#x27;origine.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). The callback is called with the parameter(s) passed in <em>param</em> (optional). Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (n&#x27;importe quel type) : nouvelle valeur transformée à ajouter à la collection résultante</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-19">Exemple<a class="hash-link" href="#exemple-19" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection(1; 4; 9; 10; 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c2:=$c.map(Formula(Round(($1.value/$2)*100; 2)); $c.sum())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$c2=[2.27,9.09,20.45,22.73,45.45]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="max">.max()<a class="hash-link" href="#max" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.max</strong>( { <em>propertyPath</em> : Text } ) : any </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Boolean, Text, Number, Collection, Object, Date</td><td align="center">&lt;-</td><td>Valeur maximum de la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-24">Description<a class="hash-link" href="#description-24" title="Direct link to heading">​</a></h4><p>La fonction <code>.max()</code> retourne l&#x27;élément de la collection ayant la valeur la plus élevée (le dernier élément de la collection si était triée par ordre croissant à l&#x27;aide de la fonction <a href="#sort"><code>.sort()</code></a>).</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Si la collection contient différents types de valeurs, la fonction <code>.max()</code> retournera la plus grande valeur du dernier type d&#x27;élément dans l&#x27;ordre de la liste de types (cf. description de <a href="#sort"><code>.sort()</code></a>).</p><p>Si la collection contient des objets, passez le paramètre <em>propertyPath</em> pour indiquer la propriété d&#x27;objet dont vous souhaitez obtenir la valeur maximale.</p><p>Si la collection est vide, <code>.max()</code> retourne <em>Undefined</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-20">Exemple<a class="hash-link" href="#exemple-20" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(200;150;55)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;salary&quot;;10000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;salary&quot;;50000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Alabama&quot;;&quot;salary&quot;;10500))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $max:=$col.max() //{name:Alabama,salary:10500}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $maxSal:=$col.max(&quot;salary&quot;) //50000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $maxName:=$col.max(&quot;name&quot;) //&quot;Wesson&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="min">.min()<a class="hash-link" href="#min" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.min</strong>( { <em>propertyPath</em> : Text } ) : any </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Boolean, Text, Number, Collection, Object, Date</td><td align="center">&lt;-</td><td>Valeur minimum de la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-25">Description<a class="hash-link" href="#description-25" title="Direct link to heading">​</a></h4><p>La fonction <code>min()</code> retourne l&#x27;élément de la collection ayant la valeur la plus petite (le premier élément de la collection si était triée par ordre croissant à l&#x27;aide de la fonction <a href="#sort"><code>.sort()</code></a>).</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Si la collection contient différents types de valeurs, la fonction <code>.min()</code> retournera la plus petite valeur du premier type d&#x27;élément dans l&#x27;ordre de la liste de types (cf. description de <a href="#sort"><code>.sort()</code></a>).</p><p>Si la collection contient des objets, passez le paramètre <em>propertyPath</em> pour indiquer la propriété d&#x27;objet dont vous souhaitez obtenir la valeur minimum.</p><p>Si la collection est vide, <code>.min()</code> retourne <em>Undefined</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-21">Exemple<a class="hash-link" href="#exemple-21" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(200;150;55)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;salary&quot;;10000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;salary&quot;;50000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Alabama&quot;;&quot;salary&quot;;10500))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $min:=$col.min() //55</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $minSal:=$col.min(&quot;salary&quot;) //10000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $minName:=$col.min(&quot;name&quot;) //&quot;Alabama&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="orderby">.orderBy()<a class="hash-link" href="#orderby" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.orderBy</strong>( ) : Collection<br><strong>.orderBy</strong>( <em>pathStrings</em> : Text ) : Collection<br><strong>.orderBy</strong>( <em>pathObjects</em> : Collection ) : Collection<br><strong>.orderBy</strong>( <em>ascOrDesc</em> : Integer ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>pathStrings</td><td>Text</td><td align="center">-&gt;</td><td>Chemin(s) de propriété(s) à utiliser pour trier la collection</td></tr><tr><td>pathObjects</td><td>Collection</td><td align="center">-&gt;</td><td>Collection d&#x27;objets critère</td></tr><tr><td>ascOrDesc</td><td>Integer</td><td align="center">-&gt;</td><td><code>ck ascending</code> ou <code>ck descending</code> (valeurs scalaires)</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Copiée triée de la collection (shallow copy)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-26">Description<a class="hash-link" href="#description-26" title="Direct link to heading">​</a></h4><p>La fonction <code>.orderBy()</code> retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine triés selon les critères définis.</p><p>Cette fonction retourne une<em>shallow copy</em> (copie superficielle), ce qui signifie que les objets ou les collections présents dans les deux collections partagent la même référence. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Si vous ne passez aucun paramètre, la fonction trie les valeurs scalaires de la collection par ordre croissant (les autres types d&#x27;éléments tels que les objets ou les collections sont retournés sans être triés). Vous pouvez modifier ce tri automatique par défaut en passant la constante <code>ck ascending</code> ou <code>ck descending</code> dans le paramètre <em>ascOrDesc</em> (voir ci-dessous).</p><p>Vous pouvez également passer des critères afin de configurer le tri des éléments de la collection. Trois syntaxes sont prises en charge pour ce paramètre :</p><ul><li><p><em>pathStrings</em> : Texte (formule). <strong>Syntaxe</strong> : <code>propertyPath1 {desc ou asc}, propertyPath2 {desc ou asc},...</code> (défaut : asc). <em>pathStrings</em> contient une formule constituée de 1 à N chemin(s) de propriété(s) et (optionnellement) ordres de tri, séparés par des virgules. L&#x27;ordre dans lequel les propriétés sont passées détermine la priorité de tri des éléments de la collection. Par défaut, les propriétés sont triées pas ordre croissant. Vous pouvez définir l&#x27;ordre de tri de chaque propriété dans la formule de critère, séparée du chemin de propriété par un simple espace : passez &quot;asc&quot; pour trier par ordre croissant ou &quot;desc&quot; pour un ordre décroissant.</p></li><li><p><em>pathObjects</em> : Collection. Vous pouvez ajouter autant d&#x27;objets dans la collection <em>pathObjects</em> que nécessaire. Par défaut, les propriétés sont triées par ordre croissant (&quot;descending&quot; est faux). Chaque élément de la collection contient un objet structuré de la manière suivante :</p></li></ul><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;propertyPath&quot;: string,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;descending&quot;: boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><em>ascOrDesc</em> : Entier. Passez une des constantes suivantes du thème <strong>Objets et collections</strong> :</p><table><thead><tr><th>Constante</th><th>Type</th><th>Value</th><th>Commentaire</th></tr></thead><tbody><tr><td>ck ascending</td><td>Longint</td><td>0</td><td>Les éléments sont triés par ordre croissant (défaut)</td></tr><tr><td>ck descending</td><td>Longint</td><td>1</td><td>Les éléments sont triés par ordre décroissant</td></tr></tbody></table><p>Cette syntaxe trie uniquement les valeurs scalaires de la collection (les autres types d&#x27;éléments comme les objets ou les collections sont retournés non triés).</p></li></ul><p>Si la collection contient des éléments de différents types, ils sont d&#x27;abord groupés par type et triés par la suite. Les types sont renvoyés dans l&#x27;ordre suivant :</p><ol><li>Null</li><li>booléens</li><li>chaînes</li><li>nombres</li><li>objets</li><li>collections</li><li>dates</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-8">Exemple 1<a class="hash-link" href="#exemple-1-8" title="Direct link to heading">​</a></h4><p>Tri d&#x27;une collection d&#x27;objets basé sur une formule de texte avec noms de propriétés :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2; $3 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> For($vCounter;1;10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $c.push(Random)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End for</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy(ck ascending)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c3:=$c.orderBy(ck descending)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-8">Exemple 2<a class="hash-link" href="#exemple-2-8" title="Direct link to heading">​</a></h4><p>Tri d&#x27;une collection d&#x27;objets sur des propriétés :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> For($vCounter;1;10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $c.push(New object(&quot;id&quot;;$vCounter;&quot;value&quot;;Random))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End for</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy(&quot;value desc&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy(&quot;value desc, id&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy(&quot;value desc, id asc&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Tri d&#x27;une collection d&#x27;objets via une collection d&#x27;objets critères :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;phones&quot;;New object(&quot;p1&quot;;&quot;01&quot;;&quot;p2&quot;;&quot;02&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;phones&quot;;New object(&quot;p1&quot;;&quot;00&quot;;&quot;p2&quot;;&quot;03&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy(&quot;phones.p1 asc&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-3">Exemple 3<a class="hash-link" href="#exemple-3-3" title="Direct link to heading">​</a></h4><p>Tri avec un chemin de propriété :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $crit; $c; $c2 : COllection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $crit:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> For($vCounter;1;10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $c.push(New object(&quot;id&quot;;$vCounter;&quot;value&quot;;Random))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End for</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $crit.push(New object(&quot;propertyPath&quot;;&quot;value&quot;;&quot;descending&quot;;True))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $crit.push(New object(&quot;propertyPath&quot;;&quot;id&quot;;&quot;descending&quot;;False))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy($crit)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Tri avec un chemin de propriété :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $crit; $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;phones&quot;;New object(&quot;p1&quot;;&quot;01&quot;;&quot;p2&quot;;&quot;02&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;phones&quot;;New object(&quot;p1&quot;;&quot;00&quot;;&quot;p2&quot;;&quot;03&quot;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $crit:=New collection(New object(&quot;propertyPath&quot;;&quot;phones.p2&quot;;&quot;descending&quot;;True))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy($crit)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="orderbymethod">.orderByMethod()<a class="hash-link" href="#orderbymethod" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.orderByMethod</strong>( <em>formula</em> : 4D.Function { ; ...<em>extraParam</em> : expression } ) : Collection<br><strong>.orderByMethod</strong>( <em>methodName</em> : Text { ; ...<em>extraParam</em> : expression } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>extraParam</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Copie triée de la collection (shallow copy)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-27">Description<a class="hash-link" href="#description-27" title="Direct link to heading">​</a></h4><p>La fonction <code>.orderByMethod()</code> retourne une nouvelle collection contenant tous les éléments de la collection d&#x27;origine triés selon les critères définis par la fonction 4D <em>formula</em> 4D function ou la méthode <em>methodName</em>.</p><p>Cette fonction retourne une<em>shallow copy</em> (copie superficielle), ce qui signifie que les objets ou les collections présents dans les deux collections partagent la même référence. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>Dans la callback, passez votre code qui compare deux valeurs et retourne <strong>true</strong> si la première valeur est inférieure à la seconde valeur. Vous pouvez fournir des paramètres <em>extraParam</em> à la callback si nécessaire.</p><p>La callback reçoit les paramètres suivants :</p><ul><li>$1 (object), où :<ul><li><em>$1.value</em> (tout type) : valeur du premier élément à comparer</li><li><em>$1.value2</em> (tout type) : valeur du second élément à comparer</li><li>$2...$N (tout type) : paramètres supplémentaires (extraParam)</li></ul></li></ul><p>Si vous avez utilisé une méthode, elle doit définir le paramètre suivant :</p><ul><li><em>$1.result</em> (booléen): <strong>true</strong> si <em>$1.value &lt; $1.value2</em>, <strong>false</strong> sinon</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-9">Exemple 1<a class="hash-link" href="#exemple-1-9" title="Direct link to heading">​</a></h4><p>Voici le code de la méthode <strong><em>NumAscending</em></strong> :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2; $c3 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(&quot;33&quot;;&quot;4&quot;;&quot;1111&quot;;&quot;222&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.orderBy() //$c2=[&quot;1111&quot;,&quot;222&quot;,&quot;33&quot;,&quot;4&quot;], ordre alphabétique</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c3:=$c.orderByMethod(Formula(Num($1.value)&lt;Num($1.value2))) // $c3=[&quot;4&quot;,&quot;33&quot;,&quot;222&quot;,&quot;1111&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-9">Exemple 2<a class="hash-link" href="#exemple-2-9" title="Direct link to heading">​</a></h4><p>Voici le code de la méthode <strong><em>WordLength</em></strong> :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $fruits; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $fruits:=New collection(&quot;Orange&quot;;&quot;Apple&quot;;&quot;Grape&quot;;&quot;pear&quot;;&quot;Banana&quot;;&quot;fig&quot;;&quot;Blackberry&quot;;&quot;Passion fruit&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$fruits.orderByMethod(Formula(Length(String($1.value))&gt;Length(String($1.value2))))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$c2=[Passion fruit,Blackberry,Orange,Banana,Apple,Grape,pear,fig]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-4">Exemple 3<a class="hash-link" href="#exemple-3-4" title="Direct link to heading">​</a></h4><p>Vous souhaitez trier une collection par code de caractère ou par langage :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $strings1; $strings2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$strings1:=New collection(&quot;Alpha&quot;;&quot;Charlie&quot;;&quot;alpha&quot;;&quot;bravo&quot;;&quot;Bravo&quot;;&quot;charlie&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//using the character code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$strings2:=$strings1.orderByMethod(Function(sortCollection);sk character codes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// result : [&quot;Alpha&quot;,&quot;Bravo&quot;,&quot;Charlie&quot;,&quot;alpha&quot;,&quot;bravo&quot;,&quot;charlie&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//using the language:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$strings2:=$string1s.orderByMethod(Function(sortCollection);sk strict)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// result : [&quot;alpha&quot;,&quot;Alpha&quot;,&quot;bravo&quot;,&quot;Bravo&quot;,&quot;charlie&quot;,&quot;Charlie&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Paramètre(s) à passer à <em>methodName</em></p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $1 : Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $2: Integer // option de tri</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$1.result:=(Compare strings($1.value;$1.value2;$2)&lt;0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pop">.pop()<a class="hash-link" href="#pop" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.pop()</strong> : any </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>any</td><td align="center">&lt;-</td><td>Dernier élément de collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-28">Description<a class="hash-link" href="#description-28" title="Direct link to heading">​</a></h4><p>La fonction <code>.pop()</code> supprime le dernier élément de la collection et le retourne comme résultat de fonction.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Lorsqu&#x27;elle est appliquée à une collection vide, .<code>pop()</code> retourne <strong><em>undefined</em></strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-22">Exemple<a class="hash-link" href="#exemple-22" title="Direct link to heading">​</a></h4><p><code>.pop()</code>, combinée à <a href="#push"><code>push()</code></a>, peut être utilisée pour implémenter une fonctionnalité first-in last-out de traitement de données empilées :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $stack : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack:=New collection //$stack=[]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack.push(1;2) //$stack=[1,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack.pop() //$stack=[1]  retourne 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack.push(New collection(4;5)) //$stack=[[1,[4,5]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack.pop() //$stack=[1]  retourne [4,5]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $stack.pop() //$stack=[]  retourne 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="push">.push()<a class="hash-link" href="#push" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.push</strong>( <em>element</em> : any { ;...<em>elementN</em> } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>element</td><td>Mixed</td><td align="center">-&gt;</td><td>Élément(s) à ajouter à la collection</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection originale contenant des éléments ajoutés</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-29">Description<a class="hash-link" href="#description-29" title="Direct link to heading">​</a></h4><p>La fonction <code>.push()</code> ajoute un ou plusieurs <em>element</em>(s) à la fin de la collection et retourne la collection modifiée.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-10">Exemple 1<a class="hash-link" href="#exemple-1-10" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(1;2) //$col=[1,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(3) //$col=[1,2,3]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(6;New object(&quot;firstname&quot;;&quot;John&quot;;&quot;lastname&quot;;&quot;Smith&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[1,2,3,6,{firstname:John,lastname:Smith}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-10">Exemple 2<a class="hash-link" href="#exemple-2-10" title="Direct link to heading">​</a></h4><p>Vous souhaitez trier une collection de chaînes contenant des nombres par valeur plutôt que par ordre alphabétique :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col; $sortedCol : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(5;3;9) //$col=[5,3,9]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $sortedCol:=$col.push(7;50).sort()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[5,3,9,7,50]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$sortedCol=[3,5,7,9,50]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="query">.query()<a class="hash-link" href="#query" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Prise en charge de querySettings</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.query</strong>( <em>queryString</em> : Text ; <em>...value</em> : any ) : Collection<br><strong>.query</strong>( <em>queryString</em> : Text ; <em>querySettings</em> : Object ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>queryString</td><td>Text</td><td align="center">-&gt;</td><td>Critère(s) de recherche</td></tr><tr><td>value</td><td>Mixed</td><td align="center">-&gt;</td><td>Valeur(s) à comparer lors de l&#x27;utilisation de paramètre(s) dans la chaîne</td></tr><tr><td>querySettings</td><td>Object</td><td align="center">-&gt;</td><td>Options de requête : paramètres, attributs</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Élément(s) correspondant à queryString dans la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-30">Description<a class="hash-link" href="#description-30" title="Direct link to heading">​</a></h4><p>La fonction <code>.query()</code> retourne tous les éléments d&#x27;une collection d&#x27;objets qui correspondent aux critères de recherche définis par <em>queryString</em> et (optionnellement) <em>value</em> ou <em>querySettings</em>. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Le paramètre <em>queryString</em> doit respecter la syntaxe suivante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">propertyPath comparator value {logicalOperator propertyPath comparator value}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pour plus d&#x27;informations sur la génération d&#x27;une requête à l&#x27;aide des paramètres <em>queryString</em>, <em>value</em> et <em>querySettings</em>, reportez-vous à la description de la fonction de dataclass <a href="/docs/fr/19-R6/API/DataClassClass#query"><code>.query()</code></a>.</p><blockquote><p>Les formules ne sont pas prises en charge par la fonction <code>collection.query()</code> que ce soit via le paramètre <em>queryString</em> ou comme paramètre objet <em>formula</em>.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-11">Exemple 1<a class="hash-link" href="#exemple-1-11" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2; $c3 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Cleveland&quot;;&quot;zc&quot;;35049))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Blountsville&quot;;&quot;zc&quot;;35031))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Adger&quot;;&quot;zc&quot;;35006))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35046))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Clanton&quot;;&quot;zc&quot;;35045))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.query(&quot;name = :1&quot;;&quot;Cleveland&quot;) //$c2=[{name:Cleveland,zc:35049}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c3:=$c.query(&quot;zc &gt; 35040&quot;) //$c3=[{name:Cleveland,zc:35049},{name:Clanton,zc:35046},{name:Clanton,zc:35045}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-11">Exemple 2<a class="hash-link" href="#exemple-2-11" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;dateHired&quot;;!22-05-2002!;&quot;age&quot;;45))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;dateHired&quot;;!30-11-2017!))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Winch&quot;;&quot;dateHired&quot;;!16-05-2018!;&quot;age&quot;;36))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Sterling&quot;;&quot;dateHired&quot;;!10-5-1999!;&quot;age&quot;;Null))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Mark&quot;;&quot;dateHired&quot;;!01-01-2002!))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Winch&quot;;&quot;dateHired&quot;;!16-05-2018!;&quot;age&quot;;36))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Sterling&quot;;&quot;dateHired&quot;;!10-5-1999!;&quot;age&quot;;Null))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New object(&quot;name&quot;;&quot;Mark&quot;;&quot;dateHired&quot;;!01-01-2002!))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cet exemple retourne des personnes dont le nom ne commence pas par une chaîne d&#x27;une variable (saisie par l&#x27;utilisateur, par exemple) :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=$c.query(&quot;name = :1&quot;;&quot;@in@&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[{name:Winch...},{name:Sterling...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cet exemple retourne des personnes dont l&#x27;âge n&#x27;est pas connu (propriété définie sur null ou indéfinie) :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=$c.query(&quot;name # :1&quot;;$aString+&quot;@&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //if $astring=&quot;W&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[{name:Smith...},{name:Sterling...},{name:Mark...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cet exemple retourne des personnes embauchées il y a plus de 90 jours :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=$c.query(&quot;age=null&quot;) //placeholders not allowed with &quot;null&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[{name:Wesson...},{name:Sterling...},{name:Mark...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Vous trouverez plus d&#x27;exemples de requêtes dans la page <code>dataClass.query()</code>.</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=$c.query(&quot;dateHired &lt; :1&quot;;(Current date-90))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  //$col=[{name:Smith...},{name:Sterling...},{name:Mark...}] if today is 01/10/2018 si la date du jour est 01/10/2018</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-5">Exemple 3<a class="hash-link" href="#exemple-3-5" title="Direct link to heading">​</a></h4><p>Vous trouverez plus d&#x27;exemples de requêtes dans la page <code>dataClass.query()</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reduce">.reduce()<a class="hash-link" href="#reduce" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.reduce</strong>( <em>formula</em> : 4D.Function { ; <em>initValue</em> : any { ; <em>...param</em> : expression }} ) : any<br><strong>.reduce</strong>( <em>methodName</em> : Text { ; <em>initValue</em> : any { ; <em>...param</em> : expression }} ) : any </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>initValue</td><td>Text, Number, Object, Collection, Date, Boolean</td><td align="center">-&gt;</td><td>Valeur à utiliser comme premier argument du premier appel de <em>formula</em> ou <em>methodName</em></td></tr><tr><td>param</td><td>expression</td><td align="center">-&gt;</td><td>Paramètre(s) à passer</td></tr><tr><td>Résultat</td><td>Text, Number, Object, Collection, Date, Boolean</td><td align="center">&lt;-</td><td>Résultat de la valeur de l&#x27;accumulateur</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-31">Description<a class="hash-link" href="#description-31" title="Direct link to heading">​</a></h4><p>La fonction <code>.reduce()</code> applique la callback <em>formula</em> ou <em>methodName</em> à un accumulateur et à chaque élément de la collection (de gauche à droite) pour le réduire à une valeur unique.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>Vous désignez le code de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback prend chaque élément de la collection et effectue toutes les opérations souhaitées pour accumuler le résultat dans <em>$1.accumulator</em>, qui est retourné dans <em>$1.value</em>.</p><p>Vous pouvez passer la valeur pour initialiser l&#x27;accumulateur dans <em>initValue</em>. S&#x27;il est omis, <em>$1.accumulator</em> commence par <em>Undefined</em>.</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>dans $2 : <em>param</em></li><li>dans <em>$N...</em> : <em>paramN...</em></li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li><em>$1.accumulator</em>: valeur à modifier par la fonction et qui est initialisée par <em>initValue</em>.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-12">Exemple 1<a class="hash-link" href="#exemple-1-12" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$c:=New collection(5;3;5;1;3;4;4;6;2;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$r:=$c.reduce(Formula($1.accumulator:=$1.accumulator*$1.value); 1)  //renvoie 86400</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-12">Exemple 2<a class="hash-link" href="#exemple-2-12" title="Direct link to heading">​</a></h4><p>Avec la méthode <strong><em>Flatten</em></strong> suivante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c;$r : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New collection(0;1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New collection(2;3))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New collection(4;5))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(New collection(6;7))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $r:=$c.reduce(Formula(Flatten)) //$r=[0,1,2,3,4,5,6,7]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Avec la méthode <em>NumberGreaterThan0</em> suivante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> If($1.accumulator=Null)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $1.accumulator:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $1.accumulator.combine($1.value)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="remove">.remove()<a class="hash-link" href="#remove" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.remove</strong>( <em>index</em> : Integer { ; <em>howMany</em> : Integer } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>index</td><td>Integer</td><td align="center">-&gt;</td><td>Élément à partir duquel la suppression peut commencer</td></tr><tr><td>howMany</td><td>Integer</td><td align="center">-&gt;</td><td>Nombre d&#x27;éléments à supprimer, ou 1 élément si omis</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine sans élément(s) supprimé(s)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-32">Description<a class="hash-link" href="#description-32" title="Direct link to heading">​</a></h4><p>La fonction <code>.remove()</code> supprime un ou plusieurs élément(s) dans la collection à partir de la position spécifiée par <em>index</em> et retourne la collection modifiée.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Dans <em>index</em>, passez le numéro de l&#x27;élément à partir duquel la suppression doit débuter dans la collection.</p><blockquote><p><strong>Attention :</strong> N&#x27;oubliez pas que la numérotation des éléments de collection débute à 0. Si <em>index</em> est supérieur à la taille de la collection, l&#x27;<em>index</em> de départ réel sera fixé à la longueur (length) de la collection.</p></blockquote><ul><li>Si <em>index</em> &lt; 0, il est recalculé comme <em>index:=index+lenth</em> (il est considéré comme le décalage par rapport à la fin de la collection).</li><li>Si la valeur recalculée est négative, <em>index</em> prend la valeur 0.</li><li>Si valeur recalculée &gt; longueur de la collection, <em>index</em> prend comme valeur la taille de la collection.</li></ul><p>Dans <em>howMany</em>, passez le nombre d&#x27;éléments à supprimer à partir de l&#x27;<em>index</em>. Si <em>howMany</em> n&#x27;est pas spécifié, un élément est supprimé.</p><p>Si vous essayez de supprimer un élément d&#x27;une collection vide, la méthode ne fait rien (aucune erreur n&#x27;est générée).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-23">Exemple<a class="hash-link" href="#exemple-23" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;d&quot;;&quot;e&quot;;&quot;f&quot;;&quot;g&quot;;&quot;h&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.remove(3) // $col=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.remove(3;2) // $col=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.remove(-8;1) // $col=[&quot;b&quot;,&quot;c&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.remove(-3;1) // $col=[&quot;b&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resize">.resize()<a class="hash-link" href="#resize" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.resize</strong>( <em>size</em> : Integer { ; <em>defaultValue</em> : any } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>Integer</td><td align="center">-&gt;</td><td>Nouvelle taille de la collection</td></tr><tr><td>defaultValue</td><td>Number, Text, Object, Collection, Date, Boolean</td><td align="center">-&gt;</td><td>Valeur par défaut pour remplir de nouveaux éléments</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine redimensionnée</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-33">Description<a class="hash-link" href="#description-33" title="Direct link to heading">​</a></h4><p>La fonction <code>.resize()</code> redimensionne la collection à la taille définie et retourne la collection redimensionnée.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><ul><li>Si <em>size</em> est inférieure à la longueur de la collection, les éléments excédentaires sont retirés de la collection.</li><li>Si <em>size</em> &gt; longueur de la collection, <em>size</em> est la nouvelle longueur de la collection.</li></ul><p>Par défaut, les nouveaux éléments sont remplis par des valeurs <strong>null</strong>. Vous pouvez indiquer la valeur à remplir dans les éléments ajoutés à l&#x27;aide du paramètre <em>defaultValue</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-24">Exemple<a class="hash-link" href="#exemple-24" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.resize(10) // $c=[null,null,null,null,null,null,null,null,null,null]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.resize(10;0) // $c=[0,0,0,0,0,0,0,0,0,0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;3;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.resize(10;New object(&quot;name&quot;;&quot;X&quot;)) //$c=[1,2,3,4,5,{name:X},{name:X},{name:X},{name:X},{name:X}]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;3;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.resize(2) //$c=[1,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reverse">.reverse()<a class="hash-link" href="#reverse" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.reverse( )</strong> : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Copie inversée de la collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-34">Description<a class="hash-link" href="#description-34" title="Direct link to heading">​</a></h4><p>La fonction <code>.reverse()</code> retourne une copie profonde (deep copy) de la collection avec tous ses éléments en ordre inverse. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-25">Exemple<a class="hash-link" href="#exemple-25" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $c2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;3;5;2;4;6)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c2:=$c.reverse() //$c2=[6,4,2,5,3,1]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="shift">.shift()<a class="hash-link" href="#shift" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.shift()</strong> : any</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>any</td><td align="center">&lt;-</td><td>Premier élément de collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-35">Description<a class="hash-link" href="#description-35" title="Direct link to heading">​</a></h4><p>La fonction <code>shift()</code> supprime le premier élément de la collection et le retourne en résultat.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Si la collection est vide, cette méthode ne fait rien.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-26">Exemple<a class="hash-link" href="#exemple-26" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $val : Variant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;4;5;6;7;8)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $val:=$c.shift()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // $val=1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // $c=[2,4,5,6,7,8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="slice">.slice()<a class="hash-link" href="#slice" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.slice</strong>( <em>startFrom</em> : Integer { ; <em>end</em> : Integer } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de l&#x27;élément de départ (inclus)</td></tr><tr><td>end</td><td>Integer</td><td align="center">-&gt;</td><td>Position de fin (non incluse)</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Nouvelle collection contenant des éléments scindés (copie superficielle)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-36">Description<a class="hash-link" href="#description-36" title="Direct link to heading">​</a></h4><p>La fonction <code>slice()</code> retourne une partie de la collection dans une nouvelle collection, selected from <em>startFrom</em> index to <em>end</em> index (end not included). Cette fonction retourne une <em>copie superficielle</em> de la collection. Si la collection d&#x27;origine est une collection partagée, la collection retournée est également une collection partagée.</p><blockquote><p>Cette fonction ne modifie pas la collection d&#x27;origine.</p></blockquote><p>La collection retournée contient l&#x27;élément spécifié par <em>startFrom</em> et tous les éléments suivants jusqu&#x27;à l&#x27;élément spécifié par <em>end</em> (mais non compris). Si seul le paramètre <em>startFrom</em> est spécifié, la collection retournée contient tous les éléments de <em>startFrom</em> au dernier élément de la collection d&#x27;origine.</p><ul><li>Si <em>startFrom</em> &lt; 0, le paramètre est recalculé comme <em>startFrom:=startFrom+length</em> (la fin de la collection est considérée comme point de départ du calcul de la position).</li><li>Si la valeur calculée est négative, <em>startFrom</em> prend la valeur 0.</li><li>Si <em>end</em> &lt; 0 , le paramètre est recalculé comme <em>end:=end+length</em>.</li><li>Si <em>end &lt; startFrom</em> (valeurs passées ou recalculées), la fonction ne fait rien.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-27">Exemple<a class="hash-link" href="#exemple-27" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c; $nc : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2;3;4;5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $nc:=$c.slice(0;3) //$nc=[1,2,3]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $nc:=$c.slice(3) //$nc=[4,5]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $nc:=$c.slice(1;-1) //$nc=[2,3,4]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $nc:=$c.slice(-3;-2) //$nc=[3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="some">.some()<a class="hash-link" href="#some" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.some</strong>( { <em>startFrom</em> : Integer ; } <em>formula</em> : 4D.Function { ; <em>...param</em> : any } ) : Boolean<br><strong>.some</strong>( { <em>startFrom</em> : Integer ; } <em>methodName</em> : Text { ; <em>...param</em> : any } ) : Boolean</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>Integer</td><td align="center">-&gt;</td><td>Elément à partir duquel débuter l&#x27;évaluation</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>param</td><td>Mixed</td><td align="center">-&gt;</td><td>Paramètre(s) à passer</td></tr><tr><td>Résultat</td><td>Boolean</td><td align="center">&lt;-</td><td>Vrai si au moins un élément a réussi le test</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-37">Description<a class="hash-link" href="#description-37" title="Direct link to heading">​</a></h4><p>La fonction <code>some()</code> retourne vrai si au moins un des éléments de la collection a été évalué à vrai par le test implémenté dans l&#x27;objet <em>formula</em> ou la méthode <em>methodName</em>.</p><p>Vous désignez le code 4D de rétroappel (callback) à exécuter pour évaluer les éléments de la collection en utilisant soit :</p><ul><li><em>formula</em> (syntaxe recommandée), un <a href="/docs/fr/19-R6/API/FunctionClass">objet formule</a> qui peut encapsuler toute expression exécutable, y compris des fonctions et des méthodes projet ;</li><li><em>methodName</em>, le nom d&#x27;une méthode projet (texte).</li></ul><p>La callback est appelée avec le(s) paramètre(s) passés dans <em>param</em> (facultatif). La callback peut effectuer n&#x27;importe quel test, avec ou sans le(s) paramètre(s) et doit retourner <strong>true</strong> pour chaque élément remplissant le test. Elle reçoit un <code>objet</code> en premier paramètre ($1).</p><p>La callback reçoit les paramètres suivants :</p><ul><li>dans <em>$1.value</em> : valeur de l&#x27;élément à évaluer</li><li>dans $2 : <em>param</em></li><li>dans <em>$N...</em> : <em>paramN...</em></li></ul><p>Elle peut définir le(s) paramètre(s) suivant(s) :</p><ul><li>(obligatoire si vous avez utilisé une méthode) <em>$1.result</em> (booléen) : <strong>true</strong> si l&#x27;évaluation de la valeur de l&#x27;élément est à vrai, <strong>false</strong> sinon.</li><li><em>$1.stop</em> (booléen, optionnel) : <strong>true</strong> pour stopper le rétroappel. La valeur retournée est la dernière calculée.</li></ul><p>Dans tous les cas, au moment où la fonction <code>.some()</code> rencontre le premier élément de la collection retournant true, elle arrête d&#x27;appeler la callback et retourne <strong>true</strong>.</p><p>Par défaut, <code>.some()</code> évalue l&#x27;ensemble de la collection. Optionnellement, vous pouvez passer le numéro de l&#x27;élément auquel démarrer la recherche dans <em>startFrom</em>.</p><ul><li>Si <em>startFrom</em> &gt;= la longueur de la collection, <strong>False</strong> est retourné, ce qui signifie que la collection n&#x27;est pas testée.</li><li>Si <em>startFrom</em> &lt; 0, il est considéré comme le décalage depuis la fin de la collection.</li><li>Si <em>startFrom</em> = 0, l&#x27;ensemble de la collection est évalué (défaut).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-28">Exemple<a class="hash-link" href="#exemple-28" title="Direct link to heading">​</a></h4><p>Vous voulez savoir si au moins une valeur de la collection est &gt;0.</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $b : Boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(-5;-3;-1;-4;-6;-2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.some(Formula($1.value&gt;0)) // $b=false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.some(Formula($1.value&gt;0)) // $b=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.push(1;-5;-3;-1;-4;-6;-2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.some(Formula($1.value&gt;0)) //$b=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $b:=$c.some(1;Formula($1.value&gt;0)) //$b=false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sort">.sort()<a class="hash-link" href="#sort" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R6</td><td>Prise en charge des formules</td></tr><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.sort</strong>( <em>formula</em> : 4D.Function { ; <em>...extraParam</em> : any } ) : Collection<br><strong>.sort</strong>( <em>methodName</em> : Text { ; <em>...extraParam</em> : any } ) : Collection </p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Objet formule</td></tr><tr><td>methodName</td><td>Text</td><td align="center">-&gt;</td><td>Nom de méthode</td></tr><tr><td>extraParam</td><td>any</td><td align="center">-&gt;</td><td>Paramètre(s) à passer à la méthode</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;origine triée</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-38">Description<a class="hash-link" href="#description-38" title="Direct link to heading">​</a></h4><p>La fonction <code>.sort()</code> trie les éléments de la collection d&#x27;origine et retourne également une référence vers cette collection triée .</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Si <code>.sort()</code> est appelé sans paramètre, seules les valeurs scalaires (numérique, texte, date, booléens) sont triées. Les éléments sont triés par défaut par ordre croissant, en fonction de leur type.</p><p>Si vous souhaitez trier les éléments de la collection dans un autre ordre ou trier n&#x27;importe quel type d&#x27;élément, vous devez fournir, dans <em>formula</em> (<a href="/docs/fr/19-R6/API/FunctionClass">objet Formula</a>) ou <em>methodName</em> (texte), une callback de comparaison qui compare deux valeurs et retourne <strong>true</strong> si la première valeur est inférieure à la deuxième valeur. Vous pouvez fournir des paramètres supplémentaires à la callback si nécessaire.</p><p>La callback reçoit les paramètres suivants :</p><ul><li>$1 (object), où :<ul><li><em>$1.value</em> (tout type) : valeur du premier élément à comparer</li><li><em>$1.value2</em> (tout type) : valeur du second élément à comparer</li></ul></li><li>$2...$N (tout type) : paramètres supplémentaires (extraParam)</li></ul><p>Si vous avez utilisé une méthode, elle doit définir le paramètre suivant :</p><ul><li><em>$1.result</em> (booléen) : <strong>true</strong> si <em>$1.value &lt; $1.value2</em>, <strong>false</strong> sinon.</li></ul><p>Si la collection contient des éléments de différents types, ils sont d&#x27;abord groupés par type et triés par la suite. Les types sont renvoyés dans l&#x27;ordre suivant :</p><ol><li>Null</li><li>booléens</li><li>chaînes</li><li>nombres</li><li>objets</li><li>collections</li><li>dates</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-13">Exemple 1<a class="hash-link" href="#exemple-1-13" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col; $col2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(&quot;Tom&quot;;5;&quot;Mary&quot;;3;&quot;Henry&quot;;1;&quot;Jane&quot;;4;&quot;Artie&quot;;6;&quot;Chip&quot;;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col2:=$col.sort() // $col2=[&quot;Artie&quot;,&quot;Chip&quot;,&quot;Henry&quot;,&quot;Jane&quot;,&quot;Mary&quot;,&quot;Tom&quot;,1,2,3,4,5,6]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // $col=[&quot;Artie&quot;,&quot;Chip&quot;,&quot;Henry&quot;,&quot;Jane&quot;,&quot;Mary&quot;,&quot;Tom&quot;,1,2,3,4,5,6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-13">Exemple 2<a class="hash-link" href="#exemple-2-13" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col; $col2 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(10;20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col2:=$col.push(5;3;1;4;6;2).sort() //$col2=[1,2,3,4,5,6,10,20]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-3-6">Exemple 3<a class="hash-link" href="#exemple-3-6" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var $col; $col2; $col3 : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col:=New collection(33;4;66;1111;222)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col2:=$col.sort() //numerical sort: [4,33,66,222,1111]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$col3:=$col.sort(Formula(String($1.value)&lt;String($1.value2))) //tri alphabétique : [1111,222,33,4,66]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sum">.sum()<a class="hash-link" href="#sum" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.sum</strong>( { <em>propertyPath</em> : Text } ) : Real</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>Text</td><td align="center">-&gt;</td><td>Chemin de propriété d&#x27;objet à utiliser pour évaluer les valeurs</td></tr><tr><td>Résultat</td><td>Real</td><td align="center">&lt;-</td><td>Somme des valeurs de collection</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-39">Description<a class="hash-link" href="#description-39" title="Direct link to heading">​</a></h4><p>La fonction <code>.sum()</code> retourne la somme de toutes les valeurs numériques de la collection.</p><p>Seuls les éléments ayant une valeur numérique sont pris en compte pour le calcul (les autres types d&#x27;éléments sont ignorés).</p><p>Si la collection contient des objets, passez le paramètre <em>propertyPath</em> si vous souhaitez désigner la propriété dont vous voulez connaître la moyenne.</p><p><code>.sum()</code> retourne 0 si :</p><ul><li>la collection est vide,</li><li>la collection ne contient pas d&#x27;éléments numériques,</li><li><em>propertyPath</em> n&#x27;est pas trouvé dans la collection.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-1-14">Exemple 1<a class="hash-link" href="#exemple-1-14" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $vSum : Real</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection(10;20;&quot;Monday&quot;;True;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vSum:=$col.sum() //32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-2-14">Exemple 2<a class="hash-link" href="#exemple-2-14" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $col : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $vSum : Real</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col:=New collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Smith&quot;;&quot;salary&quot;;10000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Wesson&quot;;&quot;salary&quot;;50000))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $col.push(New object(&quot;name&quot;;&quot;Gross&quot;;&quot;salary&quot;;10500,5))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $vSum:=$col.sum(&quot;salary&quot;) //$vSum=70500,5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unshift">.unshift()<a class="hash-link" href="#unshift" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v16 R6</td><td>Ajoutées</td></tr></tbody></table></div></div></details><p><strong>.unshift</strong>( <em>value</em> : any { ;...<em>valueN</em> : any } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Text, Number, Object, Collection, Date</td><td align="center">-&gt;</td><td>Valeur(s) à insérer au début de la collection</td></tr><tr><td>Résultat</td><td>Real</td><td align="center">&lt;-</td><td>Collection contenant des éléments ajoutés</td></tr></tbody></table><p>|
|                                        |    |                                               |</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-40">Description<a class="hash-link" href="#description-40" title="Direct link to heading">​</a></h4><p>La fonction <code>unshift()</code> insère la ou les <em>value</em>(s) au début de la collection et retourne la collection modifiée.</p><blockquote><p>Cette fonction modifie la collection d&#x27;origine.</p></blockquote><p>Si plusieurs valeurs sont passées, elles sont insérées toutes en même temps, ce qui signifie qu&#x27;elles apparaissent dans la collection résultante dans le même ordre que dans la liste d&#x27;arguments.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-29">Exemple<a class="hash-link" href="#exemple-29" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> var $c : Collection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c:=New collection(1;2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.unshift(4) // $c=[4,1,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.unshift(5) //$c=[5,4,1,2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> $c.unshift(6;7) // $c=[6,7,5,4,1,2]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/fr/19-R6/API/ClassClass"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Classe</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/fr/19-R6/API/CryptoKeyClass"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CryptoKey</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#exemple" class="table-of-contents__link toc-highlight">Exemple</a></li><li><a href="#sommaire" class="table-of-contents__link toc-highlight">Sommaire</a></li><li><a href="#new-collection" class="table-of-contents__link toc-highlight"><code>New collection</code></a></li><li><a href="#new-shared-collection" class="table-of-contents__link toc-highlight"><code>New shared collection</code></a></li><li><a href="#average" class="table-of-contents__link toc-highlight">.average()</a></li><li><a href="#clear" class="table-of-contents__link toc-highlight">.clear()</a></li><li><a href="#combine" class="table-of-contents__link toc-highlight">.combine()</a></li><li><a href="#concat" class="table-of-contents__link toc-highlight">.concat()</a></li><li><a href="#copy" class="table-of-contents__link toc-highlight">.copy()</a></li><li><a href="#count" class="table-of-contents__link toc-highlight">.count()</a></li><li><a href="#countvalues" class="table-of-contents__link toc-highlight">.countValues()</a></li><li><a href="#distinct" class="table-of-contents__link toc-highlight">.distinct()</a></li><li><a href="#equal" class="table-of-contents__link toc-highlight">.equal()</a></li><li><a href="#every" class="table-of-contents__link toc-highlight">.every()</a></li><li><a href="#extract" class="table-of-contents__link toc-highlight">.extract()</a></li><li><a href="#fill" class="table-of-contents__link toc-highlight">.fill()</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">.filter()</a></li><li><a href="#find" class="table-of-contents__link toc-highlight">.find()</a></li><li><a href="#findindex" class="table-of-contents__link toc-highlight">.findIndex()</a></li><li><a href="#indexof" class="table-of-contents__link toc-highlight">.indexOf()</a></li><li><a href="#indices" class="table-of-contents__link toc-highlight">.indices()</a></li><li><a href="#insert" class="table-of-contents__link toc-highlight">.insert()</a></li><li><a href="#join" class="table-of-contents__link toc-highlight">.join()</a></li><li><a href="#lastindexof" class="table-of-contents__link toc-highlight">.lastIndexOf()</a></li><li><a href="#length" class="table-of-contents__link toc-highlight">.length</a></li><li><a href="#map" class="table-of-contents__link toc-highlight">.map()</a></li><li><a href="#max" class="table-of-contents__link toc-highlight">.max()</a></li><li><a href="#min" class="table-of-contents__link toc-highlight">.min()</a></li><li><a href="#orderby" class="table-of-contents__link toc-highlight">.orderBy()</a></li><li><a href="#orderbymethod" class="table-of-contents__link toc-highlight">.orderByMethod()</a></li><li><a href="#pop" class="table-of-contents__link toc-highlight">.pop()</a></li><li><a href="#push" class="table-of-contents__link toc-highlight">.push()</a></li><li><a href="#query" class="table-of-contents__link toc-highlight">.query()</a></li><li><a href="#reduce" class="table-of-contents__link toc-highlight">.reduce()</a></li><li><a href="#remove" class="table-of-contents__link toc-highlight">.remove()</a></li><li><a href="#resize" class="table-of-contents__link toc-highlight">.resize()</a></li><li><a href="#reverse" class="table-of-contents__link toc-highlight">.reverse()</a></li><li><a href="#shift" class="table-of-contents__link toc-highlight">.shift()</a></li><li><a href="#slice" class="table-of-contents__link toc-highlight">.slice()</a></li><li><a href="#some" class="table-of-contents__link toc-highlight">.some()</a></li><li><a href="#sort" class="table-of-contents__link toc-highlight">.sort()</a></li><li><a href="#sum" class="table-of-contents__link toc-highlight">.sum()</a></li><li><a href="#unshift" class="table-of-contents__link toc-highlight">.unshift()</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Developer Center</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (Where It All Began)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Knowledgebase</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ressources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About 4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D around the world<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/fr/assets/js/runtime~main.47377a59.js"></script>
<script src="/docs/fr/assets/js/main.6a2a1b9c.js"></script>
</body>
</html>