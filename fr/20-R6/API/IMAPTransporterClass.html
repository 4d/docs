<!doctype html><html lang=fr dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-20-R6 docs-doc-page docs-doc-id-API/IMAPTransporterClass" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>IMAPTransporter | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/fr/20-R6/API/IMAPTransporterClass><meta data-rh=true property=og:locale content=fr><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true property=og:locale:alternate content=pt><meta data-rh=true name=docusaurus_locale content=fr><meta data-rh=true name=docsearch:language content=fr><meta data-rh=true name=docusaurus_version content=20-R6><meta data-rh=true name=docusaurus_tag content=docs-default-20-R6><meta data-rh=true name=docsearch:version content=20-R6><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-20-R6><meta data-rh=true property=og:title content="IMAPTransporter | 4D Docs"><meta data-rh=true name=description content="La classe IMAPTransporter vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP."><meta data-rh=true property=og:description content="La classe IMAPTransporter vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP."><link data-rh=true rel=icon href=/docs/fr/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/fr/20-R6/API/IMAPTransporterClass><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20-R6/API/IMAPTransporterClass hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/20-R6/API/IMAPTransporterClass hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/20-R6/API/IMAPTransporterClass hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/20-R6/API/IMAPTransporterClass hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/20-R6/API/IMAPTransporterClass hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20-R6/API/IMAPTransporterClass hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/fr/opensearch.xml><link rel=stylesheet href=/docs/fr/assets/css/styles.4aaeeab1.css><script src=/docs/fr/assets/js/main.1e5d7f86.js defer></script><script src=/docs/fr/assets/js/runtime~main.4d096877.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Aller au contenu principal"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Aller au contenu principal</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/fr/><div class=navbar__logo><img src=/docs/fr/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/fr/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/fr/20-R6/API/IMAPTransporterClass>20 R6</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/fr/API/IMAPTransporterClass>20 R7 BETA</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/fr/20-R6/API/IMAPTransporterClass>20 R6</a><li><a class=dropdown__link href=/docs/fr/20/API/IMAPTransporterClass>20</a><li><a class=dropdown__link href=/docs/fr/19/API/IMAPTransporterClass>19</a><li><a class=dropdown__link href=/docs/fr/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Français</a><ul class=dropdown__menu><li><a href=/docs/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/docs/fr/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=fr>Français</a><li><a href=/docs/es/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/docs/ja/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a><li><a href=/docs/pt/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Rechercher (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Rechercher</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/fr/><img src=/docs/fr/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/fr/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>4D Documentation</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/fr/20-R6/category/getting-started>Prise en main</a><button aria-label="Expand sidebar category 'Prise en main'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/fr/20-R6/category/core-development>Développement</a><button aria-label="Collapse sidebar category 'Développement'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/fr/20-R6/Project/overview>Gestion des projets</a><button aria-label="Expand sidebar category 'Gestion des projets'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/fr/20-R6/Project/code-overview>Environnement de développement</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/fr/20-R6/ORDA/overview>ORDA</a><button aria-label="Expand sidebar category 'ORDA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/fr/20-R6/Concepts/about>Langage</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/fr/20-R6/Concepts/about>Concepts</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href=https://doc.4d.com/4Dv20R6/4D/20-R6/4D-Language-Reference.100-6957482.en.html target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex=0>Commandes<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/fr/20-R6/category/class-API-reference>Classes</a><button aria-label="Collapse sidebar category 'Classes'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/overview>A propos des fonctions de classes</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/BlobClass>Blob</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/ClassClass>Class</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/CollectionClass>Collection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/CryptoKeyClass>CryptoKey</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/DataClassClass>DataClass</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/DataStoreClass>DataStore</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/EmailObjectClass>Email</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/EntityClass>Entity</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/EntitySelectionClass>EntitySelection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/FileClass>File</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/FileHandleClass>FileHandle</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/FolderClass>Folder</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/FunctionClass>Function</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/HTTPAgentClass>HTTPAgent</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/HTTPRequestClass>HTTPRequest</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/fr/20-R6/API/IMAPTransporterClass>IMAPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/MailAttachmentClass>MailAttachment</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/POP3TransporterClass>POP3Transporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/SessionClass>Session</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/SignalClass>Signal</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/SMTPTransporterClass>SMTPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/SystemWorkerClass>SystemWorker</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebFormClass>WebForm</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebFormItemClass>WebFormItem</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebServerClass>WebServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebSocketClass>WebSocket</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebSocketConnectionClass>WebSocketConnection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/WebSocketServerClass>WebSocketServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/ZipArchiveClass>ZIPArchive</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/ZipFileClass>ZIPFile</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/API/ZipFolderClass>ZIPFolder</a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/fr/20-R6/Develop/processes>Process</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/fr/20-R6/Tags/transformation-tags>Balises de transformation</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/fr/20-R6/Preferences/overview>Préférences</a><button aria-label="Expand sidebar category 'Préférences'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/fr/20-R6/category/administration>Administration</a><button aria-label="Expand sidebar category 'Administration'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/fr/20-R6/Extensions/overview>Extensions</a><button aria-label="Expand sidebar category 'Extensions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/fr/20-R6/category/web-applications>Applications Web</a><button aria-label="Expand sidebar category 'Applications Web'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/fr/20-R6/category/desktop-applications>Applications Desktop</a><button aria-label="Expand sidebar category 'Applications Desktop'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a href=https://developer.4d.com/go-mobile/ target=_blank rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false>Applications mobiles</a></div></ul></nav><button type=button title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Page d’accueil" class=breadcrumbs__link href=/docs/fr/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/fr/20-R6/category/core-development><span itemprop=name>Développement</span></a><meta itemprop=position content=1><li class=breadcrumbs__item><span class=breadcrumbs__link>Langage</span><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/fr/20-R6/category/class-API-reference><span itemprop=name>Classes</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>IMAPTransporter</span><meta itemprop=position content=4></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 20 R6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>La classe <code>IMAPTransporter</code> vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objet-imap-transporter>Objet IMAP Transporter<a href=#objet-imap-transporter class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h3>
<p>Les objets IMAP Transporter sont instanciés avec la commande <a href=#imap-new-transporter>IMAP New transporter</a>. Leurs propriétés et fonctions sont les suivantes :</p>


































































































<table><thead><tr><th><tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a><br><strong>True</strong> si 4D est autorisé à établir une connexion non chiffrée<tr><td><a href=#addflags><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><br>ajoute des flags (drapeaux) aux <code>msgIDs</code> pour les <code>keywords</code> spécifiés<tr><td><a href=#append><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><br>ajoute un <code>mailObj</code> à la boîte <code>destinationBox</code><tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a><br> le mode d'authentification utilisé pour ouvrir la session sur le serveur de messagerie<tr><td><a href=#checkconnection><strong>.checkConnection()</strong> : Object</a><br>vérifie la connexion en utilisant les informations stockées dans l'objet transporteur<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a><br>la durée maximale (en secondes) autorisée avant vérification de la connexion au serveur<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a><br>le temps d'attente maximum (en secondes) autorisé pour établir une connexion avec le serveur<tr><td><a href=#copy><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br>copie les messages définis par <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP<tr><td><a href=#createbox><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><br>crée une boîte de réception avec le <code>name</code> passé en paramètre<tr><td><a href=#delete><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><br>associe le marqueur "deleted" aux messages définis dans <code>msgsIDs</code> ou <code>allMsgs</code><tr><td><a href=#deletebox><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><br>supprime définitivement la boîte de réception nommée <code>name</code> sur le serveur IMAP<tr><td><a href=#expunge><strong>.expunge()</strong> : Object</a><br>supprime tous les messages marqués "deleted" du serveur de messagerie IMAP.<tr><td><a href=#getboxinfo><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><br>retourne un objet <code>boxInfo</code> correspondant à la boîte de réception courante ou à la boîte de réception nommée <em>name</em><tr><td><a href=#getboxlist><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><br>retourne une collection de boîtes aux lettres décrivant toutes les boîtes aux lettres disponibles<tr><td><a href=#getdelimiter><strong>.getDelimiter()</strong> : Text</a><br>retourne le caractère utilisé pour délimiter les niveaux de hiérarchie dans le nom de la boîte aux lettres<tr><td><a href=#getmail><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><br>retourne l'objet <code>Email</code> correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boite de réception désignée par l'<code>IMAP_transporter</code><tr><td><a href=#getmails><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><br>retourne un objet contenant une collection d'objets <code>Email</code><tr><td><a href=#getmimeasblob><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><br>retourne un BLOB avec le contenu MIME du message correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boîte de réception désignée par le <code>IMAP_transporter</code><tr><td><a href=#host><strong>.host</strong> : Text</a><br>le nom ou l'adresse IP du serveur hôte<tr><td><a href=#logfile><strong>.logFile</strong> : Text</a><br>le chemin du fichier journal étendu défini (le cas échéant) pour la connexion de messagerie<tr><td><a href=#move><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br>déplace les messages définis par <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP<tr><td><a href=#numtoid><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><br>convertit les numéros de séquence en identifiants uniques IMAP pour les messages de la plage séquentielle désignée par <em>startMsg</em> et <em>endMsg</em><tr><td><a href=#removeflags><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><br>supprime les flags (drapeaux) des <code>msgIDs</code> pour les <code>keywords</code> spécifiés<tr><td><a href=#renamebox><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><br>change le nom d'une boîte de réception sur le serveur IMAP<tr><td><a href=#port><strong>.port</strong> : Integer</a><br>le numéro de port utilisé pour les transactions de courrier<tr><td><a href=#searchmails><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><br>recherche les messages qui correspondent aux critères de recherche <em>searchCriteria</em> dans la boîte aux lettres courante<tr><td><a href=#selectbox><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><br>sélectionne la boîte de réception <em>name</em> comme boîte de réception courante<tr><td><a href=#subscribe><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><br>permet d'ajouter la boîte spécifiée à l'ensemble des boîtes auxquelles vous avez "souscrit" sur le serveur IMAP<tr><td><a href=#unsubscribe><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><br>supprime la boîte spécifiée de l'ensemble des boîtes auxquelles vous avez "souscrit"<tr><td><a href=#user><strong>.user</strong> : Text</a><br>le nom d'utilisateur utilisé pour l'authentification sur le serveur de messagerie</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=imap-new-transporter>IMAP New transporter<a href=#imap-new-transporter class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Informations sur le serveur IMAP<tr><td>Résultat<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#objet-imap-transporter>Objet transporteur IMAP</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description>Description<a href=#description class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La commande <code>IMAP New transporter</code>configure une nouvelle connexion IMAP en fonction du paramètre <em>server</em> et retourne un nouvel objet <em>transporter</em>. L'objet transporteur retourné sera alors utilisé pour la réception d'emails.</p>
<p>Dans le paramètre <em>server</em>, passez un objet contenant les propriétés suivantes :</p>

















































<table><thead><tr><th><em>server</em><th>Valeur par défaut (si omise)<tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a><br><strong>True</strong> si 4D est autorisé à établir une connexion non chiffrée<td>False<tr><td>.<strong>accessTokenOAuth2</strong> : Text<br>.<strong>accessTokenOAuth2</strong> : Object<br>Chaîne ou objet token représentant les informations d'autorisation OAuth2. Utilisé uniquement avec OAUTH2 <code>authenticationMode</code>. Si <code>accessTokenOAuth2</code> est utilisé mais que <code>authenticationMode</code> est omis, le protocole OAuth 2 est utilisé (si le serveur l'autorise). Non retourné en objet <em><a href=#imap-transporter-object>IMAP transporter</a></em>.<td>aucun<tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a><br> le mode d'authentification utilisé pour ouvrir la session sur le serveur de messagerie<td>le mode d'authentification le plus sûr pris en charge par le serveur est utilisé<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a><br>la durée maximale (en secondes) autorisée avant vérification de la connexion au serveur<td>300<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a><br>le temps d'attente maximum (en secondes) autorisé pour établir une connexion avec le serveur<td>30<tr><td><a href=#host><strong>.host</strong> : Text</a><br>le nom ou l'adresse IP du serveur hôte<td><em>obligatoire</em><tr><td><a href=#logfile><strong>.logFile</strong> : Text</a><br>le chemin du fichier journal étendu défini (le cas échéant) pour la connexion de messagerie<td>aucun<tr><td>.<strong>password</strong> : Text<br>Mot de passe utilisateur pour l'authentification sur le serveur. Non retourné en objet <em><a href=#imap-transporter-object>IMAP transporter</a></em>.<td>aucun<tr><td><a href=#port><strong>.port</strong> : Integer</a><br>le numéro de port utilisé pour les transactions de courrier<td>993<tr><td><a href=#user><strong>.user</strong> : Text</a><br>le nom d'utilisateur utilisé pour l'authentification sur le serveur de messagerie<td>aucun</table>
<blockquote>
<p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat>Résultat<a href=#résultat class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction retourne un <a href=#objet-imap-transporter><strong>objet transporteur IMAP</strong></a>. Toutes les propriétés retournées sont en <strong>lecture seule</strong>.</p>
<blockquote>
<p>La connexion IMAP est automatiquement fermée lorsque l'objet transporteur est détruit.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple>Exemple<a href=#exemple class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.host:="imap.gmail.com" //Obligatoire</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.logFile:="LogTest.txt" //log à sauvegarder dans le dossier Logs</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(Not($status.success))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("An error occurred: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4dimaptransporternew>4D.IMAPTransporter.new()<a href=#4dimaptransporternew class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Informations sur le serveur IMAP<tr><td>Résultat<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#objet-imap-transporter>Objet transporteur IMAP</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-1>Description<a href=#description-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>4D.IMAPTransporter.new()</code> crée et retourne un nouvel objet de type <code>4D.IMAPTransporter</code>. Elle est identique à la commande <a href=#imap-new-transporter><code>IMAP New transporter</code></a> (raccourci).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=acceptunsecureconnection>.acceptUnsecureConnection<a href=#acceptunsecureconnection class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R4<td>Ajout</table>
</div></div></details>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-2>Description<a href=#description-2 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.acceptUnsecureConnection</code> contient <strong>True</strong> si 4D est autorisé à établir une connexion non chiffrée lorsqu'une connexion chiffrée n'est pas possible.</p>
<p>Elle contient <strong>False</strong> si les connexions non chiffrées ne sont pas autorisées, auquel cas une erreur est retournée lorsque la connexion chiffrée n'est pas possible.</p>
<p>Ports sécurisés disponibles :</p>
<ul>
<li>
<p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur le prend en charge.</li>
</ul>
</li>
<li>
<p>IMAP</p>
<ul>
<li>143 : Port IMAP non chiffré</li>
<li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prend en charge</li>
</ul>
</li>
<li>
<p>POP3</p>
<ul>
<li>110 : Port POP3 non chiffré</li>
<li>995 : POP3 avec mise à niveau STARTTLS si le serveur le prend en charge.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=addflags>.addFlags()<a href=#addflags class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>20<td>Prise en charge des mots-clés personnalisés (custom keywords)<tr><td>18 R6<td>Ajout</table>
</div></div></details>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgIDs<td>Collection<td style=text-align:center>-><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d'un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée<tr><td>keywords<td>Object<td style=text-align:center>-><td>Mots-clés de flags à ajouter<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération addFlags</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-3>Description<a href=#description-3 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.addFlags()</code> ajoute des flags (drapeaux) aux <code>msgIDs</code> pour les <code>keywords</code> spécifiés.</p>
<p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p>
<ul>
<li>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</li>
<li>l'ID unique (<em>texte</em>) d'un seul message ou</li>
<li>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</li>
</ul>















<table><thead><tr><th>Constante<th>Valeur<th>Commentaire<tbody><tr><td>IMAP all<td>1<td>Sélectionner tous les messages de la boîte sélectionnée</table>
<p>Le paramètre <code>keywords</code> permet de définir les flags à ajouter aux <code>msgIDs</code>. Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalisés (la prise en charge des flags personnalisés dépend de l'implémentation du serveur) :</p>








































<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>$draft<td>Boolean<td>True pour ajouter le marqueur "draft" au message<tr><td>$seen<td>Boolean<td>True pour ajouter le marqueur "seen" au message<tr><td>$flagged<td>Boolean<td>True pour ajouter le marqueur "flagged" au message<tr><td>$answered<td>Boolean<td>True pour ajouter le marqueur "answered" au message<tr><td>$deleted<td>Boolean<td>True pour ajouter le marqueur "deleted" au message<tr><td><code>&lt;custom flag></code><td>Boolean<td>True pour ajouter le flag personnalisé au message</table>
<p>Les noms des flags personnalisés doivent respecter cette règle : le mot-clé doit être une chaîne non sensible à la casse, excluant les caractères de contrôle et les espaces, et ne peut inclure aucun de ces caractères : <code>( ) { ] % * " \</code></p>
<blockquote>
<ul>
<li>Pour qu'un mot-clé soit pris en compte, il doit être à vrai.</li>
<li>L'interprétation des indicateurs de mots-clés peut varier selon le client de messagerie.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-1>Exemple<a href=#exemple-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Créer transporteur</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Sélectionner la boîte de messagerie</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Marquer tous les messages de la boite de réception (INBOX) comme étant lus/vus</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=append>.append()<a href=#append class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R6<td>Ajout</table>
</div></div></details>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>



































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>mailObj<td>Object<td style=text-align:center>-><td>Objet email<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Mailbox devant recevoir l'objet email<tr><td>options<td>Object<td style=text-align:center>-><td>Objet contenant les informations de charset<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-4>Description<a href=#description-4 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.append()</code> ajoute un <code>mailObj</code> à la boîte <code>destinationBox</code>.</p>
<p>Dans le paramètre <code>mailObj</code>, passez un objet email. Pour une description détaillée des propriétés de mail, reportez-vous à <a href=/docs/fr/20-R6/API/EmailObjectClass#objet-email>Objet Email</a>. La fonction <code>.append()</code> prend en charge les marqueurs de mots-clés dans l'attribut <code>keywords</code> des objets email.</p>
<p>Le paramètre optionnel <code>destinationBox</code> vous permet de passer le nom de la boîte de réception dans laquelle l'objet <code>mailObj</code> sera ajouté. S'il est omis, la mailbox courante sera utilisée.</p>
<p>Dans le paramètre optionnel <code>options</code>, vous pouvez passer un objet permettant de définir le charset et l'encodage des différentes parties de l'email. Propriétés disponibles :</p>




















<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>headerCharset<td>Text<td>Charset et encodage utilisés pour les parties de mail suivantes : le sujet, les noms de fichiers joints et le nom du mail. Valeurs possibles : voir le tableau des charsets possibles<tr><td>bodyCharset<td>Text<td>Charset et encodage utilisés pour le contenu html et le texte du body du mail. Valeurs possibles : voir le tableau des charsets possibles</table>
<p>Charsets possibles :</p>






























<table><thead><tr><th>Constante<th>Valeur<th>Commentaire<tbody><tr><td>mail mode ISO2022JP<td>US-ASCII_ISO-2022-JP_UTF8_QP<td><ul><li>headerCharset : US-ASCII si possible, Japanese (ISO-2022-JP) & Quoted-printable si possible, sinon UTF-8 & Quoted-printable<li>bodyCharset : US-ASCII si possible, Japanese (ISO-2022-JP) & 7-bit si possible, sinon UTF-8 & Quoted-printable</ul><tr><td>mail mode ISO88591<td>ISO-8859-1<td><ul><li>headerCharset : ISO-8859-1 & Quoted-printable<li>bodyCharset : ISO-8859-1 & 8-bit</ul><tr><td>mail mode UTF8<td>US-ASCII_UTF8_QP<td>headerCharset & bodyCharset : US-ASCII si possible, sinon UTF-8 & Quoted-printable (<strong>valeur par défaut</strong>)<tr><td>mail mode UTF8 in base64<td>US-ASCII_UTF8_B64<td>headerCharset &bodyCharset : US-ASCII si possible, sinon UTF-8 & base64</table>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-2>Exemple<a href=#exemple-2 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour enregistrer un email dans la boîte Drafts :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$settings:=New object("host"; "domain.com"; "user"; "xxxx"; "password"; "xxxx"; "port"; 993)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.from:="xxxx@domain.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.subject:="Lorem Ipsum"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.textBody:="Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$seen"]:=True //marquer le message comme étant lu</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$draft"]:=True //marquer le message comme brouillon</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$imap.append($msg; "Drafts")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=authenticationmode>.authenticationMode<a href=#authenticationmode class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R4<td>Ajout</table>
</div></div></details>
<p><strong>.authenticationMode</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-5>Description<a href=#description-5 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.authenticationMode</code> contient  le mode d'authentification utilisé pour ouvrir la session sur le serveur de messagerie.</p>
<p>Par défaut, le mode le plus sécurisé pris en charge par le serveur est utilisé.</p>
<p>Valeurs possibles :</p>






























<table><thead><tr><th>Valeur<th>Constantes<th>Commentaire<tbody><tr><td>CRAM-MD5<td><code>IMAP authentication CRAM MD5</code><td>Authentification à l'aide du protocole CRAM-MD5<tr><td>LOGIN<td><code>IMAP authentication login</code><td>Authentification à l'aide du protocole LOGIN<tr><td>OAUTH2<td><code>IMAP authentication OAUTH2</code><td>Authentification à l'aide du protocole OAuth2<tr><td>PLAIN<td><code>IMAP authentication plain</code><td>Authentification à l'aide du protocole PLAIN</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnection>.checkConnection()<a href=#checkconnection class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R4<td>Ajout</table>
</div></div></details>
<p><strong>.checkConnection()</strong> : Object</p>

















<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de la connexion de l'objet transporteur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-6>Description<a href=#description-6 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.checkConnection()</code> vérifie la connexion en utilisant les informations stockées dans l'objet transporteur, recrée la connexion si nécessaire et renvoie le statut. Cette fonction vous permet de vérifier que les valeurs fournies par l'utilisateur sont valides et cohérentes.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objet-retourné>Objet retourné<a href=#objet-retourné class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction envoie une requête au serveur de mail et retourne un objet décrivant le statut. Cet objet peut avoir les propriétés suivantes :</p>





















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>boolean<td>Vrai si la vérification a été effectuée avec succès, sinon Faux<tr><td>status<td><td>number<td>(SMTP uniquement) Code du statut retourné par le serveur de messagerie (0 en cas de problème non lié au traitement du mail)<tr><td>statusText<td><td>text<td>Message du statut retourné par le serveur de messagerie, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur de messagerie est reçue)<tr><td><td>[ ].errCode<td>number<td>Code d'erreur 4D<tr><td><td>[ ].message<td>text<td>Description de l'erreur 4D<tr><td><td>[ ].componentSignature<td>text<td>Signature du composant interne qui a retourné l'erreur</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnectiondelay>.checkConnectionDelay<a href=#checkconnectiondelay class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-7>Description<a href=#description-7 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.checkConnectionDelay</code> contient la durée maximale (en secondes) autorisée avant vérification de la connexion au serveur.  Si cette durée est dépassée entre deux appels de méthodes, la connexion au serveur sera vérifiée. Par défaut, si la propriété n'a pas été définie dans l'objet <em>server</em>, la valeur est de 300.</p>
<blockquote>
<p><strong>Attention</strong> : Assurez-vous que le timeout défini est inférieur au timeout du serveur, sinon le timeout du client sera inutile.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=connectiontimeout>.connectionTimeOut<a href=#connectiontimeout class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R5<td>Ajout</table>
</div></div></details>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-8>Description<a href=#description-8 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.connectionTimeOut</code> contient le temps d'attente maximum (en secondes) autorisé pour établir une connexion avec le serveur. Par défaut, si la propriété n'a pas été définie dans l'objet server (utilisé pour créer l'objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), la valeur utilisée est 30.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=copy>.copy()<a href=#copy class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Collection d'IDs uniques de messages (texte)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Boîte de réception recevant les messages copiés<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération de copie</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-9>Description<a href=#description-9 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.copy()</code> copie les messages définis par <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à copier, ou</li>
<li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour copier tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages copiés.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-1-1>Exemple 1<a href=#exemple-1-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour copier une sélection de messages :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatoire</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtenir la collection des IDs uniques de message</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copier les messages identifiés dans la boîte de réception "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy($mailIds;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-2-1>Exemple 2<a href=#exemple-2-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour copier tous les messages de la boîte de réception courante :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatoire</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copier les messages dans la boîte de réception "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy(IMAP all;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=createbox>.createBox()<a href=#createbox class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>19<td>Ajout</table>
</div></div></details>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la nouvelle mailbox<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération de création de mailbox</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-10>Description<a href=#description-10 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.createBox()</code> crée une boîte de réception avec le <code>name</code> passé en paramètre. Si le caractère séparateur de hiérarchie du serveur IMAP apparaît dans le nom de la mailbox, le serveur IMAP créera tous les boîtes parentes nécessaires pour créer la boîte donnée.</p>
<p>Par exemple, si vous essayez de créer "Projects/IMAP/Doc" dans un serveur dont le "/" est le caractère séparateur de hiérarchie, les éléments suivants seront créés :</p>
<ul>
<li>Uniquement la boîte "Doc" si "Projects" & "IMAP" existent déjà.</li>
<li>Les boîtes "IMAP" & "Doc" si seule “Projects” existe déjà.</li>
<li>Les boîtes "Projects" & “IMAP” & "Doc" si elles n'existent pas déjà.</li>
</ul>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à créer.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-3>Exemple<a href=#exemple-3 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour créer une nouvelle boîte “Invoices” :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.createBox("Invoices")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("Mailbox creation successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=delete>.delete()<a href=#delete class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Collection d'IDs uniques de messages (texte)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération de suppression</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-11>Description<a href=#description-11 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.delete()</code> associe le marqueur "deleted" aux messages définis dans <code>msgsIDs</code> ou <code>allMsgs</code>.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <code>msgsIDs</code>, une collection contenant les ID uniques des messages spécifiques à supprimer, ou</li>
<li>dans le paramètre <code>allMsgs</code>, la constante <code>IMAP all</code> (integer) pour supprimer tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>L'exécution de cette fonction ne supprime pas réellement les messages. Les messages ayant le marqueur "deleted" peuvent toujours être trouvés par la fonction <a href=#searchmails>.searchMails()</a>. Les messages marqués sont supprimés du serveur IMAP avec la fonction <a href=#expunge><code>.expunge()</code></a> ou en sélectionnant une autre boîte de réception ou lorsque l'objet <a href=#imap-transporter-object>transporter</a> (créé avec <a href=#imap-new-transporter>IMAP New transporter</a>) est détruit.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-1-2>Exemple 1<a href=#exemple-1-2 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour supprimer une sélection de messages :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //get collection of message unique IDs</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"Reports\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // Delete selected messages</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-2-2>Exemple 2<a href=#exemple-2-2 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour supprimer tous les messages de la boîte de réception courante :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Junk Email")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // delete all messages in the current mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete(IMAP all)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=deletebox>.deleteBox()<a href=#deletebox class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>19<td>Ajout</table>
</div></div></details>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la boîte de réception à supprimer<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération de suppression de boîte</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-12>Description<a href=#description-12 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.deleteBox()</code> supprime définitivement la boîte de réception nommée <code>name</code> sur le serveur IMAP. Si vous tentez de supprimer la boîte INBOX ou une boîte de réception qui n'existe pas, une erreur sera générée.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer.</p>
<blockquote>
<ul>
<li>La fonction ne peut pas supprimer une boîte de réception contenant des boîtes "enfant" si la boîte "parente" dispose de l'attribute "\Noselect".</li>
<li>Tous les messages présents dans la boîte seront également supprimés.</li>
<li>La possibilité de supprimer une boîte de réception dépend du serveur de messagerie.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-4>Exemple<a href=#exemple-4 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Vous souhaitez supprimer la boîte enfant "Nova Orion Industries" à l'intérieur de la boîte "Bills" :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// delete mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Nova Orion Industries"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("Mailbox deletion successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=expunge>.expunge()<a href=#expunge class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R6<td>Ajout</table>
</div></div></details>
<p><strong>.expunge()</strong> : Object</p>

















<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération expunge</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-13>Description<a href=#description-13 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.expunge()</code> supprime tous les messages marqués "deleted" du serveur de messagerie IMAP. Le marqueur "deleted" peut être fixé avec les fonctions <a href=#delete><code>.delete()</code></a> ou <a href=#addflags><code>.addFlags()</code></a>.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-5>Exemple<a href=#exemple-5 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $ids : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Creation du transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Sélection de la boîte</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Chercher et sélectionner les messages lus dans INBOX</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ids:=$transporter.searchMails("SEEN")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Purger tous les messages marqués deleted</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxinfo>.getBoxInfo()<a href=#getboxinfo class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>





















<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>20<td><em>id</em> est renvoyé<tr><td>18 R5<td><em>name</em> est optionnel<tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la boîte de réception<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Objet boxInfo</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-14>Description<a href=#description-14 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getBoxInfo()</code>retourne un objet <code>boxInfo</code> correspondant à la boîte de réception courante ou à la boîte de réception nommée <em>name</em>. Cette fonction retourne les mêmes informations que <a href=#selectbox><code>.selectBox()</code></a> mais sans modifier la boite de réception courante.</p>
<p>Dans le paramètre <em>name</em> passez le nom de la mailbox à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l'aide de la fonction <a href=#getdelimiter><code>.getDelimiter()</code></a>.</p>
<p>Si la boîte de réception nommée <em>name</em> n'est pas sélectionnable ou n'existe pas, la fonction génère une erreur et retourne <strong>null</strong>.</p>
<p><strong>Objet retourné</strong></p>
<p>L'objet <code>boxInfo</code> contient les propriété suivantes :</p>






























<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>name<td>text<td>Nom de la boîte de réception<tr><td>mailCount<td>number<td>Nombre de messages contenus dans la boîte de réception<tr><td>mailRecent<td>number<td>Nombre de messages portant le marqueur "récent" (indiquant les nouveaux messages)<tr><td>id<td>text<td>Identifiant unique de la boîte aux lettres</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-6>Exemple<a href=#exemple-6 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $info:=$transporter.getBoxInfo("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("INBOX contains "+String($info.mailRecent)+" recent emails.")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxlist>.getBoxList()<a href=#getboxlist class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout<tr><td>19<td>Ajout paramètre <code>isSubscribed</code></table>
</div></div></details>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>parameters<td>Object<td style=text-align:center>-><td>Objet de paramètre<tr><td>Résultat<td>Collection<td style=text-align:center>&lt;-<td>Collection d'objets mailbox</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-15>Description<a href=#description-15 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getBoxList()</code>retourne une collection de boîtes aux lettres décrivant toutes les boîtes aux lettres disponibles. Cette fonction vous permet de gérer localement les listes de messages situés sur le serveur de messagerie IMAP.</p>
<p>Dans le paramètre optionnel <code>parameters</code>, passez un objet contenant des valeurs de filtrage des boîtes de réception retournées. Vous pouvez passer :</p>















<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>isSubscribed<td>Boolean<td><li><strong>True</strong> pour ne renvoyer que les boîtes auxquelles vous êtes abonné</li><li> <strong>False</strong> pour retourner toutes les boîtes aux lettres disponibles</li></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-1>Résultat<a href=#résultat-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Chaque objet de la collection retournée contient les propriétés suivantes :</p>






























<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>[].name<td>text<td>Nom de la boîte de réception<tr><td>[].selectable<td>boolean<td>Indique si les droits d'accès permettent ou non de sélectionner la boîte aux lettres : <ul><li>true - la boîte aux lettres peut être sélectionnée<li>false - la boîte aux lettres ne peut pas être sélectionnée</ul><tr><td>[].inferior<td>boolean<td>Indique si les droits d'accès permettent ou non de créer une hiérarchie inférieure dans la boîte aux lettres : <ul><li>true - un niveau inférieur peut être créé<li>false - un niveau inférieur ne peut pas être créé</ul><tr><td>[].interesting<td>boolean<td>Indique si la boîte aux lettres a été marquée comme "intéressante" par le serveur : <ul><li>true - La boîte aux lettres a été marquée comme "intéressante" par le serveur. Par exemple, elle peut contenir de nouveaux messages.<li>false - La boîte aux lettres n'a pas été marquée comme "intéressante" par le serveur</li>.</ul></table>
<p>Si le compte ne contient pas de boites de réception, une collection vide est retournée.</p>
<blockquote>
<ul>
<li>Si aucune connexion n'est ouverte, <code>.getBoxList()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis le délai de connexion (voir <code>IMAP New transporter</code>), la fonction <code>.checkConnection( )</code> est automatiquement appelée.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-7>Exemple<a href=#exemple-7 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getdelimiter>.getDelimiter()<a href=#getdelimiter class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.getDelimiter()</strong> : Text</p>

















<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>Résultat<td>Text<td style=text-align:center>&lt;-<td>Caractère de délimitation de hiérarchie</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-16>Description<a href=#description-16 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getDelimiter()</code>retourne le caractère utilisé pour délimiter les niveaux de hiérarchie dans le nom de la boîte aux lettres.</p>
<p>Le délimiteur est un caractère pouvant être utilisé pour :</p>
<ul>
<li>créer des boites de réception de niveau inférieur</li>
<li>rechercher des niveaux inférieurs ou supérieurs dans la hiérarchie de la boite de réception</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-2>Résultat<a href=#résultat-2 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Caractère de délimitation des noms de boites de réception.</p>
<blockquote>
<ul>
<li>Si aucune connexion n'est ouverte, <code>.getDelimiter()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis la <a href=#checkconnectiondelay>durée maximale définie</a>, la fonction <a href=#checkconnection><code>.checkConnection()</code></a> est automatiquement appelée.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-8>Exemple<a href=#exemple-8 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmail>.getMail()<a href=#getmail class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>



































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Numéro de séquence du message<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID unique du message<tr><td>options<td>Object<td style=text-align:center>-><td>Instructions sur la gestion du message<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td><a href=/docs/fr/20-R6/API/EmailObjectClass#objet-email>Objet Email</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-17>Description<a href=#description-17 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getMail()</code> retourne l'objet <code>Email</code> correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boite de réception désignée par l'<code>IMAP_transporter</code>. Cette fonction vous permet de gérer localement le contenu de l'email.</p>
<p>Dans le premier paramètre, vous pouvez passer soit :</p>
<ul>
<li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li>
<li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID unique du message à récupérer.</li>
</ul>
<p>Le paramètre facultatif <em>options</em> vous permet de passer un objet définissant des instructions supplémentaires pour la gestion de votre message. Les propriétés suivantes sont disponibles :</p>




















<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>updateSeen<td>boolean<td>Si Vrai, le message est marqué comme "seen" (lu) dans la boite de réception. Si Faux, le message n'est pas marqué comme "seen". Valeur par défaut : Vrai<tr><td>withBody<td>boolean<td>Passez Vrai pour retourner le corps du message. Si Faux, seul l'en-tête du message est retourné. Valeur par défaut : Vrai</table>
<blockquote>
<ul>
<li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>msgID</em> désigne un message non existant,</li>
<li>Si aucune boite de réception n'est sélectionnée avec la <a href=#selectbox>fonction <code>.selectBox()</code></a>, une erreur est générée,</li>
<li>S'il n'y a pas de connexion ouverte, <code>.getMail()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l'aide de <a href=#selectbox><code>.selectBox()</code></a>`.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-3>Résultat<a href=#résultat-3 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p><code>.getMail()</code> retourne un <a href=/docs/fr/20-R6/API/EmailObjectClass#objet-email>objet <code>Email</code></a> avec les propriétés IMAP suivantes spécifiques : <em>id</em>, <em>receivedAt</em>, et <em>size</em>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-9>Exemple<a href=#exemple-9 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Vous souhaitez lire le message avec ID = 1 :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //create transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //get Email object with ID 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmails>.getMails()<a href=#getmails class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>









































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>ids<td>Collection<td style=text-align:center>-><td>Collection d'identifiants de messages<tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Numéro de séquence du premier message<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Numéro de séquence du dernier message<tr><td>options<td>Object<td style=text-align:center>-><td>Instructions sur la gestion du message<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Objet contenant :<br><ul><li>une collection d'[objets Email] (EmailObjectClass.md#objet-email) et<li>une collection d'ID ou de numéros pour les messages manquants, le cas échéant</ul></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-18>Description<a href=#description-18 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getMails()</code>retourne un objet contenant une collection d'objets <code>Email</code>.</p>
<p><strong>Première syntaxe :</strong></p>
<p><em><strong>.getMails( ids { ; options } ) -> result</strong></em></p>
<p>La première syntaxe vous permet de récupérer des messages en fonction de leurs identifiants.</p>
<p>Dans le paramètre <em>ids</em>, passez une collection d'identifiants des messages à retourner. Vous pouvez obtenir les ID à l'aide de <a href=#getmail><code>.getMail()</code></a>.</p>
<p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner. Pour une description détaillée des propriétés disponibles, reportez-vous au tableau <strong>Options</strong> ci-dessous.</p>
<p><strong>Deuxième syntaxe :</strong></p>
<p><em><strong>.getMails( startMsg ; endMsg { ; options } ) -> result</strong></em></p>
<p>La deuxième syntaxe vous permet de récupérer des messages en fonction d'une plage séquentielle. Les valeurs passées représentent la position des messages dans la boite de réception.</p>
<p>Dans le paramètre <em>startMsg</em>, passez une valeur integer correspondant au numéro du premier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p>
<p>Dans le paramètre <em>endMsg</em>, passez une valeur integer correspondant au numéro du dernier message dans la plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p>
<p>Le paramètre optionnel <em>options</em> vous permet de définir les parties de messages à retourner.</p>
<p><strong>Options</strong></p>




















<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>updateSeen<td>Boolean<td>Si Vrai, les messages sont marqués comme "seen" (lus) dans la boite de réception. Si Faux, les messages ne sont pas marqués comme "seen". Valeur par défaut : Vrai<tr><td>withBody<td>Boolean<td>Passez Vrai pour retourner le corps des messages spécifiés. Si Faux, seuls les en-tête des messages sont retournés. Valeur par défaut : Vrai</table>
<blockquote>
<ul>
<li>Si aucune boite de réception n'est sélectionnée avec <a href=#selectbox><code>.selectBox()</code></a>, une erreur est générée.</li>
<li>S'il n'y a pas de connexion ouverte, <code>.getMails()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l'aide de <a href=#selectbox><code>selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-4>Résultat<a href=#résultat-4 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p><code>.getMails()</code> retourne un objet contenant les collections suivantes :</p>




















<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>liste<td>Collection<td>Collection d'<a href=/docs/fr/20-R6/API/EmailObjectClass#objet-email>objets Email</a>. Si aucun objet Email n'est trouvé, une collection vide est retournée.<tr><td>notFound<td>Collection<td>Collection de :<br><ul><li>première syntaxe - ID de messages passés précédemment qui n'existent pas<li>deuxième syntaxe - numéros de séquence des messages entre startMsg et endMsg qui n'existent pas.</ul>Une collection vide est renvoyée si tous les messages ont été trouvés.</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-10>Exemple<a href=#exemple-10 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Vous souhaitez récupérer les 20 emails les plus récents sans modifier le statut "seen" :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //create transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  If($boxInfo.mailCount>0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class=token-line style=color:#393A34><span class="token plain">     New object("withBody";False;"updateSeen";False))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    For each($mail;$result.list)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    // ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End for each</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmimeasblob>.getMIMEAsBlob()<a href=#getmimeasblob class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>



































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Numéro de séquence du message<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID unique du message<tr><td>updateSeen<td>Boolean<td style=text-align:center>-><td>Si Vrai, le message est marqué comme "seen" (lu) dans la boite de réception. Si Faux, le message demeure inchangé.<tr><td>Résultat<td>BLOB<td style=text-align:center>&lt;-<td>Blob de la chaine MIME retournée par le serveur mail</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-19>Description<a href=#description-19 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.getMIMEAsBlob()</code> retourne un BLOB avec le contenu MIME du message correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boîte de réception désignée par le <code>IMAP_transporter</code>.</p>
<p>Dans le premier paramètre, vous pouvez passer soit :</p>
<ul>
<li><em>msgNumber</em>, une valeur <em>integer</em> indiquant le numéro de séquence du message à récupérer ou</li>
<li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID unique du message à récupérer.</li>
</ul>
<p>Le paramètre optionnel <em>updateSeen</em> vous permet d'indiquer si le message est marqué comme "seen" (lu) dans la boîte de réception. Vous pouvez passer :</p>
<ul>
<li><strong>Vrai</strong> - pour marquer le message comme "seen" (indiquant que le message a été lu)</li>
<li><strong>Faux</strong> - pour ne pas modifier le statut "seen" du message</li>
</ul>
<blockquote>
<ul>
<li>La fonction retourne un BLOB vide si <em>msgNumber</em> ou msgID désigne un message inexistant,</li>
<li>Si aucune boite de réception n'est sélectionnée avec <a href=#selectbox><code>.selectBox()</code></a>, une erreur est générée,</li>
<li>S'il n'y a pas de connexion ouverte, <code>.getMIMEAsBlob()</code> ouvrira une connexion avec la dernière boite de réception spécifiée à l'aide de <code>.selectBox()</code>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-5>Résultat<a href=#résultat-5 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p><code>.getMIMEAsBlob()</code> renvoie un <code>BLOB</code> qui peut être archivé dans une base de données ou converti en un objet <a href=/docs/fr/20-R6/API/EmailObjectClass#objet-email><code>Email</code></a> avec la commande <code>MAIL Convert from MIME</code>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-11>Exemple<a href=#exemple-11 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $blob : Blob</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //create transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //get BLOB</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=host>.host<a href=#host class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R5<td>Ajout</table>
</div></div></details>
<p><strong>.host</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-20>Description<a href=#description-20 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.host</code> contient le nom ou l'adresse IP du serveur hôte. Utilisée pour les échanges de courrier (SMTP, POP3, IMAP).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logfile>.logFile<a href=#logfile class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R5<td>Ajout</table>
</div></div></details>
<p><strong>.logFile</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-21>Description<a href=#description-21 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.logFile</code> contient le chemin du fichier journal étendu défini (le cas échéant) pour la connexion de messagerie. Le chemin peut être relatif (au dossier Logs courant) ou absolu.</p>
<p>Contrairement aux fichiers log habituels (activés via la commande <code>SET DATABASE PARAMETER</code>), les fichiers log étendus stockent le contenu MIME de tous les emails envoyés et n'ont pas de limite de taille. Pour plus d'informations sur les fichiers log étendus, reportez-vous à :</p>
<ul>
<li><strong>Connexions SMTP</strong> - <a href=/docs/fr/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DSMTPLog.txt</a></li>
<li><strong>Connexions POP3</strong> - <a href=/docs/fr/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DPOP3Log.txt</a></li>
<li><strong>Connexions IMAP</strong> - <a href=/docs/fr/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DIMAPLog.txt</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=move>.move()<a href=#move class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Collection d'IDs uniques de messages (texte)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code> : tous les messages de la boîte de réception sélectionnée<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Boîte de réception recevant les messages déplacés<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération de déplacement</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-22>Description<a href=#description-22 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.move()</code> déplace les messages définis par <em>msgsIDs</em> ou <em>allMsgs</em> vers la <em>destinationBox</em> sur le serveur IMAP.</p>
<p>Vous pouvez passer :</p>
<ul>
<li>dans le paramètre <em>msgsIDs</em>, une collection contenant les ID uniques des messages spécifiques à déplacer, ou</li>
<li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAP all</code> (integer) pour déplacer tous les messages de la boîte de réception sélectionnée.</li>
</ul>
<p>Le paramètre <em>destinationBox</em> vous permet de passer une valeur texte avec le nom de la boîte de réception dans laquelle seront placés les messages déplacés.</p>
<blockquote>
<p>Cette fonction est uniquement prise en charge par les serveurs IMAP compatibles avec RFC <a href=https://tools.ietf.org/html/rfc8474 target=_blank rel="noopener noreferrer">8474</a>.</p>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-1-3>Exemple 1<a href=#exemple-1-3 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour déplacer une sélection de messages :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtenir une collection d'IDs uniques de messages</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // déplacer les messages trouvés de la boite courante vers la boite "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move($mailIds;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-2-3>Exemple 2<a href=#exemple-2-3 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour déplacer tous les messages de la boîte de réception courante :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //sélectionner la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // déplacer tous les messages de la boite courante vers la boite "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move(IMAP all;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=numtoid>.numToID()<a href=#numtoid class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Numéro de séquence du premier message<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Numéro de séquence du dernier message<tr><td>Résultat<td>Collection<td style=text-align:center>&lt;-<td>Collection d'identifiants de messages uniques</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-23>Description<a href=#description-23 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.numToID()</code> convertit les numéros de séquence en identifiants uniques IMAP pour les messages de la plage séquentielle désignée par <em>startMsg</em> et <em>endMsg</em> dans la boîte de réception courante.</p>
<p>Dans le paramètre <em>startMsg</em> passez une valeur <em>entier</em> correspondant au numéro du premier message dans une plage séquentielle. Si vous passez un nombre négatif (<em>startMsg</em> &lt;= 0), le premier message de la boîte de réception sera utilisé comme début de la séquence.</p>
<p>Dans le paramètre <em>endMsg</em> passez une valeur <em>entier long</em> correspondant au numéro du dernier message à inclure dans une plage séquentielle. Si vous passez un nombre négatif (<em>endMsg</em> &lt;= 0), le dernier message de la boîte de réception sera utilisé comme fin de séquence.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=résultat-6>Résultat<a href=#résultat-6 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction retourne une collection de chaînes (IDs uniques).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-12>Exemple<a href=#exemple-12 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //Sélectionner la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtenir les IDs des 5 derniers messages reçus</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //supprimer les messages de la boite courante</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=removeflags>.removeFlags()<a href=#removeflags class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>20<td>Prise en charge des mots-clés personnalisés (custom keywords)<tr><td>18 R6<td>Ajout</table>
</div></div></details>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>msgIDs<td>Collection<td style=text-align:center>-><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d'un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée<tr><td>keywords<td>Object<td style=text-align:center>-><td>Mots-clés de flags à supprimer<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération removeFlags</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-24>Description<a href=#description-24 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.removeFlags()</code> supprime les flags (drapeaux) des <code>msgIDs</code> pour les <code>keywords</code> spécifiés.</p>
<p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit :</p>
<ul>
<li>une <em>collection</em> contenant les IDs uniques de messages spécifiques, ou</li>
<li>l'ID unique (<em>texte</em>) d'un seul message ou</li>
<li>la constante suivante (<em>entier long</em>) pour tous les messages de la boîte sélectionnée :</li>
</ul>















<table><thead><tr><th>Constante<th>Valeur<th>Commentaire<tbody><tr><td>IMAP all<td>1<td>Sélectionner tous les messages de la boîte sélectionnée</table>
<p>Le paramètre <code>keywords</code> vous permet de définir les flags à supprimer des <code>msgIDs</code>. Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalisés :</p>








































<table><thead><tr><th>Paramètres<th>Type<th>Description<tbody><tr><td>$draft<td>Boolean<td>True pour supprimer le marqueur "draft" du message<tr><td>$seen<td>Boolean<td>True pour supprimer le marqueur "seen" du message<tr><td>$flagged<td>Boolean<td>True pour supprimer le marqueur "flagged" du message<tr><td>$answered<td>Boolean<td>True pour supprimer le marqueur "answered" du message<tr><td>$deleted<td>Boolean<td>True pour supprimer le marqueur "deleted" du message<tr><td><code>&lt;custom flag></code><td>Boolean<td>True pour supprimer le flag personnalisé du message</table>
<p>Reportez-vous à <a href=#addflags>.addFlags()</a> pour plus d'informations sur les flags personnalisés.</p>
<blockquote>
<ul>
<li>Pour qu'un mot-clé soit pris en compte, il doit être à vrai.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-13>Exemple<a href=#exemple-13 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// renommer la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.renameBox("Invoices"; "Bills")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox renaming successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=renamebox>.renameBox()<a href=#renamebox class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>19<td>Ajout</table>
</div></div></details>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>currentName<td>Text<td style=text-align:center>-><td>Nom actuel de la boîte de réception<tr><td>nouveauNom<td>Text<td style=text-align:center>-><td>Nom de la nouvelle mailbox<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération renaming</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-25>Description<a href=#description-25 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.renameBox()</code> change le nom d'une boîte de réception sur le serveur IMAP. Essayer de renommer une mailbox qui n'existe pas ou de renommer une mailbox avec un nom qui est déjà utilisé génère une erreur.</p>
<p>Dans le paramètre <code>currentName</code>, passez le nom de la mailbox à renommer.</p>
<p>Passez le nouveau nom de la mailbox dans e paramètre <code>newName</code>.</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-14>Exemple<a href=#exemple-14 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour renommer la mailbox “Invoices” en “Bills”:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// renommer la boite de réception</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.renameBox("Invoices"; "Bills")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox renaming successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=port>.port<a href=#port class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R4<td>Ajout</table>
</div></div></details>
<p><strong>.port</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-26>Description<a href=#description-26 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.port</code> contient le numéro de port utilisé pour les transactions de courrier. Par défaut, si la propriété <em>port</em> n'a pas été définie dans l'objet <em>server</em> (utilisé pour créer l'objet transporteur avec <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), le port utilisé est :</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=searchmails>.searchMails()<a href=#searchmails class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>18 R5<td>Ajout</table>
</div></div></details>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>searchCriteria<td>Text<td style=text-align:center>-><td>Critère(s) de recherche<tr><td>Résultat<td>Collection<td style=text-align:center>&lt;-<td>Collection de numéros de messages</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-27>Description<a href=#description-27 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<blockquote>
<p>Cette fonction est basée sur la spécification du <a href=https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol target=_blank rel="noopener noreferrer">protocole IMAP</a>.</p>
</blockquote>
<p>La fonction <code>.searchMails()</code> recherche les messages qui correspondent aux critères de recherche <em>searchCriteria</em> dans la boîte aux lettres courante. .</p>
<p><em>searchCriteria</em> est un paramètre texte listant un ou plusieurs critères de recherche (voir <a href=#mots-cles-de-recherche-autorises>Mots-clés de recherche autorisés</a> ci-dessous) associés ou non à des valeurs à rechercher. Un critère de recherche peut être composé d'un ou plusieurs éléments. Par exemple :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">SearchKey1 = FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey2 = NOT FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<blockquote>
<p>La correspondance n'est généralement pas sensible à la casse</p>
</blockquote>
<ul>
<li>Si <em>searchCriteria</em> est une chaîne vide, la recherche sera équivalente à un "tout sélectionner".</li>
<li>Si <em>searchCriteria</em> contient plusieurs mots-clés de recherche, le résultat est l'intersection (fonction ET) de tous les messages qui correspondent à ces critères.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = FLAGGED FROM "SMITH"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... retourne tous les messages avec le marqueur \Flagged activé ET envoyés par Smith.</p>
<ul>
<li>Vous pouvez utiliser les opérateurs <strong>OR</strong> ou <strong>NOT</strong> comme suit :</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... retourne tous les messages comportant le marqueur \Seen OU \Flagged</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... retourne tous les messages ne comportant pas le marqueur \Seen.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... retourne les messages dont l'en-tête content-type contient “Mixed” et ne contient pas “Text”.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... retourne les messages dont l'en-tête content-type contient “ e ” et dont l'en-tête Subject ne contient pas “ o ” et dont l'en-tête content-type n'est pas “ Mixed ”.</p>
<p>A noter que dans les deux derniers exemples, le résultat de la recherche est différent lorsque vous enlevez les parenthèses de la première liste de mots-clés.</p>
<ul>
<li>Le paramètre <em>searchCriteria</em> peut inclure optionnellement l'instruction [CHARSET]. Cette instruction est composée du mot "CHARSET" suivi d'un jeu de caractères défini [CHARSET] (US ASCII, ISO-8859). Elle indique le codage de caractères utilisé dans la chaine <em>searchCriteria</em>. Par conséquent, vous devez convertir la chaîne <em>searchCriteria</em> dans le jeu de caractères spécifié si vous utilisez l'instruction [CHARSET] (voir les commandes <code>CONVERT FROM TEXT</code> ou <code>Convert to text</code>).
Par défaut, 4D encode la chaîne de critères searchCriteria en "Quotable Printable" si elle contient des caractères étendus.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = CHARSET "ISO-8859" BODY "Help"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... signifie que le critère de recherche utilise le jeu de caractères iso-8859 et que le serveur devra convertir la chaîne avant la recherche, si nécessaire.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mots-clés-de-recherche-autorisés>Mots-clés de recherche autorisés<a href=#mots-clés-de-recherche-autorisés class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Les mots-clés de recherche peuvent traiter des valeurs des types suivants :</p>
<ul>
<li>
<p><strong>Valeurs de type date</strong> : Les valeurs de type date sont placées dans des chaînes formatées de la manière suivante : <em>date-day+"-"+date-month+"-"+date-year</em> où date-day indique la date du jour dans le mois (2 caractères maxi), date-month indique le mois (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) et date-year indique l’année sur 4 chiffres.
Exemple : <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (il n’est généralement pas nécessaire de mettre une date entre guillemets puisqu’elle ne contient pas de caractères spéciaux)</p>
</li>
<li>
<p>**Valeurs de type chaîne
** : Les valeurs de type chaîne peuvent contenir tout type de caractère et doivent être placées entre des guillemets. Toutefois, si la chaîne ne contient pas de caractères spéciaux (des espaces par exemple), les guillemets ne sont pas obligatoires. Dans tous les cas, les guillemets vous permettent de vous assurer que la chaîne sera correctement interprétée.
Example: <code>searchCriteria = FROM "SMITH"</code> For all search keys that use strings, a message matches the key if the string is a substring of the field. La recherche ne tient pas compte de la casse des caractères.</p>
</li>
<li>
<p><strong>Noms de champs</strong> : Les valeurs de type nom de champ contiennent le nom d’un champ d’en-tête.
Exemple : <code>searchCriteria = HEADER CONTENT-TYPE "MIXED"</code></p>
</li>
<li>
<p><strong>Marqueurs</strong> : Les valeurs de type marqueur (flags) acceptent un ou plusieurs mots-clés (y compris des marqueurs standard) séparés par des espaces.
Exemple : <code>searchCriteria = KEYWORD \Flagged \Draft</code></p>
</li>
<li>
<p><strong>Ensemble de messages</strong> : Les valeurs de ce type désignent un ensemble de messages. Elles contiennent une liste de numéros de messages dans un ordre croissant, de 1 au nombre total de messages dans la boîte aux lettres. Les numéros sont séparés par des virgules ; un deux-points (:) indique un intervalle (inclusif) de numéros.
Examples: <code>2,4:7,9,12:*</code> is <code>2,4,5,6,7,9,12,13,14,15</code> for a mailbox with 15 messages.
<code>searchCriteria = 1:5 ANSWERED</code> recherche, parmi les messages 1 à 5, ceux qui comportent le marqueur \Answered.
<code>searchCriteria= 2,4 ANSWERED</code> recherche, parmi les messages 2 et 4, ceux qui comportent le marqueur \Answered.</p>
</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mots-clés-de-recherche-autorisés-1>Mots-clés de recherche autorisés<a href=#mots-clés-de-recherche-autorisés-1 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p><strong>ALL</strong>: Tous les messages dans la boîte de réception.<br>
<strong>ANSWERED</strong> : Messages avec l'indicateur \Answered activé.<br>
<strong>UNANSWERED</strong> : Messages pour lesquels l'indicateur \Answered n'est pas activé.<br>
<strong>DELETED</strong> : Messages dont l'indicateur \Deleted est activé.<br>
<strong>UNDELETED</strong> : Messages pour lesquels l'indicateur \Deleted n'a pas été activé.<br>
<strong>DRAFT</strong> : Messages dont l'indicateur \Draft est activé.<br>
<strong>UNDRAFT</strong> : Messages pour lesquels l'indicateur \Draft n'est pas activé.<br>
<strong>FLAGGED</strong> : Messages avec le drapeau \Flagged activé.<br>
<strong>UNFLAGGED</strong> : Messages pour lesquels l'indicateur \Flagged n'est pas activé.<br>
<strong>RECENT</strong> : Messages dont l'indicateur \Recent est activé.<br>
<strong>OLD</strong> : Messages pour lesquels l'indicateur \Recent n'a pas été activé.<br>
<strong>SEEN</strong> : Messages pour lesquels l'indicateur \Seen est activé.<br>
<strong>UNSEEN</strong> : Messages pour lesquels l'indicateur \Seen n'est pas activé.<br>
<strong>NOUVEAU</strong> : Messages pour lesquels l'indicateur \Recent est activé mais pas l'indicateur \Seen. Equivaut à “(RECENT UNSEEN)”.<br>
<strong>KEYWORD <em>flag</em></strong> : Messages avec le jeu de mots-clés spécifié.<br>
<strong>UNKEYWORD <em>flag</em></strong> : Messages ne contenant pas le mot-clé spécifié.<br>
<strong>BEFORE <em>date</em></strong> : Messages dont la date interne est antérieure à la date spécifiée.<br>
<strong>ON <em>date</em></strong> : Messages dont la date interne est comprise dans la date spécifiée.<br>
<strong>SINCE <em>date</em></strong> : Messages dont la date interne est antérieure ou postérieure à la date spécifiée.<br>
<strong>SENTBEFORE <em>date</em></strong> : Messages dont l'en-tête Date est antérieur à la date spécifiée.<br>
<strong>SENTON <em>date</em></strong> : Messages dont l'en-tête Date est compris dans la date spécifiée.<br>
<strong>SENTSINCE <em>date</em></strong> : Messages dont l'en-tête Date est inférieur ou supérieur à la date spécifiée.<br>
<strong>TO <em>string</em></strong> : Messages contenant la chaîne de caractères spécifiée dans l'en-tête TO.<br>
<strong>FROM <em>string</em></strong>: Messages contenant la chaîne spécifiée dans l’en-tête Emetteur.<br>
<strong>CC <em>string</em></strong> : Messages contenant la chaîne spécifiée dans l'en-tête CC.<br>
<strong>BCC <em>string</em></strong> : Messages contenant la chaîne spécifiée dans l'en-tête BCC.<br>
<strong>SUBJECT <em>string</em></strong> : Messages qui contiennent la chaîne spécifiée dans l'en-tête Subject .<br>
<strong>BODY <em>string</em></strong> : Messages qui contiennent la chaîne spécifiée dans le body du message.<br>
<strong>TEXT <em>chaîne</em></strong> : Messages contenant la chaîne spécifiée dans l'en-tête ou dans le corps du message.<br>
<strong>HEADER <em>field-name</em> <em>string</em></strong>: Messages qui ont un en-tête avec le nom de champ spécifié et qui contiennent la chaîne spécifiée dans le field-body.<br>
<strong>UID <em>message-UID</em></strong> : Messages avec des identifiants uniques correspondant au jeu d'identifiants uniques spécifié.<br>
<strong>LARGER <em>n</em></strong> : Messages dont la taille est supérieure au nombre d'octets spécifié.<br>
<strong>SMALLER <em>n</em></strong> : Messages dont la taille est inférieure au nombre d'octets spécifié.<br>
<strong>NOT <em>search-key</em></strong> : Messages ne correspondant pas à la clé de recherche spécifiée.<br>
<strong>OR <em>search-key1</em> <em>search-key2</em></strong> : Messages qui correspondent à l'un des deux mots clés de recherche.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=selectbox>.selectBox()<a href=#selectbox class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>20<td><em>id</em>, <em>flags</em>, <em>permanentFlags</em> sont renvoyés<tr><td>18 R4<td>Ajout</table>
</div></div></details>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>





























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la boîte de réception<tr><td>state<td>Integer<td style=text-align:center>-><td>Statut de l'accès à la boite de réception<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Objet boxInfo</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-28>Description<a href=#description-28 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.selectBox()</code> sélectionne la boîte de réception <em>name</em> comme boîte de réception courante. Cette fonction vous permet de récupérer des informations sur la boite de réception.</p>
<blockquote>
<p>Pour obtenir les informations d'une boîte aux lettres sans modifier la boîte aux lettres courante, utilisez <a href=#getboxinfo><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>Dans le paramètre optionnel <em>name</em> passez le nom de la boite de réception à laquelle vous souhaitez accéder. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. Le délimiteur peut être récupéré à l'aide de la fonction <a href=#getdelimiter><code>.getDelimiter()</code></a>.</p>
<p>Le paramètre optionnel <em>state</em> définit le type d'accès à la mailbox. Les valeurs possibles sont les suivantes :</p>




















<table><thead><tr><th>Constante<th>Valeur<th>Commentaire<tbody><tr><td>IMAP read only state<td>1<td>La mailbox sélectionnée est accessible avec les privilèges de lecture seule. Les messages contenant un marqueur "recent" (indication de nouveaux messages) restent inchangés.<tr><td>IMAP read write state<td>0<td>La mailbox sélectionnée est accessible avec des privilèges de lecture et d'écriture. Les messages sont considérés "seen" et perdent le marqueur "recent" (indication des nouveaux messages). (Valeur par défaut)</table>
<blockquote>
<ul>
<li>La fonction génère une erreur et retourne <strong>Null</strong> si <em>name</em> désigne une mailbox inexistante.</li>
<li>Si aucune connexion n'est ouverte, <code>.selectBox()</code> ouvrira une connexion.</li>
<li>Si la connexion n'a pas été utilisée depuis la durée maximale définie (voir <code>IMAP New transporter</code>), la fonction <a href=#checkconnection><code>.checkConnection()</code></a> est automatiquement appelée.</li>
</ul>
</blockquote>
<p><strong>Objet retourné</strong></p>
<p>L'objet <code>boxInfo</code> contient les propriété suivantes :</p>








































<table><thead><tr><th>Propriété<th>Type<th>Description<tbody><tr><td>name<td>Text<td>Nom de la boîte de réception<tr><td>mailCount<td>number<td>Nombre de messages contenus dans la boîte de réception<tr><td>mailRecent<td>number<td>Nombre de messages avec le marqueur "recent"<tr><td>id<td>text<td>Identifiant unique de la boîte aux lettres<tr><td>flags<td>text<td>Liste des flags actuellement utilisés pour la boîte aux lettres, séparés par des espaces<tr><td>permanentFlags<td>text<td>Liste des flags que le client peut modifier en permanence (à l'exception de l'indicateur \Recent, qui est géré par le serveur IMAP), séparés par des espaces</table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p>Si la chaîne <code>permanentFlags</code> comprend le flag spécial *, cela signifie que le serveur prend en charge <a href=#addflags>les flags personnalisés</a>.</div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-15>Exemple<a href=#exemple-15 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatoire</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=subscribe>.subscribe()<a href=#subscribe class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>19<td>Ajout</table>
</div></div></details>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la boîte de réception<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération subscribe</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-29>Description<a href=#description-29 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.subscribe()</code> permet d'ajouter la boîte spécifiée à l'ensemble des boîtes auxquelles vous avez "souscrit" sur le serveur IMAP. Ainsi, vous pouvez contrôler la taille de la liste des boîtes de réception disponibles en souscrivant uniquement à celles que vous souhaitez généralement consulter.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à ajouter (subscribe) à la liste de mailboxes auxquelles vous avez "souscrit".</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-16>Exemple<a href=#exemple-16 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour souscrire à la mailbox "Atlas Corp” dans la hiérarchie "Bills" :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox subscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=unsubscribe>.unsubscribe()<a href=#unsubscribe class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>19<td>Ajout</table>
</div></div></details>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Paramètres<th>Type<th style=text-align:center><th>Description<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nom de la boîte de réception<tr><td>Résultat<td>Object<td style=text-align:center>&lt;-<td>Statut de l'opération unsubscribe</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-30>Description<a href=#description-30 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La fonction <code>.unsubscribe()</code> supprime la boîte spécifiée de l'ensemble des boîtes auxquelles vous avez "souscrit". Elle vous permet de réduire le nombre de mailboxes que vous consultez régulièrement.</p>
<p>Dans le paramètre <code>name</code>, passez le nom de la mailbox à supprimer (unsubscribe) de la liste de mailboxes auxquelles vous avez "souscrit".</p>
<p><strong>Objet retourné</strong></p>
<p>La fonction retourne un objet décrivant le statut IMAP :</p>















































<table><thead><tr><th>Propriété<th><th>Type<th>Description<tbody><tr><td>success<td><td>Boolean<td>Vrai si l'opération est réussie, sinon Faux<tr><td>statusText<td><td>Text<td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d'erreurs 4D<tr><td>errors<td><td>Collection<td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)<tr><td><td>[].errcode<td>Number<td>Code d'erreur 4D<tr><td><td>[].message<td>Text<td>Description de l'erreur 4D<tr><td><td>[].componentSignature<td>Text<td>Signature du composant interne qui a retourné l'erreur</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemple-17>Exemple<a href=#exemple-17 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>Pour ne plus souscrire à la mailbox "Atlas Corp” dans la hiérarchie "Bills" :</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.unsubscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox unsubscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copier le code" title=Copier class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=user>.user<a href=#user class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historique</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Modifications<tbody><tr><td>17 R4<td>Ajout</table>
</div></div></details>
<p><strong>.user</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=description-31>Description<a href=#description-31 class=hash-link aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4>
<p>La propriété <code>.user</code> contient le nom d'utilisateur utilisé pour l'authentification sur le serveur de messagerie.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(20-R6)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Ecrire un commentaire sur cette page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagination des documents"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/fr/20-R6/API/HTTPRequestClass><div class=pagination-nav__sublabel>Précédent</div><div class=pagination-nav__label>HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/fr/20-R6/API/MailAttachmentClass><div class=pagination-nav__sublabel>Suivant</div><div class=pagination-nav__label>MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#objet-imap-transporter class="table-of-contents__link toc-highlight">Objet IMAP Transporter</a><li><a href=#imap-new-transporter class="table-of-contents__link toc-highlight">IMAP New transporter</a><li><a href=#4dimaptransporternew class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a><li><a href=#acceptunsecureconnection class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a><li><a href=#addflags class="table-of-contents__link toc-highlight">.addFlags()</a><li><a href=#append class="table-of-contents__link toc-highlight">.append()</a><li><a href=#authenticationmode class="table-of-contents__link toc-highlight">.authenticationMode</a><li><a href=#checkconnection class="table-of-contents__link toc-highlight">.checkConnection()</a><li><a href=#checkconnectiondelay class="table-of-contents__link toc-highlight">.checkConnectionDelay</a><li><a href=#connectiontimeout class="table-of-contents__link toc-highlight">.connectionTimeOut</a><li><a href=#copy class="table-of-contents__link toc-highlight">.copy()</a><li><a href=#createbox class="table-of-contents__link toc-highlight">.createBox()</a><li><a href=#delete class="table-of-contents__link toc-highlight">.delete()</a><li><a href=#deletebox class="table-of-contents__link toc-highlight">.deleteBox()</a><li><a href=#expunge class="table-of-contents__link toc-highlight">.expunge()</a><li><a href=#getboxinfo class="table-of-contents__link toc-highlight">.getBoxInfo()</a><li><a href=#getboxlist class="table-of-contents__link toc-highlight">.getBoxList()</a><li><a href=#getdelimiter class="table-of-contents__link toc-highlight">.getDelimiter()</a><li><a href=#getmail class="table-of-contents__link toc-highlight">.getMail()</a><li><a href=#getmails class="table-of-contents__link toc-highlight">.getMails()</a><li><a href=#getmimeasblob class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a><li><a href=#host class="table-of-contents__link toc-highlight">.host</a><li><a href=#logfile class="table-of-contents__link toc-highlight">.logFile</a><li><a href=#move class="table-of-contents__link toc-highlight">.move()</a><li><a href=#numtoid class="table-of-contents__link toc-highlight">.numToID()</a><li><a href=#removeflags class="table-of-contents__link toc-highlight">.removeFlags()</a><li><a href=#renamebox class="table-of-contents__link toc-highlight">.renameBox()</a><li><a href=#port class="table-of-contents__link toc-highlight">.port</a><li><a href=#searchmails class="table-of-contents__link toc-highlight">.searchMails()</a><li><a href=#selectbox class="table-of-contents__link toc-highlight">.selectBox()</a><li><a href=#subscribe class="table-of-contents__link toc-highlight">.subscribe()</a><li><a href=#unsubscribe class="table-of-contents__link toc-highlight">.unsubscribe()</a><li><a href=#user class="table-of-contents__link toc-highlight">.user</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Communauté</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://developer.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Developer Center</a><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://twitter.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="col footer__col"><div class=footer__title>Support</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (Où tout a commencé)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Knowledgebase</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>Téléchargements<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>Aide<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Société</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>A propos de 4D<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>Contacts<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>4D dans le monde<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Carrière<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2024 4D SAS - Tous droits réservés</div></div></div></footer></div>