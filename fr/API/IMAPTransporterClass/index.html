<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-20-R5 plugin-docs plugin-id-default docs-doc-id-API/IMAPTransporterClass">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">IMAPTransporter | 4D Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://4d.github.io/docs/fr/API/IMAPTransporterClass"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="20-R5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-20-R5"><meta data-rh="true" name="docsearch:version" content="20-R5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-20-R5"><meta data-rh="true" property="og:title" content="IMAPTransporter | 4D Docs"><meta data-rh="true" name="description" content="The IMAPTransporter class allows you to retrieve messages from a IMAP email server."><meta data-rh="true" property="og:description" content="The IMAPTransporter class allows you to retrieve messages from a IMAP email server."><link data-rh="true" rel="icon" href="/docs/fr/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://4d.github.io/docs/fr/API/IMAPTransporterClass"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/API/IMAPTransporterClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/fr/API/IMAPTransporterClass" hreflang="fr"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/es/API/IMAPTransporterClass" hreflang="es"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/ja/API/IMAPTransporterClass" hreflang="ja"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/pt/API/IMAPTransporterClass" hreflang="pt"><link data-rh="true" rel="alternate" href="https://4d.github.io/docs/API/IMAPTransporterClass" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJ04C0M3CU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/fr/opensearch.xml"><link rel="stylesheet" href="/docs/fr/assets/css/styles.abfcc139.css">
<link rel="preload" href="/docs/fr/assets/js/runtime~main.63ed9e6e.js" as="script">
<link rel="preload" href="/docs/fr/assets/js/main.d20a5138.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/fr/"><div class="navbar__logo"><img src="/docs/fr/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/fr/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/fr/GettingStarted/installation">20 R5 BETA</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/fr/API/IMAPTransporterClass">20 R5 BETA</a></li><li><a class="dropdown__link" href="/docs/fr/20-R4/API/IMAPTransporterClass">20 R4</a></li><li><a class="dropdown__link" href="/docs/fr/20/API/IMAPTransporterClass">20</a></li><li><a class="dropdown__link" href="/docs/fr/19/API/IMAPTransporterClass">19</a></li><li><a class="dropdown__link" href="/docs/fr/18/GettingStarted/installation">18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Français</a><ul class="dropdown__menu"><li><a href="/docs/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/fr/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="fr">Français</a></li><li><a href="/docs/es/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs/ja/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/docs/pt/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Rechercher"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Rechercher</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/docs/fr/"><img src="/docs/fr/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/fr/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>4D Documentation</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/fr/category/getting-started">Prise en main</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prise en main&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/fr/category/core-development">Développement</a><button aria-label="Toggle the collapsible sidebar category &#x27;Développement&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/fr/Project/overview">Gestion des projets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Gestion des projets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Project/code-overview">Environnement de développement</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/fr/ORDA/overview">ORDA</a><button aria-label="Toggle the collapsible sidebar category &#x27;ORDA&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/fr/Concepts/about">Langage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Concepts/about">Concepts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href="https://doc.4d.com/4Dv20R5/4D/20-R5/4D-Language-Reference.100-6817247.en.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Commandes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/fr/category/class-API-reference">Classes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Classes&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/overview">A propos des fonctions de classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/BlobClass">Blob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ClassClass">Classe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/CollectionClass">Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EntityClass">Entity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FileHandleClass">FileHandle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/FunctionClass">Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/HTTPRequestClass">HTTPRequest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/fr/API/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/POP3TransporterClass">POP3Transporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SMTPTransporterClass">SMTPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/SystemWorkerClass">SystemWorker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebFormClass">WebForm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebFormItemClass">WebFormItem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebSocketClass">WebSocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebSocketConnectionClass">WebSocketConnection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/WebSocketServerClass">WebSocketServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/API/ZipFolderClass">ZIPFolder</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/fr/Develop/processes">Process</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fr/Tags/transformation-tags">Balises de transformation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/fr/Preferences/overview">Préférences</a><button aria-label="Toggle the collapsible sidebar category &#x27;Préférences&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/fr/category/administration">Administration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Administration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/fr/Extensions/overview">Extensions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extensions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/fr/category/web-applications">Applications Web</a><button aria-label="Toggle the collapsible sidebar category &#x27;Applications Web&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/fr/category/desktop-applications">Applications Desktop</a><button aria-label="Toggle the collapsible sidebar category &#x27;Applications Desktop&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://developer.4d.com/go-mobile/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Applications mobiles</a></div></li></ul></nav><button type="button" title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d’accueil" class="breadcrumbs__link" href="/docs/fr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/fr/category/core-development"><span itemprop="name">Développement</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Langage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/fr/category/class-API-reference"><span itemprop="name">Classes</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">IMAPTransporter</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 20 R5 BETA</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>The <code>IMAPTransporter</code> class allows you to retrieve messages from a IMAP email server.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="objet-imap-transporter">Objet IMAP Transporter<a href="#objet-imap-transporter" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h3><p>IMAP Transporter objects are instantiated with the <a href="#imap-new-transporter">IMAP New transporter</a> command. Leurs propriétés et fonctions sont les suivantes :</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<strong>True</strong> if 4D is allowed to establish an unencrypted connection</td></tr><tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;adds flags to the <code>msgIDs</code> for the specified <code>keywords</code></td></tr><tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;appends a <code>mailObj</code> to the <code>destinationBox</code></td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the authentication mode used to open the session on the mail server</td></tr><tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp; checks the connection using information stored in the transporter object</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the maximum time (in seconds) allowed prior to checking the connection to the server</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the maximum wait time (in seconds) allowed to establish a connection to the server</td></tr><tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;copies the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr><tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;creates a mailbox with the given <code>name</code></td></tr><tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;sets the &quot;deleted&quot; flag for the messages defined in <code>msgsIDs</code> or <code>allMsgs</code></td></tr><tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;permanently removes the mailbox with the given <code>name</code> from the IMAP server</td></tr><tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;removes all messages with the &quot;deleted&quot; flag from the IMAP mail server.</td></tr><tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em></td></tr><tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns a collection of mailboxes describing all of the available mailboxes</td></tr><tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns the character used to delimit levels of hierarchy in the mailbox name</td></tr><tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns an object containing a collection of <code>Email</code> objects</td></tr><tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the name or the IP address of the host server</td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the path of the extended log file defined (if any) for the mail connection</td></tr><tr><td><a href="#move"><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr><tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em></td></tr><tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;removes flags from the <code>msgIDs</code> for the specified <code>keywords</code></td></tr><tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;changes the name of a mailbox on the IMAP server</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp; the port number used for mail transactions</td></tr><tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;searches for messages that match the given <em>searchCriteria</em> in the current mailbox</td></tr><tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;selects the <em>name</em> mailbox as the current mailbox</td></tr><tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes</td></tr><tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;removes a mailbox from a set of subscribed mailboxes</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp; the user name used for authentication on the mail server</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="imap-new-transporter">IMAP New transporter<a href="#imap-new-transporter" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td align="center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">IMAP transporter object</a></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description">Description<a href="#description" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>IMAP New transporter</code> command configures a new IMAP connection according to the <em>server</em> parameter and returns a new <em>transporter</em> object. L&#x27;objet transporteur retourné sera alors utilisé pour la réception d&#x27;emails.</p><p>In the <em>server</em> parameter, pass an object containing the following properties:</p><table><thead><tr><th><em>server</em></th><th>Valeur par défaut (si omise)</th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<strong>True</strong> if 4D is allowed to establish an unencrypted connection</td><td>False</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br>.<strong>accessTokenOAuth2</strong>: Object<br>Text string or token object representing OAuth2 authorization credentials. Used only with OAUTH2 <code>authenticationMode</code>. If <code>accessTokenOAuth2</code> is used but <code>authenticationMode</code> is omitted, the OAuth 2 protocol is used (if allowed by the server). Not returned in <em><a href="#imap-transporter-object">IMAP transporter</a></em> object.</td><td>aucun</td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the authentication mode used to open the session on the mail server</td><td>le mode d&#x27;authentification le plus sûr pris en charge par le serveur est utilisé</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the maximum time (in seconds) allowed prior to checking the connection to the server</td><td>300</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the maximum wait time (in seconds) allowed to establish a connection to the server</td><td>30</td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the name or the IP address of the host server</td><td><em>obligatoire</em></td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;the path of the extended log file defined (if any) for the mail connection</td><td>aucun</td></tr><tr><td>.<strong>password</strong> : Text<br>User password for authentication on the server. Not returned in <em><a href="#imap-transporter-object">IMAP transporter</a></em> object.</td><td>aucun</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp; the port number used for mail transactions</td><td>993</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a>&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp;<!-- -->&amp;<!-- -->nbsp; the user name used for authentication on the mail server</td><td>aucun</td></tr></tbody></table><blockquote><p><strong>Warning</strong>: Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless.</p></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat">Résultat<a href="#résultat" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The function returns an <a href="#imap-transporter-object"><strong>IMAP transporter object</strong></a>. All returned properties are <strong>read-only</strong>.</p><blockquote><p>La connexion IMAP est automatiquement fermée lorsque l&#x27;objet transporteur est détruit.</p></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple">Exemple<a href="#exemple" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.logFile:=&quot;LogTest.txt&quot; //log à sauvegarder dans le dossier Logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(Not($status.success))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;An error occurred: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4dimaptransporternew">4D.IMAPTransporter.new()<a href="#4dimaptransporternew" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td align="center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">IMAP transporter object</a></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-1">Description<a href="#description-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>4D.IMAPTransporter.new()</code> function creates and returns a new object of the <code>4D.IMAPTransporter</code> type. It is identical to the <a href="#imap-new-transporter"><code>IMAP New transporter</code></a> command (shortcut).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="acceptunsecureconnection">.acceptUnsecureConnection<a href="#acceptunsecureconnection" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-2">Description<a href="#description-2" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.acceptUnsecureConnection</code> property contains <strong>True</strong> if 4D is allowed to establish an unencrypted connection when encrypted connection is not possible.</p><p>It contains <strong>False</strong> if unencrypted connections are unallowed, in which case an error in returned when encrypted connection is not possible.</p><p>Ports sécurisés disponibles :</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur le prend en charge.</li></ul></li><li><p>IMAP</p><ul><li>143 : Port IMAP non chiffré</li><li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prend en charge</li></ul></li><li><p>POP3</p><ul><li>110 : Port POP3 non chiffré</li><li>995 : POP3 avec mise à niveau STARTTLS si le serveur le prend en charge.</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="addflags">.addFlags()<a href="#addflags" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>20</td><td>Prise en charge des mots-clés personnalisés (custom keywords)</td></tr><tr><td>18 R6</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d&#x27;un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td align="center">-&gt;</td><td>Mots-clés de flags à ajouter</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération addFlags</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-3">Description<a href="#description-3" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.addFlags()</code> function adds flags to the <code>msgIDs</code> for the specified <code>keywords</code>.</p><p>In the <code>msgIDs</code> parameter, you can pass either:</p><ul><li>a <em>collection</em> containing the unique IDs of specific messages or</li><li>the unique ID (<em>text</em>) of a single message or</li><li>the following constant (<em>longint</em>) for all messages in the selected mailbox:</li></ul><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table><p>The <code>keywords</code> parameter lets you define the flags to add to <code>msgIDs</code>. Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalisés (la prise en charge des flags personnalisés dépend de l&#x27;implémentation du serveur) :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;draft&quot; au message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;seen&quot; au message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;flagged&quot; au message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;answered&quot; au message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True pour ajouter le marqueur &quot;deleted&quot; au message</td></tr><tr><td><code>&lt;custom flag&gt;</code></td><td>Boolean</td><td>True pour ajouter le flag personnalisé au message</td></tr></tbody></table><p>Les noms des flags personnalisés doivent respecter cette règle : le mot-clé doit être une chaîne non sensible à la casse, excluant les caractères de contrôle et les espaces, et ne peut inclure aucun de ces caractères : <code>( ) { ] % * &quot; \</code></p><blockquote><ul><li>Pour qu&#x27;un mot-clé soit pris en compte, il doit être à vrai.</li><li>L&#x27;interprétation des indicateurs de mots-clés peut varier selon le client de messagerie.</li></ul></blockquote><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-1">Exemple<a href="#exemple-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Créer transporteur</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Sélectionner la boîte de messagerie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Marquer tous les messages de la boite de réception (INBOX) comme étant lus/vus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags[&quot;$seen&quot;]:=True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="append">.append()<a href="#append" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R6</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>mailObj</td><td>Object</td><td align="center">-&gt;</td><td>Objet email</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Mailbox devant recevoir l&#x27;objet email</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Objet contenant les informations de charset</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-4">Description<a href="#description-4" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.append()</code> function appends a <code>mailObj</code> to the <code>destinationBox</code>.</p><p>In the <code>mailObj</code> parameter, pass an Email object. For a comprehensive description of mail properties, see <a href="/docs/fr/API/EmailObjectClass#email-object">Email object</a>. The <code>.append()</code> function supports keyword tags in the Email object&#x27;s <code>keywords</code> attribute.</p><p>The optional <code>destinationBox</code> parameter lets you pass the name of a mailbox where the <code>mailObj</code> will be appended. S&#x27;il est omis, la mailbox courante sera utilisée.</p><p>In the optional <code>options</code> parameter, you can pass an object to define the charset and encoding for specific parts of the email. Propriétés disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset et encodage utilisés pour les parties de mail suivantes : le sujet, les noms de fichiers joints et le nom du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset et encodage utilisés pour le contenu html et le texte du body du mail. Valeurs possibles : voir le tableau des charsets possibles</td></tr></tbody></table><p>Charsets possibles :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; Quoted-printable if possible, otherwise UTF-8 &amp; Quoted-printable</li><li>bodyCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp; Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; Quoted-printable (<strong>valeur par défaut</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp;bodyCharset : US-ASCII si possible, sinon UTF-8 &amp; base64</td></tr></tbody></table><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-2">Exemple<a href="#exemple-2" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour enregistrer un email dans la boîte Drafts :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$settings:=New object(&quot;host&quot;; &quot;domain.com&quot;; &quot;user&quot;; &quot;xxxx&quot;; &quot;password&quot;; &quot;xxxx&quot;; &quot;port&quot;; 993)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.from:=&quot;xxxx@domain.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.subject:=&quot;Lorem Ipsum&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.textBody:=&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords[&quot;$seen&quot;]:=True//flag the message as read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords[&quot;$draft&quot;]:=True//flag the message as a draft</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$imap.append($msg; &quot;Drafts&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="authenticationmode">.authenticationMode<a href="#authenticationmode" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.authenticationMode</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-5">Description<a href="#description-5" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.authenticationMode</code> property contains the authentication mode used to open the session on the mail server.</p><p>Par défaut, le mode le plus sécurisé pris en charge par le serveur est utilisé.</p><p>Valeurs possibles :</p><table><thead><tr><th>Valeur</th><th>Constantes</th><th>Commentaire</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentification à l&#x27;aide du protocole CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentification à l&#x27;aide du protocole LOGIN</td></tr><tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentification à l&#x27;aide du protocole OAuth2</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentification à l&#x27;aide du protocole PLAIN</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checkconnection">.checkConnection()<a href="#checkconnection" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de la connexion de l&#x27;objet transporteur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-6">Description<a href="#description-6" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.checkConnection()</code> function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. Cette fonction vous permet de vérifier que les valeurs fournies par l&#x27;utilisateur sont valides et cohérentes.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="objet-retourné">Objet retourné<a href="#objet-retourné" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>La fonction envoie une requête au serveur de mail et retourne un objet décrivant le statut. Cet objet peut avoir les propriétés suivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Vrai si la vérification a été effectuée avec succès, sinon Faux</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP uniquement) Code du statut retourné par le serveur de messagerie (0 en cas de problème non lié au traitement du mail)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Message du statut retourné par le serveur de messagerie, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur de messagerie est reçue)</td></tr><tr><td></td><td>[<!-- --> ].errCode</td><td>number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- --> ].message</td><td>text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- --> ].componentSignature</td><td>text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checkconnectiondelay">.checkConnectionDelay<a href="#checkconnectiondelay" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-7">Description<a href="#description-7" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.checkConnectionDelay</code> property contains the maximum time (in seconds) allowed prior to checking the connection to the server.  Si cette durée est dépassée entre deux appels de méthodes, la connexion au serveur sera vérifiée. By default, if the property has not been set in the <em>server</em> object, the value is 300.</p><blockquote><p><strong>Warning</strong>: Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="connectiontimeout">.connectionTimeOut<a href="#connectiontimeout" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-8">Description<a href="#description-8" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.connectionTimeOut</code> property contains the maximum wait time (in seconds) allowed to establish a connection to the server. By default, if the property has not been set in the server object (used to create the transporter object with <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, or <code>IMAP New transporter</code>), the value is 30.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="copy">.copy()<a href="#copy" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: All messages in the selected mailbox</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Boîte de réception recevant les messages copiés</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de copie</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-9">Description<a href="#description-9" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.copy()</code> function copies the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p><p>Vous pouvez passer :</p><ul><li>in the <em>msgsIDs</em> parameter, a collection containing the unique IDs of the specific messages to copy, or</li><li>in the <em>allMsgs</em> parameter, the <code>IMAP all</code> constant (integer) to copy all messages in the selected mailbox.</li></ul><p>The <em>destinationBox</em> parameter allows you to pass a text value with the name of the mailbox where the copies of messages will be placed.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-1-1">Exemple 1<a href="#exemple-1-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour copier une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get collection of message unique IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // copy found messages to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.copy($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-2-1">Exemple 2<a href="#exemple-2-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour copier tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // copy all messages to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.copy(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="createbox">.createBox()<a href="#createbox" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>19</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la nouvelle mailbox</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de création de mailbox</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-10">Description<a href="#description-10" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.createBox()</code> function creates a mailbox with the given <code>name</code>. Si le caractère séparateur de hiérarchie du serveur IMAP apparaît dans le nom de la mailbox, le serveur IMAP créera tous les boîtes parentes nécessaires pour créer la boîte donnée.</p><p>Par exemple, si vous essayez de créer &quot;Projects/IMAP/Doc&quot; dans un serveur dont le &quot;/&quot; est le caractère séparateur de hiérarchie, les éléments suivants seront créés :</p><ul><li>Only the &quot;Doc&quot; mailbox if &quot;Projects&quot; &amp; &quot;IMAP&quot; already exist.</li><li>&quot;IMAP&quot; &amp; &quot;Doc&quot; mailboxes if only “Projects” already exists.</li><li>&quot;Projects&quot; &amp; “IMAP” &amp; &quot;Doc&quot; mailboxes, if they do not already exist.</li></ul><p>In the <code>name</code> parameter, pass the name of the new mailbox.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-3">Exemple<a href="#exemple-3" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour créer une nouvelle boîte “Invoices” :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.createBox(&quot;Invoices&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALERT(&quot;Mailbox creation successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="delete">.delete()<a href="#delete" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: All messages in the selected mailbox</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de suppression</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-11">Description<a href="#description-11" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.delete()</code> function sets the &quot;deleted&quot; flag for the messages defined in <code>msgsIDs</code> or <code>allMsgs</code>.</p><p>Vous pouvez passer :</p><ul><li>in the <code>msgsIDs</code> parameter, a collection containing the unique IDs of the specific messages to delete, or</li><li>in the <code>allMsgs</code> parameter, the <code>IMAP all</code> constant (integer) to delete all messages in the selected mailbox.</li></ul><p>L&#x27;exécution de cette fonction ne supprime pas réellement les messages. Messages with the &quot;delete&quot; flag can still be found by the <a href="#searchmails">.searchMails()</a> function. Flagged messages are deleted from the IMAP server with the <a href="#expunge"><code>.expunge()</code></a> function or by selecting another mailbox or when the <a href="#imap-transporter-object">transporter object</a> (created with <a href="#imap-new-transporter">IMAP New transporter</a>) is destroyed.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-1-2">Exemple 1<a href="#exemple-1-2" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour supprimer une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get collection of message unique IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;Reports\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Delete selected messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-2-2">Exemple 2<a href="#exemple-2-2" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour supprimer tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Junk Email&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // delete all messages in the current mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete(IMAP all)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deletebox">.deleteBox()<a href="#deletebox" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>19</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception à supprimer</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de suppression de boîte</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-12">Description<a href="#description-12" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.deleteBox()</code> function permanently removes the mailbox with the given <code>name</code> from the IMAP server. Si vous tentez de supprimer la boîte INBOX ou une boîte de réception qui n&#x27;existe pas, une erreur sera générée.</p><p>In the <code>name</code> parameter, pass the name of the mailbox to delete.</p><blockquote><ul><li>La fonction ne peut pas supprimer une boîte de réception contenant des boîtes &quot;enfant&quot; si la boîte &quot;parente&quot; dispose de l&#x27;attribute &quot;\Noselect&quot;.</li><li>Tous les messages présents dans la boîte seront également supprimés.</li><li>La possibilité de supprimer une boîte de réception dépend du serveur de messagerie.</li></ul></blockquote><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-4">Exemple<a href="#exemple-4" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Vous souhaitez supprimer la boîte enfant &quot;Nova Orion Industries&quot; à l&#x27;intérieur de la boîte &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// delete mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Nova Orion Industries&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;Mailbox deletion successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expunge">.expunge()<a href="#expunge" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R6</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération expunge</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-13">Description<a href="#description-13" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.expunge()</code> function removes all messages with the &quot;deleted&quot; flag from the IMAP mail server. The &quot;deleted&quot; flag can be set with the <a href="#delete"><code>.delete()</code></a> or <a href="#addflags"><code>.addFlags()</code></a> methods.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-5">Exemple<a href="#exemple-5" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $ids : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Creation du transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Sélection de la boîte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Chercher et sélectionner les messages lus dans INBOX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ids:=$transporter.searchMails(&quot;SEEN&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Purger tous les messages marqués deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getboxinfo">.getBoxInfo()<a href="#getboxinfo" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>20</td><td><em>id</em> is returned</td></tr><tr><td>18 R5</td><td><em>name</em> is optional</td></tr><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Objet boxInfo</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-14">Description<a href="#description-14" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getBoxInfo()</code> function returns a <code>boxInfo</code> object corresponding to the current maibox, or the mailbox <em>name</em>. This function returns the same information as <a href="#selectbox"><code>.selectBox()</code></a> without changing the current mailbox.</p><p>In the optional <em>name</em> parameter, pass the name of the mailbox to access. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. The delimiter can be found with the <a href="#getdelimiter"><code>.getDelimiter()</code></a> function.</p><p>If the mailbox <em>name</em> is not selectable or does not exist, the function generates an error and returns <strong>null</strong>.</p><p><strong>Returned object</strong></p><p>The <code>boxInfo</code> object returned contains the following properties:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>text</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages portant le marqueur &quot;récent&quot; (indiquant les nouveaux messages)</td></tr><tr><td>id</td><td>text</td><td>Identifiant unique de la boîte aux lettres</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-6">Exemple<a href="#exemple-6" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $info:=$transporter.getBoxInfo(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;INBOX contains &quot;+String($info.mailRecent)+&quot; recent emails.&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getboxlist">.getBoxList()<a href="#getboxlist" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr><tr><td>19</td><td>Add <code>isSubscribed</code> parameter</td></tr></tbody></table></div></div></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>parameters</td><td>Object</td><td align="center">-&gt;</td><td>Objet de paramètre</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;objets mailbox</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-15">Description<a href="#description-15" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getBoxList()</code> function returns a collection of mailboxes describing all of the available mailboxes. Cette fonction vous permet de gérer localement les listes de messages situés sur le serveur de messagerie IMAP.</p><p>In the optional <code>parameters</code> parameter, pass an object containing values to filter the returned mailboxes. Vous pouvez passer :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Boolean</td><td><li><strong>True</strong> to return only subscribed mailboxes</li><li> <strong>False</strong> to return all available mailboxes</li></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-1">Résultat<a href="#résultat-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Chaque objet de la collection retournée contient les propriétés suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[<!-- -->].name</td><td>text</td><td>Nom de la boîte de réception</td></tr><tr><td>[<!-- -->].selectable</td><td>boolean</td><td>Indicates whether or not the access rights allow the mailbox to be selected: <ul><li>true - the mailbox can be selected</li><li>false - the mailbox can not be selected</li></ul></td></tr><tr><td>[<!-- -->].inferior</td><td>boolean</td><td>Indicates whether or not the access rights allow creating a lower hierachy in the mailbox: <ul><li>true - a lower level can be created</li><li>false - a lower level can not be created</li></ul></td></tr><tr><td>[<!-- -->].interesting</td><td>boolean</td><td>Indicates if the mailbox has been marked &quot;interesting&quot; by the server: <ul><li>true - The mailbox has been marked &quot;interesting&quot; by the server. For example, it may contain new messages.</li><li>false - The mailbox has not been marked &quot;interesting&quot; by the server.</li></ul></td></tr></tbody></table><p>Si le compte ne contient pas de boites de réception, une collection vide est retournée.</p><blockquote><ul><li>If there is no open connection, <code>.getBoxList()</code> will open a connection.</li><li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <code>.checkConnection( )</code> function is automatically called.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-7">Exemple<a href="#exemple-7" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getdelimiter">.getDelimiter()<a href="#getdelimiter" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Text</td><td align="center">&lt;-</td><td>Caractère de délimitation de hiérarchie</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-16">Description<a href="#description-16" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getDelimiter()</code> function returns the character used to delimit levels of hierarchy in the mailbox name.</p><p>Le délimiteur est un caractère pouvant être utilisé pour :</p><ul><li>créer des boites de réception de niveau inférieur</li><li>rechercher des niveaux inférieurs ou supérieurs dans la hiérarchie de la boite de réception</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-2">Résultat<a href="#résultat-2" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Caractère de délimitation des noms de boites de réception.</p><blockquote><ul><li>If there is no open connection, <code>.getDelimiter()</code> will open a connection.</li><li>If the connection has not been used since the <a href="#checkconnectiondelay">designated connection delay</a>, the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-8">Exemple<a href="#exemple-8" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmail">.getMail()<a href="#getmail" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID unique du message</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td><a href="/docs/fr/API/EmailObjectClass#email-object">Email object</a></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-17">Description<a href="#description-17" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getMail()</code> function returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>. Cette fonction vous permet de gérer localement le contenu de l&#x27;email.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li></ul><p>The optional <em>options</em> parameter allows you pass an object defining additional instructions for handling the message. Les propriétés suivantes sont disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>boolean</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message n&#x27;est pas marqué comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>boolean</td><td>Passez Vrai pour retourner le corps du message. Si Faux, seul l&#x27;en-tête du message est retourné. Valeur par défaut : Vrai</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns <strong>Null</strong> if <em>msgID</em> designates a non-existing message,</li><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> function, an error is generated,</li><li>If there is no open connection, <code>.getMail()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>`<!-- -->.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-3">Résultat<a href="#résultat-3" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p><code>.getMail()</code> returns an <a href="/docs/fr/API/EmailObjectClass#email-object"><code>Email</code> object</a> with the following specific IMAP properties: <em>id</em>, <em>receivedAt</em>, and <em>size</em>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-9">Exemple<a href="#exemple-9" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Vous souhaitez lire le message avec ID = 1 :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get Email object with ID 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmails">.getMails()<a href="#getmails" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>ids</td><td>Collection</td><td align="center">-&gt;</td><td>Collection d&#x27;identifiants de messages</td></tr><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>options</td><td>Object</td><td align="center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Object containing:<br><ul><li>a collection of <a href="/docs/fr/API/EmailObjectClass#email-object">Email objects</a> and</li><li>a collection of IDs or numbers for missing messages, if any</li></ul></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-18">Description<a href="#description-18" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getMails()</code> function returns an object containing a collection of <code>Email</code> objects.</p><p><strong>First Syntax:</strong></p><p><em><strong>.getMails( ids { ; options } ) -&gt; result</strong></em></p><p>La première syntaxe vous permet de récupérer des messages en fonction de leurs identifiants.</p><p>In the <em>ids</em> parameter, pass a collection of IDs for the messages to return. You can get the IDs with <a href="#getmail"><code>.getMail()</code></a>.</p><p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned. See the <strong>Options</strong> table below for a description of the available properties.</p><p><strong>Second syntax:</strong></p><p><em><strong>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</strong></em></p><p>La deuxième syntaxe vous permet de récupérer des messages en fonction d&#x27;une plage séquentielle. Les valeurs passées représentent la position des messages dans la boite de réception.</p><p>In the <em>startMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p><p>In the <em>endMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p><p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned.</p><p><strong>Options</strong></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>Boolean</td><td>Si Vrai, les messages sont marqués comme &quot;seen&quot; (lus) dans la boite de réception. Si Faux, les messages ne sont pas marqués comme &quot;seen&quot;. Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>Boolean</td><td>Passez Vrai pour retourner le corps des messages spécifiés. Si Faux, seuls les en-tête des messages sont retournés. Valeur par défaut : Vrai</td></tr></tbody></table><blockquote><ul><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated.</li><li>If there is no open connection, <code>.getMails()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-4">Résultat<a href="#résultat-4" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p><code>.getMails()</code> returns an object containing the following collections:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>liste</td><td>Collection</td><td>Collection of <a href="/docs/fr/API/EmailObjectClass#email-object"><code>Email</code> objects</a>. Si aucun objet Email n&#x27;est trouvé, une collection vide est retournée.</td></tr><tr><td>notFound</td><td>Collection</td><td>Collection of:<br><ul><li>first syntax - previously passed message IDs that do not exist</li><li>second syntax - sequence numbers of messages between startMsg and endMsg that do not exist</li></ul>An empty collection is returned if all messages are found.</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-10">Exemple<a href="#exemple-10" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Vous souhaitez récupérer les 20 emails les plus récents sans modifier le statut &quot;seen&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  If($boxInfo.mailCount&gt;0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     New object(&quot;withBody&quot;;False;&quot;updateSeen&quot;;False))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For each($mail;$result.list)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End for each</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmimeasblob">.getMIMEAsBlob()<a href="#getmimeasblob" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID unique du message</td></tr><tr><td>updateSeen</td><td>Boolean</td><td align="center">-&gt;</td><td>Si Vrai, le message est marqué comme &quot;seen&quot; (lu) dans la boite de réception. Si Faux, le message demeure inchangé.</td></tr><tr><td>Résultat</td><td>BLOB</td><td align="center">&lt;-</td><td>Blob de la chaine MIME retournée par le serveur mail</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-19">Description<a href="#description-19" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.getMIMEAsBlob()</code> function returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li></ul><p>The optional <em>updateSeen</em> parameter allows you to specify if the message is marked as &quot;seen&quot; in the mailbox. Vous pouvez passer :</p><ul><li><strong>True</strong> - to mark the message as &quot;seen&quot; (indicating the message has been read)</li><li><strong>False</strong> - to leave the message&#x27;s &quot;seen&quot; status untouched</li></ul><blockquote><ul><li>The function returns an empty BLOB if <em>msgNumber</em> or msgID<!-- -->*<!-- --> designates a non-existing message,</li><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated,</li><li>If there is no open connection, <code>.getMIMEAsBlob()</code> will open a connection the last mailbox specified with <code>.selectBox()</code>.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-5">Résultat<a href="#résultat-5" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p><code>.getMIMEAsBlob()</code> returns a <code>BLOB</code> which can be archived in a database or converted to an <a href="/docs/fr/API/EmailObjectClass#email-object"><code>Email</code> object</a> with the <code>MAIL Convert from MIME</code> command.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-11">Exemple<a href="#exemple-11" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $boxInfo : Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $blob : Blob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get BLOB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="host">.host<a href="#host" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.host</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-20">Description<a href="#description-20" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.host</code> property contains the name or the IP address of the host server. Utilisée pour les échanges de courrier (SMTP, POP3, IMAP).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="logfile">.logFile<a href="#logfile" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.logFile</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-21">Description<a href="#description-21" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.logFile</code> property contains the path of the extended log file defined (if any) for the mail connection. Le chemin peut être relatif (au dossier Logs courant) ou absolu.</p><p>Unlike regular log files (enabled via the <code>SET DATABASE PARAMETER</code> command), extended log files store MIME contents of all sent mails and do not have any size limit. Pour plus d&#x27;informations sur les fichiers log étendus, reportez-vous à :</p><ul><li><strong>SMTP connections</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>POP3 connections</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>IMAP connections</strong> - <a href="/docs/fr/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="move">.move()<a href="#move" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Collection d&#x27;IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: All messages in the selected mailbox</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Boîte de réception recevant les messages déplacés</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération de déplacement</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-22">Description<a href="#description-22" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.move()</code> function moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p><p>Vous pouvez passer :</p><ul><li>in the <em>msgsIDs</em> parameter, a collection containing the unique IDs of the specific messages to move, or</li><li>in the <em>allMsgs</em> parameter, the <code>IMAP all</code> constant (integer) to move all messages in the selected mailbox.</li></ul><p>The <em>destinationBox</em> parameter allows you to pass a text value with the name of the mailbox where the messages will be moved.</p><blockquote><p>This function is only supported by IMAP servers compliant with RFC <a href="https://tools.ietf.org/html/rfc8474" target="_blank" rel="noopener noreferrer">8474</a>.</p></blockquote><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-1-3">Exemple 1<a href="#exemple-1-3" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour déplacer une sélection de messages :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get collection of message unique IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Move found messages from the current mailbox to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.move($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-2-3">Exemple 2<a href="#exemple-2-3" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour déplacer tous les messages de la boîte de réception courante :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // move all messages in the current mailbox to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.move(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="numtoid">.numToID()<a href="#numtoid" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection d&#x27;identifiants de messages uniques</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-23">Description<a href="#description-23" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.numToID()</code> function converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em> in the currently selected mailbox.</p><p>In the <em>startMsg</em> parameter, pass an integer value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p><p>In the <em>endMsg</em> parameter, pass an integer value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="résultat-6">Résultat<a href="#résultat-6" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>La fonction retourne une collection de chaînes (IDs uniques).</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-12">Exemple<a href="#exemple-12" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get IDs for 5 last messages received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //delete the messages from the current mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="removeflags">.removeFlags()<a href="#removeflags" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>20</td><td>Prise en charge des mots-clés personnalisés (custom keywords)</td></tr><tr><td>18 R6</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br>Texte : ID unique d&#x27;un message<br>Numérique (IMAP all) : Tous les messages de la boîte sélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td align="center">-&gt;</td><td>Mots-clés de flags à supprimer</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération removeFlags</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-24">Description<a href="#description-24" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.removeFlags()</code> function removes flags from the <code>msgIDs</code> for the specified <code>keywords</code>.</p><p>In the <code>msgIDs</code> parameter, you can pass either:</p><ul><li>a <em>collection</em> containing the unique IDs of specific messages or</li><li>the unique ID (<em>text</em>) of a single message or</li><li>the following constant (<em>longint</em>) for all messages in the selected mailbox:</li></ul><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table><p>The <code>keywords</code> parameter lets you define the flags to remove from <code>msgIDs</code>. Vous pouvez utiliser les flags standard suivants ainsi que des flags personnalisés :</p><table><thead><tr><th>Paramètres</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;draft&quot; du message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;seen&quot; du message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;flagged&quot; du message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;answered&quot; du message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True pour supprimer le marqueur &quot;deleted&quot; du message</td></tr><tr><td><code>&lt;custom flag&gt;</code></td><td>Boolean</td><td>True pour supprimer le flag personnalisé du message</td></tr></tbody></table><p>Please refer to <a href="#addflags">.addFlags()</a> for more information on custom flags.</p><blockquote><ul><li>Pour qu&#x27;un mot-clé soit pris en compte, il doit être à vrai.</li></ul></blockquote><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-13">Exemple<a href="#exemple-13" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// renommer la boite de réception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.renameBox(&quot;Invoices&quot;; &quot;Bills&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox renaming successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="renamebox">.renameBox()<a href="#renamebox" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>19</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>currentName</td><td>Text</td><td align="center">-&gt;</td><td>Nom actuel de la boîte de réception</td></tr><tr><td>nouveauNom</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la nouvelle mailbox</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération renaming</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-25">Description<a href="#description-25" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.renameBox()</code> function changes the name of a mailbox on the IMAP server. Essayer de renommer une mailbox qui n&#x27;existe pas ou de renommer une mailbox avec un nom qui est déjà utilisé génère une erreur.</p><p>In the <code>currentName</code> parameter, pass the name of the mailbox to be renamed.</p><p>Pass the new name for the mailbox in the <code>newName</code> parameter.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-14">Exemple<a href="#exemple-14" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour renommer la mailbox “Invoices” en “Bills”:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// rename mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.renameBox(&quot;Invoices&quot;; &quot;Bills&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox renaming successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="port">.port<a href="#port" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.port</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-26">Description<a href="#description-26" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.port</code> property contains  the port number used for mail transactions. By default, if the <em>port</em> property has not been set in the <em>server</em> object (used to create the transporter object with <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), the port used is:</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="searchmails">.searchMails()<a href="#searchmails" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>18 R5</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Text</td><td align="center">-&gt;</td><td>Critère(s) de recherche</td></tr><tr><td>Résultat</td><td>Collection</td><td align="center">&lt;-</td><td>Collection de numéros de messages</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-27">Description<a href="#description-27" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><blockquote><p>This function is based upon the specification for the <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol" target="_blank" rel="noopener noreferrer">IMAP protocol</a>.</p></blockquote><p>The <code>.searchMails()</code> function searches for messages that match the given <em>searchCriteria</em> in the current mailbox. <em>searchCriteria</em> consists of one or more search keys.</p><p><em>searchCriteria</em> is a text parameter listing one or more search keys (see <a href="#authorized-search-keys">Authorized search-keys</a> below) associated or not with values to look for. Un critère de recherche peut être composé d&#x27;un ou plusieurs éléments. Par exemple :</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SearchKey1 = FLAGGED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SearchKey2 = NOT FLAGGED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>La correspondance n&#x27;est généralement pas sensible à la casse</p></blockquote><ul><li>If the <em>searchCriteria</em> is a null string, the search will be equivalent to a “select all”.</li><li>If the <em>searchCriteria</em> includes multiple search keys, the result is the intersection (AND function) of all the messages that match those keys.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = FLAGGED FROM &quot;SMITH&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns all messages with \Flagged flag set AND sent by Smith.</p><ul><li>You can use the <strong>OR</strong> or <strong>NOT</strong> operators as follows:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne tous les messages comportant le marqueur \Seen OU \Flagged</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne tous les messages ne comportant pas le marqueur \Seen.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot; NOT HEADER CONTENT-TYPE &quot;TEXT&quot;...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne les messages dont l&#x27;en-tête content-type contient “Mixed” et ne contient pas “Text”.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;E&quot; NOT SUBJECT &quot;o&quot; NOT HEADER CONTENT-TYPE &quot;MIXED&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... retourne les messages dont l&#x27;en-tête content-type contient “ e ” et dont l&#x27;en-tête Subject ne contient pas “ o ” et dont l&#x27;en-tête content-type n&#x27;est pas “ Mixed ”.</p><p>A noter que dans les deux derniers exemples, le résultat de la recherche est différent lorsque vous enlevez les parenthèses de la première liste de mots-clés.</p><ul><li>The <em>searchCriteria</em> may include the optional <!-- -->[<!-- -->CHARSET] specification. Cette instruction est composée du mot &quot;CHARSET&quot; suivi d&#x27;un jeu de caractères défini <!-- -->[<!-- -->CHARSET] (US ASCII, ISO-8859). It indicates the charset of the <em>searchCriteria</em> string. Therefore, you must convert the <em>searchCriteria</em> string into the specified charset if you use the <!-- -->[<!-- -->CHARSET] specification (see the <code>CONVERT FROM TEXT</code> or <code>Convert to text</code> commands).
Par défaut, 4D encode la chaîne de critères searchCriteria en &quot;Quotable Printable&quot; si elle contient des caractères étendus.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = CHARSET &quot;ISO-8859&quot; BODY &quot;Help&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... means the search criteria uses the charset iso-8859 and the server will have to convert the search criteria before searching, if necessary.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mots-clés-de-recherche-autorisés">Mots-clés de recherche autorisés<a href="#mots-clés-de-recherche-autorisés" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Les mots-clés de recherche peuvent traiter des valeurs des types suivants :</p><ul><li><p><strong>Search-keys with a date value</strong>: the date is a string that must be formatted as follows: <em>date-day+&quot;-&quot;+date-month+&quot;-&quot;+date-year</em> where date-day indicates the number of the day of the month (max. 2 characters), date-month indicates the name of the month (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) and date-year indicates the year (4 characters).
Example: <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (a date does not usually need to be quoted since it does not contain any special characters)</p></li><li><p><strong>Search-keys with a string value</strong>: the string may contain any character and must be quoted. Toutefois, si la chaîne ne contient pas de caractères spéciaux (des espaces par exemple), les guillemets ne sont pas obligatoires. Dans tous les cas, les guillemets vous permettent de vous assurer que la chaîne sera correctement interprétée.
Example: <code>searchCriteria = FROM &quot;SMITH&quot;</code>
For all search keys that use strings, a message matches the key if the string is a substring of the field. La recherche ne tient pas compte de la casse des caractères.</p></li><li><p><strong>Search-keys with a field-name value</strong>: the field-name is the name of a header field.
Example: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li><li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces.
Example: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Search-keys with a message set value</strong>: Identifies a set of messages. Elles contiennent une liste de numéros de messages dans un ordre croissant, de 1 au nombre total de messages dans la boîte aux lettres. Les numéros sont séparés par des virgules ; un deux-points (:) indique un intervalle (inclusif) de numéros.
Examples:
<code>2,4:7,9,12:*</code> is <code>2,4,5,6,7,9,12,13,14,15</code> for a mailbox with 15 messages.
<code>searchCriteria = 1:5 ANSWERED</code> search in message selection from message sequence number 1 to 5 for messages which have the \Answered flag set.
<code>searchCriteria= 2,4 ANSWERED</code> search in the message selection (message numbers 2 and 4) for messages which have the \Answered flag set.</p></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mots-clés-de-recherche-autorisés-1">Mots-clés de recherche autorisés<a href="#mots-clés-de-recherche-autorisés-1" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p><strong>ALL</strong>: All messages in the mailbox.\
<strong>ANSWERED</strong>: Messages with the \Answered flag set.\
<strong>UNANSWERED</strong>: Messages that do not have the \Answered flag set.\
<strong>DELETED</strong>: Messages with the \Deleted flag set.\
<strong>UNDELETED</strong>: Messages that do not have the \Deleted flag set.\
<strong>DRAFT</strong>: Messages with the \Draft flag set.\
<strong>UNDRAFT</strong>: Messages that do not have the \Draft flag set.\
<strong>FLAGGED</strong>: Messages with the \Flagged flag set.\
<strong>UNFLAGGED</strong>: Messages that do not have the \Flagged flag set.\
<strong>RECENT</strong>: Messages that have the \Recent flag set.\
<strong>OLD</strong>: Messages that do not have the \Recent flag set.\
<strong>SEEN</strong>: Messages that have the \Seen flag set.\
<strong>UNSEEN</strong>: Messages that do not have the \Seen flag set.\
<strong>NEW</strong>: Messages that have the \Recent flag set but not the \Seen flag. Equivaut à “(RECENT UNSEEN)”.\
<strong>KEYWORD <em>flag</em></strong>: Messages with the specified keyword set.\
<strong>UNKEYWORD <em>flag</em></strong>: Messages that do not have the specified keyword set.\
<strong>BEFORE <em>date</em></strong>: Messages whose internal date is earlier than the specified date.\
<strong>ON <em>date</em></strong>: Messages whose internal date is within the specified date.\
<strong>SINCE <em>date</em></strong>: Messages whose internal date is within or later than the specified date.\
<strong>SENTBEFORE <em>date</em></strong>: Messages whose Date header is earlier than the specified date.\
<strong>SENTON <em>date</em></strong>: Messages whose Date header is within the specified date.\
<strong>SENTSINCE <em>date</em></strong>: Messages whose Date header is within or later than the specified date.\
<strong>TO <em>string</em></strong>: Messages that contain the specified string in the TO header.\
<strong>FROM <em>string</em></strong>: Messages that contain the specified string in the FROM header.\
<strong>CC <em>string</em></strong>: Messages that contain the specified string in the CC header.\
<strong>BCC <em>string</em></strong>: Messages that contain the specified string in the BCC header.\
<strong>SUBJECT <em>string</em></strong>: Messages that contain the specified string in the Subject header.\
<strong>BODY <em>string</em></strong>: Messages that contain the specified string in the message body.\
<strong>TEXT <em>string</em></strong>: Messages that contain the specified string in the header or in the message body.\
<strong>HEADER <em>field-name</em> <em>string</em></strong>: Messages that have a header with the specified field-name and that contain the specified string in the field-body.\
<strong>UID <em>message-UID</em></strong>: Messages with unique identifiers corresponding to the specified unique identifier set.\
<strong>LARGER <em>n</em></strong>: Messages with a size larger than the specified number of bytes.\
<strong>SMALLER <em>n</em></strong>: Messages with a size smaller than the specified number of bytes.\
<strong>NOT <em>search-key</em></strong>: Messages that do not match the specified search key.\
<strong>OR <em>search-key1</em> <em>search-key2</em></strong>: Messages that match either search key.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="selectbox">.selectBox()<a href="#selectbox" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>20</td><td><em>id</em>, <em>flags</em>, <em>permanentFlags</em> are returned</td></tr><tr><td>18 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>state</td><td>Integer</td><td align="center">-&gt;</td><td>Statut de l&#x27;accès à la boite de réception</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Objet boxInfo</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-28">Description<a href="#description-28" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.selectBox()</code> function selects the <em>name</em> mailbox as the current mailbox. Cette fonction vous permet de récupérer des informations sur la boite de réception.</p><blockquote><p>To get the information from a mailbox without changing the current mailbox, use <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>In the <em>name</em> parameter, pass the name of the mailbox to access. Le nom doit représenter une hiérarchie claire, de gauche à droite, avec des niveaux séparés par un caractère délimiteur spécifique. The delimiter can be found with the <a href="#getdelimiter"><code>.getDelimiter()</code></a> function.</p><p>The optional <em>state</em> parameter defines the type of access to the mailbox. Les valeurs possibles sont les suivantes :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>La mailbox sélectionnée est accessible avec les privilèges de lecture seule. Les messages contenant un marqueur &quot;recent&quot; (indication de nouveaux messages) restent inchangés.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>La mailbox sélectionnée est accessible avec des privilèges de lecture et d&#x27;écriture. Les messages sont considérés &quot;seen&quot; et perdent le marqueur &quot;recent&quot; (indication des nouveaux messages). (Valeur par défaut)</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns <strong>Null</strong> if <em>name</em> designates a non-existing mailbox.</li><li>If there is no open connection, <code>.selectBox()</code> will open a connection.</li><li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li></ul></blockquote><p><strong>Returned object</strong></p><p>The <code>boxInfo</code> object returned contains the following properties:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages avec le marqueur &quot;recent&quot;</td></tr><tr><td>id</td><td>text</td><td>Identifiant unique de la boîte aux lettres</td></tr><tr><td>flags</td><td>text</td><td>Liste des flags actuellement utilisés pour la boîte aux lettres, séparés par des espaces</td></tr><tr><td>permanentFlags</td><td>text</td><td>Liste des flags que le client peut modifier en permanence (à l&#x27;exception de l&#x27;indicateur \Recent, qui est géré par le serveur IMAP), séparés par des espaces</td></tr></tbody></table><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>If <code>permanentFlags</code> string includes the special flag <!-- -->*<!-- -->, it means that the server supports <a href="#addflags">custom flags</a>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-15">Exemple<a href="#exemple-15" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obligatoire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="subscribe">.subscribe()<a href="#subscribe" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>19</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération subscribe</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-29">Description<a href="#description-29" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.subscribe()</code> function allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes. Ainsi, vous pouvez contrôler la taille de la liste des boîtes de réception disponibles en souscrivant uniquement à celles que vous souhaitez généralement consulter.</p><p>In the <code>name</code> parameter, pass the name of the mailbox to add (subscribe) to your &quot;subscribed&quot; mailboxes.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-16">Exemple<a href="#exemple-16" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox subscription successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unsubscribe">.unsubscribe()<a href="#unsubscribe" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>19</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td align="center">&lt;-</td><td>Statut de l&#x27;opération unsubscribe</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-30">Description<a href="#description-30" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.unsubscribe()</code> function removes a mailbox from a set of subscribed mailboxes. Elle vous permet de réduire le nombre de mailboxes que vous consultez régulièrement.</p><p>In the <code>name</code> parameter, pass the name of the mailbox to remove (unsubscribe) from your active mailboxes.</p><p><strong>Returned object</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l&#x27;opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernière erreur retournée dans la pile d&#x27;erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d&#x27;erreurs 4D (non retournée si une réponse du serveur IMAP est reçue)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Number</td><td>Code d&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Description de l&#x27;erreur 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l&#x27;erreur</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemple-17">Exemple<a href="#exemple-17" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>Pour ne plus souscrire à la mailbox &quot;Atlas Corp” dans la hiérarchie &quot;Bills&quot; :</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.unsubscribe($name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox unsubscription successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user">.user<a href="#user" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Historique</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Release</th><th>Modifications</th></tr></thead><tbody><tr><td>17 R4</td><td>Ajout</td></tr></tbody></table></div></div></details><p><strong>.user</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="description-31">Description<a href="#description-31" class="hash-link" aria-label="Lien direct vers le titre" title="Lien direct vers le titre">​</a></h4><p>The <code>.user</code> property contains  the user name used for authentication on the mail server.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(20-R5)&amp;body=Please%20enter%20your%20comment%3A" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Ecrire un commentaire sur cette page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagination des documents"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/fr/API/HTTPRequestClass"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/fr/API/MailAttachmentClass"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objet-imap-transporter" class="table-of-contents__link toc-highlight">Objet IMAP Transporter</a></li><li><a href="#imap-new-transporter" class="table-of-contents__link toc-highlight">IMAP New transporter</a></li><li><a href="#4dimaptransporternew" class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection" class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a></li><li><a href="#addflags" class="table-of-contents__link toc-highlight">.addFlags()</a></li><li><a href="#append" class="table-of-contents__link toc-highlight">.append()</a></li><li><a href="#authenticationmode" class="table-of-contents__link toc-highlight">.authenticationMode</a></li><li><a href="#checkconnection" class="table-of-contents__link toc-highlight">.checkConnection()</a></li><li><a href="#checkconnectiondelay" class="table-of-contents__link toc-highlight">.checkConnectionDelay</a></li><li><a href="#connectiontimeout" class="table-of-contents__link toc-highlight">.connectionTimeOut</a></li><li><a href="#copy" class="table-of-contents__link toc-highlight">.copy()</a></li><li><a href="#createbox" class="table-of-contents__link toc-highlight">.createBox()</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">.delete()</a></li><li><a href="#deletebox" class="table-of-contents__link toc-highlight">.deleteBox()</a></li><li><a href="#expunge" class="table-of-contents__link toc-highlight">.expunge()</a></li><li><a href="#getboxinfo" class="table-of-contents__link toc-highlight">.getBoxInfo()</a></li><li><a href="#getboxlist" class="table-of-contents__link toc-highlight">.getBoxList()</a></li><li><a href="#getdelimiter" class="table-of-contents__link toc-highlight">.getDelimiter()</a></li><li><a href="#getmail" class="table-of-contents__link toc-highlight">.getMail()</a></li><li><a href="#getmails" class="table-of-contents__link toc-highlight">.getMails()</a></li><li><a href="#getmimeasblob" class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a></li><li><a href="#host" class="table-of-contents__link toc-highlight">.host</a></li><li><a href="#logfile" class="table-of-contents__link toc-highlight">.logFile</a></li><li><a href="#move" class="table-of-contents__link toc-highlight">.move()</a></li><li><a href="#numtoid" class="table-of-contents__link toc-highlight">.numToID()</a></li><li><a href="#removeflags" class="table-of-contents__link toc-highlight">.removeFlags()</a></li><li><a href="#renamebox" class="table-of-contents__link toc-highlight">.renameBox()</a></li><li><a href="#port" class="table-of-contents__link toc-highlight">.port</a></li><li><a href="#searchmails" class="table-of-contents__link toc-highlight">.searchMails()</a></li><li><a href="#selectbox" class="table-of-contents__link toc-highlight">.selectBox()</a></li><li><a href="#subscribe" class="table-of-contents__link toc-highlight">.subscribe()</a></li><li><a href="#unsubscribe" class="table-of-contents__link toc-highlight">.unsubscribe()</a></li><li><a href="#user" class="table-of-contents__link toc-highlight">.user</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Communauté</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Developer Center</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (Where It All Began)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Knowledgebase</a></li><li class="footer__item"><a href="https://us.4d.com/product-download/Feature-Release" target="_blank" rel="noopener noreferrer" class="footer__link-item">Téléchargements<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Aide<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Société</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">A propos de 4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contacts<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D dans le monde<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Carrière<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/fr/assets/js/runtime~main.63ed9e6e.js"></script>
<script src="/docs/fr/assets/js/main.d20a5138.js"></script>
</body>
</html>