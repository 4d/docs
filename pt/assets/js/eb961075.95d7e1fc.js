"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["29105"],{509790:function(e,n,o){o.r(n),o.d(n,{default:()=>p,frontMatter:()=>i,metadata:()=>r,assets:()=>t,toc:()=>l,contentTitle:()=>d});var r=JSON.parse('{"id":"WritePro/commands-legacy/wp-get-position","title":"WP Get position","description":"WP Get position ( objRange {; layout} ) -> Resultado","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R8/WritePro/commands-legacy/wp-get-position.md","sourceDirName":"WritePro/commands-legacy","slug":"/WritePro/commands/wp-get-position","permalink":"/docs/pt/WritePro/commands/wp-get-position","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WritePro%2Fcommands-legacy%2Fwp-get-position.md%20(20-R8)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R8","frontMatter":{"id":"wp-get-position","title":"WP Get position","slug":"/WritePro/commands/wp-get-position","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"WP Get page count","permalink":"/docs/pt/WritePro/commands/wp-get-page-count"},"next":{"title":"WP Get section","permalink":"/docs/pt/WritePro/commands/wp-get-section"}}'),a=o("785893"),s=o("250065");let i={id:"wp-get-position",title:"WP Get position",slug:"/WritePro/commands/wp-get-position",displayed_sidebar:"docs"},d=void 0,t={},l=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:2},{value:"Exemplo 1",id:"exemplo-1",level:2},{value:"Exemplo 2",id:"exemplo-2",level:2},{value:"Exemplo 3",id:"exemplo-3",level:2},{value:"Exemplo 4",id:"exemplo-4",level:2},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:2}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WP Get position"})," ( ",(0,a.jsx)(n.em,{children:"objRange"})," {; ",(0,a.jsx)(n.em,{children:"layout"}),"} ) -> Resultado"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Par\xe2metro"}),(0,a.jsx)(n.th,{children:"Tipo"}),(0,a.jsx)(n.th,{}),(0,a.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"objRange"}),(0,a.jsx)(n.td,{children:"Object"}),(0,a.jsx)(n.td,{children:"\u2192"}),(0,a.jsx)(n.td,{children:"Elemento ou range ou documento 4D Write |Pro"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"layout"}),(0,a.jsx)(n.td,{children:"Integer"}),(0,a.jsx)(n.td,{children:"\u2192"}),(0,a.jsx)(n.td,{children:"Layout documento 4D Write Pro usado para avalia\xe7\xe3o: 0 (padr\xe3o) = 4D Write Pro layout; 1= HTML WYSWYG"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Resultado"}),(0,a.jsx)(n.td,{children:"Object"}),(0,a.jsx)(n.td,{children:"\u2190"}),(0,a.jsx)(n.td,{children:"Informa\xe7\xe3o posi\xe7\xe3o"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,a.jsxs)(n.p,{children:["O comando ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devolve um objeto que descreve a posi\xe7\xe3o atual de ",(0,a.jsx)(n.em,{children:"objRange"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["No par\xe2metro ",(0,a.jsx)(n.em,{children:"objRange"}),", pode passar:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"uma range, ou"}),"\n",(0,a.jsx)(n.li,{children:"um elemento (tabela / fila / par\xe1grafo / corpo / cabe\xe7alho/ rodap\xe9 / imagem/se\xe7\xe3o/ subse\xe7\xe3o/ caixa de texto), ou"}),"\n",(0,a.jsx)(n.li,{children:"um documento 4D Write Pro"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"O comando devolve a informa\xe7\xe3o de posi\xe7\xe3o em um objeto com as propriedades abaixo:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Nome da propriedade"})}),(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Tipo"})}),(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Descri\xe7\xe3o"})})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"se\xe7\xe3o"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["N\xfamero da primeira se\xe7\xe3o que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"p\xe1gina"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["N\xfamero da primeira p\xe1gina que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"coluna"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["\xcdndice da primeira coluna que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})," (baseado-1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"linha"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["\xcdndice da primeira linha que intersecta ",(0,a.jsx)(n.em,{children:"objRange"})," (relativo \xe0 coluna - ou p\xe1gina se n\xe3o houver nenhuma coluna com base - 1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"posi\xe7\xe3o"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["Posi\xe7\xe3o na linha do primeiro caractere de ",(0,a.jsx)(n.em,{children:"objRange"})," (baseado -1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"delimitadores"}),(0,a.jsx)(n.td,{children:"Objeto"}),(0,a.jsx)(n.td,{children:"Coordenadas de ret\xe2ngulo delimitador de objRange, expressas na unidade de documento atual e em rela\xe7\xe3o com o canto superior esquerdo da p\xe1gina. Se levam em considera\xe7\xe3o os tamanhos de preenchimento e borda (se houver); as margens e as r\xe9guas n\xe3o s\xe3o consideradas."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"acima"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada superior de ret\xe2ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"esquerda"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada esquerda de ret\xe2ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"abaixo"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada inferior de ret\xe2ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"direita"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada direita de ret\xe2ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"rangeAltura"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Altura de ret\xe2ngulo delimitador de objRange. Este valor pode ser diferente das op\xe7\xf5es bounds.bottom-bounds.top se objRange for estendido sobre v\xe1rias colunas (ver exemplo 4)"})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["Se ",(0,a.jsx)(n.em,{children:"objRango"})," for uma range vazio, ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devolve a informa\xe7\xe3o de posi\xe7\xe3o ao in\xedcio da range.",(0,a.jsx)(n.br,{}),"\nSe ",(0,a.jsx)(n.em,{children:"objRango"})," \xe9 um texto no cabe\xe7alho ou no rodap\xe9, ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devolve a informa\xe7\xe3o de posi\xe7\xe3o onde s\xe3o mostrados o cabe\xe7alho e o rodap\xe9 na primeira se\xe7\xe3o/p\xe1gina.",(0,a.jsx)(n.br,{}),"\nSe ",(0,a.jsx)(n.em,{children:"objRango"})," \xe9 uma imagem ancorada (que pode ser replicada em v\xe1rias p\xe1ginas), ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devolve a informa\xe7\xe3o de posi\xe7\xe3o onde a imagem estiver ancorada na primeira se\xe7\xe3o/p\xe1gina.",(0,a.jsx)(n.br,{}),"\nSe ",(0,a.jsx)(n.em,{children:"objRango"})," \xe9 uma subse\xe7\xe3o, WP Get position retorna a informa\xe7\xe3o de posi\xe7\xe3o da primeira p\xe1gina da se\xe7\xe3o pai."]}),"\n",(0,a.jsxs)(n.p,{children:["O par\xe2metro opcional ",(0,a.jsx)(n.em,{children:"layout"})," pode ser usada para definir a vista HTML wysiwyg para a avalia\xe7\xe3o ",(0,a.jsx)(n.em,{children:"objRange"}),'. Pode passar uma das constantes abaixo do tema "4D Write Pro":']}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Constante"}),(0,a.jsx)(n.th,{children:"Tipo"}),(0,a.jsx)(n.th,{children:"Valor"}),(0,a.jsx)(n.th,{children:"Coment\xe1rio"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"wk 4D Write Pro layout"}),(0,a.jsx)(n.td,{children:"Inteiro longo"}),(0,a.jsx)(n.td,{children:"0"}),(0,a.jsx)(n.td,{children:"Layout 4D Write Pro padr\xe3o, que pode incluir atributos de estilo espec\xedficos"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"wk html wysiwyg"}),(0,a.jsx)(n.td,{children:"Inteiro longo"}),(0,a.jsx)(n.td,{children:"1"}),(0,a.jsx)(n.td,{children:"Neste formato, os atributos avan\xe7ados 4D Write Pro que n\xe3o s\xe3o compat\xedveis com todos os navegadores s\xe3o eliminados"})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["Se omitir ",(0,a.jsx)(n.em,{children:"layout"}),", o design de 4D Write Pro se usa de forma pr\xe9-determinada."]}),"\n",(0,a.jsxs)(n.p,{children:["A mesma configura\xe7\xe3o de visualiza\xe7\xe3o que para o comando ",(0,a.jsx)(n.a,{href:"/docs/pt/WritePro/commands/wp-print",children:"WP PRINT"})," se usa com ",(0,a.jsx)(n.strong,{children:"WP Get position"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"cabe\xe7alhos: vis\xedveis"}),"\n",(0,a.jsx)(n.li,{children:"rodap\xe9s: vis\xedveis"}),"\n",(0,a.jsx)(n.li,{children:"express\xf5s: computadas e mostradas"}),"\n",(0,a.jsx)(n.li,{children:"modo p\xe1gina: p\xe1gina ou rascunho (vista wysiwyg HTML segundo o definido pelo comando)"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Se ",(0,a.jsx)(n.em,{children:"objRango"}),' mostrar em uma \xe1rea de formul\xe1rio 4D Write Pro, tenha certeza de que a configura\xe7\xe3o de visualiza\xe7\xe3o da \xe1rea coincida com a configura\xe7\xe3o de visualiza\xe7\xe3o do comando para obter informa\xe7\xe3o consistente. Lembre tamb\xe9m que se estas configura\xe7\xf5es forem diferentes na \xe1rea, 4D Write Pro ter\xe1 que "clonar" o documento para calcular o design em cada chamada do comando, o que pode levar muito tempo. Por motivos de rendimento, neste caso, se recomenda construir o documento fora de linha e copi\xe1-lo na \xe1rea de objetos de formul\xe1rio s\xf3 quando se complete a compila\xe7\xe3o.']}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Este comando n\xe3o deve ser chamado dentro de eventos que s\xe3o frequentemente gerados (tais como On After Edit) j\xe1 que ",(0,a.jsx)(n.em,{children:"result.rangeHeight"})," por exemplo pode exigir c\xe1lculos que consumem muito tempo e que ter\xe3o que ser feitos a cada chamada de evento"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"exemplo-1",children:"Exemplo 1"}),"\n",(0,a.jsx)(n.p,{children:"Se quiser saber o n\xfamero de p\xe1gina de uma range:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:'\xa0var $range;$rangePosition : Object\n\xa0$range:=WP Text range(WParea)\xa0//range da sele\xe7\xe3o de usu\xe1rio\n\xa0$rangePosition:=WP Get position($range;wk 4D Write Pro layout)\n\xa0ALERT("First page number in selection is "+String($rangePosition.page))\n'})}),"\n",(0,a.jsx)(n.h2,{id:"exemplo-2",children:"Exemplo 2"}),"\n",(0,a.jsx)(n.p,{children:"Se quiser definir na cor azul o texto na primeira e \xfaltima p\xe1gina do documento:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:'\xa0var $nbPages : Integer\n\xa0var $body : Object\n\xa0var $_paragraphs : Collection\n\xa0\n\xa0$nbPages:=WP Get page count([DOC]Sample)\n\xa0$body:=WP Get body([DOC]Sample)\n\xa0$_paragraphs:=WP Get elements($body;wk type paragraph)\n\xa0For each($paragraph;$_paragraphs)\n\xa0\xa0\xa0\xa0$info:=WP Get position($paragraph)\n\xa0\xa0\xa0\xa0If($info.page=1)|($info.page=$nbPages)\xa0//par\xe1grafos da primeira e \xfaltima p\xe1gina em azul\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET ATTRIBUTES($paragraph;wk text color;"blue")\n\xa0\xa0\xa0\xa0Else\xa0//outros par\xe1grafos de p\xe1gina em preto\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET ATTRIBUTES($paragraph;wk text color;"black")\n\xa0\xa0\xa0\xa0End if\n\xa0End for each\n'})}),"\n",(0,a.jsx)(n.h2,{id:"exemplo-3",children:"Exemplo 3"}),"\n",(0,a.jsx)(n.p,{children:"Enquanto cria um documento, se quiser evitar divis\xf5es de par\xe1grafo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:"\xa0var WParea;$body : Object\n\xa0var $_paragraphs : Collection\n\xa0WParea:=WP New\n\xa0\n\xa0$body:=WP Get body([DOC]Sample)\n\xa0$_paragraphs:=WP Get elements($body;wk type paragraph)\n\xa0\n\xa0For each($paragraph;$_paragraphs)\n\xa0\xa0\xa0\xa0$insert:=WP New($paragraph)\n\xa0\n\xa0\xa0//memoriza a range atual e o n\xfamero de p\xe1gina\n\xa0\xa0\xa0\xa0$rangeBefore:=WP Text range(WParea;wk end text;wk end text)\n\xa0\xa0\xa0\xa0$info:=WP Get position($rangeBefore)\n\xa0\xa0\xa0\xa0$memoPage:=$info.page\n\xa0\n\xa0\xa0//insere o conte\xfado, conserva a range intacta\n\xa0\xa0\xa0\xa0WP INSERT DOCUMENT($rangeBefore;$insert;wk append;wk exclude from range)\n\xa0\n\xa0\xa0//verifica a posi\xe7\xe3o depois da inser\xe7\xe3o\n\xa0\xa0\xa0\xa0$rangeAfter:=WP Text range(WParea;wk end text;wk end text)\n\xa0\xa0\xa0\xa0$info:=WP Get position($rangeAfter)\n\xa0\n\xa0\xa0\xa0\xa0If($memoPage#$info.page)\xa0// se a p\xe1gina tiver mudado, insere um salto de p\xe1gina\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP INSERT BREAK($rangeBefore;wk page break;wk replace)\n\xa0\xa0\xa0\xa0End if\n\xa0\n\xa0End for each\n"})}),"\n",(0,a.jsx)(n.h2,{id:"exemplo-4",children:"Exemplo 4"}),"\n",(0,a.jsxs)(n.p,{children:["Os exemplos abaixo ilustram as coordenadas do ret\xe2ngulo delimitador devolvidas, segundo o ",(0,a.jsx)(n.em,{children:"objRange"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:"\xa0$default:=WP Text range(WPArea)\xa0//range predeterminada (texto)\n\xa0$textCoordinates:=WP Get position($default)\xa0//linha de pontos vermelha\n\xa0\n\xa0$paragraph:=WP Create paragraph range($default)\xa0//range de par\xe1grafo\n\xa0$paraCoordinates:=WP Get position($paragraph)\xa0// l\xednha pontilhada verde\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:o(351814).Z+"",width:"800",height:"421"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"L\xednha de pontos vermelha:"})," ",(0,a.jsx)(n.em,{children:"valores de objeto $textCoordinates"}),"\n",(0,a.jsx)(n.em,{children:"L\xednha de pontos verde:"})," ",(0,a.jsx)(n.em,{children:"valores de objeto $"})," ",(0,a.jsx)(n.em,{children:"paraCoordinates"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Nota: no"})," caso de uma visualiza\xe7\xe3o em v\xe1rias colunas, a propriedade ",(0,a.jsx)(n.em,{children:"rangeHeight"})," (l\xednhas sem formato) poder\xeda ser maior que ",(0,a.jsx)(n.em,{children:"bounds.bottom"}),"-",(0,a.jsx)(n.em,{children:"bounds.top"})," (linhas de pontos):"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:o(357963).Z+"",width:"567",height:"427"})}),"\n",(0,a.jsx)(n.h2,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"/docs/pt/WritePro/commands/wp-print",children:"WP PRINT"})})]})}function p(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},351814:function(e,n,o){o.d(n,{Z:function(){return r}});let r=o.p+"assets/images/pict4096405.en-06494b17daf4c188448c7a627e5e83c7.png"},357963:function(e,n,o){o.d(n,{Z:function(){return r}});let r=o.p+"assets/images/pict4096411.en-392fb0a306ecaaf16fc2ed9654286496.png"},250065:function(e,n,o){o.d(n,{Z:function(){return d},a:function(){return i}});var r=o(667294);let a={},s=r.createContext(a);function i(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);