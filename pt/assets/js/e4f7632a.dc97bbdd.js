/*! For license information please see e4f7632a.dc97bbdd.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[23139],{597289:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var s=t(474848),i=t(28453);const r={id:"MailAttachmentClass",title:"MailAttachment"},d=void 0,l={id:"API/MailAttachmentClass",title:"MailAttachment",description:"Attachment objects allow referencing files within a Email object. Attachment objects are created using the MAIL New attachment command.",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R5/API/MailAttachmentClass.md",sourceDirName:"API",slug:"/API/MailAttachmentClass",permalink:"/docs/pt/API/MailAttachmentClass",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FMailAttachmentClass.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"MailAttachmentClass",title:"MailAttachment"},sidebar:"docs",previous:{title:"IMAPTransporter",permalink:"/docs/pt/API/IMAPTransporterClass"},next:{title:"POP3Transporter",permalink:"/docs/pt/API/POP3TransporterClass"}},c={},a=[{value:"Objeto anexos",id:"Objeto-anexos",level:3},{value:"MAIL New attachment",id:"MAIL-New-attachment",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o",level:4},{value:"Exemplo 1",id:"Exemplo-1",level:4},{value:"Exemplo 2",id:"Exemplo-2",level:4},{value:"4D. MailAttachment.new()",id:"4D-MailAttachmentnew",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-1",level:4},{value:".cid",id:"cid",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-2",level:4},{value:".disposition",id:"disposition",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-3",level:4},{value:".getContent()",id:"getContent",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-4",level:4},{value:".name",id:"name",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-5",level:4},{value:".path",id:"path",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-6",level:4},{value:".platformPath",id:"platformPath",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-7",level:4},{value:".size",id:"size",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-8",level:4},{value:".type",id:"type",level:2},{value:"Descri\xe7\xe3o",id:"Descri\xe7\xe3o-9",level:4}];function h(e){const n={a:"a",br:"br",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Attachment objects allow referencing files within a ",(0,s.jsx)(n.a,{href:"/docs/pt/API/EmailObjectClass",children:(0,s.jsx)(n.code,{children:"Email"})})," object. Attachment objects are created using the ",(0,s.jsx)(n.a,{href:"#mail-new-attachment",children:(0,s.jsx)(n.code,{children:"MAIL New attachment"})})," command."]}),"\n",(0,s.jsx)(n.h3,{id:"Objeto-anexos",children:"Objeto anexos"}),"\n",(0,s.jsx)(n.p,{children:"Objetos anexos oferecem as propriedades e fun\xe7\xf5es apenas leitura abaixo:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsx)(n.tr,{children:(0,s.jsx)(n.th,{})})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#cid",children:[(0,s.jsx)(n.strong,{children:".cid"})," : Text"]}),(0,s.jsx)(n.br,{})," the ID of the attachment"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#disposition",children:[(0,s.jsx)(n.strong,{children:".disposition"})," : Text"]}),(0,s.jsx)(n.br,{}),"the value of the ",(0,s.jsx)(n.code,{children:"Content-Disposition"})," header"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#getcontent",children:[(0,s.jsx)(n.strong,{children:".getContent()"})," : 4D.Blob"]}),(0,s.jsx)(n.br,{}),"returns the contents of the attachment object in a ",(0,s.jsx)(n.code,{children:"4D.Blob"})," object"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#name",children:[(0,s.jsx)(n.strong,{children:".name"})," : Text"]}),(0,s.jsx)(n.br,{}),"the name and extension of the attachment"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#path",children:[(0,s.jsx)(n.strong,{children:".path"})," : Text"]}),(0,s.jsx)(n.br,{}),"the POSIX path of the attachment file, if it exists"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#platformpath",children:[(0,s.jsx)(n.strong,{children:".platformPath"})," : Text"]}),(0,s.jsx)(n.br,{}),"the path of the attachment file expressed with the current platform syntax"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#size",children:[(0,s.jsx)(n.strong,{children:".size"})," : Integer"]}),(0,s.jsx)(n.br,{}),"the value of the ",(0,s.jsx)(n.code,{children:"size"})," header of the attachment file"]})}),(0,s.jsx)(n.tr,{children:(0,s.jsxs)(n.td,{children:[(0,s.jsxs)(n.a,{href:"#type",children:[(0,s.jsx)(n.strong,{children:".type"})," : Text"]}),(0,s.jsx)(n.br,{}),"the ",(0,s.jsx)(n.code,{children:"content-type"})," of the attachment file"]})})]})]}),"\n",(0,s.jsx)(n.h2,{id:"MAIL-New-attachment",children:"MAIL New attachment"}),"\n",(0,s.jsxs)(n.details,{children:[(0,s.jsx)(n.summary,{children:"Hist\xf3ria"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Release"}),(0,s.jsx)(n.th,{children:"Mudan\xe7as"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"19 R2"}),(0,s.jsx)(n.td,{children:"Accepts 4D. File, 4D. ZipFile, 4D. Blob"})]})})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"MAIL New attachment"}),"( ",(0,s.jsx)(n.em,{children:"file"})," : 4D.File { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"MAIL New attachment"}),"( ",(0,s.jsx)(n.em,{children:"zipFile"})," : 4D.ZipFile { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"MAIL New attachment"}),"( ",(0,s.jsx)(n.em,{children:"blob"})," : 4D.Blob { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"MAIL New attachment"}),"( ",(0,s.jsx)(n.em,{children:"path"})," : Text { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe2metro"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{style:{textAlign:"center"}}),(0,s.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"file"}),(0,s.jsx)(n.td,{children:"4D. File"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"zipFile"}),(0,s.jsx)(n.td,{children:"4D. ZipFile"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Arquivo zip"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"blob"}),(0,s.jsx)(n.td,{children:"4D. Blob"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Blob contendo o anexo"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"path"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Pode passar uma rota ou um Blob para definir o anexo."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Nome + extens\xe3o usado pelo cliente email para designar o anexo"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cid"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:'ID do anexo (apenas mensagens HTML), ou " " se nenhum cid for exigido'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"type"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Valor do cabe\xe7alho content-type"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"disposition"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:'Valor do cabe\xe7alho content-disposition: "inline" ou "attachment".'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Resultados"}),(0,s.jsx)(n.td,{children:"4D. MailAttachment"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,s.jsx)(n.td,{children:"Objeto anexo"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"MAIL New attachment"})," command allows you to create an attachment object that you can add to an ",(0,s.jsx)(n.a,{href:"/docs/pt/API/EmailObjectClass#email-object",children:"Email object"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Para definir o anexo, pode utilizar:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["a ",(0,s.jsx)(n.em,{children:"file"}),", pass a ",(0,s.jsx)(n.code,{children:"4D.File"})," object containing the attachment file."]}),"\n",(0,s.jsxs)(n.li,{children:["a ",(0,s.jsx)(n.em,{children:"zipfile"}),", pass a ",(0,s.jsx)(n.code,{children:"4D.ZipFile"})," object containing the attachment file."]}),"\n",(0,s.jsxs)(n.li,{children:["a ",(0,s.jsx)(n.em,{children:"blob"}),", pass a ",(0,s.jsx)(n.code,{children:"4D.Blob"})," object containing the attachment itself."]}),"\n",(0,s.jsxs)(n.li,{children:["a ",(0,s.jsx)(n.em,{children:"path"}),", pass a ",(0,s.jsx)(n.strong,{children:"text"})," value containing the path of the attachment file, expressed with the system syntax. Pode passar um nome de rota completo ou um nome de arquivo simples (em cujo caso 4D vai pesquisar para o arquivo no mesmo diret\xf3rio como o arquivo projeto)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The optional ",(0,s.jsx)(n.em,{children:"name"})," parameter lets you pass the name and extension to be used by the mail client to designate the attachment. If ",(0,s.jsx)(n.em,{children:"name"})," is omitted and:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"passar uma rota de arquivo, o nome e extens\xe3o do arquivo \xe9 usado,"}),"\n",(0,s.jsx)(n.li,{children:"passar um BLOB, um nome aleat\xf3rio sem extens\xe3o \xe9 gerado automaticamente."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The optional ",(0,s.jsx)(n.em,{children:"cid"})," parameter lets you pass an internal ID for the attachment. This ID is the value of the ",(0,s.jsx)(n.code,{children:"Content-Id"})," header, it will be used in HTML messages only. The cid associates the attachment with a reference defined in the message body using an HTML tag such as ",(0,s.jsx)(n.code,{children:'\\<img src="cid:ID">'}),". Isso significa que os conte\xfados do anexo (por exemplo uma imagem) deve ser exibida dentro da mensagem do cliente mail. O resultado final deve variar dependendo do cliente mail. You can pass an empty string in ",(0,s.jsx)(n.em,{children:"cid"})," if you do not want to use this parameter."]}),"\n",(0,s.jsxs)(n.p,{children:["You can use the optional ",(0,s.jsx)(n.em,{children:"type"})," parameter to explicitly set the ",(0,s.jsx)(n.code,{children:"content-type"}),' of the attachment file. Por exemplo, pode passar uma string definindo um tipo MIME ("video/mpeg"). Esse valor de content-type vai ser estabelecido para o anexo, independente de sua extens\xe3o. For more information about MIME types, please refer to the ',(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/MIME",children:"MIME type page on Wikipedia"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["By default, if the ",(0,s.jsx)(n.em,{children:"type"})," parameter is omitted or contains an empty string, the ",(0,s.jsx)(n.code,{children:"content-type"})," of the attachment file is based on its extension. As regras abaixo s\xe3o aplicadas aos tipos MIME:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Extens\xe3o"}),(0,s.jsx)(n.th,{children:"Tipo"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"jpg, jpeg"}),(0,s.jsx)(n.td,{children:"image/jpeg"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"png"}),(0,s.jsx)(n.td,{children:"image/png"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"gif"}),(0,s.jsx)(n.td,{children:"image/gif"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pdf"}),(0,s.jsx)(n.td,{children:"application/pdf"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"doc"}),(0,s.jsx)(n.td,{children:"application/msword"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"xls"}),(0,s.jsx)(n.td,{children:"application/vnd.ms-excel"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ppt"}),(0,s.jsx)(n.td,{children:"application/vnd.ms-powerpoint"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"zip"}),(0,s.jsx)(n.td,{children:"application/zip"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"gz"}),(0,s.jsx)(n.td,{children:"application/gzip"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"json"}),(0,s.jsx)(n.td,{children:"application/json"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"js"}),(0,s.jsx)(n.td,{children:"application/javascript"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ps"}),(0,s.jsx)(n.td,{children:"application/postscript"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"xml"}),(0,s.jsx)(n.td,{children:"application/xml"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"htm, html"}),(0,s.jsx)(n.td,{children:"text/html"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mp3"}),(0,s.jsx)(n.td,{children:"audio/mpeg"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.em,{children:"outro"})}),(0,s.jsx)(n.td,{children:"application/octet-stream"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The optional ",(0,s.jsx)(n.em,{children:"disposition"})," parameter lets you pass the ",(0,s.jsx)(n.code,{children:"content-disposition"}),' header of the attachment. Pode passar uma das constantes abaixo da constante tema de "Mail":']}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe2metros"}),(0,s.jsx)(n.th,{children:"Valor"}),(0,s.jsx)(n.th,{children:"Coment\xe1rio"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mail disposition attachment"}),(0,s.jsx)(n.td,{children:'"attachment"'}),(0,s.jsx)(n.td,{children:'Estabelece o valor de cabe\xe7alho Content-disposition para "attachment" que significa que o arquivo anexo deve ser fornecido como um link na mensagem.'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mail disposition inline"}),(0,s.jsx)(n.td,{children:'"inline"'}),(0,s.jsx)(n.td,{children:'Estabelece o valor de cabe\xe7alho Content-disposition para "inline", o que significa que o anexo deve ser renderizado dentro do conte\xfado da mensagem, no local "cid". A renderiza\xe7\xe3o depende do cliente mail.'})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["By default, if the ",(0,s.jsx)(n.em,{children:"disposition"})," parameter is omitted:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["if the ",(0,s.jsx)(n.em,{children:"cid"})," parameter is used, the ",(0,s.jsx)(n.code,{children:"Content-disposition"}),' header is set to "inline",']}),"\n",(0,s.jsxs)(n.li,{children:["if the ",(0,s.jsx)(n.em,{children:"cid"})," parameter is not passed or empty, the ",(0,s.jsx)(n.code,{children:"Content-disposition"}),' header is set to "attachment".']}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"Exemplo-1",children:"Exemplo 1"}),"\n",(0,s.jsx)(n.p,{children:"Se quiser enviar um email com um arquivo selecionado pelo usu\xe1rio como um anexo e uma imagem embebida no corpo HTML:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'$doc:=Select document("";"*";"Please select a file to attach";0)\nIf (OK=1) //If a document was selected\n\nC_OBJECT($email;$server;$transporter)\n\n$server:=New object\n$server.host:="smtp.mail.com"\n$server.user:="test_user@mail.com"\n$server.password:="p@ssw@rd"\n$transporter:=SMTP New transporter($server)\n\n$email:=New object\n$email.from:="test_user@mail.com"\n$email.to:="test_user@mail.com"\n$email.subject:="This is a test message with attachments"\n\n//add a link to download file\n$email.attachments:=New collection(MAIL New attachment(Document))\n//insert an inline picture (use a cid)\n$email.attachments[1]:=MAIL New attachment("c:\\\\Pictures\\\\4D.jpg";"";"4D")\n\n$email.htmlBody:="<html>"+\\\n"<body>Hello World!"+\\\n"<img src=\'cid:4D\' >"+\\\n"</body>"+\\\n"</head>"+\\\n"</html>"\n\n$transporter.send($email) //send mail\n\nEnd if\n'})}),"\n",(0,s.jsx)(n.h4,{id:"Exemplo-2",children:"Exemplo 2"}),"\n",(0,s.jsx)(n.p,{children:"Se quiser enviar um email com uma \xe1rea 4D Write pro como um anexo:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'C_BLOB($blob)\nWP EXPORT VARIABLE(WPArea;$blob;wk docx)\n\nC_OBJECT($email;$server;$transporter)\n\n$server:=New object\n$server.host:="smtp.mail.com"\n$server.user:="user@mail.com"\n$server.password:="p@ssw@rd"\n$transporter:=SMTP New transporter($server)\n\n$email:=New object\n$email.from:="user@mail.com"\n$email.to:="customer@mail.com"\n$email.subject:="New annual report"\n$email.textBody:="Please find enclosed our latest annual report."\n$email.attachments:=New collection(MAIL New attachment($blob;"Annual report.docx"))\n\n$transporter.send($email)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"4D-MailAttachmentnew",children:"4D. MailAttachment.new()"}),"\n",(0,s.jsxs)(n.details,{children:[(0,s.jsx)(n.summary,{children:"Hist\xf3ria"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Release"}),(0,s.jsx)(n.th,{children:"Mudan\xe7as"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"19 R2"}),(0,s.jsx)(n.td,{children:"Accepts 4D. File, 4D. ZipFile, 4D. Blob"})]})})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"4D.MailAttachment.new"}),"( ",(0,s.jsx)(n.em,{children:"file"})," : 4D.File { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"4D.MailAttachment.new"}),"( ",(0,s.jsx)(n.em,{children:"zipFile"})," : 4D.ZipFile { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"4D.MailAttachment.new"}),"( ",(0,s.jsx)(n.em,{children:"blob"})," : 4D.Blob { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.strong,{children:"4D.MailAttachment.new"}),"( ",(0,s.jsx)(n.em,{children:"path"})," : Text { ; ",(0,s.jsx)(n.em,{children:"name"})," : Text {; ",(0,s.jsx)(n.em,{children:"cid"})," : Text{ ; ",(0,s.jsx)(n.em,{children:"type"})," : Text { ; ",(0,s.jsx)(n.em,{children:"disposition"})," :Text } } } } ) : 4D.MailAttachment"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe2metro"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{style:{textAlign:"center"}}),(0,s.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"file"}),(0,s.jsx)(n.td,{children:"4D. File"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"zipFile"}),(0,s.jsx)(n.td,{children:"4D. ZipFile"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Arquivo zip"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"blob"}),(0,s.jsx)(n.td,{children:"4D. Blob"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Blob contendo o anexo"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"path"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Pode passar uma rota ou um Blob para definir o anexo."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Nome + extens\xe3o usado pelo cliente email para designar o anexo"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cid"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:'ID do anexo (apenas mensagens HTML), ou " " se nenhum cid for exigido'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"type"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:"Valor do cabe\xe7alho content-type"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"disposition"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,s.jsx)(n.td,{children:'Valor do cabe\xe7alho content-disposition: "inline" ou "attachment".'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Resultados"}),(0,s.jsx)(n.td,{children:"4D. MailAttachment"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,s.jsx)(n.td,{children:"Objeto anexo"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-1",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"4D.MailAttachment.new()"})," function creates and returns a new object of the ",(0,s.jsx)(n.code,{children:"4D.MailAttachment"})," type. It is identical to the ",(0,s.jsx)(n.a,{href:"#mail-new-attachment",children:(0,s.jsx)(n.code,{children:"MAIL New attachment"})})," command (shortcut)."]}),"\n",(0,s.jsx)(n.h2,{id:"cid",children:".cid"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".cid"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-2",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".cid"})," property contains  the ID of the attachment. Essa funcionalidade \xe9 usada em mensagens HTML apenas. Se essa propriedade faltar, o arquivo \xe9 manejado como um anexo simples (link)."]}),"\n",(0,s.jsx)(n.h2,{id:"disposition",children:".disposition"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".disposition"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-3",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".disposition"})," property contains the value of the ",(0,s.jsx)(n.code,{children:"Content-Disposition"})," header. Dois valores eset\xe3o dispon\xedveis:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'"inline": o anexo \xe9 renderizado dentro dos conte\xfados da mensagem, no local "cid". A renderiza\xe7\xe3o depende do cliente mail.'}),"\n",(0,s.jsx)(n.li,{children:'"attachment": o anexo \xe9 fornecido como um link na mensagem.'}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"getContent",children:".getContent()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".getContent()"})," : 4D.Blob"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe2metro"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{style:{textAlign:"center"}}),(0,s.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Resultados"}),(0,s.jsx)(n.td,{children:"4D. Blob"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,s.jsx)(n.td,{children:"Conte\xfado do anexo"})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-4",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".getContent()"})," function returns the contents of the attachment object in a ",(0,s.jsx)(n.code,{children:"4D.Blob"})," object. You can use this method with attachment objects received by the ",(0,s.jsx)(n.a,{href:"/docs/pt/API/EmailObjectClass#mail-convert-from-mime",children:(0,s.jsx)(n.code,{children:"MAIL Convert from MIME"})})," command."]}),"\n",(0,s.jsx)(n.h2,{id:"name",children:".name"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".name"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-5",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".name"})," property contains the name and extension of the attachment.  By default, it is the name of the file, unless another name was specified in the ",(0,s.jsx)(n.a,{href:"#mail-new-attachment",children:(0,s.jsx)(n.code,{children:"MAIL New attachment"})})," command."]}),"\n",(0,s.jsx)(n.h2,{id:"path",children:".path"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".path"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-6",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".path"})," property contains the POSIX path of the attachment file, if it exists."]}),"\n",(0,s.jsx)(n.h2,{id:"platformPath",children:".platformPath"}),"\n",(0,s.jsxs)(n.details,{children:[(0,s.jsx)(n.summary,{children:"Hist\xf3ria"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Release"}),(0,s.jsx)(n.th,{children:"Mudan\xe7as"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"19"}),(0,s.jsx)(n.td,{children:"Adicionado"})]})})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".platformPath"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-7",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".platformPath"})," property returns the path of the attachment file expressed with the current platform syntax."]}),"\n",(0,s.jsx)(n.h2,{id:"size",children:".size"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".size"})," : Integer"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-8",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".size"})," property contains the value of the ",(0,s.jsx)(n.code,{children:"size"})," header of the attachment file. The ",(0,s.jsx)(n.code,{children:".size"})," property is returned when the MIME message defines a size header in the attachment part."]}),"\n",(0,s.jsx)(n.h2,{id:"type",children:".type"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:".type"})," : Text"]}),"\n",(0,s.jsx)(n.h4,{id:"Descri\xe7\xe3o-9",children:"Descri\xe7\xe3o"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".type"})," property contains the ",(0,s.jsx)(n.code,{children:"content-type"})," of the attachment file. If this type is not explicitly passed to the ",(0,s.jsx)(n.a,{href:"#mail-new-attachment",children:(0,s.jsx)(n.code,{children:"MAIL New attachment"})})," command, the ",(0,s.jsx)(n.code,{children:"content-type"})," is based on its file extension."]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},221020:(e,n,t)=>{var s=t(296540),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,n,t){var s,r={},a=null,h=null;for(s in void 0!==t&&(a=""+t),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(h=n.ref),n)d.call(n,s)&&!c.hasOwnProperty(s)&&(r[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===r[s]&&(r[s]=n[s]);return{$$typeof:i,type:e,key:a,ref:h,props:r,_owner:l.current}}n.Fragment=r,n.jsx=a,n.jsxs=a},474848:(e,n,t)=>{e.exports=t(221020)},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>l});var s=t(296540);const i={},r=s.createContext(i);function d(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);