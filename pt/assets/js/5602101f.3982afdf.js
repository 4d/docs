"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[41189],{3905:(e,o,r)=>{r.d(o,{Zo:()=>p,kt:()=>u});var t=r(67294);function a(e,o,r){return o in e?Object.defineProperty(e,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[o]=r,e}function n(e,o){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),r.push.apply(r,t)}return r}function d(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?n(Object(r),!0).forEach((function(o){a(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}))}return e}function s(e,o){if(null==e)return{};var r,t,a=function(e,o){if(null==e)return{};var r,t,a={},n=Object.keys(e);for(t=0;t<n.length;t++)r=n[t],o.indexOf(r)>=0||(a[r]=e[r]);return a}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(t=0;t<n.length;t++)r=n[t],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=t.createContext({}),l=function(e){var o=t.useContext(i),r=o;return e&&(r="function"==typeof e?e(o):d(d({},o),e)),r},p=function(e){var o=l(e.components);return t.createElement(i.Provider,{value:o},e.children)},m={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},c=t.forwardRef((function(e,o){var r=e.components,a=e.mdxType,n=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=l(r),u=a,g=c["".concat(i,".").concat(u)]||c[u]||m[u]||n;return r?t.createElement(g,d(d({ref:o},p),{},{components:r})):t.createElement(g,d({ref:o},p))}));function u(e,o){var r=arguments,a=o&&o.mdxType;if("string"==typeof e||a){var n=r.length,d=new Array(n);d[0]=c;var s={};for(var i in o)hasOwnProperty.call(o,i)&&(s[i]=o[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,d[1]=s;for(var l=2;l<n;l++)d[l]=r[l];return t.createElement.apply(null,d)}return t.createElement.apply(null,r)}c.displayName="MDXCreateElement"},53362:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>d,metadata:()=>i,toc:()=>p});r(67294);var t=r(3905);function a(){return a=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},a.apply(this,arguments)}function n(e,o){if(null==e)return{};var r,t,a=function(e,o){if(null==e)return{};var r,t,a={},n=Object.keys(e);for(t=0;t<n.length;t++)r=n[t],o.indexOf(r)>=0||(a[r]=e[r]);return a}(e,o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(t=0;t<n.length;t++)r=n[t],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const d={id:"error-handling",title:"Gest\xe3o de erros"},s=void 0,i={unversionedId:"Concepts/error-handling",id:"version-18/Concepts/error-handling",title:"Gest\xe3o de erros",description:"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es.",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-18/Concepts/error-handling.md",sourceDirName:"Concepts",slug:"/Concepts/error-handling",permalink:"/docs/pt/18/Concepts/error-handling",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20Concepts%2Ferror-handling.md%20(18)&body=Please%20enter%20your%20comment%3A",tags:[],version:"18",frontMatter:{id:"error-handling",title:"Gest\xe3o de erros"},sidebar:"docs",previous:{title:"Estruturas de loop",permalink:"/docs/pt/18/Concepts/looping"},next:{title:"Modos interpretado e compilado",permalink:"/docs/pt/18/Concepts/interpreted-compiled"}},l={},p=[{value:"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros",id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros",level:2},{value:"Alcance e componentes",id:"alcance-e-componentes",level:3},{value:"Manejo de erros dentro do m\xe9todo",id:"manejo-de-erros-dentro-do-m\xe9todo",level:3},{value:"Exemplo",id:"exemplo",level:4},{value:"Utilizar um m\xe9todo de gest\xe3o de erro vazio",id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio",level:3}],m={toc:p};function c(e){var{components:o}=e,r=n(e,["components"]);return(0,t.kt)("wrapper",a({},m,r,{components:o,mdxType:"MDXLayout"}),(0,t.kt)("p",null,"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es."),(0,t.kt)("p",null,"Manejo de erros responde \xe0 duas necessidades principais:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"descobrir e consertar erros potenciais e bugs no c\xf3digo durante a fase de desenvolvimento,"),(0,t.kt)("li",{parentName:"ul"},"detectar e recuperar de erros inesperados nas aplica\xe7\xf5es implementadas; em particular pode substituir di\xe1logos de erros de sistemas (disco cheio, arquivo faltando, etc) com sua pr\xf3pria interface.",(0,t.kt)("blockquote",{parentName:"li"},(0,t.kt)("blockquote",{parentName:"blockquote"},(0,t.kt)("p",{parentName:"blockquote"},"\xc9 recomendado instalar um m\xe9todo de gerenciamento de erros em 4D Server, para todos os c\xf3digos rodando no servidor. Esse m\xe9todo evitaria a apari\xe7\xe3o de caixas de di\xe1logo inesperadas no servidor e poderia registrar os erros em um arquivo especifico para sua an\xe1lise posterior."))))),(0,t.kt)("h2",a({},{id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros"}),"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros"),(0,t.kt)("p",null,"Em 4D todos os erros podem ser capturados e manejados em um m\xe9todo projeto espec\xedfico, o m\xe9todo ",(0,t.kt)("strong",{parentName:"p"},"gest\xe3o de erros")," (ou ",(0,t.kt)("strong",{parentName:"p"},"captura de erros"),")."),(0,t.kt)("p",null,"Este m\xe9todo projeto se instala para o processo atual e ser\xe1 chamado automaticamente para qualquer erro que se produza no processo, em modo interpretado ou compilado. Para ",(0,t.kt)("em",{parentName:"p"},"instalar")," este m\xe9todo projeto, basta com chamar ao comando ",(0,t.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," com o nome do m\xe9todo projeto como par\xe2metro. Por exemplo:"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("IO_ERRORS") //Instala o m\xe9todo de gest\xe3o de erros\n')),(0,t.kt)("p",null,"Para deixar de detectar erros e devolver o controle a 4D, chame a ",(0,t.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," com uma string vazia:"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("") //devolve o controle a 4D\n')),(0,t.kt)("h3",a({},{id:"alcance-e-componentes"}),"Alcance e componentes"),(0,t.kt)("p",null,"Pode definir um \xfanico m\xe9todo de captura de erros para toda a aplica\xe7\xe3o ou diferentes m\xe9todos por m\xf3dulo de aplica\xe7\xe3o. Entretanto, apenas um m\xe9todo pode ser instalado por processo."),(0,t.kt)("p",null,"Um m\xe9todo de gest\xe3o de erros instalado pelo comando ",(0,t.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," s\xf3 se aplica ao banco de dados em execu\xe7\xe3o. No caso de um erro gerado por um ",(0,t.kt)("strong",{parentName:"p"},"componente"),", n\xe3o se chama ao m\xe9todo ",(0,t.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," de gest\xe3o de erros do banco de dados local, e vice versa."),(0,t.kt)("p",null,"O comando ",(0,t.kt)("inlineCode",{parentName:"p"},"Method called on error")," permite conhecer o nome do m\xe9todo instalado por ",(0,t.kt)("inlineCode",{parentName:"p"},"ON ERR CALL")," para o processo atual. \xc9 particularmente \xfatil no contexto dos componentes porque permite mudar temporariamente e depois restaurar o m\xe9todo de captura de erros do banco de dados local:"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),' $methCurrent:=Method called on error\n ON ERR CALL("NewMethod")\n  //Se o documento n\xe3o pouder ser aberto, um erro \xe9 gerado\n $ref:=Open document("MyDocument")\n  //Reinstala\xe7\xe3o do m\xe9todo anterior\n ON ERR CALL($methCurrent)\n\n')),(0,t.kt)("h3",a({},{id:"manejo-de-erros-dentro-do-m\xe9todo"}),"Manejo de erros dentro do m\xe9todo"),(0,t.kt)("p",null,"Dentro do m\xe9todo de erro personalizado, tem acesso a v\xe1rias informa\xe7\xf5es que lhe ajudar\xe1 a identificar o erro:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"4D mant\xe9m automaticamente um certo n\xfamero de vari\xe1veis denominadas ",(0,t.kt)("strong",{parentName:"p"},"vari\xe1veis sistema"),", que respondem a diferentes necessidades (ver  ",(0,t.kt)("em",{parentName:"p"},"manual de refer\xeancia da Linguagem 4D"),"):"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Error")," (inteiro longo): c\xf3digo de erro"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Error method"),"(texto): nome do m\xe9todo que provocou o erro"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Error line")," (entero largo): n\xfamero de l\xednea do m\xe9todo que provocou o erro"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Error formula")," (text): f\xf3rmula do c\xf3digo 4D (texto bruto) que est\xe1 na origem do erro."))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"o comando ",(0,t.kt)("inlineCode",{parentName:"p"},"GET LAST ERROR STACK")," que devolve informa\xe7\xe3o sobre a pilha de erros atual da aplica\xe7\xe3o 4D.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"o comando ",(0,t.kt)("inlineCode",{parentName:"p"},"Get call chain")," que devolve uma cole\xe7\xe3o de objetos que descrevem cada passo da string de chamadas a m\xe9todos dentro do processo atual."))),(0,t.kt)("h4",a({},{id:"exemplo"}),"Exemplo"),(0,t.kt)("p",null,"Aqui est\xe1 um sistema de gest\xe3o de erros simples:"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'//instalar o m\xe9todo de gest\xe3o de erros\n ON ERR CALL("errorMethod")\n //... executar o c\xf3digo\n ON ERR CALL("") //retorna o controle para 4D\n')),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'// m\xe9todo projeto errorMethod\n If(Error#1006) //essa n\xe3o \xe9 uma interrup\xe7\xe3o do usu\xe1rio\n    ALERT("Um erro foi produzido "+String(Error)+". O c\xf3digo em quest\xe3o \xe9: \\""+Error formula+"\\"")\n End if\n')),(0,t.kt)("h3",a({},{id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio"}),"Utilizar um m\xe9todo de gest\xe3o de erro vazio"),(0,t.kt)("p",null,"Se quiser que a caixa de di\xe1logo fique escondida, pode instalar um m\xe9todo de gest\xe3o de erros vazio. A vari\xe1vel sistema ",(0,t.kt)("inlineCode",{parentName:"p"},"Error")," pode ser provada em qualquer m\xe9todo, ou seja, fora do m\xe9todo de gest\xe3o de erros:"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-4d"}),'ON ERR CALL("emptyMethod") //emptyMethod exists but is empty\n$doc:=Open document( "myFile.txt")\nIf (Error=-43)\n    ALERT("File not found.")\nEnd if\nON ERR CALL("")\n')))}c.isMDXComponent=!0}}]);