"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["90474"],{587039:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>i,default:()=>m,toc:()=>l,metadata:()=>o,assets:()=>d,contentTitle:()=>a});var o=JSON.parse('{"id":"WritePro/commands-legacy/wp-set-link","title":"WP SET LINK","description":"WP SET LINK ( objRange ; objLink )","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R9/WritePro/commands-legacy/wp-set-link.md","sourceDirName":"WritePro/commands-legacy","slug":"/WritePro/commands/wp-set-link","permalink":"/docs/pt/20-R9/WritePro/commands/wp-set-link","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WritePro%2Fcommands-legacy%2Fwp-set-link.md%20(20-R9)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R9","frontMatter":{"id":"wp-set-link","title":"WP SET LINK","slug":"/WritePro/commands/wp-set-link","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"WP SET FRAME","permalink":"/docs/pt/20-R9/WritePro/commands/wp-set-frame"},"next":{"title":"WP SET TEXT","permalink":"/docs/pt/20-R9/WritePro/commands/wp-set-text"}}'),t=r(785893),s=r(250065);let i={id:"wp-set-link",title:"WP SET LINK",slug:"/WritePro/commands/wp-set-link",displayed_sidebar:"docs"},a=void 0,d={},l=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:2},{value:"Exemplo 1",id:"exemplo-1",level:2},{value:"Exemplo 2",id:"exemplo-2",level:2},{value:"Exemplo 3",id:"exemplo-3",level:2},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:2}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"WP SET LINK"})," ( ",(0,t.jsx)(n.em,{children:"objRange"})," ; ",(0,t.jsx)(n.em,{children:"objLink"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Par\xe2metro"}),(0,t.jsx)(n.th,{children:"Tipo"}),(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"objRange"}),(0,t.jsx)(n.td,{children:"Object"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Range ou elemento ou documento 4D Write Pro"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"objLink"}),(0,t.jsx)(n.td,{children:"Object"}),(0,t.jsx)(n.td,{children:"\u2192"}),(0,t.jsx)(n.td,{children:"Valor do hyperlink"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"WP SET LINK"})," aplica uma refer\xeancia de hiperlink ao ",(0,t.jsx)(n.em,{children:"objRange"}),". S\xe3o compat\xedveis links a URL, m\xe9todos 4D e marcadores. O link ativa uma a\xe7\xe3o quando o usu\xe1rio clicar nele (ou utilizar ",(0,t.jsx)(n.strong,{children:"Ctrl+clique"})," em Windows ou ",(0,t.jsx)(n.strong,{children:"Cmd+clique"})," em macOS se o texto n\xe3o for apenas leitura para abrir URL)."]}),"\n",(0,t.jsxs)(n.p,{children:["Em ",(0,t.jsx)(n.em,{children:"objRange"}),", passe o objeto 4D Write Pro onde se aplicar\xe1 o link. Pode passar:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"uma range, ou"}),"\n",(0,t.jsx)(n.li,{children:"um elemento (tabela / fila / par\xe1grafo / corpo / cabe\xe7alho / rodap\xe9 / se\xe7\xe3o / subse\xe7\xe3o), ou"}),"\n",(0,t.jsx)(n.li,{children:"um documento 4D Write Pro"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Por exemplo, se passar um cabe\xe7alho, o conte\xfado completo do cabe\xe7alho se mostrar\xe1 como um link. Ao inserir links em seus documentos, 4D Write Pro aplica as seguintes regras:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Se definir um link a um ",(0,t.jsx)(n.em,{children:"objRange"})," que conter v\xe1rios par\xe1grafos, se definir\xe3o v\xe1rios links separados."]}),"\n",(0,t.jsxs)(n.li,{children:["Se definir um link a um ",(0,t.jsx)(n.em,{children:"objRange"})," que j\xe1 contenha links:\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["todos os links existentes que estejam completamente inclu\xeddos no ",(0,t.jsx)(n.em,{children:"objRange"})," s\xe3o eliminados e o novo link se aplica a ",(0,t.jsx)(n.em,{children:"objRange"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Se um link for selecionado parcialmente (intersecta ",(0,t.jsx)(n.em,{children:"objRange"}),"), ele \xe9 reduzido para que a parte externa mantenha o link anterior e o novo link se aplique a ",(0,t.jsx)(n.em,{children:"objRange"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["No par\xe2metro ",(0,t.jsx)(n.em,{children:"objLink"}),", passe um objeto que descreva o hyperlink. Deve conter apenas uma das seguintes propriedades (exceto a propriedade de par\xe2metro que possa ser utilizada junto com a propriedade de m\xe9todo):"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Propriedade"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Tipo"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Descri\xe7\xe3o"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"A\xe7\xe3o de hyperlink"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"url"}),(0,t.jsx)(n.td,{children:"Texto"}),(0,t.jsx)(n.td,{children:"Destino para um link de tipo URL (url codificado)."}),(0,t.jsxs)(n.td,{children:["Faz refer\xeancia a um endere\xe7o web normal (http ou https://",(0,t.jsx)(n.em,{children:"website"}),", mailto:",(0,t.jsxs)(n.em,{children:[(0,t.jsx)(n.a,{href:"mailto:abc@xyz.com",children:"abc@xyz.com"}),","]})," etc.): abre a URL na aplica\xe7\xe3o predeterminada (geralmente um navegador)Faz refer\xeancia a uma rota de arquivo (absoluta ou relativa ao arquivo de estrutura 4D). Ao referenciar a um arquivo .4wp ou .4w7 (file://",(0,t.jsx)(n.em,{children:"filepath"})," ou ",(0,t.jsx)(n.em,{children:"filepath/file.4wp"}),"): carrega e substitui o documento atual. Ao referenciar a outros tipos de arquivos, abre o arquivo na aplica\xe7\xe3o pre-determinada de sistema para o tipo de arquivo"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"bookmark"}),(0,t.jsx)(n.td,{children:"Texto"}),(0,t.jsx)(n.td,{children:"Nome da bookmark"}),(0,t.jsxs)(n.td,{children:["Acessa a bookmark especificada no documento atual. (Consulte ",(0,t.jsx)(n.em,{children:"Comandos de Bookmark"}),")"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"method"}),(0,t.jsx)(n.td,{children:"Texto"}),(0,t.jsxs)(n.td,{children:["Nome de m\xe9todo de projeto: o m\xe9todo deve existir e deve ser permitido com o comando ",(0,t.jsx)(n.a,{href:"/docs/pt/20-R9/commands/set-allowed-methods",children:"SET ALLOWED METHODS"}),"."]}),(0,t.jsxs)(n.td,{children:["Executa o m\xe9todo 4D quando fizer um clique. O m\xe9todo recebe automaticamente dois par\xe2metros em $1 e $2:",(0,t.jsx)(n.br,{}),(0,t.jsx)(n.table,{children:(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Par\xe2metro"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Propriedade"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Tipo"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Descri\xe7\xe3o"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"$1"}),(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Texto"}),(0,t.jsx)(n.td,{children:"Nome da \xe1rea 4D Write Pro"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"$2"}),(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"Objeto"}),(0,t.jsx)(n.td,{})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"m\xe9todo"}),(0,t.jsx)(n.td,{children:"Texto"}),(0,t.jsx)(n.td,{children:"Nome de m\xe9todo 4D"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"par\xe2metro"}),(0,t.jsx)(n.td,{children:"Texto | N\xfamero"}),(0,t.jsx)(n.td,{children:"Par\xe2metro de usu\xe1rio enviado ao m\xe9todo atrav\xe9s da propriedade de par\xe2metro (opcional, ver abaixo)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:"rango"}),(0,t.jsx)(n.td,{children:"Objeto"}),(0,t.jsxs)(n.td,{children:["Range de ",(0,t.jsx)(n.em,{children:"objRangE"})]})]})]})})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"par\xe2metro"}),(0,t.jsx)(n.td,{children:"Texto | N\xfamero"}),(0,t.jsxs)(n.td,{children:["S\xf3 se utiliza com um link de tipo ",(0,t.jsx)(n.em,{children:"m\xe9todo"}),", n\xe3o \xe9 obrigat\xf3rio se o m\xe9todo n\xe3o exigir um par\xe2metro. Cont\xe9m um par\xe2metro adicional para enviar ao m\xe9todo."]}),(0,t.jsx)(n.td,{children:"Recebido no par\xe2metro $2. dentro do m\xe9todo"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notas:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"4D Write Pro s\xf3 aceita URL v\xe1lidas (codificadas). Os caracteres especiais nos links n\xe3o est\xe3o traduzidos. Se os caracteres especiais (ou seja,% 20 para espa\xe7os) s\xe3o necess\xe1rios, deve codific\xe1-los expressamente. Se o link n\xe3o for v\xe1lido, se gera um erro."}),"\n",(0,t.jsx)(n.li,{children:"Os links aos m\xe9todos 4D s\xe3o eliminados dos documentos 4D Write Pro quando se exportam em formato HTML, MIME HTML ou .docx."}),"\n",(0,t.jsxs)(n.li,{children:["Se desejar eliminar um link de ",(0,t.jsx)(n.em,{children:"objRange"}),", consulte o par\xe1grafo ",(0,t.jsx)(n.em,{children:"Manejar URLs"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"exemplo-1",children:"Exemplo 1"}),"\n",(0,t.jsx)(n.p,{children:"Se quiser agregar um link a seu website na \xe1rea de rodap\xe9 de seu documento:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0var $footer : Object\n\xa0$footer:=WP Get footer(WPArea;1)\n\xa0WP SET TEXT($footer;"Please visit our website";wk replace)\n\xa0WP SET LINK($footer;New object("url";"http://www.4d.com"))\n'})}),"\n",(0,t.jsx)(n.h2,{id:"exemplo-2",children:"Exemplo 2"}),"\n",(0,t.jsx)(n.p,{children:"Se quiser criar uma tabela de conte\xfado com links utilizando todos os marcadores em seu documento:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0var $i;$n;$p;$memoStart : Integer\n\xa0var $range;$link;$toc;$tocRange;$positionInfo;$target : Object\n\xa0var $text : Text\n\xa0\n\xa0ARRAY TEXT($_bookmarks;0)\n\xa0WP GET BOOKMARKS(WParea1;$_bookmarks)\xa0//encontra todos os marcadores\n\xa0\n\xa0$n:=Size of array($_bookmarks)\n\xa0If($n>0)\n\xa0\xa0\xa0\xa0$tocRange:=WP Text range(WParea1;wk start text;wk start text)\xa0//encontra o come\xe7o do texto\n\xa0\xa0\xa0\xa0WP INSERT BREAK($tocRange;wk page break;wk append;wk exclude from range)\xa0//agrega um salto de p\xe1gina antes do texto\n\xa0\n\xa0\xa0\xa0\xa0For($i;1;$n)\xa0// Insere a tabela de conte\xfados e links\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$range:=WP Bookmark range(WParea1;$_bookmarks{$i})\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$positionInfo:=WP Get position($range)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$memoStart:=$tocRange.end\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET TEXT($tocRange;Char(Tab)+$_bookmarks{$i}+Char(Tab)+String($positionInfo.page);wk append;wk include in range)\n\xa0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$target:=WP Text range($tocRange;$memoStart+1;$memoStart+1+Length($_bookmarks{$i}))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$link:=New object("bookmark";$_bookmarks{$i})\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET LINK($target;$link)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP INSERT BREAK($tocRange;wk line break;wk append;wk include in range)\n\xa0\xa0\xa0\xa0End for\n\xa0End if\n'})}),"\n",(0,t.jsx)(n.h2,{id:"exemplo-3",children:"Exemplo 3"}),"\n",(0,t.jsx)(n.p,{children:'Se quiser definir um link a um m\xe9todo 4D em cada string "4D" no documento:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-4d",children:'\xa0var $text,$find : Text\n\xa0var $p : Integer\n\xa0var $range;$link : Object\n\xa0\n\xa0$text:=WP Get text(wpArea;wk expressions as value)\xa0//recupera todo o texto do documento\n\xa0\n\xa0$find:="4D"\xa0//destino para o link\n\n\n\xa0$p:=Position($find;$text)\xa0//recorre o texto para encontrar todas as inst\xe2ncias de objetivo\n\xa0If($p>0)\n\xa0\xa0\xa0\xa0$range:=WP Text range(wpArea;$p;$p+Length($find))\xa0//define a longitude de objetivo\n\xa0\xa0//create the link object\n\xa0\xa0\xa0\xa0$link:=New object("method";"myAlert";"parameter";"4D rocks!")\xa0//N\xe3o se esque\xe7a de autorizar com SET ALLOWED METHODS \xa0\n\xa0\n\xa0\xa0\xa0\xa0WP SET LINK($range;$link)\n\xa0End if\n\n\n'})}),"\n",(0,t.jsx)(n.h2,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"/docs/pt/20-R9/WritePro/commands/wp-get-links",children:"WP Get links"})})]})}function m(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},250065:function(e,n,r){r.d(n,{Z:()=>a,a:()=>i});var o=r(667294);let t={},s=o.createContext(t);function i(e){let n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);