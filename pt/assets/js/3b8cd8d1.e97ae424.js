"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[49568],{603905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>k});var n=a(667294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),p=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(d.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=p(a),k=r,u=c["".concat(d,".").concat(k)]||c[k]||s[k]||o;return a?n.createElement(u,l(l({ref:t},m),{},{components:a})):n.createElement(u,l({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=c;var i={};for(var d in t)hasOwnProperty.call(t,d)&&(i[d]=t[d]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},9302:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>d,toc:()=>m});a(667294);var n=a(603905);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r.apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const l={id:"WebSocketServerClass",title:"WebSocketServer"},i=void 0,d={unversionedId:"API/WebSocketServerClass",id:"version-20-R5/API/WebSocketServerClass",title:"WebSocketServer",description:"A classe WebSocketServer permite-lhe criar e configurar um servidor WebSocket em 4D. Quando o servidor 4D WebSocket estiver ativo, voc\xea poder\xe1 abrir e usar conex\xf5es WebSocket entre o 4D e os clientes usando a classe [WebSocketConnection] (WebSocketConnectionClass.md).",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R5/API/WebSocketServerClass.md",sourceDirName:"API",slug:"/API/WebSocketServerClass",permalink:"/docs/pt/API/WebSocketServerClass",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FWebSocketServerClass.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"WebSocketServerClass",title:"WebSocketServer"},sidebar:"docs",previous:{title:"WebSocketConnection",permalink:"/docs/pt/API/WebSocketConnectionClass"},next:{title:"ZIPArchive",permalink:"/docs/pt/API/ZipArchiveClass"}},p={},m=[{value:"Requisitos",id:"requisitos",level:3},{value:"Exemplo",id:"exemplo",level:3},{value:"Objecto WebSocketServer",id:"objecto-websocketserver",level:3},{value:"4D.WebSocketServer.new()",id:"4dwebsocketservernew",level:2},{value:"Par\xe2metro <em>WSSHandler</em>",id:"par\xe2metro-wsshandler",level:3},{value:"Exemplo de classe <code>WSSHandler</code>",id:"exemplo-de-classe-wsshandler",level:3},{value:"objeto <code>request</code>",id:"objeto-request",level:3},{value:"objeto <code>connectionHandler</code>",id:"objeto-connectionhandler",level:3},{value:"Exemplo de classe <code>connectionHandler</code>",id:"exemplo-de-classe-connectionhandler",level:3},{value:"Par\xe2metro <em>options</em>",id:"par\xe2metro-options",level:3},{value:".connections",id:"connections",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:4},{value:".dataType",id:"datatype",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-1",level:4},{value:".handler",id:"handler",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-2",level:4},{value:".path",id:"path",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-3",level:4},{value:".terminate()",id:"terminate",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-4",level:4},{value:".terminated",id:"terminated",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-5",level:4}],s={toc:m};function c(e){var{components:t}=e,a=o(e,["components"]);return(0,n.kt)("wrapper",r({},s,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"A classe ",(0,n.kt)("inlineCode",{parentName:"p"},"WebSocketServer")," permite-lhe criar e configurar um servidor WebSocket em 4D. Quando o servidor 4D WebSocket estiver ativo, voc\xea poder\xe1 abrir e usar conex\xf5es WebSocket entre o 4D e os clientes usando a classe ","[",(0,n.kt)("inlineCode",{parentName:"p"},"WebSocketConnection"),"]"," (WebSocketConnectionClass.md)."),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Hist\xf3ria"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Mudan\xe7as"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"20"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Adicionado"))))),(0,n.kt)("admonition",r({},{title:"Sobre os servidores WebSocket",type:"note"}),(0,n.kt)("p",{parentName:"admonition"},"O protocolo WebSocket proporciona um canal de comunica\xe7\xe3o full-duplex entre um servidor WebSocket e um cliente (por exemplo, um navegador Web). Para obter mais informa\xe7\xf5es sobre servidores WebSocket, leia ","[esta p\xe1gina na Wikipedia]"," (",(0,n.kt)("a",r({parentName:"p"},{href:"https://en.wikipedia.org/wiki/WebSocket"}),"https://en.wikipedia.org/wiki/WebSocket"),").")),(0,n.kt)("admonition",r({},{title:"Veja tamb\xe9m",type:"info"}),(0,n.kt)("p",{parentName:"admonition"},"Consulte tamb\xe9m ","[esta postagem no blog]"," (",(0,n.kt)("a",r({parentName:"p"},{href:"https://blog.4d.com/new-built-in-websocket-server/"}),"https://blog.4d.com/new-built-in-websocket-server/"),") sobre o servidor 4D WebSocket.")),(0,n.kt)("h3",r({},{id:"requisitos"}),"Requisitos"),(0,n.kt)("p",null,"Para criar e manipular seu servidor WebSocket em 4D, \xe9 preciso usar duas classes embutidas em 4D:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"essa classe (",(0,n.kt)("inlineCode",{parentName:"li"},"4D.WebSocketServer"),") para gerenciar o pr\xf3prio servidor,"),(0,n.kt)("li",{parentName:"ul"},"the ",(0,n.kt)("a",r({parentName:"li"},{href:"/docs/pt/API/WebSocketConnectionClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))," class to manage connections and messages.")),(0,n.kt)("p",null,"Al\xe9m disso, ter\xe1 de criar duas classes de utilizador que conter\xe3o fun\xe7\xf5es de retorno de chamada:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"uma classe de usu\xe1rio para tratar as liga\xe7\xf5es ao servidor,"),(0,n.kt)("li",{parentName:"ul"},"uma classe de usu\xe1rio para tratar as mensagens.")),(0,n.kt)("p",null,"Voc\xea deve ","[criar o servidor WebSocket]"," (#4dwebsocketservernew) em um ",(0,n.kt)("a",r({parentName:"p"},{href:"https://doc.4d.com/4dv19R/help/command/en/page1389.html"}),"worker")," para manter a conex\xe3o ativa."),(0,n.kt)("p",null,"O ","[4D Web Server]"," (WebServerClass.md) deve ser iniciado."),(0,n.kt)("h3",r({},{id:"exemplo"}),"Exemplo"),(0,n.kt)("p",null,"Neste exemplo b\xe1sico, o nosso servidor WebSocket devolver\xe1 mensagens em mai\xfasculas."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Crie o servidor WebSocket utilizando um trabalhador (obrigat\xf3rio) e passe a sua classe de liga\xe7\xe3o ao servidor como par\xe2metro:")),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'    //criar uma inst\xe2ncia da classe de usu\xe1rio\n    //que manipular\xe1 as conex\xf5es com o servidor\nvar $handler:cs.myServerHandler\n$handler:=cs.myServerHandler.new()\n\nCALL WORKER("WebSocketServer"; Formula(wss:=4D.WebSocketServer.new($handler)))  \n    //atribuir uma vari\xe1vel (wss) ao WebSocket permite que voc\xea  \n    //chame wss.terminate() posteriormente\n')),(0,n.kt)("ol",r({},{start:2}),(0,n.kt)("li",{parentName:"ol"},"Defina a classe de usu\xe1rio ",(0,n.kt)("inlineCode",{parentName:"li"},"myServerHandler")," que cont\xe9m a(s) fun\xe7\xe3o(\xf5es) de retorno de chamada usada(s) para tratar as conex\xf5es com o servidor:")),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),"//classe myServerHandler\n\nFunction onConnection($wss : Object; $event : Object) : Object\n    //retorna uma inst\xe2ncia da classe de usu\xe1rio\n    //que tratar\xe1 as mensagens\n    return cs.myConnectionHandler.new() \n")),(0,n.kt)("ol",r({},{start:3}),(0,n.kt)("li",{parentName:"ol"},"Defina a classe de usu\xe1rio ",(0,n.kt)("inlineCode",{parentName:"li"},"myConnectionHandler")," que cont\xe9m a(s) fun\xe7\xe3o(\xf5es) de retorno de chamada usada(s) para tratar mensagens:")),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),"// minhaConnectionHandler classe\n\nFunction onMessage($ws : 4D.WebSocketConnecation; $message : Object)\n    \u251c//reenvia a mensagem em mai\xfasculas \n    $ws.send(Uppercase($message.data))\n\n")),(0,n.kt)("admonition",r({},{title:"JS do lado do cliente",type:"tip"}),(0,n.kt)("p",{parentName:"admonition"},"Consulte ","[esta publica\xe7\xe3o no blog]"," (",(0,n.kt)("a",r({parentName:"p"},{href:"https://blog.4d.com/websocket-server/"}),"https://blog.4d.com/websocket-server/"),") para ver um exemplo de c\xf3digo Javascript do lado do cliente que manipula uma conex\xe3o WebSocket.")),(0,n.kt)("h3",r({},{id:"objecto-websocketserver"}),"Objecto WebSocketServer"),(0,n.kt)("p",null,"Os objectos de servidor WebSocket fornecem as seguintes propriedades e fun\xe7\xf5es:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null})))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#connections"}),(0,n.kt)("strong",{parentName:"a"},".connections")," : Collection"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;todas as conex\xf5es atuais tratadas pelo servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#dataType"}),(0,n.kt)("strong",{parentName:"a"},".dataType")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;o tipo de dados recebidos ou enviados")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#handler"}),(0,n.kt)("strong",{parentName:"a"},".handler")," : Object"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;o acess\xf3rio que obt\xe9m o objeto ",(0,n.kt)("inlineCode",{parentName:"td"},"WSSHandler")," usado para iniciar o servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#path"}),(0,n.kt)("strong",{parentName:"a"},".path")," : Text"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp; o padr\xe3o do caminho para acessar o servidor de WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#terminate"}),(0,n.kt)("strong",{parentName:"a"},".terminate()")),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;fecha o servidor de WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#terminated"}),(0,n.kt)("strong",{parentName:"a"},".terminated")," : Boolean"),"&","nbsp;","&","nbsp;","&","nbsp;","&","nbsp;True se o servidor de WebSocket estiver fechado")))),(0,n.kt)("h2",r({},{id:"4dwebsocketservernew"}),"4D.WebSocketServer.new()"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"4D.WebSocketServer.new"),"( ",(0,n.kt)("em",{parentName:"p"},"WSSHandler")," : Object { ; ",(0,n.kt)("em",{parentName:"p"},"options")," : Object } ) : 4D.WebSocketServer"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#wsshandler-parameter"}),"WSSHandler")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto da classe de utilizador que declara as chamadas de retorno do servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#options-parameter"}),"options")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros de configura\xe7\xe3o do WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Resultados"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocketServer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Novo objeto WebSocketServer")))),(0,n.kt)("p",null,"A fun\xe7\xe3o ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.WebSocketServer.new()")," cria e inicia um servidor WebSocket que usar\xe1 os retornos de chamada especificados ",(0,n.kt)("em",{parentName:"p"},"WSSHandler")," e (opcionalmente) ",(0,n.kt)("em",{parentName:"p"},"op\xe7\xf5es"),"  e retorna um objeto ",(0,n.kt)("inlineCode",{parentName:"p"},"4D.WebSocketServer"),"."),(0,n.kt)("p",null,"A chamada dessa fun\xe7\xe3o requer que o ","[4D Web Server]"," (WebServerClass.md) seja iniciado. O ",(0,n.kt)("strong",{parentName:"p"},"host")," e a ",(0,n.kt)("strong",{parentName:"p"},"port")," do servidor WebSocket s\xe3o os mesmos que o host e a porta do 4D Web Server."),(0,n.kt)("h3",r({},{id:"par\xe2metro-wsshandler"}),"Par\xe2metro ",(0,n.kt)("em",{parentName:"h3"},"WSSHandler")),(0,n.kt)("p",null,"No par\xe2metro ",(0,n.kt)("em",{parentName:"p"},"WSSHandler"),", passe uma inst\xe2ncia de uma classe de usu\xe1rio que ser\xe1 chamada sempre que ocorrer um evento no servidor WebSocket - essencialmente, eventos de conex\xe3o. A classe deve definir as seguintes fun\xe7\xf5es de retorno de chamada (somente ",(0,n.kt)("inlineCode",{parentName:"p"},"onConnection")," \xe9 obrigat\xf3rio):"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propriedade"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Por padr\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onConnection"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"(obrigat\xf3rio) Chamada de retorno quando \xe9 iniciada uma nova liga\xe7\xe3o de cliente (ver abaixo)"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"indefinido")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onOpen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Callback quando o servidor WebSocket \xe9 iniciado (ver abaixo)"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"indefinido")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onTerminate"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Callback quando o servidor WebSocket \xe9 terminado (ver abaixo)"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"indefinido")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onError"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Callback quando ocorre um erro (ver abaixo)"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"indefinido")))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"WSHandler.onConnection"),"(",(0,n.kt)("em",{parentName:"p"},"WSServer")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object) : Object | null"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"WSServer"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocketServer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto actual do servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"connection"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"request"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"objeto ",(0,n.kt)("inlineCode",{parentName:"td"},"request"),". Cont\xe9m informa\xe7\xf5es sobre o pedido de liga\xe7\xe3o (ver abaixo)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Resultado"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"->"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"#connectionhandler-object"}),(0,n.kt)("inlineCode",{parentName:"a"},"connectionHandler")," object")," (veja abaixo). Se essa fun\xe7\xe3o retornar um objeto ",(0,n.kt)("inlineCode",{parentName:"td"},"connectionHandler"),", um objeto ",(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass#websocketconnection-object"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))," \xe9 criado automaticamente e adicionado \xe0 ",(0,n.kt)("a",r({parentName:"td"},{href:"#connections"}),"cole\xe7\xe3o de conex\xf5es"),". Esse objeto \xe9 ent\xe3o recebido como par\xe2metro em cada fun\xe7\xe3o do objeto ",(0,n.kt)("inlineCode",{parentName:"td"},"connectionHandler"),". Se o valor devolvido for nulo ou indefinido, a liga\xe7\xe3o \xe9 cancelada.")))),(0,n.kt)("p",null,"Esta chamada de retorno \xe9 feita quando o handshake estiver conclu\xeddo. Ele deve ser chamado com um objeto ","[",(0,n.kt)("inlineCode",{parentName:"p"},"connectionHandler"),"]"," v\xe1lido (#connectionhandler-object) para criar a conex\xe3o WebSocket; caso contr\xe1rio, a conex\xe3o ser\xe1 cancelada."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"WSHandler.onOpen"),"(",(0,n.kt)("em",{parentName:"p"},"WSServer")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"WSServer"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocketServer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto actual do servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"open"')))),(0,n.kt)("p",null,"Evento emitido quando o servidor websocket \xe9 iniciado."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"WSHandler.onTerminate"),"(",(0,n.kt)("em",{parentName:"p"},"WSServer")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"WSServer"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocketServer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto actual do servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"terminate"')))),(0,n.kt)("p",null,"Evento emitido quando o servidor HTTP ou o servidor WebSocket \xe9 encerrado."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"WSHandler.onError"),"(",(0,n.kt)("em",{parentName:"p"},"WSServer")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"WSServer"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"4D.WebSocketServer"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto actual do servidor WebSocket")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"error"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Cole\xe7\xe3o da pilha de erros 4D em caso de erro de execu\xe7\xe3o",(0,n.kt)("li",null,"[","].errCode (number) - C\xf3digo de erro 4D"),(0,n.kt)("li",null,"[","].message (text) - Descri\xe7\xe3o do erro 4D"),(0,n.kt)("li",null,"[","].componentSignature (text) - Assinatura do componente interno que retornou o erro"))))),(0,n.kt)("p",null,"Evento emitido quando ocorre um erro no servidor WebSocket."),(0,n.kt)("h3",r({},{id:"exemplo-de-classe-wsshandler"}),"Exemplo de classe ",(0,n.kt)("inlineCode",{parentName:"h3"},"WSSHandler")),(0,n.kt)("p",null,"Este exemplo de um recurso b\xe1sico de bate-papo ilustra como lidar com conex\xf5es de servidor WebSocket em uma classe ",(0,n.kt)("em",{parentName:"p"},"WSSHandler"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'//minhaWSServerHandler classe \n\nFun\xe7\xe3o onConnection($wss : Objeto; $event : Objeto) : Object\n\n    \u251cIf (VerifyAddress($event.request. emoteAddress))\n        \u251c// O m\xe9todo VerifyAddress valida o endere\xe7o do cliente\n        \u251c// O objeto WSConnectionHandler retornado ser\xe1 usado \n        \u251c// por 4D para instanciar o 4D. Objeto ebSocketConnection\n        ^\\\\// relacionado a esta conex\xe3o\n        \u251creturn cs.myConnectionHandler. ew()   \n        \u2122\ufe0f// Ver connectionHandler objeto\n    \xebElse \n        \u251c// A conex\xe3o \xe9 cancelada\u27b2      \n        \xbd return Null \n    \u251cEnd se \n\nFunction onOpen($wss : Object; $event : Objeto)\nLogFile("*** Servidor iniciado")\n\nFun\xe7\xe3o onTerminate($wss : Objeto; $event : Objeto)\nLogFile("*** Servidor fechado")\n\nFun\xe7\xe3o onError($wss : Objeto; $event : Objeto)\nLogFile("! ! Erro no servidor: "+$event. rrors.first().message)\n\n')),(0,n.kt)("h3",r({},{id:"objeto-request"}),"objeto ",(0,n.kt)("inlineCode",{parentName:"h3"},"request")),(0,n.kt)("p",null,"Um objeto ",(0,n.kt)("inlineCode",{parentName:"p"},"request")," cont\xe9m as seguintes propriedades:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"headers"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"O pedido HTTP GET do cliente. ",(0,n.kt)("inlineCode",{parentName:"td"},"headers.key=value")," (o valor pode ser uma cole\xe7\xe3o se a mesma chave aparecer v\xe1rias vezes)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"query"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto que cont\xe9m os par\xe2metros URL. Por exemplo, se os par\xe2metros s\xe3o: ",(0,n.kt)("inlineCode",{parentName:"td"},"?key1=value1&key2=value2")," -> ",(0,n.kt)("inlineCode",{parentName:"td"},"query.key1=value1"),", ",(0,n.kt)("inlineCode",{parentName:"td"},"query.key2=value2"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"url"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"cont\xe9m apenas o URL que est\xe1 presente no pedido HTTP efectivo. Ex: ",(0,n.kt)("inlineCode",{parentName:"td"},"GET /status?name=ryan HTTP/1.1"),' -> url="/status?name=ryan"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"remoteAddress"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Endere\xe7o IP do cliente")))),(0,n.kt)("h3",r({},{id:"objeto-connectionhandler"}),"objeto ",(0,n.kt)("inlineCode",{parentName:"h3"},"connectionHandler")),(0,n.kt)("p",null,"Como resultado do ",(0,n.kt)("inlineCode",{parentName:"p"},"WSHandler. callback nConnection"),", passe um objeto ",(0,n.kt)("inlineCode",{parentName:"p"},"connectionHandler"),", que \xe9 uma inst\xe2ncia de uma classe de usu\xe1rio que ser\xe1 chamada toda vez que um evento ocorrer na conex\xe3o de WebSocket --essencialmente, mensagens recebidas. A classe deve definir as seguintes fun\xe7\xf5es de retorno de chamada (somente ",(0,n.kt)("inlineCode",{parentName:"p"},"onConnection")," \xe9 obrigat\xf3rio):"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onMessage"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"(obrigat\xf3rio) Fun\xe7\xe3o chamada quando \xe9 recebida uma nova mensagem desta liga\xe7\xe3o")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onOpen"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fun\xe7\xe3o chamada quando o ",(0,n.kt)("inlineCode",{parentName:"td"},"4D.WebSocketConnection")," \xe9 criado")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onTerminate"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fun\xe7\xe3o chamada quando esta liga\xe7\xe3o \xe9 terminada")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"onError"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/FunctionClass"}),"Function")),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Fun\xe7\xe3o chamada quando ocorre um erro")))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"connectionHandler.onMessage"),"(",(0,n.kt)("em",{parentName:"p"},"ws")," : 4D.WebSocketConnection ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ws"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto de liga\xe7\xe3o WebSocket actual")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"message"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"data"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text / Blob / Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"dados enviados pelo cliente")))),(0,n.kt)("p",null,"Este Callback para dados WebSocket. Chamado sempre que o WebSocket recebe dados."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"connectionHandler.onOpen"),"(",(0,n.kt)("em",{parentName:"p"},"ws")," : 4D.WebSocketConnection ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ws"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto de liga\xe7\xe3o WebSocket actual")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"open"')))),(0,n.kt)("p",null,"Chamado quando o objeto ",(0,n.kt)("inlineCode",{parentName:"p"},"connectionHandler")," for criado (ap\xf3s o evento ",(0,n.kt)("inlineCode",{parentName:"p"},"WSS.onConnection"),")."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"connectionHandler.onTerminate"),"(",(0,n.kt)("em",{parentName:"p"},"ws")," : 4D.WebSocketConnection ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ws"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto de liga\xe7\xe3o WebSocket actual")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"terminate"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"code"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"C\xf3digo de estado que indica o motivo pelo qual a liga\xe7\xe3o foi encerrada. Se o WebSocket n\xe3o retorna um c\xf3digo de erro, ",(0,n.kt)("inlineCode",{parentName:"td"},"code")," est\xe1 definido para 1005 se nenhum erro ocorreu ou para 1006 se houve um erro.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"reason"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Cadeia de caracteres que explica porque \xe9 que a liga\xe7\xe3o foi encerrada. Se o websocket n\xe3o devolver um motivo, o c\xf3digo \xe9 indefinido")))),(0,n.kt)("p",null,"Fun\xe7\xe3o chamada quando o WebSocket \xe9 fechado."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"connectionHandler.onError"),"(",(0,n.kt)("em",{parentName:"p"},"ws")," : 4D.WebSocketConnection ; ",(0,n.kt)("em",{parentName:"p"},"event")," : Object)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"ws"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass"}),(0,n.kt)("inlineCode",{parentName:"a"},"4D.WebSocketConnection"))),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Objecto de liga\xe7\xe3o WebSocket actual")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"event"'),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"<-"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Par\xe2metros")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"type"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),'"error"')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"errors"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Collection"),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:"center"}),"Cole\xe7\xe3o de erros 4D stack em caso de erro de execu\xe7\xe3o",(0,n.kt)("li",null,"[","].errCode (number) - c\xf3digo de erro 4D"),(0,n.kt)("li",null,"[","]. essagem (texto) - Descri\xe7\xe3o do erro 4D"),(0,n.kt)("li",null,"[","].componentSignature (texto) - Assinatura do componente interno que retornou o erro")),(0,n.kt)("td",r({parentName:"tr"},{align:null}))))),(0,n.kt)("p",null,"Fun\xe7\xe3o chamada quando ocorre um erro."),(0,n.kt)("h3",r({},{id:"exemplo-de-classe-connectionhandler"}),"Exemplo de classe ",(0,n.kt)("inlineCode",{parentName:"h3"},"connectionHandler")),(0,n.kt)("p",null,"Este exemplo de um recurso b\xe1sico de bate-papo ilustra como tratar mensagens em uma classe ",(0,n.kt)("em",{parentName:"p"},"connectionHandler"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'// myConnectionHandler Class\n\nFunction onMessage($ws : 4D.WebSocketConnection; $message : Object)\n    // Reenvia a mensagem a todos os clientes de chat   \n    This.broadcast($ws;$message.data)\n\nFunction onOpen($ws : 4D.WebSocketConnection; $message : Object)\n    // Envia uma mensagem aos novos usu\xe1rios conectados\n    $ws.send("Welcome on the chat!")    \n    // Envia a mensagem "Novo cliente conectado" a todos os outros clientes de chat\n    This.broadcast($ws; "New client connected")\n\nFunction onTerminate($ws : 4D.WebSocketConnection; $message : Object)\n    // Envia a mensagem "Client disconnected" a todos os outros clientes de bate-papo\n    This.broadcast($ws; "Client disconnected")\n\nFunction broadcast($ws : 4D.WebSocketConnection; $message:text)\n    var $client:4D.WebSocketConnection\n    // Reenviar a mensagem a todos os clientes de bate-papo\n    For each ($client; $ws.wss.connections)\n        // Verificar se o id n\xe3o \xe9 a conex\xe3o atual\n        If ($client.id#$ws.id)\n            $client.send($message)\n        End if \n    End for each \n\n')),(0,n.kt)("h3",r({},{id:"par\xe2metro-options"}),"Par\xe2metro ",(0,n.kt)("em",{parentName:"h3"},"options")),(0,n.kt)("p",null,"No par\xe2metro opcional ",(0,n.kt)("em",{parentName:"p"},"options"),", passe um objeto que contenha as seguintes propriedades:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Propriedade"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Por padr\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"path"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Representa o caminho para aceder ao servidor WebSocket. Se n\xe3o for definido um caminho, o servidor WebSocket gere todas as liga\xe7\xf5es"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"indefinido")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null}),"dataType"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"Tipo dos dados recebidos atrav\xe9s da fun\xe7\xe3o ",(0,n.kt)("inlineCode",{parentName:"td"},"connectionHandler.onMessage")," e os dados enviados por ",(0,n.kt)("a",r({parentName:"td"},{href:"/docs/pt/API/WebSocketConnectionClass#send"}),(0,n.kt)("inlineCode",{parentName:"a"},"WebSocketConnection.send()")),'. Values: "text", "blob","object"). Se "object": (enviar) transforma o objecto num formato json e envia-o; (recep\xe7\xe3o): recebe o formato json e transforma-o em objecto'),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"text")))),(0,n.kt)("h2",r({},{id:"connections"}),".connections"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".connections")," : Collection"),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A propriedade ",(0,n.kt)("inlineCode",{parentName:"p"},".connections")," cont\xe9m todas as conex\xf5es atuais tratadas pelo servidor WebSocket. Cada elemento da cole\xe7\xe3o \xe9 um objeto ","[",(0,n.kt)("inlineCode",{parentName:"p"},"WebSocketConnection"),"]"," (WebSocketConnectionClass.md)."),(0,n.kt)("p",null,"Quando uma conex\xe3o \xe9 encerrada, seu ",(0,n.kt)("a",r({parentName:"p"},{href:"/docs/pt/API/WebSocketConnectionClass#status"}),(0,n.kt)("inlineCode",{parentName:"a"},"status")),' muda para "Fechado" e ele \xe9 removido desta cole\xe7\xe3o.'),(0,n.kt)("h2",r({},{id:"datatype"}),".dataType"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".dataType")," : Text"),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o-1"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A propriedade ",(0,n.kt)("inlineCode",{parentName:"p"},".dataType")," cont\xe9m o tipo de dados recebidos ou enviados."),(0,n.kt)("p",null,"Esta propriedade \xe9 s\xf3 de leitura."),(0,n.kt)("h2",r({},{id:"handler"}),".handler"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".handler")," : Object"),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o-2"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A propriedade ",(0,n.kt)("inlineCode",{parentName:"p"},".handler")," cont\xe9m o acess\xf3rio que obt\xe9m o objeto ",(0,n.kt)("inlineCode",{parentName:"p"},"WSSHandler")," usado para iniciar o servidor WebSocket."),(0,n.kt)("h2",r({},{id:"path"}),".path"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".path")," : Text"),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o-3"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A propriedade ",(0,n.kt)("inlineCode",{parentName:"p"},".path")," cont\xe9m  o padr\xe3o do caminho para acessar o servidor de WebSocket . Se n\xe3o for definido um caminho, o servidor WebSocket gere todas as liga\xe7\xf5es."),(0,n.kt)("p",null,"Esta propriedade \xe9 s\xf3 de leitura."),(0,n.kt)("h2",r({},{id:"terminate"}),".terminate()"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".terminate()")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Par\xe2metro"),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Tipo"),(0,n.kt)("th",r({parentName:"tr"},{align:"center"})),(0,n.kt)("th",r({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:null})),(0,n.kt)("td",r({parentName:"tr"},{align:"center"})),(0,n.kt)("td",r({parentName:"tr"},{align:null}),"N\xe3o exige nenhum par\xe2metro")))),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o-4"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A fun\xe7\xe3o ",(0,n.kt)("inlineCode",{parentName:"p"},".terminate()")," fecha o servidor de WebSocket."),(0,n.kt)("h2",r({},{id:"terminated"}),".terminated"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},".terminated")," : Boolean"),(0,n.kt)("h4",r({},{id:"descri\xe7\xe3o-5"}),"Descri\xe7\xe3o"),(0,n.kt)("p",null,"A propriedade ",(0,n.kt)("inlineCode",{parentName:"p"},".terminated")," cont\xe9m True se o servidor de WebSocket estiver fechado."),(0,n.kt)("p",null,"Esta propriedade \xe9 s\xf3 de leitura."))}c.isMDXComponent=!0}}]);