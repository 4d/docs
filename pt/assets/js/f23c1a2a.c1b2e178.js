"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[63867],{64866:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>t,metadata:()=>i,toc:()=>u});var o=n(474848),r=n(28453);const t={id:"authUsers",title:"Usu\xe1rios e sess\xf5es"},a=void 0,i={id:"REST/authUsers",title:"Usu\xe1rios e sess\xf5es",description:"Autentica\xe7\xe3o de usu\xe1rios",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-18/REST/authUsers.md",sourceDirName:"REST",slug:"/REST/authUsers",permalink:"/docs/pt/18/REST/authUsers",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20REST%2FauthUsers.md%20(18)&body=Please%20enter%20your%20comment%3A",tags:[],version:"18",frontMatter:{id:"authUsers",title:"Usu\xe1rios e sess\xf5es"},sidebar:"docs",previous:{title:"Configura\xe7\xe3o do servidor",permalink:"/docs/pt/18/REST/configuration"},next:{title:"Obter informa\xe7\xe3o do servidor",permalink:"/docs/pt/18/REST/genInfo"}},d={},u=[{value:"Autentica\xe7\xe3o de usu\xe1rios",id:"autentica\xe7\xe3o-de-usu\xe1rios",level:2},{value:"Cookie de sess\xe3o",id:"cookie-de-sess\xe3o",level:2},{value:"Exemplo",id:"exemplo",level:3}];function c(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h2,{id:"autentica\xe7\xe3o-de-usu\xe1rios",children:"Autentica\xe7\xe3o de usu\xe1rios"}),"\n",(0,o.jsx)(s.p,{children:"Como primeiro passo para abrir uma sess\xe3o REST no servidor 4D, o usu\xe1rio que envia a solicitude deve estar autenticado."}),"\n",(0,o.jsxs)(s.p,{children:["You log in a user to your application by passing the user's name and password to ",(0,o.jsx)(s.a,{href:"/docs/pt/18/REST/directory#directorylogin",children:(0,o.jsx)(s.code,{children:"$directory/login"})}),"."]}),"\n",(0,o.jsx)(s.p,{children:"Quando um usu\xe1rio \xe9 registrado com sucesso, uma sess\xe3o \xe9 aberta. See below to know how to handle the session cookie in subsequent client requests, if necessary."}),"\n",(0,o.jsx)(s.p,{children:"A sess\xe3o ser\xe1 encerrada automaticamente quando o tempo limite for atingido."}),"\n",(0,o.jsx)(s.h2,{id:"cookie-de-sess\xe3o",children:"Cookie de sess\xe3o"}),"\n",(0,o.jsx)(s.p,{children:"Each REST request is handled through a specific session on the 4D server."}),"\n",(0,o.jsxs)(s.p,{children:["When a first valid REST request is received, the server creates the session and sends a session cookie named ",(0,o.jsx)(s.code,{children:"WASID4D"})," in the ",(0,o.jsx)(s.strong,{children:'"Set-Cookie" response header'}),", containing the session UUID, for example:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{children:"WASID4D=EA0400C4D58FF04F94C0A4XXXXXX3\n"})}),"\n",(0,o.jsxs)(s.p,{children:["In the subsequent REST requests, make sure this cookie is included in the ",(0,o.jsx)(s.strong,{children:'"Cookie" request header'})," so that you will reuse the same session. Caso contr\xe1rio, uma nova sess\xe3o ser\xe1 aberta e outra licen\xe7a ser\xe1 usada."]}),"\n",(0,o.jsx)(s.h3,{id:"exemplo",children:"Exemplo"}),"\n",(0,o.jsxs)(s.p,{children:["A maneira de lidar com os cookies de sess\xe3o depende, na verdade, de seu cliente HTTP. Este exemplo mostra como extrair e reenviar o cookie de sess\xe3o no contexto de solicita\xe7\xf5es tratadas por meio do comando 4D ",(0,o.jsx)(s.code,{children:"HTTP Request"}),"."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-4d",children:'// Creating headers\nARRAY TEXT(headerNames;0)\nARRAY TEXT(headerValues;0)\n\nAPPEND TO ARRAY(headerNames;"username-4D")\nAPPEND TO ARRAY(headerNames;"session-4D-length")\nAPPEND TO ARRAY(headerNames;"hashed-password-4D")\n\nAPPEND TO ARRAY(headerValues;"kind user")\nAPPEND TO ARRAY(headerValues;"60")\nAPPEND TO ARRAY(headerValues;Generate digest("test";4D digest))\n\nC_OBJECT($response)\n$response:=New object\n\n//This request opens a session for the user "kind user"\n$result:=HTTP Request(HTTP POST method;"127.0.0.1:8044/rest/$directory/login";"";\\  \n    $response;headerNames;headerValues;*)\n\n\n//Build new arrays for headers with only the cookie WASID4D\nbuildHeader(->headerNames;->headerValues)\n\n//This other request will not open a new session\n$result:=HTTP Request(HTTP GET method;"127.0.0.1:8044/rest/$catalog";"";\\  \n    $response;headerNames;headerValues;*)\n'})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-4d",children:'// buildHeader project method  \n\nC_POINTER($pointerNames;$1;$pointerValues;$2)\nARRAY TEXT($headerNames;0)\nARRAY TEXT($headerValues;0)\n\nCOPY ARRAY($1->;$headerNames)\nCOPY ARRAY($2->;$headerValues)\n\n$indexCookie:=Find in array($headerValues;"WASID4D@")\n$cookie:=$headerValues{$indexCookie}\n$start:=Position("WASID4D";$cookie)\n$end:=Position(";";$cookie)\n$uuid:= Substring($cookie;$start;$end-$start)\n\nARRAY TEXT($headerNames;1)\nARRAY TEXT($headerValues;1)\n\n$headerNames{1}:="Cookie"\n$headerValues{1}:=$uuid\n\nCOPY ARRAY($headerNames;$1->)\nCOPY ARRAY($headerValues;$2->)\n'})})]})}function l(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var o=n(296540);const r={},t=o.createContext(r);function a(e){const s=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(t.Provider,{value:s},e.children)}}}]);