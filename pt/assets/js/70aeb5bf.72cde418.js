"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["27839"],{170559:function(e,r,s){s.r(r),s.d(r,{frontMatter:()=>t,toc:()=>i,default:()=>m,metadata:()=>n,assets:()=>d,contentTitle:()=>c});var n=JSON.parse('{"id":"commands-legacy/receive-buffer","title":"RECEIVE BUFFER","description":"RECEIVE BUFFER ( receiveVar )","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R10/commands-legacy/receive-buffer.md","sourceDirName":"commands-legacy","slug":"/commands/receive-buffer","permalink":"/docs/pt/20-R10/commands/receive-buffer","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Freceive-buffer.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"receive-buffer","title":"RECEIVE BUFFER","slug":"/commands/receive-buffer","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"GET SERIAL PORT MAPPING","permalink":"/docs/pt/20-R10/commands/get-serial-port-mapping"},"next":{"title":"RECEIVE PACKET","permalink":"/docs/pt/20-R10/commands/receive-packet"}}'),a=s(785893),o=s(250065);let t={id:"receive-buffer",title:"RECEIVE BUFFER",slug:"/commands/receive-buffer",displayed_sidebar:"docs"},c=void 0,d={},i=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:2},{value:"Exemplo",id:"exemplo",level:2},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:2},{value:"Propriedades",id:"propriedades",level:2}];function l(e){let r={a:"a",br:"br",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"RECEIVE BUFFER"})," ( ",(0,a.jsx)(r.em,{children:"receiveVar"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(r.table,{children:[(0,a.jsx)(r.thead,{children:(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.th,{children:"Par\xe2metro"}),(0,a.jsx)(r.th,{children:"Tipo"}),(0,a.jsx)(r.th,{}),(0,a.jsx)(r.th,{children:"Descri\xe7\xe3o"})]})}),(0,a.jsx)(r.tbody,{children:(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"receiveVar"}),(0,a.jsx)(r.td,{children:"Text"}),(0,a.jsx)(r.td,{children:"\u2190"}),(0,a.jsx)(r.td,{children:"Variable to receive data"})]})})]}),"\n",(0,a.jsx)(r.h2,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,a.jsxs)(r.p,{children:["RECEIVE BUFFER l\xea a porta serial que foi aberta anteriormente com ",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/set-channel",children:"SET CHANNEL"}),". A porta serial tem um buffer que preenche com caracteres at\xe9 que um comando l\xea a partir do buffer. RECEIVE BUFFER recebe os caracteres do buffer serial, coloc\xe1-os em ",(0,a.jsx)(r.em,{children:"receiveVar"})," e limpa o buffer. Se n\xe3o houver caracteres no buffer, ent\xe3o ",(0,a.jsx)(r.em,{children:"receiveVar"})," n\xe3o conter\xe1 nada."]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Em Windows"}),(0,a.jsx)(r.br,{}),"\nA porta serial de buffer do Windows \xe9 limitada a 10 Kbytes. Isso significa que o buffer pode realizar um overflow. Quando ela estiver cheia e novos caracteres forem recebidos, os novos caracteres substituem os antigos caracteres. Os caracteres antigos est\xe3o perdidos e, portanto, \xe9 essencial que o buffer seja lido rapidamente quando novos caracteres s\xe3o recebidos."]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Em Mac OS"}),(0,a.jsx)(r.br,{}),"\nA porta serial buffer no macOS \xe9 capacidade ilimitada (dependendo da mem\xf3ria dispon\xedvel). Se o buffer estiver cheio e novos caracteres s\xe3o recebidos, os novos caracteres substituem os antigos caracteres. Os caracteres antigos est\xe3o perdidos e, portanto, \xe9 essencial que o buffer seja lido rapidamente quando novos caracteres s\xe3o recebidos."]}),"\n",(0,a.jsxs)(r.p,{children:["RECEIVE BUFFER \xe9 diferente de ",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/receive-packet",children:"RECEIVE PACKET"}),", ele leva o que est\xe1 no buffer e, em seguida, retorna imediatamente. ",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/receive-packet",children:"RECEIVE PACKET"})," aguarda at\xe9 encontrar um caractere espec\xedfico ou at\xe9 que um determinado n\xfamero de caracteres estejam no buffer"]}),"\n",(0,a.jsxs)(r.p,{children:["Durante a execu\xe7\xe3o do RECEIVE BUFFER, o usu\xe1rio pode interromper a recep\xe7\xe3o pressionando ",(0,a.jsx)(r.strong,{children:"Ctrl-Alt-Shift"})," (Windows) ou ",(0,a.jsx)(r.strong,{children:"Command"})," + ",(0,a.jsx)(r.strong,{children:"Option"})," + ",(0,a.jsx)(r.strong,{children:"Shift"})," (Macintosh). Esta interrup\xe7\xe3o gera um erro -9994, que voc\xea pode pegar com um m\xe9todo de tratamento de erros instalado usando ",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/on-err-call",children:"ON ERR CALL"}),"."]}),"\n",(0,a.jsx)(r.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,a.jsx)(r.p,{children:"O m\xe9todo de projeto LISTEN TO SERIAL PORT usa RECEIVE BUFFER para obter o texto da porta serial e acumul\xe1-lo em uma vari\xe1vel interprocesso:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-4d",children:'\xa0\xa0// ESCUTAR PORTA SERIAL\n\xa0\xa0// Abrir a porta serial\n\xa0SET CHANNEL(201;Speed 9600+Data bits 8+Stop bits one+Parity none)\n\xa0<>IP_Escutar_Porta_Serial:=True\n\xa0While(<>IP_Escutar_Porta_Serial)\n\xa0\xa0\xa0\xa0RECEIVE BUFFER($vtBuffer)\n\xa0\xa0\xa0\xa0If((Length($vtBuffer)+Length(<>vtBuffer))>MAXTEXTLEN)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0<>vtBuffer:=""\n\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0<>vtBuffer:=<>vtBuffer+$Buffer\n\xa0End while\n'})}),"\n",(0,a.jsxs)(r.p,{children:["Neste ponto, qualquer outro processo pode ler a interprocesso ",(0,a.jsx)(r.em,{children:"vtBuffer"})," para trabalhar com os dados provenientes da porta serial."]}),"\n",(0,a.jsx)(r.p,{children:"Para parar de ouvir a porta serial, basta executar:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-4d",children:"\xa0\xa0// Deixar de escutar a porta serial\n\xa0\u25CAIP_Escutar_Porta_Serial:=False\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Note que o acesso \xe0 vari\xe1vel interprocesso ",(0,a.jsx)(r.em,{children:"vtBuffer"})," deve ser protegida por um sem\xe1foro, de modo que os processos n\xe3o causar\xe3o conflito. Veja o comando ",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/semaphore",children:"Semaphore"})," para obter mais informa\xe7\xf5es."]}),"\n",(0,a.jsx)(r.h2,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/on-err-call",children:"ON ERR CALL"}),(0,a.jsx)(r.br,{}),"\n",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/receive-packet",children:"RECEIVE PACKET"}),(0,a.jsx)(r.br,{}),"\n",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/semaphore",children:"Semaphore"}),(0,a.jsx)(r.br,{}),"\n",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/set-channel",children:"SET CHANNEL"}),(0,a.jsx)(r.br,{}),"\n",(0,a.jsx)(r.a,{href:"/docs/pt/20-R10/commands/use-character-set",children:"USE CHARACTER SET"})]}),"\n",(0,a.jsx)(r.h2,{id:"propriedades",children:"Propriedades"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(r.table,{children:[(0,a.jsx)(r.thead,{children:(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.th,{}),(0,a.jsx)(r.th,{})]})}),(0,a.jsxs)(r.tbody,{children:[(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"N\xfamero do comando"}),(0,a.jsx)(r.td,{children:"172"})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"Thread-seguro"}),(0,a.jsx)(r.td,{children:"\u2713"})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"Modificar vari\xe1veis"}),(0,a.jsx)(r.td,{children:"error"})]})]})]})]})}function m(e={}){let{wrapper:r}={...(0,o.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},250065:function(e,r,s){s.d(r,{Z:()=>c,a:()=>t});var n=s(667294);let a={},o=n.createContext(a);function t(e){let r=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);