"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["45531"],{541130:function(e,r,o){o.r(r),o.d(r,{default:()=>m,frontMatter:()=>i,metadata:()=>a,assets:()=>t,toc:()=>c,contentTitle:()=>d});var a=JSON.parse('{"id":"commands-legacy/integrate-mirror-log-file","title":"INTEGRATE MIRROR LOG FILE","description":"INTEGRATE MIRROR LOG FILE ( viaAcesso ; numOperacao {; mode {; errObject}} )","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R8/commands-legacy/integrate-mirror-log-file.md","sourceDirName":"commands-legacy","slug":"/commands/integrate-mirror-log-file","permalink":"/docs/pt/commands/integrate-mirror-log-file","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fintegrate-mirror-log-file.md%20(20-R8)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R8","frontMatter":{"id":"integrate-mirror-log-file","title":"INTEGRATE MIRROR LOG FILE","slug":"/commands/integrate-mirror-log-file","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"CHECK LOG FILE","permalink":"/docs/pt/commands/check-log-file"},"next":{"title":"Log File","permalink":"/docs/pt/commands/log-file"}}'),n=o("785893"),s=o("250065");let i={id:"integrate-mirror-log-file",title:"INTEGRATE MIRROR LOG FILE",slug:"/commands/integrate-mirror-log-file",displayed_sidebar:"docs"},d=void 0,t={},c=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:2},{value:"Exemplo",id:"exemplo",level:2},{value:"Vari\xe1veis e conjuntos do sistema",id:"vari\xe1veis-e-conjuntos-do-sistema",level:2},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:2},{value:"Propriedades",id:"propriedades",level:2}];function l(e){let r={a:"a",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"INTEGRATE MIRROR LOG FILE"})," ( ",(0,n.jsx)(r.em,{children:"viaAcesso"})," ; ",(0,n.jsx)(r.em,{children:"numOperacao"})," {; ",(0,n.jsx)(r.em,{children:"mode"})," {; ",(0,n.jsx)(r.em,{children:"errObject"}),"}} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Par\xe2metro"}),(0,n.jsx)(r.th,{children:"Tipo"}),(0,n.jsx)(r.th,{}),(0,n.jsx)(r.th,{children:"Descri\xe7\xe3o"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"viaAcesso"}),(0,n.jsx)(r.td,{children:"Text"}),(0,n.jsx)(r.td,{children:"\u2192"}),(0,n.jsx)(r.td,{children:"Nome ou via de acesso do arquivo de hist\xf3rico a integrar"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"numOperacao"}),(0,n.jsx)(r.td,{children:"Real"}),(0,n.jsx)(r.td,{children:"\u2192"}),(0,n.jsx)(r.td,{children:"N\xfamero da \xfaltima opera\xe7\xe3o integrada"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"\u2190"}),(0,n.jsx)(r.td,{children:"Novo N\xfamero da \xfaltima opera\xe7\xe3o integrada"}),(0,n.jsx)(r.td,{}),(0,n.jsx)(r.td,{})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"mode"}),(0,n.jsx)(r.td,{children:"Integer"}),(0,n.jsx)(r.td,{children:"\u2192"}),(0,n.jsx)(r.td,{children:"0 = modo estrito (modo padr\xe3o), 1 =  modo auto reparo"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"errObject"}),(0,n.jsx)(r.td,{children:"Object"}),(0,n.jsx)(r.td,{children:"\u2190"}),(0,n.jsx)(r.td,{children:"Opera\xe7\xf5es com erro"})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Nota preliminar:"})," este comando s\xf3 funciona com 4D Server. S\xf3 pode ser executado atrav\xe9s do comando ",(0,n.jsx)(r.a,{href:"/docs/pt/commands/execute-on-server",children:"Execute on server"})," ou em um procedimento armazenado."]}),"\n",(0,n.jsxs)(r.p,{children:["O ",(0,n.jsx)(r.strong,{children:"INTEGRATE MIRROR LOG FILE"}),"  integra o arquivo de hist\xf3rico designado por ",(0,n.jsx)(r.em,{children:"viaAcesso"})," em uma base 4D Server, a partir da opera\xe7\xe3o ",(0,n.jsx)(r.em,{children:"numOperacao"})," (opcional)."]}),"\n",(0,n.jsx)(r.p,{children:"O comando aceita integrar todo arquivo de hist\xf3rico na base, inclusive se n\xe3o corresponde ao arquivo de dados. Este comando est\xe1 destinado especificamente para seu uso no contexto de uma base espelho."}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Nota:"}),' a partir de 4D v14, \xe9 poss\xedvel utilizar um arquivo de hist\xf3rico no contexto de uma base "espelho": a op\xe7\xe3o "Utilizar arquivo de hist\xf3rico" agora pode selecionar nas propriedades da base 4D Server utilizada como um espelho l\xf3gico, portanto, permitindo a implementa\xe7\xe3o de uma s\xe9rie de servidores espelho em s\xe9rie(ver ',(0,n.jsx)(r.em,{children:"Configurar um espelho l\xf3gico"})," no mamual 4D Server)."]}),"\n",(0,n.jsxs)(r.p,{children:["A diferen\xe7a do comando ",(0,n.jsx)(r.em,{children:"_o_INTEGRATE LOG FILE"}),", ao final de sua execu\xe7\xe3o ",(0,n.jsx)(r.strong,{children:"INTEGRATE MIRROR LOG FILE"})," n\xe3o substitui o arquivo de hist\xf3rico atual integrado ao hist\xf3rico atual da base: o arquivo de hist\xf3rico da base continua sendo utilizado. Consequentemente, qualquer mudan\xe7a realizada durante a integra\xe7\xe3o foi guardada no arquivo de hist\xf3rico atual."]}),"\n",(0,n.jsxs)(r.p,{children:["Em ",(0,n.jsx)(r.em,{children:"viaAcesso"}),", passe uma via absoluta ou relativa a pasta da base. Se passar uma cadeia vazia neste par\xe2metro, aparecer\xe1 uma caixa de di\xe1logo padr\xe3o de abertura do arquivo para que possa designar o arquivo a integrar. Se cancelar esta caixa de di\xe1logo, nenhum arquivo se integra e a vari\xe1vel sistema OK toma o valor 0."]}),"\n",(0,n.jsxs)(r.p,{children:["Por padr\xe3o, quando se omite o par\xe2metro ",(0,n.jsx)(r.em,{children:"numOperacao"}),", o comando integra todas as opera\xe7\xf5es do arquivo de hist\xf3rico.",(0,n.jsx)(r.br,{}),"\nSe passar um valor no par\xe2metro ",(0,n.jsx)(r.em,{children:"numOperacao"}),", a integra\xe7\xe3o come\xe7a no valor especificado. Depois da integra\xe7\xe3o, se passou uma vari\xe1vel em ",(0,n.jsx)(r.em,{children:"numOperacao"}),", este par\xe2metro cont\xe9m o n\xfamero da \xfaltima opera\xe7\xe3o integrada. Isto lhe permite seguir adiante com posteriores integra\xe7\xf5es do arquivo de hist\xf3rico, passando diretamente o valor devolvido em ",(0,n.jsx)(r.em,{children:"numOperacao"})," durante a seguinte chamada a ",(0,n.jsx)(r.strong,{children:"INTEGRATE MIRROR LOG FILE"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"Nota de compatibilidade: em vers\xf5es anteriores a 4D v15 R4, o par\xe2metro operationNum era opcional: entretanto, de agora em diante, se o par\xe2metro operationNum for omitido, um erro \xe9 gerado. Para restaurar o funcionamento original de seu c\xf3digo anterior, pode passar -2 no par\xe2metro vari\xe1vel."}),"\n",(0,n.jsxs)(r.p,{children:['Em modo, pode passar o modo de integra\xe7\xe3o que quiser ativar. Pode usar uma das seguintes constantes encontradas no tema "',(0,n.jsx)(r.em,{children:"Backup"}),'":']}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Constante"}),(0,n.jsx)(r.th,{children:"Tipo"}),(0,n.jsx)(r.th,{children:"Valor"}),(0,n.jsx)(r.th,{children:"Coment\xe1rio"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Auto repair mode"}),(0,n.jsx)(r.td,{children:"Inteiro longo"}),(0,n.jsx)(r.td,{children:"1"}),(0,n.jsxs)(r.td,{children:["Utilizar o modo flex\xedvel com as a\xe7\xf5es de repara\xe7\xe3o autom\xe1tica e preencher o par\xe2metro ",(0,n.jsx)(r.em,{children:"errObject"})," (se houver )"]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Strict mode"}),(0,n.jsx)(r.td,{children:"Inteiro longo"}),(0,n.jsx)(r.td,{children:"0"}),(0,n.jsx)(r.td,{children:"Utilize o modo de integra\xe7\xe3o estrito (por padr\xe3o)"})]})]})]}),"\n",(0,n.jsx)(r.p,{children:"Modo estrito: Neste modo, logo que um erro ocorre durante integra\xe7\xe3o, ele \xe9 parado e \xe9 necess\xe1rio usar o MSC de modo a rastrear o erro. O modo seguro \xe9 usado como padr\xe3o e \xe9 recomendado na maioria dos casos."}),"\n",(0,n.jsxs)(r.p,{children:["Modo auto reparo: Neste modo, quando um erro n\xe3o cr\xedtico ocorre, ele \xe9 ignorado e a integra\xe7\xe3o continua. Se passar o par\xe2metro errObjet, cada erro \xe9 registrado e pode ser analisado depois.",(0,n.jsx)(r.br,{}),"\nCasos de erros n\xe3o cr\xedticos s\xe3o:",(0,n.jsx)(r.br,{}),"\nAs requisi\xe7\xf5es de registro para adicionar um registro, mas este registro j\xe1 existe nos dados.",(0,n.jsx)(r.br,{}),"\nA\xe7\xe3o de reparo: 4D atualiza o registro.",(0,n.jsx)(r.br,{}),"\nO registro exige para atualizar um registro, mas este registro ainda n\xe3o existe.",(0,n.jsx)(r.br,{}),"\nA\xe7\xe3o de reparo: 4D adiciona o registro.",(0,n.jsx)(r.br,{}),"\nO hist\xf3rico exige apagar um registro, mas este registro n\xe3o existe.",(0,n.jsx)(r.br,{}),"\nA\xe7\xe3o de reparo: 4D n\xe3o faz nada."]}),"\n",(0,n.jsx)(r.p,{children:"Nota: em modo estrito (padr\xe3o) integra\xe7\xe3o para no primeiro erro encontrado. Neste caso, se quiser continuar com a integra\xe7\xe3o precisar\xe1 usar o MSC."}),"\n",(0,n.jsx)(r.p,{children:'Quando uma das anomalias ocorre no modo auto-reparo, o registro em quest\xe3o \xe9 automaticamente "reparado" e a opera\xe7\xe3o relacionada \xe9 registrada no par\xe2metro erroObjeto. Depois que a execu\xe7\xe3o for completa, o par\xe2metro errObjeto lista todos os registros reparados. Cont\xe9m um objeto de array chamado "opera\xe7\xf5es" constru\xeddo como abaixo:'}),"\n",(0,n.jsx)(r.p,{children:"O diagrama seguinte (pseudo c\xf3digo) detalha o processo de integra\xe7\xe3o dependendo dos diferentes casos. No arquivo de hist\xf3rico a integrar, X \xe9 o n\xfamero da primeira opera\xe7\xe3o e Y \xe9 o n\xfamero da \xfaltima:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-json",children:'{"operations":\xa0\xa0\xa0 [\xa0\xa0\xa0\xa0\xa0\xa0\xa0 {\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "operationType":24,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "operationName":"Create record",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "operationNumber":2,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "contextID":48,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "timeStamp":"2015-07-10T07:53:02.413Z",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "dataLen":24,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "recordNumber":0,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "tableID":"F4CXXXXX",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "tableName":"Customers",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "fields": {\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "1": 9,\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "2": "test value",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "3": "2003-03-03T00:00:00.000Z",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "4": "BlobPath: Table 1/Field 4/Data_9ACB28F1A2744FDFA5822B22F18B2E12.png",\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "8": "BlobID: 2"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }\xa0\xa0\xa0\xa0\xa0\xa0\xa0 },\xa0\xa0\xa0\xa0\xa0\xa0\xa0 {...}\xa0\xa0\xa0 ]\n'})}),"\n",(0,n.jsx)(r.p,{children:"Aviso: o modo auto-reparo pode ser usado em casos espec\xedficos j\xe1 que ultrapassa as propriedades de checagem de integridade interna de dados de 4D. Pode ser usado, por exemplo, com um arquivo de hist\xf3rico intermedi\xe1rio que foi perdido ou corrompido e queira recuperar tantas opera\xe7\xf5es quantas poss\xedveis. Neste caso \xe9 necess\xe1rio rpestar aten\xe7\xe3o \xe0 integridade dos dados quando usar este modo."}),"\n",(0,n.jsx)(r.h3,{id:""}),"\n",(0,n.jsx)(r.p,{children:"A lista atual de propriedades dispon\xedveis depende do tipo de opera\xe7\xe3o (por exemplo: criar registros, apagar registros, modificar registros, etc.). Aqui est\xe3o algumas das propriedades principais:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"operationType"}),": c\xf3digo interno para a opera\xe7\xe3o"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"operationName"}),': tipo da opera\xe7\xe3o, por exemplo "criar registro", "modificar registro"']}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"operationNumber"}),": n\xfamero interno da opera\xe7\xe3o no arquivo de log"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"contextID"}),": ID do contexto da execu\xe7\xe3o"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"timeStamp"}),": timestamp da opera\xe7\xe3o no arquivo de log"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"dataLen"}),": tamanhos dos dados"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"recordNumber"}),": n\xfamero interno do registro"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"tableID"}),": ID interna da tabela"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"tableName"}),": nome da tabela"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"fields"}),": array dos valores campo"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.em,{children:"sequenceNumber"}),": n\xfamero de sequ\xeancia."]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,n.jsx)(r.p,{children:"Para integrar um arquivo mirror de log no servidor em modo autoreparo:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-4d",children:'\xa0\xa0//para ser executado no servidor\n\xa0var $err : Object\n\xa0var $num : Integer\xa0//0 por padr\xe3o\n\xa0INTEGRATE MIRROR LOG FILE("c:\\\\mirror\\\\logNew.journal";$num;Auto repair mode;$err)\n'})}),"\n",(0,n.jsx)(r.h2,{id:"vari\xe1veis-e-conjuntos-do-sistema",children:"Vari\xe1veis e conjuntos do sistema"}),"\n",(0,n.jsx)(r.p,{children:"Se a integra\xe7\xe3o \xe9 efetuada corretamente, a vari\xe1vel sistema OK recebe o valor 1; caso contr\xe1rio, recebe o valor 0."}),"\n",(0,n.jsx)(r.h2,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.a,{href:"/docs/pt/commands/log-file-to-json",children:"LOG FILE TO JSON"})}),"\n",(0,n.jsx)(r.h2,{id:"propriedades",children:"Propriedades"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{}),(0,n.jsx)(r.th,{})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"N\xfamero do comando"}),(0,n.jsx)(r.td,{children:"1312"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Thread-seguro"}),(0,n.jsx)(r.td,{children:"\u2713"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Modificar vari\xe1veis"}),(0,n.jsx)(r.td,{children:"OK, error"})]})]})]})]})}function m(e={}){let{wrapper:r}={...(0,s.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},250065:function(e,r,o){o.d(r,{Z:function(){return d},a:function(){return i}});var a=o(667294);let n={},s=a.createContext(n);function i(e){let r=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);