"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[46723],{153184:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>o,toc:()=>l});var r=s(474848),t=s(28453);const d={id:"WebSocketServerClass",title:"WebSocketServer"},c=void 0,o={id:"API/WebSocketServerClass",title:"WebSocketServer",description:"A classe WebSocketServer permite-lhe criar e configurar um servidor WebSocket em 4D. Quando o servidor 4D WebSocket estiver ativo, voc\xea poder\xe1 abrir e usar conex\xf5es WebSocket entre o 4D e os clientes usando a classe [WebSocketConnection] (WebSocketConnectionClass.md).",source:"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R6/API/WebSocketServerClass.md",sourceDirName:"API",slug:"/API/WebSocketServerClass",permalink:"/docs/pt/API/WebSocketServerClass",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FWebSocketServerClass.md%20(20-R6)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R6",frontMatter:{id:"WebSocketServerClass",title:"WebSocketServer"},sidebar:"docs",previous:{title:"WebSocketConnection",permalink:"/docs/pt/API/WebSocketConnectionClass"},next:{title:"ZIPArchive",permalink:"/docs/pt/API/ZipArchiveClass"}},i={},l=[{value:"Requisitos",id:"requisitos",level:3},{value:"Exemplo",id:"exemplo",level:3},{value:"Objecto WebSocketServer",id:"objecto-websocketserver",level:3},{value:"4D.WebSocketServer.new()",id:"4dwebsocketservernew",level:2},{value:"Par\xe2metro <em>WSSHandler</em>",id:"par\xe2metro-wsshandler",level:3},{value:"Exemplo de classe <code>WSSHandler</code>",id:"exemplo-de-classe-wsshandler",level:3},{value:"objeto <code>request</code>",id:"objeto-request",level:3},{value:"objeto <code>connectionHandler</code>",id:"objeto-connectionhandler",level:3},{value:"Exemplo de classe <code>connectionHandler</code>",id:"exemplo-de-classe-connectionhandler",level:3},{value:"Par\xe2metro <em>options</em>",id:"par\xe2metro-options",level:3},{value:".connections",id:"connections",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:4},{value:".dataType",id:"datatype",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-1",level:4},{value:".handler",id:"handler",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-2",level:4},{value:".path",id:"path",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-3",level:4},{value:".terminate()",id:"terminate",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-4",level:4},{value:".terminated",id:"terminated",level:2},{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o-5",level:4}];function a(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["A classe ",(0,r.jsx)(n.code,{children:"WebSocketServer"})," permite-lhe criar e configurar um servidor WebSocket em 4D. Quando o servidor 4D WebSocket estiver ativo, voc\xea poder\xe1 abrir e usar conex\xf5es WebSocket entre o 4D e os clientes usando a classe [",(0,r.jsx)(n.code,{children:"WebSocketConnection"}),"] (WebSocketConnectionClass.md)."]}),"\n",(0,r.jsxs)(n.details,{children:[(0,r.jsx)(n.summary,{children:"Hist\xf3ria"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Release"}),(0,r.jsx)(n.th,{children:"Mudan\xe7as"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Adicionado"})]})})]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Sobre os servidores WebSocket",type:"note",children:(0,r.jsxs)(n.p,{children:["O protocolo WebSocket proporciona um canal de comunica\xe7\xe3o full-duplex entre um servidor WebSocket e um cliente (por exemplo, um navegador Web). Para obter mais informa\xe7\xf5es sobre servidores WebSocket, leia [esta p\xe1gina na Wikipedia] (",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/WebSocket",children:"https://en.wikipedia.org/wiki/WebSocket"}),")."]})}),"\n",(0,r.jsx)(n.admonition,{title:"Veja tamb\xe9m",type:"info",children:(0,r.jsxs)(n.p,{children:["Consulte tamb\xe9m [esta postagem no blog] (",(0,r.jsx)(n.a,{href:"https://blog.4d.com/new-built-in-websocket-server/",children:"https://blog.4d.com/new-built-in-websocket-server/"}),") sobre o servidor 4D WebSocket."]})}),"\n",(0,r.jsx)(n.h3,{id:"requisitos",children:"Requisitos"}),"\n",(0,r.jsx)(n.p,{children:"Para criar e manipular seu servidor WebSocket em 4D, \xe9 preciso usar duas classes embutidas em 4D:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["essa classe (",(0,r.jsx)(n.code,{children:"4D.WebSocketServer"}),") para gerenciar o pr\xf3prio servidor,"]}),"\n",(0,r.jsxs)(n.li,{children:["a classe ",(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})," para gerir as liga\xe7\xf5es e as mensagens."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Al\xe9m disso, ter\xe1 de criar duas classes de utilizador que conter\xe3o fun\xe7\xf5es de retorno de chamada:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"uma classe de usu\xe1rio para tratar as liga\xe7\xf5es ao servidor,"}),"\n",(0,r.jsx)(n.li,{children:"uma classe de usu\xe1rio para tratar as mensagens."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Voc\xea deve [criar o servidor WebSocket] (#4dwebsocketservernew) em um ",(0,r.jsx)(n.a,{href:"https://doc.4d.com/4dv19R/help/command/en/page1389.html",children:"worker"})," para manter a conex\xe3o ativa."]}),"\n",(0,r.jsx)(n.p,{children:"O [4D Web Server] (WebServerClass.md) deve ser iniciado."}),"\n",(0,r.jsx)(n.h3,{id:"exemplo",children:"Exemplo"}),"\n",(0,r.jsx)(n.p,{children:"Neste exemplo b\xe1sico, o nosso servidor WebSocket devolver\xe1 mensagens em mai\xfasculas."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Crie o servidor WebSocket utilizando um trabalhador (obrigat\xf3rio) e passe a sua classe de liga\xe7\xe3o ao servidor como par\xe2metro:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'\t//criar uma inst\xe2ncia da classe de usu\xe1rio\n\t//que manipular\xe1 as conex\xf5es com o servidor\nvar $handler:cs.myServerHandler\n$handler:=cs.myServerHandler.new()\n\nCALL WORKER("WebSocketServer"; Formula(wss:=4D.WebSocketServer.new($handler)))  \n\t//atribuir uma vari\xe1vel (wss) ao WebSocket permite que voc\xea  \n\t//chame wss.terminate() posteriormente\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Defina a classe de usu\xe1rio ",(0,r.jsx)(n.code,{children:"myServerHandler"})," que cont\xe9m a(s) fun\xe7\xe3o(\xf5es) de retorno de chamada usada(s) para tratar as conex\xf5es com o servidor:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"//myServerHandler class\n\nFunction onConnection($wss : Object; $event : Object) : Object\n\t//returns an instance of the user class\n\t//that will handle the messages\n\treturn cs.myConnectionHandler.new()\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["Defina a classe de usu\xe1rio ",(0,r.jsx)(n.code,{children:"myConnectionHandler"})," que cont\xe9m a(s) fun\xe7\xe3o(\xf5es) de retorno de chamada usada(s) para tratar mensagens:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"// myConnectionHandler class\n\nFunction onMessage($ws : 4D.WebSocketConnection; $message : Object)\n\t//resends the message in uppercase\n\t$ws.send(Uppercase($message.data))\n\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"JS do lado do cliente",type:"tip",children:(0,r.jsxs)(n.p,{children:["Consulte [esta publica\xe7\xe3o no blog] (",(0,r.jsx)(n.a,{href:"https://blog.4d.com/websocket-server/",children:"https://blog.4d.com/websocket-server/"}),") para ver um exemplo de c\xf3digo Javascript do lado do cliente que manipula uma conex\xe3o WebSocket."]})}),"\n",(0,r.jsx)(n.h3,{id:"objecto-websocketserver",children:"Objecto WebSocketServer"}),"\n",(0,r.jsx)(n.p,{children:"Os objectos de servidor WebSocket fornecem as seguintes propriedades e fun\xe7\xf5es:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsx)(n.tr,{children:(0,r.jsx)(n.th,{})})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#connections",children:[(0,r.jsx)(n.strong,{children:".connections"})," : Collection"]}),(0,r.jsx)(n.br,{}),"todas as conex\xf5es atuais tratadas pelo servidor WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#dataType",children:[(0,r.jsx)(n.strong,{children:".dataType"})," : Text"]}),(0,r.jsx)(n.br,{}),"o tipo de dados recebidos ou enviados"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#handler",children:[(0,r.jsx)(n.strong,{children:".handler"})," : Object"]}),(0,r.jsx)(n.br,{}),"o acess\xf3rio que obt\xe9m o objeto ",(0,r.jsx)(n.code,{children:"WSSHandler"})," usado para iniciar o servidor WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#path",children:[(0,r.jsx)(n.strong,{children:".path"})," : Text"]}),(0,r.jsx)(n.br,{})," o padr\xe3o do caminho para acessar o servidor de WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#terminate",children:[(0,r.jsx)(n.strong,{children:".terminate"}),"()",(0,r.jsx)(n.br,{}),(0,r.jsx)(n.strong,{children:".terminate"}),"( ",(0,r.jsx)(n.em,{children:"timeout"})," : Integer )"]}),(0,r.jsx)(n.br,{}),"fecha o servidor de WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#terminated",children:[(0,r.jsx)(n.strong,{children:".terminated"})," : Boolean"]}),(0,r.jsx)(n.br,{}),"True se o servidor de WebSocket estiver fechado"]})})]})]}),"\n",(0,r.jsx)(n.h2,{id:"4dwebsocketservernew",children:"4D.WebSocketServer.new()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"4D.WebSocketServer.new"}),"( ",(0,r.jsx)(n.em,{children:"WSSHandler"})," : Object { ; ",(0,r.jsx)(n.em,{children:"options"})," : Object } ) : 4D.WebSocketServer"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"#wsshandler-parameter",children:"WSSHandler"})}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Objecto da classe de utilizador que declara as chamadas de retorno do servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"#options-parameter",children:"options"})}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Par\xe2metros de configura\xe7\xe3o do WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resultados"}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Novo objeto WebSocketServer"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["A fun\xe7\xe3o ",(0,r.jsx)(n.code,{children:"4D.WebSocketServer.new()"})," cria e inicia um servidor WebSocket que usar\xe1 os retornos de chamada especificados ",(0,r.jsx)(n.em,{children:"WSSHandler"})," e (opcionalmente) ",(0,r.jsx)(n.em,{children:"op\xe7\xf5es"}),"  e retorna um objeto ",(0,r.jsx)(n.code,{children:"4D.WebSocketServer"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["A chamada dessa fun\xe7\xe3o requer que o [4D Web Server] (WebServerClass.md) seja iniciado. O ",(0,r.jsx)(n.strong,{children:"host"})," e a ",(0,r.jsx)(n.strong,{children:"port"})," do servidor WebSocket s\xe3o os mesmos que o host e a porta do 4D Web Server."]}),"\n",(0,r.jsxs)(n.h3,{id:"par\xe2metro-wsshandler",children:["Par\xe2metro ",(0,r.jsx)(n.em,{children:"WSSHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["No par\xe2metro ",(0,r.jsx)(n.em,{children:"WSSHandler"}),", passe uma inst\xe2ncia de uma classe de usu\xe1rio que ser\xe1 chamada sempre que ocorrer um evento no servidor WebSocket - essencialmente, eventos de conex\xe3o. A classe deve definir as seguintes fun\xe7\xf5es de retorno de chamada (somente ",(0,r.jsx)(n.code,{children:"onConnection"})," \xe9 obrigat\xf3rio):"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propriedade"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"}),(0,r.jsx)(n.th,{children:"Por padr\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onConnection"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"(obrigat\xf3rio) Chamada de retorno quando \xe9 iniciada uma nova liga\xe7\xe3o de cliente (ver abaixo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onOpen"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Callback quando o servidor WebSocket \xe9 iniciado (ver abaixo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onTerminate"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Callback quando o servidor WebSocket \xe9 terminado (ver abaixo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onError"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Callback quando ocorre um erro (ver abaixo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onConnection"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object) : Object | null"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto actual do servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"connection"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"request"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["objeto ",(0,r.jsx)(n.code,{children:"request"}),". Cont\xe9m informa\xe7\xf5es sobre o pedido de liga\xe7\xe3o (ver abaixo)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resultado"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#connectionhandler-object",children:[(0,r.jsx)(n.code,{children:"connectionHandler"})," object"]})," (veja abaixo). Se essa fun\xe7\xe3o retornar um objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"}),", um objeto ",(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass#websocketconnection-object",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})," \xe9 criado automaticamente e adicionado \xe0 ",(0,r.jsx)(n.a,{href:"#connections",children:"cole\xe7\xe3o de conex\xf5es"}),". Esse objeto \xe9 ent\xe3o recebido como par\xe2metro em cada fun\xe7\xe3o do objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"}),". Se o valor devolvido for nulo ou indefinido, a liga\xe7\xe3o \xe9 cancelada."]})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Esta chamada de retorno \xe9 feita quando o handshake estiver conclu\xeddo. Ele deve ser chamado com um objeto [",(0,r.jsx)(n.code,{children:"connectionHandler"}),"] v\xe1lido (#connectionhandler-object) para criar a conex\xe3o WebSocket; caso contr\xe1rio, a conex\xe3o ser\xe1 cancelada."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onOpen"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto actual do servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"open"'})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido quando o servidor websocket \xe9 iniciado."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onTerminate"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto actual do servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"terminate"'})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido quando o servidor HTTP ou o servidor WebSocket \xe9 encerrado."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onError"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto actual do servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"error"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"errors"}),(0,r.jsx)(n.td,{children:"Collection"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["Cole\xe7\xe3o da pilha de erros 4D em caso de erro de execu\xe7\xe3o",(0,r.jsx)(n.li,{children:"[].errCode (number) - C\xf3digo de erro 4D"}),(0,r.jsx)(n.li,{children:"[].message (text) - Descri\xe7\xe3o do erro 4D"}),(0,r.jsx)(n.li,{children:"[].componentSignature (text) - Assinatura do componente interno que retornou o erro"})]})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido quando ocorre um erro no servidor WebSocket."}),"\n",(0,r.jsxs)(n.h3,{id:"exemplo-de-classe-wsshandler",children:["Exemplo de classe ",(0,r.jsx)(n.code,{children:"WSSHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["Este exemplo de um recurso b\xe1sico de bate-papo ilustra como lidar com conex\xf5es de servidor WebSocket em uma classe ",(0,r.jsx)(n.em,{children:"WSSHandler"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'//myWSServerHandler class\n\nFunction onConnection($wss : Object; $event : Object) : Object\n\n\tIf (VerifyAddress($event.request.remoteAddress))\n\t\t// The VerifyAddress method validates the client address\n\t\t// The returned WSConnectionHandler object will be used\n\t\t// by 4D to instantiate the 4D.WebSocketConnection object\n\t\t// related to this connection\n\t\treturn cs.myConnectionHandler.new()   \n\t\t// See connectionHandler object\n\tElse\n\t\t// The connection is cancelled\t\t\n\t\treturn Null\n\tEnd if\n\nFunction onOpen($wss : Object; $event : Object)\nLogFile("*** Server started")\n\nFunction onTerminate($wss : Object; $event : Object)\nLogFile("*** Server closed")\n\nFunction onError($wss : Object; $event : Object)\nLogFile("!!! Server error: "+$event.errors.first().message)\n\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"objeto-request",children:["objeto ",(0,r.jsx)(n.code,{children:"request"})]}),"\n",(0,r.jsxs)(n.p,{children:["Um objeto ",(0,r.jsx)(n.code,{children:"request"})," cont\xe9m as seguintes propriedades:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"headers"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:["O pedido HTTP GET do cliente. ",(0,r.jsx)(n.code,{children:"headers.key=value"})," (o valor pode ser uma cole\xe7\xe3o se a mesma chave aparecer v\xe1rias vezes)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:["Objecto que cont\xe9m os par\xe2metros URL. Por exemplo, se os par\xe2metros s\xe3o: ",(0,r.jsx)(n.code,{children:"?key1=value1&key2=value2"})," -> ",(0,r.jsx)(n.code,{children:"query.key1=value1"}),", ",(0,r.jsx)(n.code,{children:"query.key2=value2"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"url"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["cont\xe9m apenas o URL que est\xe1 presente no pedido HTTP efectivo. Ex: ",(0,r.jsx)(n.code,{children:"GET /status?name=ryan HTTP/1.1"}),' -> url="/status?name=ryan"']})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"remoteAddress"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"Endere\xe7o IP do cliente"})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"objeto-connectionhandler",children:["objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["Como resultado do ",(0,r.jsx)(n.code,{children:"WSHandler. callback nConnection"}),", passe um objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"}),", que \xe9 uma inst\xe2ncia de uma classe de usu\xe1rio que ser\xe1 chamada toda vez que um evento ocorrer na conex\xe3o de WebSocket --essencialmente, mensagens recebidas. A classe deve definir as seguintes fun\xe7\xf5es de retorno de chamada (somente ",(0,r.jsx)(n.code,{children:"onConnection"})," \xe9 obrigat\xf3rio):"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onMessage"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"(obrigat\xf3rio) Fun\xe7\xe3o chamada quando \xe9 recebida uma nova mensagem desta liga\xe7\xe3o"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onOpen"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsxs)(n.td,{children:["Fun\xe7\xe3o chamada quando o ",(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})," \xe9 criado"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onTerminate"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Fun\xe7\xe3o chamada quando esta liga\xe7\xe3o \xe9 terminada"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onError"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Fun\xe7\xe3o chamada quando ocorre um erro"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onMessage"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto de liga\xe7\xe3o WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"message"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"data"}),(0,r.jsx)(n.td,{children:"Text / Blob / Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:"dados enviados pelo cliente"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Este Callback para dados WebSocket. Chamado sempre que o WebSocket recebe dados."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onOpen"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto de liga\xe7\xe3o WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"open"'})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Chamado quando o objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"})," for criado (ap\xf3s o evento ",(0,r.jsx)(n.code,{children:"WSS.onConnection"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onTerminate"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto de liga\xe7\xe3o WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"terminate"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"code"}),(0,r.jsx)(n.td,{children:"Number"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["C\xf3digo de estado que indica o motivo pelo qual a liga\xe7\xe3o foi encerrada. Se o WebSocket n\xe3o retorna um c\xf3digo de erro, ",(0,r.jsx)(n.code,{children:"code"})," est\xe1 definido para 1005 se nenhum erro ocorreu ou para 1006 se houve um erro."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"reason"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:"Cadeia de caracteres que explica porque \xe9 que a liga\xe7\xe3o foi encerrada. Se o websocket n\xe3o devolver um motivo, o c\xf3digo \xe9 indefinido"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Fun\xe7\xe3o chamada quando o WebSocket \xe9 fechado."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onError"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objecto de liga\xe7\xe3o WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"event"'}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe2metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"error"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"errors"}),(0,r.jsx)(n.td,{children:"Collection"}),(0,r.jsx)(n.td,{}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["Cole\xe7\xe3o de erros 4D stack em caso de erro de execu\xe7\xe3o",(0,r.jsx)(n.li,{children:"[].errCode (number) - c\xf3digo de erro 4D"}),(0,r.jsx)(n.li,{children:"[]. essagem (texto) - Descri\xe7\xe3o do erro 4D"}),(0,r.jsx)(n.li,{children:"[].componentSignature (texto) - Assinatura do componente interno que retornou o erro"})]}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Fun\xe7\xe3o chamada quando ocorre um erro."}),"\n",(0,r.jsxs)(n.h3,{id:"exemplo-de-classe-connectionhandler",children:["Exemplo de classe ",(0,r.jsx)(n.code,{children:"connectionHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["Este exemplo de um recurso b\xe1sico de bate-papo ilustra como tratar mensagens em uma classe ",(0,r.jsx)(n.em,{children:"connectionHandler"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// myConnectionHandler Class\n\nFunction onMessage($ws : 4D.WebSocketConnection; $message : Object)\n\t// Resend the message to all chat clients\n\tThis.broadcast($ws;$message.data)\n\nFunction onOpen($ws : 4D.WebSocketConnection; $message : Object)\n\t// Send a message to new connected users\n\t$ws.send("Welcome on the chat!")\n\t// Send "New client connected" message to all other chat clients\n\tThis.broadcast($ws;"New client connected")\n\nFunction onTerminate($ws : 4D.WebSocketConnection; $message : Object)\n\t// Send "Client disconnected" message to all other chat clients\n\tThis.broadcast($ws;"Client disconnected")\n\nFunction broadcast($ws : 4D.WebSocketConnection; $message:text)\n\tvar $client:4D.WebSocketConnection\n\t// Resend the message to all chat clients\n\tFor each ($client; $ws.wss.connections)\n\t\t// Check that the id is not the current connection\n\t\tIf ($client.id#$ws.id)\n\t\t\t$client.send($message)\n\t\tEnd if\n\tEnd for each\n\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"par\xe2metro-options",children:["Par\xe2metro ",(0,r.jsx)(n.em,{children:"options"})]}),"\n",(0,r.jsxs)(n.p,{children:["No par\xe2metro opcional ",(0,r.jsx)(n.em,{children:"options"}),", passe um objeto que contenha as seguintes propriedades:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propriedade"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"}),(0,r.jsx)(n.th,{children:"Por padr\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"path"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"Representa o caminho para aceder ao servidor WebSocket. Se n\xe3o for definido um caminho, o servidor WebSocket gere todas as liga\xe7\xf5es"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"dataType"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["Tipo dos dados recebidos atrav\xe9s da fun\xe7\xe3o ",(0,r.jsx)(n.code,{children:"connectionHandler.onMessage"})," e os dados enviados por ",(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass#send",children:(0,r.jsx)(n.code,{children:"WebSocketConnection.send()"})}),'. Values: "text", "blob","object"). Se "object": (enviar) transforma o objecto num formato json e envia-o; (recep\xe7\xe3o): recebe o formato json e transforma-o em objecto']}),(0,r.jsx)(n.td,{children:"text"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"connections",children:".connections"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".connections"})," : Collection"]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A propriedade ",(0,r.jsx)(n.code,{children:".connections"})," cont\xe9m todas as conex\xf5es atuais tratadas pelo servidor WebSocket. Cada elemento da cole\xe7\xe3o \xe9 um objeto [",(0,r.jsx)(n.code,{children:"WebSocketConnection"}),"] (WebSocketConnectionClass.md)."]}),"\n",(0,r.jsxs)(n.p,{children:["Quando uma conex\xe3o \xe9 encerrada, seu ",(0,r.jsx)(n.a,{href:"/docs/pt/API/WebSocketConnectionClass#status",children:(0,r.jsx)(n.code,{children:"status"})}),' muda para "Fechado" e ele \xe9 removido desta cole\xe7\xe3o.']}),"\n",(0,r.jsx)(n.h2,{id:"datatype",children:".dataType"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".dataType"})," : Text"]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o-1",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A propriedade ",(0,r.jsx)(n.code,{children:".dataType"})," cont\xe9m o tipo de dados recebidos ou enviados."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propriedade \xe9 s\xf3 de leitura."}),"\n",(0,r.jsx)(n.h2,{id:"handler",children:".handler"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".handler"})," : Object"]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o-2",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A propriedade ",(0,r.jsx)(n.code,{children:".handler"})," cont\xe9m o acess\xf3rio que obt\xe9m o objeto ",(0,r.jsx)(n.code,{children:"WSSHandler"})," usado para iniciar o servidor WebSocket."]}),"\n",(0,r.jsx)(n.h2,{id:"path",children:".path"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".path"})," : Text"]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o-3",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A propriedade ",(0,r.jsx)(n.code,{children:".path"})," cont\xe9m  o padr\xe3o do caminho para acessar o servidor de WebSocket . Se n\xe3o for definido um caminho, o servidor WebSocket gere todas as liga\xe7\xf5es."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propriedade \xe9 s\xf3 de leitura."}),"\n",(0,r.jsx)(n.h2,{id:"terminate",children:".terminate()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".terminate"}),"()",(0,r.jsx)(n.br,{}),(0,r.jsx)(n.strong,{children:".terminate"}),"( ",(0,r.jsx)(n.em,{children:"timeout"})," : Integer )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe2metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"timeout"}),(0,r.jsx)(n.td,{children:"Integer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Waiting time in seconds before terminating the WebSocket server"})]})})]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o-4",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A fun\xe7\xe3o ",(0,r.jsx)(n.code,{children:".terminate()"})," fecha o servidor de WebSocket."]}),"\n",(0,r.jsxs)(n.p,{children:["By default, if no ",(0,r.jsx)(n.em,{children:"timeout"})," value is set, the function initializes close handshake and waits to receive close frame from the peer, after that sending FIN packet in attempt to perform a clean socket close. When answer received, the socket is destroyed."]}),"\n",(0,r.jsxs)(n.p,{children:["If a ",(0,r.jsx)(n.em,{children:"timeout"})," value is set:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"when the waiting time is reached, forcibly destroys the socket."}),"\n",(0,r.jsxs)(n.li,{children:["if ",(0,r.jsx)(n.em,{children:"timeout"})," = 0, forcibly destroys the socket without closing frames or fin packets exchange, and does it instantly without waiting time."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"terminated",children:".terminated"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".terminated"})," : Boolean"]}),"\n",(0,r.jsx)(n.h4,{id:"descri\xe7\xe3o-5",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(n.p,{children:["A propriedade ",(0,r.jsx)(n.code,{children:".terminated"})," cont\xe9m True se o servidor de WebSocket estiver fechado."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propriedade \xe9 s\xf3 de leitura."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var r=s(296540);const t={},d=r.createContext(t);function c(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);