"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["97240"],{583113:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>l,toc:()=>d,default:()=>h,metadata:()=>r,assets:()=>a,contentTitle:()=>o});var r=JSON.parse('{"id":"WebServer/http-request-handler","title":"Gestionnaire de requ\xeates HTTP","description":"Par d\xe9faut, les requ\xeates HTTP re\xe7ues par le serveur web 4D sont trait\xe9es par des fonctionalit\xe9s int\xe9gr\xe9es de traitement ou le serveur REST.","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-21/WebServer/http-request-handler.md","sourceDirName":"WebServer","slug":"/WebServer/http-request-handler","permalink":"/docs/pt/WebServer/http-request-handler","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WebServer%2Fhttp-request-handler.md%20(21)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"21","frontMatter":{"id":"http-request-handler","title":"Gestionnaire de requ\xeates HTTP"},"sidebar":"docs","previous":{"title":"Processamento de pedidos HTTP","permalink":"/docs/pt/WebServer/httpRequests"},"next":{"title":"HTTP Rules","permalink":"/docs/pt/WebServer/http-rules"}}'),i=s(785893),t=s(250065);let l={id:"http-request-handler",title:"Gestionnaire de requ\xeates HTTP"},o=void 0,a={},d=[{value:"Requisitos",id:"requisitos",level:2},{value:"How to set handlers",id:"how-to-set-handlers",level:2},{value:"D\xe9finition du gestionnaire",id:"d\xe9finition-du-gestionnaire",level:2},{value:"Motifs d&#39;URL",id:"motifs-durl",level:3},{value:"Correspondance des motifs",id:"correspondance-des-motifs",level:4},{value:"Padr\xf5es proibidos",id:"padr\xf5es-proibidos",level:4},{value:"Classe e m\xe9todo",id:"classe-e-m\xe9todo",level:3},{value:"Verbs",id:"verbs",level:3},{value:"Exemplo",id:"exemplo",level:2},{value:"Code du gestionnaire de requ\xeate",id:"code-du-gestionnaire-de-requ\xeate",level:2},{value:"Configuration des fonctions",id:"configuration-des-fonctions",level:3},{value:"Entr\xe9e : une instance de la classe 4D.IncomingMessage",id:"entr\xe9e--une-instance-de-la-classe-4dincomingmessage",level:3},{value:"Sortie : une instance de la classe 4D.OutgoingMessage",id:"sortie--une-instance-de-la-classe-4doutgoingmessage",level:3},{value:"Exemplo",id:"exemplo-1",level:3},{value:"Veja tamb\xe9m",id:"veja-tamb\xe9m",level:2}];function c(e){let n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Par d\xe9faut, les requ\xeates HTTP re\xe7ues par le serveur web 4D sont trait\xe9es par des ",(0,i.jsx)(n.a,{href:"/docs/pt/WebServer/httpRequests",children:"fonctionalit\xe9s int\xe9gr\xe9es de traitement"})," ou le ",(0,i.jsx)(n.a,{href:"/docs/pt/REST/REST_requests",children:"serveur REST"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Toutefois, 4D prend en charge la mise en \u0153uvre de ",(0,i.jsx)(n.strong,{children:"gestionnaires de requ\xeates HTTP personnalis\xe9s"})," (",(0,i.jsx)(n.em,{children:"custom HTTP handlers"}),"), vous permettant d'intercepter des requ\xeates HTTP entrantes sp\xe9cifiques et de les traiter \xe0 l'aide de votre propre code."]}),"\n",(0,i.jsxs)(n.p,{children:["Lorsqu'un gestionnaire de requ\xeate HTTP personnalis\xe9 intercepte une requ\xeate, celle-ci est trait\xe9e directement et aucune autre fonctionnalit\xe9 de traitement (par exemple, les m\xe9thodes base ",(0,i.jsx)(n.a,{href:"/docs/pt/WebServer/authentication#on-web-authentication",children:"On Web authentication"})," ou ",(0,i.jsx)(n.a,{href:"/docs/pt/WebServer/httpRequests#on-web-connection",children:"On Web connection"}),") n'est appel\xe9e."]}),"\n",(0,i.jsx)(n.p,{children:"Les gestionnaires de requ\xeates HTTP personnalis\xe9s r\xe9pondent \xe0 divers besoins, y compris :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"l'utilisation d'une URL d\xe9di\xe9e comme fournisseur de ressources ou comme zone de t\xe9l\xe9chargement de fichiers (pour t\xe9l\xe9charger ou t\xe9l\xe9verser divers fichiers),"}),"\n",(0,i.jsx)(n.li,{children:"la redirection sur des pages sp\xe9cifiques en fonction d'un contexte (utilisateur authentifi\xe9, privil\xe8ges accord\xe9s...),"}),"\n",(0,i.jsx)(n.li,{children:"la gestion d'une authentification via oAuth 2.0."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"requisitos",children:"Requisitos"}),"\n",(0,i.jsx)(n.p,{children:"Custom HTTP Request handlers are supported in the following context:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/pt/WebServer/sessions#enabling-web-sessions",children:"scalable sessions"})," or ",(0,i.jsx)(n.a,{href:"/docs/pt/settings/web#no-sessions",children:"no sessions"})," are enabled,"]}),"\n",(0,i.jsxs)(n.li,{children:["a web server run locally by 4D or 4D Server, including those ",(0,i.jsx)(n.a,{href:"/docs/pt/WebServer/webServerObject",children:"run by components"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["For security reasons, external access to the datastore can be disallowed in 4D. Voc\xea precisa configurar os ",(0,i.jsx)(n.a,{href:"/docs/pt/ORDA/privileges",children:"privil\xe9gios ORDA"})," para permitir solicita\xe7\xf5es HTTP."]})}),"\n",(0,i.jsx)(n.h2,{id:"how-to-set-handlers",children:"How to set handlers"}),"\n",(0,i.jsx)(n.p,{children:"You can declare HTTP Request handlers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["in a configuration file named ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"})," stored in the ",(0,i.jsx)(n.a,{href:"/docs/pt/Project/architecture#sources",children:(0,i.jsx)(n.code,{children:"Project/Sources"})})," folder of the project. HTTP Request handlers are loaded and applied in the main Web server once it is started."]}),"\n",(0,i.jsxs)(n.li,{children:["using a ",(0,i.jsx)(n.a,{href:"/docs/pt/API/WebServerClass#handlers",children:(0,i.jsx)(n.code,{children:".handlers"})})," property set in the ",(0,i.jsx)(n.em,{children:"settings"})," parameter of the ",(0,i.jsx)(n.a,{href:"/docs/pt/API/WebServerClass#start",children:"start()"})," function, for any web server object:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:"WEB Server.start($settings.handlers) //set rules at web server startup\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If both a ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"})," file and a call to the ",(0,i.jsx)(n.a,{href:"/docs/pt/commands/web-server",children:(0,i.jsx)(n.code,{children:"WEB Server"})})," command with a valid ",(0,i.jsx)(n.code,{children:"$settings.handlers"})," are used, the ",(0,i.jsx)(n.code,{children:"WEB Server"})," command has priority."]}),"\n",(0,i.jsxs)(n.p,{children:["The json file (or the object in the ",(0,i.jsx)(n.em,{children:"settings"})," parameter) contains all listened URL patterns, the handled verbs, and the code to be called."]}),"\n",(0,i.jsx)(n.p,{children:"Handlers are provided as a collection."}),"\n",(0,i.jsx)(n.p,{children:"Au moment de l'ex\xe9cution, le premier motif correspondant \xe0 l'URL est ex\xe9cut\xe9, les autres sont ignor\xe9s."}),"\n",(0,i.jsxs)(n.p,{children:["Aqui est\xe1 um exemplo do conte\xfado de um arquivo ",(0,i.jsx)(n.em,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'\n[\n    {\n        "class": "GeneralHandling",\n        "method": "gettingStarted",\n        "pattern": "start",\n        "verbs": "get, post"\n    }\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Cette d\xe9claration de gestionnaire peut \xeatre lue ainsi : quand une requ\xeate commen\xe7ant par ",(0,i.jsx)(n.code,{children:"/start/"})," avec un verbe ",(0,i.jsx)(n.code,{children:"GET"})," ou ",(0,i.jsx)(n.code,{children:"POST"})," est re\xe7ue par le serveur, la fonction ",(0,i.jsx)(n.code,{children:"gettingStarted"})," du singleton ",(0,i.jsx)(n.code,{children:"GeneralHandling"})," est ex\xe9cut\xe9e."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Vous devez red\xe9marrer le serveur Web pour que les modifications apport\xe9es dans ce fichier soient prises en compte."})}),"\n",(0,i.jsx)(n.h2,{id:"d\xe9finition-du-gestionnaire",children:"D\xe9finition du gestionnaire"}),"\n",(0,i.jsx)(n.p,{children:"Un gestionnaire est d\xe9fini par :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"un motif d'URL \xe0 intercepter"}),"\n",(0,i.jsx)(n.li,{children:"une fonction et sa classe o\xf9 le code est impl\xe9ment\xe9 pour traiter le motif d'URL en question"}),"\n",(0,i.jsx)(n.li,{children:"les verbes avec lesquels l'URL peut \xeatre appel\xe9e pour d\xe9clencher le gestionnaire personnalis\xe9"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"L'identifiant du gestionnaire est le couple [motif + un verbe parmi la liste des verbes]."}),"\n",(0,i.jsx)(n.h3,{id:"motifs-durl",children:"Motifs d'URL"}),"\n",(0,i.jsxs)(n.p,{children:["Os padr\xf5es de URL podem ser fornecidos como ",(0,i.jsx)(n.strong,{children:"prefixos"})," ou usando ",(0,i.jsx)(n.strong,{children:"express\xf5es regulares"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:['To declare a regular expression pattern, use the "regexPattern" property name in the HTTPHandlers.json file. Regular expressions patterns are handled directly.',(0,i.jsx)(n.br,{}),"\nEx: ",(0,i.jsx)(n.code,{children:'"regexPattern" : "/docs/**/index.html"'})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'Les propri\xe9t\xe9s "Pattern" et "regexPattern" ne peuvent pas \xeatre utilis\xe9es dans la m\xeame d\xe9finition de gestionnaire (dans ce cas, seule la propri\xe9t\xe9 "regexPattern" est prise en compte).'}),"\n",(0,i.jsx)(n.h4,{id:"correspondance-des-motifs",children:"Correspondance des motifs"}),"\n",(0,i.jsx)(n.p,{children:"Les motifs d'URL sont d\xe9clench\xe9s dans l'ordre d\xe9fini :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"le premier motif correspondant est ex\xe9cut\xe9"}),"\n",(0,i.jsx)(n.li,{children:"the following patterns are not executed even if they match the URL"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Par cons\xe9quent, vous devez appliquer une strat\xe9gie pr\xe9cise lorsque vous \xe9crivez vos gestionnaires : les motifs les plus d\xe9taill\xe9s doivent \xeatre \xe9crits avant les motifs plus g\xe9n\xe9raux."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleTheInvoice",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleUnauthorizedVerbs",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "comment": "This handler is triggered for all verbs except GET (handled above)"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs",\n        "comment": "This handler is triggered for all the verbs"\n    }\n]\n\n'})}),"\n",(0,i.jsx)(n.h4,{id:"padr\xf5es-proibidos",children:"Padr\xf5es proibidos"}),"\n",(0,i.jsx)(n.p,{children:"Les motifs d'URL correspondant aux fonctions de traitement HTTP int\xe9gr\xe9es de 4D ne sont pas autoris\xe9s dans les gestionnaires HTTP personnalis\xe9s. Par exemple, les motifs suivants ne peuvent pas \xeatre trait\xe9s :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/4DACTION"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/rest"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/$lib/renderer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/$shared"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"classe-e-m\xe9todo",children:"Classe e m\xe9todo"}),"\n",(0,i.jsx)(n.p,{children:'Vous d\xe9clarez le code \xe0 ex\xe9cuter lorsqu\'un motif d\'URL d\xe9fini est intercept\xe9 \xe0 l\'aide des propri\xe9t\xe9s "class" et "method".'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:['"class": class name without ',(0,i.jsx)(n.code,{children:"cs."}),', e.g. "UsersHandling" for the ',(0,i.jsx)(n.code,{children:"cs.UsersHandling"})," user class. Deve ser uma classe ",(0,i.jsx)(n.a,{href:"/docs/pt/Concepts/classes#shared-singleton",children:(0,i.jsx)(n.strong,{children:"compartilhada"})})," e ",(0,i.jsx)(n.a,{href:"/docs/pt/Concepts/classes#singleton-classes",children:(0,i.jsx)(n.strong,{children:"singleton"})}),"."]}),"\n",(0,i.jsx)(n.li,{children:'"method": class function belonging to the class.'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"#request-handler-code",children:"Veja abaixo"})," para informa\xe7\xf5es sobre o c\xf3digo do manipulador de pedidos."]}),"\n",(0,i.jsx)(n.h3,{id:"verbs",children:"Verbs"}),"\n",(0,i.jsx)(n.p,{children:'Vous pouvez utiliser la propri\xe9t\xe9 "verbs" dans la d\xe9finition du gestionnaire pour d\xe9clarer les verbes HTTP pris en charge dans les requ\xeates entrantes pour ce gestionnaire. Une requ\xeate qui utilise un verbe qui n\'est pas explicitement autoris\xe9 est automatiquement rejet\xe9e par le serveur.'}),"\n",(0,i.jsx)(n.p,{children:"Vous pouvez d\xe9clarer plusieurs verbes, s\xe9par\xe9s par une virgule. Les noms de verbes ne sont pas sensibles \xe0 la casse."}),"\n",(0,i.jsxs)(n.p,{children:["Ex : ",(0,i.jsx)(n.code,{children:'"verbs" : "PUT, POST"'})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"No control is done on verb names. Todos os nomes podem ser usados."})}),"\n",(0,i.jsxs)(n.p,{children:['Par d\xe9faut, si la propri\xe9t\xe9 "verbs" n\'est pas utilis\xe9e pour un gestionnaire, ',(0,i.jsx)(n.strong,{children:"tous"})," les verbes HTTP sont pris en charge dans les requ\xeates entrantes pour ce gestionnaire (sauf ceux \xe9ventuellement utilis\xe9s au pr\xe9alable dans un motif plus d\xe9taill\xe9, comme illustr\xe9 dans l'exemple ci-dessus)."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Le verbe HTTP peut \xe9galement \xeatre \xe9valu\xe9 ",(0,i.jsxs)(n.a,{href:"/docs/pt/API/IncomingMessageClass#verb",children:["\xe0 l'aide de la propri\xe9t\xe9 ",(0,i.jsx)(n.code,{children:".verb"})," dans le code du gestionnaire de requ\xeate"]})," pour \xeatre accept\xe9 ou rejet\xe9."]})}),"\n",(0,i.jsx)(n.h2,{id:"exemplo",children:"Exemplo"}),"\n",(0,i.jsx)(n.p,{children:"Voici un exemple d\xe9taill\xe9 de fichier HTTPHandlers.json :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'\n[\n   {\n        "class": "GeneralHandling",\n        "method": "handle",\n        "pattern": "info", //URL prefix\n        "verbs": "GET"\n    }, \n    {\n        "class": "UsersHandling",\n        "method": "manageAccount",\n        "pattern": "userAccount/update",   //URL prefix\n        "verbs": "PUT,POST"\n    }, \n    {\n        "class": "FinancialHandling",\n        "method": "handleInvoices",\n        "regexPattern": "/docs/invoices/(past|today)", //URL prefix given as a regex\n        "verbs": "GET"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs/myPage.html",  //URL prefix given as a regex\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleTheInvoice",\n        "pattern": "docs/invoices/details/theInvoice", // The most specific URL first\n        "verbs": "GET,POST"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleDetails",\n        "pattern": "docs/invoices/details",    // The general URLs after\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleInvoices",   // The general URLs after\n        "pattern": "docs/invoices",\n        "verbs": "GET"\n    }\n]\n\n'})}),"\n",(0,i.jsx)(n.p,{children:"Dans cet exemple, vous devez impl\xe9menter les fonctions suivantes :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handle function"})," in the ",(0,i.jsx)(n.em,{children:"GeneralHandling"})," class"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"manageAccount"})," na classe ",(0,i.jsx)(n.em,{children:"UsersHandling"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleInvoices"})," na classe *FinancialHandling"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleDocs"})," na classe ",(0,i.jsx)(n.em,{children:"DocsHandling"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleTheInvoice"})," / ",(0,i.jsx)(n.em,{children:"handleDetails"})," / ",(0,i.jsx)(n.em,{children:"handleInvoices"})," na clase ",(0,i.jsx)(n.em,{children:"InvoicesHandling"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Exemples d'URL d\xe9clenchant les gestionnaires personnalis\xe9s :"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/info/"})," com um verbo GET\n",(0,i.jsx)(n.code,{children:"IP:port/info/general"})," com um verbo GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/userAccount/update/"})," avec un verbe POST\n",(0,i.jsx)(n.code,{children:"IP:port/userAccount/update/profile"})," avec un verbe POST"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/docs/invoices/past"})," avec un verbe GET\n",(0,i.jsx)(n.code,{children:"IP:port/docs/invoices/today/latest"})," avec un verbe GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port//docs/myPage.html"})," avec un verbe GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port//docs/invoices/"})," avec un verbe GET, appelle la fonction ",(0,i.jsx)(n.em,{children:"handleInvoices"})," (classe ",(0,i.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,i.jsx)(n.code,{children:"IP:port//docs/invoices/details/"})," avec un verbe GET, appelle la fonction ",(0,i.jsx)(n.em,{children:"handleDetails"})," (classe ",(0,i.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,i.jsx)(n.code,{children:"IP :port//docs/invoices/details/theInvoice/xxxxxx"})," avec un verbe GET, appelle la fonction ",(0,i.jsx)(n.em,{children:"handleTheInvoice"})," (classe ",(0,i.jsx)(n.em,{children:"InvoiceslHandling"}),")"]}),"\n",(0,i.jsx)(n.h2,{id:"code-du-gestionnaire-de-requ\xeate",children:"Code du gestionnaire de requ\xeate"}),"\n",(0,i.jsx)(n.h3,{id:"configuration-des-fonctions",children:"Configuration des fonctions"}),"\n",(0,i.jsxs)(n.p,{children:["Le code du gestionnaire de requ\xeates HTTP doit \xeatre mis en \u0153uvre dans une fonction d'une classe ",(0,i.jsx)(n.a,{href:"/docs/pt/Concepts/classes#shared-singleton",children:(0,i.jsx)(n.strong,{children:"partag\xe9e"})})," et ",(0,i.jsx)(n.a,{href:"/docs/pt/Concepts/classes#singleton-classes",children:(0,i.jsx)(n.strong,{children:"singleton"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:['Si le singleton est manquant ou non partag\xe9, une erreur "Cannot find singleton" est renvoy\xe9e par le serveur. Si la classe ou la fonction ',(0,i.jsx)(n.a,{href:"#handler-definition",children:"d\xe9finie comme handler"})," dans le fichier HTTPHandlers.json n'est pas trouv\xe9e, le serveur renvoie l'erreur \"Cannot find singleton function\"."]}),"\n",(0,i.jsxs)(n.p,{children:["Request handler functions are not necessarily shared, unless some request handler properties are updated by the functions. Nesse caso, voc\xea precisa declarar suas fun\xe7\xf5es com a palavra-chave ",(0,i.jsx)(n.a,{href:"/docs/pt/Concepts/classes#shared-functions",children:(0,i.jsx)(n.code,{children:"shared"})}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Il est ",(0,i.jsx)(n.strong,{children:"d\xe9conseill\xe9"})," d'exposer les fonctions du gestionnaire de requ\xeates aux appels REST externes en utilisant les mots-cl\xe9s ",(0,i.jsx)(n.a,{href:"/docs/pt/ORDA/ordaClasses#exposed-vs-non-exposed-functions",children:(0,i.jsx)(n.code,{children:"exposed"})})," ou ",(0,i.jsx)(n.a,{href:"/docs/pt/ORDA/ordaClasses#onhttpget-keyword",children:(0,i.jsx)(n.code,{children:"onHTTPGet"})}),"."]})}),"\n",(0,i.jsx)(n.h3,{id:"entr\xe9e--une-instance-de-la-classe-4dincomingmessage",children:"Entr\xe9e : une instance de la classe 4D.IncomingMessage"}),"\n",(0,i.jsxs)(n.p,{children:["Lorsqu'une requ\xeate a \xe9t\xe9 intercept\xe9e par le gestionnaire, elle est re\xe7ue sur le serveur en tant qu'instance de la classe ",(0,i.jsx)(n.a,{href:"/docs/pt/API/IncomingMessageClass",children:"4D.IncomingMessage"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Toutes les informations n\xe9cessaires concernant la requ\xeate sont disponibles dans cet objet, y compris l'URL, le verbe, les en-t\xeates et, le cas \xe9ch\xe9ant, les param\xe8tres (plac\xe9s dans l'URL) et le corps de la requ\xeate."}),"\n",(0,i.jsx)(n.p,{children:"Ensuite, le gestionnaire de requ\xeate peut utiliser ces informations pour mettre en oeuvre une logique m\xe9tier appropri\xe9e."}),"\n",(0,i.jsx)(n.h3,{id:"sortie--une-instance-de-la-classe-4doutgoingmessage",children:"Sortie : une instance de la classe 4D.OutgoingMessage"}),"\n",(0,i.jsxs)(n.p,{children:["Le gestionnaire de requ\xeate peut renvoyer une instance d'objet de la classe ",(0,i.jsx)(n.a,{href:"/docs/pt/API/OutgoingMessageClass",children:"4D.OutGoingMessage"}),", c'est-\xe0-dire un contenu web complet pr\xeat \xe0 \xeatre trait\xe9 par un navigateur, comme un contenu de fichier."]}),"\n",(0,i.jsx)(n.h3,{id:"exemplo-1",children:"Exemplo"}),"\n",(0,i.jsxs)(n.p,{children:["La classe ",(0,i.jsx)(n.a,{href:"/docs/pt/API/IncomingMessageClass",children:"4D.IncomingMessage"})," fournit des fonctions pour obtenir les ",(0,i.jsx)(n.a,{href:"/docs/pt/API/IncomingMessageClass#headers",children:"headers"})," et le ",(0,i.jsx)(n.a,{href:"/docs/pt/API/IncomingMessageClass#gettext",children:"body"})," de la requ\xeate."]}),"\n",(0,i.jsx)(n.p,{children:"Voici un exemple simple pour t\xe9l\xe9charger un fichier sur le serveur."}),"\n",(0,i.jsxs)(n.p,{children:["O arquivo ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "UploadFile",\n        "method": "uploadFile",\n        "regexPattern": "/putFile",\n        "verbs": "POST"\n    }\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["L'URL appel\xe9e est : ",(0,i.jsx)(n.a,{href:"http://127.0.0.1:8044/putFile?fileName=testFile",children:"http://127.0.0.1:8044/putFile?fileName=testFile"})]}),"\n",(0,i.jsxs)(n.p,{children:["The binary content of the file is put in the body of the request and a POST verb is used. O nome do arquivo \xe9 fornecido como par\xe2metro (",(0,i.jsx)(n.em,{children:"fileName"}),") no URL. Ele \xe9 recebido no objeto ",(0,i.jsx)(n.a,{href:"/docs/pt/API/IncomingMessageClass#urlquery",children:(0,i.jsx)(n.code,{children:"urlQuery"})})," na solicita\xe7\xe3o."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:'    //UploadFile class\n\nshared singleton Class constructor()\n	\n	\nFunction uploadFile($request : 4D.IncomingMessage) : 4D.OutgoingMessage\n	\n	var $response:=4D.OutgoingMessage.new()\n	\n	var $body:="Not supported file"\n	var $fileName; $fileType : Text\n	var $file : 4D.File\n	var $picture : Picture\n	var $created : Boolean\n	\n	$fileName:=$request.urlQuery.fileName\n	$fileType:=$request.getHeader("Content-Type")\n	\n	Case of \n		: ($fileType="application/pdf")\n			$file:=File("/PACKAGE/Files/"+$fileName+".pdf")\n			$created:=$file.create()\n			$file.setContent($request.getBlob())\n			$body:="Upload OK - File size: "+String($file.size)\n			\n		: ($fileType="image/jpeg")\n			$file:=File("/PACKAGE/Files/"+$fileName+".jpg")\n			$picture:=$request.getPicture()\n			WRITE PICTURE FILE($file.platformPath; $picture)\n			$body:="Upload OK - Image size: "+String($file.size)\n			\n	End case \n	\n	$response.setBody($body)\n	$response.setHeader("Content-Type"; "text/plain")\n	\n	return $response\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"veja-tamb\xe9m",children:"Veja tamb\xe9m"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://blog.4d.com/master-http-requests-with-4d-request-handlers/",children:"Ma\xeetriser les requ\xeates HTTP avec les gestionnaires de requ\xeates 4D"})," (blog post)"]})]})}function h(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,n,s){s.d(n,{Z:()=>o,a:()=>l});var r=s(667294);let i={},t=r.createContext(i);function l(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);