"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["13297"],{882532:function(e,o,n){n.r(o),n.d(o,{metadata:()=>d,contentTitle:()=>a,default:()=>m,assets:()=>i,toc:()=>c,frontMatter:()=>t});var d=JSON.parse('{"id":"commands-legacy/open-document","title":"Open document","description":"Open document ( documento {; tipoArquivo}{; modo} ) : Time","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-20-R7/commands-legacy/open-document.md","sourceDirName":"commands-legacy","slug":"/commands/open-document","permalink":"/docs/pt/commands/open-document","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fopen-document.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"open-document","title":"Open document","slug":"/commands/open-document","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"Object to path","permalink":"/docs/pt/commands/object-to-path"},"next":{"title":"Path to object","permalink":"/docs/pt/commands/path-to-object"}}'),r=n("785893"),s=n("250065");let t={id:"open-document",title:"Open document",slug:"/commands/open-document",displayed_sidebar:"docs"},a=void 0,i={},c=[{value:"Descri\xe7\xe3o",id:"descri\xe7\xe3o",level:4},{value:"Exemplo 1",id:"exemplo-1",level:4},{value:"Exemplo 2",id:"exemplo-2",level:4},{value:"Vari\xe1veis e conjuntos do sistema",id:"vari\xe1veis-e-conjuntos-do-sistema",level:4},{value:"Ver tamb\xe9m",id:"ver-tamb\xe9m",level:4},{value:"Propriedades",id:"propriedades",level:4}];function l(e){let o={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.strong,{children:"Open document"})," ( ",(0,r.jsx)(o.em,{children:"documento"})," {; ",(0,r.jsx)(o.em,{children:"tipoArquivo"}),"}{; ",(0,r.jsx)(o.em,{children:"modo"}),"} ) : Time"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(o.table,{children:[(0,r.jsx)(o.thead,{children:(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.th,{children:"Par\xe2metro"}),(0,r.jsx)(o.th,{children:"Tipo"}),(0,r.jsx)(o.th,{}),(0,r.jsx)(o.th,{children:"Descri\xe7\xe3o"})]})}),(0,r.jsxs)(o.tbody,{children:[(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"documento"}),(0,r.jsx)(o.td,{children:"Text"}),(0,r.jsx)(o.td,{children:"\u2192"}),(0,r.jsx)(o.td,{children:"Nome de documento ou rota de acesso completa ou string vazia para caixa de di\xe1logo de arquivo"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"tipoArquivo"}),(0,r.jsx)(o.td,{children:"Text"}),(0,r.jsx)(o.td,{children:"\u2192"}),(0,r.jsx)(o.td,{children:'Lista de tipos de documentos a serem pesquisados, ou "*" para n\xe3o pesquisar os documentos'})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"modo"}),(0,r.jsx)(o.td,{children:"Integer"}),(0,r.jsx)(o.td,{children:"\u2192"}),(0,r.jsx)(o.td,{children:"Modo de abertura do documento"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Resultado"}),(0,r.jsx)(o.td,{children:"Time"}),(0,r.jsx)(o.td,{children:"\u2190"}),(0,r.jsx)(o.td,{children:"N\xfamero de refer\xeancia de documento"})]})]})]}),"\n",(0,r.jsx)(o.h4,{id:"descri\xe7\xe3o",children:"Descri\xe7\xe3o"}),"\n",(0,r.jsxs)(o.p,{children:["O comando Open document abre o documento cujo nome ou rota de acesso se passa em ",(0,r.jsx)(o.em,{children:"documento"}),"."]}),"\n",(0,r.jsxs)(o.p,{children:["Se passar uma string vazia em ",(0,r.jsx)(o.em,{children:"documento"}),", aparece uma caixa de di\xe1logo padr\xe3o de abertura de arquivos, e o usu\xe1rio pode selecionar o documento a abrir. Se cancelar o di\xe1logo, o documento n\xe3o \xe9 aberto; Open document retorna uma refer\xeancia de documento nula, e a vari\xe1vel OK toma o valor 0."]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Se o documento abrir corretamente, Open document retorna seu n\xfamero de refer\xeancia e a vari\xe1vel OK toma o valor 1."}),"\n",(0,r.jsxs)(o.li,{children:["Se o documento estiver aberto e o par\xe2metro ",(0,r.jsx)(o.em,{children:"modo"})," for omitido, Open document abre o documento em modo leitura/escritura e a vari\xe1vel OK toma o valor 1."]}),"\n",(0,r.jsx)(o.li,{children:"Se o documento j\xe1 estiver aberto em modo leitura/escritura e voc\xea tentar abri-lo em modo escrita, um erro \xe9 gerado (-43) No entanto pode abri-lo em modo leitura unicamente, logo a vari\xe1vel OK toma o valor 1."}),"\n",(0,r.jsx)(o.li,{children:"Se o documento n\xe3o existir, um erro \xe9 gerado."}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["No par\xe2metro ",(0,r.jsx)(o.em,{children:"tipoArquivo"}),', passe os tipos de arquivos que podem ser selecionados na caixa de di\xe1logo de abertura. Pode passar uma lista de v\xe1rios tipos separados por um ";" (ponto e v\xedrgula). Para cada tipo definido, uma linha nser\xe1 adicionada ao menu para escolher o tipo de caixa de di\xe1logo.']}),"\n",(0,r.jsxs)(o.p,{children:['Em Mac OS, pode passar o tipo Mac OS cl\xe1sico (TEXT, APPL, etc.), ou um tipo UTI (Uniform Tipo Identifier). Os tipos UTIs s\xe3o definidos por Apple para responder as necessidades de padroniza\xe7\xe3o dos tipos de arquivos. Por exemplo, "public.text" \xe9 o tipo UTI dos arquivos de tipo texto. Para maior informa\xe7\xe3o sobre os UTIs, consulte a seguinte dire\xe7\xe3o:',(0,r.jsx)(o.br,{}),"\n",(0,r.jsx)(o.em,{children:(0,r.jsx)(o.a,{href:"https://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding%5C_utis/understand%5C_utis%5C_intro/understand%5C_utis%5C_intro.html",children:"https://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding\\_utis/understand\\_utis\\_intro/understand\\_utis\\_intro.html"})}),"."]}),"\n",(0,r.jsx)(o.p,{children:"Em Windows, tamb\xe9m pode passar um tipo de arquivo cl\xe1ssico Mac OS, 4D realiza a correspond\xeancia interna, ou a extens\xe3o dos arquivos (.txt, .exe, etc.). Note que em Windows, o usu\xe1rio pode \u201Cfor\xe7ar\u201D a visualiza\xe7\xe3o de todos os tipos de arquivos introduzindo *.* na caixa de di\xe1logo. Entretanto, neste caso, 4D realizar\xe1 uma verifica\xe7\xe3o adicional dos tipos de arquivos selecionados: se o usu\xe1rio selecionar um tipo de arquivo n\xe3o autorizado, o comando retorna um erro."}),"\n",(0,r.jsxs)(o.p,{children:['Se n\xe3o deseja restringir os arquivos mostrados a um ou mais tipos, passe a cadeia "*" (asterisco) ou ".*" em ',(0,r.jsx)(o.em,{children:"tipoArquivo"}),"."]}),"\n",(0,r.jsxs)(o.p,{children:["O par\xe2metro opcional ",(0,r.jsx)(o.em,{children:"modo"})," permite definir o modo de abertura do arquivo ",(0,r.jsx)(o.em,{children:"documento"}),'. Est\xe3o dispon\xedveis quatro diferentes modos de abertura. 4D oferece as seguintes constantes pr\xe9-definidas, localizadas no tema "',(0,r.jsx)(o.em,{children:"Documentos Sistema"}),'":']}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(o.table,{children:[(0,r.jsx)(o.thead,{children:(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.th,{children:"Constante"}),(0,r.jsx)(o.th,{children:"Tipo"}),(0,r.jsx)(o.th,{children:"Valor"})]})}),(0,r.jsxs)(o.tbody,{children:[(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Get Pathname"}),(0,r.jsx)(o.td,{children:"Inteiro longo"}),(0,r.jsx)(o.td,{children:"3"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Read and Write"}),(0,r.jsx)(o.td,{children:"Inteiro longo"}),(0,r.jsx)(o.td,{children:"0"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Read Mode"}),(0,r.jsx)(o.td,{children:"Inteiro longo"}),(0,r.jsx)(o.td,{children:"2"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Write Mode"}),(0,r.jsx)(o.td,{children:"Inteiro longo"}),(0,r.jsx)(o.td,{children:"1"})]})]})]}),"\n",(0,r.jsxs)(o.p,{children:["Quando um documento for aberto, Open document se localiza inicialmente ao come\xe7o do documento, enquanto ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/append-document",children:"Append document"})," \xe9 localizado ao final do documento."]}),"\n",(0,r.jsxs)(o.p,{children:["Quando abrir um documento, pode ler e escrever no documento utilizando os comandos ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/receive-packet",children:"RECEIVE PACKET"})," e ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/send-packet",children:"SEND PACKET"})," que pode combinar com os comandos ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/get-document-position",children:"Get document position"})," e ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/set-document-position",children:"SET DOCUMENT POSITION"})," para acessar diretamente a qualquer parte do documento."]}),"\n",(0,r.jsxs)(o.p,{children:["N\xe3o esque\xe7a de, no final, chamar ",(0,r.jsx)(o.a,{href:"/docs/pt/commands/close-document",children:"CLOSE DOCUMENT"})," para o documento."]}),"\n",(0,r.jsx)(o.h4,{id:"exemplo-1",children:"Exemplo 1"}),"\n",(0,r.jsx)(o.p,{children:"O exemplo abaixo abre um documento existente chamado Nota, escreve a string \u201CAt\xe9 logo\u201D, e fecha o documento. Se o documento contiver a string \u201COl\xe1\u201D, esta string ser\xe1 substituida:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-4d",children:'\n//``\n\n  \n```4d\n\xa0[#code4D]var vhDoc : Time\n\xa0vhDoc:=Open document("Note.txt";Read and Write)\xa0//Open a document called Note\n\xa0If(OK=1)\n\xa0\xa0\xa0\xa0SEND PACKET(vhDoc;"Good-bye")\xa0//Write one word into the document\n\xa0\xa0\xa0\xa0CLOSE DOCUMENT(vhDoc)\xa0//Close the document\n\xa0End if[#/code4D]\n\xa0\n\xa0\n'})}),"\n",(0,r.jsx)(o.h4,{id:"exemplo-2",children:"Exemplo 2"}),"\n",(0,r.jsx)(o.p,{children:"Agora pode ler um documento mesmo se estiver aberto em modo escrita:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-4d",children:'\xa0vDoc:=Open document("PassFile";"TEXT")\xa0// O arquivo est\xe1 aberto\n\xa0\xa0// Antes de fechar o arquivo, \xe9 poss\xedvel consult\xe1-lo em modo apenas leitura:\n\xa0vRef:=Open document("PassFile";"TEXT";Read Mode)\xa0// O arquivo est\xe1 fechado\n'})}),"\n",(0,r.jsx)(o.h4,{id:"vari\xe1veis-e-conjuntos-do-sistema",children:"Vari\xe1veis e conjuntos do sistema"}),"\n",(0,r.jsx)(o.p,{children:"Se o documento for aberto corretamente, a vari\xe1vel sistema OK assume o valor 1; do contr\xe1rio, assume o valor 0. Depois da chamada, a vari\xe1vel sistema Document cont\xe9m o nome completo do documento."}),"\n",(0,r.jsxs)(o.p,{children:["Se passa o valor 3 em ",(0,r.jsx)(o.em,{children:"modo"}),", a fun\xe7\xe3o retorna ?00:00:00? (sem refer\xeancia de documento). O documento n\xe3o \xe9 aberto mas as vari\xe1veis sistema Document e OK s\xe3o atualizadas:"]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["\n",(0,r.jsx)(o.p,{children:"OK toma o valor 1."}),"\n"]}),"\n",(0,r.jsxs)(o.li,{children:["\n",(0,r.jsxs)(o.p,{children:["Document cont\xe9m a rota de acesso e o nome do arquivo ",(0,r.jsx)(o.em,{children:"document"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.strong,{children:"Nota"}),": se n\xe3o for encontrado o arquivo definido em ",(0,r.jsx)(o.em,{children:"documento"})," ou se for passado uma string vazia em ",(0,r.jsx)(o.em,{children:"documento"}),", aparece uma caixa de di\xe1logo de abertura de arquivos. Se o usu\xe1rio escolher um documento e clicar no bot\xe3o OK, ",(0,r.jsx)(o.em,{children:"documento"})," define a rota ao documento selecionado pelo usu\xe1rio e OK toma o valor 1. Se o usu\xe1rio clicar no bot\xe3o Cancelar, OK toma o valor 0."]}),"\n",(0,r.jsx)(o.h4,{id:"ver-tamb\xe9m",children:"Ver tamb\xe9m"}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.a,{href:"/docs/pt/commands/append-document",children:"Append document"}),(0,r.jsx)(o.br,{}),"\n",(0,r.jsx)(o.a,{href:"/docs/pt/commands/create-document",children:"Create document"})]}),"\n",(0,r.jsx)(o.h4,{id:"propriedades",children:"Propriedades"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(o.table,{children:[(0,r.jsx)(o.thead,{children:(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.th,{}),(0,r.jsx)(o.th,{})]})}),(0,r.jsxs)(o.tbody,{children:[(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"N\xfamero do comando"}),(0,r.jsx)(o.td,{children:"264"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Thread-seguro"}),(0,r.jsx)(o.td,{children:"\u2713"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:"Modificar vari\xe1veis"}),(0,r.jsx)(o.td,{children:"OK, Document, error"})]})]})]})]})}function m(e={}){let{wrapper:o}={...(0,s.a)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},250065:function(e,o,n){n.d(o,{Z:function(){return a},a:function(){return t}});var d=n(667294);let r={},s=d.createContext(r);function t(e){let o=d.useContext(s);return d.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),d.createElement(s.Provider,{value:o},e.children)}}}]);