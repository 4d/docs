"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["97782"],{379111:function(e,o,r){r.r(o),r.d(o,{default:()=>m,frontMatter:()=>n,metadata:()=>s,assets:()=>i,toc:()=>c,contentTitle:()=>t});var s=JSON.parse('{"id":"Concepts/error-handling","title":"Gest\xe3o de erros","description":"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es.","source":"@site/i18n/pt/docusaurus-plugin-content-docs/version-19/Concepts/error-handling.md","sourceDirName":"Concepts","slug":"/Concepts/error-handling","permalink":"/docs/pt/19/Concepts/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20Concepts%2Ferror-handling.md%20(19)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"19","frontMatter":{"id":"error-handling","title":"Gest\xe3o de erros"},"sidebar":"docs","previous":{"title":"Etiquetas de transforma\xe7\xe3o","permalink":"/docs/pt/19/Tags/tags"},"next":{"title":"Modos interpretado e compilado","permalink":"/docs/pt/19/Concepts/interpreted-compiled"}}'),a=r("785893"),d=r("250065");let n={id:"error-handling",title:"Gest\xe3o de erros"},t=void 0,i={},c=[{value:"Erro ou status",id:"erro-ou-status",level:2},{value:"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros",id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros",level:2},{value:"Alcance e componentes",id:"alcance-e-componentes",level:3},{value:"Manejo de erros dentro do m\xe9todo",id:"manejo-de-erros-dentro-do-m\xe9todo",level:3},{value:"Exemplo",id:"exemplo",level:4},{value:"Utilizar um m\xe9todo de gest\xe3o de erro vazio",id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio",level:3}];function l(e){let o={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.p,{children:"O manejo de erros \xe9 o processo de antecipar e responder aos erros que possam ocorrer em sua aplica\xe7\xe3o. 4D oferece assist\xeancia completa \xe0 detec\xe7\xe3o e notifica\xe7\xe3o de erros no tempo de execu\xe7\xe3o, assim como a an\xe1lise de suas condi\xe7\xf5es."}),"\n",(0,a.jsx)(o.p,{children:"Manejo de erros responde \xe0 duas necessidades principais:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsx)(o.li,{children:"descobrir e consertar erros potenciais e bugs no c\xf3digo durante a fase de desenvolvimento,"}),"\n",(0,a.jsx)(o.li,{children:"detectar e recuperar de erros inesperados nas aplica\xe7\xf5es implementadas; em particular pode substituir di\xe1logos de erros de sistemas (disco cheio, arquivo faltando, etc) com sua pr\xf3pria interface."}),"\n"]}),"\n",(0,a.jsxs)(o.blockquote,{children:["\n",(0,a.jsx)(o.p,{children:"\xc9 recomendado instalar um m\xe9todo de gerenciamento de erros em 4D Server, para todos os c\xf3digos rodando no servidor. Esse m\xe9todo evitaria a exibi\xe7\xe3o de caixas de di\xe1logo inesperadas no computador do servidor e poderia registrar os erros em um arquivo dedicado para an\xe1lises posteriores."}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"erro-ou-status",children:"Erro ou status"}),"\n",(0,a.jsxs)(o.p,{children:["Muitas fun\xe7\xf5es de classe 4D, tais como ",(0,a.jsx)(o.code,{children:"entity.save()"})," ou ",(0,a.jsx)(o.code,{children:"transporter.send()"}),', devolvem um objecto com o estatuto **. Este objecto \xe9 utilizado para armazenar erros "previs\xedveis" no contexto do tempo de execu\xe7\xe3o, por exemplo, palavra-passe inv\xe1lida, entidade bloqueada, etc., que n\xe3o interrompem a execu\xe7\xe3o do programa. Esta categoria de erros pode ser tratada por c\xf3digo normal.']}),"\n",(0,a.jsx)(o.p,{children:'Outros erros "imprevis\xedveis" incluem erro de grava\xe7\xe3o em disco, falha de rede, ou em geral qualquer interrup\xe7\xe3o inesperada. Esta categoria de erros gera exce\xe7\xf5es e precisa ser tratada atrav\xe9s de um m\xe9todo de tratamento de erros.'}),"\n",(0,a.jsx)(o.h2,{id:"instala\xe7\xe3o-de-um-m\xe9todo-de-gest\xe3o-de-erros",children:"Instala\xe7\xe3o de um m\xe9todo de gest\xe3o de erros"}),"\n",(0,a.jsxs)(o.p,{children:["Em 4D, todos os erros podem ser capturados e tratados em um m\xe9todo de projeto espec\xedfico, o m\xe9todo ",(0,a.jsx)(o.strong,{children:"de tratamento de erros"})," (ou ",(0,a.jsx)(o.strong,{children:"captura de erros"}),")."]}),"\n",(0,a.jsxs)(o.p,{children:["Esse m\xe9todo de projeto \xe9 instalado para o processo atual e ser\xe1 chamado automaticamente para qualquer erro que ocorra no processo, no modo interpretado ou compilado. Para ",(0,a.jsx)(o.em,{children:"instalar"})," esse m\xe9todo projeto, voc\xea s\xf3 precisa chamar o comando ",(0,a.jsx)(o.code,{children:"ON ERR CALL"})," com o nome do m\xe9todo projeto como par\xe2metro. Por exemplo:"]}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:'ON ERR CALL("IO_ERRORS") //Instala o m\xe9todo de tratamento de erros\n'})}),"\n",(0,a.jsxs)(o.p,{children:["Para parar de capturar erros e devolver a m\xe3o ao 4D, chame ",(0,a.jsx)(o.code,{children:"ON ERR CALL"})," com uma string vazia:"]}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:'ON ERR CALL("") //devolve o controlo a 4D\n'})}),"\n",(0,a.jsxs)(o.p,{children:["O m\xe9todo  ",(0,a.jsx)(o.code,{children:"Method called on error"})," permite que voc\xea saiba o nome do m\xe9todo instalado por ",(0,a.jsx)(o.code,{children:"ON ERR CALL"})," para o processo atual. \xc9 particularmente \xfatil no contexto dos componentes porque permite mudar temporariamente e depois restaurar o m\xe9todo de captura de erros do banco de dados local:"]}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:' $methCurrent:=Method called on error\n ON ERR CALL("NewMethod")\n  //Se o documento n\xe3o pouder ser aberto, um erro \xe9 gerado\n $ref:=Open document("MyDocument")\n  //Reinstala\xe7\xe3o do m\xe9todo anterior\n ON ERR CALL($methCurrent)\n\n'})}),"\n",(0,a.jsx)(o.h3,{id:"alcance-e-componentes",children:"Alcance e componentes"}),"\n",(0,a.jsx)(o.p,{children:"Pode definir um \xfanico m\xe9todo de captura de erros para toda a aplica\xe7\xe3o ou diferentes m\xe9todos por m\xf3dulo de aplica\xe7\xe3o. No entanto, somente um m\xe9todo pode ser instalado por processo."}),"\n",(0,a.jsxs)(o.p,{children:["Um m\xe9todo de tratamento de erros instalado pelo comando ",(0,a.jsx)(o.code,{children:"ON ERR CALL"})," s\xf3 se aplica ao aplicativo em execu\xe7\xe3o. No caso de um erro gerado por um ",(0,a.jsx)(o.strong,{children:"componente"}),", o m\xe9todo de tratamento de erros ",(0,a.jsx)(o.code,{children:"ON ERR CALL"})," da aplica\xe7\xe3o host n\xe3o \xe9 chamado, e vice-versa."]}),"\n",(0,a.jsx)(o.h3,{id:"manejo-de-erros-dentro-do-m\xe9todo",children:"Manejo de erros dentro do m\xe9todo"}),"\n",(0,a.jsx)(o.p,{children:"No m\xe9todo de erro personalizado, voc\xea tem acesso a v\xe1rias informa\xe7\xf5es que ajudar\xe3o voc\xea a identificar o erro:"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["\n",(0,a.jsx)(o.p,{children:"vari\xe1veis sistema (*):"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"Error"})," (inteiro longo): c\xf3digo de erro"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"Error method"}),"(texto): nome do m\xe9todo que provocou o erro"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"Error line"})," (entero largo): n\xfamero de l\xednea do m\xe9todo que provocou o erro"]}),"\n",(0,a.jsxs)(o.li,{children:[(0,a.jsx)(o.code,{children:"Error formula"})," (text): f\xf3rmula do c\xf3digo 4D (texto bruto) que est\xe1 na origem do erro."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(o.admonition,{type:"info",children:[(0,a.jsxs)(o.p,{children:["4D mant\xe9m automaticamente uma s\xe9rie de vari\xe1veis chamadas ",(0,a.jsx)(o.a,{href:"/docs/pt/19/Concepts/variables#system-variables",children:(0,a.jsx)(o.strong,{children:"vari\xe1veis sistema"})}),", que respondem a diferentes necessidades. :::"]}),(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["o comando ",(0,a.jsx)(o.code,{children:"GET LAST ERROR STACK"})," que retorna informa\xe7\xf5es sobre a pilha de erros atual da aplica\xe7\xe3o 4D."]}),"\n",(0,a.jsxs)(o.li,{children:["o comando ",(0,a.jsx)(o.code,{children:"Get call chain"})," que devolve uma cole\xe7\xe3o de objetos que descrevem cada passo da string de chamadas a m\xe9todos dentro do processo atual."]}),"\n"]}),(0,a.jsx)(o.h4,{id:"exemplo",children:"Exemplo"}),(0,a.jsx)(o.p,{children:"Aqui est\xe1 um sistema de gest\xe3o de erros simples:"}),(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:'//instalar o m\xe9todo de gest\xe3o de erros\n ON ERR CALL("errorMethod")\n //... executar o c\xf3digo\n ON ERR CALL("") //retorna o controle para 4D\n'})}),(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:'// m\xe9todo projeto errorMethod\n If(Error#1006) //essa n\xe3o \xe9 uma interrup\xe7\xe3o do usu\xe1rio\n    ALERT("Um erro foi produzido "+String(Error)+". O c\xf3digo em quest\xe3o \xe9: \\""+Error formula+"\\"")\n End if\n'})}),(0,a.jsx)(o.h3,{id:"utilizar-um-m\xe9todo-de-gest\xe3o-de-erro-vazio",children:"Utilizar um m\xe9todo de gest\xe3o de erro vazio"}),(0,a.jsxs)(o.p,{children:["Se quiser que a caixa de di\xe1logo fique escondida, pode instalar um m\xe9todo de gest\xe3o de erros vazio. A vari\xe1vel sistema ",(0,a.jsx)(o.code,{children:"Error"})," pode ser provada em qualquer m\xe9todo, ou seja, fora do m\xe9todo de gest\xe3o de erros:"]}),(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-4d",children:'ON ERR CALL("emptyMethod") //emptyMethod exists but is empty\n$doc:=Open document( "myFile.txt")\nIf (Error=-43)\n    ALERT("File not found.")\nEnd if\nON ERR CALL("")\n'})})]})]})}function m(e={}){let{wrapper:o}={...(0,d.a)(),...e.components};return o?(0,a.jsx)(o,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},250065:function(e,o,r){r.d(o,{Z:function(){return t},a:function(){return n}});var s=r(667294);let a={},d=s.createContext(a);function n(e){let o=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:n(e.components),s.createElement(d.Provider,{value:o},e.children)}}}]);