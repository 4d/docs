<!doctype html><html lang=pt dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-19 docs-doc-page docs-doc-id-API/IMAPTransporterClass" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>IMAPTransporter | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/pt/19/API/IMAPTransporterClass><meta data-rh=true property=og:locale content=pt><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true name=docusaurus_locale content=pt><meta data-rh=true name=docsearch:language content=pt><meta data-rh=true name=docusaurus_version content=19><meta data-rh=true name=docusaurus_tag content=docs-default-19><meta data-rh=true name=docsearch:version content=19><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-19><meta data-rh=true property=og:title content="IMAPTransporter | 4D Docs"><meta data-rh=true name=description content="A classe IMAPTransporter permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP."><meta data-rh=true property=og:description content="A classe IMAPTransporter permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP."><link data-rh=true rel=icon href=/docs/pt/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/pt/19/API/IMAPTransporterClass><link data-rh=true rel=alternate href=https://developer.4d.com/docs/19/API/IMAPTransporterClass hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/19/API/IMAPTransporterClass hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/19/API/IMAPTransporterClass hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/19/API/IMAPTransporterClass hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/19/API/IMAPTransporterClass hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/19/API/IMAPTransporterClass hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://developer.4d.com/docs/pt/19/API/IMAPTransporterClass","name":"IMAPTransporter","position":1}]}</script><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/pt/opensearch.xml><script src=https://kit.fontawesome.com/daeacc3fc4.js crossorigin=anonymous></script><link rel=stylesheet href=/docs/pt/assets/css/styles.ae3169d2.css><script src=/docs/pt/assets/js/runtime~main.1c0f09b7.js defer></script><script src=/docs/pt/assets/js/main.e369ec22.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/docs/pt/img/logohome.png><div role=region aria-label="Saltar para o conteúdo principal"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Saltar para o conteúdo principal</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Alternar barra de navegação" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/pt/><div class=navbar__logo><img src=/docs/pt/img/logohome.png alt="Logotipo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/pt/img/logohome.png alt="Logotipo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Documentação 4D</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/pt/19/API/IMAPTransporterClass>19</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/pt/API/IMAPTransporterClass>21 BETA</a><li><a class=dropdown__link href=/docs/pt/20-R10/API/IMAPTransporterClass>20 R10</a><li><a class=dropdown__link href=/docs/pt/20/API/IMAPTransporterClass>20</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/pt/19/API/IMAPTransporterClass>19</a><li><a class=dropdown__link href=/docs/pt/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Português</a><ul class=dropdown__menu><li><a href=/docs/19/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/docs/fr/19/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/docs/es/19/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/docs/ja/19/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a><li><a href=/docs/pt/19/API/IMAPTransporterClass target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Alternar entre os modos escuro e claro (atualmente system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Pesquisa (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Pesquisa</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Voltar ao topo" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/pt/><img src=/docs/pt/img/logohome.png alt="Logotipo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/pt/img/logohome.png alt="Logotipo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Documentação 4D</b></a><nav aria-label="Barra lateral de documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/GettingStarted/installation>Começando</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Project/overview>Gestão de projectos</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Concepts/about>Conceitos da linguagem 4D</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/ORDA/overview>ORDA</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/docs/pt/19/API/overview>Referência da API de classe</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/overview>Funções de classe e comandos</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/ClassClass>Class</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/CollectionClass>Collection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/CryptoKeyClass>CryptoKey</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/DataClassClass>DataClass</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/DataStoreClass>DataStore</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/EmailObjectClass>Email</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/EntityClass>Entity</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/EntitySelectionClass>EntitySelection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/FileClass>File</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/FolderClass>Folder</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/FunctionClass>Function</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/pt/19/API/IMAPTransporterClass>IMAPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/MailAttachmentClass>MailAttachment</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/POP3TransporterClass>POP3Transporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/SessionClass>Session</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/SignalClass>Signal</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/SMTPTransporterClass>SMTPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/WebServerClass>WebServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/ZipArchiveClass>ZIPArchive</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/ZipFileClass>ZIPFile</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/pt/19/API/ZipFolderClass>ZIPFolder</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Preferences/overview>Preferências</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Admin/webAdmin>Administração</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Users/overview>Direitos de acesso</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/MSC/overview>CSM</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Backup/overview>Cópia de segurança e restauração</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/WebServer/overview>Servidor Web</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/WebServer/gettingStarted>Desenvolvimento Web</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/REST/gettingStarted>Servidor REST</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Desktop/clientServer>Cliente/Servidor</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/FormEditor/forms>Formulários</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/FormEditor/jsonReference>Propriedades do formulário</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/FormObjects/formObjectsOverview>Objectos formulário</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/FormObjects/propertiesReference>Propriedades dos objectos formulário</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Events/overview>Eventos formulário</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Menus/overview>Menus</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/pt/19/Desktop/building>Criar aplicação</a></div></ul></nav><button type=button title="Recolher a barra lateral" aria-label="Recolher a barra lateral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Trilha de navegação"><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Página inicial" class=breadcrumbs__link href=/docs/pt/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Referência da API de classe</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>IMAPTransporter</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Versão: 19</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">Nesta página</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>A classe <code>IMAPTransporter</code> permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objecto-imap-transporter>Objecto IMAP Transporter<a href=#objecto-imap-transporter class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h3>
<p>Os objectos do IMAP Transporter são instanciados com o comando <a href=#imap-new-transporter>IMAP New Transportter</a> . Eles oferecem as propriedades abaixo e funções:</p>


































































































<table><thead><tr><th><tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a>    <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada<tr><td><a href=#addflags><strong>.addFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</a>    adiciona flags ao <code>msgIDs</code> para as palavras-chave especificadas ``<tr><td><a href=#append><strong>.append</strong>( <em>mailObj</em> : Objecto ; <em>destinationBox</em> : Texto ; <em>opções</em> : Objecto ) : Object</a>    anexa um  <code>mailObj</code> ao <code>destinationBox</code><tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a>    o modo de autenticação utilizado para abrir a sessão no servidor de correio<tr><td><a href=#checkconnection><strong>.checkConnection()</strong> : Object</a>     verifica a ligação utilizando a informação armazenada no objeto de transporte<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a>    o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a>    o tempo máximo de espera (em segundos) de uma chamada para <code>.send( )</code> antes de ocorrer um timeout<tr><td><a href=#copy><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a>    A função <code>.getMails()</code><tr><td><a href=#createbox><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a>    cria uma caixa de correio com o  <code>nome</code>dado<tr><td><a href=#delete><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a>    define o marcador "apagado" para as mensagens definidas em <code>msgsIDs</code> ou <code>allMsgs</code><tr><td><a href=#deletebox><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a>    remove permanentemente a caixa de correio com o nome <code>dado</code> do servidor IMAP<tr><td><a href=#expunge><strong>.expunge()</strong> : Object</a>    remove todas as mensagens com o marcador "apagada" do servidor de correio IMAP.<tr><td><a href=#getboxinfo><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a>    devolve um objeto <code>boxInfo</code> correspondente à maibox actual, ou a caixa de correio <em>nome</em><tr><td><a href=#getboxlist><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a>    devolve uma colecção de caixas de correio descrevendo todas as caixas de correio disponíveis<tr><td><a href=#getdelimiter><strong>.getDelimiter()</strong> : Text</a>    devolve o carácter utilizado para delimitar os níveis de hierarquia no nome da caixa de correio<tr><td><a href=#getmail><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a>    A função <code>.getMail()</code><tr><td><a href=#getmails><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a>    devolve o BLOB contendo o conteúdo MIME para a mensagem correspondente a <em>msgNumber</em> ou <em>msgID</em> na caixa de correio designada pelo <code>IMAP_transporter</code><tr><td><a href=#getmimeasblob><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a>    copia as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a Caixa de destino ** no servidor IMAP<tr><td><a href=#host><strong>.host</strong> : Text</a>    o nome ou o endereço IP do servidor anfitrião<tr><td><a href=#logfile><strong>.logFile</strong> : Text</a>    o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio<tr><td><a href=#move><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a>    move as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a <em>destinationBox</em> no servidor IMAP<tr><td><a href=#numtoid><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a>    converte os números sequenciais para IDs únicos IMAP para as mensagens no intervalo sequencial designado por <em>startMsg</em> e <em>endMsg</em><tr><td><a href=#removeflags><strong>.removeFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</a>    remove flags do <code>msgIDs</code> para as <code>palavras-chave</code> especificadas<tr><td><a href=#renamebox><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a>    muda o nome de uma caixa de correio no servidor IMAP<tr><td><a href=#port><strong>.port</strong> : Integer</a>     o número do porto utilizado para as transações postais<tr><td><a href=#searchmails><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a>    procura por mensagens que correspondam ao dado <em>searchCriteria</em> na caixa de correio actual<tr><td><a href=#selectbox><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a>    A função <code>.selectBox()</code><tr><td><a href=#subscribe><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a>    permite adicionar ou remover a caixa de correio especificada de/para o conjunto de caixas de correio "subscritas" do servidor IMAP<tr><td><a href=#unsubscribe><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a>    remove uma caixa de correio de um conjunto de caixas de correio subscritas<tr><td><a href=#user><strong>.user</strong> : Text</a>     o nome de usuário utilizado para autenticação no servidor de correio</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=imap-new-transporter>IMAP New transporter<a href=#imap-new-transporter class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Informação de servidor de correio<tr><td>Resultados<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#imap-transporter-object>Objecto de transporte IMAP</a></table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição>Descrição<a href=#descrição class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>O comando <code>IMAP Novo transportador</code> configura uma nova ligação IMAP de acordo com o parâmetro <em>server</em> e devolve um novo objecto <em>transporter</em>. O objeto transporter retornado vai geralmente ser usado para receber emails.</p>
<p>No parâmetro <em>server</em>, passe um objeto contendo as propriedades abaixo:</p>

















































<table><thead><tr><th><em>server</em><th>Valor padrão (se omitido)<tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a>    <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada<td>False<tr><td>.<strong>accessTokenOAuth2</strong>: Texto<br>.<strong>accessTokenOAuth2</strong>: Objecto<br>Cadeia de texto ou objecto simbólico representando as credenciais de autorização do OAuth2. Usado apenas com OAUTH2 <code>authenticationMode</code>. Se <code>accessTokenOAuth2</code> for utilizado mas <code>authenticationMode</code> for omitido, é utilizado o protocolo OAuth 2 (se permitido pelo servidor). Não devolvido em <em><a href=#imap-transporter-object>IMAP transporter</a></em> objecto.<td>nenhum<tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a>    o modo de autenticação utilizado para abrir a sessão no servidor de correio<td>o modo de autenticação mais seguro disponível no servidor é usado<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a>    o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor<td>300<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a>    o tempo máximo de espera (em segundos) de uma chamada para <code>.send( )</code> antes de ocorrer um timeout<td>30<tr><td><a href=#host><strong>.host</strong> : Text</a>    o nome ou o endereço IP do servidor anfitrião<td><em>obrigatório</em><tr><td><a href=#logfile><strong>.logFile</strong> : Text</a>    o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio<td>nenhum<tr><td>.<strong>password</strong> : Texto<br>senha de usuário para autenticação no servidor. Não devolvido em <em><a href=#imap-transporter-object>IMAP transporter</a></em> objecto.<td>nenhum<tr><td><a href=#port><strong>.port</strong> : Integer</a>     o número do porto utilizado para as transações postais<td>993<tr><td><a href=#user><strong>.user</strong> : Text</a>     o nome de usuário utilizado para autenticação no servidor de correio<td>nenhum</table>
<blockquote>
<p><strong>Aviso</strong>: Certifique-se de que o tempo limite definido é inferior ao tempo limite do servidor, caso contrário, o tempo limite do cliente será inútil.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados>Resultados<a href=#resultados class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função devolve um  <a href=#imap-transporter-object><strong>objecto de transporte do IMAP</strong></a>. Todas as propriedades retornadas são <strong>apenas leitura</strong>.</p>
<blockquote>
<p>A ligação IMAP é automaticamente fechada quando o objecto transportador é destruído.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo>Exemplo<a href=#exemplo class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.logFile:="LogTest.txt" //log para salvar na pasta Logs</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(Not($status.success))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("An error occurred: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4dimaptransporternew>4D.IMAPTransporter.new()<a href=#4dimaptransporternew class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Informação de servidor de correio<tr><td>Resultados<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#imap-transporter-object>Objecto de transporte IMAP</a></table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-1>Descrição<a href=#descrição-1 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>4D.IMAPTransporter.new()</code> cria e devolve um novo objecto do tipo <code>4D.IMAPTransporter</code>. É idêntico ao comando <a href=#imap-new-transporter><code>IMAP Novo Transportador</code></a> (atalho).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=acceptunsecureconnection>.acceptUnsecureConnection<a href=#acceptunsecureconnection class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-2>Descrição<a href=#descrição-2 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.acceptUnsecureConnection</code> contém <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada quando a ligação encriptada não é possível.</p>
<p>Contém <strong>False</strong> se conexões cifradas não forem permitidas, neste caso um erro é retornado quando a conexão criptografada não for possível.</p>
<p>Estão disponíveis portos seguros:</p>
<ul>
<li>
<p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 ou 25: SMTP com atualização STARTTLS se for compat[ivel com o servidor.</li>
</ul>
</li>
<li>
<p>IMAP</p>
<ul>
<li>143: IMAP non-encrypted port</li>
<li>993: IMAP com atualização STARTTLS se for compatível com o servidor</li>
</ul>
</li>
<li>
<p>POP3</p>
<ul>
<li>110: Porta não criptografada POP3</li>
<li>995: POP3 com atualização STARTTLS se suportado pelo servidor.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=addflags>.addFlags()<a href=#addflags class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R6<td>Adicionado</table>
</div></div></details>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgIDs<td>any<td style=text-align:center>-><td>Coleção de strings: IDs únicos de mensagens (texto)<br>Texto: ID único de uma mensagem<br>Longint (todos IMAP): Todas as mensagens na caixa de correio seleccionada<tr><td>keywords<td>Object<td style=text-align:center>-><td>Flags de palavras chaves a adicionar<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação addFlags</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-3>Descrição<a href=#descrição-3 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.addFlags()</code> adiciona flags ao <code>msgIDs</code> para as palavras-chave especificadas ``.</p>
<p>No parâmetro <code>msgIDs</code> , pode passar qualquer um dos dois:</p>
<ul>
<li>uma colecção ** contendo as identificações únicas de mensagens específicas ou</li>
<li>o ID único (<em>texto</em>) de uma mensagem ou</li>
<li>a seguinte constante (<em>longint</em>) para todas as mensagens na caixa de correio seleccionada:</li>
</ul>















<table><thead><tr><th>Parâmetros<th>Valor<th>Comentário<tbody><tr><td>IMAP all<td>1<td>Seleccione todas as mensagens na caixa de correio seleccionada</table>
<p>O parâmetro <code>keywords</code> permite passar um objeto com valores de palavra-chave para as bandeiras específicas para adicionar a <code>msgIDs</code>. Pode passar qualquer uma das seguintes palavras-chave:</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th>Descrição<tbody><tr><td>$draft<td>Parâmetros<td>True para adicionar o marcador "draft" na mensagem<tr><td>$seen<td>Parâmetros<td>True para adicionar o marcador "seen" na mensagem<tr><td>$flagged<td>Parâmetros<td>True para adicionar o marcador "flagged" na mensagem<tr><td>$answered<td>Parâmetros<td>True para adicionar o marcador "answered" na mensagem<tr><td>$deleted<td>Parâmetros<td>True para adicionar o marcador "deleted" na mensagem</table>
<blockquote>
<ul>
<li>Os valores falsos são ignorados.</li>
<li>A interpretação dos marcadores de palavras-chave pode variar por cliente de correio.</li>
</ul>
</blockquote>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-1>Exemplo<a href=#exemplo-1 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Criar transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Marcar todas as mensagens de INBOX como lidas</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=append>.append()<a href=#append class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R6<td>Adicionado</table>
</div></div></details>
<p><strong>.append</strong>( <em>mailObj</em> : Objecto ; <em>destinationBox</em> : Texto ; <em>opções</em> : Objecto ) : Object</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>mailObj<td>Object<td style=text-align:center>-><td>Objeto Email<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Caixa de email que vai receber o objeto Email<tr><td>options<td>Object<td style=text-align:center>-><td>Objeto que contém informações do charset<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação anexada</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-4>Descrição<a href=#descrição-4 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.append()</code> anexa um  <code>mailObj</code> ao <code>destinationBox</code>.</p>
<p>No parâmetro <code>mailObj</code> , passe um objecto Email. In the <code>mailObj</code> parameter, pass an Email object. A função <code>.append()</code> é compatível com tags de palavras-chave no atributo <code>, palavra-chave</code> do objeto Email.</p>
<p>O parâmetro opcional <code>destinationBox</code> permite-lhe passar o nome de uma caixa de correio onde o <code>mailObj</code> será anexado. Se omitido, é utilizada a caixa de correio actual.</p>
<p>No parâmetro opcional <code>opções</code> , pode passar um objecto para definir o charset e a codificação para partes específicas do correio electrónico. Propriedades disponiveis:</p>




















<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>headerCharset<td>Text<td>Charset e codificação usados para as seguintes partes do e-mail: assunto, nomes de arquivos de anexo e atributos de nome de e-mail. Possíveis valores: Ver tabela de possíveis cartas abaixo<tr><td>bodyCharset<td>Text<td>Charset e codificação usados para o conteúdo html e corpo do e-mail. Possíveis valores: Ver tabela de possíveis cartas abaixo</table>
<p>Charsets possíveis:</p>






























<table><thead><tr><th>Parâmetros<th>Valor<th>Comentário<tbody><tr><td>mail mode ISO2022JP<td>US-ASCII_ISO-2022-JP_UTF8_QP<td><ul><li>headerCharset: US-ASCII se possível, japonês (ISO-2022-JP) & impressora, se possível, caso contrário, UTF-8 & Quoted-printable<li>bodyCharset: US-ASCII se possível, japonês (ISO-2022-JP) & 7-bit se possível, caso contrário, UTF-8 & Quoted-printable</ul><tr><td>mail mode ISO88591<td>ISO-8859-1<td><ul><li>headerCharset: ISO-8859-1 & Quoted-printable<li>bodyCharset: ISO-8859-1 & 8-bit</ul><tr><td>mail mode UTF8<td>US-ASCII_UTF8_QP<td>headerCharset & bodyCharset: US-ASCII se possível, caso contrário UTF-8 & Citação-printável (<strong>valor por padrão</strong>)<tr><td>modo de correio UTF8 na base64<td>US-ASCII_UTF8_B64<td>headerCharset & bodyCharset: US-ASCII se possível, senão UTF-8 & base64</table>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-2>Exemplo<a href=#exemplo-2 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para guardar um e-mail na caixa de correio Drafts:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$settings:=New object("host"; "domain.com"; "user"; "xxxx"; "password"; "xxxx"; "port"; 993)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.from:="xxxx@domain.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.subject:="Lorem Ipsum"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.textBody:="Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords:=Novo objecto</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$seen"]:= Verdadeiro/// assinalar a mensagem como lido</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$draft"]:= Verdadeiro/// assinalar a mensagem como um rascunho</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$imap.append($msg; "Rascunhos")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=authenticationmode>.authenticationMode<a href=#authenticationmode class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.authenticationMode</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-5>Descrição<a href=#descrição-5 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.authenticationMode&lt;</code> contém o modo de autenticação utilizado para abrir a sessão no servidor de correio.</p>
<p>Por padrão, o modo mais seguro suportado pelo servidor é usado.</p>
<p>Valores possíveis:</p>






























<table><thead><tr><th>Valor<th>Constantes<th>Comentário<tbody><tr><td>CRAM-MD5<td><code>IMAP authentication CRAM MD5</code><td>Autenticação usando o protocolo CRAM-MD5<tr><td>LOGIN<td><code>IMAP authentication login</code><td>Autenticação usando o protocolo LOGIN<tr><td>OAUTH2<td><code>Autenticação IMAP OAUTH2</code><td>Autenticação usando o protocolo OAuth2<tr><td>PLAIN<td><code>IMAP authentication plain</code><td>Autenticação usando o protocolo PLAIN</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnection>.checkConnection()<a href=#checkconnection class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.checkConnection()</strong> : Object</p>

















<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da ligação do objecto transportador</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-6>Descrição<a href=#descrição-6 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.checkConnection()</code>  verifica a ligação utilizando a informação armazenada no objeto de transporte, recria a ligação, se necessário, e devolve o estado. Esta função permite verificar se os valores fornecidos pelo utilizador são válidos e consistentes.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objeto-devolvido>Objeto devolvido<a href=#objeto-devolvido class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função envia um pedido para o servidor de correio e devolve um objecto descrevendo o estado do correio. Este objeto pode conter as seguintes propriedades:</p>





















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>boolean<td>Verdadeiro se a verificação for bem sucedida, Falso de outra forma<tr><td>status<td><td>number<td>(apenas SMTP) Código de estado devolvido pelo servidor de correio (0 no caso de um problema não relacionado com o processamento de correio)<tr><td>statusText<td><td>text<td>Mensagem de estado devolvida pelo servidor de correio, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor de correio)<tr><td><td>[ ].errCode<td>number<td>Código de erro 4D<tr><td><td>[ ].message<td>text<td>Descrição do erro 4D<tr><td><td>[ ].componentSignature<td>text<td>Assinatura da componente interna que devolveu o erro</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnectiondelay>.checkConnectionDelay<a href=#checkconnectiondelay class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-7>Descrição<a href=#descrição-7 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.checkConnectionDelay</code> contém o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor.  Se este tempo for excedido entre duas chamadas de método, a ligação ao servidor será verificada. Por padrão, se a propriedade não tiver sido definida no objecto <em>do servidor</em>, o valor é 300.</p>
<blockquote>
<p><strong>Aviso</strong>: Certifique-se de que o tempo limite definido é inferior ao tempo limite do servidor, caso contrário, o tempo limite do cliente será inútil.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=connectiontimeout>.connectionTimeOut<a href=#connectiontimeout class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-8>Descrição<a href=#descrição-8 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.sendTimeOut</code> contém o tempo máximo de espera (em segundos) de uma chamada para <code>.send( )</code> antes de ocorrer um timeout. .</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=copy>.copy()<a href=#copy class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Coleção de identificadores únicos de mensagens (strings)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Caixa de correio para receber mensagens copiadas<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação anexada</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-9>Descrição<a href=#descrição-9 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.copy()</code> A função <code>.getMails()</code>.</p>
<p>Pode passar:</p>
<ul>
<li>no parâmetro <em>msgsIDs</em> , uma colecção contendo as identificações únicas das mensagens específicas a copiar, ou</li>
<li>no parâmetro <em>allMsgs</em> , o <code>IMAP all</code> constante (inteiro) para copiar todas as mensagens na caixa de correio seleccionada.</li>
</ul>
<p>O parâmetro <em>destinationBox</em> permite-lhe passar um valor de texto com o nome da caixa de correio onde as cópias das mensagens serão colocadas.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-1-1>Exemplo 1<a href=#exemplo-1-1 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para copiar uma selecção de mensagens:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtém a coleção de mensagens com IDs únicos</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copia mensagens encontradas ao mailbox "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy($mailIds;"documents")</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-2-1>Exemplo 2<a href=#exemplo-2-1 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para copiar todas as mensagens na caixa de correio actual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copiar todas as mensagens ao "documents" mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy(IMAP all;"documents")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=createbox>.createBox()<a href=#createbox class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>19<td>Adicionado</table>
</div></div></details>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de criação da caixa de correio</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-10>Descrição<a href=#descrição-10 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.createBox()</code> cria uma caixa de correio com o  <code>nome</code>dado. Se o carácter separador hierárquico do servidor IMAP aparecer noutro lugar no nome da caixa de correio, o servidor IMAP criará os nomes dos pais necessários para criar a caixa de correio em questão.</p>
<p>Por outras palavras, uma tentativa de criar "Projectos/IMAP/Doc" num servidor em que "/" é o carácter separador hierárquico criará:</p>
<ul>
<li>Apenas a caixa de correio "Doc" se "Projectos" & "IMAP" já existir.</li>
<li>"IMAP" & "Doc" caixas de correio se apenas "Projectos" já existirem.</li>
<li>"Projectos" & "IMAP" & "Doc" caixas de correio, se ainda não existirem.</li>
</ul>
<p>No parâmetro <code>nome</code> , passe o nome da nova caixa de correio.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-3>Exemplo<a href=#exemplo-3 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para criar uma nova caixa de correio "Facturas":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:") If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.unsubscribe($name) If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox unsubscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=delete>.delete()<a href=#delete class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Coleção de identificadores únicos de mensagens (strings)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação apagada</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-11>Descrição<a href=#descrição-11 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.delete()</code> define o marcador "apagado" para as mensagens definidas em <code>msgsIDs</code> ou <code>allMsgs</code>.</p>
<p>Pode passar:</p>
<ul>
<li>no parâmetro <code>msgsIDs</code> , uma colecção contendo as identificações únicas das mensagens específicas a apagar, ou</li>
<li>no parâmetro <code>allMsgs</code> , o <code>IMAP all</code> constante (inteiro) para apagar todas as mensagens na caixa de correio seleccionada.</li>
</ul>
<p>A execução desta função não remove realmente as mensagens. As mensagens com a bandeira "apagar" ainda podem ser encontradas pela função <a href=#searchmails>.searchMails()</a> . As mensagens assinaladas são eliminadas do servidor IMAP com a função <a href=#expunge><code>.expunge()</code></a> ou seleccionando outra caixa de correio ou quando o objecto de transporte <a href=#imap-transporter-object></a> (criado com <a href=#imap-new-transporter>IMAP Novo transportador</a>) é destruído.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-1-2>Exemplo 1<a href=#exemplo-1-2 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para apagar uma selecção de mensagens:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obter coleção das IDs únicas de mensagem</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"Reports\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // Apagar mensagens selecionadas</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-2-2>Exemplo 2<a href=#exemplo-2-2 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para apagar todas as mensagens na caixa de correio actual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Objecto</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=Novo objecto</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="$transporter"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP Novo transportador($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar caixa de correio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:= .selectBox("Junk Email")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // apagar todas as mensagens na caixa de correio actual</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete(IMAP todos)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=deletebox>.deleteBox()<a href=#deletebox class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>19<td>Adicionado</table>
</div></div></details>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da caixa de correio a apagar<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de eliminação da caixa de correio</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-12>Descrição<a href=#descrição-12 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.deleteBox()</code> remove permanentemente a caixa de correio com o nome <code>dado</code> do servidor IMAP. A tentativa de apagar uma INBOX ou uma caixa de correio que não existe, gerará um erro.</p>
<p>No parâmetro <code>name</code> , passar o nome da caixa de correio para eliminar.</p>
<blockquote>
<ul>
<li>A função não pode apagar uma caixa de correio que tenha caixas de correio para crianças se a caixa de correio dos pais tiver o atributo "\Noselect".</li>
<li>Todas as mensagens na caixa de correio eliminadas serão também eliminadas.</li>
<li>A capacidade de apagar uma caixa de correio depende do servidor de correio.</li>
</ul>
</blockquote>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-4>Exemplo<a href=#exemplo-4 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para eliminar a caixa de correio filha "Nova Orion Industries" da hierarquia da caixa de correio "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:") If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.subscribe($name) If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox subscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=expunge>.expunge()<a href=#expunge class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R6<td>Adicionado</table>
</div></div></details>
<p><strong>.expunge()</strong> : Object</p>

















<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de expurgo</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-13>Descrição<a href=#descrição-13 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.expunge()</code> remove todas as mensagens com o marcador "apagada" do servidor de correio IMAP. O marcador "apagada" pode ser definida com os métodos <a href=#delete><code>.delete()</code></a> ou <a href=#addflags><code>.addFlags()</code></a> .</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-5>Exemplo<a href=#exemplo-5 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $ids : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Criar transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Encontrar e apagar todas as mensagens vistas no INBOX</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ids:=$transporter.searchMails("SEEN")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Expurga todas as mensagens marcadas como apagadas</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxinfo>.getBoxInfo()<a href=#getboxinfo class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td><em>name</em> é opcional</table>
<p>|18 R4|Adicionado|</p>
</div></div></details>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>objecto boxInfo</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-14>Descrição<a href=#descrição-14 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getBoxInfo()</code> devolve um objeto <code>boxInfo</code> correspondente à maibox actual, ou a caixa de correio <em>nome</em>. Esta função devolve a mesma informação que <a href=#selectbox><code>.selectBox()</code></a> sem alterar a caixa de correio actual.</p>
<p>No parâmetro opcional <em>nome</em> , passe o nome da caixa de correio para aceder. O nome representa uma hierarquia inequívoca da esquerda para a direita com níveis separados por um carácter delimitador específico. O delimitador pode ser encontrado com a função <a href=#getdelimiter><code>.getDelimiter()</code></a> .</p>
<p>Se a caixa de correio <em>nome</em> não for seleccionável ou não existir, a função gera um erro e devolve <strong>null</strong>.</p>
<p><strong>Objeto devolvido</strong></p>
<p>O objeto <code>boxInfo</code> retornado contém as funcionalidades abaixo:</p>

























<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>name<td>text<td>Nome da nova caixa de correio<tr><td>mailCount<td>number<td>Número de mensagens na caixa de email<tr><td>mailRecent<td>number<td>Número de mensagens com o marcador "recente" (indicando novas mensagens)</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-6>Exemplo<a href=#exemplo-6 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $info:=$transporter.getBoxInfo("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("INBOX contains "+String($info.mailRecent)+" recent emails.")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxlist>.getBoxList()<a href=#getboxlist class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado<tr><td>19<td>Adicionar parâmetro <code>isSubscribed</code></table>
</div></div></details>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>parameters<td>Object<td style=text-align:center>-><td>Parâmetros<tr><td>Resultados<td>Collection<td style=text-align:center>&lt;-<td>Coleção de objetos da caixa de correio</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-15>Descrição<a href=#descrição-15 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getBoxList()</code> devolve uma colecção de caixas de correio descrevendo todas as caixas de correio disponíveis. Esta função permite gerir localmente a lista de mensagens localizadas no servidor de correio IMAP.</p>
<p>No parâmetro opcional `` , passe um objeto contendo valores para filtrar as caixas de correio devolvidas. Pode passar:</p>















<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>isSubscribed<td>Parâmetros<td><li><strong>True</strong>* para devolver apenas caixas de correio inscritas</li><li> <strong>False</strong>* para devolver todas as caixas de correio disponíveis</li></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-1>Resultados<a href=#resultados-1 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Cada objecto da coleção devolvida contém as seguintes propriedades:</p>






























<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>[].name<td>text<td>Nome da nova caixa de correio<tr><td>[].selectable<td>boolean<td>Indica se os direitos de acesso permitem ou não a selecção da caixa de correio: <ul><li>true - a caixa de correio pode ser seleccionada<li>falso - a caixa de correio não pode ser seleccionada</ul><tr><td>[].inferior<td>boolean<td>Indica se os direitos de acesso permitem ou não a criação de uma hierarquia inferior na caixa de correio: <ul><li>true - pode ser criado um nível inferior<li>falso - um nível inferior não pode ser criado</ul><tr><td>[].interesting<td>boolean<td>Indica se a caixa de correio foi marcada como "interessante" pelo servidor: <ul><li>true - A caixa de correio foi marcada como "interessante" pelo servidor. Por exemplo, pode conter novas mensagens.<li>falso - A caixa de correio não foi marcada como "interessante" pelo servidor.</ul></table>
<p>Se a conta não contiver quaisquer caixas de correio, é devolvida uma colecção vazia.</p>
<blockquote>
<ul>
<li>Se não houver uma conexão aberta, <code>.getBoxList()</code> irá abrir uma conexão.</li>
<li>Se a conexão não tiver sido utilizada desde o atraso da ligação determinado (ver <code>IMAP Novo transportador</code>), a função <code>.checkConnection( )</code> é automaticamente chamada.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-7>Exemplo<a href=#exemplo-7 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getdelimiter>.getDelimiter()<a href=#getdelimiter class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.getDelimiter()</strong> : Text</p>

















<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>Resultados<td>Text<td style=text-align:center>&lt;-<td>Carácter delimitador da hierarquia</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-16>Descrição<a href=#descrição-16 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getDelimiter()</code> devolve o carácter utilizado para delimitar os níveis de hierarquia no nome da caixa de correio.</p>
<p>O delimitador é um caractere a que se pode usar para:</p>
<ul>
<li>criar caixas de correio de nível inferior</li>
<li>pesquisar hierarquias de nível mais alto ou mais baixo dentro das caixa de correio</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-2>Resultados<a href=#resultados-2 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Carácter delimitador do nome da caixa de correio.</p>
<blockquote>
<ul>
<li>Se não houver uma ligação aberta, <code>.getDelimiter()</code> irá abrir uma ligação.</li>
<li>Se a ligação não tiver sido utilizada desde o atraso da ligação designada <a href=#checkconnectiondelay></a>, a função <a href=#checkconnection><code>.checkConnection()</code></a> é automaticamente chamada.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-8>Exemplo<a href=#exemplo-8 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmail>.getMail()<a href=#getmail class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Número sequencial da mensagem<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID única da mensagem<tr><td>options<td>Object<td style=text-align:center>-><td>Instruções de tratamento de mensagens<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td><a href=/docs/pt/19/API/EmailObjectClass#email-object>Email objecto</a></table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-17>Descrição<a href=#descrição-17 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getMail()</code> A função <code>.getMail()</code>. Essa função permite manejar localmente os conteúdos de email.</p>
<p>No primeiro parâmetro, pode passar qualquer um dos dois:</p>
<ul>
<li><em>msgNumber</em>, um valor <em>inteiro</em> indicando o número de sequência da mensagem a recuperar ou</li>
<li><em>msgID</em>, um texto <em>valor</em> indicando a identificação única da mensagem a recuperar.</li>
</ul>
<p>O parâmetro opcional <em>opções</em> permite-lhe passar um objecto definindo instruções adicionais para o tratamento da mensagem. As seguintes propriedades estão disponíveis:</p>




















<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>updateSeen<td>boolean<td>Se Verdadeiro, a mensagem é marcada como "visto" na caixa de correio. Se falso, a mensagem não é marcada como "visto". Valor padrão: True<tr><td>withBody<td>boolean<td>Pass True para devolver o corpo da mensagem. Se falso, apenas o cabeçalho da mensagem é devolvido. Valor padrão: True</table>
<blockquote>
<ul>
<li>A função gera um erro e devolve <strong>Null</strong> se <em>msgID</em> designar uma mensagem inexistente,</li>
<li>Se nenhuma caixa de correio for seleccionada com a função <a href=#selectbox><code>.selectBox()</code></a> , é gerado um erro,</li>
<li>Se não houver uma ligação aberta, <code>.getMail()</code> abrirá uma ligação a última caixa de correio especificada com <a href=#selectbox><code>.selectBox()</code></a>`.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-3>Resultados<a href=#resultados-3 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p><code>.getMail()</code> devolve um <a href=/docs/pt/19/API/EmailObjectClass#email-object><code>Email</code> object</a> com as seguintes propriedades IMAP específicas: <em>id</em>, <em>recebidoEm</em>, e <em>tamanho</em>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-9>Exemplo<a href=#exemplo-9 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Se quiser receber uma mensagem com ID = 1:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //cria transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleciona mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtém objeto Email com ID 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmails>.getMails()<a href=#getmails class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>









































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>ids<td>Collection<td style=text-align:center>-><td>Colecção de identificação da mensagem<tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Número sequencial da primeira mensagem<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Número sequencial da última mensagem<tr><td>options<td>Object<td style=text-align:center>-><td>Instruções de tratamento de mensagens<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Parâmetro objecto<br><ul><li>uma colecção de <a href=/docs/pt/19/API/EmailObjectClass#email-object>Email objects</a> e<li>uma colecção de identificações ou números para mensagens em falta, se existirem</ul></table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-18>Descrição<a href=#descrição-18 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getMIMEAsBlob()</code> devolve o BLOB contendo o conteúdo MIME para a mensagem correspondente a <em>msgNumber</em> ou <em>msgID</em> na caixa de correio designada pelo <code>IMAP_transporter</code>.</p>
<p><strong>Primeira sintaxe:</strong></p>
<p><em><strong>.getMails( ids { ; options } ) -> result</strong></em></p>
<p>A primeira sintaxe permite recuperar mensagens com base nas suas identificações.</p>
<p>No parâmetro <em>ids</em> , passe uma colecção de IDs para as mensagens a devolver. Pode obter as identificações com <a href=#getmail><code>.getMail()</code></a>.</p>
<p>O parâmetro opcional <em>opções</em> permite definir as partes das mensagens a serem devolvidas. Ver a tabela <strong>Opções</strong> abaixo para uma descrição das propriedades disponíveis.</p>
<p><strong>Segunda sintaxe:</strong></p>
<p><em><strong>.getMails( startMsg ; endMsg { ; options } ) -> result</strong></em></p>
<p>A segunda sintaxe permite recuperar mensagens com base num intervalo sequencial. Os valores passados representam a posição das mensagens na caixa de correio.</p>
<p>No parâmetro <em>startMsg</em>, passe um valor inteiro correspondente ao número da primeira mensagem num intervalo sequencial. Se passar um número negativo (<em>startMsg</em> &lt;= 0), a primeira mensagem da caixa de correio será utilizada como o início da sequência.</p>
<p>No parâmetro <em>endMsg</em>, passe um valor inteiro correspondente ao número da última mensagem a ser incluída num intervalo sequencial. Se passar um número negativo (<em>endMsg</em> &lt;= 0), a última mensagem da caixa de correio será utilizada como o fim da sequência.</p>
<p>O parâmetro opcional <em>opções</em> permite definir as partes das mensagens a serem devolvidas.</p>
<p><strong>Opções</strong></p>




















<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>updateSeen<td>Parâmetros<td>Se Verdadeiro, as mensagens especificadas são marcadas como "vistas" na caixa de correio. Se falso, as mensagens não são marcadas como "vistas". Valor padrão: True<tr><td>withBody<td>Parâmetros<td>Pass True para devolver o corpo das mensagens especificadas. Se falso, apenas os cabeçalhos das mensagens são devolvidos. Valor padrão: True</table>
<blockquote>
<ul>
<li>Se nenhuma caixa de correio for seleccionada com o comando <a href=#selectbox><code>.selectBox()</code></a>, é gerado um erro.</li>
<li>Se não houver uma ligação aberta, <code>.getMails()</code> abrirá uma ligação a última caixa de correio especificada com <a href=#selectbox><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-4>Resultados<a href=#resultados-4 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p><code>.getMails()</code> devolve um objecto contendo as seguintes colecções:</p>




















<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>lista<td>Collection<td>Coleção de <a href=/docs/pt/19/API/EmailObjectClass#email-object><code>Email</code> objetos</a>. Se não forem encontrados objetos e-mail, uma coleção vazia é devolvida.<tr><td>notFound<td>Collection<td>Coleção:<br><ul><li>primeira sintaxe - IDs de mensagens passadas anteriormente que não existem<li>segunda sintaxe - números de sequência de mensagens entre startMsg e endMsg que não existem</ul>Uma colecção vazia é devolvida se todas as mensagens forem encontradas.</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-10>Exemplo<a href=#exemplo-10 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Se quiser recuperar os 20 e-mails mais recentes sem alterar o seu estatuto de "visto":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //create transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  If($boxInfo.mailCount>0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        New object("withBody";False;"updateSeen";False))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    For each($mail;$result.list)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End for each</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmimeasblob>.getMIMEAsBlob()<a href=#getmimeasblob class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Número sequencial da mensagem<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID única da mensagem<tr><td>updateSeen<td>Parâmetros<td style=text-align:center>-><td>Se Verdadeiro, a mensagem é marcada "visto" na caixa de correio. Se Falso, a mensagem é deixada intocada.<tr><td>Resultados<td>BLOB<td style=text-align:center>&lt;-<td>Blob da string MIME retornado do servidor mail</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-19>Descrição<a href=#descrição-19 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.getMIMEAsBlob()</code> copia as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a Caixa de destino ** no servidor IMAP.</p>
<p>No primeiro parâmetro, pode passar qualquer um dos dois:</p>
<ul>
<li><em>msgNumber</em>, um valor <em>inteiro</em> indicando o número de sequência da mensagem a recuperar ou</li>
<li><em>msgID</em>, um texto <em>valor</em> indicando a identificação única da mensagem a recuperar.</li>
</ul>
<p>O parâmetro opcional <em>updateSeen</em> permite-lhe especificar se a mensagem está marcada como "vista" na caixa de correio. Pode passar:</p>
<ul>
<li><strong>Verdadeiro</strong> - para marcar a mensagem como "vista" (indicando que a mensagem foi lida)</li>
<li><strong>False</strong> - para deixar o estado "seen" da mensagem intacto</li>
</ul>
<blockquote>
<ul>
<li>A função devolve um BLOB vazio se <em>msgNumber</em> ou msgID* designar uma mensagem inexistente,</li>
<li>Se nenhuma caixa de correio for seleccionada com o comando <a href=#selectbox><code>.selectBox()</code></a>, é gerado um erro,</li>
<li>Parâmetros</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-5>Resultados<a href=#resultados-5 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p><code>.getMIMEAsBlob()</code> retorna um <code>BLOB</code> que pode ser arquivado em um banco de dados ou convertido a um objeto <a href=/docs/pt/19/API/EmailObjectClass#email-object><code>Email</code> </a> com o comando <code>MAIL Convert from MIME</code>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-11>Exemplo<a href=#exemplo-11 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Objecto</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $boxInfo : Variante</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $blob : Blob</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=Novo objecto</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:=" "</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //criar transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP Novo transportador($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar caixa de correio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //get BLOB</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=host>.host<a href=#host class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.host</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-20>Descrição<a href=#descrição-20 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.host</code> contém o nome ou o endereço IP do servidor anfitrião. Utilizado para transacções postais (SMTP, POP3, IMAP).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logfile>.logFile<a href=#logfile class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.logFile</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-21>Descrição<a href=#descrição-21 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.logFile</code> contém o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio. Pode ser relativo (à pasta atual de Logs) ou absoluto.</p>
<p>Ao contrário dos arquivos de registo regulares (ativados através do comando <code>SET DATABASE PARAMETER</code> ), os arquivos de registo armazenam o conteúdo MIME de todos os e-mails enviados e não têm qualquer limite de tamanho. Para mais informações sobre arquivos de registo estendidos, consultar:</p>
<ul>
<li><strong>SMTP connections</strong> - <a href=/docs/pt/19/Admin/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DSMTPLog.txt</a></li>
<li><strong>POP3 connections</strong> - <a href=/docs/pt/19/Admin/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DPOP3Log.txt</a></li>
<li><strong>IMAP connections</strong> - <a href=/docs/pt/19/Admin/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DIMAPLog.txt</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=move>.move()<a href=#move class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Coleção de identificadores únicos de mensagens (strings)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Caixa de correio para receber mensagens movimentadas<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de mudança</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-22>Descrição<a href=#descrição-22 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.move()</code> move as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a <em>destinationBox</em> no servidor IMAP.</p>
<p>Pode passar:</p>
<ul>
<li>no parâmetro <em>msgsIDs</em>, uma colecção contendo as identificações únicas das mensagens específicas a mover, ou</li>
<li>no parâmetro <em>allMsgs</em>, o <code>IMAP all</code> constante (inteiro) para mover todas as mensagens na caixa de correio seleccionada.</li>
</ul>
<p>O parâmetro <em>destinationBox</em> permite-lhe passar um valor de texto com o nome da caixa de correio onde as mensagens serão movimentadas.</p>
<blockquote>
<p>Esta função só é suportada por servidores IMAP em conformidade com o RFC <a href=https://tools.ietf.org/html/rfc8474 target=_blank rel="noopener noreferrer">8474</a>.</p>
</blockquote>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-1-3>Exemplo 1<a href=#exemplo-1-3 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para mover uma selecção de mensagens:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obter coleção das IDs únicas de mensagem</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // mover mensagens encontradas da caixa de correio actual para a caixa de correio "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move($mailIds; "documentos")</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-2-3>Exemplo 2<a href=#exemplo-2-3 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para mover todas as mensagens na mailbox atual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar caixa de correio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // mover todas as mensagens da caixa de correio actual para a caixa de correio "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move(IMAP all;"documents")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=numtoid>.numToID()<a href=#numtoid class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Número sequencial da primeira mensagem<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Número sequencial da última mensagem<tr><td>Resultados<td>Collection<td style=text-align:center>&lt;-<td>Colecção de identificações únicas</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-23>Descrição<a href=#descrição-23 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.numToID()</code> converte os números sequenciais para IDs únicos IMAP para as mensagens no intervalo sequencial designado por <em>startMsg</em> e <em>endMsg</em> na caixa de correio actualmente seleccionada.</p>
<p>No parâmetro <em>startMsg</em> , passe um valor <em>inteiro</em> correspondente ao número da primeira mensagem num intervalo sequencial. Se passar um número negativo (<em>startMsg</em> &lt;= 0), a primeira mensagem da caixa de correio será utilizada como o início da sequência.</p>
<p>No parâmetro <em>endMsg</em> , passe um valor <em>inteiro</em> correspondente ao número da última mensagem a ser incluída num intervalo sequencial. Se passar um número negativo (<em>endMsg</em> &lt;= 0), a última mensagem da caixa de correio será utilizada como o fim da sequência.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resultados-6>Resultados<a href=#resultados-6 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função devolve uma colecção de cordas (identificações únicas).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-12>Exemplo<a href=#exemplo-12 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //select mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obter IDs para 5 últimas mensagens recebidas</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //excluir as mensagens da caixa de correio actual</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=removeflags>.removeFlags()<a href=#removeflags class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R6<td>Adicionado</table>
</div></div></details>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : any ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>msgIDs<td>any<td style=text-align:center>-><td>Coleção de strings: IDs únicos de mensagens (texto)<br>Texto: ID único de uma mensagem<br>Longint (todos IMAP): Todas as mensagens na caixa de correio seleccionada<tr><td>keywords<td>Object<td style=text-align:center>-><td>Flags de palavras-chave a remover<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação removeFlags</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-24>Descrição<a href=#descrição-24 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.removeFlags()</code> remove flags do <code>msgIDs</code> para as <code>palavras-chave</code> especificadas.</p>
<p>No parâmetro <code>msgIDs</code> , pode passar qualquer um dos dois:</p>
<ul>
<li>uma colecção ** contendo as identificações únicas de mensagens específicas ou</li>
<li>o ID único (<em>texto</em>) de uma mensagem ou</li>
<li>a seguinte constante (<em>longint</em>) para todas as mensagens na caixa de correio seleccionada:</li>
</ul>















<table><thead><tr><th>Parâmetros<th>Valor<th>Comentário<tbody><tr><td>IMAP all<td>1<td>Seleccione todas as mensagens na caixa de correio seleccionada</table>
<p>O parâmetro <code>keywords</code> permite passar um objeto com valores de palavra-chave para as bandeiras específicas a serem removidas de <code>msgIDs</code>. Pode passar qualquer uma das seguintes palavras-chave:</p>



































<table><thead><tr><th>Parâmetro<th>Tipo<th>Descrição<tbody><tr><td>$draft<td>Parâmetros<td>True para remover o flag "draft" na mensagem<tr><td>$seen<td>Parâmetros<td>True para remover a flag "seen" na mensagem<tr><td>$flagged<td>Parâmetros<td>True para remover a flag "flagged" na mensagem<tr><td>$answered<td>Parâmetros<td>True para remover a flag "answered" na mensagem<tr><td>$deleted<td>Parâmetros<td>True para remover a flag "deleted" na mensagem</table>
<p>Note-se que os valores falsos são ignorados.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-13>Exemplo<a href=#exemplo-13 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Criar transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Selecionar mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Marcar todas as mensagens de INBOX como invisíveis</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.removeFlags(IMAP all;$flags)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=renamebox>.renameBox()<a href=#renamebox class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>19<td>Adicionado</table>
</div></div></details>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>currentName<td>Text<td style=text-align:center>-><td>Nome da caixa de correio actual<tr><td>newName<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de renomeamento</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-25>Descrição<a href=#descrição-25 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.renameBox()</code> muda o nome de uma caixa de correio no servidor IMAP. Tentar mudar o nome de uma caixa de correio de um nome de caixa de correio que não existe ou para um nome de caixa de correio que já existe irá gerar um erro.</p>
<p>No parâmetro <code>currentName</code>, passar o nome da caixa de correio para renommer.</p>
<p>Passar o novo nome para a caixa de correio no parâmetro <code>newName</code>.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-14>Exemplo<a href=#exemplo-14 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para renomear a sua caixa de correio "Invoices" para "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $server,$boxInfo,$result : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //cria transporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleciona mailbox</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  If($boxInfo.mailCount>0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // recupera cabeçalhos das últimas 20 mensagens sem marcá-las como lidas</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class=token-line style=color:#393A34><span class="token plain">     New object("withBody";False;"updateSeen";False))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    For each($mail;$result.list)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    // ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=port>.port<a href=#port class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.port</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-26>Descrição<a href=#descrição-26 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.port</code> contém  o número do porto utilizado para as transações postais. Por padrão, se a propriedade <em>port</em> não tiver sido definida no objeto <em>server</em> (utilizado para criar o objecto transportador com <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), a porta utilizada é:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=searchmails>.searchMails()<a href=#searchmails class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R5<td>Adicionado</table>
</div></div></details>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>searchCriteria<td>Text<td style=text-align:center>-><td>Critérios de pesquisa<tr><td>Resultados<td>Collection<td style=text-align:center>&lt;-<td>Coleção de números de mensagens</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-27>Descrição<a href=#descrição-27 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<blockquote>
<p>Esta função é baseada na especificação do <a href=https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol target=_blank rel="noopener noreferrer">protocolo IMAP</a>.</p>
</blockquote>
<p>A função <code>.searchMails()</code> procura por mensagens que correspondam ao dado <em>searchCriteria</em> na caixa de correio actual. <em>searchCriteria</em> consiste em uma ou mais chaves de pesquisa.</p>
<p><em>searchCriteria</em> é um parâmetro de texto que lista uma ou mais chaves de pesquisa (ver <a href=#authorized-search-keys>Chaves de pesquisa autorizadas</a> abaixo) associadas ou não a valores a procurar. Uma chave de pesquisa pode ser um único ou vários itens. Por exemplo:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">SearchKey1 = FLAGGED SearchKey2 = NOT FLAGGED SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre></div></div>
<blockquote>
<p>A correspondência não é normalmente sensível a maiúsculas e minúsculas</p>
</blockquote>
<ul>
<li>Se a <em>searchCriteria</em> for uma cadeia nula, a pesquisa será equivalente a uma "seleccionar tudo".</li>
<li>Se a <em>searchCriteria</em> inclui múltiplas chaves de pesquisa, o resultado é a intersecção (E função) de todas as mensagens que correspondem a essas chaves.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = FLAGGED FROM "SMITH"</span><br></span></code></pre></div></div>
<p>... retorna todas as mensagens com o sinalizador \Flagged definido e enviadas por Smith.</p>
<ul>
<li>Pode utilizar os operadores <strong>OR</strong> ou <strong>NOT</strong> como se segue:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre></div></div>
<p>... retorna todas as mensagens com o sinalizador \Seen definido OU com o sinalizador \Flagged definido</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre></div></div>
<p>... retorna todas as mensagens com o sinalizador \Seen não definido.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...</span><br></span></code></pre></div></div>
<p>... devolve mensagem cujo cabeçalho de tipo de conteúdo contém "Mixed" e não contém "Text".</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"</span><br></span></code></pre></div></div>
<p>... retorna mensagem cujo cabeçalho do tipo de conteúdo contém " e " e cujo cabeçalho do tipo de conteúdo não contém " o " e cujo cabeçalho do tipo de conteúdo não é " Mixed ".</p>
<p>No que diz respeito aos dois últimos exemplos, note que o resultado da pesquisa é diferente quando se remove os parênteses da primeira lista de chaves de pesquisa.</p>
<ul>
<li>A <em>searchCriteria</em> pode incluir a especificação opcional [CHARSET] . Esta consiste na palavra "CHARSET" seguida de uma palavra registada [CHARSET] (US ASCII, ISO-8859). Indica o charset da string <em>searchCriteria</em> . Portanto, deve converter a string <em>searchCriteria</em> no charset especificado se utilizar a especificação [CHARSET] (ver os comandos <code>CONVERT FROM TEXT</code> ou <code>Convert to text</code>). Como padrão, os códigos 4D em Quotable Printable the searchCriteria string se conter caracteres estendidos</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = CHARSET "ISO-8859" BODY "Help"</span><br></span></code></pre></div></div>
<p>... significa que o critério de pesquisa utiliza o iso-8859 charset e o servidor terá de converter o critério de pesquisa antes de efectuar a pesquisa, se necessário.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=tipos-de-valores-de-pesquisa>Tipos de valores de pesquisa<a href=#tipos-de-valores-de-pesquisa class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>As chaves de pesquisa podem solicitar o valor a pesquisar:</p>
<ul>
<li>
<p><strong>Chaves de pesquisa com um valor de data</strong>: a data é uma string que deve ser formatada da seguinte forma: <em>date-day+"-"+date-month+"-"+dateyear</em> onde data-dia indica o número do dia do mês (máx. 2 caracteres), data-mês indica o nome do mês (Jan/Fev/Mar/Abr/Abr/May/Jun/Jul/Aug/Sep/Oct/Dec) e data-ano indica o ano (4 caracteres). Exemplo: <code>searchCriteria = SENTBEFORE 1-Fev-2020</code> (uma data não precisa normalmente de ser citada uma vez que não contém quaisquer caracteres especiais)</p>
</li>
<li>
<p><strong>Chaves de pesquisa com um valor de cadeia</strong>: a cadeia pode conter qualquer carácter e deve ser citada. Se a string não conter quaisquer caracteres especiais, como o carácter espacial, por exemplo, não precisa de ser citada. A citação de tais strings assegurará que o seu valor de strings será interpretado correctamente. Exemplo: <code>searchCriteria = FROM "SMITH"</code> Para todas as chaves de pesquisa que utilizam strings uma mensagem corresponde à chave se a corda for uma substring do campo. A correspondência não é sensível a maiúsculas e minúsculas.</p>
</li>
<li>
<p><strong>Pesquisa-chaves com um valor de nome de campo</strong>: o nome de campo é o nome de um campo de cabeçalho. Exemplo: <code>searchCriteria = HEADER CONTENT-TYPE "MISTURADO"</code></p>
</li>
<li>
<p><strong>Chaves de pesquisa com um valor de marcador</strong>: o valor pode aceitar uma ou várias palavras-chave (incluindo marcadores padrão), separadas por espaços. Exemplo: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p>
</li>
<li>
<p><strong>Pesquisa-chaves com um valor de conjunto de mensagens</strong>: Identifica um conjunto de mensagens. Para números de sequência de mensagens, estes são números consecutivos de 1 até ao número total de mensagens na caixa de correio. Uma vírgula delimita números individuais; uma vírgula delimita entre dois números, inclusive. Exemplos: <code>2,4:7,9,12:*</code> é <code>2,4,5,6,7,9,12,13,14,15</code> para uma caixa de correio com 15 mensagens. <code>searchCriteria = 1:5 RESPOSTA</code> pesquisa na selecção de mensagens a partir da sequência de mensagens número 1 a 5 para mensagens que tenham o marcador \i1 <code>searchCriteria= 2,4 RESPOSTA</code> pesquisa na selecção de mensagens (mensagens números 2 e 4) por mensagens que tenham o marcador \i1 <code>searchCriteria= 2,4 ANSWERED</code> pesquisa na selecção de mensagens (mensagens números 2 e 4) por mensagens que tenham o marcador \Answered.</p>
</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=chaves-de-pesquisa-autorizadas>Chaves de pesquisa autorizadas<a href=#chaves-de-pesquisa-autorizadas class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p><strong>ALL</strong>: Todas as mensagens em mailbox.<br>
<strong>ANSWERED</strong>: Mensagens com marcador \Answered .<br>
<strong>UNANSWERED</strong>: Mensagens sem o marcador \Answered.<br>
<strong>DELETED</strong>: Mensagens com marcador \Deleted.<br>
<strong>UNDELETED</strong>: Mensagens com o marcador \Deleted .<br>
<strong>DRAFT</strong>: Mensagens com o marcador \Draft.<br>
<strong>UNDRAFT</strong>: Mensagens sem o marcador \Draft.<br>
<strong>FLAGGED</strong>: Mensagens com o marcador \Flagged.<br>
<strong>UNFLAGGED</strong>:Mensagens sem o marcador \Flagged .<br>
<strong>RECENT</strong>: Mensagens com o marcador \Recent.<br>
<strong>OLD</strong>: Mensagens sem o marcador \Recent .<br>
<strong>SEEN</strong>: Mensagens com o marcador \Seen.<br>
<strong>UNSEEN</strong>: Mensagens sem o marcador \Seen.<br>
<strong>NEW</strong>: Mensagens com o marcador \Recent mas não o marcador \Seen. Isto é funcionalmente equivalente a "(RECENTEMENTE UNSEENTE)".<br>
<em><strong>KEYWORD <em><strong>flag</strong></em></strong></em>: Mensagens com o conjunto de palavras-chave especificado.<br>
<em><strong>UNKEYWORD <em><strong>flag</strong></em></strong></em>: Mensagens que não têm a palavra-chave especificada.<br>
***ANTES da data *********: Mensagens cuja data interna é anterior à data especificada.<br>
***ANTES da data *********: Mensagens cuja data interna está dentro da data especificada.<br>
<em><strong>DESDE <em><strong>data</strong></em></strong></em>: Mensagens cuja data interna se encontra dentro ou fora da data especificada.<br>
<em><strong>SENTBEFORE <em><strong>data</strong></em></strong></em>: Mensagens cujo cabeçalho da data é anterior à data especificada.<br>
<em><strong>SENTON <em><strong>data</strong></em></strong></em>: Mensagens cujo cabeçalho da Data se encontra dentro da data especificada.<br>
<em><strong>SENTSINCE <em><strong>data</strong></em></strong></em>: Mensagens cujo cabeçalho da Data está dentro ou mais tarde do que a data especificada.<br>
<em><strong>TO <em><strong>string</strong></em></strong></em>: Mensagens que contêm a string especificada no cabeçalho da TO.<br>
<em><strong>DE <em><strong>string</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no cabeçalho DE.<br>
<em><strong>CC <em><strong>string</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no cabeçalho CC.<br>
<em><strong>BCC <em><strong>string</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no cabeçalho BCC.<br>
<em><strong>SUBJECT <em><strong>string</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no cabeçalho do Subject.<br>
<em><strong>BODY <em><strong>string</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no corpo da mensagem.<br>
<em><strong>TEXTO <em><strong>cadeia de caracteres</strong></em></strong></em>: Mensagens que contêm a cadeia de caracteres especificada no cabeçalho ou no corpo da mensagem.<br>
<em><strong>HEADER <em>nome de campo</em> <em><strong>corda</strong></em></strong></em>: Mensagens que têm um cabeçalho com o nome de campo especificado e que contêm a corda especificada no corpo do campo.<br>
<em><strong>UID <em><strong>message-UID</strong></em></strong></em>: Mensagens com identificadores únicos correspondentes ao conjunto de identificadores únicos especificado.<br>
<em><strong>LARGER <em><strong>n</strong></em></strong></em>: Mensagens com um tamanho maior do que o número de bytes especificado.<br>
<em><strong>SMALLER <em><strong>n</strong></em></strong></em>: Mensagens com um tamanho menor do que o número especificado de bytes.<br>
<em><strong>NOT <em><strong>search-key</strong></em></strong></em>: Mensagens que não correspondem à chave de pesquisa especificada.<br>
<em><strong>OU <em>search-key1</em> <em><strong>search-key2</strong></em></strong></em>: Mensagens que correspondem a qualquer uma das chaves de pesquisa.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=selectbox>.selectBox()<a href=#selectbox class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>18 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>





























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>state<td>Integer<td style=text-align:center>-><td>Estado de acesso à caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>objecto boxInfo</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-28>Descrição<a href=#descrição-28 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>selecciona a caixa de correio <em>name</em> como a caixa de correio actual A função <code>.selectBox()</code>. Essa função permite que recupere informação sobre o mailbox.</p>
<blockquote>
<p>Para obter as informações de uma caixa de correio sem alterar a caixa de correio actual, utilize <a href=#getboxinfo><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>No parâmetro <em>name</em>, passar o nome da caixa de correio para aceder. O nome representa uma hierarquia inequívoca da esquerda para a direita com níveis separados por um carácter delimitador específico. O delimitador pode ser encontrado com a função <a href=#getdelimiter><code>.getDelimiter()</code></a> .</p>
<p>O parâmetro opcional <em>state</em> define o tipo de acesso à caixa de correio. Os valores possíveis são:</p>




















<table><thead><tr><th>Parâmetros<th>Valor<th>Comentário<tbody><tr><td>IMAP read only state<td>1<td>A caixa de correio seleccionada é acedida com privilégios apenas de leitura. As mensagens com uma flag "recente" (indicando novas mensagens) permanecem inalteradas.<tr><td>IMAP read write state<td>0<td>A caixa de correio seleccionada é acedida com privilégios de leitura e escrita. As mensagens são consideradas "vistas" e perdem o marcador "recente" (indicando novas mensagens). (Valor padrão)</table>
<blockquote>
<ul>
<li>A função gera um erro e devolve <strong>Null</strong> se <em>name</em> designar uma caixa de correio inexistente.</li>
<li>Se não houver uma conexão aberta, <code>.selectBox()</code> irá abrir uma conexão.</li>
<li>Se a conexão não tiver sido utilizada desde o atraso da ligação determinado (ver <code>IMAP New transpor ter</code>), a função <a href=#checkconnection><code>.checkConnection()</code></a> é automaticamente chamada.</li>
</ul>
</blockquote>
<p><strong>Objeto devolvido</strong></p>
<p>O objeto <code>boxInfo</code> retornado contém as funcionalidades abaixo:</p>

























<table><thead><tr><th>Propriedade<th>Tipo<th>Descrição<tbody><tr><td>name<td>Text<td>Nome da nova caixa de correio<tr><td>mailCount<td>number<td>Número de mensagens na caixa de email<tr><td>mailRecent<td>number<td>Número de mensagens com a flag "recent"</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-15>Exemplo<a href=#exemplo-15 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obrigatório</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=subscribe>.subscribe()<a href=#subscribe class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>19<td>Adicionado</table>
</div></div></details>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação de subscrição</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-29>Descrição<a href=#descrição-29 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.subscribe()</code> permite adicionar ou remover a caixa de correio especificada de/para o conjunto de caixas de correio "subscritas" do servidor IMAP. Como tal, pode optar por restringir uma grande lista de caixas de correio disponíveis, subscrevendo as que normalmente deseja ver.</p>
<p>No parâmetro <code>name</code> , passe o nome da caixa de correio para adicionar (subscrever) às suas caixas de correio "subscritas".</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-16>Exemplo<a href=#exemplo-16 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para subscrever a caixa de correio "Atlas Corp" na hierarquia "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox subscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=unsubscribe>.unsubscribe()<a href=#unsubscribe class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>19<td>Adicionado</table>
</div></div></details>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parâmetro<th>Tipo<th style=text-align:center><th>Descrição<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nome da nova caixa de correio<tr><td>Resultados<td>Object<td style=text-align:center>&lt;-<td>Estado da operação unsubscribe</table>
<p>|</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-30>Descrição<a href=#descrição-30 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A função <code>.unsubscribe()</code> remove uma caixa de correio de um conjunto de caixas de correio subscritas. Isto permite reduzir o número de caixas de correio que normalmente se vêem.</p>
<p>No parâmetro <code>name</code> , passe o nome da caixa de correio para remover (cancelar a subscrição) das suas caixas de correio activas.</p>
<p><strong>Objeto devolvido</strong></p>
<p>A função devolve um objecto que descreve o estado IMAP:</p>















































<table><thead><tr><th>Propriedade<th><th>Tipo<th>Descrição<tbody><tr><td>success<td><td>Parâmetros<td>True se a operação for bem sucedida, False caso contrário<tr><td>statusText<td><td>Text<td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D<tr><td>errors<td><td>Collection<td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de erro 4D<tr><td><td>[].message<td>Text<td>Descrição do erro 4D<tr><td><td>[].componentSignature<td>Text<td>Assinatura da componente interna que devolveu o erro</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=exemplo-17>Exemplo<a href=#exemplo-17 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>Para cancelar a subscrição da caixa de correio "Atlas Corp" na hierarquia "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:") If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// renomear caixa de correio</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.renameBox("Invoices"; "Bills") If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox renaming successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=user>.user<a href=#user class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Histórico</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Release<th>Mudanças<tbody><tr><td>17 R4<td>Adicionado</table>
</div></div></details>
<p><strong>.user</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descrição-31>Descrição<a href=#descrição-31 class=hash-link aria-label="Link direto para o cabeçalho" title="Link direto para o cabeçalho">​</a></h4>
<p>A propriedade <code>.user</code> contém  o nome de usuário utilizado para autenticação no servidor de correio.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(19)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Comentar esta página</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Navegação nas páginas dos documentos"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/pt/19/API/FunctionClass><div class=pagination-nav__sublabel>Anterior</div><div class=pagination-nav__label>Function</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/pt/19/API/MailAttachmentClass><div class=pagination-nav__sublabel>Próximo</div><div class=pagination-nav__label>MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#objecto-imap-transporter class="table-of-contents__link toc-highlight">Objecto IMAP Transporter</a><li><a href=#imap-new-transporter class="table-of-contents__link toc-highlight">IMAP New transporter</a><li><a href=#4dimaptransporternew class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a><li><a href=#acceptunsecureconnection class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a><li><a href=#addflags class="table-of-contents__link toc-highlight">.addFlags()</a><li><a href=#append class="table-of-contents__link toc-highlight">.append()</a><li><a href=#authenticationmode class="table-of-contents__link toc-highlight">.authenticationMode</a><li><a href=#checkconnection class="table-of-contents__link toc-highlight">.checkConnection()</a><li><a href=#checkconnectiondelay class="table-of-contents__link toc-highlight">.checkConnectionDelay</a><li><a href=#connectiontimeout class="table-of-contents__link toc-highlight">.connectionTimeOut</a><li><a href=#copy class="table-of-contents__link toc-highlight">.copy()</a><li><a href=#createbox class="table-of-contents__link toc-highlight">.createBox()</a><li><a href=#delete class="table-of-contents__link toc-highlight">.delete()</a><li><a href=#deletebox class="table-of-contents__link toc-highlight">.deleteBox()</a><li><a href=#expunge class="table-of-contents__link toc-highlight">.expunge()</a><li><a href=#getboxinfo class="table-of-contents__link toc-highlight">.getBoxInfo()</a><li><a href=#getboxlist class="table-of-contents__link toc-highlight">.getBoxList()</a><li><a href=#getdelimiter class="table-of-contents__link toc-highlight">.getDelimiter()</a><li><a href=#getmail class="table-of-contents__link toc-highlight">.getMail()</a><li><a href=#getmails class="table-of-contents__link toc-highlight">.getMails()</a><li><a href=#getmimeasblob class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a><li><a href=#host class="table-of-contents__link toc-highlight">.host</a><li><a href=#logfile class="table-of-contents__link toc-highlight">.logFile</a><li><a href=#move class="table-of-contents__link toc-highlight">.move()</a><li><a href=#numtoid class="table-of-contents__link toc-highlight">.numToID()</a><li><a href=#removeflags class="table-of-contents__link toc-highlight">.removeFlags()</a><li><a href=#renamebox class="table-of-contents__link toc-highlight">.renameBox()</a><li><a href=#port class="table-of-contents__link toc-highlight">.port</a><li><a href=#searchmails class="table-of-contents__link toc-highlight">.searchMails()</a><li><a href=#selectbox class="table-of-contents__link toc-highlight">.selectBox()</a><li><a href=#subscribe class="table-of-contents__link toc-highlight">.subscribe()</a><li><a href=#unsubscribe class="table-of-contents__link toc-highlight">.unsubscribe()</a><li><a href=#user class="table-of-contents__link toc-highlight">.user</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Comunidade</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://x.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>X</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Suporte</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/4d/docs/releases/tag/latest target=_blank rel="noopener noreferrer" class=footer__link-item>Documentation download<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (Onde tudo começou)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Base de conhecimento</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>Baixares</a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources</a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>Obter suporte</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Empresa</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>Sobre 4D</a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>Contactar-nos</a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>4D no mundo</a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Careers</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>© 2025 4D SAS - Todos os direitos reservados</div></div></div></footer></div>