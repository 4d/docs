<!doctype html>
<html lang="pt" dir="ltr" class="docs-wrapper docs-doc-page docs-version-19-R8 plugin-docs plugin-id-default docs-doc-id-API/IMAPTransporterClass">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">IMAPTransporter | 4D Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://4d.github.io//docs/pt/API/IMAPTransporterClass"><meta data-rh="true" name="docusaurus_locale" content="pt"><meta data-rh="true" name="docsearch:language" content="pt"><meta data-rh="true" name="docusaurus_version" content="19-R8"><meta data-rh="true" name="docusaurus_tag" content="docs-default-19-R8"><meta data-rh="true" name="docsearch:version" content="19-R8"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-19-R8"><meta data-rh="true" property="og:title" content="IMAPTransporter | 4D Docs"><meta data-rh="true" name="description" content="A classe IMAPTransporter permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP."><meta data-rh="true" property="og:description" content="A classe IMAPTransporter permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP."><link data-rh="true" rel="icon" href="/docs/pt/img/favicon/4d.gif"><link data-rh="true" rel="canonical" href="https://4d.github.io//docs/pt/API/IMAPTransporterClass"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/API/IMAPTransporterClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/fr/API/IMAPTransporterClass" hreflang="fr"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/es/API/IMAPTransporterClass" hreflang="es"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/ja/API/IMAPTransporterClass" hreflang="ja"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/pt/API/IMAPTransporterClass" hreflang="pt"><link data-rh="true" rel="alternate" href="https://4d.github.io//docs/API/IMAPTransporterClass" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJ04C0M3CU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="4D Docs" href="/docs/pt/opensearch.xml"><link rel="stylesheet" href="/docs/pt/assets/css/styles.c92a4f00.css">
<link rel="preload" href="/docs/pt/assets/js/runtime~main.84ff404e.js" as="script">
<link rel="preload" href="/docs/pt/assets/js/main.6498f955.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/pt/"><div class="navbar__logo"><img src="/docs/pt/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/pt/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/pt/GettingStarted/installation">v19 R8 BETA</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/pt/API/IMAPTransporterClass">v19 R8 BETA</a></li><li><a class="dropdown__link" href="/docs/pt/19-R7/API/IMAPTransporterClass">v19 R7</a></li><li><a class="dropdown__link" href="/docs/pt/19/API/IMAPTransporterClass">v19</a></li><li><a class="dropdown__link" href="/docs/pt/18/GettingStarted/installation">v18</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Português</a><ul class="dropdown__menu"><li><a href="/docs/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/fr/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/docs/es/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs/ja/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/docs/pt/API/IMAPTransporterClass" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="pt">Português</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Pesquisa"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Pesquisa</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/docs/pt/"><img src="/docs/pt/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/pt/img/logohome.png" alt="4D Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>4D Documentation</b></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pt/GettingStarted/installation">Começando</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/pt/Project/overview">Core Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/Project/overview">Project Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/Concepts/about">4D Language Concepts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://doc.4d.com/4Dv19R7/4D/19-R7/4D-Language-Reference.100-5944528.en.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">4D Language Reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/ORDA/overview">ORDA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/pt/API/overview">Class API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/overview">Funções de classe e comandos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/BlobClass">Blob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/ClassClass">Class</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/CollectionClass">Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/DataClassAttributeClass">DataClassAttribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/EntityClass">Entity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/FileHandleClass">FileHandle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/FunctionClass">Formula</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/HTTPRequestClass">HTTPRequest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pt/API/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/POP3TransporterClass">POP3Transporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/SMTPTransporterClass">SMTPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/SystemWorkerClass">SystemWorker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pt/API/ZipFolderClass">ZIPFolder</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/code-editor/overview">Handling Code</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/Debugging/basics">Depuração</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/settings/overview">Settings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/pt/Preferences/overview">Preferências</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pt/ServerWindow/overview">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pt/Extensions/overview">Extensions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pt/WebServer/overview">Web Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/pt/Desktop/clientServer">Desktop Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://developer.4d.com/go-mobile/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Mobile Applications</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/pt/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Class API Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">IMAPTransporter</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v19 R8 BETA</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>A classe <code>IMAPTransporter</code> permite-lhe recuperar mensagens a partir de um servidor de correio electrónico IMAP.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="objecto-do-imap-transporter">Objecto do IMAP Transporter<a class="hash-link" href="#objecto-do-imap-transporter" title="Direct link to heading">​</a></h3><p>Os objectos do IMAP Transporter são instanciados com o comando <a href="#imap-new-transporter">IMAP New Transportter</a> . Eles oferecem as propriedades abaixo e funções:</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a> <!-- --> <!-- --> <!-- --> <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada</td></tr><tr><td><a href="#addflags"><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->adiciona flags ao <code>msgIDs</code> para as palavras-chave especificadas ``</td></tr><tr><td><a href="#append"><strong>.append</strong>( <em>mailObj</em> : Objecto ; <em>destinationBox</em> : Texto ; <em>opções</em> : Objecto ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->anexa um  <code>mailObj</code> ao <code>destinationBox</code></td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o modo de autenticação utilizado para abrir a sessão no servidor de correio</td></tr><tr><td><a href="#checkconnection"><strong>.checkConnection()</strong> : Object</a> <!-- --> <!-- --> <!-- --> <!-- --> verifica a ligação utilizando a informação armazenada no objeto de transporte</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->o tempo máximo de espera (em segundos) permitido para estabelecer uma conexão com o servidor</td></tr><tr><td><a href="#copy"><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->copia as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a Caixa de destino ** no servidor IMAP</td></tr><tr><td><a href="#createbox"><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->cria uma caixa de correio com o  <code>nome</code>dado</td></tr><tr><td><a href="#delete"><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->define o marcador &quot;apagado&quot; para as mensagens definidas em <code>msgsIDs</code> ou <code>allMsgs</code></td></tr><tr><td><a href="#deletebox"><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->remove permanentemente a caixa de correio com o nome <code>dado</code> do servidor IMAP</td></tr><tr><td><a href="#expunge"><strong>.expunge()</strong> : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->remove todas as mensagens com o marcador &quot;apagada&quot; do servidor de correio IMAP.</td></tr><tr><td><a href="#getboxinfo"><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->devolve um objeto <code>boxInfo</code> correspondente à maibox actual, ou a caixa de correio <em>nome</em></td></tr><tr><td><a href="#getboxlist"><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->devolve uma colecção de caixas de correio descrevendo todas as caixas de correio disponíveis</td></tr><tr><td><a href="#getdelimiter"><strong>.getDelimiter()</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->devolve o carácter utilizado para delimitar os níveis de hierarquia no nome da caixa de correio</td></tr><tr><td><a href="#getmail"><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#getmails"><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->returns an object containing a collection of <code>Email</code> objects</td></tr><tr><td><a href="#getmimeasblob"><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code></td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o nome ou o endereço IP do servidor anfitrião</td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio</td></tr><tr><td><a href="#move"><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server</td></tr><tr><td><a href="#numtoid"><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em></td></tr><tr><td><a href="#removeflags"><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->removes flags from the <code>msgIDs</code> for the specified <code>keywords</code></td></tr><tr><td><a href="#renamebox"><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->changes the name of a mailbox on the IMAP server</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- --> o número do porto utilizado para as transações postais</td></tr><tr><td><a href="#searchmails"><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a> <!-- --> <!-- --> <!-- --> <!-- -->searches for messages that match the given <em>searchCriteria</em> in the current mailbox</td></tr><tr><td><a href="#selectbox"><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->selects the <em>name</em> mailbox as the current mailbox</td></tr><tr><td><a href="#subscribe"><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes</td></tr><tr><td><a href="#unsubscribe"><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a> <!-- --> <!-- --> <!-- --> <!-- -->removes a mailbox from a set of subscribed mailboxes</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- --> o nome de usuário utilizado para autenticação no servidor de correio</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="imap-new-transporter">IMAP New transporter<a class="hash-link" href="#imap-new-transporter" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>server</td><td>Objeto</td><td align="center">-&gt;</td><td>Informação de servidor de correio</td></tr><tr><td>Resultados</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">Objecto de transporte IMAP</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição">Descrição<a class="hash-link" href="#descrição" title="Direct link to heading">​</a></h4><p>O comando <code>IMAP Novo transportador</code> configura uma nova ligação IMAP de acordo com o parâmetro <em>server</em> e devolve um novo objecto <em>transporter</em>. O objeto transporter retornado vai geralmente ser usado para receber emails.</p><p>No parâmetro <em>server</em>, passe um objeto contendo as propriedades abaixo:</p><table><thead><tr><th><em>server</em></th><th>Valor padrão (se omitido)</th></tr></thead><tbody><tr><td><a href="#acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong> : Boolean</a> <!-- --> <!-- --> <!-- --> <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada</td><td>False</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Texto<br>.<strong>accessTokenOAuth2</strong>: Objecto<br>Cadeia de texto ou objecto simbólico representando as credenciais de autorização do OAuth2. Usado apenas com OAUTH2 <code>authenticationMode</code>. Se <code>accessTokenOAuth2</code> for utilizado mas <code>authenticationMode</code> for omitido, é utilizado o protocolo OAuth 2 (se permitido pelo servidor). Não devolvido em <em><a href="#imap-transporter-object">IMAP transporter</a></em> objecto.</td><td>nenhum</td></tr><tr><td><a href="#authenticationmode"><strong>.authenticationMode</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o modo de autenticação utilizado para abrir a sessão no servidor de correio</td><td>o modo de autenticação mais seguro disponível no servidor é usado</td></tr><tr><td><a href="#checkconnectiondelay"><strong>.checkConnectionDelay</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor</td><td>300</td></tr><tr><td><a href="#connectiontimeout"><strong>.connectionTimeOut</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- -->o tempo máximo de espera (em segundos) permitido para estabelecer uma conexão com o servidor</td><td>30</td></tr><tr><td><a href="#host"><strong>.host</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o nome ou o endereço IP do servidor anfitrião</td><td><em>obrigatório</em></td></tr><tr><td><a href="#logfile"><strong>.logFile</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- -->o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio</td><td>nenhum</td></tr><tr><td>.<strong>password</strong> : Texto<br>senha de usuário para autenticação no servidor. Não devolvido em <em><a href="#imap-transporter-object">IMAP transporter</a></em> objecto.</td><td>nenhum</td></tr><tr><td><a href="#port"><strong>.port</strong> : Integer</a> <!-- --> <!-- --> <!-- --> <!-- --> o número do porto utilizado para as transações postais</td><td>993</td></tr><tr><td><a href="#user"><strong>.user</strong> : Text</a> <!-- --> <!-- --> <!-- --> <!-- --> o nome de usuário utilizado para autenticação no servidor de correio</td><td>nenhum</td></tr></tbody></table><blockquote><p><strong>Aviso</strong>: Certifique-se de que o tempo limite definido é inferior ao tempo limite do servidor, caso contrário, o tempo limite do cliente será inútil.</p></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados">Resultados<a class="hash-link" href="#resultados" title="Direct link to heading">​</a></h4><p>A função devolve um  <a href="#imap-transporter-object"><strong>objecto de transporte do IMAP</strong></a>. Todas as propriedades retornadas são <strong>apenas leitura</strong>.</p><blockquote><p>A ligação IMAP é automaticamente fechada quando o objecto transportador é destruído.</p></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo">Exemplo<a class="hash-link" href="#exemplo" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.host:=&quot;imap.gmail.com&quot; //Obrigatório</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$server.logFile:=&quot;LogTest.txt&quot; //log para salvar na pasta Logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(Not($status.success))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;An error occurred: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4dimaptransporternew">4D.IMAPTransporter.new()<a class="hash-link" href="#4dimaptransporternew" title="Direct link to heading">​</a></h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>server</td><td>Objeto</td><td align="center">-&gt;</td><td>Informação de servidor de correio</td></tr><tr><td>Resultados</td><td>4D.IMAPTransporter</td><td align="center">&lt;-</td><td><a href="#imap-transporter-object">Objecto de transporte IMAP</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-1">Descrição<a class="hash-link" href="#descrição-1" title="Direct link to heading">​</a></h4><p>A função <code>4D.IMAPTransporter.new()</code> cria e devolve um novo objecto do tipo <code>4D.IMAPTransporter</code>. É idêntico ao comando <a href="#imap-new-transporter"><code>IMAP Novo Transportador</code></a> (atalho).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="acceptunsecureconnection">.acceptUnsecureConnection<a class="hash-link" href="#acceptunsecureconnection" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-2">Descrição<a class="hash-link" href="#descrição-2" title="Direct link to heading">​</a></h4><p>A propriedade <code>.acceptUnsecureConnection</code> contém <strong>Verdadeiro</strong> se 4D for permitido estabelecer uma ligação não encriptada quando a ligação encriptada não é possível.</p><p>Contém <strong>False</strong> se conexões cifradas não forem permitidas, neste caso um erro é retornado quando a conexão criptografada não for possível.</p><p>Estão disponíveis portos seguros:</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 ou 25: SMTP com atualização STARTTLS se for compat[ivel com o servidor.</li></ul></li><li><p>IMAP</p><ul><li>143: IMAP non-encrypted port</li><li>993: IMAP com atualização STARTTLS se for compatível com o servidor</li></ul></li><li><p>POP3</p><ul><li>110: Porta não criptografada POP3</li><li>995: POP3 com atualização STARTTLS se suportado pelo servidor.</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="addflags">.addFlags()<a class="hash-link" href="#addflags" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R6</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Coleção de strings: IDs únicos de mensagens (texto)<br>Texto: ID único de uma mensagem<br>Longint (todos IMAP): Todas as mensagens na caixa de correio seleccionada</td></tr><tr><td>keywords</td><td>Objeto</td><td align="center">-&gt;</td><td>Flags de palavras chaves a adicionar</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação addFlags</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-3">Descrição<a class="hash-link" href="#descrição-3" title="Direct link to heading">​</a></h4><p>A função <code>.addFlags()</code> adiciona flags ao <code>msgIDs</code> para as palavras-chave especificadas ``.</p><p>No parâmetro <code>msgIDs</code> , pode passar qualquer um dos dois:</p><ul><li><p>uma colecção ** contendo as identificações únicas de mensagens específicas ou</p></li><li><p>o ID único (<em>texto</em>) de uma mensagem ou</p></li><li><p>a seguinte constante (<em>longint</em>) para todas as mensagens na caixa de correio seleccionada:</p><table><thead><tr><th>Constante</th><th>Value</th><th>Comentário</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Seleccione todas as mensagens na caixa de correio seleccionada</td></tr></tbody></table></li></ul><p>O parâmetro <code>palavras-chave</code> permite-lhe passar um objecto com valores de palavras-chave para bandeiras específicas a acrescentar a <code>msgIDs</code>. Pode passar qualquer uma das seguintes palavras-chave:</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>$draft</td><td>Booleano</td><td>True para adicionar o marcador &quot;draft&quot; na mensagem</td></tr><tr><td>$seen</td><td>Booleano</td><td>True para adicionar o marcador &quot;seen&quot; na mensagem</td></tr><tr><td>$flagged</td><td>Booleano</td><td>True para adicionar o marcador &quot;flagged&quot; na mensagem</td></tr><tr><td>$answered</td><td>Booleano</td><td>True para adicionar o marcador &quot;answered&quot; na mensagem</td></tr><tr><td>$deleted</td><td>Booleano</td><td>True para adicionar o marcador &quot;deleted&quot; na mensagem</td></tr></tbody></table><blockquote><ul><li>Os falsos valores são ignorados.</li><li>A interpretação dos marcadores de palavras-chave pode variar por cliente de correio.</li></ul></blockquote><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-1">Exemplo<a class="hash-link" href="#exemplo-1" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Criar transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Selecionar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Marcar todas as mensagens de INBOX como lidas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags[&quot;$seen&quot;]:=True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="append">.append()<a class="hash-link" href="#append" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R6</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.append</strong>( <em>mailObj</em> : Objecto ; <em>destinationBox</em> : Texto ; <em>opções</em> : Objecto ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>mailObj</td><td>Objeto</td><td align="center">-&gt;</td><td>Objeto Email</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Caixa de email que vai receber o objeto Email</td></tr><tr><td>options</td><td>Objeto</td><td align="center">-&gt;</td><td>Objeto que contém informações do charset</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação anexada</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-4">Descrição<a class="hash-link" href="#descrição-4" title="Direct link to heading">​</a></h4><p>A função <code>.append()</code> anexa um  <code>mailObj</code> ao <code>destinationBox</code>.</p><p>No parâmetro <code>mailObj</code> , passe um objecto Email. In the <code>mailObj</code> parameter, pass an Email object. A função <code>.append()</code> é compatível com tags de palavras-chave no atributo <code>, palavra-chave</code> do objeto Email.</p><p>O parâmetro opcional <code>destinationBox</code> permite-lhe passar o nome de uma caixa de correio onde o <code>mailObj</code> será anexado. Se omitido, é utilizada a caixa de correio actual.</p><p>No parâmetro opcional <code>opções</code> , pode passar um objecto para definir o charset e a codificação para partes específicas do correio electrónico. Propriedades disponiveis:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset e codificação usados para as seguintes partes do e-mail: assunto, nomes de arquivos de anexo e atributos de nome de e-mail. Possíveis valores: Ver tabela de possíveis cartas abaixo</td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset e codificação usados para o conteúdo html e corpo do e-mail. Possíveis valores: Ver tabela de possíveis cartas abaixo</td></tr></tbody></table><p>Charsets possíveis:</p><table><thead><tr><th>Constante</th><th>Value</th><th>Comentário</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII se possível, japonês (ISO-2022-JP) &amp; impressora, se possível, caso contrário, UTF-8 &amp; Quoted-printable</li><li>bodyCharset: US-ASCII se possível, japonês (ISO-2022-JP) &amp; 7-bit se possível, caso contrário, UTF-8 &amp; Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: US-ASCII se possível, caso contrário UTF-8 &amp; Citação-printável (<strong>valor por padrão</strong>)</td></tr><tr><td>modo de correio UTF8 na base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: US-ASCII se possível, senão UTF-8 &amp; base64</td></tr></tbody></table><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-2">Exemplo<a class="hash-link" href="#exemplo-2" title="Direct link to heading">​</a></h4><p>Para guardar um e-mail na caixa de correio Drafts:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$settings:=New object(&quot;host&quot;; &quot;domain.com&quot;; &quot;user&quot;; &quot;xxxx&quot;; &quot;password&quot;; &quot;xxxx&quot;; &quot;port&quot;; 993)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.from:=&quot;xxxx@domain.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.subject:=&quot;Lorem Ipsum&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.textBody:=&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords:=Novo objecto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords[&quot;$seen&quot;]:= Verdadeiro/// assinalar a mensagem como lido</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$msg.keywords[&quot;$draft&quot;]:= Verdadeiro/// assinalar a mensagem como um rascunho</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$imap.append($msg; &quot;Rascunhos&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="authenticationmode">.authenticationMode<a class="hash-link" href="#authenticationmode" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.authenticationMode</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-5">Descrição<a class="hash-link" href="#descrição-5" title="Direct link to heading">​</a></h4><p>A propriedade <code>.authenticationMode&lt;</code> contém o modo de autenticação utilizado para abrir a sessão no servidor de correio.</p><p>Por padrão, o modo mais seguro suportado pelo servidor é usado.</p><p>Valores possíveis:</p><table><thead><tr><th>Value</th><th>Constantes</th><th>Comentário</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Autenticação usando o protocolo CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>Autenticação do login/acesso</code></td><td>Autenticação usando o protocolo LOGIN</td></tr><tr><td>OAUTH2</td><td><code>Autenticação IMAP OAUTH2</code></td><td>Autenticação usando o protocolo OAuth2</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Autenticação usando o protocolo PLAIN</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checkconnection">.checkConnection()<a class="hash-link" href="#checkconnection" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da ligação do objecto transportador</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-6">Descrição<a class="hash-link" href="#descrição-6" title="Direct link to heading">​</a></h4><p>A função <code>.checkConnection()</code>  verifica a ligação utilizando a informação armazenada no objeto de transporte, recria a ligação, se necessário, e devolve o estado. Esta função permite verificar se os valores fornecidos pelo utilizador são válidos e consistentes.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="objeto-devolvido">Objeto devolvido<a class="hash-link" href="#objeto-devolvido" title="Direct link to heading">​</a></h4><p>A função envia um pedido para o servidor de correio e devolve um objecto descrevendo o estado do correio. This object can contain the following properties:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Verdadeiro se a verificação for bem sucedida, Falso de outra forma</td></tr><tr><td>status</td><td></td><td>number</td><td>(apenas SMTP) Código de estado devolvido pelo servidor de correio (0 no caso de um problema não relacionado com o processamento de correio)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Mensagem de estado devolvida pelo servidor de correio, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor de correio)</td></tr><tr><td></td><td>[<!-- --> ].errCode</td><td>number</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- --> ].message</td><td>text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- --> ].componentSignature</td><td>text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checkconnectiondelay">.checkConnectionDelay<a class="hash-link" href="#checkconnectiondelay" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-7">Descrição<a class="hash-link" href="#descrição-7" title="Direct link to heading">​</a></h4><p>A propriedade <code>.checkConnectionDelay</code> contém o tempo máximo (em segundos) permitido antes de verificar a ligação ao servidor.  Se este tempo for excedido entre duas chamadas de método, a ligação ao servidor será verificada. Por padrão, se a propriedade não tiver sido definida no objecto <em>do servidor</em>, o valor é 300.</p><blockquote><p><strong>Aviso</strong>: Certifique-se de que o tempo limite definido é inferior ao tempo limite do servidor, caso contrário, o tempo limite do cliente será inútil.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="connectiontimeout">.connectionTimeOut<a class="hash-link" href="#connectiontimeout" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-8">Descrição<a class="hash-link" href="#descrição-8" title="Direct link to heading">​</a></h4><p>A propriedade <code>.connectionTimeOut</code> contém o tempo máximo de espera (em segundos) permitido para estabelecer uma conexão com o servidor. Por padrão, se a propriedade não tiver sido definida no objecto servidor (utilizado para criar o objecto transportador com <code>SMTP Novo transportador</code>, <code>POP3 Novo transportador</code>, ou <code>IMAP Novo transportador</code>), o valor é 30.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="copy">.copy()<a class="hash-link" href="#copy" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Coleção de identificadores únicos de mensagens (strings)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Caixa de correio para receber mensagens copiadas</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação anexada</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-9">Descrição<a class="hash-link" href="#descrição-9" title="Direct link to heading">​</a></h4><p>A função <code>.copy()</code> copia as mensagens definidas por <em>msgsIDs</em> ou <em>allMsgs</em> para a Caixa de destino ** no servidor IMAP.</p><p>Pode passar:</p><ul><li>no parâmetro <em>msgsIDs</em> , uma colecção contendo as identificações únicas das mensagens específicas a copiar, ou</li><li>no parâmetro <em>allMsgs</em> , o <code>IMAP all</code> constante (inteiro) para copiar todas as mensagens na caixa de correio seleccionada.</li></ul><p>O parâmetro <em>destinationBox</em> permite-lhe passar um valor de texto com o nome da caixa de correio onde as cópias das mensagens serão colocadas.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-1-1">Exemplo 1<a class="hash-link" href="#exemplo-1-1" title="Direct link to heading">​</a></h4><p>Para copiar uma selecção de mensagens:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obrigatório</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //selecionar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //obtém a coleção de mensagens com IDs únicos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // copia mensagens encontradas ao mailbox &quot;documents&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.copy($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-2-1">Exemplo 2<a class="hash-link" href="#exemplo-2-1" title="Direct link to heading">​</a></h4><p>Para copiar todas as mensagens na caixa de correio actual:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obrigatório</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //selecionar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // copiar todas as mensagens ao &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.copy(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="createbox">.createBox()<a class="hash-link" href="#createbox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v19</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da nova caixa de correio</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação de criação da caixa de correio</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-10">Descrição<a class="hash-link" href="#descrição-10" title="Direct link to heading">​</a></h4><p>A função <code>.createBox()</code> cria uma caixa de correio com o  <code>nome</code>dado. Se o carácter separador hierárquico do servidor IMAP aparecer noutro lugar no nome da caixa de correio, o servidor IMAP criará os nomes dos pais necessários para criar a caixa de correio em questão.</p><p>Por outras palavras, uma tentativa de criar &quot;Projectos/IMAP/Doc&quot; num servidor em que &quot;/&quot; é o carácter separador hierárquico criará:</p><ul><li>Apenas a caixa de correio &quot;Doc&quot; se &quot;Projectos&quot; &amp; &quot;IMAP&quot; já existir.</li><li>&quot;IMAP&quot; &amp; &quot;Doc&quot; caixas de correio se apenas &quot;Projectos&quot; já existirem.</li><li>&quot;Projectos&quot; &amp; &quot;IMAP&quot; &amp; &quot;Doc&quot; caixas de correio, se ainda não existirem.</li></ul><p>No parâmetro <code>nome</code> , passe o nome da nova caixa de correio.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-3">Exemplo<a class="hash-link" href="#exemplo-3" title="Direct link to heading">​</a></h4><p>Para criar uma nova caixa de correio &quot;Facturas&quot;:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $server,$boxInfo,$result : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  If($boxInfo.mailCount&gt;0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        New object(&quot;withBody&quot;;False;&quot;updateSeen&quot;;False))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For each($mail;$result.list)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End for each</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="delete">.delete()<a class="hash-link" href="#delete" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Coleção de identificadores únicos de mensagens (strings)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação apagada</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-11">Descrição<a class="hash-link" href="#descrição-11" title="Direct link to heading">​</a></h4><p>A função <code>.delete()</code> define o marcador &quot;apagado&quot; para as mensagens definidas em <code>msgsIDs</code> ou <code>allMsgs</code>.</p><p>Pode passar:</p><ul><li>no parâmetro <code>msgsIDs</code> , uma colecção contendo as identificações únicas das mensagens específicas a apagar, ou</li><li>no parâmetro <code>allMsgs</code> , o <code>IMAP all</code> constante (inteiro) para apagar todas as mensagens na caixa de correio seleccionada.</li></ul><p>A execução desta função não remove realmente as mensagens. As mensagens com a bandeira &quot;apagar&quot; ainda podem ser encontradas pela função <a href="#searchmails">.searchMails()</a> . As mensagens assinaladas são eliminadas do servidor IMAP com a função <a href="#expunge"><code>.expunge()</code></a> ou seleccionando outra caixa de correio ou quando o objecto de transporte <a href="#imap-transporter-object"></a> (criado com <a href="#imap-new-transporter">IMAP Novo transportador</a>) é destruído.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-1-2">Exemplo 1<a class="hash-link" href="#exemplo-1-2" title="Direct link to heading">​</a></h4><p>Para apagar uma selecção de mensagens:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Obrigatório</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //selecionar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //obter coleção das IDs únicas de mensagem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;Reports\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Apagar mensagens selecionadas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-2-2">Exemplo 2<a class="hash-link" href="#exemplo-2-2" title="Direct link to heading">​</a></h4><p>Para apagar todas as mensagens na caixa de correio actual:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Objecto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=Novo objecto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatório</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;$transporter&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP Novo transportador($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //seleccionar caixa de correio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:= .selectBox(&quot;Junk Email&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // apagar todas as mensagens na caixa de correio actual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete(IMAP todos)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deletebox">.deleteBox()<a class="hash-link" href="#deletebox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v19</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da caixa de correio a apagar</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação de eliminação da caixa de correio</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-12">Descrição<a class="hash-link" href="#descrição-12" title="Direct link to heading">​</a></h4><p>A função <code>.deleteBox()</code> remove permanentemente a caixa de correio com o nome <code>dado</code> do servidor IMAP. A tentativa de apagar uma INBOX ou uma caixa de correio que não existe, gerará um erro.</p><p>No parâmetro <code>name</code> , passar o nome da caixa de correio para eliminar.</p><blockquote><ul><li>A função não pode apagar uma caixa de correio que tenha caixas de correio para crianças se a caixa de correio dos pais tiver o atributo &quot;\Noselect&quot;.</li><li>Todas as mensagens na caixa de correio eliminadas serão também eliminadas.</li><li>A capacidade de apagar uma caixa de correio depende do servidor de correio.</li></ul></blockquote><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-4">Exemplo<a class="hash-link" href="#exemplo-4" title="Direct link to heading">​</a></h4><p>Para eliminar a caixa de correio filha &quot;Nova Orion Industries&quot; da hierarquia da caixa de correio &quot;Bills&quot;:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// apagar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Nova Orion Industries&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;Mailbox deletion successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expunge">.expunge()<a class="hash-link" href="#expunge" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R6</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Estado da operação de expurgo</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-13">Descrição<a class="hash-link" href="#descrição-13" title="Direct link to heading">​</a></h4><p>A função <code>.expunge()</code> remove todas as mensagens com o marcador &quot;apagada&quot; do servidor de correio IMAP. O marcador &quot;apagada&quot; pode ser definida com os métodos <a href="#delete"><code>.delete()</code></a> ou <a href="#addflags"><code>.addFlags()</code></a> .</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-5">Exemplo<a class="hash-link" href="#exemplo-5" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $ids : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Criar transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Selecionar mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Encontrar e apagar todas as mensagens vistas no INBOX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ids:=$transporter.searchMails(&quot;SEEN&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Expurga todas as mensagens marcadas como apagadas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getboxinfo">.getBoxInfo()<a class="hash-link" href="#getboxinfo" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td><em>name</em> is optional</td></tr></tbody></table><p>|v18 R4|Added|</p></div></div></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da nova caixa de correio</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-14">Descrição<a class="hash-link" href="#descrição-14" title="Direct link to heading">​</a></h4><p>A função <code>.getBoxInfo()</code> devolve um objeto <code>boxInfo</code> correspondente à maibox actual, ou a caixa de correio <em>nome</em>. Esta função devolve a mesma informação que <a href="#selectbox"><code>.selectBox()</code></a> sem alterar a caixa de correio actual.</p><p>No parâmetro opcional <em>nome</em> , passe o nome da caixa de correio para aceder. O nome representa uma hierarquia inequívoca da esquerda para a direita com níveis separados por um carácter delimitador específico. O delimitador pode ser encontrado com a função <a href="#getdelimiter"><code>.getDelimiter()</code></a> .</p><p>Se a caixa de correio <em>nome</em> não for seleccionável ou não existir, a função gera um erro e devolve <strong>null</strong>.</p><p><strong>Objeto devolvido</strong></p><p>O objeto <code>boxInfo</code> retornado contém as funcionalidades abaixo:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>text</td><td>Nome da nova caixa de correio</td></tr><tr><td>mailCount</td><td>number</td><td>Número de mensagens na caixa de email</td></tr><tr><td>mailRecent</td><td>number</td><td>Número de mensagens com o marcador &quot;recente&quot; (indicando novas mensagens)</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-6">Exemplo<a class="hash-link" href="#exemplo-6" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $info:=$transporter.getBoxInfo(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ALERT(&quot;INBOX contains &quot;+String($info.mailRecent)+&quot; recent emails.&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getboxlist">.getBoxList()<a class="hash-link" href="#getboxlist" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr><tr><td>v19</td><td>Add <code>isSubscribed</code> parameter</td></tr></tbody></table></div></div></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>parameters</td><td>Objeto</td><td align="center">-&gt;</td><td>Parâmetro objecto</td></tr><tr><td>Resultados</td><td>Collection</td><td align="center">&lt;-</td><td>Coleção de objetos da caixa de correio</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-15">Descrição<a class="hash-link" href="#descrição-15" title="Direct link to heading">​</a></h4><p>A função <code>.getBoxList()</code> devolve uma colecção de caixas de correio descrevendo todas as caixas de correio disponíveis. Esta função permite gerir localmente a lista de mensagens localizadas no servidor de correio IMAP.</p><p>No parâmetro opcional `` , passe um objeto contendo valores para filtrar as caixas de correio devolvidas. Pode passar:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Booleano</td><td><li><strong>True*</strong> para devolver apenas caixas de correio inscritas</li><li> <strong>False*</strong> para devolver todas as caixas de correio disponíveis</li></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-1">Resultados<a class="hash-link" href="#resultados-1" title="Direct link to heading">​</a></h4><p>Cada objecto da coleção devolvida contém as seguintes propriedades:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>[<!-- -->].name</td><td>text</td><td>Nome da nova caixa de correio</td></tr><tr><td>[<!-- -->].selectable</td><td>boolean</td><td>Indica se os direitos de acesso permitem ou não a selecção da caixa de correio: <ul><li>true - a caixa de correio pode ser seleccionada</li><li>falso - a caixa de correio não pode ser seleccionada</li></ul></td></tr><tr><td>[<!-- -->].inferior</td><td>boolean</td><td>Indica se os direitos de acesso permitem ou não a criação de uma hierarquia inferior na caixa de correio: <ul><li>true - pode ser criado um nível inferior</li><li>falso - um nível inferior não pode ser criado</li></ul></td></tr><tr><td>[<!-- -->].interesting</td><td>boolean</td><td>Indica se a caixa de correio foi marcada como &quot;interessante&quot; pelo servidor: <ul><li>true - A caixa de correio foi marcada como &quot;interessante&quot; pelo servidor. Por exemplo, pode conter novas mensagens.</li><li>falso - A caixa de correio não foi marcada como &quot;interessante&quot; pelo servidor.</li></ul></td></tr></tbody></table><p>Se a conta não contiver quaisquer caixas de correio, é devolvida uma colecção vazia.</p><blockquote><ul><li>Se não houver uma conexão aberta, <code>.getBoxList()</code> irá abrir uma conexão.</li><li>Se a conexão não tiver sido utilizada desde o atraso da ligação determinado (ver <code>IMAP Novo transportador</code>), a função <code>.checkConnection( )</code> é automaticamente chamada.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-7">Exemplo<a class="hash-link" href="#exemplo-7" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getdelimiter">.getDelimiter()<a class="hash-link" href="#getdelimiter" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>Resultados</td><td>Text</td><td align="center">&lt;-</td><td>Carácter delimitador da hierarquia</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-16">Descrição<a class="hash-link" href="#descrição-16" title="Direct link to heading">​</a></h4><p>A função <code>.getDelimiter()</code> devolve o carácter utilizado para delimitar os níveis de hierarquia no nome da caixa de correio.</p><p>O delimitador é um caractere a que se pode usar para:</p><ul><li>criar caixas de correio de nível inferior</li><li>pesquisar hierarquias de nível mais alto ou mais baixo dentro das caixa de correio</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-2">Resultados<a class="hash-link" href="#resultados-2" title="Direct link to heading">​</a></h4><p>Carácter delimitador do nome da caixa de correio.</p><blockquote><ul><li>Se não houver uma ligação aberta, <code>.getDelimiter()</code> irá abrir uma ligação.</li><li>Se a ligação não tiver sido utilizada desde o atraso da ligação designada <a href="#checkconnectiondelay"></a>, a função <a href="#checkconnection"><code>.checkConnection()</code></a> é automaticamente chamada.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-8">Exemplo<a class="hash-link" href="#exemplo-8" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> For each($box;$boxList)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If($box.interesting)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ALERT(&quot;New emails are available in the box: &quot;+$split[$split.length-1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End for each</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmail">.getMail()<a class="hash-link" href="#getmail" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Número sequencial da mensagem</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID única da mensagem</td></tr><tr><td>options</td><td>Objeto</td><td align="center">-&gt;</td><td>Instruções de tratamento de mensagens</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td><a href="/docs/pt/API/EmailObjectClass#email-object">Email objecto</a></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-17">Descrição<a class="hash-link" href="#descrição-17" title="Direct link to heading">​</a></h4><p>A função <code>.getMail()</code> returns the <code>Email</code> object corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>. Essa função permite manejar localmente os conteúdos de email.</p><p>In the first parameter, you can pass either:</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li></ul><p>The optional <em>options</em> parameter allows you pass an object defining additional instructions for handling the message. As seguintes propriedades estão disponíveis:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>updateSeen</td><td>boolean</td><td>If True, the message is marked as &quot;seen&quot; in the mailbox. If False, the message is not marked as &quot;seen&quot;. Default value: True</td></tr><tr><td>withBody</td><td>boolean</td><td>Pass True to return the body of the message. If False, only the message header is returned. Default value: True</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns <strong>Null</strong> if <em>msgID</em> designates a non-existing message,</li><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> function, an error is generated,</li><li>If there is no open connection, <code>.getMail()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>`.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-3">Resultados<a class="hash-link" href="#resultados-3" title="Direct link to heading">​</a></h4><p><code>.getMail()</code> returns an <a href="/docs/pt/API/EmailObjectClass#email-object"><code>Email</code> object</a> with the following specific IMAP properties: <em>id</em>, <em>receivedAt</em>, and <em>size</em>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-9">Exemplo<a class="hash-link" href="#exemplo-9" title="Direct link to heading">​</a></h4><p>You want to get the message with ID = 1:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get Email object with ID 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmails">.getMails()<a class="hash-link" href="#getmails" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>ids</td><td>Collection</td><td align="center">-&gt;</td><td>Collection of message ID</td></tr><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Sequence number of the first message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Sequence number of the last message</td></tr><tr><td>options</td><td>Objeto</td><td align="center">-&gt;</td><td>Instruções de tratamento de mensagens</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Object containing:<br><ul><li>a collection of <a href="/docs/pt/API/EmailObjectClass#email-object">Email objects</a> and</li><li>a collection of IDs or numbers for missing messages, if any</li></ul></td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-18">Descrição<a class="hash-link" href="#descrição-18" title="Direct link to heading">​</a></h4><p>A função <code>.getMails()</code> returns an object containing a collection of <code>Email</code> objects.</p><p><strong>First Syntax:</strong></p><p><strong><em>.getMails( ids { ; options } ) -&gt; result</em></strong></p><p>The first syntax allows you to retrieve messages based on their IDs.</p><p>In the <em>ids</em> parameter, pass a collection of IDs for the messages to return. You can get the IDs with <a href="#getmail"><code>.getMail()</code></a>.</p><p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned. See the <strong>Options</strong> table below for a description of the available properties.</p><p><strong>Second syntax:</strong></p><p> <strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt; result</em></strong></p><p>The second syntax allows you to retrieve messages based on a sequential range. The values passed represent the position of the messages in the mailbox.</p><p>In the <em>startMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p><p>In the <em>endMsg</em> parameter, pass an <em>integer</em> value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p><p>The optional <em>options</em> parameter allows you to define the parts of the messages to be returned.</p><p><strong>Options</strong></p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>updateSeen</td><td>Booleano</td><td>If True, the specified messages are marked as &quot;seen&quot; in the mailbox. If False, the messages are not marked as &quot;seen&quot;. Default value: True</td></tr><tr><td>withBody</td><td>Booleano</td><td>Pass True to return the body of the specified messages. If False, only the message headers are returned. Default value: True</td></tr></tbody></table><blockquote><ul><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated.</li><li>If there is no open connection, <code>.getMails()</code> will open a connection the last mailbox specified with <a href="#selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-4">Resultados<a class="hash-link" href="#resultados-4" title="Direct link to heading">​</a></h4><p><code>.getMails()</code> returns an object containing the following collections:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>lista</td><td>Collection</td><td>Collection of <a href="/docs/pt/API/EmailObjectClass#email-object"><code>Email</code> objects</a>. If no Email objects are found, an empty collection is returned.</td></tr><tr><td>notFound</td><td>Collection</td><td>Collection of:<br><ul><li>first syntax - previously passed message IDs that do not exist</li><li>second syntax - sequence numbers of messages between startMsg and endMsg that do not exist</li></ul>An empty collection is returned if all messages are found.</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-10">Exemplo<a class="hash-link" href="#exemplo-10" title="Direct link to heading">​</a></h4><p>You want to retrieve the 20 most recent emails without changing their &quot;seen&quot; status:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  If($boxInfo.mailCount&gt;0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // retrieve the headers of the last 20 messages without marking them as read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     New object(&quot;withBody&quot;;False;&quot;updateSeen&quot;;False))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For each($mail;$result.list)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getmimeasblob">.getMIMEAsBlob()<a class="hash-link" href="#getmimeasblob" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td align="center">-&gt;</td><td>Número sequencial da mensagem</td></tr><tr><td>msgID</td><td>Text</td><td align="center">-&gt;</td><td>ID única da mensagem</td></tr><tr><td>updateSeen</td><td>Booleano</td><td align="center">-&gt;</td><td>If True, the message is marked &quot;seen&quot; in the mailbox. If False the message is left untouched.</td></tr><tr><td>Resultados</td><td>BLOB</td><td align="center">&lt;-</td><td>Blob of the MIME string returned from the mail server</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-19">Descrição<a class="hash-link" href="#descrição-19" title="Direct link to heading">​</a></h4><p>A função <code>.getMIMEAsBlob()</code> returns a BLOB containing the MIME contents for the message corresponding to the <em>msgNumber</em> or <em>msgID</em> in the mailbox designated by the <code>IMAP_transporter</code>.</p><p>In the first parameter, you can pass either:</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating the sequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique ID of the message to retrieve.</li></ul><p>The optional <em>updateSeen</em> parameter allows you to specify if the message is marked as &quot;seen&quot; in the mailbox. Pode passar:</p><ul><li><strong>True</strong> - to mark the message as &quot;seen&quot; (indicating the message has been read)</li><li><strong>False</strong> - to leave the message&#x27;s &quot;seen&quot; status untouched &gt; <em> The function returns an empty BLOB if </em>msgNumber<em> or msgID</em> designates a non-existing message, &gt; <em> If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated, &gt; </em> If there is no open connection, <code>.getMIMEAsBlob()</code> will open a connection the last mailbox specified with <code>.selectBox()</code>.<blockquote><ul><li>The function returns an empty BLOB if <em>msgNumber</em> or msgID* designates a non-existing message,</li><li>If no mailbox is selected with the <a href="#selectbox"><code>.selectBox()</code></a> command, an error is generated,</li><li>If there is no open connection, <code>.getMIMEAsBlob()</code> will open a connection the last mailbox specified with <code>.selectBox()</code>.</li></ul></blockquote></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-5">Resultados<a class="hash-link" href="#resultados-5" title="Direct link to heading">​</a></h4><p><code>.getMIMEAsBlob()</code> retorna um <code>BLOB</code> que pode ser arquivado em um banco de dados ou convertido a um objeto <a href="/docs/pt/API/EmailObjectClass#email-object"><code>Email</code> </a> com o comando <code>MAIL Convert from MIME</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-11">Exemplo<a class="hash-link" href="#exemplo-11" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $boxInfo : Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $blob : Blob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;Inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get BLOB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="host">.host<a class="hash-link" href="#host" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.host</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-20">Descrição<a class="hash-link" href="#descrição-20" title="Direct link to heading">​</a></h4><p>A propriedade <code>.host</code> contém o nome ou o endereço IP do servidor anfitrião. Utilizado para transacções postais (SMTP, POP3, IMAP).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="logfile">.logFile<a class="hash-link" href="#logfile" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.logFile</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-21">Descrição<a class="hash-link" href="#descrição-21" title="Direct link to heading">​</a></h4><p>A propriedade <code>.logFile</code> contém o caminho do arquivo de registo alargado definido (se existir) para a ligação de correio. Pode ser relativo (à pasta atual de Logs) ou absoluto.</p><p>Ao contrário dos arquivos de registo regulares (ativados através do comando <code>SET DATABASE PARAMETER</code> ), os arquivos de registo armazenam o conteúdo MIME de todos os e-mails enviados e não têm qualquer limite de tamanho. Para mais informações sobre arquivos de registo estendidos, consultar:</p><ul><li><strong>Conexões SMTP</strong> - <a href="/docs/pt/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>Conexões POP3</strong> - <a href="/docs/pt/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>Conexões IMAP </strong> - <a href="/docs/pt/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="move">.move()<a class="hash-link" href="#move" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Coleção de identificadores únicos de mensagens (strings)</td></tr><tr><td>allMsgs</td><td>Integer</td><td align="center">-&gt;</td><td><code>IMAP all</code>: Todas as mensagens na caixa de correio seleccionada</td></tr><tr><td>destinationBox</td><td>Text</td><td align="center">-&gt;</td><td>Mailbox to receive moved messages</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Status of the move operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-22">Descrição<a class="hash-link" href="#descrição-22" title="Direct link to heading">​</a></h4><p>A função <code>.move()</code> moves the messages defined by <em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em> on the IMAP server.</p><p>Pode passar:</p><ul><li>in the <em>msgsIDs</em> parameter, a collection containing the unique IDs of the specific messages to move, or</li><li>in the <em>allMsgs</em> parameter, the <code>IMAP all</code> constant (integer) to move all messages in the selected mailbox.</li></ul><p>The <em>destinationBox</em> parameter allows you to pass a text value with the name of the mailbox where the messages will be moved.</p><blockquote><p>This function is only supported by IMAP servers compliant with RFC <a href="https://tools.ietf.org/html/rfc8474" target="_blank" rel="noopener noreferrer">8474</a>.</p></blockquote><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-1-3">Exemplo 1<a class="hash-link" href="#exemplo-1-3" title="Direct link to heading">​</a></h4><p>To move a selection of messages:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get collection of message unique IDs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.searchMails(&quot;subject \&quot;4D new feature:\&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Move found messages from the current mailbox to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.move($mailIds;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-2-3">Exemplo 2<a class="hash-link" href="#exemplo-2-3" title="Direct link to heading">​</a></h4><p>To move all messages in the current mailbox:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // move all messages in the current mailbox to the &quot;documents&quot; mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.move(IMAP all;&quot;documents&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="numtoid">.numToID()<a class="hash-link" href="#numtoid" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>startMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Sequence number of the first message</td></tr><tr><td>endMsg</td><td>Integer</td><td align="center">-&gt;</td><td>Sequence number of the last message</td></tr><tr><td>Resultados</td><td>Collection</td><td align="center">&lt;-</td><td>Collection of unique IDs</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-23">Descrição<a class="hash-link" href="#descrição-23" title="Direct link to heading">​</a></h4><p>A função <code>.numToID()</code> converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by <em>startMsg</em> and <em>endMsg</em> in the currently selected mailbox.</p><p>In the <em>startMsg</em> parameter, pass an integer value corresponding to the number of the first message in a sequential range. If you pass a negative number (<em>startMsg</em> &lt;= 0), the first message of the mailbox will be used as the beginning of the sequence.</p><p>In the <em>endMsg</em> parameter, pass an integer value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (<em>endMsg</em> &lt;= 0), the last message of the mailbox will be used as the end of the sequence.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resultados-6">Resultados<a class="hash-link" href="#resultados-6" title="Direct link to heading">​</a></h4><p>The function returns a collection of strings (unique IDs).</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-12">Exemplo<a class="hash-link" href="#exemplo-12" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $mailIds : Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;inbox&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //get IDs for 5 last messages received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //delete the messages from the current mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="removeflags">.removeFlags()<a class="hash-link" href="#removeflags" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R6</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td align="center">-&gt;</td><td>Coleção de strings: IDs únicos de mensagens (texto)<br>Texto: ID único de uma mensagem<br>Longint (todos IMAP): Todas as mensagens na caixa de correio seleccionada</td></tr><tr><td>keywords</td><td>Objeto</td><td align="center">-&gt;</td><td>Keyword flags to remove</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Status of the removeFlags operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-24">Descrição<a class="hash-link" href="#descrição-24" title="Direct link to heading">​</a></h4><p>A função <code>.removeFlags()</code> removes flags from the <code>msgIDs</code> for the specified <code>keywords</code>.</p><p>No parâmetro <code>msgIDs</code> , pode passar qualquer um dos dois:</p><ul><li><p>uma colecção ** contendo as identificações únicas de mensagens específicas ou</p></li><li><p>o ID único (<em>texto</em>) de uma mensagem ou</p></li><li><p>a seguinte constante (<em>longint</em>) para todas as mensagens na caixa de correio seleccionada:</p><table><thead><tr><th>Constante</th><th>Value</th><th>Comentário</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Seleccione todas as mensagens na caixa de correio seleccionada</td></tr></tbody></table></li></ul><p>The <code>keywords</code> parameter lets you pass an object with keyword values for specific flags to remove from <code>msgIDs</code>. Pode passar qualquer uma das seguintes palavras-chave:</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>$draft</td><td>Booleano</td><td>True to remove the &quot;draft&quot; flag from the message</td></tr><tr><td>$seen</td><td>Booleano</td><td>True to remove the &quot;seen&quot; flag from the message</td></tr><tr><td>$flagged</td><td>Booleano</td><td>True to remove the &quot;flagged&quot; flag from the message</td></tr><tr><td>$answered</td><td>Booleano</td><td>True to remove the &quot;answered&quot; flag from the message</td></tr><tr><td>$deleted</td><td>Booleano</td><td>True to remove the &quot;deleted&quot; flag from the message</td></tr></tbody></table><p>Note that False values are ignored.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-13">Exemplo<a class="hash-link" href="#exemplo-13" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.port:=993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create transporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Select mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Mark all messages from INBOX as unseen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$flags[&quot;$seen&quot;]:=True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.removeFlags(IMAP all;$flags)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="renamebox">.renameBox()<a class="hash-link" href="#renamebox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v19</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>currentName</td><td>Text</td><td align="center">-&gt;</td><td>Name of the current mailbox</td></tr><tr><td>newName</td><td>Text</td><td align="center">-&gt;</td><td>New mailbox name</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Status of the renaming operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-25">Descrição<a class="hash-link" href="#descrição-25" title="Direct link to heading">​</a></h4><p>A função <code>.renameBox()</code> changes the name of a mailbox on the IMAP server. Attempting to rename a mailbox from a mailbox name that does not exist or to a mailbox name that already exists will generate an error.</p><p>In the <code>currentName</code> parameter, pass the name of the mailbox to be renamed.</p><p>Pass the new name for the mailbox in the <code>newName</code> parameter.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-14">Exemplo<a class="hash-link" href="#exemplo-14" title="Direct link to heading">​</a></h4><p>To to rename your “Invoices” mailbox to “Bills”:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// rename mailbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.renameBox(&quot;Invoices&quot;; &quot;Bills&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox renaming successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="port">.port<a class="hash-link" href="#port" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.port</strong> : Integer</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-26">Descrição<a class="hash-link" href="#descrição-26" title="Direct link to heading">​</a></h4><p>A propriedade <code>.port</code> contém  o número do porto utilizado para as transações postais. Por padrão, se a propriedade não tiver sido definida no objeto servidor (utilizado para criar o objecto transportador com <code>SMTP Novo transportador</code>, <code>POP3 Novo transportador</code>, ou <code>IMAP Novo transportador</code>), o valor é 30:</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="searchmails">.searchMails()<a class="hash-link" href="#searchmails" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R5</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Text</td><td align="center">-&gt;</td><td>Critérios de pesquisa</td></tr><tr><td>Resultados</td><td>Collection</td><td align="center">&lt;-</td><td>Collection of message numbers</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-27">Descrição<a class="hash-link" href="#descrição-27" title="Direct link to heading">​</a></h4><blockquote><p>This function is based upon the specification for the <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol" target="_blank" rel="noopener noreferrer">IMAP protocol</a>.</p></blockquote><p>A função <code>.searchMails()</code> searches for messages that match the given <em>searchCriteria</em> in the current mailbox. <em>searchCriteria</em> consists of one or more search keys.</p><p><em>searchCriteria</em> is a text parameter listing one or more search keys (see <a href="#authorized-search-keys">Authorized search-keys</a> below) associated or not with values to look for. A search key may be a single or multiple items. Por exemplo:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SearchKey1 = FLAGGED SearchKey2 = NOT FLAGGED SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Matching is usually not case-sensitive</p></blockquote><ul><li>If the <em>searchCriteria</em> is a null string, the search will be equivalent to a “select all”.</li><li>If the <em>searchCriteria</em> includes multiple search keys, the result is the intersection (AND function) of all the messages that match those keys.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = FLAGGED FROM &quot;SMITH&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns all messages with \Flagged flag set AND sent by Smith.</p><ul><li>You can use the <strong>OR</strong> or <strong>NOT</strong> operators as follows:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns all messages with \Seen flag set OR \Flagged flag set</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns all messages with \Seen flag not set.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot; NOT HEADER CONTENT-TYPE &quot;TEXT&quot;...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns message whose content-type header contains “Mixed” and does not contain “Text”.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = HEADER CONTENT-TYPE &quot;E&quot; NOT SUBJECT &quot;o&quot; NOT HEADER CONTENT-TYPE &quot;MIXED&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... returns message whose content-type header contains “ e ” and whose Subject header does not contain “ o ” and whose content-type header is not “ Mixed ”.</p><p>As concerns the last two examples, notice that the result of the search is different when you remove the parentheses of the first search key list.</p><ul><li>The <em>searchCriteria</em> may include the optional <!-- -->[<!-- -->CHARSET] specification. This consists of the &quot;CHARSET&quot; word followed by a registered <!-- -->[<!-- -->CHARSET] (US ASCII, ISO-8859). It indicates the charset of the <em>searchCriteria</em> string. Therefore, you must convert the <em>searchCriteria</em> string into the specified charset if you use the <!-- -->[<!-- -->CHARSET] specification (see the <code>CONVERT FROM TEXT</code> or <code>Convert to text</code> commands). By default, 4D encodes in Quotable Printable the searchCriteria string if it contains extended characters.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchCriteria = CHARSET &quot;ISO-8859&quot; BODY &quot;Help&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... means the search criteria uses the charset iso-8859 and the server will have to convert the search criteria before searching, if necessary.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="search-value-types">Search value types<a class="hash-link" href="#search-value-types" title="Direct link to heading">​</a></h4><p>Search-keys may request the value to search for:</p><ul><li><p><strong>Search-keys with a date value</strong>: the date is a string that must be formatted as follows: <em>date-day+&quot;-&quot;+date-month+&quot;-&quot;+date-year</em> where date-day indicates the number of the day of the month (max. 2 characters), date-month indicates the name of the month (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) and date-year indicates the year (4 characters). Example: <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (a date does not usually need to be quoted since it does not contain any special characters)</p></li><li><p><strong>Search-keys with a string value</strong>: the string may contain any character and must be quoted. If the string does not contain any special characters, like the space character for instance, it does not need to be quoted. Quoting such strings will ensure that your string value will be correctly interpreted. Example: <code>searchCriteria = FROM &quot;SMITH&quot;</code> For all search keys that use strings, a message matches the key if the string is a substring of the field. Matching is not case-sensitive.</p></li><li><p><strong>Search-keys with a field-name value</strong>: the field-name is the name of a header field. Example: <code>searchCriteria = HEADER CONTENT-TYPE &quot;MIXED&quot;</code></p></li><li><p><strong>Search-keys with a flag value</strong>: the flag may accept one or several keywords (including standard flags), separated by spaces. Example: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Search-keys with a message set value</strong>: Identifies a set of messages. For message sequence numbers, these are consecutive numbers from 1 to the total number of messages in the mailbox. A comma delimits individual numbers; a colon delimits between two numbers inclusive. Examples: <code>2,4:7,9,12:*</code> is <code>2,4,5,6,7,9,12,13,14,15</code> for a mailbox with 15 messages. <code>searchCriteria = 1:5 ANSWERED</code> search in message selection from message sequence number 1 to 5 for messages which have the \Answered flag set. <code>searchCriteria= 2,4 ANSWERED</code> search in the message selection (message numbers 2 and 4) for messages which have the \Answered flag set.</p></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="authorized-search-keys">Authorized search-keys<a class="hash-link" href="#authorized-search-keys" title="Direct link to heading">​</a></h4><p><strong>ALL</strong>: All messages in the mailbox.<br>
<strong>ANSWERED</strong>: Messages with the \Answered flag set.<br>
<strong>UNANSWERED</strong>: Messages that do not have the \Answered flag set.<br>
<strong>DELETED</strong>: Messages with the \Deleted flag set.<br>
<strong>UNDELETED</strong>: Messages that do not have the \Deleted flag set.<br>
<strong>DRAFT</strong>: Messages with the \Draft flag set.<br>
<strong>UNDRAFT</strong>: Messages that do not have the \Draft flag set.<br>
<strong>FLAGGED</strong>: Messages with the \Flagged flag set.<br>
<strong>UNFLAGGED</strong>: Messages that do not have the \Flagged flag set.<br>
<strong>RECENT</strong>: Messages that have the \Recent flag set.<br>
<strong>OLD</strong>: Messages that do not have the \Recent flag set.<br>
<strong>SEEN</strong>: Messages that have the \Seen flag set.<br>
<strong>UNSEEN</strong>: Messages that do not have the \Seen flag set.<br>
<strong>NEW</strong>: Messages that have the \Recent flag set but not the \Seen flag. This is functionally equivalent to “(RECENT UNSEEN)”.<br>
<strong><em>KEYWORD </em></strong>flag<strong>**</strong>: Messages with the specified keyword set.<br>
<strong><em>UNKEYWORD </em></strong>flag<strong>**</strong>: Messages that do not have the specified keyword set.<br>
<strong><em>BEFORE </em></strong>date<strong>**</strong>: Messages whose internal date is earlier than the specified date.<br>
<strong><em>ON </em></strong>date<strong>**</strong>: Messages whose internal date is within the specified date.<br>
<strong><em>SINCE </em></strong>date<strong>**</strong>: Messages whose internal date is within or later than the specified date.<br>
<strong><em>SENTBEFORE </em></strong>date<strong>**</strong>: Messages whose Date header is earlier than the specified date.<br>
<strong><em>SENTON </em></strong>date<strong>**</strong>: Messages whose Date header is within the specified date.<br>
<strong><em>SENTSINCE </em></strong>date<strong>**</strong>: Messages whose Date header is within or later than the specified date.<br>
<strong><em>TO </em></strong>string<strong>**</strong>: Messages that contain the specified string in the TO header.<br>
<strong><em>FROM </em></strong>string<strong>**</strong>: Messages that contain the specified string in the FROM header.<br>
<strong><em>CC </em></strong>string<strong>**</strong>: Messages that contain the specified string in the CC header.<br>
<strong><em>BCC </em></strong>string<strong>**</strong>: Messages that contain the specified string in the BCC header.<br>
<strong><em>SUBJECT </em></strong>string<strong>**</strong>: Messages that contain the specified string in the Subject header.<br>
<strong><em>BODY </em></strong>string<strong>**</strong>: Messages that contain the specified string in the message body.<br>
<strong><em>TEXT </em></strong>string<strong>**</strong>: Messages that contain the specified string in the header or in the message body.<br>
<strong><em>HEADER </em>field-name* *</strong>string<strong>**</strong>: Messages that have a header with the specified field-name and that contain the specified string in the field-body.<br>
<strong><em>UID </em></strong>message-UID<strong>**</strong>: Messages with unique identifiers corresponding to the specified unique identifier set.<br>
<strong><em>LARGER </em></strong>n<strong>**</strong>: Messages with a size larger than the specified number of bytes.<br>
<strong><em>SMALLER </em></strong>n<strong>**</strong>: Messages with a size smaller than the specified number of bytes.<br>
<strong><em>NOT </em></strong>search-key<strong>**</strong>: Messages that do not match the specified search key.<br>
<strong><em>OR </em>search-key1* *</strong>search-key2<strong>**</strong>: Messages that match either search key.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="selectbox">.selectBox()<a class="hash-link" href="#selectbox" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v18 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da nova caixa de correio</td></tr><tr><td>state</td><td>Integer</td><td align="center">-&gt;</td><td>Mailbox access status</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-28">Descrição<a class="hash-link" href="#descrição-28" title="Direct link to heading">​</a></h4><p>A função <code>.selectBox()</code> selects the <em>name</em> mailbox as the current mailbox. Essa função permite que recupere informação sobre o mailbox.</p><blockquote><p>To get the information from a mailbox without changing the current mailbox, use <a href="#getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>In the <em>name</em> parameter, pass the name of the mailbox to access. O nome representa uma hierarquia inequívoca da esquerda para a direita com níveis separados por um carácter delimitador específico. O delimitador pode ser encontrado com a função <a href="#getdelimiter"><code>.getDelimiter()</code></a> .</p><p>The optional <em>state</em> parameter defines the type of access to the mailbox. The possible values are:</p><table><thead><tr><th>Constante</th><th>Value</th><th>Comentário</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>The selected mailbox is accessed with read only privileges. Messages with a &quot;recent&quot; flag (indicating new messages) remain unchanged.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>The selected mailbox is accessed with read and write privileges. Messages are considered &quot;seen&quot; and lose the &quot;recent&quot; flag (indicating new messages). (Valor padrão)</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns <strong>Null</strong> if <em>name</em> designates a non-existing mailbox.</li><li>If there is no open connection, <code>.selectBox()</code> will open a connection.</li><li>If the connection has not been used since the designated connection delay (see <code>IMAP New transporter</code>), the <a href="#checkconnection"><code>.checkConnection()</code></a> function is automatically called.</li></ul></blockquote><p><strong>Objeto devolvido</strong></p><p>O objeto <code>boxInfo</code> retornado contém as funcionalidades abaixo:</p><table><thead><tr><th>Propriedade</th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Nome da nova caixa de correio</td></tr><tr><td>mailCount</td><td>number</td><td>Número de mensagens na caixa de email</td></tr><tr><td>mailRecent</td><td>number</td><td>Number of messages with the &quot;recent&quot; flag</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-15">Exemplo<a class="hash-link" href="#exemplo-15" title="Direct link to heading">​</a></h4><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.host:=&quot;imap.gmail.com&quot; //Mandatory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.user:=&quot;4d@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $server.password:=&quot;XXXXXXXX&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $boxInfo:=$transporter.selectBox(&quot;INBOX&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="subscribe">.subscribe()<a class="hash-link" href="#subscribe" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v19</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da nova caixa de correio</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Status of the subscribe operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-29">Descrição<a class="hash-link" href="#descrição-29" title="Direct link to heading">​</a></h4><p>A função <code>.subscribe()</code> allows adding or removing of the specified mailbox to/from the IMAP server’s set of “subscribed” mailboxes. As such, you can choose to narrow down a large list of available mailboxes by subscribing to those you usually want to see.</p><p>In the <code>name</code> parameter, pass the name of the mailbox to add (subscribe) to your &quot;subscribed&quot; mailboxes.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-16">Exemplo<a class="hash-link" href="#exemplo-16" title="Direct link to heading">​</a></h4><p>To subscribe to the &quot;Atlas Corp” mailbox in the &quot;Bills&quot; hierarchy:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;) If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.subscribe($name) If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox subscription successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unsubscribe">.unsubscribe()<a class="hash-link" href="#unsubscribe" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v19</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parâmetros</th><th>Tipo</th><th align="center"></th><th>Descrição</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td align="center">-&gt;</td><td>Nome da nova caixa de correio</td></tr><tr><td>Resultados</td><td>Objeto</td><td align="center">&lt;-</td><td>Status of the unsubscribe operation</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-30">Descrição<a class="hash-link" href="#descrição-30" title="Direct link to heading">​</a></h4><p>A função <code>.unsubscribe()</code> removes a mailbox from a set of subscribed mailboxes. This allows you reduce the number of mailboxes you usually see.</p><p>In the <code>name</code> parameter, pass the name of the mailbox to remove (unsubscribe) from your active mailboxes.</p><p><strong>Objeto devolvido</strong></p><p>A função devolve um objecto que descreve o estado IMAP:</p><table><thead><tr><th>Propriedade</th><th></th><th>Tipo</th><th>Descrição</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>Verdadeiro se a operação for bem sucedida, Falso caso contrário</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Mensagem de estado devolvida pelo servidor IMAP, ou último erro devolvido na pilha de erros 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>pilha de erros 4D (não devolvida se for recebida uma resposta do servidor IMAP)</td></tr><tr><td></td><td>[<!-- -->].errcode</td><td>Número</td><td>Código de erro 4D</td></tr><tr><td></td><td>[<!-- -->].message</td><td>Text</td><td>Descrição do erro 4D</td></tr><tr><td></td><td>[<!-- -->].componentSignature</td><td>Text</td><td>Assinatura da componente interna que devolveu o erro</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exemplo-17">Exemplo<a class="hash-link" href="#exemplo-17" title="Direct link to heading">​</a></h4><p>To unsubscribe from the &quot;Atlas Corp” mailbox in the &quot;Bills&quot; hierarchy:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $pw; $name : text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options:=New object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pw:=Request(&quot;Please enter your password:&quot;) If(OK=1) $options.host:=&quot;imap.gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.user:=&quot;test@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$options.password:=$pw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$name:=&quot;Bills&quot;+$transporter.getDelimiter()+&quot;Atlas Corp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$status:=$transporter.unsubscribe($name) If ($status.success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Mailbox unsubscription successful!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ALERT(&quot;Error: &quot;+$status.statusText)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   End if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End if</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user">.user<a class="hash-link" href="#user" title="Direct link to heading">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Histórico</summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th>Versão</th><th>Mudanças</th></tr></thead><tbody><tr><td>v17 R4</td><td>Adicionado</td></tr></tbody></table></div></div></details><p><strong>.user</strong> : Text</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="descrição-31">Descrição<a class="hash-link" href="#descrição-31" title="Direct link to heading">​</a></h4><p>A propriedade <code>.user</code> contém  o nome de usuário utilizado para autenticação no servidor de correio.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(19-R8)&amp;body=Please%20enter%20your%20comment%3A" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Comment on this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/pt/API/HTTPRequestClass"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pt/API/MailAttachmentClass"><div class="pagination-nav__sublabel">Próximo</div><div class="pagination-nav__label">MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objecto-do-imap-transporter" class="table-of-contents__link toc-highlight">Objecto do IMAP Transporter</a></li><li><a href="#imap-new-transporter" class="table-of-contents__link toc-highlight">IMAP New transporter</a></li><li><a href="#4dimaptransporternew" class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a></li><li><a href="#acceptunsecureconnection" class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a></li><li><a href="#addflags" class="table-of-contents__link toc-highlight">.addFlags()</a></li><li><a href="#append" class="table-of-contents__link toc-highlight">.append()</a></li><li><a href="#authenticationmode" class="table-of-contents__link toc-highlight">.authenticationMode</a></li><li><a href="#checkconnection" class="table-of-contents__link toc-highlight">.checkConnection()</a></li><li><a href="#checkconnectiondelay" class="table-of-contents__link toc-highlight">.checkConnectionDelay</a></li><li><a href="#connectiontimeout" class="table-of-contents__link toc-highlight">.connectionTimeOut</a></li><li><a href="#copy" class="table-of-contents__link toc-highlight">.copy()</a></li><li><a href="#createbox" class="table-of-contents__link toc-highlight">.createBox()</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">.delete()</a></li><li><a href="#deletebox" class="table-of-contents__link toc-highlight">.deleteBox()</a></li><li><a href="#expunge" class="table-of-contents__link toc-highlight">.expunge()</a></li><li><a href="#getboxinfo" class="table-of-contents__link toc-highlight">.getBoxInfo()</a></li><li><a href="#getboxlist" class="table-of-contents__link toc-highlight">.getBoxList()</a></li><li><a href="#getdelimiter" class="table-of-contents__link toc-highlight">.getDelimiter()</a></li><li><a href="#getmail" class="table-of-contents__link toc-highlight">.getMail()</a></li><li><a href="#getmails" class="table-of-contents__link toc-highlight">.getMails()</a></li><li><a href="#getmimeasblob" class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a></li><li><a href="#host" class="table-of-contents__link toc-highlight">.host</a></li><li><a href="#logfile" class="table-of-contents__link toc-highlight">.logFile</a></li><li><a href="#move" class="table-of-contents__link toc-highlight">.move()</a></li><li><a href="#numtoid" class="table-of-contents__link toc-highlight">.numToID()</a></li><li><a href="#removeflags" class="table-of-contents__link toc-highlight">.removeFlags()</a></li><li><a href="#renamebox" class="table-of-contents__link toc-highlight">.renameBox()</a></li><li><a href="#port" class="table-of-contents__link toc-highlight">.port</a></li><li><a href="#searchmails" class="table-of-contents__link toc-highlight">.searchMails()</a></li><li><a href="#selectbox" class="table-of-contents__link toc-highlight">.selectBox()</a></li><li><a href="#subscribe" class="table-of-contents__link toc-highlight">.subscribe()</a></li><li><a href="#unsubscribe" class="table-of-contents__link toc-highlight">.unsubscribe()</a></li><li><a href="#user" class="table-of-contents__link toc-highlight">.user</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Developer Center</a></li><li class="footer__item"><a href="https://blog.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Blog</a></li><li class="footer__item"><a href="https://discuss.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Forum</a></li><li class="footer__item"><a href="https://facebook.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://youtube.com/user/4Dsoftware" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/4D" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://doc.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D Doc Center (Where It All Began)</a></li><li class="footer__item"><a href="https://kb.4d.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Knowledgebase</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">Resources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-technical-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About 4D<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/4d-around-the-world" target="_blank" rel="noopener noreferrer" class="footer__link-item">4D around the world<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://us.4d.com/Careers" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/pt/assets/js/runtime~main.84ff404e.js"></script>
<script src="/docs/pt/assets/js/main.6498f955.js"></script>
</body>
</html>