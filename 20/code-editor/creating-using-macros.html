<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-20 docs-doc-page docs-doc-id-code-editor/creating-using-macros" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Creating and using macros | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/20/code-editor/creating-using-macros><meta data-rh=true property=og:locale content=en><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true property=og:locale:alternate content=pt><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=20><meta data-rh=true name=docusaurus_tag content=docs-default-20><meta data-rh=true name=docsearch:version content=20><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-20><meta data-rh=true property=og:title content="Creating and using macros | 4D Docs"><meta data-rh=true name=description content="You can use macro-commands in your methods. Using macro-commands saves a lot of time during code entry."><meta data-rh=true property=og:description content="You can use macro-commands in your methods. Using macro-commands saves a lot of time during code entry."><link data-rh=true rel=icon href=/docs/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/20/code-editor/creating-using-macros><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20/code-editor/creating-using-macros hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/20/code-editor/creating-using-macros hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/20/code-editor/creating-using-macros hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/20/code-editor/creating-using-macros hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/20/code-editor/creating-using-macros hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20/code-editor/creating-using-macros hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/opensearch.xml><link rel=stylesheet href=/docs/assets/css/styles.eef951bf.css><script src=/docs/assets/js/main.d2c2c986.js defer></script><script src=/docs/assets/js/runtime~main.aad42cdd.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/><div class=navbar__logo><img src=/docs/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">4D Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/20/code-editor/creating-using-macros>20</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/GettingStarted/installation>20 R7</a><li><a class=dropdown__link href=/docs/20-R6/GettingStarted/installation>20 R6</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/20/code-editor/creating-using-macros>20</a><li><a class=dropdown__link href=/docs/19/GettingStarted/installation>19</a><li><a class=dropdown__link href=/docs/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/docs/20/code-editor/creating-using-macros rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en>English</a><li><a href=/docs/fr/20/code-editor/creating-using-macros rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/docs/es/20/code-editor/creating-using-macros rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/docs/ja/20/code-editor/creating-using-macros rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a><li><a href=/docs/pt/20/code-editor/creating-using-macros rel="noopener noreferrer" class=dropdown__link lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/><img src=/docs/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/img/logohome.png alt="4D Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>4D Documentation</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/20/category/getting-started>Getting Started</a><button aria-label="Expand sidebar category 'Getting Started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/20/category/core-development>Core Development</a><button aria-label="Collapse sidebar category 'Core Development'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/Project/overview>Project Management</a><button aria-label="Expand sidebar category 'Project Management'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/category/4d-language-concepts>4D Language Concepts</a><button aria-label="Expand sidebar category '4D Language Concepts'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/ORDA/overview>ORDA</a><button aria-label="Expand sidebar category 'ORDA'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href=https://doc.4d.com/4Dv20/4D/20/4D-Language-Reference.100-6237190.en.html target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex=0>4D Language Reference<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/category/class-API-reference>Class Functions</a><button aria-label="Expand sidebar category 'Class Functions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/20/code-editor/overview>Handling Code</a><button aria-label="Collapse sidebar category 'Handling Code'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/20/code-editor/write-class-method>Code Editor</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/20/code-editor/creating-using-macros>Creating and using macros</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/20/Tags/tags>Tags</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/Debugging/basics>Debugging</a><button aria-label="Expand sidebar category 'Debugging'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/settings/overview>Settings</a><button aria-label="Expand sidebar category 'Settings'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/20/Preferences/overview>Preferences</a><button aria-label="Expand sidebar category 'Preferences'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/20/category/administration>Administration</a><button aria-label="Expand sidebar category 'Administration'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/20/Extensions/overview>Extensions</a><button aria-label="Expand sidebar category 'Extensions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/20/category/web-applications>Web Applications</a><button aria-label="Expand sidebar category 'Web Applications'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/20/category/desktop-applications>Desktop Applications</a><button aria-label="Expand sidebar category 'Desktop Applications'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a href=https://developer.4d.com/go-mobile/ target=_blank rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false>Mobile Applications</a></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/docs/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/20/category/core-development><span itemprop=name>Core Development</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/20/code-editor/overview><span itemprop=name>Handling Code</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Creating and using macros</span><meta itemprop=position content=3></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 20</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Creating and using macros</h1></header><p>You can use macro-commands in your methods. Using macro-commands saves a lot of time during code entry.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=what-is-a-macro>What is a macro?<a href=#what-is-a-macro class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>A macro-command is a section of 4D code that is permanently accessible and that can be inserted anywhere in your methods, whatever the type of database open. Macros can contain all types of 4D text, commands and constants, as well as special tags which are replaced at the time of macro insertion by values derived from the method context. For instance, a macro may contain the tag <code>&lt;method_name/>;</code> at the time of macro insertion, this tag will be replaced by the name of the current project method.</p>
<p>Macros are stored in one or more XML format (text) file(s). They can be placed in a Code Editor list; they can also be called using the context menu of the editor or using the autocomplete function.</p>
<p>4D macros are written in XML format. You can use the 4D default macro file as is or modify it.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=location-of-macros>Location of macros<a href=#location-of-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>4D loads the macros from a folder named <strong>Macros v2</strong>. Macros must be in the form of one or more XML files that are placed in this folder.</p>
<p>The "Macros v2" folder can be located:</p>
<ul>
<li>In the active 4D folder of the machine. Macros are then shared for all the databases.
<strong>Note:</strong> The location of the active 4D folder varies according to the operating system used. For more information, refer to the description of the <a href=https://doc.4d.com/4Dv19R4/4D/19-R4/Get-4D-folder.301-5739515.en.html target=_blank rel="noopener noreferrer">Get 4D folder</a> command in the 4D <em>Language Reference</em> manual.</li>
<li>Next to the database structure file. Macros are only loaded for this structure.</li>
<li>For components: in the <strong>Components</strong> folder of the database. Macros are then only loaded if the component is installed.</li>
</ul>
<p>These three locations can be used simultaneously: it is possible to install a "Macros v2" folder in each location. The macros will be loaded in the following order: 4D folder, structure file, component 1... component X.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=default-macros>Default macros<a href=#default-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>4D offers a set of default macros containing, for example, control flow keywords. These macros are included in the default "<em>Macros.xml</em>" file, placed in the "Macros v2" folder that is created in the active 4D folder of the machine during the initial startup of 4D.</p>
<p>You can modify this file or the contents of the folder subsequently as desired (see the following paragraph). In the event of problems with this folder, it can be deleted and 4D will re-create it on the next startup.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=adding-customized-macros>Adding customized macros<a href=#adding-customized-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>You can add customized macros in the "Macros.xml" file using a standard text editor or by programming. You can also add XML files of customized macros in this folder.</p>
<p>In local mode, the macros file can be open while using 4D. The list of available macros is updated on each event activating 4D. For instance, it is possible to bring the text editor to the foreground, modify the macro file, then return to the method: the new macro is then available in the Code Editor.</p>
<p>Empty or erroneous macros are not displayed.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checking-the-syntax-of-customized-macros>Checking the syntax of customized macros<a href=#checking-the-syntax-of-customized-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>The macro-command files of 4D must be in conformity with the XML standard. This means more particularly that XML declaration <code>&lt;?xml version="1.0" ...?></code> and document declaration <code>&lt;!DOCTYPE macros SYSTEM "http://www.4d.com/dtd/2007/macros.dtd"></code> statements are mandatory at the beginning of a macro file in order for it to be loaded. The different types of XML encoding are supported. However, it is recommended to use encoding that is Mac/PC (UTF-8) compatible. 4D provides a DTD that can be used to validate the macro files. This file is found in the following location:</p>
<ul>
<li>Windows: \Resources\DTD\macros.dtd</li>
<li>Mac OS: :Contents:Resources:DTD:macros.dtd</li>
</ul>
<p>If a macros file does not contain the declaration statements or cannot be validated, it is not loaded.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=syntax-of-4d-macros>Syntax of 4D macros<a href=#syntax-of-4d-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>4D macros are built using customized XML tags called "elements."</p>
<p>Some tags indicate the start and end of the definition (double tags of the type <code>&lt;tag> &lt;/tag></code>), others are replaced by insertion context values (<code>&lt;tag/></code>).</p>
<p>In conformity with XML specifications, some element tags can include attributes. Unless otherwise indicated, these attributes are optional and a default value is used when they are omitted. The syntax of elements with attributes is as follows:</p>
<ul>
<li>Double tags: <code>&lt;tag attribute="value"> &lt;/macro></code></li>
<li>Single tags: <code>&lt;tag attribute="value"/></code></li>
</ul>
<p>If the element accepts several attributes, you can group them in the same line of command, separated by a space:
<code>\&lt;tag attribute1="value" attribute2="value" attribute3="value"... ></code></p>
<p>Here is the list of tags and their mode of use:</p>

























































































































<table><thead><tr><th><strong>Element tags</strong><th><strong>Description</strong><tbody><tr><td><code>&lt;macros> &lt;/macros></code><td>Start and end of macro file (mandatory tag).<tr><td><code>&lt;macro> &lt;/macro></code><td>Start and end of the definition of a macro and its attributes.<tr><td><td><em>Attributes</em>:<tr><td><td>- name: Name**of macro as it appears in menus and Code Editor lists (mandatory attribute).<tr><td><td>- type_ahead_text: Character string** to be entered to call the macro using the type-ahead (aka autocomplete) function*.<tr><td><td>- in_menu: Boolean indicating whether the macro can be called using the context menu*. Values = "true" (default) or "false."<tr><td><td>- type_ahead: Boolean indicating whether the macro can be called using the type-ahead (aka autocomplete) function*. Values = "true" (default) or "false."<tr><td><td>- method_event: Used to trigger the automatic calling of the macro depending on the current handling phase of each method (creation, closing, and so on). Values = "on_load": The macro is triggered on the opening of each method, "on_save": The macro is triggered when each method is saved (closing of a modified method or saving using the File>Save command, "on_create": The macro is triggered when each method is created, "on_close": The macro is triggered when each method is closed.<tr><td><td>"on_save" and "on_close" can be used jointly --- in other words, both of these events are generated when a modified method is closed. On the other hand, "on_create" and "on_load" are never generated in a consecutive manner. This attribute can be used, for example, to preformat methods when they are created (comments in header area) or to record information such as the date and time when they are closed.<tr><td><td>- version: Used to activate the new mode of supporting text selections for the macro (see the "About the <code>&lt;method></code> Tag" section below). To activate this new mode, pass the value "2". If you omit this attribute or pass version="1", the former mode is kept.<tr><td><td>- in_toolbar: Boolean indicating if the macro must be present in the menu of the Macro button of the toolbar. Values= "true" (default) or "false".<tr><td><code>&lt;selection/></code><td>Tag replaced by the selected text when the macro is inserted. The selection may be empty.<tr><td><code>&lt;text> &lt;/text></code><td>Start and end of code that must be inserted in the method. A carriage return will be added before and after the code.<tr><td><code>&lt;method> &lt;/method></code><td>Start and end of the name of the project method and its (optional) parameter. The method is executed when the macro is called. You can pass a parameter in the form ("param1;param2;..."). This parameter will be received in the method using the variables $1, $2, etc. For additional information about this tag, refer to the "About the <code>&lt;method></code> Tag" section below.<tr><td><code>&lt;caret/></code><td>Location of the insertion point in the code after the macro has been inserted.<tr><td><code>&lt;user_4D/></code><td>Tag replaced by the name of the current 4D user.<tr><td><code>&lt;user_os/></code><td>Tag replaced by the current system user name.<tr><td><code>&lt;method_name/></code><td>Tag replaced by the current method name.<tr><td><code>&lt;method_path/></code><td>Tag replaced by path syntax (as returned by <a href=https://doc.4d.com/4dv19R/help/command/en/page1164.html target=_blank rel="noopener noreferrer"><code>METHOD Get path</code></a> of the current method.<tr><td><code>&lt;date/></code><td>Tag replaced by the current date.<tr><td><td><em>Attribute</em>:<tr><td><td>- format: 4D format used to display the date. If no format is set, the default format is used. Values = number of 4D format (0 to 8).<tr><td><code>&lt;time/></code><td>Tag replaced by the current time.<tr><td><td><em>Attribute</em>:<tr><td><td>- format: 4D format used to display the time. If no format is set, the default format is used. Values = number of 4D format (0 to 6).<tr><td><code>&lt;clipboard/></code><td>Tag replaced by the contents of the clipboard.<tr><td><td><em>Attribute</em>:<tr><td><td>- index: Clipboard to be pasted. Values = number of the clipboard (0 to 9).</table>
<ul>
<li>Macros can be called using the context menu of the Code Editor or using the type-ahead function (see the following section).</li>
<li>If you want to conform to XML language specifications, you must not use extended characters (accented characters, quotation marks, etc.).</li>
</ul>
<p>Here is an example of a macro definition:</p>

























































<table><thead><tr><th><strong>Content of macro</strong><th><strong>Comments</strong><tbody><tr><td><code>&lt;?xml version="1.0"...?></code><td>XML declaration<tr><td><code>&lt;!DOCTYPE macros SYSTEM></code><td>Document declaration<tr><td><code>&lt;macros></code><td>Start of macros XML file<tr><td><code>&lt;macro name="RecordLoop"></code><td>Start of macro definition and name<tr><td><code>&lt;text></code><td>Start of macro code<tr><td>For($i;1;Records in selection(<code>&lt;Selection/></code>))<td>The <code>&lt;Selection/></code> tag will be replaced by the selected code in the 4D method at the time of macro insertion (for instance, a table name)<tr><td>SAVE RECORD(<code>&lt;Selection/></code>)<td><tr><td>NEXT RECORD(<code>&lt;Selection/></code>)<td><tr><td>End for<td><tr><td><code>&lt;/text></code><td>End of macro code<tr><td><code>&lt;/macro></code><td>End of macro definition<tr><td><code>&lt;/macros></code><td>End of macros XML file</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=about-the-method-tag>About the <code>&lt;method></code> tag<a href=#about-the-method-tag class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>The <code>&lt;method></code> tag allows you to generate and use macro-commands that execute 4D project methods. This allows developers to create sophisticated functions that can be distributed via macro-commands which are associated with components. For example, the following macro will cause the <em>MyMethod</em> method to be executed with the name of the current method as parameter:</p>
<p><code>&lt;method>MyMethod("&lt;method_name/>")&lt;/method></code></p>
<p>The code of a called method is executed in a new process. This process is killed once the method is executed.</p>
<blockquote>
<p>The structure process remains frozen until the called method execution is completed. You must make sure that the execution is quick and that there is no risk of it blocking the application. If this occurs, use the <strong>Ctrl+F8</strong> (Windows) or <strong>Command+F8</strong> (Mac OS) command to "kill" the process.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=calling-macros>Calling macros<a href=#calling-macros class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>By default, macros can be called using the context menu or toolbar of the Code Editor, the autocomplete function, or a specific list at the bottom of the Code Editor window.</p>
<p>Note that for each macro it is possible to restrict the possibility of calling it using the context menu and/or the autocomplete function.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=context-menu-and-toolbar>Context menu and toolbar<a href=#context-menu-and-toolbar class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>By default, all macros can be called via the context menu of the Code Editor (using the <strong>Insert macro</strong> hierarchical command) or the <strong>Macros</strong> button of the toolbar.</p>
<p>The <em>in_menu</em> attribute of the <code>&lt;macro></code> tag is used to set whether or not the macro appears in this menu.</p>
<p>In the context menu, macros are displayed in the order of the "Macros.xml" file and any additional XML files. It is thus possible to change the order by modifying these files.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=autocomplete>Autocomplete<a href=#autocomplete class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>By default, all macros are accessible using the autocomplete (aka type-ahead) function (see <a href=/docs/20/code-editor/write-class-method>Writing a method</a>). The <em>type_ahead</em> attribute of the <code>&lt;macro></code> tag can be used to exclude a macro from this type of operation.</p>
<p><strong>Note:</strong> If the macro contains the <code>&lt;selection/></code> tag, it will not appear in the autocomplete pop-up window.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=code-editor-list>Code Editor list<a href=#code-editor-list class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>You can display your macros in a list of the Code Editor (see <a href=/docs/20/code-editor/write-class-method>Writing a method</a>). Simply double-click on the name of a macro in the list in order to call it. It is not possible to exclude a specific macro from this list.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=compatibility-notes>Compatibility notes<a href=#compatibility-notes class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Macro support can change from one version of 4D to another. In order to keep the different versions compatible while maintaining your customizations, 4D does not remove any previous versions. If you want to use the latest features available, you must adapt your version accordingly.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=text-selection-variables-for-methods>Text selection variables for methods<a href=#text-selection-variables-for-methods class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>It is recommended to manage text selections using the <a href=https://doc.4d.com/4dv19/help/command/en/page997.html target=_blank rel="noopener noreferrer">GET MACRO PARAMETER</a> and <a href=https://doc.4d.com/4dv19/help/command/en/page998.html target=_blank rel="noopener noreferrer">SET MACRO PARAMETER</a> commands. These commands can be used to overcome the partitioning of the host project/component execution spaces and thus allow the creation of components dedicated to the management of macros. In order to activate this mode for a macro, you must declare the Version attribute with the value 2 in the Macro element. In this case, 4D no longer manages the predefined variables _textSel,_textReplace, etc. and the <a href=https://doc.4d.com/4dv19/help/command/en/page997.html target=_blank rel="noopener noreferrer">GET MACRO PARAMETER</a> and <a href=https://doc.4d.com/4dv19/help/command/en/page998.html target=_blank rel="noopener noreferrer">SET MACRO PARAMETER</a> commands are used. This attribute must be declared as follows:</p>
<p><code>&lt;macro name="MyMacro" version="2"></code><br>
<code>--- Text of the macro ---</code><br>
<code>&lt;/macro></code></p>
<p>If you do not pass this attribute, the previous mode is kept.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=incompatibilities-related-to-the-xml-standard>Incompatibilities related to the XML standard<a href=#incompatibilities-related-to-the-xml-standard class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>Strict syntax rules must be observed in order for macros files to respect the XML standard. This may lead to incompatibilities with the code of macros created with previous versions and prevent the loading of XML files. The following are the main sources of malfunctioning:</p>
<ul>
<li>Comments of the "// my comment" type, allowed inside <code>&lt;macro></code> elements in previous versions of 4D, are not compatible with the XML syntax. The lines of comments must respect the standard <code>"&lt;!-- my comment -->"</code> form.</li>
<li>The <code>&lt;></code> symbols used more particularly for interprocess object names must be encoded. For example, the <code>&lt;>params</code> variable must be written <code>&amp;lt;>params</code>.</li>
<li>The initial <code>&lt;macros></code> declaration tag could be omitted in previous versions of 4D. It is now mandatory; otherwise, the file will not be loaded.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20code-editor%2Fcreating-using-macros.md%20(20)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Comment on this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/20/code-editor/write-class-method><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Code Editor</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/20/Tags/tags><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Transformation tags</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#what-is-a-macro class="table-of-contents__link toc-highlight">What is a macro?</a><li><a href=#location-of-macros class="table-of-contents__link toc-highlight">Location of macros</a><li><a href=#default-macros class="table-of-contents__link toc-highlight">Default macros</a><li><a href=#adding-customized-macros class="table-of-contents__link toc-highlight">Adding customized macros</a><ul><li><a href=#checking-the-syntax-of-customized-macros class="table-of-contents__link toc-highlight">Checking the syntax of customized macros</a></ul><li><a href=#syntax-of-4d-macros class="table-of-contents__link toc-highlight">Syntax of 4D macros</a><li><a href=#about-the-method-tag class="table-of-contents__link toc-highlight">About the <code>&lt;method></code> tag</a><li><a href=#calling-macros class="table-of-contents__link toc-highlight">Calling macros</a><ul><li><a href=#context-menu-and-toolbar class="table-of-contents__link toc-highlight">Context menu and toolbar</a><li><a href=#autocomplete class="table-of-contents__link toc-highlight">Autocomplete</a><li><a href=#code-editor-list class="table-of-contents__link toc-highlight">Code Editor list</a></ul><li><a href=#compatibility-notes class="table-of-contents__link toc-highlight">Compatibility notes</a><ul><li><a href=#text-selection-variables-for-methods class="table-of-contents__link toc-highlight">Text selection variables for methods</a><li><a href=#incompatibilities-related-to-the-xml-standard class="table-of-contents__link toc-highlight">Incompatibilities related to the XML standard</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://developer.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Developer Center</a><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://twitter.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="col footer__col"><div class=footer__title>Support</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (Where It All Began)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Knowledgebase</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>Downloads<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>Get Support<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Company</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>About 4D<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>Contact us<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>4D around the world<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Careers<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>© 2024 4D SAS - All rights reserved</div></div></div></footer></div>