---
id: wp-export-variable
title: WP EXPORT VARIABLE
slug: /WritePro/commands/wp-export-variable
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT VARIABLE.Syntax-->**WP EXPORT VARIABLE** ( *docWP* ; *destino* ; *formato* {; *opcion*} )<!-- END REF-->
<!--REF #_command_.WP EXPORT VARIABLE.Params-->
| Parámetro | Tipo |  | Descripción |
| --- | --- | --- | --- |
| docWP | Object | &#8594;  | Variable 4D Write Pro |
| destino | Variable texto, BLOB variable | &#x1F858; | Variable a recibir contenidos exportados |
| formato | Integer | &#8594;  | Formato de salida de la variable |
| opcion | Object, Integer | &#8594;  | Opciones de exportación |

<!-- END REF-->

#### Descripción 

<!--REF #_command_.WP EXPORT VARIABLE.Summary-->El comando **WP EXPORT VARIABLE** exporta el objeto 4D Write Pro *docWP* en la variable 4D *destino* con el *format* *o* especificado.<!-- END REF-->

En *docWP*, pase el objeto 4D Write Pro que desea exportar.

En *destino*, pase la variable texto que desea llenar con el objeto 4D Write Pro exportado. El tipo de esta variable depende del formato de exportación especificado en el parámetro de *formato*:

* Si pasa el formato .4wp nativo o el formato .docx, la variable será de tipo Blob,
* Si pasa un formato HTML o SVG, la variable será de tipo Texto.

En el parámetro *format* *o*, pase una constante del tema *Constantes 4D Write Pro* definiendo el formato de exportación que desea utilizar. Cada formato se relaciona con un uso específico. Los siguientes formatos son soportados:

| Constante           | Tipo         | Valor | Comentario                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------- | ------------ | ----- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| wk 4wp              | Entero largo | 4     | El documento 4D Write Pro se guarda en un formato de archivo nativo (HTML comprimido con imágenes almacenadas en una carpeta separada). Las expresiones 4D no se calculan y las etiquetas 4D especificas se incluyen. <br/>Este formato es especialmente adecuado para guardar y archivar documentos 4D Write Pro en el disco sin ninguna pérdida.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk docx             | Entero largo | 7     | Extensión .docx. El documento 4D Write Pro se guarda en formato Microsoft Word (certificado para Microsoft Word 2010 y posteriores). <br/> <br/>Las partes del documento exportadas son: Cuerpo / encabezados / pies de página / secciones Configuración de página / impresión (márgenes, color / imagen de fondo, bordes, relleno, tamaño / orientación del papel) Imágenes: patrón en línea, anclado y de fondo (definido con wk background image) Variables y expresiones compatibles (número de página, número de páginas, fecha, hora, metadatos). Las variables y expresiones no compatibles se evaluarán y congelarán antes de la exportación. Marcadores Tenga en cuenta que algunas configuraciones de 4D Write Pro pueden no estar disponibles o pueden comportarse de manera diferente en Microsoft Word. |
| wk mime html        | Entero largo | 1     | El documento 4D Write Pro se guarda como MIME HTML con documentos los documentos html y las imágenes embebidas como partes MIME (codificado en base 64). Las expresiones se calculan ylas etiquetas  4D específicas se eliminan. Este formato es especialmente adecuado para el envío de mensajes de correo electrónico HTML con el comando .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wk pdf              | Entero largo | 5     | Extensión .pdf. El documento 4D Write Pro se guarda en formato PDF, en función del modo de vista Página. Los siguientes metadatos se exportan en un documento PDF: Título Autor Asunto Creador de contenido **Notas**: Las expresiones se congelan automáticamente cuando se exporta el documento Los enlaces a los métodos NO se exportan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk svg              | Entero largo | 8     | La página del documento 4D Write Pro se guarda en formato SVG, según el modo de vista Página. **Nota**: al exportar a SVG, sólo puede exportar una página a la vez. Utilice el botón wk page index para especificar la página a exportar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| wk web page html 4D | Entero largo | 3     | El documento 4D Write Pro se guarda como HTML e incluye las etiquetas 4D específicas; cada expresión se inserta como un espacio de no separación. Dado que este formato es sin pérdidas, es apropiado para el almacenamiento en un campo texto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

**Notas:**

* "Etiquetas 4D específicas" designa el XHTML 4D con un namespace y estilos CSS 4D.
* Para más información sobre el formato de documento 4D Write Pro, consulte *Formato del documento .4wp*.
* Para ver una lista de diferencias conocidas o incompatibilidad al usar el formato .docx, consulte *Importar y Exportar al formato .docx*.
* Al exportar al formato SVG con este comando, las imágenes se anidan en formato base64.
* Para más información sobre la exportación al formato SVG, consulte *Exportar a formato SVG*.

##### Parámetro opcion 

Pase un [objeto](# "Datos estructurados como forma de objeto nativo 4D") en la *opcion* que contiene los valores para definir las propiedades del documento exportado. Las siguientes propiedades están disponibles:

| Constante                                   | Valor              | Comentario                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------------------------------------------- | ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nombre de dominio host CID: dominio de host que se agregará a las URLs CID generadas, incluida una '@' como separador. Disponible solo cuando se utiliza el formato wk mime html.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk embedded pictures                        | embeddedPictures   | Sólo para la exportación SVG. Define si las imágenes se anidan en el archivo .svg exportado cuando se llama a [WP EXPORT DOCUMENT](wp-export-document.md). Valores disponibles: true (por defecto): las imágenes se anidan en el archivo .svg exportado false: las imágenes se exportan en una carpeta llamada "filename\_images" al nivel del archivo .svg exportado, siendo "filename" el nombre pasado al comando para el archivo, sin la extensión. Las imágenes no están anidadas, sino referenciadas en el archivo .svg. Tenga en cuenta que: Si la carpeta ya existe, se vacía antes de exportar el archivo Si no hay ninguna imagen en la página exportada, la carpeta se borra                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk google fonts tag                         | googleFontsTag     | Sólo para la exportación SVG. Define la regla de importación para las fuentes de Google en el SVG exportado. Valores posibles: false (por defecto): no se añade ninguna regla de importación de Google fonts. true: añade la regla de @importación al archivo exportado. Es útil si quiere utilizar fuentes que no están disponibles por defecto en Windows o macOS. **Nota:** esta propiedad está definida como falsa por defecto porque cuando está activa, las fuentes de Google anulan las fuentes nativas, y las fuentes nativas generalmente se renderizan mejor en el navegador.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk HTML pretty print                        | htmlPrettyPrint    | El código HTML está formateado para facilitar su lectura.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| wk max picture DPI                          | maxPictureDPI      | Se utiliza para volver reajustar (reducir) las imágenes a la resolución preferida. Para imágenes SVG en Windows, utilizadas para rasterización. Valores predeterminados: 300 (for wk optimized for \= wk print) 192 (for wk optimized for \= wk screen) Valor máximo posible: 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| wk optimized for                            | optimizedFor       | Define cómo se optimiza un documento exportado según su soporte. Valores posibles: wk print (valor predeterminado para wk pdf y wk svg) Las imágenes mapa de bits pueden reducirse utilizando el DPI definido por wk max picture DPI o 300 (valor predeterminado) y pueden convertirse a PNG si el códec no es compatible con el tipo de exportación. Las imágenes vectoriales se convierten a PNG utilizando el DPI definido por wk max picture DPI o 300 (Windows únicamente) Si una imagen contiene más de un formato, se utiliza el mejor formato para imprimir (por ejemplo, .tiff o .jpg) wk screen (valor predeterminado para wk web page complete y wk mime html) Las imágenes mapa de bits pueden reducirse utilizando el DPI definido por wk max picture DPI o 192 (valor predeterminado) y pueden convertirse a JPEG (imágenes opacas) o PNG (imágenes transparentes) si el códec no es soportado por el tipo de exportación. Las imágenes vectoriales se convierten a PNG utilizando el DPI definido por wk max picture DPI o 192 (Windows únicamente) Si una imagen contiene más de un formato, se utilizará el mejor formato para la representación en pantalla Nota: los documentos exportados en formato wk docx siempre se optimizan para wk print (se ignora la opción wk optimized for). |
| wk page index                               | pageIndex          | Sólo para la exportación SVG. Índice de la página a exportar a formato svg (por defecto es 1). El índice de la página comienza en 1 para la primera página del documento. <br/>**Nota**: el índice de páginas es independiente de la numeración de páginas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk pdfa version                             | pdfaVersion        | Exporta PDF conforme a una versión PDF/A. Para más información sobre las propiedades y versiones de PDF/A, consulte la [página PDF/A en Wikipedia](https://en.wikipedia.org/wiki/PDF/A). Valores posibles: wk pdfa2: exporta a la versión "PDF/A-2" wk pdfa3: exporta a la versión "PDF/A-3" **Nota:** en macOS, wk pdfa2 puede exportar a PDF/A-2 o PDF/A-3 o superior, dependiendo de la implementación de la plataforma. Además, wk pdfa3 significa "exporta al menos a PDF/A-3". En Windows, el archivo PDF de salida siempre será igual a la conformidad deseada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk recompute formulas                       | recomputeFormulas  | Define si las fórmulas deben recalcularse cuando se exportan. Valores posibles: true - Valor por defecto. Todas las fórmulas son recalculadas false- No recalcula las fórmulas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk visible background and anchored elements | visibleBackground  | Muestra o exporta imágenes/color de fondo, imágenes ancladas y cajas de texto (para visualización, efecto visible solo en el modo de vista de página o anidado). Valores posibles: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk visible empty images                     | visibleEmptyImages | Muestra o exporta un rectángulo negro por defecto para las imágenes que no pueden ser cargadas o calculadas (imágenes vacías o en un formato no soportado). Valores posibles: True/False. Valor por defecto: True Si el valor es False, los elementos imagen que falten no se mostrarán en absoluto aunque tengan bordes, ancho, alto o fondo; esto puede afectar al diseño de la página para las imágenes en línea.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wk visible footers                          | visibleFooters     | Muestra los pies de página (efecto visible solo en el modo de visualización de página). Valores posibles: Verdadero/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| wk visible headers                          | visibleHeaders     | Muestra los encabezados (efecto visible solo en el modo de visualización de página). Valores posibles: Verdadero/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk visible references                       | visibleReferences  | Muestra todas las expresiones 4D insertadas en el documento como referencias. Valores posibles: Verdadero/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

La siguiente tabla indica la *opcion* disponible por *formato* de exportación:

| |  **wk 4wp**                                            | **wk docx**                                                                    | **wk mime html**                                                              | **wk pdf**                                                                                      | **wk web page html 4D**                                                        | **wk svg**                                                                     |                                                                                                |
| -------------------------------------------------------- | ------------------------------------------------------------------------------ | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------- |
| wk CID host domain name<br/>                     | \-                                                                             | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.EN.png)                                       | \-                                                                             | \-                                                                             |                                                                                                |
| wk HTML pretty print<br/>                        | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: false) | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: False)                  | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: False) | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: False) | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: False)                 |
| wk max picture DPI<br/>                          | \-                                                                             | siempre 300                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.EN.png)                                       | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: 300)   | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: 300)                   |
| wk optimized for<br/>                            | \-                                                                             | siempre wk print                                                              | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto:wk screen) <br/> | siempre wk print                                                               | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto:wk print) <br/> |
| wk recompute formulas<br/>                       | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true) | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                   | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)  | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                  |
| wk visible background and anchored elements<br/> | \-                                                                             | siempre true                                                                  | siempre true                                                                                    | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)  | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                  |
| wk visible footers<br/>                          | \-                                                                             | siempre true                                                                  | siempre false                                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)  | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                  |
| wk visible headers<br/>                          | \-                                                                             | siempre true                                                                  | siempre false                                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)  | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                  |
| wk visible empty images<br/>                     | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true) | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                   | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)  | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: true)                  |
| wk visible references<br/>                       | \-                                                                             | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: false) | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: false)                 |
| wk pdfa version<br/>                             | \-                                                                             | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.EN.png)                      | \-                                                                             | \-                                                                                             |
| wk page index<br/>                               | \-                                                                             | \-                                                                            | \-                                                                                              | \-                                                                             | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: 1)                     |
| wk factur x<br/>                                 | \-                                                                             | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.es.png)                      | \-                                                                             | \-                                                                                             |
| wk files<br/>                                    | \-                                                                             | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.es.png)                      | \-                                                                             | \-                                                                                             |
| wk embedded pictures<br/>                        | \-                                                                             | \-                                                                            | \-                                                                                              | \-                                                                             | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png)(por defecto: true)                   |
| wk google fonts tag<br/>                         | \-                                                                             | \-                                                                            | \-                                                                                              | \-                                                                             | \-                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.EN.png) (por defecto: false)                 |

**Nota de compatibilidad**: pasar un valor de tipo *entero largo* en *opcion* es soportado por razones de compatibilidad, pero se recomienda utilizar un parámetro [objeto](# "Datos estructurados como forma de objeto nativo 4D").

#### Ejemplo 1 

Desea exportar el contenido del objeto 4D Write Pro *myArea* al formato MIME y agregar "gmail.com" como dominio host:

```4d
 var $option : Object
 
 $option[wk CID host domain name]:="gmail.com"
 
 WP EXPORT VARIABLE(myArea;$export;wk mime html;$option)
```

#### Ejemplo 2 

Usted quiere enviar un correo electrónico con texto con estilo, referencias 4D e imágenes. Puede utilizar un área 4D Write Pro exportada al formato MIME y enviarla utilizando SMTP:

```4d
  // create the transporter
 $server:=New object
 $server.host:="smtp.gmail.com"
 $server.port:=465
 $server.user:="4D@gmail.com"
 $server.password:="XXXX"
 
 $transporter:=SMTP New transporter($server)
 
 WP EXPORT VARIABLE(WParea;$mime;wk mime html)
 
 $mailTmp:=MAIL Convert from MIME($mime)
 
  // añadir imágenes (si las hay)
 If($mailTmp.attachments#Null)
    $email.attachments:=$mailTmp.attachments
 End if
 
 $email.bodyStructure:=$mailTmp.bodyStructure
 $email.bodyValues:=$mailTmp.bodyValues
 
 $status:=$transporter.send($email)
 If(Not($status.success))
    ALERT("An error occurred: "+$status.statusText)
 End if
```

#### Ejemplo 3 

Para exportar la primera página de un 4D Write Pro como SVG en una variable de texto y ocultar los encabezados: 

```4d
 var $options : Object
 var $destination : Text
 
 $options:=New object
 $options[wk optimized for]:=wk screen
 $options[wk visible headers]:=False
 WP EXPORT VARIABLE(WPArea;$destination;wk svg;$options)
```

#### Ver también 

  
  
  
 *Exportación a formatos HTML y MIME HTML*  
*Importar y Exportar al formato .docx*  
[WP EXPORT DOCUMENT](wp-export-document.md)  