---
id: wp-export-variable
title: WP EXPORT VARIABLE
slug: /WritePro/commands/wp-export-variable
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT VARIABLE.Syntax-->**WP EXPORT VARIABLE** ( *wpDoc* ; *destination* ; *format* {; *option*} )<!-- END REF-->

<!--REF #_command_.WP EXPORT VARIABLE.Params-->

| Parámetros  | Tipo            |                             | Descripción                                     |
| ----------- | --------------- | --------------------------- | ----------------------------------------------- |
| wpDoc       | Object          | &#8594; | Variable 4D Write Pro                           |
| destination | Text, Blob      | &#8594; | Variable para recibir los contenidos exportados |
| format      | Integer         | &#8594; | Formato de salida variable                      |
| option      | Object, Integer | &#8594; | Opciones de exportación                         |

<!-- END REF-->

## Descripción

<!--REF #_command_.WP EXPORT VARIABLE.Summary-->The **WP EXPORT VARIABLE** command exports the *wpDoc* 4D Write Pro object to the 4D *destination* variable in the specified *format*.<!-- END REF-->

En *wpDoc*, pase el objeto 4D Write Pro que desea exportar.

In *destination*, pass the variable that you want to fill with the exported 4D Write Pro object. The type of this variable depends on the export format specified in the *format* parameter:

- If you pass the native .4wp format or the .docx format, the variable will be of the Blob type,
- If you pass an HTML or SVG format, the variable will be of the Text type.

In the *format* parameter, pass a constant from the *4D Write Pro Constants* theme to set the export format you want to use. Cada formato está relacionado con un uso específico. Se soportan los siguientes formatos:

| Constante           | Tipo    | Valor | Comentario                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------------------- | ------- | ----- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk 4wp              | Integer | 4     | El documento 4D Write Pro se guarda en un formato de archivo nativo (HTML comprimido e imágenes guardadas en una carpeta separada). Se incluyen las etiquetas específicas 4D y no se calculan las expresiones 4D. Este formato es especialmente adecuado para guardar y archivar documentos 4D Write Pro en disco sin pérdida alguna.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk docx             | Integer | 7     | Extensión .docx. El documento 4D Write Pro se guarda en formato Microsoft Word. Compatibilidad certificada con Microsoft Word 2010 y versiones posteriores. <br/> <br/>Las partes del documento exportadas son: <br/>Cuerpo / encabezados / pies de página / seccionesPágina / configuración de impresión (márgenes, color de fondo / imagen, bordes, relleno, tamaño de papel / orientación)Imágenes - en línea, ancladas, y patrón de imagen de fondo (definido con wk background image)Variables y expresiones compatibles (número de página, número de páginas, fecha, hora, metadatos). Las variables y expresiones no compatibles serán evaluadas y congeladas antes de export.Links -<br/>BookkmarksURLsNote que algunos ajustes de 4D Write Pro pueden no estar disponibles o comportarse de forma diferente en Microsoft Word. |
| wk mime html        | Integer | 1     | El documento 4D Write Pro se guarda como HTML MIME estándar con documentos HTML e imágenes anidadas como partes MIME (codificadas en base64). Se calculan las expresiones y se eliminan las etiquetas específicas de 4D y los enlaces de métodos. Sólo se exportan los cuadros de texto anclados a la vista incrustada (como divs). Este formato es especialmente adecuado para enviar correos electrónicos HTML con el comando.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk pdf              | Integer | 5     | Extensión .pdf. El documento 4D Write Pro se guarda en formato PDF, según el modo vista Página. Los siguientes metadatos se exportan en un documento PDF: Título Autor Asunto Creador del contenido **Notas**: Las expresiones se congelan automáticamente al exportar el documento Los enlaces a métodos NO se exportan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk svg              | Integer | 8     | La página del documento 4D Write Pro se guarda en formato SVG, según el modo vista Página. **Nota:** al exportar a SVG, sólo puede exportar una página cada vez. Utilice el wk page index para especificar qué página exportar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk web page html 4D | Integer | 3     | 4D Write Pro document is saved as HTML and includes 4D specific tags; each expression is inserted as a non-breaking space. Since this format is lossless, it is appropriate for storing purposes in a text field.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

**Notas:**

- "Etiquetas específicas 4D" significa XHTML 4D con un espacio de nombres 4D y estilos CSS 4D.
- Para más información sobre el formato de documento 4D Write Pro, consulte el [formato del documento .4wp](https://doc.4d.com/4Dv20/4D/20/Using-a-4D-Write-Pro-area.200-6229460.en.html#2895813).
- Para ver una lista de las diferencias o incompatibilidades conocidas al utilizar el formato .docx, consulte [Importación y exportación en formato .docx](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html).
- When exporting to SVG format with this command, images are embedded in base64 format.
- For more information on exporting to SVG format, see [Exporting to SVG format](https://doc.4d.com/4Dv20/4D/20/Exporting-to-SVG-format.200-6229468.en.html).

### Parámetro option

Pase un [objeto](# "Datos estructurados como un objeto nativo 4D") en *option* conteniendo los valores para definir las propiedades del documento exportado. Las siguientes propiedades están disponibles:

| Constante                                   | Valor              | Comentario                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------- | ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nombre de dominio de host CID: dominio de host que se añadirá a las URL CID generadas incluyendo una "@" como separador. Disponible sólo cuando se utiliza el formato `wk mime html`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk embedded pictures                        | embeddedPictures   | Sólo para exportación SVG. Establece si las imágenes se incrustan en el archivo .svg exportado cuando se llama a [WP EXPORT DOCUMENT](wp-export-document.md). Available values: <li>true (default): Pictures are embedded in the exported .svg file</li><li>false: Pictures are exported in a folder called "filename\_images" at the level of the exported .svg file, "filename" being the name passed to the command for the file, without the extension. The pictures are not embedded, but referenced in the .svg file.</li>Note: If the folder already exists, it is emptied before the file is exported. If there is no image on the exported page, the folder is deleted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk factur x                                 | facturX            | Sólo para exportación en PDF. Value: object configuring a "Factur-X (ZUGFeRD)" PDF export (see [wk factur x object](./wp-export-document.md#wk-factur-x-object)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk files                                    | Histórico          | Sólo para exportación en PDF. Valor: colección de objetos, cada uno de los cuales describe un archivo que se integrará en el documento final (ver [wk files collection](./wp-export-document.md#wk-files-collection)). Esta funcionalidad sólo se admite en documentos PDF/A-3: cuando se utiliza el atributo `wk files`, se establece automáticamente la versión "PDF/A-3" (se ignora el atributo `wk pdfa version`). In case of a Factur-X PDF export (see below), the first object of the collection must contain the Factur-X xml file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk google fonts tag                         | googleFontsTag     | Sólo para exportación SVG. Sets the import rule for google fonts in the exported SVG. Possible values: <li>false (default): No google fonts import rule is added.</li><li>true: Adds the @import rule to the exported file. Useful if you want to use fonts that are not available by default on Windows or macOS.</li> **Note:** This property is set to false by default because when enabled, Google fonts override native fonts, and native fonts are generally better rendered in the browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| wk HTML pretty print                        | htmlPrettyPrint    | El código HTML está formateado para facilitar su lectura.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk max picture DPI                          | maxPictureDPI      | Se utiliza para reducir imágenes a la resolución preferida. For SVG images in Windows, used for rasterization. Default values: 300 (for wk optimized for \= wk print) 192 (for wk optimized for \= wk screen) Maximum possible value: 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk optimized for                            | optimizedFor       | Defines how an exported document is optimized based on its intended medium. Valores posibles:<li> `wk print` (valor por defecto para `wk pdf` y `wk svg`) Las imágenes de mapa de bits pueden reducirse utilizando los PPP definidos por `wk max picture DPI` o 300 (valor por defecto) y pueden convertirse a PNG si el códec no es compatible con el tipo de exportación. Las imágenes vectoriales se convierten a PNG utilizando los PPP definidos por `wk max picture DPI` o 300 (sólo Windows). If a picture contains more than one format, the best format for printing is used (*e.g.*, .tiff instead or .jpg)</li><li>`wk screen` (default value for `wk web page complete` and `wk mime html`). Bitmap pictures may be downscaled using the DPI defined by `wk max picture DPI` or 192 (default value) and may be converted to JPEG (opaque images) or PNG (transparent images) if codec is not supported for the export type. Vectorial pictures are converted to PNG using the DPI defined by `wk max picture DPI` or 192 (Windows only). If a picture contains more than one format, the format for screen rendering is used.</li> **Note:** Documents exported in `wk docx` format are always optimized for wk print (wk optimized for option is ignored). |
| wk page index                               | pageIndex          | Sólo para exportación SVG. Índice de la página a exportar a formato svg (por defecto es 1). El índice de páginas comienza en 1 para la primera página del documento. **Nota:** el índice de páginas es independiente de la numeración de páginas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk pdfa version                             | pdfaVersion        | Exporta PDF conforme a una versión PDF/A. For more information on PDF/A properties and versions, please refer to the [PDF/A page on Wikipedia](https://en.wikipedia.org/wiki/PDF/A). Possible values: <li>`wk pdfa2`: Exports to version "PDF/A-2"</li><li> `wk pdfa3`: Exports to version "PDF/A-3"<li> **Note:** On macOS, `wk pdfa2` may export to PDF/A-2 or PDF/A-3 or higher, depending on platform implementation. Además, `wk pdfa3` significa "exporta a *al menos* PDF/A-3". On Windows, the output PDF file will always be equal to the desired conformance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk recompute formulas                       | recomputeFormulas  | Defines if formulas must be recomputed when exported. Valores posibles:<li>true - Valor por defecto. All formulas are recomputed</li><li>false - Do not recompute formulas </li>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk visible background and anchored elements | visibleBackground  | Displays or exports background images/color, anchored images and text boxes (for display, visible effect in Page or Embedded view mode only). Valores posibles: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk visible empty images                     | visibleEmptyImages | Displays or exports a default black rectangle for images that cannot be loaded or computed (empty images or images in an unsupported format). Valores posibles: True/False. Default value: True If value is False, missing image elements will not be displayed at all even if they have borders, width, height, or background; this may impact the page layout for inline images.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| wk visible footers                          | visibleFooters     | Displays or exports the footers (for display, visible effect in Page view mode only). Valores posibles: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| wk visible headers                          | visibleHeaders     | Displays or exports the headers (for display, visible effect in Page view mode only). Valores posibles: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| wk visible references                       | visibleReferences  | Displays or exports all 4D expressions inserted in the document as references. Valores posibles: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk whitespace                               | whitespace         | Sets the "white-space" css value for `wk mime html` export format. The [white-space css style](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space) is applied to paragraphs. Possible values: "normal", "nowrap", "pre", "pre-wrap" (default), "pre-line", "break-spaces".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

The following table indicates the *option* available per export *format*:

|                                             | **wk 4wp**                                                                                                        | **wk docx**                                                                                                      | **wk mime html**                                                                                                       | **wk pdf**                                                                                                        | **wk web page html 4d**                                                                                           | **wk svg**                                                                                                           |
| ------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | \-                                                                                                               | \-                                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                              | \-                                                                                                               | \-                                                                                                               | \-                                                                                                                  |
| wk embedded pictures                        | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | \-                                                                                                               | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk factur x                                 | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | \-                                                                                                               | \-                                                                                                                  |
| wk files                                    | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | \-                                                                                                               | \-                                                                                                                  |
| wk google fonts tag                         | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | \-                                                                                                               | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: false)    |
| wk HTML pretty print                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: false) | \-                                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: False)      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: false)    |
| wk max picture DPI                          | \-                                                                                                               | siempre 300                                                                                                      | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: 300)   | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: 300)      |
| wk optimized for                            | \-                                                                                                               | always wk print                                                                                                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: wk screen)  | always wk print                                                                                                   | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: wk print) |
| wk page index                               | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | \-                                                                                                               | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: 1)        |
| wk pdfa version                             | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | \-                                                                                                               | \-                                                                                                                  |
| wk recompute formulas                       | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk visible background and anchored elements | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true) | siempre true                                                                                                           | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk visible empty images                     | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk visible footers                          | \-                                                                                                               | siempre true                                                                                                     | siempre false                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk visible headers                          | \-                                                                                                               | siempre true                                                                                                     | siempre false                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: true)     |
| wk visible references                       | \-                                                                                                               | \-                                                                                                              | \-                                                                                                                    | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: false) | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: false)    |
| wk whitespace                               | \-                                                                                                               | \-                                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (por defecto: "pre-wrap") | \-                                                                                                               | \-                                                                                                               | \-                                                                                                                  |

**Nota de compatibilidad:** pasar un valor *largo* en *longint* es compatible por razones de compatibilidad, pero se recomienda usar un parámetro [objeto](# "Datos estructurados como un objeto nativo 4D").

## Ejemplo 1

You want to export the contents of the *myArea* 4D Write Pro object in MIME format and add "gmail.com" as the host domain:

```4d
 var $option;$export : Object
 
 $option[wk CID host domain name]:="gmail.com"
 
 WP EXPORT VARIABLE(myArea;$export;wk mime html;$option)
```

## Ejemplo 2

You want to send an email containing styled text, 4D references and images. You can use a 4D Write Pro area exported in MIME format and sent using SMTP:

```4d
  // crea el transportador
 $server:=New object
 $server.host:="smtp.gmail. om"
 $server.port:=465
 $server.user:="4D@gmail.com"
 $server. assword:="XXX"
 
 $transporter:=SMTP New transporter($server)
 
 WP EXPORT VARIABLE(WParea;$mime;wk mime html)
 
 $mailTmp:=MAIL Convert from MIME($mime)
 
  // añadir imágenes (si las hay)
 If($mailTmp.attachments#Null)
    $email.attachments:=$mailTmp.attachments
 End if
 
 $email.bodyStructure:=$mailTmp.bodyStructure
 $email.bodyValues:=$mailTmp.bodyValues
 
 $status:=$transporter.send($email)
 If(Not($status.success))
    ALERT("An error occurred: "+$status.statusText)
 End if
```

## Ejemplo 3

To export the first page of a 4D Write Pro as SVG in a Text variable and hide the headers:

```4d
 var $options : Object
 var $destination : Text
 
 $options:=New object
 $options[wk optimized for]:=wk screen
 $options[wk visible headers]:=False
 WP EXPORT VARIABLE(WPArea;$destination;wk svg;$options)
```

## Ver también

[4D QPDF (Component) - PDF Get attachments](https://github.com/4d/4D-QPDF)\
[Blog post - 4D Write Pro: Electronic invoice generation](https://blog.4d.com/4d-write-pro-electronic-invoice-generation)\
[Blog post - 4D Write Pro: Export to PDF with enclosures](https://blog.4d.com/4d-write-pro-export-to-pdf-with-enclosures)\
[Exporting to HTML and MIME HTML formats](https://doc.4d.com/4Dv20/4D/20/Exporting-to-HTML-and-MIME-HTML-formats.200-6229467.en.html)<br/>
[Importing and Exporting in .docx format](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html)<br/>
[WP EXPORT DOCUMENT](../commands/wp-export-document.md)