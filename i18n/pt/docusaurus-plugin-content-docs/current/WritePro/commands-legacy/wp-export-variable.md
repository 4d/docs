---
id: wp-export-variable
title: WP EXPORT VARIABLE
slug: /WritePro/commands/wp-export-variable
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT VARIABLE.Syntax-->**WP EXPORT VARIABLE** ( *docWP* ; *destino* ; *formato* {; *opcoes*} )<!-- END REF-->
<!--REF #_command_.WP EXPORT VARIABLE.Params-->
| Parâmetro | Tipo |  | Descrição |
| --- | --- | --- | --- |
| docWP | Object | &#8594;  | Variável 4D Write Pro |
| destino | Variável texto, BLOB variável | &#x1F858; | Variável a receber conteúdos exportados |
| formato | Integer | &#8594;  | Formato de saída da variável |
| opcoes | Object, Integer | &#8594;  | Opções de exportação |

<!-- END REF-->

#### Descrição 

<!--REF #_command_.WP EXPORT VARIABLE.Summary-->O comando **WP EXPORT VARIABLE** exporta o objeto 4D Write Pro *docWP* na variável 4D *destino* com o *format* *o* especificado.<!-- END REF-->

Em *docWP*, passe o objeto 4D Write Pro que quiser exportar.

Em *destino*, passe a variável texto que quiser preencher com o objeto 4D Write Pro exportado. O tipo desta variável depende de formato de exportação especificado no parâmetro de *formato*:

* Se passar o formato .4wp nativo ou o formato .docx, a variável será de tipo Blob,
* Se passar um formato HTML ou SVG, a variável será de tipo Texto.

No parâmetro *format* *o*, passe uma constante de tema *Constantes 4D Write Pro* definindo o formato de exportação que quiser utilizar. Cada formato se relaciona com um uso específico. Os formatos abaixo são compatíveis:

| Constante           | Tipo          | Valor | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------- | ------------- | ----- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk 4wp              | Inteiro longo | 4     | O documento 4D Write Pro é salvado em um formato de arquivo nativo (HTML zipado e imagens salvadas em uma pasta separada). Etiquetas 4D específicas são incluídas e expressões 4D não são computadas. Este formato é particularmente adequado para salvar e arquivar documentos 4D Write Pro em disco sem nenhuma perda.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk docx             | Inteiro longo | 7     | a extensão .docx de documentos 4D Write Pro é salvada no formato Microsoft Word. Compatibilidade certificada para Microsoft Word 2016 ou mais novo, Entretanto, também é compatível com qualquer versão que seja compatível com formatos .docx (por exemplo, Microsoft Word 2007). <br/> <br/>As partes do documento exportadas são: <br/>Corpo/cabeçalho/rodapés/seçõesPágina / configurações de impressão (margens, cor de fundo/i,agem/bordas/preenchimento/tamanho de papel/orientações)Imagens - inline, ancorada, e padrão de imagem de fundo (definido com wk background image)Variáveis compatíveis e expressões (número de página, número total de páginas, datas, hora, metadata). Variáveis não compatíveis e expressões serão avaliadas e congeladas antes de exportar.BookmarksNote que configurações 4D Write Pro podem não estar disponíveis ou podem se comportar diferente em Microsoft Word. |
| wk mime html        | Inteiro longo | 1     | O documento 4D Write Pro se guardam como MIME HTML com documentos os documentos html e as imagens embebidas como partes MIME (codificado em base 64). As expressões se calculam e as etiquetas 4D específicas se eliminam. Este formato é especialmente adequado para o envio de mensagens de email HTML com o comando .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk pdf              | Inteiro longo | 5     | Extensão .pdf. O documento 4D Write Pro se guarda em formato PDF, em função do modo de vista Página. Os seguintes metadados são exportados em um documento PDF: Título Autor Assunto Criador de conteúdo **Notas**: As expressõs se congelam automaticamente quando se exporta o documento Os links aos métodos NÃO são exportados                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk svg              | Inteiro longo | 8     | A página documento 4D Write Pro é salva em formato SVG, baseado em modo vista Página. **Nota:** Quando exportar a SVG, pode exportar só uma página por vez. Use wk page index para especificar que página a exportar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk web page html 4D | Inteiro longo | 3     | O documento 4D Write Pro se guarda como HTML e inclui as etiquetas 4D específicas; cada expressão se insere como um espaço de não separação. Dado que este formato é sem perdas, é apropriado para o armazenamento em um campo texto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**Notas:**

* "Etiquetas 4D específicas" designa o XHTML 4D com um namespace e estilos CSS 4D.
* Para saber mais sobre o formato de documento 4D Write Pro, consulte *formato de documento .4wp*.
* Para ver uma lista de diferenças conhecidas ou incompatibilidade ao usar o formato .docx, consulte *Exportar em formato .docx*.
* Quando exportar ao formato SVG com esse comando, imagens estão embebidas no formato base64.
* Para saber mais sobre exportar ao formato SVG, veja *Exportar para formato SVG*.

##### Parâmetro option 

Passe um [objeto](# "Estruturas de dados como objetos 4D nativos") na *opção* que contenha os valores para definir as propriedades de documento exportado. As propiedades abaixo estão disponíveis:

| Constante                                   | Valor              | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------------------------- | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nome de domínio host CID: domínio de host que se agregará às URLs CID geradas, incluída uma '@' como separador. Disponível apenas quando usar o formato wk mime html.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk embedded pictures                        | embeddedPictures   | Apenas SVG Export. Estabelece se as imagens são embebidas no arquivo .svg exportado quando chamar [WP EXPORT DOCUMENT](../commands/wp-export-document.md). Valores disponíveis: true (padrão): Imagens são embebidas no arquivo exportado .svg false: Imagens são exportadas em uma pasta chamada "filename\_images" no nível do arquivo exportado .svg, "nomearquivo" é o nome passado para o comando para o arquivo, sem extensão . As imagens não são embebidas, mas referenciadas no arquivo .svg. Note que: se a pasta já existir, é esvaziada antes que o arquivo seja exportado se não houver imagens na página exportada, a pasta é apagada                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk google fonts tag                         | googleFontsTag     | Apenas para exportar SVG. Estabelece a regra de importação para fontes googles em SVG exportado. Valores possíveis: false (padrão): Nenhuma regra de importação de fontes google é adicionada. true: Adiciona a regra @import para o arquivo exportado. Útil se quiser usar fontes que não estejam disponíveis como padrão em Windows ou macOS. **Nota:** Essa propriedade é estabelecida como falsa como padrão porque, quando ativado, fontes Google sobrepujam fontes nativa, e fontes nativas são geralmente melhor renderizadas no navegador.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| wk HTML pretty print                        | htmlPrettyPrint    | Código HTML é formatado para ser mais fácil de ler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk max picture DPI                          | maxPictureDPI      | Se utiliza para voltar a reajustar (reduzir) as imagens à resolução preferida. Para imagens SVG em Windows, utilizadas para rasterização (transformar uma imagem vetorial em píxels). Valores pré-determinados: 300 (para wk optimized for \= wk print) 192 (para wk optimized for \= wk screen) Valor máximo possível: 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk optimized for                            | optimizedFor       | Define como se otimiza um documento exportado segundo seu suporte. Valores possíveis: wk print (valor predeterminado para wk pdf) As imágens mapa de bits podem ser reduzidas utilizando o DPI definido por wk max picture DPI ou 300 (valor pré-determinado) e podem ser convertirdas a PNG se o códec não for compatível com o tipo de exportação. As imagens vetoriales são convertidas a PNG utilizando o DPI definido por wk max picture DPI ou 300 (Windows unicamente) Si una imagen contiene más de un formato, se utiliza el mejor formato para imprimir (por ejemplo, .tiff o .jpg) wk screen (valor pré-determinado para wk web page complete e wk mime html) As imagens mapa de bits podem ser reduzidas utilizando o DPI definido por wk max picture DPI ou 192 (valor predeterminado) e podem ser convertidas a JPEG (imagens opacas) ou PNG (imagenes transparentes) se o códec não for compatível pelo tipo de exportação As imagens vetoriais são convertidas a PNG utilizando o DPI definido por wk max picture DPI ou 192 (Windows unicamente) Se uma imagem contém mais de um formato, se utiliza o formato para o processamento de tela. |
| wk page index                               | pageIndex          | Apenas para SVG exporte. Índice da página a exportar para formato svg (padrão é 1). Indice página começa em 1 para a primeira página do documento. **Nota:**  índice da página é independente da numeração das páginas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk pdfa version                             | pdfaVersion        | Exporta PDF conforme a uma versión PDF/A. Para saber mais sobre as propriedades e versões de PDF/A, consulte a [página PDF/A em Wikipedia](https://en.wikipedia.org/wiki/PDF/A). Valores possíveis: wk pdfa2: exporta à versão "PDF/A-2" wk pdfa3: exporta à versão "PDF/A-3" **Nota:** em macOS, wk pdfa2 pode exportar a PDF/A-2 ou PDF/A-3 ou superior, dependendo da implementación da plataforma. Além disso, wk pdfa3 significa "exporta ao menos a PDF/A-3". Em Windows, o arquivo PDF de saida sempre será igual a conformidade desejada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk recompute formulas                       | recomputeFormulas  | Define se as fórmulas devem ser recalculadas quando forem exportadas. Valores possíveis: true - Valor padrão. Todas as fórmulas são recalculadas false- Não recalcula as fórmulas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk visible background and anchored elements | visibleBackground  | Exibe tanto as imagens de fundo quanto a cor de fundo (efeito visível apenas nos modos de Página e Vista Embebida). Valores Possíveis: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk visible empty images                     | visibleEmptyImages | Mostra um retângulo negro como padrão para as imagens que não podem ser carregadas ou calculadas (imagens vazias ou em um formato não compatível). Valores possíveis: True/False. Valor padrão: True Se o valor for False, os elementos imagem que faltem não são mostrados em absoluto mesmo que tenham bordas, largura, altura ou fundo; isso pode afetar o design da página para as imagens inline.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wk visible footers                          | visibleFooters     | Exibe os cabeçalhos (efeito visível apenas em modo Página). Valores possíveis: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk visible headers                          | visibleHeaders     | Exibe o cabeçalho (efeito visível apenas em modo Página). Valores possíveis: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk visible references                       | visibleReferences  | Exibe todas as expressões 4D inseridas no documento como referência. Valores possíveis: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

A tabela abaixo indica a *opção* disponível por *formato* de exportação:

| |  **wk 4wp**                                            | **wk docx**                                                                | **wk mime html**                                                          | **wk pdf**                                                                                  | **wk web page html 4D**                                                    | **wk svg**                                                                 |                                                                              |
| -------------------------------------------------------- | -------------------------------------------------------------------------- | ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- | -------------------------------------------------------------------------- | ---------------------------------------------------------------------------- |---|
| wk CID host domain name<br/>                     | \-                                                                         | \-                                                                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                   | \-                                                                         | \-                                                                         |                                                                              |
| wk HTML pretty print<br/>                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: false) | \-                                                                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: False)                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: False)   |
| wk max picture DPI<br/>                          | \-                                                                         | always 300                                                                | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: 300)   | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: 300)     |
| wk optimized for<br/>                            | \-                                                                         | always wk print                                                           | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default:wk screen) <br/> | always wk print                                                            | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default:wk print) |
| wk recompute formulas<br/>                       | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)  | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk visible background and anchored elements<br/> | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true) | always true                                                                                 | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)  | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk visible footers<br/>                          | \-                                                                         | always true                                                               | always false                                                                                | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)  | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk visible headers<br/>                          | \-                                                                         | always true                                                               | always false                                                                                | ![](../../assets/en/WritePro/commands/pict5058606.pt.png) (default: true)  | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk visible empty images<br/>                     | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.pt.png) (default: true) | ![](../../assets/en/WritePro/commands/pict5058606.pt.png) (default: true)                   | ![](../../assets/en/WritePro/commands/pict5058606.pt.png) (default: true)  | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk visible references<br/>                       | \-                                                                         | \-                                                                        | \-                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.pt.png) (default: false) | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: false)   |
| wk pdfa version<br/>                             | \-                                                                         | \-                                                                        | \-                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.pt.png)                  | \-                                                                         | \-                                                                           |
| wk page index<br/>                               | \-                                                                         | \-                                                                        | \-                                                                                          | \-                                                                         | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: 1)       |
| wk factur x<br/>                                 | \-                                                                         | \-                                                                        | \-                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                  | \-                                                                         | \-                                                                           |
| wk files<br/>                                    | \-                                                                         | \-                                                                        | \-                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                  | \-                                                                         | \-                                                                           |
| wk embedded pictures<br/>                        | \-                                                                         | \-                                                                        | \-                                                                                          | \-                                                                         | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: true)    |
| wk google fonts tag<br/>                         | \-                                                                         | \-                                                                        | \-                                                                                          | \-                                                                         | \-                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (default: false)   |

**Compatibility Note:** Passing a *longint* value in *option* is supported for compatibility reasons, but it is recommended to use an object parameter. 

#### Exemplo 1 

Se quiser exportar o conteúdo de objeto 4D Write Pro *myArea* ao formato MIME e agregar "gmail.com" como dominio host:

```4d
 var $option : Object
 
 $option[wk CID host domain name]:="gmail.com"
 
 WP EXPORT VARIABLE(myArea;$export;wk mime html;$option)

```

#### Exemplo 2 

Se quiser enviar um email texto com estilo, referências 4D e imagens. Pode utilizar uma área 4D Write Pro exportada ao formato MIME e enviá-la utilizando SMTP:

```4d
  // criar o transporter
 $server:=New object
 $server.host:="smtp.gmail.com"
 $server.port:=465
 $server.user:="4D@gmail.com"
 $server.password:="XXXX"
 
 $transporter:=SMTP New transporter($server)
 
 WP EXPORT VARIABLE(WParea;$mime;wk mime html)
 
 $mailTmp:=MAIL Convert from MIME($mime)
 
  // adicionar imagens (se houver)
 If($mailTmp.attachments#Null)
    $email.attachments:=$mailTmp.attachments
 End if
 
 $email.bodyStructure:=$mailTmp.bodyStructure
 $email.bodyValues:=$mailTmp.bodyValues
 
 $status:=$transporter.send($email)
 If(Not($status.success))
    ALERT("An error occurred: "+$status.statusText)
 End if
```

#### Exemplo 3 

Para exportar a primeira página de um 4D Write Pro como SVG em u ma variável Texto e esconder os cabeçalhos:

```4d
 var $options : Object

var $destination Text
 
 $options:=New object
 $options[wk optimized for]:=wk screen
 $options[wk visible headers]:=False
 WP EXPORT VARIABLE(WPArea;$destination;wk svg;$options)


```

#### Ver também 

  
  
  
*Exportar em formato .docx*  
*Exportar para formatos HTML e MIME HTMLS*  
[WP EXPORT DOCUMENT](../commands/wp-export-document.md)  