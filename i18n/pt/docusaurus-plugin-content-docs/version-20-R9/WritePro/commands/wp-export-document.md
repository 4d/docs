---
id: wp-export-document
title: WP EXPORT DOCUMENT
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT DOCUMENT.Syntax-->**WP EXPORT DOCUMENT** ( *wpDoc* ; *filePath* {; *format* {; *option*}} )<br/>**WP EXPORT DOCUMENT** ( *wpDoc* ; *fileObj* {; *format* {; *option*}} )<!-- END REF-->

<!--REF #_command_.WP EXPORT DOCUMENT.Params-->

| Parâmetro | Tipo                     |                             | Descrição                                                                                                                                                 |
| --------- | ------------------------ | --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wpDoc     | Object                   | &#8594; | Variável 4D Write Pro                                                                                                                                     |
| filePath  | Text                     | &#8594; | Caminho do arquivo exportado                                                                                                                              |
| fileObj   | 4D. File | &#8594; | Objeto para exportar                                                                                                                                      |
| format    | Integer                  | &#8594; | Formato de saída do documento (ex.: .docx, .pdf, etc.) |
| option    | Object, Integer          | &#8594; | Opções de exportação, que pode variar dependendo do formato escolhido.                                                                    |

<!-- END REF-->

## Descrição

O comando **WP EXPORT DOCUMENT** <!--REF #_command_.WP EXPORT DOCUMENT. ummary--> exporta o objeto *wpDoc* 4D Write Pro para um documento em disco, de acordo com o parâmetro *filePath* ou *fileObj* bem como todos os parâmetros opcionais. !-- FIM MIRA-->

Em *wpDoc*, passe o objeto 4D Write Pro que você deseja exportar.

Você pode passar um *filePath* ou *fileObj*:

- Em *filePath*, passe o caminho de destino e o nome do documento a ser exportado. Se você passar apenas o nome do documento, ele será salvo no mesmo nível que o arquivo de estrutura 4D.

- No parâmetro *fileObj*, passe um objeto 4D.File representando o arquivo a ser exportado.

Você pode omitir o parâmetro *formato*, neste caso você precisa especificar a extensão em *filePath*. Você também pode passar uma constante do tema *4D Write Pro Constants* no parâmetro *formato*. Neste caso, 4D adiciona a extensão apropriada para o nome do arquivo, se necessário. São suportados os seguintes formatos:

| Parâmetros           | Valor | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| -------------------- | ----- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk 4wp               | 4     | O documento 4D Write Pro é salvo em um formato de arquivo nativo (zipado HTML e imagens salvas em uma pasta separada). Tags específicas 4D estão incluídas e expressões 4D não são calculadas. Este formato é particularmente adequado para salvar e arquivar documentos 4D Write Pro no disco sem qualquer perda.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk docx              | 7     | Extensão .docx. O documento 4D Write Pro é salvo no formato Microsoft Word . Suporte certificado para Microsoft Word 2010 e mais recentes. <br/> <br/>As partes do documento exportadas são: <br/>Corpo / cabeçalhos / rodapés / seçõesPágina de exibição / configurações de impressão (margem, cor / imagem, bordas, preenchimento, tamanho do papel / orientação)Imagens - inline, ancorada, e padrão de imagem de fundo (definido com imagem de fundo wk)Variáveis e expressões compatíveis (número de páginas, data, hora, metadados). Variáveis e expressões não compatíveis serão avaliadas e congeladas antes da exportação. inks -<br/>BookmarksURLsNote que algumas configurações 4D Write Pro podem não estar disponíveis ou se comportar de forma diferente no Microsoft Word. |
| wk mime html         | 1     | O documento 4D Write Pro é salvo como MIME HTML padrão com documentos HTML e imagens incorporadas como partes MIME (codificado em base64). As expressões são calculadas e links de métodos e tags 4D específicos são removidos. Apenas caixas de texto ancoradas na visualização incorporada são exportadas (como divs). Este formato é particularmente adequado para enviar e-mails em HTML com o comando.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk pdf               | 5     | Extensão .pdf. O documento 4D Write Pro é salvo no formato PDF, com base no modo de visualização de página. Os seguintes metadados são exportados em um documento PDF: título autor título conteúdo autor **Notas**: As expressões são calculadas automaticamente e os valores são congelados ao exportar o documento. Os links a métodos NÂO são exportados.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk svg               | 8     | A página 4D Write Pro documento é salva no formato SVG, com base no modo de visualização de página. **Nota:** ao exportar para SVG, você só pode exportar uma página de cada vez. Use o índice da página do wk para especificar qual página exportar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk web page complete | 2     | Extensão .htm ou .html. O documento é salvo como HTML padrão e seus recursos são salvos separadamente. Tags 4D e links para métodos 4D são removidos e expressões são calculadas. Apenas caixas de texto ancoradas na visualização incorporada são exportadas (como divs). Este formato é particularmente adequado quando você deseja exibir um documento 4D Write Pro em um navegador da web.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**Notas:**

- "4D tags específicas" significa 4D XHTML com um namespace 4D e estilos 4D CSS
- Para mais informações sobre o formato 4D Write Pro do documento, consulte [formato do documento .4wp](https://doc.4d.com/4Dv20/4D/20/Using-a-4D-Write-Pro-area.200-6229460.en.html#2895813).
- Para visualizar uma lista das diferenças conhecidas ou incompatibilidades ao usar o formato .docx, consulte [Importando e Exportando no formato .docx](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html).
- Para obter mais informações sobre exportação para o formato SVG, consulte [Exportando para o formato SVG](https://doc.4d.com/4Dv20/4D/20/Exporting-to-SVG-format.200-6229468.en.html).

### parâmetro opção

Passe um [objeto](# "Dados estruturados como um objeto 4D nativo") em *opção* contendo os valores para definir as propriedades do documento exportado. As seguintes propriedades estão disponíveis:

| Parâmetros                                  | Valor              | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------- | ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nome de domínio host CID: domínio host que será adicionado aos URLs de CID gerados, incluindo um '@' como separador. Disponível somente quando o formato `wk mime html` é usado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk embedded pictures                        | embeddedPictures   | Somente para exportação SVG. Define se as imagens são incorporadas no arquivo .svg exportado quando você chamar [WP EXPORT DOCUMENT](wp-export-document.md). Available values: <li>true (default): Pictures are embedded in the exported .svg file</li><li>false: Pictures are exported in a folder called "filename\_images" at the level of the exported .svg file, "filename" being the name passed to the command for the file, without the extension. The pictures are not embedded, but referenced in the .svg file.</li>Note: If the folder already exists, it is emptied before the file is exported. If there is no image on the exported page, the folder is deleted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk factur x                                 | facturX            | For PDF export only. Valor: objeto que configura uma exportação de PDF "Factur-X (ZUGFeRD)" (consulte [wk factur x object](#wk-factur-x-object)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk files                                    | files              | For PDF export only. Valor: coleção de objetos, cada um deles descrevendo um arquivo a ser incorporado no documento final (consulte [wk files collection](#wk-files-collection)). This feature is only supported in PDF/A-3 documents: when the `wk files` attribute is used, the "PDF/A-3" version is automatically set (the `wk pdfa version` attribute is ignored). In case of a Factur-X PDF export (see below), the first object of the collection must contain the Factur-X xml file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk google fonts tag                         | googleFontsTag     | For SVG export only. Sets the import rule for google fonts in the exported SVG. Possible values: <li>false (default): No google fonts import rule is added.</li><li>true: Adds the @import rule to the exported file. Useful if you want to use fonts that are not available by default on Windows or macOS.</li> **Note:** This property is set to false by default because when enabled, Google fonts override native fonts, and native fonts are generally better rendered in the browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk HTML pretty print                        | htmlPrettyPrint    | HTML code is formatted to be easier to read.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| wk max picture DPI                          | maxPictureDPI      | Used for resampling (reducing) images to preferred resolution. For SVG images in Windows, used for rasterization. Default values: 300 (for wk optimized for \= wk print) 192 (for wk optimized for \= wk screen) Maximum possible value: 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk optimized for                            | optimizedFor       | Defines how an exported document is optimized based on its intended medium. Possible values:<li> `wk print` (default value for `wk pdf` and `wk svg`) Bitmap pictures may be downscaled using the DPI defined by `wk max picture DPI` or 300 (default value) and may be converted to PNG if codec is not supported for the export type. Vectorial pictures are converted to PNG using the DPI defined by `wk max picture DPI` or 300 (Windows only). If a picture contains more than one format, the best format for printing is used (*e.g.*, .tiff instead or .jpg)</li><li>`wk screen` (default value for `wk web page complete` and `wk mime html`). Bitmap pictures may be downscaled using the DPI defined by `wk max picture DPI` or 192 (default value) and may be converted to JPEG (opaque images) or PNG (transparent images) if codec is not supported for the export type. Vectorial pictures are converted to PNG using the DPI defined by `wk max picture DPI` or 192 (Windows only). If a picture contains more than one format, the format for screen rendering is used.</li> **Note:** Documents exported in `wk docx` format are always optimized for wk print (wk optimized for option is ignored). |
| wk page index                               | pageIndex          | For SVG export only. Index of the page to export to svg format (default is 1). Page index starts at 1 for the first page of the document. **Nota:** o índice de páginas é independente da numeração de páginas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk pdfa version                             | pdfaVersion        | Exports PDF with conformance to a PDF/A version. For more information on PDF/A properties and versions, please refer to the [PDF/A page on Wikipedia](https://en.wikipedia.org/wiki/PDF/A). Possible values: <li>`wk pdfa2`: Exports to version "PDF/A-2"</li><li> `wk pdfa3`: Exports to version "PDF/A-3"<li> **Note:** On macOS, `wk pdfa2` may export to PDF/A-2 or PDF/A-3 or higher, depending on platform implementation. Also, `wk pdfa3` means "exports to *at least* PDF/A-3". On Windows, the output PDF file will always be equal to the desired conformance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk recompute formulas                       | recomputeFormulas  | Defines if formulas must be recomputed when exported. Possible values:<li>true - Default value. All formulas are recomputed</li><li>false - Do not recompute formulas </li>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk visible background and anchored elements | visibleBackground  | Displays or exports background images/color, anchored images and text boxes (for display, visible effect in Page or Embedded view mode only). Possible values: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| wk visible empty images                     | visibleEmptyImages | Displays or exports a default black rectangle for images that cannot be loaded or computed (empty images or images in an unsupported format). Possible values: True/False. Default value: True If value is False, missing image elements will not be displayed at all even if they have borders, width, height, or background; this may impact the page layout for inline images.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk visible footers                          | visibleFooters     | Displays or exports the footers (for display, visible effect in Page view mode only). Possible values: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk visible headers                          | visibleHeaders     | Displays or exports the headers (for display, visible effect in Page view mode only). Possible values: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk visible references                       | visibleReferences  | Displays or exports all 4D expressions inserted in the document as references. Possible values: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| wk whitespace                               | whitespace         | Sets the "white-space" css value for `wk mime html` and `wk web page complete` export formats. The [white-space css style](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space) is applied to paragraphs. Possible values: "normal", "nowrap", "pre", "pre-wrap" (default), "pre-line", "break-spaces".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

A tabela a seguir indica a *option* disponível por *format* de exportação:

|                                             | **wk 4wp**                                                                                                   | **wk docx**                                                                                                 | **wk mime html**                                                                                                  | **wk pdf**                                                                                                   | **wk web page complete**                                                                                          | **wk svg**                                                                                                      |
| ------------------------------------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | \-                                                                                                          | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | \-                                                                                                          | \-                                                                                                               | \-                                                                                                             |
| wk embedded pictures                        | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk factur x                                 | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk files                                    | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk google fonts tag                         | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk HTML pretty print                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false) | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False)      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False)      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk max picture DPI                          | \-                                                                                                          | sempre 300                                                                                                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 300)   | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 300)      |
| wk optimized for                            | \-                                                                                                          | always wk print                                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: wk screen)  | always wk print                                                                                              | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: wk print) |
| wk page index                               | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 1)        |
| wk pdfa version                             | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk recompute formulas                       | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible background and anchored elements | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | sempre true                                                                                                       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible empty images                     | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible footers                          | \-                                                                                                          | sempre true                                                                                                 | sempre false                                                                                                      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible headers                          | \-                                                                                                          | sempre true                                                                                                 | sempre false                                                                                                      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible references                       | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false) | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk whitespace                               | \-                                                                                                          | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: "pre-wrap") | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: "pre-wrap") | \-                                                                                                             |

**Compatibility Note:** Passing a *longint* value in *option* is supported for compatibility reasons, but it is recommended to use an [object](# "Data structured as a native 4D object") parameter.

### wk files collection

The wk files property allows you to [export a PDF with attachments](https://blog.4d.com/4d-write-pro-export-to-pdf-with-enclosures). This property must contain a collection of objects describing the files to be embedded in the final document. Each object of the collection can contain the following properties:

| **Propriedade** | **Tipo**                       | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------------- | ------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| name            | Text                           | File name. Optional if the *file* property is used, in which case the name is inferred by default from the file name. Mandatory if the *data* property is used (except for the first file of a Factur-X export, in which case the name for the file is automatically "factur-x.xml", see below)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| description     | Text                           | Opcional. If omitted, default value for the first export file to Factur-X is "Factur-X/ZUGFeRD Invoice", otherwise empty.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| mimeType        | Text                           | Opcional. If omitted, default value can usually be guessed from file extension; otherwise, "application/octet-stream" is used. If passed, make sure to use an ISO mime type, otherwise the exported file could be invalid.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| data            | Texto ou BLOB                  | Obrigatório se a propriedade *file* está faltando                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| file            | Objeto 4D.File | Obrigatório se a propriedade *data* estiver ausente; caso contrário, será ignorado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| relationship    | Text                           | Opcional. If omitted, default value is "Data". Possible values for Factur-X first file:for BASIC, EN 16931 or EXTENDED profiles: "Alternative", "Source" or "Data" ("Alternative" only for German invoice)for MINIMUM and BASIC WL profiles: "Data" only.for other profiles: "Alternative", "Source" or "Data" (with restrictions perhaps depending on country: see profile specification for more info about other profiles - for instance for RECHNUNG profile only "Alternative" is allowed)for other files (but Factur-X invoice xml file) : "Alternative", "Source", "Data", "Supplement" or "Unspecified"any other value generates an error. |

If the *option* parameter also contains a wk factur x property, then the first element of the wk files collection must be the Factur-X (ZUGFeRD) invoice xml file (see below).

:::note

PDF attachments are only supported by the PDF/A-3 version. When you pass the wk files property, the "PDF/A-3" version is automatically used.

:::

### wk factur x object

The wk factur x property is an object that can contains up to two properties:

| **Propriedade** | **Tipo** | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| --------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| profile         | Text     | Opcional. If omitted, *profile* is determined from the provided xml file or text (which must use a standard profile). If passed, it can be a non-standard profile name (for using other profiles - for instance RECHNUNG). **Note:* Standard profile names are: MINIMUM, BASIC WL, BASIC, EN 16931 (aka COMFORT which is an alias), EXTENDED.* |
| version         | Text     | Opcional. Valor padrão é "1.0"                                                                                                                                                                                                                                                                                                                                                                                                                                          |

### Sobre documentos PDF Factur-X / ZUGFeRD

*Factur-X / ZUGFeRD* is a European standard for hybrid e-invoices (PDF for users and XML data for process automation). For more information, please read [this blog post](https://blog.4d.com/4d-write-pro-electronic-invoice-generation).

To trigger a "Factur-X" PDF export, pass both the wk factur x and wk files properties in the *option* parameter (see Example 5). Nesse modo:

- a Factur-X (ZUGFeRD) PDF is generated,
- the first element of the wk files collection is used as Factur-X xml file,
- if the wk files property is missing or contains an empty collection, or if its first element is not a xml file, an error is generated.

:::note

For a detailed example of Factur-X / ZUGFeRD export implementation, you can download [this HDI 4D project](https://github.com/4d-depot/HDI%5F4DWP%5FGenerateFacturX).

:::

## Exemplo 1

You want to export the contents of the *myArea* 4D Write Pro object in both HTML and PDF format:

```4d
  // exportar HTML
  var $option : Object
 $option:=New object

 $option[wk recompute formulas]:=False
 $option[wk HTML pretty print]:=False
 $option[wk optimized for]:=wk print
 $option[wk max picture DPI]:=600 //override default value for print (300 DPI)

 WP EXPORT DOCUMENT(myArea;$path;wk web page complete;$option)

  //exportar PDF
 var $option : Object
 $option:=New object

 $option[wk visible headers]:=True
 $option[wk visible footers]:=True
 $option[wk visible background]:=True
 $option[wk max picture DPI]:=96 //override default value for screen (192 DPI) to limit doc size
 $option[wk optimized for]:=wk screen
 $option[wk recompute formulas]:=True

 WP EXPORT DOCUMENT(myArea;$path;wk pdf;$option)
```

## Exemplo 2

You want to export the contents of the *myArea* 4D Write Pro object in .4wp format:

```4d
 var $path : Text

 Case of
    :(Form event code=On Clicked)

       $path:=Get 4D folder(Database folder)+"Export"+Folder separator
       $path:=Select document($path;".4wp";" title";File name entry)

       If($path#"")
          WP EXPORT DOCUMENT(myArea;document;wk 4wp)
       End if
 End case
```

## Exemplo 3

To export the second page of the document as SVG and export the pictures from the document:

```4d
 var $options : Object

 $options:=New object
 $options[wk embedded pictures]:=False
 $options[wk page index]:=2

 WP EXPORT DOCUMENT(WPArea;"my exported document";wk svg;$options)
```

## Exemplo

Exporting a PDF document with PDF/A-2 conformance:

```4d
 var $options: Object:={}
 $options[wk visible empty images] :=False
 $options[wk pdfa version]:=wk pdfa2 // conformidade "PDF/A-2"
 WP EXPORT DOCUMENT(wpDoc;"invoice.pdf";wk pdf;$options)
```

## Exemplo 2

Exemplos de exportações PDF de Factur-X:

```4d
  //BASIC (standard profile)
 var $options;$fileInfo : Object
 $options:={}
 $options[wk factur x]:={}
 $options[wk factur x].profile:="BASIC"
 $options[wk factur x].version:="1.0"

 $fileInfo:={}
 $fileInfo.file:=$file  //$file is a 4D.File with an .xml file as target
 $options[wk files]:=[$fileInfo]

 WP EXPORT DOCUMENT(wpDoc;"facturX_basic.pdf";wk pdf;$options)

  //RECHNUNG profile (custom profile)
 $options:={}
 $options[wk factur x]:={}
 $options[wk factur x].profile:="RECHNUNG"
 $options[wk factur x].version:="2.1" //last version for RECHNUNG

 $fileInfo:={}
 $fileInfo.file:=$file  //$file is a 4D.File with an .xml file as target
 $fileInfo.name:="rechnung.xml" //mandatory file name in PDF for RECHNUNG
 $fileInfo.relationship:="Alternative" //mandatory for Germany
 $fileInfo.description:="ZUGFeRD Rechnung"
 $options[wk files]:=[$fileInfo]

 WP EXPORT DOCUMENT(wpDoc;"facturX_rechnung.pdf";wk pdf;$options)
```

## Exemplo 6

Exportar um documento docx usando um objeto File:

```4d
var $file : 4D.File

$file:=File("/DATA/test-export")

$options:=New object(wk visible background and anchored elements; False)

WP EXPORT DOCUMENT(WParea; $file; wk docx; $options)

```

## Veja também

[4D QPDF (Component) - PDF Get attachments](https://github.com/4d/4D-QPDF)</br>
[Exporting to HTML and MIME HTML formats](https://doc.4d.com/4Dv20/4D/20/Exporting-to-HTML-and-MIME-HTML-formats.200-6229467.en.html)<br/>
[Importing and Exporting in .docx format](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html)<br/>
[Blog post - 4D Write Pro: Electronic invoice generation](https://blog.4d.com/4d-write-pro-electronic-invoice-generation)</br>
[Blog post - 4D Write Pro: Export to PDF with enclosures](https://blog.4d.com/4d-write-pro-export-to-pdf-with-enclosures)</br>
[WP EXPORT VARIABLE](wp-export-variable.md)</br>
