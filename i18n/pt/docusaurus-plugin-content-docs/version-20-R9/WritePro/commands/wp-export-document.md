---
id: wp-export-document
title: WP EXPORT DOCUMENT
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT DOCUMENT.Syntax-->**WP EXPORT DOCUMENT** ( *wpDoc* ; *filePath* {; *format* {; *option*}} )<br/>**WP EXPORT DOCUMENT** ( *wpDoc* ; *fileObj* {; *format* {; *option*}} )<!-- END REF-->

<!--REF #_command_.WP EXPORT DOCUMENT.Params-->

| Parâmetro | Tipo                     |                             | Descrição                                                                                                                                                 |
| --------- | ------------------------ | --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wpDoc     | Object                   | &#8594; | Variável 4D Write Pro                                                                                                                                     |
| filePath  | Text                     | &#8594; | Caminho do arquivo exportado                                                                                                                              |
| fileObj   | 4D. File | &#8594; | Objeto para exportar                                                                                                                                      |
| format    | Integer                  | &#8594; | Formato de saída do documento (ex.: .docx, .pdf, etc.) |
| option    | Object, Integer          | &#8594; | Opções de exportação, que pode variar dependendo do formato escolhido.                                                                    |

<!-- END REF-->

## Descrição

O comando **WP EXPORT DOCUMENT** <!--REF #_command_.WP EXPORT DOCUMENT. ummary--> exporta o objeto *wpDoc* 4D Write Pro para um documento em disco, de acordo com o parâmetro *filePath* ou *fileObj* bem como todos os parâmetros opcionais. !-- FIM MIRA-->

Em *wpDoc*, passe o objeto 4D Write Pro que você deseja exportar.

Você pode passar um *filePath* ou *fileObj*:

- Em *filePath*, passe o caminho de destino e o nome do documento a ser exportado. Se você passar apenas o nome do documento, ele será salvo no mesmo nível que o arquivo de estrutura 4D.

- No parâmetro *fileObj*, passe um objeto 4D.File representando o arquivo a ser exportado.

Você pode omitir o parâmetro *formato*, neste caso você precisa especificar a extensão em *filePath*. Você também pode passar uma constante do tema *4D Write Pro Constants* no parâmetro *formato*. Neste caso, 4D adiciona a extensão apropriada para o nome do arquivo, se necessário. São suportados os seguintes formatos:

| Parâmetros           | Valor | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| -------------------- | ----- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk 4wp               | 4     | O documento 4D Write Pro é salvo em um formato de arquivo nativo (zipado HTML e imagens salvas em uma pasta separada). Tags específicas 4D estão incluídas e expressões 4D não são calculadas. Este formato é particularmente adequado para salvar e arquivar documentos 4D Write Pro no disco sem qualquer perda.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk docx              | 7     | Extensão .docx. O documento 4D Write Pro é salvo no formato Microsoft Word . Suporte certificado para Microsoft Word 2010 e mais recentes. <br/> <br/>As partes do documento exportadas são: <br/>Corpo / cabeçalhos / rodapés / seçõesPágina de exibição / configurações de impressão (margem, cor / imagem, bordas, preenchimento, tamanho do papel / orientação)Imagens - inline, ancorada, e padrão de imagem de fundo (definido com imagem de fundo wk)Variáveis e expressões compatíveis (número de páginas, data, hora, metadados). Variáveis e expressões não compatíveis serão avaliadas e congeladas antes da exportação. inks -<br/>BookmarksURLsNote que algumas configurações 4D Write Pro podem não estar disponíveis ou se comportar de forma diferente no Microsoft Word. |
| wk mime html         | 1     | O documento 4D Write Pro é salvo como MIME HTML padrão com documentos HTML e imagens incorporadas como partes MIME (codificado em base64). As expressões são calculadas e links de métodos e tags 4D específicos são removidos. Apenas caixas de texto ancoradas na visualização incorporada são exportadas (como divs). Este formato é particularmente adequado para enviar e-mails em HTML com o comando.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk pdf               | 5     | Extensão .pdf. O documento 4D Write Pro é salvo no formato PDF, com base no modo de visualização de página. Os seguintes metadados são exportados em um documento PDF: título autor título conteúdo autor **Notas**: As expressões são calculadas automaticamente e os valores são congelados ao exportar o documento. Os links a métodos NÂO são exportados.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk svg               | 8     | A página 4D Write Pro documento é salva no formato SVG, com base no modo de visualização de página. **Nota:** ao exportar para SVG, você só pode exportar uma página de cada vez. Use o índice da página do wk para especificar qual página exportar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk web page complete | 2     | Extensão .htm ou .html. O documento é salvo como HTML padrão e seus recursos são salvos separadamente. Tags 4D e links para métodos 4D são removidos e expressões são calculadas. Apenas caixas de texto ancoradas na visualização incorporada são exportadas (como divs). Este formato é particularmente adequado quando você deseja exibir um documento 4D Write Pro em um navegador da web.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**Notas:**

- "4D tags específicas" significa 4D XHTML com um namespace 4D e estilos 4D CSS
- Para mais informações sobre o formato 4D Write Pro do documento, consulte [formato do documento .4wp](https://doc.4d.com/4Dv20/4D/20/Using-a-4D-Write-Pro-area.200-6229460.en.html#2895813).
- Para visualizar uma lista das diferenças conhecidas ou incompatibilidades ao usar o formato .docx, consulte [Importando e Exportando no formato .docx](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html).
- Para obter mais informações sobre exportação para o formato SVG, consulte [Exportando para o formato SVG](https://doc.4d.com/4Dv20/4D/20/Exporting-to-SVG-format.200-6229468.en.html).

### parâmetro opção

Passe um [objeto](# "Dados estruturados como um objeto 4D nativo") em *opção* contendo os valores para definir as propriedades do documento exportado. As seguintes propriedades estão disponíveis:

| Parâmetros                                  | Valor              | Comentário                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------------------- | ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nome de domínio host CID: domínio host que será adicionado aos URLs de CID gerados, incluindo um '@' como separador. Disponível somente quando o formato `wk mime html` é usado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk embedded pictures                        | embeddedPictures   | Somente para exportação SVG. Define se as imagens são incorporadas no arquivo .svg exportado quando você chamar [WP EXPORT DOCUMENT](wp-export-document.md). Valores disponíveis: <li>true (padrão): Imagens são incorporadas no exportado. arquivo vg</li><li>false: Imagens são exportadas em uma pasta chamada "filename\_images" no nível do exportado. arquivo vg, "nome do arquivo" sendo o nome do arquivo passado para o comando sem a extensão. As imagens não são incorporadas, mas referenciadas no arquivo .svg.</li>Nota: Se a pasta já existir, será esvaziada antes do arquivo ser exportado. Se não houver nenhuma imagem na página exportada, a pasta será excluída                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk factur x                                 | facturX            | Somente para exportação em PDF. Valor: objeto que configura uma exportação de PDF "Factur-X (ZUGFeRD)" (consulte [wk factur x object](#wk-factur-x-object)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk files                                    | files              | Somente para exportação em PDF. Valor: coleção de objetos, cada um deles descrevendo um arquivo a ser incorporado no documento final (consulte [wk files collection](#wk-files-collection)). Este recurso só é suportado em documentos PDF/A-3: quando o atributo `wk files` é usado, a versão "PDF/A-3" é definida automaticamente (o atributo `wk pdfa version` é ignorado). Em caso de exportação Factur-X PDF (ver abaixo), o primeiro objeto da coleção deve conter o arquivo xml Factur-X.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wk google fonts tag                         | googleFontsTag     | Somente para exportação SVG. Define a regra de importação para fontes do google no SVG exportado. Valores possíveis: <li>false (padrão): Nenhuma regra de importação de fontes do google é adicionada.</li><li>verdadeira: Adiciona a regra de @import ao arquivo exportado. Útil se você quiser usar fontes que não estão disponíveis por padrão no Windows ou macOS.</li> **Nota:** Essa propriedade é definida como falso por padrão porque quando habilitada As fontes do Google substituem fontes nativas, e as fontes nativas são geralmente melhor renderizadas no navegador.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| wk HTML pretty print                        | htmlPrettyPrint    | Código HTML está formatado para ser mais fácil de ler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk max picture DPI                          | maxPictureDPI      | Usado para reamostragem de imagens (reduzindo) para resolução preferida. Para imagens SVG no Windows, usado para o rasterização. Valores padrão: 300 (para wk otimizado para \= wk print) 192 (para wk otimizado para \= wk screen) Valor máximo possível: 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| wk optimized for                            | optimizedFor       | Define como um documento exportado é otimizado com base em seu meio pretendido. Valores possíveis:<li> `wk print` (valor padrão para `wk pdf` e `wk svg`) Imagens de Bitmap podem ser reduzidas usando o DPI definido por `wk max image DPI` ou 300 (valor padrão) e pode ser convertido em PNG se o codec não for suportado para o tipo de exportação. Imagens vetoriais são convertidas para PNG usando o DPI definido por `wk max image DPI` ou 300 (apenas Windows). Se uma imagem contém mais de um formato, o melhor formato para impressão é usado (*p. ex. .*, .tiff ou . pg)</li><li>`wk screen` (valor padrão para `wk web page complete` e `wk mime html`). Imagens de Bitmap podem ser redimensionadas usando o DPI definido por `wk max image DPI` ou 192 (valor padrão) e pode ser convertido em JPEG (imagens opacas) ou PNG (imagens transparentes) se o codec não for suportado pelo tipo de exportação. Imagens vetoriais são convertidas para PNG usando o DPI definido por `wk max image DPI` ou 192 (apenas Windows). Se uma imagem contiver mais de um formato, será utilizado o formato para a renderização de tela. U</li> **Nota:** Documentos exportados em formato `wk docx` são sempre otimizados para impressão wk (wk otimizado para opção é ignorado). |
| wk page index                               | pageIndex          | Somente para exportação SVG. Índice da página a ser exportada para formato svg (o padrão é 1). O índice da página começa em 1 para a primeira página do documento. **Nota:** o índice de páginas é independente da numeração de páginas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| wk pdfa version                             | pdfaVersion        | Exporta PDF de acordo com a versão PDF/A. Para obter mais informações sobre propriedades e versões PDF/A, consulte a [página PDF/A na Wikipedia](https://en.wikipedia.org/wiki/PDF/A). Valores possíveis: <li>`wk pdfa2`: Exporta para a versão "PDF/A-2"</li><li> `wk pdfa3`: Exporta para a versão "PDF/A-3"<li> **Nota:** No macOS, 'wk pdfa2' pode exportar para PDF/A-2 ou PDF/A-3 ou superior, dependendo da implementação da plataforma. Além disso, `wk pdfa3` significa "exporta para *pelo menos* PDF/A-3". No Windows, o arquivo PDF de saída será sempre igual à conformidade desejada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| wk recompute formulas                       | recomputeFormulas  | Define se fórmulas devem ser recalculadas quando exportadas. Valores possíveis:<li>verdadeiro - Valor padrão. Todas as fórmulas são recalculadas</li><li>false - Não calcular as fórmulas </li>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk visible background and anchored elements | visibleBackground  | Exibe ou exporta imagens de fundo/cor, imagens ancoradas e caixas de texto (para exibição, efeito visível no modo de visualização de página ou apenas no modo de visualização incorporado). Valores possíveis: Verdadeiro/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| wk visible empty images                     | visibleEmptyImages | Exibe ou exporta um retângulo preto padrão para imagens que não podem ser carregadas ou calculadas (imagens vazias ou imagens em um formato não suportado). Valores possíveis: Verdadeiro/Falso. Valor padrão: Verdadeiro Se o valor for Falso, elementos da imagem ausentes não serão exibidos de forma alguma, mesmo se eles tiverem fronteiras, largura, altura ou fundo; isso pode impactar o layout da página para imagens embutidas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk visible footers                          | visibleFooters     | Exibe ou exporta os rodapés (para exibição, efeito visível no modo de visualização da página) Valores possíveis: Verdadeiro/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| wk visible headers                          | visibleHeaders     | Exibe ou exporta os cabeçalhos (para exibição, efeito visível no modo de visualização da página) Valores possíveis: Verdadeiro/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk visible references                       | visibleReferences  | Exibe ou exporta todas as expressões 4D inseridas no documento como referências. Valores possíveis: Verdadeiro/Falso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| wk whitespace                               | whitespace         | Define o valor css "white-space" para os formatos de exportação `wk mime html` e `wk web page complete`. O [estilo CSS do espaço branco](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space) é aplicado aos parágrafos. Valores possíveis: "normal", "nowrap", "pre", "pre-wrap" (padrão), "pre-line", "break-spaces".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

A tabela a seguir indica a *option* disponível por *format* de exportação:

|                                             | **wk 4wp**                                                                                                   | **wk docx**                                                                                                 | **wk mime html**                                                                                                  | **wk pdf**                                                                                                   | **wk web page complete**                                                                                          | **wk svg**                                                                                                      |
| ------------------------------------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | \-                                                                                                          | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | \-                                                                                                          | \-                                                                                                               | \-                                                                                                             |
| wk embedded pictures                        | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk factur x                                 | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk files                                    | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk google fonts tag                         | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk HTML pretty print                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false) | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False)      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: False)      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk max picture DPI                          | \-                                                                                                          | sempre 300                                                                                                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 300)   | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 300)      |
| wk optimized for                            | \-                                                                                                          | always wk print                                                                                             | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: wk screen)  | always wk print                                                                                              | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: wk print) |
| wk page index                               | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | \-                                                                                                          | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: 1)        |
| wk pdfa version                             | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                                    | \-                                                                                                               | \-                                                                                                             |
| wk recompute formulas                       | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible background and anchored elements | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | sempre true                                                                                                       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible empty images                     | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible footers                          | \-                                                                                                          | sempre true                                                                                                 | sempre false                                                                                                      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible headers                          | \-                                                                                                          | sempre true                                                                                                 | sempre false                                                                                                      | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)  | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: true)     |
| wk visible references                       | \-                                                                                                          | \-                                                                                                         | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false) | \-                                                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: false)    |
| wk whitespace                               | \-                                                                                                          | \-                                                                                                         | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: "pre-wrap") | \-                                                                                                          | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (padrão: "pre-wrap") | \-                                                                                                             |

**Nota de compatibilidade:** Passar um valor *longint* na *option* é suportado por razões de compatibilidade. mas é recomendado usar um parâmetro [object](# "Dados estruturados como um objeto 4D nativo".

### coleção de arquivos wk

A propriedade de arquivos wk permite [exportar um PDF com anexos](https://blog.4d.com/4d-write-pro-export-to-pdf-with-enclosures). Essa propriedade deve conter uma coleção de objetos que descrevam os arquivos para serem incorporados no documento final. Cada objeto da coleção pode conter as seguintes propriedades:

| **Propriedade** | **Tipo**                       | **Descrição**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| name            | Text                           | Nome do Arquivo Opcional se a propriedade *file* for usada, neste caso o nome é inferido por padrão do nome do arquivo. Obrigatório se a propriedade *data* é usada (exceto para o primeiro arquivo de uma exportação Factur-X, nesse caso o nome do arquivo é automaticamente "factur-x. ml", veja abaixo)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| description     | Text                           | Opcional. Se omitido, o valor padrão do primeiro arquivo de exportação para Factur-X é "Factur-X/ZUGFeRD Invoice", caso contrário vazio.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| mimeType        | Text                           | Opcional. Se omitido, o valor padrão pode ser geralmente sugerido a partir da extensão do arquivo; caso contrário, é usado "application/octet-stream". Se nome for passado, certifique-se de usar um tipo ISO mime , caso contrário o arquivo exportado pode ser inválido.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| data            | Texto ou BLOB                  | Obrigatório se a propriedade *file* está faltando                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| file            | Objeto 4D.File | Obrigatório se a propriedade *data* estiver ausente; caso contrário, será ignorado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| relationship    | Text                           | Opcional. Se omitido, o valor padrão é "Dados". Possíveis valores para o primeiro arquivo Factur-X: para BASIC, EN 16931 ou EXTENDED: "Alternativo", "Fonte" ou "Dados" ("Alternativa" apenas para fatura alemã)para MINIMUM e perfis BASIC WL: apenas "Dados". ou outros perfis: "Alternativa", "Fonte" ou "Dados" (com restrições, talvez dependendo do país: veja a especificação do perfil para mais informações sobre outros perfis - por exemplo, para o perfil RECHNUNG apenas "Alternativa" é permitido)para outros arquivos (mas o arquivo xml de fatura de Factur-X) : "Alternativo", "Fonte", "Dados", "Suplementar" ou "Unspecified"qualquer outro valor gera um erro. |

Se o parâmetro *option* também contiver uma propriedade x do wk, em seguida, o primeiro elemento da coleção de arquivos wk deve ser o arquivo xml Factur-X (ZUGFeRD) para a fatura (veja abaixo).

:::note

Os anexos de PDF são suportados apenas pela versão PDF/A-3. Quando você passar a propriedade de arquivos wk, a versão "PDF/A-3" é usada automaticamente.

:::

### wk factur x object

A propriedade wk factur x é um objeto que pode conter até duas propriedades:

| **Propriedade** | **Tipo** | **Descrição**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| --------------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| profile         | Text     | Opcional. Se omitido, *perfil* é determinado a partir do arquivo xml fornecido ou do texto (que deve usar um perfil padrão). Se for passado, pode ser um nome de perfil não padrão (por meio de outros perfis - por exemplo, RECHNUNG). **Nota:* Os nomes padrão são: MINIMUM, BASIC WL, BASIC, EN 16931 (também conhecida como COMFORT que é um alias), EXTENDED.* |
| version         | Text     | Opcional. Valor padrão é "1.0"                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

### Sobre documentos PDF Factur-X / ZUGFeRD

*Factur-X / ZUGFeRD* é um padrão europeu para faturas eletrônicas híbridas (PDF para usuários e dados XML para automação do processo). Para mais informações, por favor leia [este post de blog](https://blog.4d.com/4d-write-pro-electronic-invoice-generation).

Para acionar a exportação de um PDF "Factur-X", passe as propriedades de arquivos wk factur x e wk no parâmetro *option* (veja Exemplo 5). Nesse modo:

- um PDF de Factur-X (ZUGFeRD) é gerado,
- o primeiro elemento da coleção de arquivos wk é usado como arquivo xml Factur-X,
- se a propriedade de arquivos wk estiver ausente ou contiver uma coleção vazia, ou se seu primeiro elemento não for um arquivo xml, um erro é gerado.

:::note

Para um exemplo detalhado de implementação da exportação Factur-X / ZUGFeRD, você pode baixar [este projeto HDI 4D](https://github.com/4d-depot/HDI%5F4DWP%5FGenerateFacturX).

:::

## Exemplo 1

Se quiser exportar o conteúdo do objeto *myArea* 4D Write Pro no formato HTML e PDF:

```4d
  // exportar HTML
  var $option : Object
 $option:=New object

 $option[wk recompute formulas]:=False
 $option[wk HTML pretty print]:=False
 $option[wk optimized for]:=wk print
 $option[wk max picture DPI]:=600 //override default value for print (300 DPI)

 WP EXPORT DOCUMENT(myArea;$path;wk web page complete;$option)

  //exportar PDF
 var $option : Object
 $option:=New object

 $option[wk visible headers]:=True
 $option[wk visible footers]:=True
 $option[wk visible background]:=True
 $option[wk max picture DPI]:=96 //override default value for screen (192 DPI) to limit doc size
 $option[wk optimized for]:=wk screen
 $option[wk recompute formulas]:=True

 WP EXPORT DOCUMENT(myArea;$path;wk pdf;$option)
```

## Exemplo 2

Se quiser exportar o conteúdo do *myArea* 4D Write Pro no formato .4wp:

```4d
 var $path : Text

 Case of
    :(Form event code=On Clicked)

       $path:=Get 4D folder(Database folder)+"Export"+Folder separator
       $path:=Select document($path;".4wp";" title";File name entry)

       If($path#"")
          WP EXPORT DOCUMENT(myArea;document;wk 4wp)
       End if
 End case
```

## Exemplo 3

Para exportar a segunda página do documento como SVG e exportar as imagens do documento:

```4d
 var $options : Object

 $options:=New object
 $options[wk embedded pictures]:=False
 $options[wk page index]:=2

 WP EXPORT DOCUMENT(WPArea;"my exported document";wk svg;$options)
```

## Exemplo

Exportando um documento PDF com conformidade com PDF/A-2:

```4d
 var $options: Object:={}
 $options[wk visible empty images] :=False
 $options[wk pdfa version]:=wk pdfa2 // conformidade "PDF/A-2"
 WP EXPORT DOCUMENT(wpDoc;"invoice.pdf";wk pdf;$options)
```

## Exemplo 2

Exemplos de exportações PDF de Factur-X:

```4d
  //BASIC (perfil padrão)
 var $options;$fileInfo : objeto
 $options:={}
 $options[wk factur x]:={}
 $options[wk factur x]. rofile:="BASIC"
 $options[wk factur x].version:="1.0"

 $fileInfo:={}
 $fileInfo.file:=$file  //$file é um 4D. ile with a .xml file as target
 $options[wk files]:=[$fileInfo]

 WP EXPORT DOCUMENT(wpDoc;"facturX_basic. df";wk pdf;$options) Perfil

  //RECHNUNG (perfil personalizado)
 $options:={}
 $options[wk factur x]:={}
 $options[wk factur x]. rofile:="RECHNUNG"
 $options[wk factur x].version:="2.1" //última versão do RECHNUNG

 $fileInfo:={}
 $fileInfo. ile:=$file  //$file é um 4D.File com um arquivo .xml como target
 $fileInfo.name:="rechnung. ml" //nome de arquivo obrigatório em PDF para RECHNUNG
 $fileInfo.relationship:="Alternative" //obrigatório para a Alemanha
 $fileInfo. escription:="Rechnung ZUGFeRD"
 $options[wk files]:=[$fileInfo]

 WP EXPORTE DOCUMENT(wpDoc;"facturX_rechnung.pdf";wk pdf;$options)
```

## Exemplo 6

Exportar um documento docx usando um objeto File:

```4d
var $file : 4D.File

$file:=File("/DATA/test-export")

$options:=New object(wk visible background and anchored elements; False)

WP EXPORT DOCUMENT(WParea; $file; wk docx; $options)

```

## Veja também

[4D QPDF (Component) - PDF Get attachments](https://github.com/4d/4D-QPDF)</br>
[Exporting to HTML and MIME HTML formats](https://doc.4d.com/4Dv20/4D/20/Exporting-to-HTML-and-MIME-HTML-formats.200-6229467.en.html)<br/>
[Importing and Exporting in .docx format](https://doc.4d.com/4Dv20/4D/20/Importing-and-Exporting-in-docx-format.200-6229466.en.html)<br/>
[Blog post - 4D Write Pro: Electronic invoice generation](https://blog.4d.com/4d-write-pro-electronic-invoice-generation)</br>
[Blog post - 4D Write Pro: Export to PDF with enclosures](https://blog.4d.com/4d-write-pro-export-to-pdf-with-enclosures)</br>
[WP EXPORT VARIABLE](wp-export-variable.md)</br>
