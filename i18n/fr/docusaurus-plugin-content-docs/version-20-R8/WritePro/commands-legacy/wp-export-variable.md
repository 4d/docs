---
id: wp-export-variable
title: WP EXPORT VARIABLE
slug: /WritePro/commands/wp-export-variable
displayed_sidebar: docs
---

<!--REF #_command_.WP EXPORT VARIABLE.Syntax-->**WP EXPORT VARIABLE** ( *docWP* ; *destination* ; *format* {; *options*} )<!-- END REF-->
<!--REF #_command_.WP EXPORT VARIABLE.Params-->
| Paramètre | Type |  | Description |
| --- | --- | --- | --- |
| docWP | Object | &#8594;  | Variable 4D Write Pro |
| destination | Variable texte, Variable BLOB | &#x1F858; | Variable devant recevoir le contenu exporté |
| format | Integer | &#8594;  | Format de sortie de la variable |
| options | Object, Integer | &#8594;  | Options d'export |

<!-- END REF-->

#### Description 

<!--REF #_command_.WP EXPORT VARIABLE.Summary-->La commande **WP EXPORT VARIABLE** exporte l'objet 4D Write Pro *docWP* dans la variable 4D *destination* avec le *format* spécifié.<!-- END REF-->

Dans *docWP*, passez l'objet 4D Write Pro que vous voulez exporter.

Dans *destination*, passez la variable que vous voulez remplir avec l'objet 4D Write Pro exporté. Le type de la variable dépend du format d'export défini dans le paramètre *format* :

* si vous passez le format natif .4wp ou le format .docx, la variable sera de type Blob,
* si vous passez un format HTML ou SVG, la variable sera de type Texte.

Dans le paramètre *format*, passez une constante du thème *Constantes 4D Write Pro* définissant le format d'export que vous voulez utiliser. Chaque format est lié à un usage spécifique. Les formats suivants sont pris en charge : 

| Constante           | Type        | Valeur | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------------------- | ----------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk 4wp              | Entier long | 4      | Le document 4D Write Pro est sauvegardé dans un format d'archive natif (HTML *zippé* avec images stockées dans un dossier séparé). Les expressions 4D ne sont pas calculées et les balises 4D spécifiques sont incluses. Ce format est particulièrement approprié pour la sauvegarde et l'archivage de documents 4D Write Pro sur disque sans aucune perte d'informations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk docx             | Entier long | 7      | Extension .docx. Le document 4D Write Pro est sauvegardé sous format Microsoft Word (certifié pour Microsoft Word 2010 et versions plus récentes). <br/> <br/>Les éléments du document exportés sont les suivants : <br/>Corps / en-têtes / pieds de page / sectionsPage / paramètres d'impression (marges, couleur d'arrière-plan / image, bordures, marges intérieures, taille du papier / orientation)Images - en ligne, ancrée, et format d'image d'arrière-plan (défini avec wk background image)Variables et expressions compatibles (numéro de page, nombre de pages, date, heure, metadonnées). Les variables et expressions non compatibles seront évaluées et figées avant l'export.SignetsNotez que certains paramètres de 4D Write Pro peuvent être non disponibles ou fonctionner différemment dans Microsoft Word. |
| wk mime html        | Entier long | 1      | Le document 4D Write Pro est sauvegardé au format MIME HTML avec les documents html et les images embarqués en tant que parties MIME (encodées en base64). Les expressions sont calculées et les balises 4D spécifiques sont supprimées. Ce format est particulièrement adapté à l'envoi de mails au format HTML à l'aide de la commande .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk pdf              | Entier long | 5      | Extension .pdf. Le document 4D Write Pro est sauvegardé au format PDF, selon le mode de vue Page. Les métadonnées suivantes sont exportées dans un document PDF : Titre Auteur Sujet Créateur de contenu **Notes** : Les expressions sont automatiquement figées lorsque le document est exporté Les liens vers les méthodes ne sont PAS exportés                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wk svg              | Entier long | 8      | La page du document 4D Write Pro est enregistrée au format SVG, défini sur le mode d'affichage Page. **Note** : Lors de l'export au format SVG, vous pouvez exporter une seule page à la fois uniquement. Utilisez wk page index pour renseigner la page à exporter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| wk web page html 4D | Entier long | 3      | Le document 4D Write Pro est sauvegardé au format HTML et inclut les balises 4D spécifiques ; chaque expression est insérée sous forme d'espace insécable. Comme ce format est sans perte, il est approprié pour le stockage dans un champ texte.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

**Notes :**

* "Balises 4D spécifiques" désigne le XHTML 4D avec *namespace* 4D et styles CSS 4D.
* Pour plus d'informations sur le format de document 4D Write Pro, veuillez vous reporter au paragraphe *Format de document .4wp*.
* Pour consulter la liste des différences ou des incompatibilités connues liées à l'utilisation du format .docx, veuillez lire *Exporter au format .docx*.
* Lors de l'export au format SVG avec cette commande, les images sont intégrées au format base64.
* Pour plus d'informations sur l'export au format SVG, consultez *Exporter au format SVG*.

##### paramètre option 

Passez un [objet](# "Données structurées sous forme d'objet natif 4D") dans *option* contenant les valeurs définissant les propriétés du document exporté. Les propriétés suivantes sont disponibles : 

| Constante                                   | Valeur             | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------------------- | ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wk CID host domain name                     | cidHostDomain      | Nom de domaine hôte : domaine hôte qui sera ajouté aux URLs CID générés comprenant un '@' comme séparateur. Disponible uniquement lorsque le format wk mime html est utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk embedded pictures                        | embeddedPictures   | Pour l'export SVG uniquement. Définit si les images sont incorporées dans le fichier .svg exporté lorsque vous appelez [WP EXPORT DOCUMENT](../commands/wp-export-document.md). Valeurs disponibles : true (par défaut) : les images sont intégrées dans le fichier .svg exporté false : les images sont exportées dans un dossier nommé "filename\_images" au niveau du fichier .svg exporté, "filename" étant le nom passé à la commande pour le fichier, sans l'extension. Les images ne sont pas intégrées, mais référencées dans le fichier .svg. A noter que : Si le dossier existe déjà, il est vidé avant l'export du fichier S'il n'y a pas d'image sur la page exportée, le dossier est supprimé                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| wk factur x                                 | facturX            | Uniquement pour l'exportation PDF. Valeur : objet configurant un export PDF "Factur-X (ZUGFeRD)" (voir *wk factur x object*).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk files                                    | files              | Uniquement pour l'exportation PDF. Valeur : collection d'objets, chacun d'entre eux décrivant un fichier à incorporer dans le document final (voir *wk files collection*). Cette fonctionnalité n'est prise en charge que dans les documents PDF/A-3 : lorsque l'attribut wk files est utilisé, la version "PDF/A-3" est automatiquement définie (l'attribut wk pdfa version est ignoré). Dans le cas d'un export PDF Factur-X (voir ci-dessous), le premier objet de la collection doit contenir le fichier Factur-X xml.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk google fonts tag                         | googleFontsTag     | Pour l'export SVG uniquement. Définit la règle d'import pour les polices Google dans le SVG exporté. Valeurs possibles : false (par défaut) : aucune règle d'import de polices Google n'est ajoutée. true : ajoute la règle @import au fichier exporté. Utile si vous souhaitez utiliser des polices qui ne sont pas disponibles par défaut sous Windows ou macOS. **Note** : Cette propriété est définie sur false par défaut, car lorsqu'elle est activée, les polices Google remplacent les polices natives, et les polices natives ont généralement un meilleur rendu dans le navigateur.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk HTML pretty print                        | htmlPrettyPrint    | Le code HTML est formaté pour faciliter sa lecture.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk max picture DPI                          | maxPictureDPI      | Utilisé pour réajuster (réduire) les images à une résolution souhaitée. Pour les images SVG sur Windows, elles sont utilisées pour le tramage. Valeurs par défaut : 300 (pour wk optimized for \= wk print) 192 (pour wk optimized for \= wk screen) Valeur maximale possible : 1440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wk optimized for                            | optimizedFor       | Définit comment un document exporté est optimisé selon son support. Valeurs possibles : wk print (valeur par défaut pour wk pdf) Les images bitmap peuvent être réajustées à l'aide du DPI défini par wk max picture DPI ou 300 (valeur par défaut) et peuvent être converties en PNG si le codec n'est pas pris en charge par le type d'export. Les images vectorielles sont converties en PNG à l'aide du DPI défini par wk max picture DPI ou 300 (Windows uniquement) Si une image contient plus d'un format, le meilleur format pour l'impression sera utilisé (ex : .tiff au lieu de .jpg) wk screen (valeur par défaut pour wk web page complete et wk mime html) Les images bitmap peuvent être réajustées à l'aide du DPI défini par wk max picture DPI ou 192 (valeur par défaut) et peuvent être converties en JPEG (images opaques) ou en PNG (images transparentes) si le codec n'est pas pris en charge par le type d'export. Les images vectorielles sont converties en PNG à l'aide du DPI défini par wk max picture DPI ou 192 (Windows uniquement) Si une image contient plus d'un format, le meilleur format pour le rendu écran sera utilisé |
| wk page index                               | pageIndex          | Pour l'export SVG uniquement. Index de la page à exporter au format svg (la valeur par défaut est 1). L'index des pages commence à 1 pour la première page du document. **Note** : l'index des pages est indépendant de la numérotation des pages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wk pdfa version                             | pdfaVersion        | Exporte un fichier PDF conforme à une version du format PDF/A. Pour plus d'informations sur les propriétés et les versions du PDF/A, veuillez consulter [la page PDF/A sur Wikipedia](https://fr.wikipedia.org/wiki/PDF/A). Valeurs possibles : wk pdfa2 : Exporte vers la version "PDF/A-2" wk pdfa3 : Exporte vers la version "PDF/A-3" **Note :** Sur macOS, wk pdfa2 peut exporter vers PDF/A-2 ou PDF/A-3 ou plus, en fonction de la mise en œuvre de la plateforme. Ainsi, wk pdfa3 veut dire "exporte au moins au format PDF/A-3". Sous Windows, le fichier PDF de sortie sera toujours conforme à la norme souhaitée.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| wk recompute formulas                       | recomputeFormulas  | Définit si les formules doivent être recalculées lorsqu'elles sont exportées. Valeurs possibles : vrai- Valeur par défaut. Toutes les formules sont recalculées faux- Ne recalcule pas les formules                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk visible background and anchored elements | visibleBackground  | Affiche ou exporte les images de fond, la couleur de fond, les images ancrées et les zones de texte (pour l'affichage, effet visible uniquement en mode d'affichage Page ou Inclus). Valeurs possibles : True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wk visible empty images                     | visibleEmptyImages | Affiche ou exporte un rectangle noir par défaut pour les images qui ne peuvent pas être chargées ou calculées (images vides ou images sous un format non pris en charge). Valeurs possibles : True/False. Valeur par défaut : True Si la valeur est False, les éléments d'image manquants ne seront pas affichés du tout, même s'ils ont des bordures, une largeur, une hauteur ou un arrière-plan ; cela peut avoir une incidence sur la mise en page des images en ligne.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wk visible footers                          | visibleFooters     | Affiche ou exporte les pieds de page (pour l'affichage, effet visible uniquement en mode d'affichage Page). Valeurs possibles : True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| wk visible headers                          | visibleHeaders     | Affiche ou exporte les en-têtes (pour l'affichage, effet visible uniquement en mode d'affichage Page). Valeurs possibles : True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| wk visible references                       | visibleReferences  | Affiche ou exporte toutes les expressions 4D insérées dans le document en tant que références. Valeurs possibles : True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

Le tableau suivant indique l'*option* disponible par *format* d'export :.

| |  **wk 4wp**                                            | **wk docx**                                                                   | **wk mime html**                                                              | **wk pdf**                                                                                      | **wk web page html 4D**                                                       | **wk svg** **<br/>**                                                  |                                                                                  |
| -------------------------------------------------------- | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |---|
| wk CID host domain name<br/>                     | \-                                                                            | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                       | \-                                                                            | \-                                                                            |                                                                                  |
| wk HTML pretty print<br/>                        | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : faux) | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : Faux)                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : Faux) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : Faux) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : Faux)    |
| wk max picture DPI<br/>                          | \-                                                                            | toujours 300                                                                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                                       | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : 300)  |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : 300)     |
| wk optimized for<br/>                            | \-                                                                            | toujours wk print<br/>)<br/>                                  | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut :wk screen) <br/> | toujours \[#cst id="5048839" /\]                                              |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut :wk print) |
| wk recompute formulas<br/>                       | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk visible background and anchored elements<br/> | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) | toujours vrai                                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk visible footers<br/>                          | \-                                                                            | toujours vrai                                                                 | toujours faux                                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk visible headers<br/>                          | \-                                                                            | toujours vrai                                                                 | toujours faux                                                                                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) |                                                                               | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk visible empty images<br/>                     | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)                   | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai) | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk visible references<br/>                       | \-                                                                            | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : faux) | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : faux)    |
| wk pdfa version<br/>                             | \-                                                                            | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                     | \-                                                                            | \-                                                                               |
| wk page index<br/>                               | \-                                                                            | \-                                                                            | \-                                                                                              | \-                                                                            | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : 1)       |
| wk factur x<br/>                                 | \-                                                                            | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                     | \-                                                                            | \-                                                                               |
| wk files<br/>                                    | \-                                                                            | \-                                                                            | \-                                                                                              | ![](../../assets/en/WritePro/commands/pict5058606.en.png)                     | \-                                                                            | \-                                                                               |
| wk embedded pictures<br/>                        | \-                                                                            | \-                                                                            | \-                                                                                              | \-                                                                            | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : vrai)    |
| wk google fonts tag<br/>                         | \-                                                                            | \-                                                                            | \-                                                                                              | \-                                                                            | \-                                                                            | ![](../../assets/en/WritePro/commands/pict5058606.en.png) (par défaut : faux)    |

**Note de compatibilité :** Passer une valeur *entier long* dans *option* est pris en charge pour des raisons de compatibilité, mais il est recommandé d'utiliser un paramètre [objet](# "Données structurées sous forme d'objet natif 4D"). 

#### Exemple 1 

Vous souhaitez exporter le contenu de l'objet 4D Write Pro *myArea* au format MIME et ajouter "gmail.com" comme domaine hôte :

```4d
 var $option : Object
 
 $option[wk CID host domain name]:="gmail.com"
 
 WP EXPORT VARIABLE(myArea;$export;wk mime html;$option)

```

#### Exemple 2 

Vous voulez envoyer un mail contenant du texte multistyle, des références 4D et des images. Vous pouvez utiliser une zone 4D Write Pro exportée au format MIME HTML et l'envoyer en utilisant 4D Internet Commands :

```4d
 var $smtpid_l;$err_l;$smtpOption_l;$smtpPort_l : Integer
 var $str;$emailBody_t;$smtpHost_t;$emailTo_t;$emailFrom_t;$smtpPass_t : Text
 
  //export zone dans le format approprié
 WP EXPORT VARIABLE(myWPArea;$str;wk mime html)
 $emailTo_t:="johnsmith@4d.com"
 $emailFrom_t:="testWritePro@gmail.com"
 $emailBody_t:=$str
 $smtpHost_t:="smtp.gmail.com"
 $smtpOption_l:=9
 $smtpPort_l:=465
 $smtpPass_t:="QRN_on_bretzelburg"
 
 $err_l:=SMTP_QuickSend($smtpHost_t;$emailFrom_t;$emailTo_t;$emailTitle_t;\
 $emailBody_t;$smtpOption_l;$smtpPort_l;$smtpUser_t;$smtpPass_t)
 
 If(($err_l=0))
    ALERT("Message envoyé à "+emailTo_t)
 Else
    ALERT("Erreur dans les paramètres, veuillez réessayer.")
 End if
```

#### Exemple 3 

Pour exporter la première page d'un 4D Write Pro au format SVG dans une variable Texte et masquer les en-têtes :

```4d
 var $options : Object
 var $destination : Text
 
 $options:=New object
 $options[wk optimized for]:=wk screen
 $options[wk visible headers]:=false
 WP EXPORT VARIABLE(WPArea;$destination;wk svg;$options)
```

#### Voir aussi 

  
  
  
*Exporter au format .docx*  
*Exporter aux formats HTML et MIME HTML*  
[WP EXPORT DOCUMENT](../commands/wp-export-document.md)  