---
id: get-print-option
title: GET PRINT OPTION
slug: /commands/get-print-option
displayed_sidebar: docs
---

<!--REF #_command_.GET PRINT OPTION.Syntax-->**GET PRINT OPTION** ( *option* ; *valeur1* {; *valeur2*} )<!-- END REF-->
<!--REF #_command_.GET PRINT OPTION.Params-->
| Paramètre | Type |  | Description |
| --- | --- | --- | --- |
| option | Integer | &#8594;  | Numéro d’option ou Code d'option PDF |
| valeur1 | Integer, Text | &#8592; | Valeur 1 de l’option |
| valeur2 | Integer, Text | &#8592; | Valeur 2 de l’option |

<!-- END REF-->

*Cette commande n'est pas thread-safe, elle ne peut pas être utilisée dans du code préemptif.*


#### Description 

<!--REF #_command_.GET PRINT OPTION.Summary-->La commande **GET PRINT OPTION** retourne la ou les valeur(s) courante(s) d’une option d’impression.<!-- END REF--> 

Le paramètre *option* vous permet de désigner l’option à lire. Vous pouvez passer soit une constante du thème *Options d'impression* (entier long), soit un code d'option PDF (chaîne). 

Les constantes d'option sont les suivantes :

| Constante                     | Type        | Valeur | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ----------------------------- | ----------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Paper option                  | Entier long | 1      | Si vous passez uniquement *valeur1*, il contient le nom du papier. Si vous passez les deux paramètres, *valeur1* contient la largeur du papier et *valeur2* contient la hauteur du papier. La largeur et la hauteur sont exprimées en pixels écran. Utilisez la commande [PRINT OPTION VALUES](print-option-values.md) pour connaître le nom, la hauteur et la largeur de tous les formats de papier proposés par l’imprimante.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Orientation option            | Entier long | 2      | *valeur1* uniquement : 1=Portrait, 2=Paysage. Si une option d’orientation différente est utilisée, [GET PRINT OPTION](get-print-option.md) retourne 0 dans *valeur1*.<br/>**Versions 64 bits** : Cette option peut être appelée au sein d'une tâche d'impression, ce qui signifie que vous pouvez passer du mode portrait au mode paysage et inversement dans la même tâche d'impression.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Scale option                  | Entier long | 3      | *valeur1* uniquement : valeur d'échelle en pourcentage. Attention, certaines imprimantes ne permettent pas de modifier l’échelle. Si vous passez une valeur invalide, la propriété est remise à 100% au moment de l'impression.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Number of copies option       | Entier long | 4      | *valeur1* uniquement : nombre de copies à imprimer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Paper source option           | Entier long | 5      | (Windows uniqument) *valeur1* uniquement : numéro correspondant à l’indice, dans le tableau des bacs retourné par la commande [PRINT OPTION VALUES](print-option-values.md), du bac papier à utiliser. Cette option est utilisable sous Windows uniquement.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Color option                  | Entier long | 8      | (Windows uniquement) *valeur1* uniquement : code indiquant le mode de prise en charge de la couleur : 1=Noir et blanc (monochrome), 2=Couleur.<br/>**Versions 64 bits** : Cette option n'est pas prise en charge dans les versions 64 bits de 4D (obsolète).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Destination option            | Entier long | 9      | *valeur1*: code indiquant le type de destination de l’impression : 1=Imprimante, 2=Fichier (PC)/PS (Mac), 3=Fichier PDF, 5=Ecran (option du pilote OS X)<br/>Si *valeur1* est différent de 1 ou de 5, *valeur2* contient un chemin d’accès pour le document résultant. Ce chemin sera utilisé jusqu’à ce qu’un autre chemin soit spécifié. Si un fichier du même nom existe déjà à l’emplacement de destination, il est remplacé. Avec [GET PRINT OPTION](get-print-option.md), si la valeur courante n’est pas dans la liste prédéfinie, *valeur1* contient -1 et la variable système OK vaut 1\. Si une erreur se produit, *valeur1* et la variable système OK valent 0.<br/>Note (s**ous Windows) :** Pour imprimer un PDF sous Windows, vous devez appeler [SET CURRENT PRINTER](set-current-printer.md)(Generic PDF driver) et définir la destination d'impression 2 (Fichier) ou 3 (Fichier PDF). La destination d'impression 3 vous permet d'écrire du code multi-plate-forme. De plus, si le pilote PDF Creator a été installé et si une imprimante standard a été sélectionnée, lorsque les valeurs (9;3;chemin) sont passées, 4D lance automatiquement une impression PDF "silencieuse" et prend en compte les codes d'options éventuellement passés (à noter que si vous passez une chaîne vide dans *valeur2* ou omettez ce paramètre, une boîte de dialogue d’enregistrement de fichier apparaît au moment de l’impression). A l'issue de l'impression, les paramétrages courants sont restaurés. |
| Double sided option           | Entier long | 11     | *valeur1*: 0=Recto ou standard, 1=Recto-verso. Si *valeur1*\=1, *valeur2* contient la reliure à appliquer : 0=Reliure à gauche (valeur par défaut), 1=Reliure en haut.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Spooler document name option  | Entier long | 12     | *valeur1* uniquement : nom du document d’impression, qui apparaît dans la liste des documents du serveur d’impression. Le nom défini par cette instruction sera utilisé pour tous les documents d’impression de la session tant qu’un nouveau nom ou une chaîne vide ne sera pas passé(e). Pour utiliser ou rétablir le fonctionnement standard (utilisation du nom de la méthode dans le cas d’une méthode, nom de la table pour un enregistrement, etc.), passez une chaîne vide dans *valeur1*.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Mac spool file format option  | Entier long | 13     | (Mac uniquement) *valeur1* uniquement : 0=impression en mode PDF (valeur par défaut), 1=impression en mode Postscript.<br/>**Notes :** <br/>- Cette option n’a pas d’effet sous Windows.<br/>- Sous OS X, les impressions sont effectuées par défaut en mode PDF. Or, le pilote d’impression PDF ne prend pas en charge les images PICT encapsulant des informations Postscript — ces images sont générées notamment par des logiciels de dessin vectoriel. Pour résoudre ce problème, cette option permet de modifier le mode d’impression sous OS X pour la session courante. Attention, l'impression en mode Postscript peut entraîner des effets de bords indésirables.<br/>**Versions 64 bits :** Cette option n'est pas prise en charge ; elle est remplacée par l'utilisation de l'option Driver PDF générique de la commande [SET CURRENT PRINTER](set-current-printer.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Hide printing progress option | Entier long | 14     | (Mac 32 bits uniquement) *valeur1* uniquement : 1=masquer toutes les fenêtres de progression d'impression, 0=afficher les fenêtres de progression d'impression (fonctionnement par défaut). Cette option est particulièrement utile dans le cadre des impressions en PDF sous OS X.<br/>**Note :** Il existe déjà une option d’affichage Progression de l’impression accessible via la boîte de dialogue des Propriétés de la base (page Interface). Toutefois, elle est globale à l’application et ne masque pas toutes les fenêtres sous OS X.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

Un code d’option PDF est constitué de deux parties, *TypeOption* et *NomOption*, assemblées sous la forme "*TypeOption:NomOption*". 

La commande retourne dans les paramètres *valeur1* et (facultativement) *valeur2* la ou les valeur(s) courante(s) de l’*option* spécifiée. 

Pour plus d'informations sur les options, les codes d'option PDF et les valeurs possibles, reportez-vous à la description de la commande [SET PRINT OPTION](set-print-option.md). 

A noter les spécificités suivantes de la commande **GET PRINT OPTION** : 

* *option* \= 1 (Paper option) : retourne le nom du papier courant dans *valeur1* si *valeur2* est omis. Si *valeur2* est passé, la commande retourne respectivement la largeur et la hauteur du papier dans *valeur1* et *valeur2*. Utilisez la commande [PRINT OPTION VALUES](print-option-values.md) pour connaître le nom, la hauteur et la largeur de tous les formats de papier proposés par l’imprimante.
* *option* \= 2 (Orientation option) : retourne 1 (Portrait) ou 2 (Paysage). Si une option d’orientation différente est utilisée, valeur1 prend la valeur 0\.
* *option* \= 5 (Paper source option) : retourne dans *valeur1* l’indice, dans le tableau des bacs retourné par la commande [PRINT OPTION VALUES](print-option-values.md), du bac papier utilisé (*valeur2* doit être omis).  
**Note :** Cette option est utilisable sous Windows uniquement.
* *option* \= 8 (Color option) : retourne dans *valeur1* un code indiquant le mode de prise en charge de la couleur : 1=Noir et blanc (monochrome), 2=Couleur.  
**Note :** Cette option est utilisable sous Windows uniquement.
* *option* \= 9 (Destination option) : si la valeur courante n’est pas dans la liste prédéfinie, *valeur1* contient -1 et la variable système OK vaut 1\. Si une erreur se produit, *valeur1* et la variable système OK valent 0\. Si *valeur1* contient une valeur prédéfinie différente de 1 ou de 5, *valeur2* contient le chemin d’accès du fichier imprimé.
* *option* \= 11 (Double sided option) : retourne 0 (Standard ou Recto, valeur par défaut) ou 1 (Recto-verso) dans *valeur1*. Si *valeur1* vaut 1, *valeur2* peut retourner une des valeurs suivantes : 0=Reliure à gauche (par défaut), 1=Reliure en haut.  
**Note :** Cette option est utilisable sous Windows uniquement.
* *option* \= 12 (Spooler document name option) : retourne dans *valeur1* le nom du document d’impression courant, s’il a été défini au préalable. Sinon, une chaîne vide est retournée.

**Note :** La commande **GET PRINT OPTION** prend principalement en charge les imprimantes PostScript. Elle peut être utilisée avec d'autres types d'imprimantes, telles que PCL ou Ink, mais dans ce cas il est possible que certaines options ne soient pas disponibles. 

#### Variables et ensembles système 

La variable système OK prend la valeur 1 si la commande a été exécutée correctement, sinon elle prend la valeur 0\. 

#### Voir aussi 

[PRINT OPTION VALUES](print-option-values.md)  
[SET PRINT OPTION](set-print-option.md)  