---
id: monitored-activity
title: Monitored activity
slug: /commands/monitored-activity
displayed_sidebar: docs
---

<!--REF #_command_.Monitored activity.Syntax-->**Monitored activity**  : Collection<!-- END REF-->
<!--REF #_command_.Monitored activity.Params-->
| Paramètre | Type |  | Description |
| --- | --- | --- | --- |
| Résultat | Collection | &#8592; | Collection d'activités suivies |

<!-- END REF-->

#### Description 

<!--REF #_command_.Monitored activity.Summary-->La commande **Monitored activity** retourne une collection d'objets décrivant les opérations enregistrées selon les spécifications définies par la commande [START MONITORING ACTIVITY](start-monitoring-activity.md).<!-- END REF--> Elle peut être appelée et exécutée sur un 4D distant, 4D Server ou des applications 4D autonomes (si *source* n'est pas issu de l'activité réseau).

Les objets de la collection retournée possèdent les propriétés suivantes :

| **Propriété**    | **Type**    | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ---------------- | ----------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| activityKind     | Entier long | Le type d'activité enregistrée :<br/><br/> <table> <thead> <tr> <td>Constante</td> <td>Valeur</td> <td>Comment</td> </tr> </thead> <tbody> <tr> <td>Activity language</td> <td>1</td> <td>Opérations d'exécution du langage</td> </tr><tr> <td>Activity network</td> <td>2</td> <td>Opérations de requêtes réseau.</td> </tr><tr> <td>Activity operations</td> <td>4</td> <td>Opération de données 4D.</td> </tr> </tbody> </table> |
| activityDuration | Reée        | Durée de l'activité exprimée en secondes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| activityData     | Objet       | Objet(s) contenant des propriétés spécifiques selon le type d'activité enregistrée (*activityKind*). Dans certains cas, plusieurs objets peuvent être retournés pour la même opération. Dans ce cas, les objets auront le même UUID. Les propriétés supplémentaires de ces objets sont décrites dans les sections ci-dessous.                                                                                                                                                                                                                                                                                                                                                           |

##### activityKind = langage de l'activité (1) 

**Note :** L'objet *activityData* utilise les informations définies par la commande [SET DATABASE PARAMETER](set-database-parameter.md) pour *4DDebugLog.txt (standard)* (le cas échéant), sinon, elle utilise un mode par défaut. Le lancement de l'enregistrement des requêtes durant l'exécution de la commande **Monitored activity** aura une incidence sur les résultats retournés.

Objet *activityData* :

| **Propriété**   | **Type**    | **Description**                                                                                                                                                              |
| --------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| sequenceNumber  | entier long | Numéro d'opération unique et séquentiel dans la session d'historique.                                                                                                        |
| elapsedTime     | entier long | Temps écoulé depuis le lancement du journal de débogage (exprimé en millisecondes)                                                                                           |
| processID       | entier long | ID du process                                                                                                                                                                |
| uniqueProcessID | entier long | ID unique du process                                                                                                                                                         |
| stackLevel      | entier long | Niveau de stack                                                                                                                                                              |
| duration        | entier long | Durée de l'opéation (exprimée en microsecondes)                                                                                                                              |
| kind            | texte       | Le type d'opération enregistré. Valeurs possibles :<br/> "command" "method" "Message" "pluginMessage" "pluginCommand" "pluginCallback" "pluginEvent" "task" "member" |

###### Propriétés supplémentaires 

Les propriétés supplémentaires suivantes sont retournées dans l'objet *activityData* selon le type d'opération :

| **Propriété**       | **Type**    | **Type**                                                                                                                             | **Description**                                                                                                                                                                                                                                              |
| ------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| commandName         | texte       | commande                                                                                                                             | Nom de commande                                                                                                                                                                                                                                              |
| commandNumber       | entier long | commande                                                                                                                             | Numéro de commande                                                                                                                                                                                                                                           |
| connectionUUID      | texte       | task                                                                                                                                 | UUID de la machine cliente                                                                                                                                                                                                                                   |
| formEvent           | texte       | commande                                                                                                                             | Nom de l'événement formulaire                                                                                                                                                                                                                                |
| formMethod          | texte       | command                                                                                                                              | Méthode formulaire                                                                                                                                                                                                                                           |
| functionName        | texte       | member                                                                                                                               | Nom de la méthode membre ORDA                                                                                                                                                                                                                                |
| memberMethod        | texte       | command                                                                                                                              | Chaîne localisée de la méthode membre pour appeler l'objet 4D                                                                                                                                                                                                |
| method              | texte       | command                                                                                                                              | Noms localisés des commandes et fonctions 4D                                                                                                                                                                                                                 |
| parameters          | texte       | command<br/>member<br/>message<br/>method<br/>pluginCommand<br/>pluginEvent<br/>task | Paramètres passés dans l'opération                                                                                                                                                                                                                           |
| pluginCommandName   | texte       | pluginCommand<br/>pluginEvent                                                                                                | Nom de la commande du plug-in                                                                                                                                                                                                                                |
| pluginCommandNumber | entier long | pluginCommand<br/>pluginEvent<br/>pluginMessage                                                                      | Niméro de la commande du plug-in                                                                                                                                                                                                                             |
| pluginExternalCall  | entier long | pluginCallback                                                                                                                       | Appel du point d'entrée du plug-in SDK                                                                                                                                                                                                                       |
| pluginMessageName   | texte       | pluginMessage                                                                                                                        | Valeurs possibles : PackMsgServerDeInit PackMsgServerDisposeData PackMsgServerWriteData PackMsgServerReadData PackMsgServerKillClient PackMsgServerNewClient PackMsgServerInit PackMsgProcessDeInit PackMsgProcessInit PackMsgClientDeInit PackMsgClientInit |
| pluginName          | texte       | pluginCallback<br/>pluginCommand<br/>pluginEvent<br/>pluginMessage                                           | Nom du plug-in                                                                                                                                                                                                                                               |

##### activityKind = activité réseau (2) 

**Notes :**

* Si le journal de débogage a été stoppé sur la [GRAPH SETTINGS](graph-settings.md) de 4D Server, la commande **Monitored activity** ne retourne rien. Si le journal est relancé sur le serveur ou à l'aide de la commande [START MONITORING ACTIVITY](start-monitoring-activity.md) avec Activity network, **Monitored activity** reprendra la génération des informations de l'activité réseau.
* L'objet *activityData* utilise les informations définies par la commande [SET DATABASE PARAMETER](set-database-parameter.md) pour *4DRequestsLog.txt* (le cas échéant), sinon, elle utilise un mode par défaut. Le lancement de l'enregistrement des requêtes durant l'exécution de la commande **Monitored activity** aura une incidence sur les résultats retournés.

L'objet *activityData* :

| **Propriété**    | **Type**    | **Description**                                                                                                                                                                                                                                                                                                                                                                    |
| ---------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| sequenceNumber   | entier long | Numéro d'opération unique et séquentiel dans la session d'historique.                                                                                                                                                                                                                                                                                                              |
| time             | texte       | Date et heure au format ISO 8601 : ("YYYY-MM-DDTHH:MM:SS.sss")                                                                                                                                                                                                                                                                                                                     |
| systemID         | texte       | ID du système                                                                                                                                                                                                                                                                                                                                                                      |
| component        | texte       | Signature du composant (par exemple '4SQLS' ou 'dbmg')                                                                                                                                                                                                                                                                                                                             |
| processInfoIndex | entier long | Correspond au champ "index" dans le fichier d'historique *4DRequestsLog\_ProcessInfo.txt*, et permet de relier une requête à un process                                                                                                                                                                                                                                            |
| request          | entier long | ID de requête pour les messages c/s, les requêtes SQL, ou les messages [LOG EVENT](log-event.md)                                                                                                                                                                                                                                                                                   |
| bytesIn          | entier long | Nombre d'octets reçus                                                                                                                                                                                                                                                                                                                                                              |
| bytesOut         | entier long | Nombre d'octets envoyés                                                                                                                                                                                                                                                                                                                                                            |
| execDuration     | entier long | En fonction de l'emplacement de leur génération :server\_duration . <br/>OU,exec\_duration lorsqu'il est généré sur le serveur  \--Temps en microsecondes pris par le serveur pour traiter la requête.  .                                                                                                                                                                  |
| writeDuration    | entier long | Temps en microsecondes pris pour envoyer :La requête (lorsqu'elle est exécutée sur le client).La réponse (lorsqu'elle est exécutée sur le serveur).                                                                                                                                                                                                                                |
| serverDuration   | entier long | Durée de la communication client/serveur                                                                                                                                                                                                                                                                                                                                           |
| taskKind         | texte       | Préemprtif ou coopératif (respectivement 'p' ou 'c')                                                                                                                                                                                                                                                                                                                               |
| rtt              | entier long | Temps en microsecondes pris par le client pour envoyer la requête et pour qu'elle soit reçue par le serveur. Mesuré uniquement lorsque la couche réseau ServerNet est utilisée, retourne 0 lorsque l'ancienne couche réseau est utilisée.Dans les versions antérieures à Windows 10 ou Windows Server 2016, l'appel retournera la valeur 0.<br/><br/><br/> |

##### activityKind = opérations de l'activité (4) 

**Note :** L'objet *activityData* et l'objet retourné par la commande [ACTIVITY SNAPSHOT](activity-snapshot.md) sont similaires, excepté que *activityData* est soumis à un seuil et que les opérations terminées sont retournées :

L'objet *activityData* :

| **Propriété**          |            | **Type**                                                                                                                                                                           | **Description**                                                                                                                                                                                  |
| ---------------------- | ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| message                |            | text                                                                                                                                                                               | Description de l'opération                                                                                                                                                                       |
| maxValue               |            | longint                                                                                                                                                                            | Nombre maximal d'itérations de l'opération (valeur=-1 pour les opérations non itératives)                                                                                                        |
| remote-                |            | boolean                                                                                                                                                                            | Opération client / serveur. Valeurs possibles : true, false                                                                                                                                      |
| uuid                   |            | text                                                                                                                                                                               | UUID de l'opération                                                                                                                                                                              |
| taskId                 |            | longint                                                                                                                                                                            | Identifiant 4D interne du process d'origine                                                                                                                                                      |
| startTime              |            | text                                                                                                                                                                               | Heure de début de l'opération au format ISO 8601 ("YYYY-MM-DDTHH:MM:SS.sss")                                                                                                                     |
| duration               |            | longint                                                                                                                                                                            | Durée totale (exprimée en millisecondes) de l'exécution de l'opération                                                                                                                           |
| title                  |            | text                                                                                                                                                                               | Informations supplémentaires de l'opération                                                                                                                                                      |
| extraInfo              |            | object                                                                                                                                                                             | Informations SQL supplémentaires (le cas échéant) :<br/><br/> extraInfo.SQL\_Query (text): La requête SQL extraInfo.SQL\_User (text): Utilisateur authentifié sur le serveur SQL |
| dbContextInfo          |            | object                                                                                                                                                                             | Informations contextuelles de l'opération                                                                                                                                                        |
| |  host\_name          | text       | Nom de l'hôte ayant lancé l'opération                                                                                                                                              |                                                                                                                                                                                                  |
| |  user\_name          | text       | Nom de l'utilisateur 4D dont la session a lancé l'opération                                                                                                                        |                                                                                                                                                                                                  |
| |  task\_name          | text       | Nom du process ayant lancé l'opération                                                                                                                                             |                                                                                                                                                                                                  |
| |  task\_id            | longint    | ID du process ayant lancé l'opération                                                                                                                                              |                                                                                                                                                                                                  |
| |  client\_uid         | text       | (opération en c/s uniquement) UUID de la machine cliente ayant lancé l'opération dans la base de données                                                                           |                                                                                                                                                                                                  |
| |  is\_remote\_context | longint    | (opération en c/s uniquement) Indique si l'opération a été lancée par le serveur via une procédure stockée (valeur=0) ou par un client (valeur=1)                                  |                                                                                                                                                                                                  |
| |  user4d\_id          | longint    | ID de l'utilisateur 4D sur la machine cliente                                                                                                                                      |                                                                                                                                                                                                  |
| |  user4d\_alias       | text       | Alias défini pour l'utilisateur 4D. Voir [SET USER ALIAS](set-user-alias.md)                                                                                                       |                                                                                                                                                                                                  |
| |  client\_version     | text       | Valeur de chaîne encodée qui exprime le numéro de version de l'environnement 4D retourné par la commande [Application version](application-version.md)                             |                                                                                                                                                                                                  |
| dbOperationDetails     |            | object                                                                                                                                                                             | Informations sur les appels d'opérations vers le moteur de base de données                                                                                                                       |
| |  table               | text       | Nom de la table dans l'opération                                                                                                                                                   |                                                                                                                                                                                                  |
| |  field               | text       | Nom du champ de la table dans l'opération                                                                                                                                          |                                                                                                                                                                                                  |
| |  queryPlan           | text       | Plan de requête pour l'opération                                                                                                                                                   |                                                                                                                                                                                                  |
| |  operationType       | text       | Type d'opération                                                                                                                                                                   |                                                                                                                                                                                                  |
| |  sortParameters      | collection | Critère de tri                                                                                                                                                                     |                                                                                                                                                                                                  |
| subOperations          |            | collection                                                                                                                                                                         | collection d'objets activytData contenant des informations sur les opérations subordonnées dans l'opération courante.                                                                            |
| |  \[ \].message       | text       | Libellé des opérations                                                                                                                                                             |                                                                                                                                                                                                  |
| |  \[ \].maxValue      | longint    | Nombre maximal d'itérations pour l'opération (valeur=-1 pour les opérations non itératives)                                                                                        |                                                                                                                                                                                                  |
| |  \[ \].remote        | boolean    | Opérations client / serveur (0=true, 1=false)                                                                                                                                      |                                                                                                                                                                                                  |
| |  \[ \].uuid          | text       | UUID de l'opération                                                                                                                                                                |                                                                                                                                                                                                  |
| |  \[ \].taskId        | longint    | Identifiant 4D interne du process d'origine                                                                                                                                        |                                                                                                                                                                                                  |
| |  \[ \].startTime     | text       | Heure de début de l'opération au format ISO 8601 ("YYYY-MM-DDTHH:MM:SS.sss")                                                                                                       |                                                                                                                                                                                                  |
| |  \[ \].duration      | longint    | Durée totale (exprimée en millisecondes) de l'exécution de l'opération                                                                                                             |                                                                                                                                                                                                  |
| |  \[ \].title         | text       | Informations supplémentaires sur l'opéraiton                                                                                                                                       |                                                                                                                                                                                                  |
| |  \[ \].extraInfo     | object     | Informations SQL supplémentaires (le cas échéant) : \[ \].extraInfo.SQL\_Query (text): La requête SQL \[ \].extraInfo.SQL\_User (text): Utilisateur authentifié sur le serveur SQL |                                                                                                                                                                                                  |

#### Exemple 

Voir l'exemple de **[START MONITORING ACTIVITY](start-monitoring-activity.md).**

#### Voir aussi 

[START MONITORING ACTIVITY](start-monitoring-activity.md)  
[STOP MONITORING ACTIVITY](stop-monitoring-activity.md)  

#### Propriétés

|  |  |
| --- | --- |
| Numéro de commande | 1713 |
| Thread safe | &check; |


