---
id: restore
title: 復元ページ
sidebar_label: 復元ページ
---

You can manually restore an archive of the current application using the **Restore** page. このページでは、復元処理を制御するためのオプションをいくつか提供します:

![](../assets/en/MSC/MSC_restore.png)

> 4D の自動復元機能は、アプリケーション復元後に場合に応じてデータログファイルを統合します。

ウィンドウの左側には、アプリケーションの既存のバックアップが表示されます。 You can also click on the **Browse...** button found just under the area in order to open any other archive file from a different location. 選択したアーカイブはリストに追加されます。

このリストからバックアップファイルを選択すると、ウィンドウの右側にはそのバックアップについての説明が表示されます:

- **Path**: Complete pathname of the selected backup file. <strong x-id="1">表示</strong> ボタンをクリックすると、システムウィンドウでバックアップファイルが表示されます。
- **Date and Time**: Date and time of backup.
- **Content**: Contents of the backup file. 各項目の右側にはチェックボックスがあり、復元をおこなうかどうか、ファイルごとに選択できます。 You can also use the **Check All** or **Uncheck All** buttons to set the list of items to be restored.
- **Destination folder of the restored files**: Folder where the restored files will be placed. デフォルトで 4D は Projectフォルダーと同階層にアーカイブ名 (拡張子なし) のフォルダーを作成し、そこにファイルを復元します。 To change this location, click on **[...]** and specify the folder where you want the restored files to be placed.

The **Restore** button launches the manual restoration of the selected element(s).

## 複数のログファイルを連続して統合する

The **Integrate one or more log file(s) after restore** option allows you to integrate several data log files successively into an application. たとえば、4つのバックアップに対応する 4つのログファイルアーカイブがある場合、最初のバックアップを復元して、ログアーカイブを一つずつ統合することが可能です。 これにより、たとえば最新のバックアップファイルを失った場合でも、データファイルを復旧することができます。

このオプションが選択されていると、4Dは復元後に標準のファイルを開くダイアログを表示します。ここで統合するログファイルを選択できます。 ファイルを開くダイアログは、キャンセルされるまで統合の都度表示されます。

## 暗号化されたデータベースの復元

カレントアプリケーションと複数のバックアップファイル (.4BK) やログファイル (.4BL) の間で、データ暗号化キー (パスフレーズ) が変更されている可能性があることに注意が必要です。 合致した暗号化キーは常に必要となります。

暗号化されたデータベースのバックアップを復元し、カレントログファイルを統合したい場合、以下の点に注意してください:

- 古いパスフレーズを使用してバックアップを復元した場合、そのパスフレーズは次回のデータベース起動時に必要となります。
- 暗号化のあと、暗号化されたデータファイルを開く際に、バックアップが実行され新しいログファイルが作成されます。 そのため、バックアップファイル (.4BK) を特定のキーで復号化した後、異なるキーで暗号化されたログファイル (.4BL) をそれに統合することはできません。

以下の表は、複数のキーを使用したバックアップ/復元操作における過程の一例をまとめたものです:

| 演算                                    | 生成されるファイル                                                                                | 説明                                                                                                                                                                                                      |
| ------------------------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 新規データファイル作成                           |                                                                                          |                                                                                                                                                                                                         |
| 新規データ追加 (レコード番号1番) |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0000.4BL および 0001.4BK                                    |                                                                                                                                                                                                         |
| データを追加 (レコード番号2番)  |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0001.4BL および 0002.4BK                                    |                                                                                                                                                                                                         |
| データを追加 (レコード番号3番)  |                                                                                          |                                                                                                                                                                                                         |
| Key1を使用してデータファイルを暗号化                  | 0003.4BK ファイル (Key1で暗号化)                              | 暗号化をすると (ログファイルも含め) 元のファイルは "Replaced files (Encrypting) YYY-DD-MM HH-MM-SS" というフォルダーに保存されます。 暗号化されたデータファイルを開く際、新しいログファイルが作成され、このログファイルを有効化するためにバックアップ処理がおこなわれます。 |
| データを追加 (レコード番号4番)  |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0003.4BL および 0004.4BK ファイル (Key1で暗号化) | 0003.4BK を復元し、0003.4BL を統合することが可能です                                                                                                                                     |
| データを追加 (レコード番号5番)  |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0004.4BL および 0005.4BK ファイル (Key1で暗号化) | 0003.4BK を復元し、0003.4BL + 0004.4BL を統合することが可能です。 また、0004.4BK を復元し、0004.4BL を統合することが可能です。                                 |
| データを追加 (レコード番号6番)  |                                                                                          |                                                                                                                                                                                                         |
| Key2を使用してデータファイルを暗号化                  | 0006.4BK ファイル (Key2で暗号化)                              | 暗号化をすると (ログファイルも含め) 元のファイルは "Replaced files (Encrypting) YYY-DD-MM HH-MM-SS" というフォルダーに保存されます。 暗号化されたデータファイルを開く際、新しいログファイルが作成され、このログファイルを有効化するためにバックアップ処理がおこなわれます。 |
| データを追加 (レコード番号7番)  |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0006.4BL および 0007.4BK ファイル (Key2で暗号化) | 0006.4BK を復元し、0006.4BL を統合することが可能です                                                                                                                                     |
| データを追加 (レコード番号8番)  |                                                                                          |                                                                                                                                                                                                         |
| データベースをバックアップ                         | 0007.4BL および 0008.4BK ファイル (Key2で暗号化) | 0006.4BK を復元し、0006.4BL + 0007.4BL を統合することが可能です。 また、0007.4BK を復元し、0007.4BL を統合することが可能です。                                 |

> バックアップを復元し、一つ以上の .4BL ファイルを統合する場合、復元された .4BK ファイルおよび .4BL ファイルは同じ暗号化キーを持っていなければなりません。 統合プロセスの間、.4BL ファイルが統合される際に有効な暗号化キーが 4Dキーチェーンに見つからなかった場合、エラーが生成されます。
>
> 連続した複数のデータキーを同じ外部デバイスに保存していた場合、バックアップの復元とログファイルの統合をおこなうと、デバイスが接続されていれば合致するキーの検索が自動的におこなわれます。
