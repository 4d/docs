---
id: import-data
title: IMPORT DATA
slug: /commands/import-data
displayed_sidebar: docs
---

<!--REF #_command_.IMPORT DATA.Syntax-->**IMPORT DATA** ( *fileName* {; *project* {; *}} )<!-- END REF-->
<!--REF #_command_.IMPORT DATA.Params-->
| 引数 | 型 |  | 説明 |
| --- | --- | --- | --- |
| fileName | Text | &#8594;  | インポートファイルのフルパス名 |
| project | Text, Blob | &#8594;  | インポートプロジェクト |
| &#8592; | インポートプロジェクトの新しい内容 (*引数指定時) |
| * | 演算子 | &#8594;  | インポートダイアログを表示し プロジェクトの内容を更新 |

<!-- END REF-->

#### 説明 

<!--REF #_command_.IMPORT DATA.Summary-->**IMPORT DATA**コマンドはデータを*fileName*ファイルから読み込みます。<!-- END REF-->4Dは以下のフォーマットのデータ読み込みを行えます: テキスト、固定長テキスト、XML、SYLK、DIF、DBF（dBase）および4Dフォーマット

*fileName*に空の文字列を渡すと、**IMPORT DATA**は標準のファイルを選択ダイアログボックスを表示して、ユーザが読み込みファイルの名前、タイプおよび場所を指定することができるようにします。ダイアログボックスが受け入れられると、Documentシステム変数にファイルパスが設定されます。ユーザが**キャンセル**をクリックすると、コマンドの実行は停止されて、システム変数OKは0になります。

オプション引数*project*を使用すると、データ読み込みにプロジェクトを使用できます。この引数を渡すと、読み込みはユーザーの操作を経ることなく直接行われます (後述の *\** 引数を指定しない限り)。 この引数を渡さないと、読み込みダイアログボックスが表示されます。ユーザーは読み込みパラメターを指定するか、既存の読み込みプロジェクトをロードできます。

読み込みプロジェクトには、読み込むテーブルやフィールド、区切り符号のような読み込みに関するすべてのパラメターが含まれています。*project*引数にはXMLで記述されたテキスト変数、定義済みのDOM要素への参照を格納したテキスト変数、またはBLOBのいずれかを渡せます。プロジェクトはプログラム (XMLフォーマットのプロジェクトのみ)、または読み込みダイアログボックスで事前に定義済みのパラメターをロードすることで作成できます。後者の場合、2つの方法を利用できます:

* 空のプロジェクト引数およびオプションの *\** 付きで**IMPORT DATA**コマンドを使用し、ダイアログでの設定内容を*project*引数に受け取って、それをテキストまたはBLOBフィールドに格納します (後述)。この方法ではプロジェクトをデータファイルに保存できます。
* プロジェクトをディスクに保存し、[DOM Parse XML source](dom-parse-xml-source.md)コマンド等を使用してロードします。そしてその参照を*project*引数に渡します。

**互換性に関する注意:** 4D v12より、読み込みプロジェクトはXMLにエンコードされるようになりました。4Dは以前のバージョンで作成された読み込みプロジェクト (BLOB形式) を開くことができます。しかし4D v12以降で作成されたプロジェクトをv11以前で開くことはできません。読み込みファイルを扱う際は、以降テキスト変数を使用することをお勧めします。

オプションの引数 *\** が指定されていれば、*project*に定義されたパラメターと共にデータ読み込みダイアログボックスを表示します。これは、定義済みのプロジェクトを使用しつつ、いくつかのパラメターを変更できるようにするものです。さらにデータ読み込みダイアログボックスを閉じた後に、*project*引数には、新しいプロジェクトのパラメターが格納され、この新しいプロジェクトをBLOBフィールドやディスク等に保存することができます。

データ読み込みが正常に終了すると、OKシステム変数は1になります。

**Note:** 空のプロジェクトを使用してプロジェクトを保存する例題は[EXPORT DATA](export-data.md "EXPORT DATA") コマンドを参照してください。

#### システム変数およびセット 

標準のファイルを保存または読み込みダイアログボックスでユーザがキャンセルをクリックするとOKシステム変数は0に設定されます。読み込みが行われると1に設定されます。

#### 参照 

[EXPORT DATA](export-data.md)  
[IMPORT DIF](import-dif.md)  
[IMPORT SYLK](import-sylk.md)  
[IMPORT TEXT](import-text.md)  

#### プロパティ

|  |  |
| --- | --- |
| コマンド番号 | 665 |
| スレッドセーフである | &check; |
| システム変数を更新する | OK |


