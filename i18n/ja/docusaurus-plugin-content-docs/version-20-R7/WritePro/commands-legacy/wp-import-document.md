---
id: wp-import-document
title: WP Import document
slug: /WritePro/commands/wp-import-document
displayed_sidebar: docs
---

<!--REF #_command_.WP Import document.Syntax-->**WP Import document** ( *filePath* {; *option*} ) -> 戻り値<!-- END REF-->
<!--REF #_command_.WP Import document.Params-->
| 引数 | 型 |  | 説明 |
| --- | --- | --- | --- |
| filePath | Text | &#8594;  | 4D Write ドキュメント(.4w7または.4wt)へのパス、または<br/>4D Write Pro ドキュメント(.4wp)へのパス、または<br/>.docx ドキュメント(.docx)へのパス |
| option | Integer, Object | &#8594;  | (倍長整数) HTML 式の読み込みオプション(オブジェクト型) .docx ドキュメント用の読み込みオプション |
| 戻り値 | Object | &#8592; | 4D Write Proオブジェクト |

<!-- END REF-->

## 説明 

<!--REF #_command_.WP Import document.Summary-->**WP Import document** コマンドは既存の4D Write Proドキュメント/4D Write ドキュメント(.4w7 または .4wt)を新規の4D Write Proオブジェクトへと変換します。<!-- END REF-->

*filePath* 引数には、ディスク上に保存されたドキュメントへのパスを渡します。以下のタイプのドキュメントがサポートされています:

* 以前の4D Write ドキュメント(.4w7 or .4wt)。4D Write Proオブジェクト内で現在サポートされている4D Writeの昨日の詳細な一覧に着いては、*4D Write ドキュメントの読み込み* の章を参照して下さい。
* 4D Write Pro(.4wp)フォーマットドキュメント。4D Write Proドキュメントフォーマットについてのより詳細な情報に関しては、*.4wp ドキュメントフォーマット* を参照して下さい。
* .docx フォーマットのドキュメント。詳細な情報については、*.docxフォーマットの読み込み/書き出し* を参照してください。

パスは完全なパスを渡す必要があります。ドキュメントがストラクチャーファイルと同等の階層の保存されている場合に限り、ドキュメント名のみを渡す事もできます。

**注:** 4D BLOBフィールドに保存されたドキュメントを読み込みたい場合には、[WP New](wp-new.md) コマンドの使用も検討してみて下さい。

*filePath* 引数に渡したパスが無効な場合、またはファイルが見つからない場合、または指定したファイルがサポートされていないフォーマットだった場合、エラーが返されます。

任意の *option* 引数を渡すと、以下のような読み込みオプションを定義することができます:

* **倍長整数型**  
    
デフォルトで、旧式の4D Write ドキュメント内で使用されているHTML 式は読み込まれません(4D Write Pro ではサポートされません)。wk import html expressions as text 定数を渡した場合、HTML 式は*##htmlBegin##* および *##htmlEnd##* タグで囲まれた標準テキストとして読み込まれるため、そのあとに整形アクションが必要になります。例:  
    
```RAW  
##htmlBegin##Imported titlebold##htmlEnd##  
```
* **オブジェクト型**  
    
以下のプロパティを持ったオブジェクトを渡すことで、読み込みオペレーション中に以下の属性がどのように扱われるかを定義することができます:  
    
    
| **属性**                  | **型** | **詳細**                                                                                                                                                                                                                                                                                                                                                                                                 |  
| ----------------------- | ----- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |  
| anchoredTextAreas       | テキスト  | MS Word (.docx) ドキュメントのみ有効。アンカーされたテキストがどのように管理されるかを指定します。取り得る値:<br/><br/> **anchored** (デフォルト) - アンカーされたテキストエリアはテキストボックスとして扱われます。 **inline** \- アンカーされたテキストはアンカーされた位置でインラインテキストとして扱われます。 **ignore** \- アンカーされたテキストは無視されます。 **注**: ドキュメント内のレイアウトとページが変化する可能性があります。*.docx フォーマットのファイルの読み込み方* も参照してください。                                                                                  |  
| anchoredImages          | テキスト  | MS Word (.docx) ドキュメントのみ有効。アンカーされた画像がどのように管理されるかを指定します。取り得る値:<br/><br/> **all** (デフォルト) - アンカーされた画像は全てアンカーされた画像としてテキスト折り返しプロパティとともに読み込まれます(例外: .docx の折り返しオプション"tight"はwrap square として読み込まれます)。 **ignoreWrap** \- アンカーされた画像は全て読み込まれますが、画像の周りにテキスト折り返しがある場合は無視されます。 **ignore** \- アンカーされた画像は読み込まれません。                                                                                   |  
| sections                | テキスト  | MS Word (.docx) ドキュメントのみ有効。セクションがどのように管理されるかを指定します。取り得る値:<br/><br/> **all** (デフォルト) - 全てのセクションが読み込まれます。継続されたセクション、奇数/偶数セクションは全て標準のセクションへと変換されます。 **ignore** \- セクションは全てデフォルトの4D Write Pro セクション(A4/縦向きレイアウト/ヘッダーやフッターはなし)へと変換されます。 **注**: 継続されたセクションブレークを除く全てのセクションブレークはセクションブレークを伴う改ページへと変換されます。継続されたセクションブレークは継続したセクションブレークとして読み込まれます。                                               |  
| fields                  | テキスト  | MS Word (.docx) ドキュメントのみ有効。4D Write Pro フォーミュラに変換できない.docx フィールドがどのように管理されるかを指定します。取り得る値:<br/><br/> **ignore** \- .docx フィールドは無視されます。 **label** \- .docx フィールド参照は二重中括弧 ("{{ }}")がついたラベルとして読み込まれます。例: "ClientName" フィールドは{{ClientName}} として読み込まれます。 **value** (デフォルト) - .docx フィールドの最後の計算された値が読み込まれます。 **注**: .docx フィールドが4D Write Pro 変数に対応している場合、フィールドはフォーミュラとして読み込まれ、このオプションは無視されます。 |  
| borderRules             | テキスト  | MS Word (.docx) ドキュメントのみ有効。段落の境界線がどのように管理されるかを指定します。取り得る値:<br/><br/> **collapse** \- 段落フォーマットは自動折りたたみ境界線を真似するように変更されます。折りたたみプロパティは読み込みオペレーションのときにしか適用されないと言う点に注意してください。自動境界線折りたたみ設定のあるスタイルシートが読み込みオペレーションの後に再適用された場合、この設定は無視されます。 **noCollapse** (デフォルト) - 段落フォーマットは変更されません。                                                                                                           |  
| preferredFontScriptType | テキスト  | MS Word (.docx) ドキュメントのみ有効。OOXML 内の単一フォントプロパティとして異なるタイプフェイスが定義されていた場合にどのタイプフェイスを使用するかを指定します。取り得る値:<br/><br/> **latin** (デフォルト) - ラテン文字 **bidi** \-双方向テキスト。ドキュメントが双方向でleft-to-right(LTR)またはright-to-left(RTL)テキストの場合に適しています(例:アラビア文字やヘブライ文字)。 **eastAsia** \- 東アジア文字(縦書き文字)。ドキュメントが日本語などのアジア系テキストの場合に適しています。                                                                            |  
| htmlExpressions         | テキスト  | 4D Write (.4w7) ドキュメントのみ有効。HTML 式がどのように管理されるかを指定します。取り得る値: <br/><br/> **rawText** \- HTML テキストは##htmlBegin## および ##htmlEnd## タグに挟まれた標準テキストとして読み込まれます。 **ignore** (デフォルト) - HTML 式は無視されます。                                                                                                                                                                                              |  
| importDisplayMode       | テキスト  | 4D Write (.4w7) ドキュメントのみ有効。画像の表示が管理されるかを指定します、取り得る値:<br/><br/> **legacy -** 4W7 画像の表示モードは、縮小して表示以外の場合には背景画像として変換冠されます。 **noLegacy** (デフォルト) - 4W7 画像の表示モードは縮小して表示以外の場合には*imageDisplayMode* 属性に変換されます。                                                                                                                                                                                  |

**互換性に関する注意:** 

* *旧式の4D Write ドキュメント内で使用される文字スタイルシートは独自の機構が使用されており、これは4D Write Pro ではサポートされていないものです。インポートされたテキストを可能な限り再現するため、スタイルシート属性は"ハードコード"スタイル属性へと変換されています。旧式の文字スタイルシートは読み込まれず、今後ドキュメント内では参照されることはありません。*
* *.docx フォーマットからの読み込みのサポートはMicrosoft Word 2010 以降でのみ認定されています。それ以前のバージョン、具体的には* *Microsoft Word 2007 などでは、正しく読み込まれない可能性があります。*

## 例題 1 

```4d
 var WPDoc : Object
 WPDoc:=WP Import document("C:\\documents\\4DWriteDocs\\Letter.4w7")
```

## 例題 2 

.docx ドキュメントを読み込み、段落境界線がMS Word のように折りたたまれていてほしい場合を考えます:

```4d
 $options:=New object
 $options.borderRules:="collapse" // 変換時に段落境界線を減少させる
 
 wpDoc:=WP Import document("mydoc.docx";$options)
```

オリジナルの.docx フィールドをテキストとして読み込みたい場合を考えます(4D フォーミュラに変換できないフィールドの場合):

```4d
 $options:=New object
 $options.fields:="label" // 変換されていないフィールドは、{{ と }} に挟まれたテキストとして読み込まれます。
 
 wpDoc:=WP Import document("mydoc.docx";$options)
```

テキストが主に日本語である.docx ドキュメントを読み込みたい場合を考えます:

```4d
 $options:=New object¥
 $options.preferredFontScriptType:="eastAsia" // 強制的に東アジアフォント文字に適した変換をします
 
 wpDoc:=WP Import document("mydoc.docx";$options)
```

## 参照 

[WP New](wp-new.md)  