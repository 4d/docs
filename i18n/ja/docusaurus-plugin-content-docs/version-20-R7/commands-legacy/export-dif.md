---
id: export-dif
title: EXPORT DIF
slug: /commands/export-dif
displayed_sidebar: docs
---

<!--REF #_command_.EXPORT DIF.Syntax-->**EXPORT DIF** ( {*aTable* ;} *document* )<!-- END REF-->
<!--REF #_command_.EXPORT DIF.Params-->
| 引数 | 型 |  | 説明 |
| --- | --- | --- | --- |
| aTable | Table | &#8594;  | データを書き出すテーブル, または 省略した場合, デフォルトテーブル |
| document | Text | &#8594;  | データが書き出されるDIFドキュメント |

<!-- END REF-->

*このコマンドはスレッドセーフではないため、プリエンプティブなコードには使えません。*


#### 説明 

<!--REF #_command_.EXPORT DIF.Summary-->EXPORT DIF コマンドは、カレントプロセスにおける*aTable*のカレントセレクションのレコードをディスクに書き出します。<!-- END REF-->このデータは*document*に書き込まれます。*document*は、WindowsまたはMacintoshの標準的なDIF形式のドキュメントです。 

データの書き出し処理は、カレント出力フォームを介して実行します。このデータ書き出し処理は、出力フォーム上のフィールドや変数をその入力順序に 従って書き出します。このため、書き出したいフィールドと入力可能オブジェクトのみを含んだ出力フォームを使用する必要があります。書き出し用のフォーム にボタンやその他関係ないオブジェクトを配置しないでください。サブフォームオブジェクトは無視されます。

書き出されるレコードごとに、On Loadイベントがフォームメソッドに送られます。このイベントを利用して、書き出し用フォームで使用する変数を設定します。

*document*引数には、新規または既存のドキュメントファイルを指定することができます。*document*が既存のドキュメントファイルと同じ名前の場合には、そのドキュメントファイルは上書きされます。また、*document*にはボリューム名やフォルダ名等のパスを含めることもできます。空の文字列を渡すと、標準のファイルを保存ダイアログボックスが表示されます。ユーザがこのダイアログボックスをキャンセルすると、データ書き出し処理は中止され、システム変数OKには0がセットされます。

データの書き出し処理中には進捗インジケータが表示されます。インジケータの中止ボタンをクリックすると、処理を中断します。書き出しが正常に完了 すると、システム変数OKに1がセットされ、エラーが発生、または処理が中断された場合には0がセットされます。インジケータを表示したくない場合には、[MESSAGES OFF](messages-off.md "MESSAGES OFF")コマンドを使用してください。

デフォルトでは、コマンドはデフォルトでUTF-8文字セットを使用します。DIFフォーマットドキュメントは一般的にIBM437文字セットを使用するため、適切な文字セットを指定するために[USE CHARACTER SET](use-character-set.md "USE CHARACTER SET")コマンドを使用する必要があるでしょう。

EXPORT DIF を使用する際、デフォルトのフィールド区切り文字はタブ文字 (コード 9) です。デフォルトのレコード区切り文字はキャリッジリターン (コード 13) です。これらの値は2つの *システム変数*、 FldDelimit と RecDelimit に新しい値を代入することによって変更できます。ユーザはこれらのデフォルト値をデザインモードの書き出しダイアログで変更できます。テキストフィールドにはタブやキャリッジリターンを含めることができるので、これらの値を区切り文字として使用する際は注意が必要です。

#### 例題 

以下の例は、データをDIFドキュメントファイルに書き出します。まず、メソッドの最初で書き出しに使用する出力フォームを設定し、次にデータ書き出しを実行します:

```4d
 FORM SET OUTPUT([People];"Export")
 EXPORT DIF([People];"NewPeople.dif"")  // "NewPeople.dif" ドキュメントに書き出しを行う
```

#### システム変数およびセット 

コマンドが正しく実行されるとシステム変数OKに1が設定され、そうでなければ0が設定されます。

#### 参照 

[EXPORT SYLK](export-sylk.md)  
[EXPORT TEXT](export-text.md)  
[IMPORT DIF](import-dif.md)  
[USE CHARACTER SET](use-character-set.md)  