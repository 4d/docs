---
id: listbox-set-footer-calculation
title: LISTBOX SET FOOTER CALCULATION
slug: /commands/listbox-set-footer-calculation
displayed_sidebar: docs
---

<!--REF #_command_.LISTBOX SET FOOTER CALCULATION.Syntax-->**LISTBOX SET FOOTER CALCULATION** ( {* ;} *object* ; *calculation* )<!-- END REF-->
<!--REF #_command_.LISTBOX SET FOOTER CALCULATION.Params-->
| 引数 | 型 |  | 説明 |
| --- | --- | --- | --- |
| * | 演算子 | &#8594;  | 指定時objectはオブジェクト名 (文字列)、省略時objectは変数 |
| object | any | &#8594;  | オブジェクト名 (* 指定時) または 変数 (* 省略時) |
| calculation | Integer | &#8594;  | フッターエリアの計算タイプ |

<!-- END REF-->

*このコマンドはスレッドセーフではないため、プリエンプティブなコードには使えません。*


#### 説明 

<!--REF #_command_.LISTBOX SET FOOTER CALCULATION.Summary-->**LISTBOX SET FOOTER CALCULATION**コマンドは*object* と *\** 引数で指定したリストボックスのフッターに割り当てる自動計算を設定します。<!-- END REF-->

オプションの *\** 引数を渡した場合、*object* 引数はオブジェクト名 (文字列) です。この引数を渡さない場合 *object* は変数です。この場合文字列ではなく変数参照を渡します。

*object* 引数では以下を指定できます:

* フッターエリアの変数あるいはオブジェクト名。この場合コマンドはこのエリアに適用されます。
* リストボックス列の変数あるいはオブジェクト名。この場合コマンドはこの列のフッターエリアに適用されます。
* リストボックスの変数あるいはオブジェクト名。この場合コマンドはリストボックスのすべてのフッターエリアに適用されます。

*calculation* 引数には実行する計算式を指定する*Listbox Footer Calculation*テーマの定数を渡します:

| 定数                           | 型    | 値 | コメント                                                                              |
| ---------------------------- | ---- | - | --------------------------------------------------------------------------------- |
| Listbox footer std deviation | 倍長整数 | 7 | 数値または時間型の列に使用します (配列タイプのリストボックスのみ)。<br/>結果のデフォルト型: 実数                     |
| lk footer average            | 倍長整数 | 6 | 数値または時間型の列に使用します。<br/>結果のデフォルト型: 実数                                       |
| lk footer count              | 倍長整数 | 5 | 数値、テキスト、日付、時間、ブール、またはピクチャー型の列に使用します。<br/> 結果のデフォルト型: 倍長整数                 |
| lk footer custom             | 倍長整数 | 1 | 4Dは計算を行いません。フッター変数はプログラムを使用して計算されなければなりません。<br/> 結果のデフォルト型: フッター変数に指定された型 |
| lk footer max                | 倍長整数 | 3 | 数値、日付、時間、またはブール型の列に使用します。<br/>結果のデフォルト型: 列配列またはフィールドに対応する型                |
| lk footer min                | 倍長整数 | 2 | 数値、日付、時間、またはブール型の列に使用します。<br/>結果のデフォルト型: 列配列またはフィールドに対応する型                |
| lk footer sum                | 倍長整数 | 4 | 数値、ブールまたは時間型の列に使用します。<br/>結果のデフォルト型: 列配列またはフィールドに対応する型                    |
| lk footer sum squares        | 倍長整数 | 9 | 数値または時間型の列に使用します (配列タイプのリストボックスのみ)。<br/>結果のデフォルト型: 実数                     |
| lk footer variance           | 倍長整数 | 8 | 数値または時間型の列に使用します (配列タイプのリストボックスのみ)。<br/>結果のデフォルト型: 実数                     |

定義済み計算式では列のすべての値が計算対象になることに留意してください。これには非表示行も含まれます。表示されている行に計算対象を限定したい場合は lk footer custom 定数を使用し、計算をカスタマイズしなければなりません。 

列のデータ型や (*object*にリストボックスを指定した場合) リストボックス中の1つの列でも設定した*calculation*と互換性がない場合、フッターは変更されずエラー18が生成されます。列にフォーミュラが設定されている場合 (セレクションタイプのリストボックス)、エラー10が生成されます。

**注**: フッターエリア変数の型は (コードで明示的に型宣言されていない場合)、プロパティリストで設定された計算に基づき自動で型付けされます (*リストボックスフッター特有のプロパティ*参照)。変数型が、**LISTBOX SET FOOTER CALCULATION**コマンドが期待する結果の型に対応しない場合、型エラーが生成されます。例えば列が日付を表示しているとき、フッターの計算式が '最大値' であれば、フッターエリアの変数は日付型になります。このとき **LISTBOX SET FOOTER CALCULATION**(footer;lk footer count) を実行すると、変数型日付に対して式の結果が倍長整数になるため、エラーが生成されます。

#### 参照 

[LISTBOX Get footer calculation](listbox-get-footer-calculation.md)  