---
id: get-print-option
title: GET PRINT OPTION
slug: /commands/get-print-option
displayed_sidebar: docs
---

<!--REF #_command_.GET PRINT OPTION.Syntax-->**GET PRINT OPTION** ( *option* ; *value1* {; *value2*} )<!-- END REF-->
<!--REF #_command_.GET PRINT OPTION.Params-->
| 引数 | 型 |  | 説明 |
| --- | --- | --- | --- |
| option | Integer | &#8594;  | オプション番号 |
| value1 | Integer, Text | &#8592; | オプションの値1 |
| value2 | Integer, Text | &#8592; | オプションの値2 |

<!-- END REF-->

*このコマンドはスレッドセーフではないため、プリエンプティブなコードには使えません。*


#### 説明 

<!--REF #_command_.GET PRINT OPTION.Summary-->**GET PRINT OPTION** コマンドは、プリントオプションの現在の値を返します。<!-- END REF--> 

*option*引数を使用して取得するオプションを指定することができます。標準のオプション(倍長整数)か、PDFオプションコード(文字列)を取得することができます。コマンドは、*value1* と*value2* (任意)引数に、*option*引数で指定されたカレント値を入れて返します。

標準の印刷オプションを指定するには、“*Print Options*”テーマ内にある以下の定義済み定数を使用します:

| 定数                           | 型    | 値  | コメント                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ---------------------------- | ---- | -- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Paper option                 | 倍長整数 | 1  | *value1* のみを使用した場合、ここには用紙の名前のみが含まれます。両方の引数を使用した場合、*value1* には用紙の幅が、*value2* には用紙の高さが含まれます。幅と高さはどちらもスクリーンピクセルで表現されます。プリンターで使用できる全ての用紙フォーマットの名前、高さと幅を取得する場合には[PRINT OPTION VALUES](print-option-values.md) コマンドを使用して下さい。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Orientation option           | 倍長整数 | 2  | *value1* のみ:1=縦向き、2=横向き。異なるページ方向が使用されている場合、[GET PRINT OPTION](get-print-option.md)コマンドは*value1*に0を返します**。**このオプションは印刷ジョブ内から呼び出す事が可能なので、同一印刷ジョブ中において縦向きを横向きに、あるいはその逆へと切り替えることが可能です。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Scale option                 | 倍長整数 | 3  | *value1* のみ: 拡大縮小の倍率の値(パーセント)。一部のプリンターでは倍率の変更を許可していないものもあるという点に注意して下さい。無効な値を渡した場合、プロパティは印刷時に100%へとリセットされます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Number of copies option      | 倍長整数 | 4  | *value1* のみ: 印刷する部数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Paper source option          | 倍長整数 | 5  | (Windows のみ) *value1* のみ: コマンドで返されるトレイの配列の中で、使用される予定の用紙トレイのインデックスに対応する番号。このオプションはWindowsでのみ使用可能です。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Destination option           | 倍長整数 | 9  | *value1*: 印刷先のタイプを指定するコード: 1=プリンター、2=ファイル(MacではPS)、3=PDFファイル、5=スクリーン(OS X ドライバーオプション)。 *value1* が1あるいは5以外であった場合、*value2* には生成されたドキュメントへのパス名が含まれます。このパスは他のパスが指定されるまでは使用され続けます。保存先に同じ名前のファイルが既に存在していた場合には、それは置き換えられます。[GET PRINT OPTION](get-print-option.md)の場合、カレントの値が既定のリスト内にない場合、*value1* には-1が返され、OKシステム変数は1に設定されます。エラーが起きた場合、*value1* とOKシステム変数は0に設定されます。<br/>**注(Windows)**: Windows 上でPDF を印刷するためには、[SET CURRENT PRINTER](set-current-printer.md)(Generic PDF driver) を呼び出して印刷保存先を2 (File) または 3 (PDF File) に設定する必要があります。3 に設定することでマルチプラットフォーム対応のコードを書くことができます。PDF Creator がインストールされていて、通常のプリンターが選択された場合で、かつ*(9;3;path)* の値が渡された場合、4D は自動的に"サイレント"PDF 印刷を開始し、あらゆるオプションコードを受け入れます(ただしにからの文字列を渡した場合、あるいはこの引数を省略した場合、ファイルを保存ダイアログが印刷時に表示されます)。印刷後、カレントの設定は保存されます。 |
| Double sided option          | 倍長整数 | 11 | (Windows のみ) *value1*: 0=片側印刷あるいは標準、1=両面印刷。*value1*\=1のとき、*value2* にはページ綴じの設定が含まれます: 0=左綴じ(デフォルト値)、1=上綴じ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Spooler document name option | 倍長整数 | 12 | *value1* のみ: スプーラドキュメントの一覧に表示される、カレントの印刷ドキュメント名。この宣言によって定義される名前は、新しい名前あるいは空の文字列が渡されない限りはセッションで印刷される全てのドキュメントに対して使用されます。標準のオペレーション(メソッドの場合にはメソッド名を、レコードの場合にはテーブル名を使用)を使用あるいは復元するためには、空の文字列を*value1* に渡して下さい。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Page range option            | 倍長整数 | 15 | 4D Write Pro 専用のオプション<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Legacy printing layer option | 倍長整数 | 16 | (Windows用4D 64-bit版のみ) *value1* のみ: 1=以降の印刷ジョブに対してはGDI-ベースの旧式の印刷レイヤーを選択。0=D2D印刷レイヤーを選択(デフォルト)。<br/>**64-bit 版:** このセレクターはWindows用64-bit版4Dのシングルユーザーアプリケーションでのみサポートされます。他のプラットフォームでは無視されます。これは主に64-bit版4Dアプリケーションの4Dジョブ内で旧式プラグインが印刷できるようにするためにものです。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Print preview option         | 倍長整数 | 18 | (Windows のみ) *value1*: Windows 上で印刷プレビュー用に使用するフォーマット。取り得る値: kp preview automatic (デフォルト): XPS プリンターとビューアーがあればそれを利用し、なければPDF プリンターかビューアーを使用し、それもなければエラーを生成する kp preview XPS: XPS プリンターとビューアーがあればそれを使用し、なければエラーを生成する kp preview PDF: PDF プリンターとビューアーがあればそれを使用し、なければエラーを生成する *value2* ([GET PRINT OPTION](get-print-option.md) でのみ使用可能): Windows 上で実際に使用されている印刷プレビューフォーマット(設定によっては *value1* の値と異なることが有り得ます)。取り得る値: kp preview none: 利用可能なフォーマットはありません kp preview XPS: XPS プリンターとビューアーが使用されています kp preview PDF: PDF プリンターとビューアーが使用されています                                                                                                                                                                                                                                         |

PDFオプションコードは2つの部分、OptionT*ype*と*OptionName*からなり、"*OptionType:OptionName*"のように組み合わせて使用します。 PDFオプションコードとそれらの取り得る値についての詳細な情報については、[SET PRINT OPTION](set-print-option.md)コマンドの説明を参照して下さい。

**注:** **GET PRINT OPTION** コマンドは主にPostScript プリンターをサポートします。このコマンドは他のタイプのプリンター、例えばPCLやlinkなどにも使用できますが、その場合一部のオプションが使用できない可能性があります。

#### システム変数およびセット 

このコマンドが正しく実行されると、OKシステム変数に1が、そうでなければ0が設定されます。

#### 参照 

[PRINT OPTION VALUES](print-option-values.md)  
[SET PRINT OPTION](set-print-option.md)  