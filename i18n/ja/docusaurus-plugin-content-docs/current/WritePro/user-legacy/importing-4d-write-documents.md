---
id: importing-4d-write-documents
title: Importing 4D Write documents
displayed_sidebar: docs
---

#### 

新しい4D Write Proオブジェクトの主要な機能の一つとして、既存の4D Writeドキュメントの読み込みと変換機能が挙げられます。これによって4D Write プラグインに依存しているアプリケーションを移行させることができます。

****互換性に関する注意:** 

* サポートされるのは、4DWite ドキュメントのうち最後の世代 ("4D Write v7") のドキュメントに限られます。
* 4D Write ドキュメントから 4D Write Pro エリアへのコピー・ペーストは現時点ではまだサポートされていません。4D Writeドキュメントの読み込みは 4D Write Pro ランゲージコマンドの使用によってのみ可能です。
* キャリッジリターン(CR)は4D Write と4D Write Pro とで振る舞いが異なります。4D Write では、CRは常に段落ブレークとして解釈されましたが、4D Write Pro ではデフォルトでは改行として解釈されます。読み込まれた4D Write ドキュメントでフォーミュラ内のCRを段落ブレークとして扱うためには、変換後に以下のコードを実行してください:  
```4d  
 WP SET ATTRIBUTES(wp;wk break paragraphs in formulas;wk true)  
```  
    
詳細な情報については、*フォーミュラの管理* を参照してください。

#### 4D Write ドキュメントを読み込むには 

4D Write Proオブジェクトに 4D Writeドキュメントを読み込む方法は二つあります:

* ディスク上に保存されている 4D Write ファイルに関しては、[WP Import document](../commands/wp-import-document) コマンドを使用してください。
* BLOBフィールドに格納されている 4D Write エリアに関しては、[WP New](../commands/wp-new) コマンドを使用してください。

より詳細な情報に関しては、それぞれのコマンドの詳細を参照してください。

#### 4D Write のプロパティで復元されるもの 

4D Write プラグインから4D Write Proへの移行を簡単にするために、4D Write の機能のうち、出来る限り多くのものが4D Write Proオブジェクトでサポートされようとしています。

以下の段落では、4D Write プラグインのプロパティのうち、[WP Import document](../commands/wp-import-document) または [WP New](../commands/wp-new) コマンドを使用して4D Write Proエリアへと読み込んだときに復元されるプロパティについてまとめています。

しかしながら一部の機能において、バグとはみなされない小さな差異が生じることがあります。これらは例えば、4D Write Proで使用されるデフォルトの行頭の記号や、下線のタイプの小さな変化などによるものです。

##### ドキュメント情報 

| **4D Write プラグイン** | **4D Write Pro**                |
| ------------------ | ------------------------------- |
| 作成日時               | 利用可能                            |
| 修正日時               | 利用可能                            |
| ロック                | 利用不可(読み込み専用オブジェクトプロパティを使用して下さい) |
| タイトル               | 利用可能                            |
| 件名                 | 利用可能(標準テキストのみ)                  |
| 作者                 | 利用可能                            |
| 会社名                | 利用可能                            |
| 注記                 | 利用可能                            |

##### ドキュメントの表示の引数 

| **4D Writeプラグイン** | **4D Write Pro**                                              |
| ----------------- | ------------------------------------------------------------- |
| ページモード            | 読み込まれません(コンテキストメニューの、ドキュメント/ページモードを使用して下さい)                   |
| ルーラー              | 読み込まれません(オブジェクトプロパティを使用して下さい)                                 |
| 枠                 | 読み込まれません(オブジェクトプロパティを使用して下さい)                                 |
| ヘッダー              | 読み込まれません(オブジェクトプロパティを使用して下さい)                                 |
| フッター              | 読み込まれません(オブジェクトプロパティを使用して下さい)                                 |
| 最初のページのヘッダー       | 利用不可                                                          |
| 最初のページのフッター       | 利用不可                                                          |
| 画像                | 利用不可                                                          |
| 縦スクロールバー          | 読み込まれません(オブジェクトプロパティの縦スクロールバーを使用して下さい)                        |
| 横スクロールバー          | 読み込まれません(オブジェクトプロパティの横スクロールバーを使用して下さい)                        |
| 非表示文字             | 読み込まれません(オブジェクトプロパティを使用して下さい)                                 |
| 参照                | 利用不可([ST SET OPTIONS](../../commands/st-set-options)を参照して下さい) |
| カラム分割             | 利用可能(v17以降)                                                   |
| 縦スプリッター           | 利用不可                                                          |
| 横スプリッター           | 利用不可                                                          |
| Wysiwyg           | 利用不可                                                          |
| ズーム               | 読み込まれません(コンテキストメニューの、ドキュメント/ズームを使用して下さい)                      |

##### ドキュメントの引数 

| **4D Write プラグイン** | **4D Write Pro**                         |
| ------------------ | ---------------------------------------- |
| 単位                 | 読み込まれません(コンテキストメニューのドキュメント/計測単位を使用して下さい) |
| 言語                 | 利用不可                                     |
| カラム数               | 利用可能(v17以降)                              |
| カラム間隔              | 利用可能(v17以降)                              |
| ウィンドウ&オーファン        | 利用可能                                     |
| デフォルトのタブ           | 利用可能                                     |
| 先頭のタブ              | 利用可能                                     |
| URLカラー             | 利用不可                                     |
| アクセス済みのURLカラー      | 利用不可                                     |

**注:** 小数点区切りには([GET SYSTEM FORMAT](../../commands/get-system-format)で返される)システムの小数点が使用されます。この引数は[WP SET ATTRIBUTES](../commands/wp-set-attributes) コマンドを使用することで変更できます。

##### ドキュメントのページ付の引数 

| **4D Writeプラグイン**     | **4D Write Pro** |
| --------------------- | ---------------- |
| ページ幅                  | 利用可能             |
| ページの高さ                | 利用可能             |
| 最初のページ番号              | 利用可能             |
| 最初のページのヘッダーとフッターを別にする | 利用可能             |
| 左右のページでヘッダーとフッターが異なる  | 利用可能             |
| ページバインディング            | 利用可能             |
| 反対側のページ               | 利用可能             |
| ページマージン               | 利用可能             |
| ヘッダーの上マージン            | 利用可能             |
| ヘッダーの下マージン            | 利用可能             |
| フッターの上マージン            | 利用可能             |
| フッターの下マージン            | 利用可能             |
| 最初のページの上マージン          | 利用可能             |
| 最初のページの下マージン          | 利用可能             |
| 最初のページのヘッダーの上マージン     | 利用可能             |
| 最初のページのヘッダーの下マージン     | 利用可能             |
| 最初のページのフッターの上マージン     | 利用可能             |
| 最初のページのフッターの下マージン     | 利用可能             |
| 最初のページを右側にする          | 利用可能             |

##### ドキュメントの印刷引数 

| **4D Write プラグイン** | **4D Write Pro** |
| ------------------ | ---------------- |
| 用紙の種類              | 利用不可             |
| 横向きに印刷             | 利用不可             |
| 幅                  | 利用不可             |
| 高さ                 | 利用不可             |
| ユーザー設定マージン         | 利用不可             |
| 倍率                 | 利用不可             |
| X 解像度              | 利用不可             |
| Y 解像度              | 利用不可             |

##### 画像 

**互換性に関する注意:**

* 4D v19 R2 のWrite Pro 以降、[WP Import document](../commands/wp-import-document) を使用するとピクチャーの表示モードは自動的に読み込まれます。*importDisplayMode* 属性を使用することで以前の振る舞い(全ての画像は合致するように縮小する)を復活させることができます。
* Windows では、Mac OS PICT フォーマットの画像は読み込まれますが4D Write Pro ではレンダリングされません。このタイプの画像を格納しているドキュメントを読み込んだ場合、それらの画像を他のフォーマットへと変換する必要があります。PICT フォーマットのサポートは4D v18 以降削除されており、今後使用することはできません。

| **4D Write プラグイン**     | **4D Write Pro**                   |
| ---------------------- | ---------------------------------- |
| X (左)                  | (& position :absolute) (ページ内の画像のみ) |
| Y (上)                  | (& position :absolute) (ページ内の画像のみ) |
| 幅                      | 利用可能                               |
| 高さ                     | 利用可能                               |
| ページ番号                  | 利用可能(v16 R6 以降)                    |
| 背景画像                   | 利用可能(v16 R6 以降)                    |
| 最初のページには含めない           | 利用可能(v16 R6 以降)                    |
| ビューポートモード(縮小して画像を入れる等) | 利用可能                               |
| 式である                   | インライン画像で利用可能(v16 R5 以降)            |
| サイズを保持                 | 読み込まれません(4D Write Proでは自動)         |

##### 文字プロパティ 

| **4D Write プラグイン**            | **4D Write Pro (span プロパティ)** |
| ----------------------------- | ----------------------------- |
| イタリック                         | 利用可能                          |
| ボールド                          | 利用可能                          |
| 取り消し線                         | 利用可能                          |
| 下線                            | 利用可能                          |
| シャドウ                          | 利用可能                          |
| 指数(上付きまたは下付き)                 | 利用可能                          |
| 大文字(英大文字または小型英大文字)            | 利用可能                          |
| フォントファミリー                     | 利用可能                          |
| フォントサイズ                       | 利用可能                          |
| テキストカラー                       | 利用可能                          |
| テキスト背景カラー                     | 利用可能                          |
| 下線カラー                         | 利用可能                          |
| 取り消し線カラー                      | 利用可能                          |
| シャドウカラー                       | 利用可能                          |
| ユーザープロパティ                     | 利用不可                          |
| スペルチェック(シンタックス&グラマー onまたはoff) | 読み込まれません(エリアプロパティ)            |
| 表示                            | 利用不可                          |
| スタイルシート                       | 利用可能(4D v18以降)                |

##### 段落プロパティ 

| **4D Write プラグイン** | **4D Write Pro** |
| ------------------ | ---------------- |
| 均等位置               | 利用可能             |
| Interline          | 利用可能             |
| 箇条書き               | 利用可能             |
| 左マージン              | 利用可能             |
| 右マージン              | 利用可能             |
| テキストインデント          | 利用可能             |
| 境界線スタイル            | 利用可能             |
| 境界線カラー             | 利用可能             |
| 境界線の背景カラー          | 利用可能             |
| 左境界線               | 利用可能             |
| 右境界線               | 利用可能             |
| 上境界線&上の内側の境界線      | 利用可能             |
| 下の境界線&下の内側の境界線     | 利用可能             |
| 境界線間隔              | 利用可能             |
| スタイルシート            | 利用可能             |
| タブ                 | 利用可能             |

##### ハイパーリンク 

| **4D Write プラグイン** | **4D Write Pro**          |
| ------------------ | ------------------------- |
| URL リンク            | 利用可能 (\*)                 |
| 4D メソッドリンク         | 利用可能 (\*\*) (v17 R5 以降)   |
| ドキュメントを開くリンク       | 利用可能(ローカルファイルのURLに変換されます) |

* (\*) 4D v16 R4以降、URLリンクは編集可能な属性に変換されます。詳細については *リンクコマンド* を参照ください。
* (\*\*) 呼び出されたメソッド内で受け取った引数を調整する必要があります:  
| **引数** | **4D Write プラグイン**    | **4D Write Pro**                                                                                                                                                                                 |  
| ------ | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |  
| $1     | 倍長整数 - 4D Write エリア参照 | テキスト - 4D Write Pro エリア名                                                                                                                                                                         |  
| $2     | テキスト - リンクラベル         | オブジェクト - リンク詳細:.method - リンクのメソッドの名前。[SET ALLOWED METHODS](../../commands/set-allowed-methods) コマンドで許可されている必要があります。.parameter - メソッドに渡されたユーザー引数値(使用されていれば).range - リンクのラベルのレンジ*セレクションレンジコマンド*参照。 |  
| $3     | 倍長整数 - ユーザー引数(メソッド参照) | \-                                                                                                                                                                                               |

##### 4D 式 

| **4D Write プラグイン** | **4D Write Pro** |
| ------------------ | ---------------- |
| 4D 式               | 利用可能\*           |
| 日付と時間              | 利用可能             |
| HTML 式             | 利用不可\*\*         |
| RTF 式              | 利用不可             |

\*読み込まれたドキュメント内においてフォーミュラから返されたCR を段落ブレークへと変換するためには[WP SET ATTRIBUTES](../commands/wp-set-attributes) コマンドとwk break paragraphs in formulas 属性を使用してください(デフォルトでは改行として扱われます)。詳細は*フォーミュラの管理* を参照してください。

\*ただしwk import html expressions as text 定数を使用した場合には**##htmlBegin##** および **##htmlEnd##** タグに挟まれたテキストとして読み込み可能

##### テキストデータ 

| **4D Write プラグイン** | **4D Write Pro** |
| ------------------ | ---------------- |
| メインテキストデータ         | 利用可能             |
| ヘッダーテキストデータ        | 利用可能             |
| フッターテキストデータ        | 利用可能             |