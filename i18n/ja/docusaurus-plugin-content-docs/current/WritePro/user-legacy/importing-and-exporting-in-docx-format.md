---
id: importing-and-exporting-in-docx-format
title: Importing and Exporting in docx format
displayed_sidebar: docs
slug: /WritePro/importing-and-exporting-in-docx-format
---

4D Write Pro は.docx フォーマットでの読み込みと書き出しの両方ができます。このフォーマットはMicrosof Word などのワープロアプリケーションでサポートされているものです。

**互換性に関する注意:** 4D Write Pro ドキュメントの.docx フォーマットの読み込み/書き出しに関するサポートは、Microsoft Word 2010 以降にしか認定されていません。それより古いバージョン、具体的にはMicrosoft Word 2007 などは、ドキュメントを開けない可能性があります。

## .docx フォーマットのファイルの読み込み方 

.docx フォーマットのドキュメントは、[WP Import document](../commands/wp-import-document) コマンドで4D Write Pro に読み込むことができます。詳細な情報については、このコマンドの説明を参照してください。

### 振る舞いの変化 

大部分の.docx のパラメーターは保存される一方、一部のパラメーターは4D Write Pro ではサポートされないか振る舞いが異なることが知られています。これらのパラメーターは以下にまとめてあります:

#### 揃え / レイアウト 

| **設定**         | **詳細**                                                                                                                                                                                                                                                                                                                   |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| アンカーされたテキストエリア | アンカーされたテキストエリアはデフォルトではテキストボックスとして読み込まれます(あるいはそれらを無視するか、インラインテキストとして読み込むこともできます。詳細は[WP Import document](../commands/wp-import-document) のオプションを参照してください)。シンプルなテキストエリアのみが読み込まれます。インラインテキストエリアは前面レイヤーにアンカーされたテキストとして読み込まれます。テキストの周りにアンカーされたテキストエリアはそれぞれの折り返しプロパティで読み込まれます(例外: .docx の"tight" 折り返しオプションはスクェア折り返しとして読み込まれます)。 |
| 段落レイアウト        | 西欧テキストレイアウトのみがサポートされます。均等段落スタイル、タイ/アジア段落スタイルはサポートされません。                                                                                                                                                                                                                                                                  |
| ページサイズ         | セクションごとの異なるページサイズはサポートされません。最初のセクションのページサイズのみが読み込まれます。                                                                                                                                                                                                                                                                   |

#### 背景 

| **設定** | **詳細**     |
| ------ | ---------- |
| 透かし画像  | サポートされません。 |

#### 式 

| **設定**       | **詳細**                  |
| ------------ | ----------------------- |
| MS Word 演算式  | サポートされません。データは読み込まれません。 |
| MS Word チャート | サポートされません。データは読み込まれません。 |

#### リスト 

| **設定**      | **詳細**                                                                |
| ----------- | --------------------------------------------------------------------- |
| 階層リスト       | 複数階層のリストはサポートされません。これらは単一階層のリストへと変換されるので、リストの見た目/ナンバリングは変化する可能性があります。 |
| 読み込みオペレーション |                                                                       |

#### ピクチャー/画像 

| **設定**         | **詳細**                                                                        |
| -------------- | ----------------------------------------------------------------------------- |
| DrawingML シェイプ | 単純なDrawingML 画像(インラインまたはアンカーされた画像)のみが読み込まれます。複雑なDrawingML シェイプはサポートされません。     |
| VML シェイプまたは画像  | サポートされません。VML はMS Word では廃止予定となっており、MS Word 2010 以降で作成されたドキュメント内では使用してはいけません。 |
| 3D モデル         | サポートされませんが、3D モデルをレンダーした最後の2D 画像は、.docx ファイル内に存在すれば読み込まれます。                   |
| SmartArt       | サポートされません。                                                                    |

#### 参照 / レビュー 

| **設定** | **詳細**                    |
| ------ | ------------------------- |
| コメント   | サポートされません。コンテンツは読み込まれません。 |
| 脚注     | サポートされません。コンテンツは読み込まれません。 |

#### 行間隔 

| **設定**       | **詳細**                                    |
| ------------ | ----------------------------------------- |
| "最低限" 行間隔    | サポートされません。"最低限"行間隔は固定された(単一の)行間隔へと変換されます。 |
| テキストをフィットさせる | サポートされません。通常の4D Write Pro スタイルがしようされます。   |

#### 表 

| **設定** | **詳細**                |
| ------ | --------------------- |
| 表      | 隣接している表は自動的には結合されません。 |

#### テキスト 

| **Paramètre** | **Description**                                                                                                  |
| ------------- | ---------------------------------------------------------------------------------------------------------------- |
| テーマ           | テキストテーマは読み込まれません。カラーまたはフォントの定義がテーマのカラーやフォントを参照している場合、最後に計算されたカラーまたはフォントが使用されます。そうでない場合、テーマで定義されたカラーやフォントが使用されます。 |

### 読み込みログ 

.docx フォーマットを4D Write Pro へと読み込む際、ログオブジェクトが作成され、読み込まれたドキュメントオブジェクトに含まれます。このオブジェクトは、"importLog" カスタム属性(あるいは wk import log 定数)を通して取得することができます:

```4d
 $myDoc:=WP Import document("test.docx")
 if($myDoc#Null)
    var $log : Object
    $log:=$myDoc[wk import log]
 End if
```

読み込みログオブジェクトには、以下のプロパティが格納されています :

| 定数            | コメント                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| wk import log | ログオブジェクトには.docx 読み込みオペレーションについての情報が格納されています。プロパティは読み出し専用で設定することはできません:  <table> <tbody> <tr> <td>**プロパティ**</td> <td> </td> <td>**型**</td> <td>**詳細**</td> </tr> <tr> <td>status</td> <td> </td> <td>テキスト</td> <td>読み込みステータス:<br/> successful - ドキュメントは4D Write Proへと読み込まれました。 failed - 空の4D Write Proドキュメントが返されます。  </td> </tr> <tr> <td>developer</td> <td> </td> <td>コレクション</td> <td>4D Write Pro デベロッパーのためのメッセージオブジェクトのコレクション</td> </tr> <tr> <td> </td> <td>\[ \].type</td> <td>テキスト</td> <td>記録されたメッセージの種類:<br/> info warning error  </td> </tr> <tr> <td> </td> <td>\[ \].message</td> <td>テキスト</td> <td>読み込みオペレーションについてのメッセージ</td> </tr> <tr> <td>user</td> <td> </td> <td>コレクション</td> <td>4D Write Pro ユーザーのためのメッセージオブジェクトのコレクション</td> </tr> <tr> <td> </td> <td>\[ \].type</td> <td>テキスト</td> <td>記録されたメッセージの種類:<br/> info warning  </td> </tr> <tr> <td> </td> <td>\[ \].messageShort</td> <td>テキスト</td> <td>読み込みオペレーションについての短いメッセージ</td> </tr> <tr> <td> </td> <td>\[ \].messageLong</td> <td>テキスト</td> <td>読み込みオペレーションについての詳細なメッセージ</td> </tr> </tbody> </table> **警告:** *importLog* はカスタムの属性であるため、 wk import log 定数を[WP SET ATTRIBUTES](../commands/wp-set-attributes)、[WP GET ATTRIBUTES](../commands/wp-get-attributes) または [WP RESET ATTRIBUTES](../commands/wp-reset-attributes) コマンドで使用することはできません(詳細な情報については*カスタムの属性を使用* を参照してください)。 |

## .docx フォーマットへの書き出し方 

4D Write Pro オブジェクトでは、4D Write Pro ドキュメントを.docx フォーマットで書き出しするために、2つの方法を提供しています:

* .docx ファイルをディスクに書き出しするためには、[WP EXPORT DOCUMENT](../commands/wp-export-document) コマンドを使用します。
* .docx ファイルをBLOB 変数に書き出しするためには、[WP EXPORT VARIABLE](../commands/wp-export-variable) コマンドを使用します。

より詳細な情報については、これらのコマンドの詳細を参照してください。

### 振る舞いの変化 

4D Write Pro の大部分の設定は保たれますが、いくつかの設定についてはMicrosoft Word ではサポートされないか、振る舞いが変化することがすでに知られています。具体的には以下の設定が関連します:

#### 揃え / レイアウト 

| **設定**                                                                | **段落**                                                                                                                                       | **セクション**                                       | **画像** |
| --------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------- | ------ |
| アンカー                                                                  | Microsoft Word では、アンカーされた画像は、ページおよび最初の段落の左上の原点に対して相対的に配置されます。このため、4D Write Pro とMicrosoft Word とのテキストのレイアウトの差異によって画像が想定と異なる位置に表示される可能性があります。 |                                                 |        |
| 埋め込みエリアにアンカーされたテキストボックスは書き出されません。Microsoft Word でのレンダリングが異なる可能性があります。 |                                                                                                                                              |                                                 |        |
| 垂直方向揃え                                                                | Microsoft Word ではサポートされていません(全ての項目は上揃えになります)                                                                                                 | インライン画像に対してはサポートされません(全てのインライン画像はベースライン揃えになります) |        |

#### 背景 

| **設定**    | **段落**                                                       | **セクション**                                                         | **画像**                                                                           |
| --------- | ------------------------------------------------------------ | ----------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| 背景の切り落とし  | Microsoft Word ではサポートされていません(背景色は背景全体を塗りますが、境界線とマージンは含まれません) | Microsoft Word ではサポートされていません(背景の切り落としはパッディングボックスと同じになります)         |                                                                                  |
| 背景画像      | Microsoft Word ではサポートされていません                                 | 異なる背景画像/背景色はMicrosoft Word ではサポートされていません(アンカーされた画像あるいは図形へと変換されます) | Microsoft Word では背景色か背景画像のどちらかを設定できます。背景画像が定義されている場合、背景色は "transparent" に設定されます。 |
| 背景画像の繰り返し | 水平あるいは垂直タイルはMiscrosoft Word では完全なタイルへと変換されます                 | 水平あるいは垂直タイルはMiscrosoft Word では完全なタイルへと変換されます                      |                                                                                  |
| 背景の原点     | 原点のボックスは、背景切り落としボックスと同じ値へと変換されます。                            | Microsoft ではサポートされていません。                                          |                                                                                  |

#### 境界線 

| **設定**       | **段落**                                                                                                             | **セクション**                                       | **画像** |
| ------------ | ------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------- | ------ |
| 境界線カラー       | 各境界線ごとに異なる境界線カラーを設定することはMicrosoft Word ではサポートされていません。最初に定義された4D Write Pro 画像境界線(優先順位: 上、右、下、左)が全ての画像境界線に対して使用されます。 |                                                 |        |
| 境界線半径(丸い境界線) | Microsoft Word ではサポートされていません                                                                                       |                                                 |        |
| 境界線幅         | Microsoft Word での幅の最大値は12pt で、これを超えるサイズは縮小されます。                                                                    | Microsoft Word での幅の最大値は12pt で、これを超えるサイズは縮小されます。 |        |

#### 式 

| **設定** | **段落**                                                                                                                                                                                       | **セクション** | **画像** |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | ------ |
| 式      | "Current date" や"Current time" のようなシンプルな4D 式、あるいは4D Write Pro によって予約されているローカル変数($wp\_title、 $wp\_pageNumber、等) のみがMicrosfot Word フィールドへと変換されます。他の4D 式は値が計算され、書き出しプロセスの途中でテキストあるいは画像へと変換されます。 |           |        |

#### リスト 

| **設定**   | **段落**                                                                    | **セクション** | **画像** |
| -------- | ------------------------------------------------------------------------- | --------- | ------ |
| インデント    | リスト項目については0へと変換されます(リスト項目のインデントは、Microsoft Word ではぶら下げインデントへと変換されます)      |           |        |
| 順番付きリスト型 | Microsoft Word ではギリシャ風、アルメニアン風、ジョージア風の記号は全て点記号へと変換され、またひらがなはカタカナへと変換されます。 |           |        |

#### ピクチャー 

| **設定** | **段落**                                                       | **セクション** | **画像** |
| ------ | ------------------------------------------------------------ | --------- | ------ |
| SVG    | Microsoft Word ではサポートされません(SVG フォーマットの画像はPNG フォーマットへと変換されます) |           |        |

#### サイズ 

| **設定**  | **段落**                                        | **セクション** | **画像** |
| ------- | --------------------------------------------- | --------- | ------ |
| 最小高さ    | Microsoft Word ではサポートされていません(高さは自動的に管理されます)   |           |        |
| 幅 / 最小幅 | Microsoft Word ではサポートされていません(段落の幅は自動的に管理されます) |           |        |

#### 間隔 

| **設定** | **段落**                                         | **セクション**                                      | **画像** |
| ------ | ---------------------------------------------- | ---------------------------------------------- | ------ |
| パッディング | Microsoft Word での最大間隔は31pt で、これをパッディングは縮小されます。 | Microsoft Word での最大間隔は31pt で、これをパッディングは縮小されます。 |        |

#### 表 

| **機能**      | **詳細**   |
| ----------- | -------- |
| 下部キャリーオーバー行 | 書き出されません |

#### タブ 

| **設定**      | **段落**                                                                                                  | **セクション** | **画像** |
| ----------- | ------------------------------------------------------------------------------------------------------- | --------- | ------ |
| デフォルトタブストップ | Microsoft Word ではサポートされていません(絶対的タブストップに変換されます)                                                          |           |        |
| タブリーディング文字  | Microsoft Word では"ドット" (....)、"ダッシュ" (----)、および"アンダースコア" (\_\_\_\_) リーディング文字をサポートしています。他は全て"なし"に変換されます。 |           |        |

#### テキスト 

| **設定**   | **段落**                                                                      | **セクション**                                                  | **画像** |
| -------- | --------------------------------------------------------------------------- | ---------------------------------------------------------- | ------ |
| 打ち消し線    | テキストカラーと異なる色の線カラーはMicrosoft Word ではサポートされていません。またスタイルでは通常の線と二重線のみがサポートされます。 |                                                            |        |
| スタイルシート  | 段落のスタイルシートは、段落スタイルへと変換されます。                                                 |                                                            |        |
| テキストの揃え  | Microsoft Word はスペースを圧縮するので、両端揃えのテキストレイアウトは再構成される可能性があります。                  | Microsoft Word はスペースを圧縮するので、両端揃えのテキストレイアウトは再構成される可能性があります。 |        |
| テキストシャドウ | 4D Write Pro シャドウは、Microsoft Word のデフォルトのカラーを使用したぼかしまたはオフセットへと変換されます。       |                                                            |        |
| 下線       | 半透明の下線は通常の下線へと変換されます。                                                       |                                                            |        |