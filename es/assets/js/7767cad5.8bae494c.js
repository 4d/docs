"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[92145],{814694:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var d=r(474848),s=r(28453);const a={id:"vp-run-offscreen-area",title:"VP Run offscreen area"},o=void 0,i={id:"ViewPro/commands/vp-run-offscreen-area",title:"VP Run offscreen area",description:"VP Run offscreen area ( parameters Mixed",source:"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R5/ViewPro/commands/vp-run-offscreen-area.md",sourceDirName:"ViewPro/commands",slug:"/ViewPro/commands/vp-run-offscreen-area",permalink:"/docs/es/20-R5/ViewPro/commands/vp-run-offscreen-area",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20ViewPro%2Fcommands%2Fvp-run-offscreen-area.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"vp-run-offscreen-area",title:"VP Run offscreen area"},sidebar:"docs",previous:{title:"VP ROW AUTOFIT",permalink:"/docs/es/20-R5/ViewPro/commands/vp-row-autofit"},next:{title:"S",permalink:"/docs/es/20-R5/commands/S"}},l={},c=[{value:"Descripci\xf3n",id:"descripci\xf3n",level:4},{value:"Ejemplo 1",id:"ejemplo-1",level:4},{value:"Ejemplo 2",id:"ejemplo-2",level:4},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:4}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"VP Run offscreen area"})," ( ",(0,d.jsx)(n.em,{children:"parameters"})," : Object) : Mixed"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Par\xe1metros"}),(0,d.jsx)(n.th,{children:"Tipo"}),(0,d.jsx)(n.th,{}),(0,d.jsx)(n.th,{children:"Descripci\xf3n"}),(0,d.jsx)(n.th,{})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"parameters"}),(0,d.jsx)(n.td,{children:"Object"}),(0,d.jsx)(n.td,{children:"->"}),(0,d.jsx)(n.td,{children:"Objeto que contiene los atributos del \xe1rea fuera de pantalla"}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Result"}),(0,d.jsx)(n.td,{children:"Mixed"}),(0,d.jsx)(n.td,{children:"<-"}),(0,d.jsxs)(n.td,{children:["propiedad ",(0,d.jsx)(n.code,{children:".result"})," del objeto ",(0,d.jsx)(n.code,{children:".onEvent"}),", o Null si no devuelve ning\xfan valor"]}),(0,d.jsx)(n.td,{})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"descripci\xf3n",children:"Descripci\xf3n"}),"\n",(0,d.jsxs)(n.p,{children:["El comando ",(0,d.jsx)(n.code,{children:"VP Run offscreen area"})," crea un \xe1rea fuera de pantalla en la memoria que puede ser utilizada para procesar comandos y funciones del \xe1rea 4D View Pro."]}),"\n",(0,d.jsxs)(n.p,{children:["En el objeto ",(0,d.jsx)(n.em,{children:"parameters"}),", pase una de las siguientes propiedades opcionales. Estas propiedades estar\xe1n disponibles a trav\xe9s del comando ",(0,d.jsx)(n.code,{children:"This"})," dentro del m\xe9todo ",(0,d.jsx)(n.code,{children:"onEvent"})," y har\xe1n referencia a la instancia:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Propiedad"}),(0,d.jsx)(n.th,{children:"Tipo"}),(0,d.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"area"}),(0,d.jsx)(n.td,{children:"text"}),(0,d.jsx)(n.td,{children:'El nombre del \xe1rea fuera de la pantalla. Si se omite o es null, se asigna un nombre gen\xe9rico (por ejemplo, "OffscreenArea1").'})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"onEvent"}),(0,d.jsx)(n.td,{children:"objet (f\xf3rmula)"}),(0,d.jsxs)(n.td,{children:["Un m\xe9todo retro llamada que se lanzar\xe1 cuando el \xe1rea fuera de la pantalla est\xe9 lista. Puede ser:",(0,d.jsxs)(n.li,{children:["una funci\xf3n ",(0,d.jsx)(n.code,{children:"onEvent"})," de una clase, o"]}),(0,d.jsxs)(n.li,{children:["un objeto ",(0,d.jsx)(n.code,{children:"Formula"})]}),"Por defecto, el m\xe9todo de retrollamada es llamado en los eventos ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onVpReady",children:(0,d.jsx)(n.code,{children:"On VP Ready"})}),", ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onLoad",children:(0,d.jsx)(n.code,{children:"On Load"})}),", ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onUnload",children:(0,d.jsx)(n.code,{children:"On Unload"})}),", ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onEndUrlLoading",children:(0,d.jsx)(n.code,{children:"On End URL Loading"})}),", ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onUrlLoadingError",children:(0,d.jsx)(n.code,{children:"On URL Loading Error"})}),", ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onVpRangeChanged",children:(0,d.jsx)(n.code,{children:"On VP Range Changed"})})," u ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onTimer",children:(0,d.jsx)(n.code,{children:"On Timer"})}),". El m\xe9todo de retrollamada puede ser utilizado para acceder a la ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/ViewPro/configuring#4d-view-pro-form-object-variable",children:"variable del objeto 4D View Pro"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"autoQuit"}),(0,d.jsx)(n.td,{children:"boolean"}),(0,d.jsxs)(n.td,{children:["True (valor por defecto) si el comando debe detener la ejecuci\xf3n de la f\xf3rmula cuando se produzcan los eventos ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onEndUrlLoading",children:(0,d.jsx)(n.code,{children:"On End URL Loading"})})," o ",(0,d.jsx)(n.a,{href:"/docs/es/20-R5/Events/onUrlLoadingError",children:(0,d.jsx)(n.code,{children:"On URL Loading Error"})}),". Si es false, debe utilizar los comandos ",(0,d.jsx)(n.code,{children:"CANCEL"})," o ",(0,d.jsx)(n.code,{children:"ACCEPT"})," en el m\xe9todo de retrollamada ",(0,d.jsx)(n.em,{children:"onEvent"}),"."]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"timeout"}),(0,d.jsx)(n.td,{children:"number"}),(0,d.jsx)(n.td,{children:"Tiempo m\xe1ximo (expresado en segundos) antes de que el \xe1rea se cierre autom\xe1ticamente si no se genera ning\xfan evento. Si se fija en 0, no se aplica ninguna limitaci\xf3n. Valor por defecto: 60"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"resultado"}),(0,d.jsx)(n.td,{children:"mixto"}),(0,d.jsx)(n.td,{children:"Resultado del procesamiento (si hay)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"<customProperty>"})}),(0,d.jsx)(n.td,{children:"mixto"}),(0,d.jsxs)(n.td,{children:["Todo atributo personalizado que est\xe9 disponible en el m\xe9todo de retrollamada ",(0,d.jsx)(n.em,{children:"onEvent"}),"."]})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"La siguiente propiedad es a\xf1adida autom\xe1ticamente por el comando si es necesario:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Propiedad"}),(0,d.jsx)(n.th,{children:"Tipo"}),(0,d.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,d.jsx)(n.tbody,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"timeoutReached"}),(0,d.jsx)(n.td,{children:"boolean"}),(0,d.jsx)(n.td,{children:"A\xf1adido con el valor true si se ha excedido el tiempo de espera"})]})})]}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["El \xe1rea fuera de pantalla solo est\xe1 disponible durante la ejecuci\xf3n del comando ",(0,d.jsx)(n.code,{children:"VP Run offscreen area"}),". Se destruir\xe1 autom\xe1ticamente una vez finalizada la ejecuci\xf3n."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"Los siguientes comandos se pueden utilizar en el m\xe9todo de retrollamada:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"ACCEPT"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"CANCEL"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"SET TIMER"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"WA Evaluate JavaScript"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"WA EXECUTE JAVASCRIPT FUNCTION"})}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,d.jsx)(n.p,{children:"Quiere crear un \xe1rea 4D View Pro fuera de la pantalla y obtener el valor de una celda:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-4d",children:'// Declaraci\xf3n de la clase cs.OffscreenArea \nClass constructor ($path : Text)\n This.filePath:=$path\n\n// Esta funci\xf3n ser\xe1 llamada en cada evento del \xe1rea offscreen \nFunction onEvent()\n Case of\n  :(FORM Event.code=On VP Ready)\n      VP IMPORT DOCUMENT(This.area;This.filePath)\n       This.result:=VP Get value(VP Cell(This.area;6;22))\n \n       ALERT("The G23 cell contains the value: "+String(This.result))\n End case\n'})}),"\n",(0,d.jsxs)(n.p,{children:["El m\xe9todo de retrollamada ",(0,d.jsx)(n.em,{children:"OffscreenArea"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-4d",children:"$o:=cs.OffscreenArea.new()\n$result:=VP Run offscreen area($o)\n"})}),"\n",(0,d.jsx)(n.h4,{id:"ejemplo-2",children:"Ejemplo 2"}),"\n",(0,d.jsx)(n.p,{children:"Quiere cargar un documento grande fuera de la pantalla, esperar a que todos los c\xe1lculos se completen y exportarlo como PDF:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-4d",children:'// Declaraci\xf3n de clase cs.OffscreenArea\nClass constructor($pdfPath : Text)\n This.pdfPath:=$pdfPath\n This.autoQuit:=False\n This.isWaiting:=False\n \nFunction onEvent()\n Case of\n     :(FORM Event.code=On VP Ready)\n // Importar el documento\n   VP IMPORT DOCUMENT(This.area;$largeDocument4VP)\n         This.isWaiting:=True\n \n // Iniciar un temporizador para verificar si todos los c\xe1lculos han finalizado.\n // Si durante este per\xedodo se lanza "On VP Range Changed", se reiniciar\xe1 el temporizador\n // El tiempo debe ser definido de acuerdo con la configuraci\xf3n del ordenador.\n   SET TIMER(60)\n \n  :(FORM Event.code=On VP Range Changed)\n // Se detect\xf3 el fin del c\xe1lculo. Reinicia el temporizador\n         If(This.isWaiting)\n           SET TIMER(60)\n         End if\n \n  :(FORM Event.code=On Timer)\n // Para asegurarse de no reiniciar el temporizador si llama a otros comandos de 4D View despu\xe9s de este punto\n         This.isWaiting:=False\n \n\n\n // Detener el temporizador\n   SET TIMER(0)\n \n // Iniciar la exportaci\xf3n a PDF\n        VP EXPORT DOCUMENT(This.area;This.pdfPath;New object("formula";Formula(ACCEPT)))\n \n     :(FORM Event.code=On URL Loading Error)\n\n         CANCEL \n End case\n'})}),"\n",(0,d.jsxs)(n.p,{children:["El m\xe9todo de retrollamada ",(0,d.jsx)(n.em,{children:"OffscreenArea"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-4d",children:"$o:=cs.OffscreenArea.new()\n \n$result:=VP Run offscreen area($o)\n"})}),"\n",(0,d.jsx)(n.h4,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://blog.4d.com/4d-view-pro-end-of-document-loading/",children:"Blog post: End of document loading"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(t,{...e})}):t(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var d=r(296540);const s={},a=d.createContext(s);function o(e){const n=d.useContext(a);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),d.createElement(a.Provider,{value:n},e.children)}}}]);