"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["23638"],{784263:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>o,toc:()=>d,default:()=>h,metadata:()=>r,assets:()=>l,contentTitle:()=>t});var r=JSON.parse('{"id":"WebServer/http-request-handler","title":"HTTP Request handler","description":"Por defecto, las peticiones HTTP recibidas por el servidor web 4D se gestionan a trav\xe9s de funciones de procesamiento integradas o del servidor REST.","source":"@site/i18n/es/docusaurus-plugin-content-docs/version-21/WebServer/http-request-handler.md","sourceDirName":"WebServer","slug":"/WebServer/http-request-handler","permalink":"/docs/es/WebServer/http-request-handler","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WebServer%2Fhttp-request-handler.md%20(21)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"21","frontMatter":{"id":"http-request-handler","title":"HTTP Request handler"},"sidebar":"docs","previous":{"title":"Procesamiento de peticiones HTTP","permalink":"/docs/es/WebServer/httpRequests"},"next":{"title":"HTTP Rules","permalink":"/docs/es/WebServer/http-rules"}}'),i=s(785893),a=s(250065);let o={id:"http-request-handler",title:"HTTP Request handler"},t=void 0,l={},d=[{value:"Requisitos",id:"requisitos",level:2},{value:"How to set handlers",id:"how-to-set-handlers",level:2},{value:"Definici\xf3n del gestor",id:"definici\xf3n-del-gestor",level:2},{value:"Patrones de la URL",id:"patrones-de-la-url",level:3},{value:"Concordancia de modelos",id:"concordancia-de-modelos",level:4},{value:"Patrones prohibidos",id:"patrones-prohibidos",level:4},{value:"Clase y m\xe9todo",id:"clase-y-m\xe9todo",level:3},{value:"Verbs",id:"verbs",level:3},{value:"Ejemplo",id:"ejemplo",level:2},{value:"C\xf3digo del gestor de peticiones",id:"c\xf3digo-del-gestor-de-peticiones",level:2},{value:"Configuraci\xf3n de funciones",id:"configuraci\xf3n-de-funciones",level:3},{value:"Entrada: una instancia de la clase 4D.IncomingMessage",id:"entrada-una-instancia-de-la-clase-4dincomingmessage",level:3},{value:"Output: an instance of the 4D.OutgoingMessage class",id:"output-an-instance-of-the-4doutgoingmessage-class",level:3},{value:"Ejemplo",id:"ejemplo-1",level:3},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:2}];function c(e){let n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Por defecto, las peticiones HTTP recibidas por el servidor web 4D se gestionan a trav\xe9s de ",(0,i.jsx)(n.a,{href:"/docs/es/WebServer/httpRequests",children:"funciones de procesamiento integradas"})," o del ",(0,i.jsx)(n.a,{href:"/docs/es/REST/REST_requests",children:"servidor REST"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["In addition, 4D supports the implementation of ",(0,i.jsx)(n.strong,{children:"custom HTTP Request handlers"}),", allowing you to intercept specific incoming HTTP requests and process them using your own code."]}),"\n",(0,i.jsxs)(n.p,{children:["Cuando un manejador de peticiones HTTP personalizado intercepta una solicitud, se procesa directamente y no hay otras funcionalidades de procesamiento (por ejemplo, son llamados m\xe9todos base ",(0,i.jsx)(n.a,{href:"/docs/es/WebServer/authentication#on-web-authentication",children:"On Web authentication"})," o ",(0,i.jsx)(n.a,{href:"/docs/es/WebServer/httpRequests#on-web-connection",children:"On Web connection"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Custom HTTP request handlers meet various needs, including:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"using a given URL as a resource provider or a file-uploading box (to download or upload various files),"}),"\n",(0,i.jsx)(n.li,{children:"redirecting on specific pages according to a context (user authenticated, privileges granted...),"}),"\n",(0,i.jsx)(n.li,{children:"gestionar una autenticaci\xf3n a trav\xe9s de oAuth 2.0."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"requisitos",children:"Requisitos"}),"\n",(0,i.jsx)(n.p,{children:"Custom HTTP Request handlers are supported in the following context:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/es/WebServer/sessions#enabling-web-sessions",children:"scalable sessions"})," or ",(0,i.jsx)(n.a,{href:"/docs/es/settings/web#no-sessions",children:"no sessions"})," are enabled,"]}),"\n",(0,i.jsxs)(n.li,{children:["a web server run locally by 4D or 4D Server, including those ",(0,i.jsx)(n.a,{href:"/docs/es/WebServer/webServerObject",children:"run by components"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["For security reasons, external access to the datastore can be disallowed in 4D. You need to configure the ",(0,i.jsx)(n.a,{href:"/docs/es/ORDA/privileges",children:"ORDA privileges"})," to allow HTTP requests."]})}),"\n",(0,i.jsx)(n.h2,{id:"how-to-set-handlers",children:"How to set handlers"}),"\n",(0,i.jsx)(n.p,{children:"You can declare HTTP Request handlers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["in a configuration file named ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"})," stored in the ",(0,i.jsx)(n.a,{href:"/docs/es/Project/architecture#sources",children:(0,i.jsx)(n.code,{children:"Project/Sources"})})," folder of the project. HTTP Request handlers are loaded and applied in the main Web server once it is started."]}),"\n",(0,i.jsxs)(n.li,{children:["using a ",(0,i.jsx)(n.a,{href:"/docs/es/API/WebServerClass#handlers",children:(0,i.jsx)(n.code,{children:".handlers"})})," property set in the ",(0,i.jsx)(n.em,{children:"settings"})," parameter of the ",(0,i.jsx)(n.a,{href:"/docs/es/API/WebServerClass#start",children:"start()"})," function, for any web server object:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:"WEB Server.start($settings.handlers) //set rules at web server startup\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If both a ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"})," file and a call to the ",(0,i.jsx)(n.a,{href:"/docs/es/commands/web-server",children:(0,i.jsx)(n.code,{children:"WEB Server"})})," command with a valid ",(0,i.jsx)(n.code,{children:"$settings.handlers"})," are used, the ",(0,i.jsx)(n.code,{children:"WEB Server"})," command has priority."]}),"\n",(0,i.jsxs)(n.p,{children:["The json file (or the object in the ",(0,i.jsx)(n.em,{children:"settings"})," parameter) contains all listened URL patterns, the handled verbs, and the code to be called."]}),"\n",(0,i.jsx)(n.p,{children:"Handlers are provided as a collection."}),"\n",(0,i.jsx)(n.p,{children:"At runtime, the first pattern matching the URL is executed, the others are ignored."}),"\n",(0,i.jsxs)(n.p,{children:["Este es un ejemplo del contenido de un archivo ",(0,i.jsx)(n.em,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'\n[\n    {\n        "class": "GeneralHandling",\n        "method": "gettingStarted",\n        "pattern": "start",\n        "verbs": "get, post"\n    }\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This handler declaration can be read as: when any request starting by ",(0,i.jsx)(n.code,{children:"/start/"})," with a ",(0,i.jsx)(n.code,{children:"GET"})," or ",(0,i.jsx)(n.code,{children:"POST"})," verb is received by the server, the ",(0,i.jsx)(n.code,{children:"gettingStarted"})," function of the ",(0,i.jsx)(n.code,{children:"GeneralHandling"})," singleton is executed."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"You must restart the Web server so that modifications made in this file are taken into account."})}),"\n",(0,i.jsx)(n.h2,{id:"definici\xf3n-del-gestor",children:"Definici\xf3n del gestor"}),"\n",(0,i.jsx)(n.p,{children:"Un manejador est\xe1 definido por:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"a listened URL pattern"}),"\n",(0,i.jsx)(n.li,{children:"a function and its class where the code is implemented to handle the listened URL pattern"}),"\n",(0,i.jsx)(n.li,{children:"the verbs with which the URL can be called to trigger the handler"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The handler identifier is the couple [pattern + a verb among the verbs list]."}),"\n",(0,i.jsx)(n.h3,{id:"patrones-de-la-url",children:"Patrones de la URL"}),"\n",(0,i.jsxs)(n.p,{children:["URL patterns can be given as ",(0,i.jsx)(n.strong,{children:"prefixes"})," or using ",(0,i.jsx)(n.strong,{children:"regular expressions"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:['To declare a prefix pattern, use the "pattern" property name in the HTTPHandlers.json file. Prefixes are considered as regular expressions already containing starting and ending ',(0,i.jsx)(n.code,{children:"/"}),".",(0,i.jsx)(n.br,{}),"\nEj: ",(0,i.jsx)(n.code,{children:'"pattern": "docs"'})," o ",(0,i.jsx)(n.code,{children:'"pattern": "docs/invoices"'})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:['To declare a regular expression pattern, use the "regexPattern" property name in the HTTPHandlers.json file. Los modelos de expresiones regulares se manejan directamente.\nEj: ',(0,i.jsx)(n.code,{children:'"regexPattern" : "/docs/.+/index\\.html"'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'"Pattern" and "regexPattern" properties cannot be used in the same handler definition (in this case, only the "regexPattern" property is taken into account).'}),"\n",(0,i.jsx)(n.h4,{id:"concordancia-de-modelos",children:"Concordancia de modelos"}),"\n",(0,i.jsx)(n.p,{children:"Los modelos de URL se activan en el orden indicado:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"se ejecuta el primer modelo coincidente"}),"\n",(0,i.jsx)(n.li,{children:"los siguientes patrones no se ejecutan aunque coincidan con la URL"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"As a consequence, you need to apply a accurate strategy when writing your handlers: the most detailed patterns must be written before the more general patterns."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleTheInvoice",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleUnauthorizedVerbs",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "comment": "This handler is triggered for all verbs except GET (handled above)"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs",\n        "comment": "This handler is triggered for all the verbs"\n    }\n]\n\n'})}),"\n",(0,i.jsx)(n.h4,{id:"patrones-prohibidos",children:"Patrones prohibidos"}),"\n",(0,i.jsx)(n.p,{children:"URL patterns matching 4D built-in HTTP processing features are not allowed in custom HTTP handlers. Por ejemplo, los siguientes modelos no pueden ser manejados:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/4DACTION"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/rest"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/$lib/renderer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/$shared"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"clase-y-m\xe9todo",children:"Clase y m\xe9todo"}),"\n",(0,i.jsx)(n.p,{children:'You declare the code to be executed when a defined URL pattern is intercepted using the "class" and "method" properties.'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:['"class": class name without ',(0,i.jsx)(n.code,{children:"cs."}),', e.g. "UsersHandling" for the ',(0,i.jsx)(n.code,{children:"cs.UsersHandling"})," user class. Debe ser una clase ",(0,i.jsx)(n.a,{href:"/docs/es/Concepts/classes#shared-singleton",children:(0,i.jsx)(n.strong,{children:"compartida"})})," y ",(0,i.jsx)(n.a,{href:"/docs/es/Concepts/classes#singleton-classes",children:(0,i.jsx)(n.strong,{children:"singleton"})}),"."]}),"\n",(0,i.jsx)(n.li,{children:'"method": funci\xf3n de clase perteneciente a la clase.'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"#request-handler-code",children:"Ver abajo"})," para obtener informaci\xf3n sobre el c\xf3digo del gestor de peticiones."]}),"\n",(0,i.jsx)(n.h3,{id:"verbs",children:"Verbs"}),"\n",(0,i.jsx)(n.p,{children:'You can use the "verbs" property in the handler definition to declare HTTP verbs that are supported in incoming requests for this handler. A request that uses a verb that is not explicitely allowed is automatically rejected by the server.'}),"\n",(0,i.jsx)(n.p,{children:"You can declare several verbs, separated by a comma. Los nombres de verbos no distinguen entre may\xfasculas y min\xfasculas."}),"\n",(0,i.jsxs)(n.p,{children:["Ej: ",(0,i.jsx)(n.code,{children:'"verbs" : "PUT, POST"'})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"No control is done on verb names. Se pueden utilizar todos los nombres."})}),"\n",(0,i.jsxs)(n.p,{children:['By default, if the "verbs" property is not used for a handler, ',(0,i.jsx)(n.strong,{children:"all"})," HTTP verbs are supported in incoming requests for this handler (except those possibly used beforehand in a more detailed pattern, as shown in the example above)."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["El verbo HTTP tambi\xe9n puede ser evaluado ",(0,i.jsxs)(n.a,{href:"/docs/es/API/IncomingMessageClass#verb",children:["utilizando la propiedad ",(0,i.jsx)(n.code,{children:".verb"})," dentro del c\xf3digo del manejador de peticiones"]})," para ser aceptado o rechazado."]})}),"\n",(0,i.jsx)(n.h2,{id:"ejemplo",children:"Ejemplo"}),"\n",(0,i.jsx)(n.p,{children:"He aqu\xed un ejemplo detallado de un archivo HTTPHandlers.json:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'\n[\n   {\n        "clase": "GeneralHandling",\n        "method": "handle",\n        "pattern": "info", //prefijo URL \n        "verbs": "GET"\n    }, \n    {\n        "class": "UsersHandling",\n        "method": "manageAccount",\n        "pattern": "userAccount/update", //prefijo URL\n        "verbs": "PUT,POST"\n    }, \n    {\n        "class": "FinancialHandling",\n        "method": "handleInvoices",\n        "regexPattern": "/docs/invoices/(past|today)", //prefijo de URL dado como regex\n        "verbs": "GET"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs/myPage.html", //prefijo de URL dado como regex\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleTheInvoice",\n                "pattern": "docs/invoices/details/theInvoice", // La URL m\xe1s espec\xedfica primero\n        "verbs": "GET,POST"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleDetails",\n            "pattern": "docs/invoices/details",  // Las URL generales despu\xe9s de\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleInvoices", // Las URL generales despu\xe9s de\n        "pattern": "docs/invoices",\n        "verbs": "GET"\n    }\n]\n\n'})}),"\n",(0,i.jsx)(n.p,{children:"En este ejemplo, debe implementar las siguientes funciones:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"funci\xf3nhandle"})," en la clase *GeneralHandling"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"manageAccount"})," en la clase ",(0,i.jsx)(n.em,{children:"UsersHandling"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleInvoices"})," en la clase ",(0,i.jsx)(n.em,{children:"FinancialHandling"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleDocs"})," en la clase ",(0,i.jsx)(n.em,{children:"DocsHandling"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"handleTheInvoice"})," / ",(0,i.jsx)(n.em,{children:"handleDetails"})," / ",(0,i.jsx)(n.em,{children:"handleInvoices"})," en la clase ",(0,i.jsx)(n.em,{children:"InvoicesHandling"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples of URLs triggering the handlers:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/info/"})," con un verbo GET\n",(0,i.jsx)(n.code,{children:"IP:port/info/general"})," con un verbo GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/userAccount/update/"})," con un verbo POST\n",(0,i.jsx)(n.code,{children:"IP:port/userAccount/update/profile"})," con un verbo POST"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port/docs/invoices/past"})," con un verbo GET\n",(0,i.jsx)(n.code,{children:"IP:port/docs/invoices/today/latest"})," con un verbo GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port//docs/myPage.html"})," con un verbo GET"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IP:port//docs/invoices/"})," con un verbo GET, llama a la funci\xf3n ",(0,i.jsx)(n.em,{children:"handleInvoices"})," (clase ",(0,i.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,i.jsx)(n.code,{children:"IP:port//docs/invoices/details/"})," con un verbo GET, llama a la funci\xf3n ",(0,i.jsx)(n.em,{children:"handleDetails"})," (clase ",(0,i.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,i.jsx)(n.code,{children:"IP:port//docs/invoices/details/theInvoice/xxxxxx"})," con un verbo GET, llama a la funci\xf3n ",(0,i.jsx)(n.em,{children:"handleTheInvoice"})," (clase ",(0,i.jsx)(n.em,{children:"InvoiceslHandling"}),")"]}),"\n",(0,i.jsx)(n.h2,{id:"c\xf3digo-del-gestor-de-peticiones",children:"C\xf3digo del gestor de peticiones"}),"\n",(0,i.jsx)(n.h3,{id:"configuraci\xf3n-de-funciones",children:"Configuraci\xf3n de funciones"}),"\n",(0,i.jsxs)(n.p,{children:["The HTTP Request handler code must be implemented in a function of a ",(0,i.jsx)(n.a,{href:"/docs/es/Concepts/classes#shared-singleton",children:(0,i.jsx)(n.strong,{children:"Shared"})})," ",(0,i.jsx)(n.a,{href:"/docs/es/Concepts/classes#singleton-classes",children:(0,i.jsx)(n.strong,{children:"singleton class"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:['If the singleton is missing or not shared, an error "Cannot find singleton" is returned by the server. If the class or the function ',(0,i.jsx)(n.a,{href:"#handler-definition",children:"defined as handler"}),' in the HTTPHandlers.json file is not found, an error "Cannot find singleton function" is returned by the server.']}),"\n",(0,i.jsxs)(n.p,{children:["Request handler functions are not necessarily shared, unless some request handler properties are updated by the functions. En este caso, necesita declarar sus funciones con la ",(0,i.jsx)(n.a,{href:"/docs/es/Concepts/classes#shared-functions",children:"palabra clave 'shared'"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"no es recomendado"})," exponer las funciones del gestor de solicitudes a llamadas REST externas usando las palabras claves ",(0,i.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#exposed-vs-non-exposed-functions",children:(0,i.jsx)(n.code,{children:"exposed"})})," o ",(0,i.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#onhttpget-keyword",children:(0,i.jsx)(n.code,{children:"onHTTPGet"})}),"."]})}),"\n",(0,i.jsx)(n.h3,{id:"entrada-una-instancia-de-la-clase-4dincomingmessage",children:"Entrada: una instancia de la clase 4D.IncomingMessage"}),"\n",(0,i.jsxs)(n.p,{children:["Cuando una solicitud ha sido interceptada por el manejador, se recibe en el servidor como una instancia de la ",(0,i.jsx)(n.a,{href:"/docs/es/API/IncomingMessageClass",children:"clase 4D.IncomingMessage"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"All necessary information about the request are available in this object, including the request url, verb, headers, and, if any, parameters (put in the URL) and body."}),"\n",(0,i.jsx)(n.p,{children:"Then, the request handler can use this information to trigger appropriate business logic."}),"\n",(0,i.jsx)(n.h3,{id:"output-an-instance-of-the-4doutgoingmessage-class",children:"Output: an instance of the 4D.OutgoingMessage class"}),"\n",(0,i.jsxs)(n.p,{children:["The request handler can return an object instance of the ",(0,i.jsx)(n.a,{href:"/docs/es/API/OutgoingMessageClass",children:"4D.OutGoingMessage class"}),", i.e. some full web content ready for a browser to handle, such as a file content."]}),"\n",(0,i.jsx)(n.h3,{id:"ejemplo-1",children:"Ejemplo"}),"\n",(0,i.jsxs)(n.p,{children:["La ",(0,i.jsx)(n.a,{href:"/docs/es/API/IncomingMessageClass",children:"clase 4D.IncomingMessage"})," ofrece funciones para obtener los ",(0,i.jsx)(n.a,{href:"/docs/es/API/IncomingMessageClass#headers",children:"encabezados"})," y el ",(0,i.jsx)(n.a,{href:"/docs/es/API/IncomingMessageClass#gettext",children:"cuerpo"})," de la solicitud."]}),"\n",(0,i.jsx)(n.p,{children:"He aqu\xed un ejemplo sencillo para cargar un archivo en el servidor."}),"\n",(0,i.jsxs)(n.p,{children:["El archivo ",(0,i.jsx)(n.strong,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "UploadFile",\n        "method": "uploadFile",\n        "regexPattern": "/putFile",\n        "verbs": "POST"\n    }\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["La URL llamada es: ",(0,i.jsx)(n.a,{href:"http://127.0.0.1:8044/putFile?fileName=testFile",children:"http://127.0.0.1:8044/putFile?fileName=testFile"})]}),"\n",(0,i.jsxs)(n.p,{children:["The binary content of the file is put in the body of the request and a POST verb is used. El nombre del archivo se da como par\xe1metro (",(0,i.jsx)(n.em,{children:"fileName"}),") en la URL. Se recibe en el objeto ",(0,i.jsx)(n.a,{href:"/docs/es/API/IncomingMessageClass#urlquery",children:(0,i.jsx)(n.code,{children:"urlQuery"})})," en la petici\xf3n."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:'    //UploadFile class\n\nshared singleton Class constructor()\n	\n	\nFunction uploadFile($request : 4D.IncomingMessage) : 4D.OutgoingMessage\n	\n	var $response:=4D.OutgoingMessage.new()\n	\n	var $body:="Not supported file"\n	var $fileName; $fileType : Text\n	var $file : 4D.File\n	var $picture : Picture\n	var $created : Boolean\n	\n	$fileName:=$request.urlQuery.fileName\n	$fileType:=$request.getHeader("Content-Type")\n	\n	Case of \n		: ($fileType="application/pdf")\n			$file:=File("/PACKAGE/Files/"+$fileName+".pdf")\n			$created:=$file.create()\n			$file.setContent($request.getBlob())\n			$body:="Upload OK - File size: "+String($file.size)\n			\n		: ($fileType="image/jpeg")\n			$file:=File("/PACKAGE/Files/"+$fileName+".jpg")\n			$picture:=$request.getPicture()\n			WRITE PICTURE FILE($file.platformPath; $picture)\n			$body:="Upload OK - Image size: "+String($file.size)\n			\n	End case \n	\n	$response.setBody($body)\n	$response.setHeader("Content-Type"; "text/plain")\n	\n	return $response\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://blog.4d.com/master-http-requests-with-4d-request-handlers/",children:"Perfect mastery of your back end business logic thanks to HTTP requests handlers"})," (blog post)"]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,n,s){s.d(n,{Z:()=>t,a:()=>o});var r=s(667294);let i={},a=r.createContext(i);function o(e){let n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);