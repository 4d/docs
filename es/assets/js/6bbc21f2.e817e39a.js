"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[62001],{148656:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>i});var n=s(474848),l=s(28453);const r={id:"query-by-sql",title:"QUERY BY SQL",slug:"/commands/query-by-sql",displayed_sidebar:"docs"},c=void 0,o={id:"commands-legacy/query-by-sql",title:"QUERY BY SQL",description:"QUERY BY SQL ( {tabla ;} formulaSQL )",source:"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R7/commands-legacy/query-by-sql.md",sourceDirName:"commands-legacy",slug:"/commands/query-by-sql",permalink:"/docs/es/commands/query-by-sql",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fquery-by-sql.md%20(20-R7)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R7",frontMatter:{id:"query-by-sql",title:"QUERY BY SQL",slug:"/commands/query-by-sql",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"Is field value Null",permalink:"/docs/es/commands/is-field-value-null"},next:{title:"SET FIELD VALUE NULL",permalink:"/docs/es/commands/set-field-value-null"}},d={},i=[{value:"Descripci\xf3n",id:"descripci\xf3n",level:4},{value:"Acerca de relaciones",id:"acerca-de-relaciones",level:5},{value:"Ejemplo 1",id:"ejemplo-1",level:4},{value:"Ejemplo 2",id:"ejemplo-2",level:4},{value:"Ejemplo 3",id:"ejemplo-3",level:4},{value:"Ejemplo 4",id:"ejemplo-4",level:4},{value:"Variables y conjuntos del sistema",id:"variables-y-conjuntos-del-sistema",level:4},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:4}];function t(e){const a={a:"a",code:"code",em:"em",h4:"h4",h5:"h5",mivar:"mivar",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"QUERY BY SQL"})," ( {",(0,n.jsx)(a.em,{children:"tabla"})," ;} ",(0,n.jsx)(a.em,{children:"formulaSQL"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Par\xe1metro"}),(0,n.jsx)(a.th,{children:"Tipo"}),(0,n.jsx)(a.th,{}),(0,n.jsx)(a.th,{children:"Descripci\xf3n"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"tabla"}),(0,n.jsx)(a.td,{children:"Table"}),(0,n.jsx)(a.td,{children:"\u2192"}),(0,n.jsx)(a.td,{children:"Tabla en la cual devolver una selecci\xf3n de registros o Tabla por defecto si este par\xe1metro se omite"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"formulaSQL"}),(0,n.jsx)(a.td,{children:"Text"}),(0,n.jsx)(a.td,{children:"\u2192"}),(0,n.jsx)(a.td,{children:"F\xf3rmula de b\xfasqueda SQL v\xe1lida representando la cl\xe1usula WHERE de la b\xfasqueda SELECT"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.em,{children:"Este comando no es hilo seguro, no puede ser utilizado en c\xf3digo apropiativo."})}),"\n",(0,n.jsx)(a.h4,{id:"descripci\xf3n",children:"Descripci\xf3n"}),"\n",(0,n.jsx)(a.p,{children:"El comando QUERY BY SQL permite aprovechar directamente el motor SQL integrado de 4D. Este comando puede ejecutar una petici\xf3n SELECT simple que puede escribirse de esta forma:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0SELECT *\xa0\xa0\xa0\xa0\xa0\xa0FROM tabla\xa0\xa0\xa0\xa0\xa0\xa0WHERE \n"})}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.em,{children:"unaTabla"})," es el nombre de la tabla pasada en el primer par\xe1metro y ",(0,n.jsx)(a.em,{children:"formulaSQL"})," la cadena de b\xfasqueda pasada en el segundo par\xe1metro."]}),"\n",(0,n.jsx)(a.p,{children:"Por ejemplo, la siguiente instrucci\xf3n:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0([Empleados];"nombre=\u2019juan\u2019")\n'})}),"\n",(0,n.jsx)(a.p,{children:"es equivalente a la b\xfasqueda SQL:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:'\xa0\xa0\xa0SELECT * FROM Empleados WHERE "nombre=\u2019juan\u2019"\n'})}),"\n",(0,n.jsxs)(a.p,{children:["El comando QUERY BY SQL es similar al comando ",(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",title:"QUERY BY FORMULA",children:"QUERY BY FORMULA"}),". El comando busca registros en la tabla especificada. Modifica la selecci\xf3n actual de ",(0,n.jsx)(a.em,{children:"unaTabla"})," para el proceso actual y vuelve el primer registro de la nueva selecci\xf3n el registro actual."]}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Nota:"})," el comando QUERY BY SQL no puede utilizarse en el contexto de una conexi\xf3n SQL externa; \xe9l contacta el motor SQL integrado de 4D directamente."]}),"\n",(0,n.jsxs)(a.p,{children:["QUERY BY SQL aplica ",(0,n.jsx)(a.em,{children:"formulaSQL"})," a cada registro de la selecci\xf3n de la tabla. ",(0,n.jsx)(a.em,{children:"formulaSQL"})," es una expresi\xf3n booleana que debe devolver ",(0,n.jsx)(a.a,{href:"/docs/es/commands/true",title:"True",children:"True"})," o ",(0,n.jsx)(a.a,{href:"/docs/es/commands/false",title:"False",children:"False"}),". Como sabe, en el est\xe1ndar SQL, una condici\xf3n de b\xfasqueda puede tener un resultado ",(0,n.jsx)(a.a,{href:"/docs/es/commands/true",title:"True",children:"True"}),", ",(0,n.jsx)(a.a,{href:"/docs/es/commands/false",title:"False",children:"False"})," o ",(0,n.jsx)(a.a,{href:"/docs/es/commands/null",title:"NULL",children:"NULL"}),". Todos los registros (filas) donde la condici\xf3n de b\xfasqueda devuelva ",(0,n.jsx)(a.a,{href:"/docs/es/commands/true",title:"True",children:"True"})," se incluyen en la nueva selecci\xf3n actual."]}),"\n",(0,n.jsxs)(a.p,{children:["La expresi\xf3n ",(0,n.jsx)(a.em,{children:"formulaSQL"})," puede ser simple, como la comparaci\xf3n de un campo (columna) con un valor; o compleja, como un c\xe1lculo. Como ",(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",title:"QUERY BY FORMULA",children:"QUERY BY FORMULA"}),", QUERY BY SQL puede evaluar la informaci\xf3n en las tablas relacionadas (ver el ejemplo 4). ",(0,n.jsx)(a.em,{children:"formulaSQL"})," debe ser una instrucci\xf3n SQL v\xe1lida, conforme con el est\xe1ndar SQL-2 y con respecto a las limitaciones actuales de implementaci\xf3n del SQL en 4D. Para mayor informaci\xf3n sobre soporte SQL en 4D, consulte el manual 4D SQL."]}),"\n",(0,n.jsxs)(a.p,{children:["El par\xe1metro ",(0,n.jsx)(a.em,{children:"formulaSQL"})," puede utilizar referencias a expresiones 4D. La sintaxis a utilizar es la misma que para los comandos SQL integrados o el c\xf3digo incluido entre las etiquetas ",(0,n.jsx)(a.a,{href:"/docs/es/commands/begin-sql",title:"Begin SQL",children:"Begin SQL"}),"/",(0,n.jsx)(a.a,{href:"/docs/es/commands/end-sql",title:"End SQL",children:"End SQL"}),", es decir: ",(0,n.jsxs)(a.em,{children:["<",(0,n.jsx)(a.mivar,{children:">"})]})," o ",(0,n.jsx)(a.em,{children:":MiVar"}),"."]}),"\n",(0,n.jsx)(a.p,{children:"Para mayor informaci\xf3n, consulte la secci\xf3n ."}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Nota:"})," este comando es compatible con los comandos ",(0,n.jsx)(a.a,{href:"/docs/es/commands/set-query-limit",title:"SET QUERY LIMIT",children:"SET QUERY LIMIT"})," y ",(0,n.jsx)(a.a,{href:"/docs/es/commands/set-query-destination",title:"SET QUERY DESTINATION",children:"SET QUERY DESTINATION"}),"."]}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Recordatorio"}),": las referencias a las variables locales no son posibles en modo compilado. Para mayor informaci\xf3n sobre la programaci\xf3n SQL en 4D, consulte la secci\xf3n ",(0,n.jsx)(a.em,{children:"Presentaci\xf3n de los comandos del tema SQL"})]}),"\n",(0,n.jsx)(a.h5,{id:"acerca-de-relaciones",children:"Acerca de relaciones"}),"\n",(0,n.jsx)(a.p,{children:"QUERY BY SQL no utiliza relaciones entre tablas definidas en el editor de estructura 4D. Si quiere utilizar los datos relacionados, tendr\xe1 que a\xf1adir JOIN a la b\xfasqueda. Por ejemplo, asumiendo que tenemos la siguiente estructura, en la cual una relaci\xf3n Muchos a Uno est\xe1 relacionado los campos [Personas]Ciudad con [Ciudades]Nombre:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0[Personas]\xa0\xa0\xa0\xa0\xa0\xa0Nombre\xa0\xa0\xa0\xa0\xa0\xa0Ciudad\xa0\xa0\xa0[Ciudades]\xa0\xa0\xa0\xa0\xa0\xa0Nombre\xa0\xa0\xa0\xa0\xa0\xa0Poblacion\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Utilizando el comando ",(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",title:"QUERY BY FORMULA",children:"QUERY BY FORMULA"}),", puede escribir:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:"\xa0QUERY BY FORMULA([Personas];[Ciudades]Poblacion>1000)\n"})}),"\n",(0,n.jsx)(a.p,{children:"Utilizando QUERY BY SQL, debe escribir la siguiente instrucci\xf3n, sin importar si la relaci\xf3n existe o no:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0QUERY BY SQL([Personas];"personas.ciudad=ciudades.nombre AND ciudades.poblaci\xf3n>1000")\n'})}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Nota:"})," QUERY BY SQL trata las relaciones Uno a Muchos y Muchos a Uno de una manera diferente a la de ",(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",title:"QUERY BY FORMULA",children:"QUERY BY FORMULA"}),"."]}),"\n",(0,n.jsx)(a.h4,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,n.jsx)(a.p,{children:"Este ejemplo muestra las oficinas con ventas superiores a 100. La b\xfasqueda SQL es:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0SELECT *\xa0\xa0\xa0\xa0\xa0\xa0FROM Oficinas\xa0\xa0\xa0\xa0\xa0\xa0WHERE Ventas > 100\n"})}),"\n",(0,n.jsx)(a.p,{children:"Utilizando el comando QUERY BY SQL:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0C_STRING(30;$formulabusqueda)\n\xa0$formulabusqueda:="Ventas> 100"\n\xa0QUERY BY SQL([Oficinas];$formulabusqueda)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"ejemplo-2",children:"Ejemplo 2"}),"\n",(0,n.jsx)(a.p,{children:"Este ejemplo muestra las \xf3rdenes comprendidas entre 3 000 y 4 000. La b\xfasqueda SQL es:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0SELECT *\xa0\xa0\xa0\xa0\xa0\xa0FROM Ordenes\xa0\xa0\xa0\xa0\xa0\xa0WHERE Cantidad BETWEEN 3000 AND 4000\n"})}),"\n",(0,n.jsx)(a.p,{children:"Utilizando el comando QUERY BY SQL:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0C_STRING(40;$formulabusqueda)\n\xa0$formulabusqueda:="Cantidad BETWEEN 3000 AND 4000"\n\xa0QUERY BY SQL([Ordenes];$formulabusqueda)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"ejemplo-3",children:"Ejemplo 3"}),"\n",(0,n.jsx)(a.p,{children:"Este ejemplo muestra c\xf3mo obtener el resultado de la b\xfasqueda ordenado con un criterio espec\xedfico. La b\xfasqueda SQL es:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0SELECT *\xa0\xa0\xa0\xa0\xa0\xa0FROM Personas\xa0\xa0\xa0\xa0\xa0\xa0WHERE City =\u2019Paris\u2019\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ORDER BY Nombre\n"})}),"\n",(0,n.jsx)(a.p,{children:"Utilizando el comando QUERY BY SQL:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0C_STRING(40;$formulabusqueda)\n\xa0$formulabusqueda:="City= \u2018Paris\u2019 ORDER BY Nombre"\n\xa0QUERY BY SQL([Personas];$formulabusqueda)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"ejemplo-4",children:"Ejemplo 4"}),"\n",(0,n.jsx)(a.p,{children:"Este ejemplo muestra una b\xfasqueda utilizando tablas relacionadas en 4D. En SQL debe utilizar un JOIN para simular esta relaci\xf3n. Consideremos las dos tablas siguientes:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0[Facturas] con los campos (columnas) siguientes:\xa0\xa0\xa0\xa0\xa0\xa0ID_Fact: Entero largo\xa0\xa0\xa0\xa0\xa0\xa0Fecha_Fact: Fecha\xa0\xa0\xa0\xa0\xa0\xa0Total: Real\xa0\xa0\xa0[Lineas_Facturas] con las siguientes columnas (campos):\xa0\xa0\xa0\xa0\xa0\xa0ID_Linea: Entero largo\xa0\xa0\xa0\xa0\xa0\xa0ID_Fact: Entero largo\xa0\xa0\xa0\xa0\xa0\xa0Codigo: Alfa (10)\n"})}),"\n",(0,n.jsx)(a.p,{children:"Existe una relaci\xf3n Muchos a Uno de [Lineas_Facturas]ID_Fact con [Facturas]ID_Fact."}),"\n",(0,n.jsxs)(a.p,{children:["Utilizando el comando ",(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",title:"QUERY BY FORMULA",children:"QUERY BY FORMULA"}),", puede escribir:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0QUERY BY FORMULA([Lineas_Facturas];([Lineas_Facturas]Codigo="FX-200")\xa0&\xa0(Month of([Facturas]Fecha_Fact)=4))\n'})}),"\n",(0,n.jsx)(a.p,{children:"La b\xfasqueda SQL es:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-SQL",children:"\xa0\xa0\xa0SELECT ID_Linea\xa0\xa0\xa0\xa0\xa0\xa0FROM Lineas_Facturas, Facturas\xa0\xa0\xa0\xa0\xa0\xa0WHERE Lineas_Facturas.ID_Fact=Facturas.ID_Fact\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0AND Lineas_Facturas.Codigo='FX-200'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0AND MONTH(Facturas.Fecha_Fact) = 4\n"})}),"\n",(0,n.jsx)(a.p,{children:"Cuando utiliza el comando QUERY BY SQL:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-4d",children:'\xa0C_STRING(40;$queryFormula)\n\xa0$formulaBusqueda:="Lineas_Facturas.ID_Fact=Facturas.ID_FactAND Lineas_Facturas.Codigo=\u2019FX-200\u2019 AND MONTH(Facturas.Fecha_Fact)=4"\n\xa0QUERY BY SQL([Lineas_Facturas];$formulaBusqueda)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"variables-y-conjuntos-del-sistema",children:"Variables y conjuntos del sistema"}),"\n",(0,n.jsxs)(a.p,{children:["Si el formato de la condici\xf3n de b\xfasqueda es correcto, la variable sistema OK toma el valor 1. De lo contrario, toma el valor 0, el resultado del comando es una selecci\xf3n vac\xeda y se devuelve un error. Este error puede ser interceptado por un m\xe9todo instalado utilizando el comando ",(0,n.jsx)(a.a,{href:"/docs/es/commands/on-err-call",title:"ON ERR CALL",children:"ON ERR CALL"}),"."]}),"\n",(0,n.jsx)(a.h4,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.a,{href:"/docs/es/commands/query-by-formula",children:"QUERY BY FORMULA"})})]})}function u(e={}){const{wrapper:a}={...(0,l.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}},28453:(e,a,s)=>{s.d(a,{R:()=>c,x:()=>o});var n=s(296540);const l={},r=n.createContext(l);function c(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);