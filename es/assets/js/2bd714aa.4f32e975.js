"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["30138"],{85693:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>a,toc:()=>o,default:()=>h,metadata:()=>s,assets:()=>d,contentTitle:()=>l});var s=JSON.parse('{"id":"ORDA/orda-events","title":"Eventos de entidad","description":"Historia","source":"@site/i18n/es/docusaurus-plugin-content-docs/version-21/ORDA/orda-events.md","sourceDirName":"ORDA","slug":"/ORDA/orda-events","permalink":"/docs/es/ORDA/orda-events","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20ORDA%2Forda-events.md%20(21)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"21","frontMatter":{"id":"orda-events","title":"Eventos de entidad"},"sidebar":"docs","previous":{"title":"Trabajar con los datos","permalink":"/docs/es/ORDA/entities"},"next":{"title":"Utilizando el sello global","permalink":"/docs/es/ORDA/global-stamp"}}'),r=t(474848),i=t(884429);let a={id:"orda-events",title:"Eventos de entidad"},l,d={},o=[{value:"Generalidades",id:"generalidades",level:2},{value:"Nivel del evento",id:"nivel-del-evento",level:3},{value:"Ejecuci\xf3n en configuraciones remotas",id:"ejecuci\xf3n-en-configuraciones-remotas",level:3},{value:"Tabla resumen",id:"tabla-resumen",level:3},{value:"Par\xe1metro <em>event</em>",id:"par\xe1metro-event",level:2},{value:"Objeto error",id:"objeto-error",level:2},{value:"Propiedades del objeto error",id:"propiedades-del-objeto-error",level:3},{value:"Descripci\xf3n de las funciones",id:"descripci\xf3n-de-las-funciones",level:2},{value:"<code>Function event touched</code>",id:"function-event-touched",level:3},{value:"Sintaxis",id:"sintaxis",level:4},{value:"Ejemplo 1",id:"ejemplo-1",level:4},{value:"Ejemplo 2",id:"ejemplo-2",level:4},{value:"Ejemplo 3 (diagrama): cliente/servidor con la palabra clave <code>local</code>:",id:"ejemplo-3-diagrama-clienteservidor-con-la-palabra-clave-local",level:4},{value:"Ejemplo 4 (diagrama): cliente/servidor sin la palabra clave <code>local</code>",id:"ejemplo-4-diagrama-clienteservidor-sin-la-palabra-clave-local",level:4},{value:"Ejemplo 5 (diagrama): Aplicaci\xf3n Qodly",id:"ejemplo-5-diagrama-aplicaci\xf3n-qodly",level:4},{value:"<code>Function event validateSave</code>",id:"function-event-validatesave",level:3},{value:"Sintaxis",id:"sintaxis-1",level:4},{value:"Ejemplo",id:"ejemplo",level:4},{value:"<code>Function event saving</code>",id:"function-event-saving",level:3},{value:"Sintaxis",id:"sintaxis-2",level:4},{value:"Ejemplo",id:"ejemplo-3",level:4},{value:"<code>Function event afterSave</code>",id:"function-event-aftersave",level:3},{value:"Sintaxis",id:"sintaxis-3",level:4},{value:"Ejemplo",id:"ejemplo-4",level:4},{value:"<code>Function event validateDrop</code>",id:"function-event-validatedrop",level:3},{value:"Sintaxis",id:"sintaxis-4",level:4},{value:"Ejemplo",id:"ejemplo-5",level:4},{value:"<code>Function event dropping</code>",id:"function-event-dropping",level:3},{value:"Sintaxis",id:"sintaxis-5",level:4},{value:"Ejemplo",id:"ejemplo-6",level:4},{value:"<code>Function event afterDrop</code>",id:"function-event-afterdrop",level:3},{value:"Sintaxis",id:"sintaxis-6",level:4},{value:"Ejemplo",id:"ejemplo-7",level:4}];function c(e){let n={a:"a",admonition:"admonition",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.details,{children:[(0,r.jsx)(n.summary,{children:"Historia"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Lanzamiento"}),(0,r.jsx)(n.th,{children:"Modificaciones"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"21"}),(0,r.jsx)(n.td,{children:"Eventos a\xf1adidos: validateSave / saving / afterSave / validateDrop / dropping / afterDrop"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20 R10"}),(0,r.jsx)(n.td,{children:"se ha a\xf1adido un evento touched"})]})]})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Los eventos de entidad son funciones que ORDA invoca autom\xe1ticamente cada vez que las entidades y los atributos de entidad se manipulan (a\xf1aden, eliminan o modifican). Puede escribir eventos muy sencillos y luego hacerlos m\xe1s sofisticados."}),"\n",(0,r.jsx)(n.p,{children:"No se puede activar directamente la ejecuci\xf3n de la funci\xf3n de evento. Los eventos son llamados autom\xe1ticamente por ORDA bas\xe1ndose en las acciones del usuario o en las operaciones realizadas mediante c\xf3digo sobre las entidades y sus atributos."}),"\n",(0,r.jsx)(n.admonition,{title:"Entrada de blog relacionada",type:"tip",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://blog.4d.com/orda-handle-an-event-driven-logic-during-database-operations",children:"ORDA - Manejar una l\xf3gica basada en eventos durante las acciones de persistencia de datos"})})}),"\n",(0,r.jsx)(n.admonition,{title:"Nota de compatibilidad",type:"info",children:(0,r.jsx)(n.p,{children:"Los eventos de entidad ORDA en el almacen de datos equivalen a triggers en la base de datos 4D. Sin embargo, las acciones desencadenadas a nivel de la base de datos 4D utilizando los comandos del lenguaje cl\xe1sico 4D o las acciones est\xe1ndar no desencadenan eventos ORDA."})}),"\n",(0,r.jsx)(n.h2,{id:"generalidades",children:"Generalidades"}),"\n",(0,r.jsx)(n.h3,{id:"nivel-del-evento",children:"Nivel del evento"}),"\n",(0,r.jsxs)(n.p,{children:["Una funci\xf3n de evento se define siempre en la ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#entity-class",children:"clase Entity"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Un evento puede definirse al nivel de la ",(0,r.jsx)(n.strong,{children:"entidad"})," y/o a nivel del ",(0,r.jsx)(n.strong,{children:"atributo"})," (incluye los ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#computed-attributes",children:(0,r.jsx)(n.strong,{children:"atributos calculados"})}),"). En el primer caso, se activar\xe1 para cualquier atributo de la entidad; en el otro caso, s\xf3lo se activar\xe1 para el atributo objetivo."]}),"\n",(0,r.jsx)(n.p,{children:"Para un mismo evento, puede definir diferentes funciones para diferentes atributos."}),"\n",(0,r.jsx)(n.p,{children:"Tambi\xe9n puede definir el mismo evento tanto a nivel del atributo como de la entidad. El evento atributo se llama primero y luego el evento entidad."}),"\n",(0,r.jsx)(n.h3,{id:"ejecuci\xf3n-en-configuraciones-remotas",children:"Ejecuci\xf3n en configuraciones remotas"}),"\n",(0,r.jsx)(n.p,{children:"Normalmente, los eventos ORDA se ejecutan en el servidor."}),"\n",(0,r.jsxs)(n.p,{children:["Sin embargo, en la configuraci\xf3n cliente/servidor, la funci\xf3n de evento ",(0,r.jsx)(n.code,{children:"touched()"})," puede ejecutarse en el ",(0,r.jsx)(n.strong,{children:"servidor o en el cliente"}),", dependiendo del uso de la palabra clave ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})}),". Una implementaci\xf3n espec\xedfica en el lado del cliente permite la activaci\xf3n del evento en el cliente."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Las funciones ORDA ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#class-constructor",children:(0,r.jsx)(n.code,{children:"constructor()"})})," se ejecutan siempre en el cliente."]})}),"\n",(0,r.jsxs)(n.p,{children:["Con otras configuraciones remotas (p. ej. ",(0,r.jsx)(n.a,{href:"https://developer.4d.com/qodly",children:"aplicaciones Qodly"}),", ",(0,r.jsx)(n.a,{href:"/docs/es/REST/REST_requests",children:"peticiones API REST"}),", o peticiones a trav\xe9s de ",(0,r.jsx)(n.a,{href:"/docs/es/commands/open-datastore",children:(0,r.jsx)(n.code,{children:"Open datastore"})}),"), la funci\xf3n de evento ",(0,r.jsx)(n.code,{children:"touched()"})," se ejecuta siempre ",(0,r.jsx)(n.strong,{children:"del lado del servidor"}),'. Esto significa que tiene que asegurarse de que el servidor puede "ver" que se ha tocado un atributo para activar el evento (ver abajo).']}),"\n",(0,r.jsx)(n.h3,{id:"tabla-resumen",children:"Tabla resumen"}),"\n",(0,r.jsx)(n.p,{children:"La siguiente tabla lista los eventos ORDA junto con sus reglas."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Evento"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nivel"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nombre de la funci\xf3n"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"(C/S) Ejecutado en"}),(0,r.jsx)(n.th,{children:"Puede detener la acci\xf3n devolviendo un error"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Instanciaci\xf3n de entidades"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"client"}),(0,r.jsx)(n.td,{children:"no"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo tocado"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched <attrName>()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["Depende de la palabra clave ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]}),(0,r.jsx)(n.td,{children:"no"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"event touched()"})}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["Depende de la palabra clave ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#local-functions",children:(0,r.jsx)(n.code,{children:"local"})})]}),(0,r.jsx)(n.td,{children:"no"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Antes de guardar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateSave <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateSave()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Al guardar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"saving <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"saving()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Despu\xe9s de guardar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"afterSave()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"no"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Antes de eliminar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateDrop <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"validateDrop()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Al soltar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Atributo"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"dropping <attrName>()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"}}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"dropping()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"s\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Despu\xe9s de eliminar una entidad"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entity"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.code,{children:"afterDrop()"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"server"}),(0,r.jsx)(n.td,{children:"no"})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La funci\xf3n ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})})," no es realmente una funci\xf3n de evento, pero siempre es llamada cuando una nueva entidad es instanciada."]})}),"\n",(0,r.jsxs)(n.h2,{id:"par\xe1metro-event",children:["Par\xe1metro ",(0,r.jsx)(n.em,{children:"event"})]}),"\n",(0,r.jsxs)(n.p,{children:["Las funciones de evento aceptan un \xfanico objeto ",(0,r.jsx)(n.em,{children:"event"})," como par\xe1metro. Cuando se llama a la funci\xf3n, el par\xe1metro se llena con varias propiedades:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Nombre de propiedad"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Disponibilidad"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Descripci\xf3n"}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"kind"'}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"siempre"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'Nombre del evento: "touched", "validateSave", "saving", "afterSave", "validateDrop", "dropping", "afterDrop"'}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"attributeName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'S\xf3lo para eventos implementados a nivel de atributos ("validateSave", "saving", "validateDrop", "dropping")'}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'Nombre del atributo (por ejemplo, "nombre")'}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.em,{children:"dataClassName"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"siempre"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["Nombre de la Dataclass (",(0,r.jsx)(n.em,{children:"ej."}),' "Company")']}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"savedAttributes"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["S\xf3lo en ",(0,r.jsx)(n.a,{href:"#function-event-aftersave",children:(0,r.jsx)(n.code,{children:"afterSave()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Colecci\xf3n de cadenas"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Nombres de atributos guardados correctamente"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"droppedAttributes"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["S\xf3lo en ",(0,r.jsx)(n.a,{href:"#function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"afterDrop()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Colecci\xf3n de cadenas"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Nombres de atributos suprimidos correctamente"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"saveStatus"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["S\xf3lo en ",(0,r.jsx)(n.a,{href:"#function-event-aftersave",children:(0,r.jsx)(n.code,{children:"afterSave()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"success" si el guardado fue exitoso, "failed" de lo contrario'}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"dropStatus"'}),(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["S\xf3lo en ",(0,r.jsx)(n.a,{href:"#function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"afterDrop()"})})]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:'"success" si la eliminaci\xf3n fue exitosa, "failed" de lo contrario'}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"objeto-error",children:"Objeto error"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"#summary-table",children:"Ciertas funciones de evento"})," pueden devolver un ",(0,r.jsx)(n.strong,{children:"objeto error"})," para plantear un error y detener la acci\xf3n en ejecuci\xf3n."]}),"\n",(0,r.jsxs)(n.p,{children:["Cuando ocurre un error en un evento, los otros eventos se detienen en el primer error planteado y la acci\xf3n (guardar o soltar) tambi\xe9n se detiene. Este error se env\xeda antes de que otros posibles errores como ",(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#save",children:"stamp has changed, entity locked"}),", etc."]}),"\n",(0,r.jsx)(n.h3,{id:"propiedades-del-objeto-error",children:"Propiedades del objeto error"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propiedad"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"}),(0,r.jsx)(n.th,{children:"Definido por el desarrollador"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"errCode"}),(0,r.jsx)(n.td,{children:"Integer"}),(0,r.jsxs)(n.td,{children:["Igual al comando ",(0,r.jsx)(n.a,{href:"/docs/es/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})})]}),(0,r.jsx)(n.td,{children:"S\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"message"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["Igual al comando ",(0,r.jsx)(n.a,{href:"/docs/es/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})})]}),(0,r.jsx)(n.td,{children:"S\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"extraDescription"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{children:"Informaci\xf3n libre a definir"}),(0,r.jsx)(n.td,{children:"S\xed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"seriousError"}),(0,r.jsx)(n.td,{children:"Boolean"}),(0,r.jsxs)(n.td,{children:["Utilizado s\xf3lo con eventos de validaci\xf3n (ver abajo). ",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"True"}),": crea un ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"error grave (imprevisible)"})," y activa una excepci\xf3n. A\xf1ade el estado ",(0,r.jsx)(n.code,{children:"dk status serious validation error"})]}),(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"False"}),": crea s\xf3lo un ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"error silencioso (previsible)"}),". A\xf1ade el estado ",(0,r.jsx)(n.code,{children:"dk status validation failed"}),"."]})]}),(0,r.jsx)(n.td,{children:"S\xed (por defecto es false)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"componentSignature"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:'Siempre "DBEV"'}),(0,r.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Los ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"errores cr\xedticos"})," est\xe1n apilados en la colecci\xf3n de la propiedad ",(0,r.jsx)(n.code,{children:"errors"})," del ",(0,r.jsx)(n.strong,{children:"objeto Result"})," devuelto por las funciones ",(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"save()"})})," o ",(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"drop()"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["En caso de un error provocado por un evento ",(0,r.jsx)(n.strong,{children:"validate"}),", la propiedad ",(0,r.jsx)(n.code,{children:"seriousError"})," le permite elegir el nivel del error a generar:\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Si es ",(0,r.jsx)(n.strong,{children:"true"}),": se arroja un error cr\xedtico y debe ser manejado por el ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"c\xf3digo de procesamiento de errores"}),", tal como un ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#trycatchend-try",children:"try catch"}),". En el objeto resultante de la funci\xf3n llamante, ",(0,r.jsx)(n.code,{children:"status"})," obtiene ",(0,r.jsx)(n.code,{children:"dk status serious validation error"})," y ",(0,r.jsx)(n.code,{children:"statusText"}),' obtiene "Serious Validation Error". El error se genera al final del evento y llega al cliente solicitando la acci\xf3n guardar/soltar (cliente REST por ejemplo).']}),"\n",(0,r.jsxs)(n.li,{children:["Si es ",(0,r.jsx)(n.strong,{children:"false"})," (por defecto): se genera un ",(0,r.jsx)(n.a,{href:"/docs/es/Concepts/error-handling#predictable-vs-unpredictable-errors",children:"error silencioso (previsible)"}),". No dispara ninguna excepci\xf3n y no se acumula en los errores devueltos por el comando ",(0,r.jsx)(n.a,{href:"/docs/es/commands/last-errors",children:(0,r.jsx)(n.code,{children:"Last errors"})}),". En el objeto resultante de la funci\xf3n llamante, ",(0,r.jsx)(n.code,{children:"status"})," obtiene ",(0,r.jsx)(n.code,{children:"dk status validation failed"})," y ",(0,r.jsx)(n.code,{children:"statusText"}),' obtiene "Mild Validation Error".']}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["En caso de un error provocado por un evento ",(0,r.jsx)(n.strong,{children:"guardar/soltar"})," cuando se retorna un objeto de error, el error siempre se plantea como un error cr\xedtico, sea cual sea el valor de la propiedad ",(0,r.jsx)(n.code,{children:"seriousError"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"descripci\xf3n-de-las-funciones",children:"Descripci\xf3n de las funciones"}),"\n",(0,r.jsx)(n.h3,{id:"function-event-touched",children:(0,r.jsx)(n.code,{children:"Function event touched"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"{local} Function event touched($event : Object)\n{local} Function event touched <attributeName>($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa cada vez que se modifica un valor en la entidad."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si define la funci\xf3n a nivel de entidad (primera sintaxis), se activa para modificaciones en cualquier atributo de la entidad."}),"\n",(0,r.jsx)(n.li,{children:"Si ha definido la funci\xf3n en el nivel de atributo (segunda sintaxis), se activa s\xf3lo para modificaciones en este atributo."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa tan pronto como el motor de 4D Server / 4D detecta una modificaci\xf3n del valor del atributo que puede deberse a las siguientes acciones:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["cliente/servidor con la ",(0,r.jsxs)(n.a,{href:"/docs/es/ORDA/ordaClasses#local-functions",children:["palabra clave ",(0,r.jsx)(n.code,{children:"local"})]})]})," o en ",(0,r.jsx)(n.strong,{children:"4D monousuario"}),":\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"el usuario define un valor en un formulario 4D,"}),"\n",(0,r.jsxs)(n.li,{children:["el c\xf3digo 4D realiza una asignaci\xf3n con el operador ",(0,r.jsx)(n.code,{children:":="}),". El evento tambi\xe9n se activa en caso de autoasignaci\xf3n (",(0,r.jsx)(n.code,{children:"$entity.attribute:=$entity.attribute"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["en ",(0,r.jsxs)(n.strong,{children:["cliente/servidor sin la palabra clave ",(0,r.jsx)(n.code,{children:"local"})]}),": alg\xfan c\xf3digo 4D que hace una asignaci\xf3n con el operador ",(0,r.jsx)(n.code,{children:":="})," es ",(0,r.jsx)(n.a,{href:"/docs/es/commands/execute-on-server",children:"ejecutado en el servidor"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["in ",(0,r.jsxs)(n.strong,{children:["client/server without the ",(0,r.jsx)(n.code,{children:"local"})," keyword"]}),", in ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://developer.4d.com/qodly",children:"Qodly application"})})," and ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/es/commands/open-datastore",children:"remote datastore"})}),": the entity is received on 4D Server while calling an ORDA function (on the entity or with the entity as parameter). Significa que puede que tenga que implementar una funci\xf3n ",(0,r.jsx)(n.em,{children:"refresh"})," o ",(0,r.jsx)(n.em,{children:"preview"})," en la aplicaci\xf3n remota que env\xeda una petici\xf3n ORDA al servidor y activa el evento."]}),"\n",(0,r.jsxs)(n.li,{children:["con el servidor REST: el valor es recibido en el servidor REST con una ",(0,r.jsx)(n.a,{href:"/docs/es/REST/method#methodupdate",children:"petici\xf3n REST"})," (",(0,r.jsx)(n.code,{children:"$method=update"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsxs)(n.p,{children:["Si esta funci\xf3n ",(0,r.jsx)(n.a,{href:"../commands/throw",children:"genera"})," un error, no detendr\xe1 la acci\xf3n en curso."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"Este evento tambi\xe9n se activa:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["cuando los atributos son asignados por el evento ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#class-constructor-1",children:(0,r.jsx)(n.code,{children:"constructor()"})}),","]}),"\n",(0,r.jsxs)(n.li,{children:["cuando los atributos son editados a trav\xe9s del ",(0,r.jsx)(n.a,{href:"/docs/es/Admin/dataExplorer",children:"Explorador de datos"}),"."]}),"\n"]})]}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,r.jsx)(n.p,{children:"Quiere en may\xfasculas todos los atributos de texto de una entidad cuando se actualiza."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //ProductsEntity class\nFunction event touched($event : Object)\n	\n	If (Value type(This[$event.attributeName])=Is text)\n		This[$event.attributeName]:=Uppercase(This[$event.attributeName])\n	End if \n"})}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-2",children:"Ejemplo 2"}),"\n",(0,r.jsxs)(n.p,{children:['El evento "touched" es \xfatil cuando no es posible escribir c\xf3digo de consulta indexada en ',(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"Function query()"})})," para un ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#computed-attributes",children:"atributo calculado"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Este es el caso, por ejemplo, cuando tu funci\xf3n ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," tiene que comparar el valor de diferentes atributos de la misma entidad entre s\xed. Debe usar f\xf3rmulas en la consulta ORDA devuelta, que activa consultas secuenciales."]}),"\n",(0,r.jsx)(n.p,{children:"Para entender plenamente este caso, examinemos los siguientes dos atributos calculados:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function get onGoing() : Boolean\n        return ((This.departureDate<=Current date) & (This.arrivalDate>=Current date))\n\nFunction get sameDay() : Boolean\n        return (This.departureDate=This.arrivalDate)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Aunque son muy similares, estas funciones no pueden ser asociadas con consultas id\xe9nticas porque no comparan los mismos tipos de valores. La primera compara los atributos a un valor determinado, mientras que la segunda compara los atributos entre s\xed."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Para el atributo ",(0,r.jsx)(n.em,{children:"onGoing"}),", la funci\xf3n ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," es sencilla de escribir y utiliza atributos indexados:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query onGoing($event : Object) : Object\n    var $operator : Text\n    var $myQuery : Text\n    var $onGoingValue : Boolean\n    var $parameters : Collection\n    $parameters:=New collection()\n\n    $operator:=$event.operator\n    Case of \n            : (($operator="=") | ($operator="==") | ($operator="==="))\n                $onGoingValue:=Bool($event.value)\n            : (($operator="!=") | ($operator="!=="))\n                $onGoingValue:=Not(Bool($event.value))\n            Else \n                return {query: ""; parameters: $parameters}\n    End case \n\n    $myQuery:=($onGoingValue) ? "departureDate <= :1 AND arrivalDate >= :1" : "departureDate > :1 OR arrivalDate < :1"\n        // la cadena de consulta ORDA utiliza atributos indexados, se indexar\xe1\n    $parameters.push(Current date)\n    return {query: $myQuery; parameters: $parameters}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Para el atributo ",(0,r.jsx)(n.em,{children:"sameDay"}),", la funci\xf3n ",(0,r.jsx)(n.a,{href:"/docs/es/ORDA/ordaClasses#function-query-attributename",children:(0,r.jsx)(n.code,{children:"query"})})," requiere una consulta ORDA basada en f\xf3rmulas y ser\xe1 secuencial:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function query sameDay($event : Object) : Text\n    var $operator : Text\n    var $sameDayValue : Boolean\n\n    $operator:=$event.operator\n    Case of \n        : (($operator="=") | ($operator="==") | ($operator="==="))\n            $sameDayValue:=Bool($event.value)\n        : (($operator="!=") | ($operator="!=="))\n            $sameDayValue:=Not(Bool($event.value))\n        Else \n            return ""\n        End case \n\n    return ($sameDayValue) ? "eval(This.departureDate = This.arrivalDate)" : "eval(This.departureDate != This.arrivalDate)"\n        // la cadena de consulta ORDA utiliza una f\xf3rmula, no ser\xe1 indexada\n\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Using a ",(0,r.jsx)(n.strong,{children:"scalar"})," ",(0,r.jsx)(n.em,{children:"sameDay"}),' attribute updated when other attributes are "touched" will save time:']}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"    //BookingEntity class\n\nFunction event touched departureDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate) \n//\n//\nFunction event touched arrivalDate($event : Object) \n\n    This.sameDay:=(This.departureDate = This.arrivalDate)\n\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"ejemplo-3-diagrama-clienteservidor-con-la-palabra-clave-local",children:["Ejemplo 3 (diagrama): cliente/servidor con la palabra clave ",(0,r.jsx)(n.code,{children:"local"}),":"]}),"\n",(0,r.jsx)(n.mermaid,{value:'\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:="Brown"\n   Note over Client: local Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\nNote over Client:$people.lastname is uppercased\n\n    Client->>+Server: $people.apply()\n   \n   Note over Server: The $people entity is received with the lastname attribute uppercased\n'}),"\n",(0,r.jsxs)(n.h4,{id:"ejemplo-4-diagrama-clienteservidor-sin-la-palabra-clave-local",children:["Ejemplo 4 (diagrama): cliente/servidor sin la palabra clave ",(0,r.jsx)(n.code,{children:"local"})]}),"\n",(0,r.jsx)(n.mermaid,{value:'\nsequenceDiagram\n\n    Client->>+Server: $people:=ds.People.all().first()\n\n    Client->>+Client: $people.lastname:="Brown"\n\n   Note over Client:$people.lastname is not uppercased\n\n    Client->>+Server: $people.apply()\n\n   Note over Server: Function event touched lastname($event : Object) <br>  This.lastname:=Uppercase(This.lastname)\n\n    Server--\x3e>-Client: The $people entity is updated\n\n   Note over Client:$people.lastname is uppercased\n\n'}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-5-diagrama-aplicaci\xf3n-qodly",children:"Ejemplo 5 (diagrama): Aplicaci\xf3n Qodly"}),"\n",(0,r.jsx)(n.mermaid,{value:"\nsequenceDiagram\n\nQodly page->>+ Server: Get an entity into the People Qodly source\n\nQodly page->>+Qodly page: The user updates People.lastname\n\nNote over Qodly page: The People Qodly source lastname attribute is not uppercased\n\nQodly page->>+ Server: Function call People.apply()\n\nNote over Server: Function event touched lastname($event : Object) <br> This.lastname:=Uppercase(This.lastname)\n\nServer--\x3e>-Qodly page: The People Qodly source is updated\nNote over Qodly page: The People Qodly source lastname attribute is uppercased\n\n"}),"\n",(0,r.jsx)(n.h3,{id:"function-event-validatesave",children:(0,r.jsx)(n.code,{children:"Function event validateSave"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-1",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event validateSave($event : Object)\nFunction event validateSave <attributeName>($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa cada vez que una entidad est\xe1 a punto de ser guardada."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"si define la funci\xf3n a nivel de entidad (primera sintaxis), se llama para cualquier atributo de la entidad."}),"\n",(0,r.jsxs)(n.li,{children:["si defini\xf3 la funci\xf3n en el nivel de atributo (segunda sintaxis), s\xf3lo se llama para este atributo. Esta funci\xf3n ",(0,r.jsx)(n.strong,{children:"no"})," se ejecuta si el atributo no ha sido tocado en la entidad."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsx)(n.p,{children:"Este evento es activado por las siguientes funciones:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"entity.save()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"dataClass.fromCollection()"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This event is triggered ",(0,r.jsx)(n.strong,{children:"before"}),' the entity is actually saved and lets you check data consistency so that you can stop the action if needed. Por ejemplo, puede comprobar en este evento que "fecha de salida" < "fecha de llegada".']}),"\n",(0,r.jsxs)(n.p,{children:["To stop the action, the code of the function must return an ",(0,r.jsx)(n.a,{href:"#error-object",children:"error object"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["No se recomienda actualizar la entidad dentro de esta funci\xf3n (utilizando ",(0,r.jsx)(n.code,{children:"This"}),")."]})}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo",children:"Ejemplo"}),"\n",(0,r.jsx)(n.p,{children:"En este ejemplo, no se permite guardar un producto con un margen inferior al 50%. In case of an invalid price attribute, you return an error object and thus, stop the save action."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// ProductsEntity class\n//\n// validateSave event at attribute level\nFunction event validateSave margin($event : Object) : Object\n	\nvar $result : Object\n	\n//The user can\'t create a product whose margin is < 50%\nIf (This.margin<50)\n	$result:={errCode: 1; message: "The validation of this product failed"; \\\n	extraDescription: {info: "The margin of this product ("+String(This.margin)+") is lower than 50%"}; seriousError: False}\nEnd if \nreturn $result\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-saving",children:(0,r.jsx)(n.code,{children:"Function event saving"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-2",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event saving($event : Object)\nFunction event saving <attributeName>($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa cada vez que se guarda una entidad."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si define la funci\xf3n a nivel de entidad (primera Sintaxis), se llama para cualquier atributo de la entidad. The function is executed even if no attribute has been touched in the entity (e.g. in case of sending data to an external app each time a save is done)."}),"\n",(0,r.jsxs)(n.li,{children:["If you defined the function at the attribute level (second syntax), it is called only for this attribute. La funci\xf3n ",(0,r.jsx)(n.strong,{children:"no"})," se ejecuta si el atributo no ha sido tocado en la entidad."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsx)(n.p,{children:"Este evento es activado por las siguientes funciones:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"entity.save()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"dataClass.fromCollection()"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Este evento se activa ",(0,r.jsx)(n.strong,{children:"mientras"})," la entidad se guarda. If a ",(0,r.jsx)(n.a,{href:"#function-event-validatesave",children:(0,r.jsx)(n.code,{children:"validateSave()"})})," event function was defined, the ",(0,r.jsx)(n.code,{children:"saving()"})," event function is called if no error was triggered by ",(0,r.jsx)(n.code,{children:"validateSave()"}),". Por ejemplo, puede utilizar este evento para crear un documento en una cuenta de Google Drive."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The business logic should raise errors which can't be detected during the ",(0,r.jsx)(n.code,{children:"validateSave()"})," events, e.g. a network error"]})}),"\n",(0,r.jsx)(n.p,{children:"Durante la acci\xf3n de guardar, se pueden producir errores en el motor 4D (\xedndice, sello ha cambiado, no hay suficiente espacio en el disco)."}),"\n",(0,r.jsxs)(n.p,{children:["To stop the action, the code of the function must return an ",(0,r.jsx)(n.a,{href:"#error-object",children:"error object"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-3",children:"Ejemplo"}),"\n",(0,r.jsx)(n.p,{children:"Cuando se guarda un archivo en el disco, por ejemplo, se capturan errores relacionados con el espacio de disco."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// ProductsEntity class\n// saving event at attribute level\nFunction event saving userManualPath($event : Object) : Object\n	\nvar $result : Object\nvar $userManualFile : 4D.File\nvar $fileCreated : Boolean\n	\nIf (This.userManualPath#"")\n	$userManualFile:=File(This.userManualPath)\n				\n	// The user manual document file is created on the disk\n	// This may fail if no more space is available\n	Try\n		$fileCreated:=$userManualFile.create() \n	Catch\n		// No more room on disk for example\n		$result:={/\n            errCode: 1; message: "Error during the save action for this product"; /\n            extraDescription: {info: "There is no available space on disk to store the user manual"}/\n        }\n	End try\nEnd if \n	\nreturn $result\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-aftersave",children:(0,r.jsx)(n.code,{children:"Function event afterSave"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-3",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Funci\xf3n evento afterSave($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"This event is triggered just after an entity is saved in the data file, when at least one attribute was modified. No se ejecuta si no se ha tocado ning\xfan atributo en la entidad."}),"\n",(0,r.jsx)(n.p,{children:"This event is useful after saving data to propagate the save action outside the application or to execute administration tasks. Por ejemplo, se puede utilizar para enviar un correo electr\xf3nico de confirmaci\xf3n despu\xe9s de guardar los datos. O, en caso de error al guardar los datos, puede hacer una cancelaci\xf3n para restaurar un estado consistente de los datos."}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["To avoid infinite loops, calling a ",(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#save",children:(0,r.jsx)(n.code,{children:"save()"})})," on the current entity (through ",(0,r.jsx)(n.code,{children:"This"}),") in this function is ",(0,r.jsx)(n.strong,{children:"not allowed"}),". Se producir\xe1 un error."]}),"\n",(0,r.jsxs)(n.li,{children:["Arrojar un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objeto error"})," ",(0,r.jsx)(n.strong,{children:"no es soportado"})," por esta funci\xf3n."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-4",children:"Ejemplo"}),"\n",(0,r.jsxs)(n.p,{children:["If an error occurred in the above saving event, the attribute value is reset accordingly in the ",(0,r.jsx)(n.code,{children:"afterSave"})," event:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// ProductsEntity class\nFunction event afterSave($event : Object)\n	\nIf (($event.status.success=False) && ($event.status.errors=Null))  \n    // $event.status.errors is filled if the error comes from the validateSave event\n		\n	// The userManualPath attribute has not been properly saved\n	// Its value is reset\n	If ($event.savedAttributes.indexOf("userManualPath")=-1)\n		This.userManualPath:=""\n		This.status:="KO"\n	End if \n		\nEnd if \n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-validatedrop",children:(0,r.jsx)(n.code,{children:"Function event validateDrop"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-4",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event validateDrop($event : Object)\nFunction event validateDrop <attributeName>($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa cada vez que una entidad est\xe1 a punto de ser soltada."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si define la funci\xf3n a nivel de entidad (primera Sintaxis), se llama para cualquier atributo de la entidad."}),"\n",(0,r.jsx)(n.li,{children:"If you defined the function at the attribute level (second syntax), it is called only for this attribute."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa con las siguientes funcionalidades:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"entity.drop()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"entitySelection.drop()"})})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://doc.4d.com/4Dv20/4D/20.2/Relation-properties.300-6750290.en.html#107320",children:"deletion control rules"})," that can be defined at the database structure level."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This event is triggered ",(0,r.jsx)(n.strong,{children:"before"})," the entity is actually dropped, allowing you to check data consistency and if necessary, to stop the drop action."]}),"\n",(0,r.jsxs)(n.p,{children:["To stop the action, the code of the function must return an ",(0,r.jsx)(n.a,{href:"#error-object",children:"error object"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-5",children:"Ejemplo"}),"\n",(0,r.jsx)(n.p,{children:'En este ejemplo, no est\xe1 permitido eliminar un producto que no est\xe9 etiquetado como "TO DELETE". In this case, you return an error object and thus, stop the drop action.'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// Clase ProductsEntity\n\nFunction event validateDrop status($event : Object) : Object\n\nvar $result : Object\n\n// Products must be marked as TO DELETE to be dropped\nIf (This.status#"TO DELETE")\n    $result:={errCode: 1; message: "You can\'t drop this product"; \\\n    extraDescription: {info: "This product must be marked as To Delete"}; seriousError: False}\nEnd if \n\nreturn $result\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-dropping",children:(0,r.jsx)(n.code,{children:"Function event dropping"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-5",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event dropping($event : Object)\nFunction event dropping <attributeName>($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa cada vez que se elimina una entidad."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si define la funci\xf3n a nivel de entidad (primera Sintaxis), se llama para cualquier atributo de la entidad."}),"\n",(0,r.jsx)(n.li,{children:"If you defined the function at the attribute level (second syntax), it is called only for this attribute."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa con las siguientes funcionalidades:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"entity.drop()"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/DataClassClass#fromcollection",children:(0,r.jsx)(n.code,{children:"entitySelection.drop()"})})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://doc.4d.com/4Dv20/4D/20.2/Relation-properties.300-6750290.en.html#107320",children:"deletion control rules"})," that can be defined at the database structure level."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This event is triggered ",(0,r.jsx)(n.strong,{children:"while"})," the entity is actually dropped. If a ",(0,r.jsx)(n.a,{href:"#function-event-validatedrop",children:(0,r.jsx)(n.code,{children:"validateDrop()"})})," event function was defined, the ",(0,r.jsx)(n.code,{children:"dropping()"})," event function is called if no error was triggered by ",(0,r.jsx)(n.code,{children:"validateDrop()"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The business logic should raise errors which cannot be detected during the ",(0,r.jsx)(n.code,{children:"validateDrop()"})," events, e.g. a network error."]})}),"\n",(0,r.jsxs)(n.p,{children:["To stop the action, the code of the function must return an ",(0,r.jsx)(n.a,{href:"#error-object",children:"error object"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-6",children:"Ejemplo"}),"\n",(0,r.jsxs)(n.p,{children:["Estes es un ejemplo del evento ",(0,r.jsx)(n.code,{children:"dropping"})," a nivel de entidad:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// ProductsEntity class\nFunction event dropping($event : Object) : Object\n\nvar $result : Object\nvar $userManualFile : 4D.File\n\n$userManualFile:=File(This.userManualPath)\n\n    // When dropping a product, its user manual is also deleted on the disk\n    // This action may fail\nTry\n    If ($userManualFile.exists)\n        $userManualFile.delete()\n    End if \nCatch\n    // Dropping the user manual failed\n    $result:={errCode: 1; message: "Drop failed"; extraDescription: {info: "The user manual can\'t be dropped"}}\nEnd try\n\nreturn $result\n'})}),"\n",(0,r.jsx)(n.h3,{id:"function-event-afterdrop",children:(0,r.jsx)(n.code,{children:"Function event afterDrop"})}),"\n",(0,r.jsx)(n.h4,{id:"sintaxis-6",children:"Sintaxis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"Function event afterDrop($event : Object)\n// c\xf3digo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Este evento se activa justo despu\xe9s de que una entidad es soltada."}),"\n",(0,r.jsx)(n.p,{children:"This event is useful after dropping data to propagate the drop action outside the application or to execute administration tasks. Por ejemplo, se puede utilizar para enviar un correo electr\xf3nico de cancelaci\xf3n despu\xe9s de soltar los datos. Or, in case of error while dropping data, it can log an information for the administrator to check data consistency."}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n recibe un ",(0,r.jsxs)(n.a,{href:"#event-parameter",children:["objeto ",(0,r.jsx)(n.em,{children:"event"})]})," como par\xe1metro."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["To avoid infinite loops, calling a ",(0,r.jsx)(n.a,{href:"/docs/es/API/EntityClass#drop",children:(0,r.jsx)(n.code,{children:"drop()"})})," on the current entity (through ",(0,r.jsx)(n.code,{children:"This"}),") in this function is ",(0,r.jsx)(n.strong,{children:"not allowed"}),". Se producir\xe1 un error."]}),"\n",(0,r.jsxs)(n.li,{children:["Arrojar un ",(0,r.jsx)(n.a,{href:"#error-object",children:"objeto error"})," ",(0,r.jsx)(n.strong,{children:"no es soportado"})," por esta funci\xf3n."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["La entidad eliminada es referenciada por ",(0,r.jsx)(n.code,{children:"This"})," y a\xfan existe en memoria."]})}),"\n",(0,r.jsx)(n.h4,{id:"ejemplo-7",children:"Ejemplo"}),"\n",(0,r.jsx)(n.p,{children:"Si la acci\xf3n de soltar fall\xf3, el producto debe ser verificado manualmente:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'Function event afterDrop($event : Object)\n\nvar $status : Object\n\nIf (($event.status.success=False) && ($event.status.errors=Null)) \n        //$event.status.errors is filled \n        //if the error comes from the validateDrop event\n    This.status:="Check this product - Drop action failed"\n    $status:=This.save()\nEnd if \n\n'})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},884429:function(e,n,t){t.d(n,{R:()=>a,x:()=>l});var s=t(296540);let r={},i=s.createContext(r);function a(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);