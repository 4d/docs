"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["39331"],{351271:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>r,toc:()=>c,default:()=>h,metadata:()=>i,assets:()=>d,contentTitle:()=>l});var i=JSON.parse('{"id":"WebServer/http-request-handler","title":"HTTP Request handler","description":"Por defecto, las peticiones HTTP recibidas por el servidor web 4D se gestionan a trav\xe9s de funciones de procesamiento integradas o del servidor REST.","source":"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R10/WebServer/http-request-handler.md","sourceDirName":"WebServer","slug":"/WebServer/http-request-handler","permalink":"/docs/es/20-R10/WebServer/http-request-handler","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WebServer%2Fhttp-request-handler.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"http-request-handler","title":"HTTP Request handler"},"sidebar":"docs","previous":{"title":"Procesamiento de peticiones HTTP","permalink":"/docs/es/20-R10/WebServer/httpRequests"},"next":{"title":"Permitir m\xe9todos proyecto","permalink":"/docs/es/20-R10/WebServer/allowProject"}}'),a=s(474848),o=s(884429);let r={id:"http-request-handler",title:"HTTP Request handler"},l,d={},c=[{value:"Requisitos",id:"requisitos",level:2},{value:"Archivo HTTPHandlers.json",id:"archivo-httphandlersjson",level:2},{value:"Definici\xf3n del gestor",id:"definici\xf3n-del-gestor",level:2},{value:"Patrones de la URL",id:"patrones-de-la-url",level:3},{value:"Correspondencia de modelos",id:"correspondencia-de-modelos",level:4},{value:"Patrones prohibidos",id:"patrones-prohibidos",level:4},{value:"Clase y m\xe9todo",id:"clase-y-m\xe9todo",level:3},{value:"Verbs",id:"verbs",level:3},{value:"Ejemplo",id:"ejemplo",level:2},{value:"C\xf3digo del gestor de peticiones",id:"c\xf3digo-del-gestor-de-peticiones",level:2},{value:"Configuraci\xf3n de funciones",id:"configuraci\xf3n-de-funciones",level:3},{value:"Entrada: una instancia de la clase 4D.IncomingMessage",id:"entrada-una-instancia-de-la-clase-4dincomingmessage",level:3},{value:"Salida: una instancia de la clase 4D.OutgoingMessage",id:"salida-una-instancia-de-la-clase-4doutgoingmessage",level:3},{value:"Ejemplo",id:"ejemplo-1",level:3},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:2}];function t(e){let n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["Por defecto, las peticiones HTTP recibidas por el servidor web 4D se gestionan a trav\xe9s de ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/WebServer/httpRequests",children:"funciones de procesamiento integradas"})," o del ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/REST/REST_requests",children:"servidor REST"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Adem\xe1s, 4D soporta la implementaci\xf3n de ",(0,a.jsx)(n.strong,{children:"gestores de peticiones HTTP personalizadas"}),", permiti\xe9ndole interceptar peticiones HTTP entrantes espec\xedficas y procesarlas utilizando su propio c\xf3digo."]}),"\n",(0,a.jsxs)(n.p,{children:["Cuando un manejador de peticiones HTTP personalizado intercepta una solicitud, se procesa directamente y no hay otras funcionalidades de procesamiento (por ejemplo, son llamados m\xe9todos base ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/WebServer/authentication#on-web-authentication",children:"On Web authentication"})," o ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/WebServer/httpRequests#on-web-connection",children:"On Web connection"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Los gestores de peticiones HTTP personalizados satisfacen diversas necesidades, entre ellas:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"la utilizaci\xf3n de una URL dedicada como proveedor de recursos o como cuadro de carga de archivos (para descargar o cargar varios archivos),"}),"\n",(0,a.jsx)(n.li,{children:"la redirecci\xf3n en p\xe1ginas espec\xedficas en funci\xf3n de un contexto (usuario autentificado, privilegios otorgados...),"}),"\n",(0,a.jsx)(n.li,{children:"gestionar una autenticaci\xf3n a trav\xe9s de oAuth 2.0."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"requisitos",children:"Requisitos"}),"\n",(0,a.jsx)(n.p,{children:"Se soportan gestores de solicitudes HTTP personalizados:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["cuando las ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/WebServer/sessions#enabling-web-sessions",children:"sesiones escalables"})," est\xe1n habilitadas,"]}),"\n",(0,a.jsxs)(n.li,{children:["with the main Web Server only (HTTP Request handlers that may have been defined in ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/WebServer/webServerObject",children:"Web Servers of components"})," are ignored)."]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/es/20-R10/ORDA/privileges#default-file",children:"Por defecto"})," por razones de seguridad, el acceso externo al datastore no est\xe1 permitido en 4D. Necesita configurar los ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/ORDA/privileges",children:"privilegios ORDA"})," para permitir peticiones HTTP."]})}),"\n",(0,a.jsx)(n.h2,{id:"archivo-httphandlersjson",children:"Archivo HTTPHandlers.json"}),"\n",(0,a.jsxs)(n.p,{children:["Define sus manejadores de petici\xf3n HTTP personalizados en un archivo de configuraci\xf3n llamado ",(0,a.jsx)(n.strong,{children:"HTTPHandlers.json"})," almacenado en la carpeta ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Project/architecture#sources",children:(0,a.jsx)(n.code,{children:"Project/Sources"})}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Este archivo contiene todos los patrones de URL a interceptar, los verbos manipulados y el c\xf3digo a llamar. Los administradores se proporcionan en forma de colecci\xf3n en formato JSON."}),"\n",(0,a.jsx)(n.p,{children:"Al momento de la ejecuci\xf3n, se ejecuta el primer patr\xf3n que coincida con la URL, los dem\xe1s se ignoran."}),"\n",(0,a.jsxs)(n.p,{children:["Este es un ejemplo del contenido de un archivo ",(0,a.jsx)(n.em,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'\n[\n    {\n        "class": "GeneralHandling",\n        "method": "gettingStarted",\n        "pattern": "start",\n        "verbs": "get, post"\n    }\n]\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Esta declaraci\xf3n de handler puede leerse como: cuando cualquier petici\xf3n que comience por ",(0,a.jsx)(n.code,{children:"/start/"})," con un verbo ",(0,a.jsx)(n.code,{children:"GET"})," o ",(0,a.jsx)(n.code,{children:"POST"})," es recibida por el servidor, se ejecuta la funci\xf3n ",(0,a.jsx)(n.code,{children:"gettingStarted"})," del singleton ",(0,a.jsx)(n.code,{children:"GeneralHandling"}),"."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"Debe reiniciar el servidor Web para que se tengan en cuenta las modificaciones realizadas en este archivo."})}),"\n",(0,a.jsx)(n.h2,{id:"definici\xf3n-del-gestor",children:"Definici\xf3n del gestor"}),"\n",(0,a.jsx)(n.p,{children:"Un manejador est\xe1 definido por:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"un patr\xf3n de URL a interceptar"}),"\n",(0,a.jsx)(n.li,{children:"una funci\xf3n y su clase donde se implementa el c\xf3digo para manejar el patr\xf3n URL escuchado"}),"\n",(0,a.jsx)(n.li,{children:"los verbos con los que se puede llamar a la URL para activar el gestor"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"El identificador del gestor es la pareja [patr\xf3n + un verbo de la lista de verbos]."}),"\n",(0,a.jsx)(n.h3,{id:"patrones-de-la-url",children:"Patrones de la URL"}),"\n",(0,a.jsxs)(n.p,{children:["Los patrones de URL pueden indicarse como ",(0,a.jsx)(n.strong,{children:"prefijos"})," o utilizando ",(0,a.jsx)(n.strong,{children:"expresiones regulares"}),"."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:['Para declarar un patr\xf3n de prefijo, utilice el nombre de propiedad "pattern" en el archivo HTTPHandlers.json. Los prefijos son considerados como expresiones regulares que ya contienen un ',(0,a.jsx)(n.code,{children:"/"})," inicial y final.",(0,a.jsx)(n.br,{}),"\nEj: ",(0,a.jsx)(n.code,{children:'"pattern": "docs"'})," o ",(0,a.jsx)(n.code,{children:'"pattern": "docs/invoices"'})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:['Para declarar un patr\xf3n de expresi\xf3n regular, utilice el nombre de propiedad "regexPattern" en el archivo HTTPHandlers.json. Los modelos de expresiones regulares se manejan directamente.\nEj: ',(0,a.jsx)(n.code,{children:'"regexPattern" : "/docs/.+/index\\.html"'})]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:'Las propiedades "Pattern" y "regexPattern" no pueden utilizarse en la misma definici\xf3n de gestor (en este caso, s\xf3lo se tiene en cuenta la propiedad "regexPattern").'}),"\n",(0,a.jsx)(n.h4,{id:"correspondencia-de-modelos",children:"Correspondencia de modelos"}),"\n",(0,a.jsx)(n.p,{children:"Los modelos de URL se activan en el orden indicado:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"se ejecuta el primer modelo coincidente"}),"\n",(0,a.jsx)(n.li,{children:"los siguientes patrones no se ejecutan aunque coincidan con la URL"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"En consecuencia, debe aplicar una estrategia precisa al escribir sus gestores: los patrones m\xe1s detallados deben escribirse antes que los patrones m\xe1s generales."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleTheInvoice",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoiceslHandling",\n        "method": "handleUnauthorizedVerbs",\n        "regexPattern": "/docs/invoices/details/theInvoice",\n        "comment": "This handler is triggered for all verbs except GET (handled above)"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs",\n        "comment": "This handler is triggered for all the verbs"\n    }\n]\n\n'})}),"\n",(0,a.jsx)(n.h4,{id:"patrones-prohibidos",children:"Patrones prohibidos"}),"\n",(0,a.jsx)(n.p,{children:"Los patrones URL que coincidan con las funciones de procesamiento HTTP integradas en 4D no est\xe1n permitidos en los gestores HTTP personalizados. Por ejemplo, los siguientes modelos no pueden ser manejados:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"/4DACTION"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"/rest"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"/$lib/renderer"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"/$shared"})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"clase-y-m\xe9todo",children:"Clase y m\xe9todo"}),"\n",(0,a.jsx)(n.p,{children:'Declare el c\xf3digo a ejecutar cuando se intercepte un patr\xf3n de URL definido utilizando las propiedades "class" y "method".'}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:['"class": nombre de la clase sin ',(0,a.jsx)(n.code,{children:"cs."}),', por ejemplo, "UsersHandling" para la clase usuario ',(0,a.jsx)(n.code,{children:"cs.UsersHandling"}),". Debe ser una clase ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Concepts/classes#shared-singleton",children:(0,a.jsx)(n.strong,{children:"compartida"})})," y ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Concepts/classes#singleton-classes",children:(0,a.jsx)(n.strong,{children:"singleton"})}),"."]}),"\n",(0,a.jsx)(n.li,{children:'"method": funci\xf3n de clase perteneciente a la clase.'}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"#request-handler-code",children:"Ver abajo"})," para obtener informaci\xf3n sobre el c\xf3digo del gestor de peticiones."]}),"\n",(0,a.jsx)(n.h3,{id:"verbs",children:"Verbs"}),"\n",(0,a.jsx)(n.p,{children:'Puede utilizar la propiedad "verbs" en la definici\xf3n del manejador para declarar los verbos HTTP que se admiten en las peticiones entrantes para este manejador. Una solicitud que utiliza un verbo no permitido expl\xedcitamente es rechazada autom\xe1ticamente por el servidor.'}),"\n",(0,a.jsx)(n.p,{children:"Puede declarar varios verbos, separados por una coma. Los nombres de verbos no distinguen entre may\xfasculas y min\xfasculas."}),"\n",(0,a.jsxs)(n.p,{children:["Ej: ",(0,a.jsx)(n.code,{children:'"verbs" : "PUT, POST"'})]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"No se hace ning\xfan control sobre los nombres de los verbos. Se pueden utilizar todos los nombres."})}),"\n",(0,a.jsxs)(n.p,{children:['Por defecto, si la propiedad "verbs" no se utiliza para un manejador, ',(0,a.jsx)(n.strong,{children:"todos"})," los verbos HTTP son soportados en las peticiones entrantes para este manejador (excepto aquellos posiblemente utilizados de antemano en un patr\xf3n m\xe1s detallado, como se muestra en el ejemplo anterior)."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["El verbo HTTP tambi\xe9n puede ser evaluado ",(0,a.jsxs)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass#verb",children:["utilizando la propiedad ",(0,a.jsx)(n.code,{children:".verb"})," dentro del c\xf3digo del manejador de peticiones"]})," para ser aceptado o rechazado."]})}),"\n",(0,a.jsx)(n.h2,{id:"ejemplo",children:"Ejemplo"}),"\n",(0,a.jsx)(n.p,{children:"He aqu\xed un ejemplo detallado de un archivo HTTPHandlers.json:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'\n[\n   {\n        "clase": "GeneralHandling",\n        "method": "handle",\n        "pattern": "info", //prefijo URL \n        "verbs": "GET"\n    }, \n    {\n        "class": "UsersHandling",\n        "method": "manageAccount",\n        "pattern": "userAccount/update", //prefijo URL\n        "verbs": "PUT,POST"\n    }, \n    {\n        "class": "FinancialHandling",\n        "method": "handleInvoices",\n        "regexPattern": "/docs/invoices/(past|today)", //prefijo de URL dado como regex\n        "verbs": "GET"\n    },\n    {\n        "class": "DocsHandling",\n        "method": "handleDocs",\n        "regexPattern": "/docs/myPage.html", //prefijo de URL dado como regex\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleTheInvoice",\n                "pattern": "docs/invoices/details/theInvoice", // La URL m\xe1s espec\xedfica primero\n        "verbs": "GET,POST"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleDetails",\n            "pattern": "docs/invoices/details",  // Las URL generales despu\xe9s de\n        "verbs": "GET"\n    },\n    {\n        "class": "InvoicesHandling",\n        "method": "handleInvoices", // Las URL generales despu\xe9s de\n        "pattern": "docs/invoices",\n        "verbs": "GET"\n    }\n]\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"En este ejemplo, debe implementar las siguientes funciones:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"funci\xf3nhandle"})," en la clase *GeneralHandling"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"manageAccount"})," en la clase ",(0,a.jsx)(n.em,{children:"UsersHandling"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"handleInvoices"})," en la clase ",(0,a.jsx)(n.em,{children:"FinancialHandling"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"handleDocs"})," en la clase ",(0,a.jsx)(n.em,{children:"DocsHandling"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"handleTheInvoice"})," / ",(0,a.jsx)(n.em,{children:"handleDetails"})," / ",(0,a.jsx)(n.em,{children:"handleInvoices"})," en la clase ",(0,a.jsx)(n.em,{children:"InvoicesHandling"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplos de URL que activan los gestores personalizados:"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"IP:port/info/"})," con un verbo GET\n",(0,a.jsx)(n.code,{children:"IP:port/info/general"})," con un verbo GET"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"IP:port/userAccount/update/"})," con un verbo POST\n",(0,a.jsx)(n.code,{children:"IP:port/userAccount/update/profile"})," con un verbo POST"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"IP:port/docs/invoices/past"})," con un verbo GET\n",(0,a.jsx)(n.code,{children:"IP:port/docs/invoices/today/latest"})," con un verbo GET"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"IP:port//docs/myPage.html"})," con un verbo GET"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"IP:port//docs/invoices/"})," con un verbo GET, llama a la funci\xf3n ",(0,a.jsx)(n.em,{children:"handleInvoices"})," (clase ",(0,a.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,a.jsx)(n.code,{children:"IP:port//docs/invoices/details/"})," con un verbo GET, llama a la funci\xf3n ",(0,a.jsx)(n.em,{children:"handleDetails"})," (clase ",(0,a.jsx)(n.em,{children:"InvoicesHandling"}),")\n",(0,a.jsx)(n.code,{children:"IP:port//docs/invoices/details/theInvoice/xxxxxx"})," con un verbo GET, llama a la funci\xf3n ",(0,a.jsx)(n.em,{children:"handleTheInvoice"})," (clase ",(0,a.jsx)(n.em,{children:"InvoiceslHandling"}),")"]}),"\n",(0,a.jsx)(n.h2,{id:"c\xf3digo-del-gestor-de-peticiones",children:"C\xf3digo del gestor de peticiones"}),"\n",(0,a.jsx)(n.h3,{id:"configuraci\xf3n-de-funciones",children:"Configuraci\xf3n de funciones"}),"\n",(0,a.jsxs)(n.p,{children:["El c\xf3digo del gestor de peticiones HTTP debe implementarse en una funci\xf3n de una clase ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Concepts/classes#shared-singleton",children:(0,a.jsx)(n.strong,{children:"Compartida"})})," ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Concepts/classes#singleton-classes",children:(0,a.jsx)(n.strong,{children:"clase singleton"})}),"."]}),"\n",(0,a.jsxs)(n.p,{children:['Si el singleton no se encuentra o no est\xe1 compartido, el servidor devuelve un error "No se puede encontrar singleton". Si la clase o la funci\xf3n ',(0,a.jsx)(n.a,{href:"#handler-definition",children:"definida como manejador"}),' en el archivo HTTPHandlers.json no se encuentra, el servidor devuelve un error "No se puede encontrar la funci\xf3n singleton".']}),"\n",(0,a.jsxs)(n.p,{children:["Las funciones del gestor de peticiones no son necesariamente compartidas, a menos que algunas propiedades del gestor de peticiones sean actualizadas por las funciones. En este caso, necesita declarar sus funciones con la ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/Concepts/classes#shared-functions",children:"palabra clave 'shared'"}),"."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"no es recomendado"})," exponer las funciones del gestor de solicitudes a llamadas REST externas usando las palabras claves ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/ORDA/ordaClasses#exposed-vs-non-exposed-functions",children:(0,a.jsx)(n.code,{children:"exposed"})})," o ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/ORDA/ordaClasses#onhttpget-keyword",children:(0,a.jsx)(n.code,{children:"onHTTPGet"})}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"entrada-una-instancia-de-la-clase-4dincomingmessage",children:"Entrada: una instancia de la clase 4D.IncomingMessage"}),"\n",(0,a.jsxs)(n.p,{children:["Cuando una solicitud ha sido interceptada por el manejador, se recibe en el servidor como una instancia de la ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass",children:"clase 4D.IncomingMessage"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Toda la informaci\xf3n necesaria sobre la petici\xf3n est\xe1 disponible en este objeto, incluyendo la url de la petici\xf3n, el verbo, los encabezados y, si los hay, los par\xe1metros (puestos en la URL) y el cuerpo de la petici\xf3n."}),"\n",(0,a.jsx)(n.p,{children:"A continuaci\xf3n, el gestor de solicitudes puede utilizar esta informaci\xf3n para activar la l\xf3gica de negocio adecuada."}),"\n",(0,a.jsx)(n.h3,{id:"salida-una-instancia-de-la-clase-4doutgoingmessage",children:"Salida: una instancia de la clase 4D.OutgoingMessage"}),"\n",(0,a.jsxs)(n.p,{children:["El gestor de peticiones puede devolver una instancia de objeto de la clase ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/OutgoingMessageClass",children:"4D.OutGoingMessage"}),", es decir, alg\xfan contenido web completo listo para que un navegador lo maneje, como un contenido de archivo."]}),"\n",(0,a.jsx)(n.h3,{id:"ejemplo-1",children:"Ejemplo"}),"\n",(0,a.jsxs)(n.p,{children:["La ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass",children:"clase 4D.IncomingMessage"})," ofrece funciones para obtener los ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass#headers",children:"encabezados"})," y el ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass#gettext",children:"cuerpo"})," de la solicitud."]}),"\n",(0,a.jsx)(n.p,{children:"He aqu\xed un ejemplo sencillo para cargar un archivo en el servidor."}),"\n",(0,a.jsxs)(n.p,{children:["El archivo ",(0,a.jsx)(n.strong,{children:"HTTPHandlers.json"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "class": "UploadFile",\n        "method": "uploadFile",\n        "regexPattern": "/putFile",\n        "verbs": "POST"\n    }\n]\n'})}),"\n",(0,a.jsxs)(n.p,{children:["La URL llamada es: ",(0,a.jsx)(n.a,{href:"http://127.0.0.1:8044/putFile?fileName=testFile",children:"http://127.0.0.1:8044/putFile?fileName=testFile"})]}),"\n",(0,a.jsxs)(n.p,{children:["El contenido binario del archivo se coloca en el cuerpo de la petici\xf3n y se utiliza un verbo POST. El nombre del archivo se da como par\xe1metro (",(0,a.jsx)(n.em,{children:"fileName"}),") en la URL. Se recibe en el objeto ",(0,a.jsx)(n.a,{href:"/docs/es/20-R10/API/IncomingMessageClass#urlquery",children:(0,a.jsx)(n.code,{children:"urlQuery"})})," en la petici\xf3n."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:'    //UploadFile class\n\nshared singleton Class constructor()\n	\n	\nFunction uploadFile($request : 4D.IncomingMessage) : 4D.OutgoingMessage\n	\n	var $response:=4D.OutgoingMessage.new()\n	\n	var $body:="Not supported file"\n	var $fileName; $fileType : Text\n	var $file : 4D.File\n	var $picture : Picture\n	var $created : Boolean\n	\n	$fileName:=$request.urlQuery.fileName\n	$fileType:=$request.getHeader("Content-Type")\n	\n	Case of \n		: ($fileType="application/pdf")\n			$file:=File("/PACKAGE/Files/"+$fileName+".pdf")\n			$created:=$file.create()\n			$file.setContent($request.getBlob())\n			$body:="Upload OK - File size: "+String($file.size)\n			\n		: ($fileType="image/jpeg")\n			$file:=File("/PACKAGE/Files/"+$fileName+".jpg")\n			$picture:=$request.getPicture()\n			WRITE PICTURE FILE($file.platformPath; $picture)\n			$body:="Upload OK - Image size: "+String($file.size)\n			\n	End case \n	\n	$response.setBody($body)\n	$response.setHeader("Content-Type"; "text/plain")\n	\n	return $response\n\n'})}),"\n",(0,a.jsx)(n.h2,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://blog.4d.com/master-http-requests-with-4d-request-handlers/",children:"Maestr\xeda de las peticiones HTTP con los gestores de peticiones 4D"})," (entrada del blog)"]})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}},884429:function(e,n,s){s.d(n,{R:()=>r,x:()=>l});var i=s(296540);let a={},o=i.createContext(a);function r(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);