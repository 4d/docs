"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["41304"],{260273:function(e,n,r){r.r(n),r.d(n,{default:()=>m,frontMatter:()=>o,metadata:()=>s,assets:()=>t,toc:()=>i,contentTitle:()=>d});var s=JSON.parse('{"id":"WritePro/commands-legacy/wp-insert-formula","title":"WP INSERT FORMULA","description":"WP INSERT FORMULA ( objTarget ; formula ; modo {; actRango} )","source":"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R7/WritePro/commands-legacy/wp-insert-formula.md","sourceDirName":"WritePro/commands-legacy","slug":"/WritePro/commands/wp-insert-formula","permalink":"/docs/es/WritePro/commands/wp-insert-formula","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WritePro%2Fcommands-legacy%2Fwp-insert-formula.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"wp-insert-formula","title":"WP INSERT FORMULA","slug":"/WritePro/commands/wp-insert-formula","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"WP INSERT DOCUMENT","permalink":"/docs/es/WritePro/commands/wp-insert-document"},"next":{"title":"WP INSERT PICTURE","permalink":"/docs/es/WritePro/commands/wp-insert-picture"}}'),l=r("785893"),a=r("250065");let o={id:"wp-insert-formula",title:"WP INSERT FORMULA",slug:"/WritePro/commands/wp-insert-formula",displayed_sidebar:"docs"},d=void 0,t={},i=[{value:"Descripci\xf3n",id:"descripci\xf3n",level:4},{value:"Ejemplo 1",id:"ejemplo-1",level:4},{value:"Ejemplo 2",id:"ejemplo-2",level:4},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:4}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"WP INSERT FORMULA"})," ( ",(0,l.jsx)(n.em,{children:"objTarget"})," ; ",(0,l.jsx)(n.em,{children:"formula"})," ; ",(0,l.jsx)(n.em,{children:"modo"})," {; ",(0,l.jsx)(n.em,{children:"actRango"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Par\xe1metro"}),(0,l.jsx)(n.th,{children:"Tipo"}),(0,l.jsx)(n.th,{}),(0,l.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"objTarget"}),(0,l.jsx)(n.td,{children:"Object"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Rango o elemento o documento 4D Write Pro"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"formula"}),(0,l.jsx)(n.td,{children:"Object"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Objeto f\xf3rmula"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"modo"}),(0,l.jsx)(n.td,{children:"Number"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Modo de inserci\xf3n"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"actRango"}),(0,l.jsx)(n.td,{children:"Number"}),(0,l.jsx)(n.td,{children:"\u2192"}),(0,l.jsx)(n.td,{children:"Incluye o excluye el contenido insertado dentro del rango"})]})]})]}),"\n",(0,l.jsx)(n.h4,{id:"descripci\xf3n",children:"Descripci\xf3n"}),"\n",(0,l.jsxs)(n.p,{children:["El comando ",(0,l.jsx)(n.strong,{children:"WP INSERT FORMULA"})," inserta una ",(0,l.jsx)(n.em,{children:"formula"})," en ",(0,l.jsx)(n.em,{children:"objTarget"})," de acuerdo con el ",(0,l.jsx)(n.em,{children:"modo"})," de inserci\xf3n especificado."]}),"\n",(0,l.jsxs)(n.p,{children:["En el par\xe1metro ",(0,l.jsx)(n.em,{children:"objTarget"}),", puede pasar:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"un rango, o"}),"\n",(0,l.jsx)(n.li,{children:"un elemento (tabla / l\xednea / celda(s) / p\xe1rrafo / cuerpo / encabezado / pie de p\xe1gina / secci\xf3n / subsecci\xf3n / imagen en l\xednea), o"}),"\n",(0,l.jsx)(n.li,{children:"un documento 4D Write Pro."}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["En el par\xe1metro ",(0,l.jsx)(n.em,{children:"formula"}),", pase la f\xf3rmula 4D a evaluar. Puede pasar:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["o bien un ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula-objects",children:"objeto f\xf3rmula"})," creado por el comando ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula",children:(0,l.jsx)(n.strong,{children:"Formula"})})," o ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula-from-string",children:(0,l.jsx)(n.strong,{children:"Formula from string"})}),","]}),"\n",(0,l.jsx)(n.li,{children:"o un objeto que contenga dos propiedades:"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Propiedad"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Tipo"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"nombre"}),(0,l.jsx)(n.td,{children:"Cadena"}),(0,l.jsx)(n.td,{children:"Nombre a mostrar para la f\xf3rmula en el documento"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"f\xf3rmula"}),(0,l.jsx)(n.td,{children:"Objeto"}),(0,l.jsxs)(n.td,{children:["El ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula-objects",children:"objeto f\xf3rmula"})," creado por el comando ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula",children:(0,l.jsx)(n.strong,{children:"Formula"})})," o ",(0,l.jsx)(n.a,{href:"https://developer.4d.com/docs/API/FunctionClass#formula-from-string",children:(0,l.jsx)(n.strong,{children:"Formula from string"})})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["Cuando se utiliza un objeto con un ",(0,l.jsx)(n.em,{children:"nombre"})," de f\xf3rmula, este nombre se muestra en el documento en lugar de la referencia de f\xf3rmula cuando las f\xf3rmulas se muestran como referencia, y en el consejo de f\xf3rmula cuando se muestran como valor o s\xedmbolos. Si la propiedad ",(0,l.jsx)(n.em,{children:"nombre"})," contiene una cadena vac\xeda o se omite, se elimina del objeto y la f\xf3rmula se muestra por defecto. Para m\xe1s informaci\xf3n, consulte la p\xe1gina ",(0,l.jsx)(n.em,{children:"Gesti\xf3n de f\xf3rmulas"}),"."]}),(0,l.jsx)(n.td,{}),(0,l.jsx)(n.td,{})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["En el par\xe1metro ",(0,l.jsx)(n.em,{children:"modo"}),", pase una de las siguientes constantes para indicar el modo de inserci\xf3n que se utilizar\xe1:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Constante"}),(0,l.jsx)(n.th,{children:"Tipo"}),(0,l.jsx)(n.th,{children:"Valor"}),(0,l.jsx)(n.th,{children:"Comentario"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk append"}),(0,l.jsx)(n.td,{children:"Entero largo"}),(0,l.jsx)(n.td,{children:"2"}),(0,l.jsx)(n.td,{children:"Inserta contenidos al final del rango"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk prepend"}),(0,l.jsx)(n.td,{children:"Entero largo"}),(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"Insertar contenidos al principio del rango"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk replace"}),(0,l.jsx)(n.td,{children:"Entero largo"}),(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"Remplazar el contenido de la p\xe1gina"})]})]})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Si ",(0,l.jsx)(n.em,{children:"objTarget"})," es un rango, puede utilizar el par\xe1metro opcional ",(0,l.jsx)(n.em,{children:"actRango"})," para pasar una de las siguientes constantes para especificar si la ",(0,l.jsx)(n.em,{children:"formula"})," insertada se incluye o no en el rango resultante:"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Constante"}),(0,l.jsx)(n.th,{children:"Tipo"}),(0,l.jsx)(n.th,{children:"Valor"}),(0,l.jsx)(n.th,{children:"Comentario"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk exclude from range"}),(0,l.jsx)(n.td,{children:"Entero largo"}),(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"Contenidos insertados no incluidos en el rango actualizado"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"wk include in range"}),(0,l.jsx)(n.td,{children:"Entero largo"}),(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"Contenido insertado incluido en el rango actualizado (predeterminado)"})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["Si no pasa un par\xe1metro ",(0,l.jsx)(n.em,{children:"actRango"}),", de forma predeterminada la ",(0,l.jsx)(n.em,{children:"formula"})," insertada se incluye en el rango resultante."]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Si ",(0,l.jsx)(n.em,{children:"objTarget"})," no es un rango, se ignora ",(0,l.jsx)(n.em,{children:"actRango"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Nota:"})," tenga en cuenta que, cuando se llama, el objeto f\xf3rmula se eval\xfaa dentro del contexto de la base de datos o del componente que lo cre\xf3."]}),"\n",(0,l.jsx)(n.h4,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,l.jsx)(n.p,{children:"Para reemplazar todas las f\xf3rmulas de fecha actuales con cadenas formateadas:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'\xa0var $_formulas : Collection\n\xa0var $find;$newFormula : Object\n\xa0\n\xa0\xa0// define la f\xf3rmula a encontrar\n\xa0$find:=Formula(Current date)\n\xa0\n\xa0\xa0// define la f\xf3rmula de reemplazo\n\xa0$newFormula:=Formula(String(Current date;System date long))\n\xa0\n\xa0\xa0// busca todas las f\xf3rmulas en el documento\n\xa0$_formulas:=WP Get formulas(WriteProArea)\n\xa0\n\xa0\xa0// consulta la colecci\xf3n de WP Get formulas\n\xa0$_formulas:=$_formulas.query("formula.source =:1";$find.source)&NBSP;&NBSP;\n\xa0\n\xa0\xa0// luego reemplaza cada f\xf3rmula\n\xa0For each($formula;$_formulas)\n\xa0\xa0\xa0\xa0WP INSERT FORMULA($formula.range;$newFormula;wk replace)\n\xa0End for each\n'})}),"\n",(0,l.jsx)(n.h4,{id:"ejemplo-2",children:"Ejemplo 2"}),"\n",(0,l.jsx)(n.p,{children:"Desea utilizar un nombre de f\xf3rmula para el nombre del cliente:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//a\xf1ade algunos datos\n\xa0$data:=New object("customer";New object("lastname";"Smith";"firstname";"John"))\n\xa0WP SET DATA CONTEXT(WPArea;$data)\n\xa0\n\xa0\xa0//crea un objeto f\xf3rmula con un nombre\n\xa0$o:=New object\n\xa0$o.formula:=Formula(This.data.customer.firstname+" "+This.data.customer.lastname)\n\xa0$o.name:="Customer name"\n\xa0\n\xa0\xa0//inserta como texto\n\xa0$range:=WP Text range(WPArea;wk start text;wk end text)\n\xa0WP SET TEXT($range;"Dear ";wk append)\n\xa0WP INSERT FORMULA($range;$o;wk append)\n'})}),"\n",(0,l.jsx)(n.p,{children:"Resultado:"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:r(994348).Z+"",width:"119",height:"33"})}),"\n",(0,l.jsx)(n.h4,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.em,{children:"Gesti\xf3n de f\xf3rmulas"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/es/WritePro/commands/wp-compute-formulas",children:"WP COMPUTE FORMULAS"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/es/WritePro/commands/wp-freeze-formulas",children:"WP FREEZE FORMULAS"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.a,{href:"/docs/es/WritePro/commands/wp-get-formulas",children:"WP Get formulas"})]})]})}function m(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},994348:function(e,n,r){r.d(n,{Z:function(){return s}});let s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAAhCAIAAABsjKM3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJLSURBVGhD7ZbLbcMwDECzlE+eR3cDGSALeAOP4B16zBQ+d42UpEhKimNFdWKiSPmAJpJIffgsOD3dnONxyxa4ZQvcsgVu2QK3bIFbtsAtW+CWLXDLL3G5XLhV5VjL35/O6dQk0C2/xD7LXwPMK+inhWM74LPMgRcLM7Th42OAmrjUKuskEJ3MkvX9ouEc17EjuwTpbrN8HcN45fbf5T2WARQ9fHHnl0SvhdZGe/Bwuv9kOdNMNxtg6dKlPnX6Yejzu7+WHKE7jRbppscManbjDE9hplGEIvkLR+fGHFwjhvWZSDYmx9wQaGV5ZsUCcjqZlU1r2QI+uNQqDZaXqUeP8BXH7/swgbTjeDlz0zIdlA8NLcyIdxxV03i6y3PgRh6LJVNDvJTTMBSX5Uk5ukDanKdxP2VQY3uL91nGWwoa6bIKkoFmAbF8J7liWc+qhWFqytW4hBEudD1Xh2gRoczNeLAAAKM4i/qtWwBcapXnllkyfpNMBQOYKYFHlulMWgcxj3jWx4VSOo1rPA/DILbrCsrdUm7GegHZV/qtW7zHMprkbvZCWKZhWtR61TIerryi5ZmpPhzSSHxDaFwTUgqMbCmAb4npK4j7GasFdB1prDI2tthnmawW5PdXozjILwum77mX5/P/y3guJlUsgyGARRiHK04tUQrVSTs273txItDBzNhaZWsuLcno4MhH0F9Cpuu493wL+ONSqzQl7SaW9cG4ZQvcsgXn85lLrXKsZSfili1wyxa4ZQvcsgVu2QK3bIFbtsAtH8/t9gPxbrckFSamGwAAAABJRU5ErkJggg=="},250065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return o}});var s=r(667294);let l={},a=s.createContext(l);function o(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);