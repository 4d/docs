"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[89642],{281032:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>j,frontMatter:()=>d,metadata:()=>i,toc:()=>o});var r=s(474848),t=s(28453);const d={id:"WebSocketServerClass",title:"WebSocketServer"},c=void 0,i={id:"API/WebSocketServerClass",title:"WebSocketServer",description:"La clase WebSocketServer permite crear y configurar un servidor WebSocket en 4D. Una vez que el servidor WebSocket 4D est\xe1 activo, puede abrir y utilizar las conexiones WebSocket entre 4D y los clientes utilizando la clase WebSocketConnection.",source:"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R6/API/WebSocketServerClass.md",sourceDirName:"API",slug:"/API/WebSocketServerClass",permalink:"/docs/es/API/WebSocketServerClass",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FWebSocketServerClass.md%20(20-R6)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R6",frontMatter:{id:"WebSocketServerClass",title:"WebSocketServer"},sidebar:"docs",previous:{title:"WebSocketConnection",permalink:"/docs/es/API/WebSocketConnectionClass"},next:{title:"ZIPArchive",permalink:"/docs/es/API/ZipArchiveClass"}},l={},o=[{value:"Requisitos",id:"requisitos",level:3},{value:"Ejemplo",id:"ejemplo",level:3},{value:"Objeto WebSocketServer",id:"objeto-websocketserver",level:3},{value:"4D.WebSocketServer.new()",id:"4dwebsocketservernew",level:2},{value:"Par\xe1metro <em>WSSHandler</em>",id:"par\xe1metro-wsshandler",level:3},{value:"Ejemplo de clase `WSSHandler",id:"ejemplo-de-clase-wsshandler",level:3},{value:"objeto <code>request</code>",id:"objeto-request",level:3},{value:"objeto <code>connectionHandler</code>",id:"objeto-connectionhandler",level:3},{value:"Ejemplo de clase `connectionHandler",id:"ejemplo-de-clase-connectionhandler",level:3},{value:"Par\xe1metro <em>options</em>",id:"par\xe1metro-options",level:3},{value:".connections",id:"connections",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n",level:4},{value:".dataType",id:"datatype",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n-1",level:4},{value:".handler",id:"handler",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n-2",level:4},{value:".path",id:"path",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n-3",level:4},{value:".terminate()",id:"terminate",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n-4",level:4},{value:".terminated",id:"terminated",level:2},{value:"Descripci\xf3n",id:"descripci\xf3n-5",level:4}];function a(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",details:"details",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["La clase ",(0,r.jsx)(n.code,{children:"WebSocketServer"})," permite crear y configurar un servidor WebSocket en 4D. Una vez que el servidor WebSocket 4D est\xe1 activo, puede abrir y utilizar las conexiones WebSocket entre 4D y los clientes utilizando la clase ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"WebSocketConnection"})}),"."]}),"\n",(0,r.jsxs)(n.details,{children:[(0,r.jsx)(n.summary,{children:"Historia"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Lanzamiento"}),(0,r.jsx)(n.th,{children:"Modificaciones"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"A\xf1adidos"})]})})]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Acerca de los servidores WebSocket",type:"note",children:(0,r.jsxs)(n.p,{children:["El protocolo WebSocket ofrece un canal de comunicaci\xf3n full-duplex entre un servidor WebSocket y un cliente (por ejemplo, un navegador web). Para m\xe1s informaci\xf3n sobre servidores WebSocket, lea ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/WebSocket",children:"esta p\xe1gina en Wikipedia"}),"."]})}),"\n",(0,r.jsx)(n.admonition,{title:"Ver tambi\xe9n",type:"info",children:(0,r.jsxs)(n.p,{children:["Ver tambi\xe9n ",(0,r.jsx)(n.a,{href:"https://blog.4d.com/new-built-in-websocket-server/",children:"esta entrada de blog"})," sobre el servidor WebSocket 4D."]})}),"\n",(0,r.jsx)(n.h3,{id:"requisitos",children:"Requisitos"}),"\n",(0,r.jsx)(n.p,{children:"Para crear y manejar su Servidor WebSocket en 4D, tendr\xe1 que utilizar dos clases 4D integradas:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["esta clase (",(0,r.jsx)(n.code,{children:"4D.WebSocketServer"}),") para gestionar el propio servidor,"]}),"\n",(0,r.jsxs)(n.li,{children:["la clase ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})," para administrar conexiones y mensajes."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Adem\xe1s, tendr\xe1 que crear dos clases de usuario que contendr\xe1n funciones de retrollamada:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"una clase usuario para gestionar las conexiones al servidor,"}),"\n",(0,r.jsx)(n.li,{children:"una clase usuario para gestionar mensajes."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Debe ",(0,r.jsx)(n.a,{href:"#4dwebsocketservernew",children:"crear el servidor WebSocket"})," dentro de un ",(0,r.jsx)(n.a,{href:"https://doc.4d.com/4dv19R/help/command/en/page1389.html",children:"worker"})," para mantener viva la conexi\xf3n."]}),"\n",(0,r.jsxs)(n.p,{children:["El ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebServerClass",children:"servidor Web 4D"})," debe estar iniciado."]}),"\n",(0,r.jsx)(n.h3,{id:"ejemplo",children:"Ejemplo"}),"\n",(0,r.jsx)(n.p,{children:"En este ejemplo b\xe1sico, nuestro servidor WebSocket devolver\xe1 los mensajes en may\xfasculas."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Crea el servidor WebSocket utilizando un worker (obligatorio) y pasa su clase de conexi\xf3n al servidor como par\xe1metro:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// crear una instancia de la clase usuario\n    // que manejar\xe1 las conexiones al servidor\nvar $handler:cs.myServerHandler\n$handler:=cs.myServerHandler.new()\n\nCALL WORKER("WebSocketServer"; Formula(wss:=4D.WebSocketServer.new($handler)))  \n    //asignar una variable (wss) al WebSocket permite   \n    //llamar a wss.terminate() despu\xe9s\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Defina la clase usuario ",(0,r.jsx)(n.code,{children:"myServerHandler"})," que contiene las funciones de retrollamada utilizadas para manejar las conexiones al servidor:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"//clase myServerHandler\n\nFunction onConnection($wss : Object; $event : Object) : Object\n\t//devuelve una instancia de la clase de usuario\n\t//que gestionar\xe1 los mensajes\n\treturn cs.myConnectionHandler.new()\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["Define la clase usuario ",(0,r.jsx)(n.code,{children:"myConnectionHandler"})," que contiene las funciones de retrollamada utilizadas para manejar los mensajes:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"// Clase myConnectionHandler\n\nFunction onMessage($ws : 4D.WebSocketConnection; $message : Object)\n\t// reenv\xeda el mensaje en may\xfasculas\n\t$ws.send(Uppercase($message.data))\n\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"JS del lado del cliente",type:"tip",children:(0,r.jsxs)(n.p,{children:["Consulte ",(0,r.jsx)(n.a,{href:"https://blog.4d.com/websocket-server/",children:"esta entrada de blog"})," para ver un ejemplo de c\xf3digo Javascript del lado del cliente que gestiona una conexi\xf3n WebSocket."]})}),"\n",(0,r.jsx)(n.h3,{id:"objeto-websocketserver",children:"Objeto WebSocketServer"}),"\n",(0,r.jsx)(n.p,{children:"Los objetos de servidor WebSocket ofrecen las siguientes propiedades y funciones:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsx)(n.tr,{children:(0,r.jsx)(n.th,{})})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#scalablesession",children:[(0,r.jsx)(n.strong,{children:".scalableSession"})," : Boolean"]}),(0,r.jsx)(n.br,{}),(0,r.jsx)(n.code,{children:"True"})," si se utilizan sesiones escalables en el servidor web, y ",(0,r.jsx)(n.code,{children:"False"})," en caso contrario"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#dataType",children:[(0,r.jsx)(n.strong,{children:".dataType"})," : Text"]}),(0,r.jsx)(n.br,{}),"el tipo de los datos recibidos o enviados"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#handler",children:[(0,r.jsx)(n.strong,{children:".handler"})," : Object"]}),(0,r.jsx)(n.br,{}),"el accessor que obtiene el objeto ",(0,r.jsx)(n.code,{children:"WSSHandler"})," utilizado para iniciar el servidor WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#path",children:[(0,r.jsx)(n.strong,{children:".path"})," : Text"]}),(0,r.jsx)(n.br,{}),"el patr\xf3n de la ruta para acceder al servidor WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#terminate",children:[(0,r.jsx)(n.strong,{children:".terminate"}),"()",(0,r.jsx)(n.br,{}),(0,r.jsx)(n.strong,{children:".terminate"}),"( ",(0,r.jsx)(n.em,{children:"timeout"})," : Integer )"]}),(0,r.jsx)(n.br,{}),"cierra el servidor WebSocket"]})}),(0,r.jsx)(n.tr,{children:(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#terminated",children:[(0,r.jsx)(n.strong,{children:".terminated"})," : Boolean"]}),(0,r.jsx)(n.br,{}),"True si el servidor WebSocket est\xe1 cerrado"]})})]})]}),"\n",(0,r.jsx)(n.h2,{id:"4dwebsocketservernew",children:"4D.WebSocketServer.new()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"4D.WebSocketServer.new"}),"( ",(0,r.jsx)(n.em,{children:"WSSHandler"})," : Object { ; ",(0,r.jsx)(n.em,{children:"options"})," : Object } ) : 4D.WebSocketServer"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"#wsshandler-parameter",children:"WSSHandler"})}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Objeto de la clase usuario que declara las retrollamadas del servidor WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"#options-parameter",children:"options"})}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Par\xe1metros de configuraci\xf3n de WebSocket"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Result"}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Nuevo objeto WebSocketServer"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n ",(0,r.jsx)(n.code,{children:"4D.WebSocketServer.new()"})," crea e inicia un servidor WebSocket que utilizar\xe1 las retrollamadas ",(0,r.jsx)(n.em,{children:"WSSHandler"})," y (opcionalmente) ",(0,r.jsx)(n.em,{children:"options"})," especificados, y devuelve un objeto ",(0,r.jsx)(n.code,{children:"4D.WebSocketServer"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Llamar a esta funci\xf3n requiere que el ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebServerClass",children:"servidor web 4D"})," est\xe9 iniciado. El ",(0,r.jsx)(n.strong,{children:"host"})," y el ",(0,r.jsx)(n.strong,{children:"port"})," del servidor WebSocket son los mismos que el host y el puerto del servidor Web 4D."]}),"\n",(0,r.jsxs)(n.h3,{id:"par\xe1metro-wsshandler",children:["Par\xe1metro ",(0,r.jsx)(n.em,{children:"WSSHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["En el par\xe1metro ",(0,r.jsx)(n.em,{children:"WSSHandler"}),", pasa una instancia de una clase de usuario que ser\xe1 llamada cada vez que ocurra un evento en el servidor WebSocket --esencialmente, eventos de conexi\xf3n. La clase debe definir las siguientes funciones de retrollamada (solo ",(0,r.jsx)(n.code,{children:"onConnection"})," es obligatoria):"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propiedad"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"}),(0,r.jsx)(n.th,{children:"Por defecto"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onConnection"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"(obligatorio) Retro llamada cuando se inicia una nueva conexi\xf3n cliente (ver m\xe1s abajo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onOpen"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Retrollamada cuando se inicia el servidor WebSocket (ver m\xe1s abajo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onTerminate"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Retrollamada cuando se termina el servidor WebSocket (ver abajo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onError"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Retrollamada cuando se ha producido un error (ver abajo)"}),(0,r.jsx)(n.td,{children:"indefinido"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onConnection"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object) : Object | null"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto servidor WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"connection"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"request"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["objeto ",(0,r.jsx)(n.code,{children:"request"}),". Contiene informaci\xf3n sobre la solicitud de conexi\xf3n (ver abajo)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resultado"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.a,{href:"#connectionhandler-object",children:["objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"})]})," (ver m\xe1s abajo). Si esta funci\xf3n devuelve un objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"}),", se crea autom\xe1ticamente un objeto [4D.WebSocketConnection",(0,r.jsx)(n.code,{children:"](WebSocketConnectionClass.md#websocketconnection-object) y se a\xf1ade a la [colecci\xf3n de conexiones](#connections). Este objeto se recibe entonces como par\xe1metro en cada funci\xf3n del objeto "}),"connectionHandler`. Si el valor devuelto es nulo o indefinido, se cancela la conexi\xf3n."]})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Esta retrollamada se llama cuando el establecimiento de la comunicaci\xf3n se ha completado. Debe ser llamado con un objeto ",(0,r.jsxs)(n.a,{href:"#connectionhandler-object",children:[(0,r.jsx)(n.code,{children:"connectionHandler"})," v\xe1lido"]})," para crear la conexi\xf3n WebSocket, de lo contrario la conexi\xf3n se cancela."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onOpen"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto servidor WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"open"'})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido cuando se inicia el servidor websocket."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onTerminate"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto servidor WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"terminate"'})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido cuando se cierra el servidor HTTP o el servidor WebSocket."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"WSHandler.onError"}),"(",(0,r.jsx)(n.em,{children:"WSServer"})," : Object ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WSServer"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"4D.WebSocketServer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto servidor WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"error"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"errors"}),(0,r.jsx)(n.td,{children:"Collection"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["Colecci\xf3n de la pila de errores 4D en caso de error de ejecuci\xf3n",(0,r.jsx)(n.li,{children:"[].errCode (number) - C\xf3digo de error 4D"}),(0,r.jsx)(n.li,{children:"[].message (text) - Descripci\xf3n del error 4D"}),(0,r.jsx)(n.li,{children:"[].componentSignature (text) - Firma del componente interno que ha devuelto el error"})]})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Evento emitido cuando se produce un error en el servidor WebSocket."}),"\n",(0,r.jsx)(n.h3,{id:"ejemplo-de-clase-wsshandler",children:"Ejemplo de clase `WSSHandler"}),"\n",(0,r.jsxs)(n.p,{children:["Este ejemplo de una funci\xf3n b\xe1sica de chat ilustra c\xf3mo manejar conexiones de servidor WebSocket en una clase ",(0,r.jsx)(n.em,{children:"WSSHandler"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'//clase myWSServerHandler \n\nFunction onConnection($wss : Object; $event : Object) : Object\n\n\tIf (VerifyAddress($event.request.remoteAddress))\n\t\t// El m\xe9todo VerifyAddress valida la direcci\xf3n del cliente\n        // El objeto WSConnectionHandler devuelto ser\xe1 utilizado \n        // por 4D para instanciar el objeto 4D.WebSocketConnection\n        // relacionado con esta conexi\xf3n\n        return cs.myConnectionHandler.new()   \n        // Ver objeto connectionHandler\n    Else \n        // La conexi\xf3n se cancela\t\n\t\treturn Null\n\tEnd if\n\nFunction onOpen($wss : Object; $event : Object)\nLogFile("*** Server started")\n\nFunction onTerminate($wss : Object; $event : Object)\nLogFile("*** Server closed")\n\nFunction onError($wss : Object; $event : Object)\nLogFile("!!! Server error: "+$event.errors.first().message)\n\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"objeto-request",children:["objeto ",(0,r.jsx)(n.code,{children:"request"})]}),"\n",(0,r.jsxs)(n.p,{children:["Un objeto ",(0,r.jsx)(n.code,{children:"request"})," contiene las siguientes propiedades:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"headers"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:["La petici\xf3n HTTP GET del cliente. ",(0,r.jsx)(n.code,{children:"headers.key=value"})," (value puede ser una colecci\xf3n si la misma llave aparece varias veces)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:["Objeto que contiene los par\xe1metros de la URL. Por ejemplo, si los par\xe1metros son ",(0,r.jsx)(n.code,{children:"?key1=value1&key2=value2"})," -> ",(0,r.jsx)(n.code,{children:"query.key1=value1"}),", ",(0,r.jsx)(n.code,{children:"query.key2=value2"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"url"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["contiene s\xf3lo la URL que est\xe1 presente en la petici\xf3n HTTP real. Ej: ",(0,r.jsx)(n.code,{children:"GET /status?name=ryan HTTP/1.1"}),' -> url="/status?name=ryan"']})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"remoteAddress"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"Direcci\xf3n IP del cliente"})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"objeto-connectionhandler",children:["objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"})]}),"\n",(0,r.jsxs)(n.p,{children:["Como resultado de la retrollamada ",(0,r.jsx)(n.code,{children:"WSHandler.onConnection"}),", pasa un objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"}),", que es una instancia de una clase de usuario que ser\xe1 llamada cada vez que ocurra un evento en la conexi\xf3n WebSocket --esencialmente, mensajes recibidos. La clase debe definir las siguientes funciones de retrollamada (s\xf3lo ",(0,r.jsx)(n.code,{children:"onMessage"})," es obligatoria):"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onMessage"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"(obligatorio) Funci\xf3n llamada cuando se recibe un nuevo mensaje de esta conexi\xf3n"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onOpen"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsxs)(n.td,{children:["Funci\xf3n llamada cuando se crea el ",(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onTerminate"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Funci\xf3n a la que se llama cuando finaliza esta conexi\xf3n"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"onError"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/FunctionClass",children:"Function"})}),(0,r.jsx)(n.td,{children:"Funci\xf3n llamada cuando se produce un error"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onMessage"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto de conexi\xf3n WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"message"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"data"}),(0,r.jsx)(n.td,{children:"Text / Blob / Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:"datos enviados por el cliente"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Esta retrollamada para datos WebSocket. Llamada cada vez que el WebSocket recibe datos."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onOpen"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto de conexi\xf3n WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"open"'})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Llamada cuando se crea el objeto ",(0,r.jsx)(n.code,{children:"connectionHandler"})," (despu\xe9s del evento ",(0,r.jsx)(n.code,{children:"WSS.onConnection"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onTerminate"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto de conexi\xf3n WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"terminate"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"code"}),(0,r.jsx)(n.td,{children:"Number"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsxs)(n.td,{children:["C\xf3digo de estado que indica por qu\xe9 se ha cerrado la conexi\xf3n. Si el WebSocket no devuelve un c\xf3digo de error, ",(0,r.jsx)(n.code,{children:"code"})," se toma el valor 1005 si no se ha producido ning\xfan error o 1006 si se ha producido un error."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"reason"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:"Cadena que explica porque se ha cerrado la conexi\xf3n. Si el websocket no devuelve una raz\xf3n, el c\xf3digo es indefinido"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Funci\xf3n llamada cuando se cierra el WebSocket."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"connectionHandler.onError"}),"(",(0,r.jsx)(n.em,{children:"ws"})," : 4D.WebSocketConnection ; ",(0,r.jsx)(n.em,{children:"event"})," : Object)"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ws"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"4D.WebSocketConnection"})})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Objeto de conexi\xf3n WebSocket actual"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"evento"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"<-"}),(0,r.jsx)(n.td,{children:"Par\xe1metros"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"type"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{children:'"error"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:"errors"}),(0,r.jsx)(n.td,{children:"Collection"}),(0,r.jsx)(n.td,{}),(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:["Colecci\xf3n de la pila de errores 4D en caso de error de ejecuci\xf3n",(0,r.jsx)(n.li,{children:"[].errCode (number) - C\xf3digo de error 4D"}),(0,r.jsx)(n.li,{children:"[].message (text) - Descripci\xf3n del error 4D"}),(0,r.jsx)(n.li,{children:"[].componentSignature (text) - Firma del componente interno que ha devuelto el error"})]}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Funci\xf3n llamada cuando se ha producido un error."}),"\n",(0,r.jsx)(n.h3,{id:"ejemplo-de-clase-connectionhandler",children:"Ejemplo de clase `connectionHandler"}),"\n",(0,r.jsxs)(n.p,{children:["Este ejemplo de una funci\xf3n b\xe1sica de chat ilustra c\xf3mo gestionar mensajes en una clase ",(0,r.jsx)(n.em,{children:"connectionHandler"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'// Clase myConnectionHandler\n\nFunction onMessage($ws : 4D.WebSocketConnection; $message : Object)\n\t// Reenviar el mensaje a todos los clientes de chat\n\tThis.broadcast($ws;$message.data)\n\nFunction onOpen($ws : 4D.WebSocketConnection; $message : Object)\n\t// Enviar un mensaje a los nuevos usuarios conectados\n\t$ws.send("\xa1Bienvenido al chat!")\n\t// Enviar el mensaje "Nuevo cliente conectado" a todos los dem\xe1s clientes de chat\n\tThis.broadcast($ws;"Nuevo cliente conectado")\n\nFunction onTerminate($ws : 4D.WebSocketConnection; $message : Object)\n\t// Enviar el mensaje "Cliente desconectado" a todos los dem\xe1s clientes de chat\n\tThis.broadcast($ws;"Cliente desconectado")\n\nFunction broadcast($ws : 4D.WebSocketConnection; $message:text)\n\tvar $client:4D.WebSocketConnection\n\t// Reenviar el mensaje a todos los clientes de chat\n\tFor each ($client; $ws.wss.connections)\n\t\t// Comprobar que el id no es la conexi\xf3n actual\n\t\tIf ($client.id#$ws.id)\n\t\t\t$client.send($message)\n\t\tEnd if\n\tEnd for each\n\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"par\xe1metro-options",children:["Par\xe1metro ",(0,r.jsx)(n.em,{children:"options"})]}),"\n",(0,r.jsxs)(n.p,{children:["En el par\xe1metro opcional ",(0,r.jsx)(n.em,{children:"options"}),", pase un objeto que contenga las siguientes propiedades:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Propiedad"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"}),(0,r.jsx)(n.th,{children:"Por defecto"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"path"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"Representa la ruta de acceso al servidor WebSocket. Si no se define ninguna ruta, el servidor WebSocket gestiona todas las conexiones"}),(0,r.jsx)(n.td,{children:"indefinido"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"dataType"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsxs)(n.td,{children:["Tipo de los datos recibidos a trav\xe9s de ",(0,r.jsx)(n.code,{children:"connectionHandler.onMessage"})," y los datos enviados por la funci\xf3n ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass#send",children:(0,r.jsx)(n.code,{children:"WebSocketConnection.send()"})}),'. Valores: "text", "blob","object"). Si "object": (send) transforma object en formato json y lo env\xeda; (reception): recibe formato json y lo transforma en object']}),(0,r.jsx)(n.td,{children:"text"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"connections",children:".connections"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".connections"})," : Collection"]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La propiedad ",(0,r.jsx)(n.code,{children:".connections"})," contiene todas las conexiones actuales gestionadas por el servidor WebSocket. Cada elemento de la colecci\xf3n es un objeto ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass",children:(0,r.jsx)(n.code,{children:"WebSocketConnection"})}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Cuando se finaliza una conexi\xf3n, su ",(0,r.jsx)(n.a,{href:"/docs/es/API/WebSocketConnectionClass#status",children:(0,r.jsx)(n.code,{children:"status"})}),' cambia a "Closed" y se elimina de esta colecci\xf3n.']}),"\n",(0,r.jsx)(n.h2,{id:"datatype",children:".dataType"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".dataType"})," : Text"]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-1",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La propiedad ",(0,r.jsx)(n.code,{children:".dataType"})," contiene el tipo de los datos recibidos o enviados."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propiedad es de s\xf3lo lectura."}),"\n",(0,r.jsx)(n.h2,{id:"handler",children:".handler"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".handler"})," : Object"]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-2",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La propiedad ",(0,r.jsx)(n.code,{children:".handler"})," contiene el accessor que obtiene el objeto ",(0,r.jsx)(n.code,{children:"WSSHandler"})," utilizado para iniciar el servidor WebSocket."]}),"\n",(0,r.jsx)(n.h2,{id:"path",children:".path"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".path"})," : Text"]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-3",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La propiedad ",(0,r.jsx)(n.code,{children:".path"})," contiene el patr\xf3n de la ruta para acceder al servidor WebSocket. Si no se ha definido ninguna ruta, el servidor WebSocket gestiona todas las conexiones."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propiedad es de s\xf3lo lectura."}),"\n",(0,r.jsx)(n.h2,{id:"terminate",children:".terminate()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".terminate"}),"()",(0,r.jsx)(n.br,{}),(0,r.jsx)(n.strong,{children:".terminate"}),"( ",(0,r.jsx)(n.em,{children:"timeout"})," : Integer )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metros"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"timeout"}),(0,r.jsx)(n.td,{children:"Integer"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"->"}),(0,r.jsx)(n.td,{children:"Tiempo de espera en segundos antes de finalizar el servidor WebSocket"})]})})]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-4",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La funci\xf3n ",(0,r.jsx)(n.code,{children:".terminate()"})," cierra el servidor WebSocket."]}),"\n",(0,r.jsxs)(n.p,{children:["De forma predeterminada, si no se establece un valor ",(0,r.jsx)(n.em,{children:"timeout"}),", la funci\xf3n inicializa el cierre de conexi\xf3n y espera recibir un frame de cierre del otro extremo, luego env\xeda un paquete FIN en un intento de realizar un cierre limpio del socket. Cuando se recibe la respuesta, se destruye el socket."]}),"\n",(0,r.jsxs)(n.p,{children:["Si se establece un valor de ",(0,r.jsx)(n.em,{children:"timeout"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"cuando se alcanza el tiempo de espera, destruye forzosamente el socket."}),"\n",(0,r.jsxs)(n.li,{children:["si ",(0,r.jsx)(n.em,{children:"timeout"})," = 0, destruye el socket de forma forzada sin cerrar los frames ni intercambiar paquetes fin, y lo hace al instante sin esperar."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"terminated",children:".terminated"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:".terminated"})," : Boolean"]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-5",children:"Descripci\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["La propiedad ",(0,r.jsx)(n.code,{children:".terminated"})," contiene True si el servidor WebSocket est\xe1 cerrado."]}),"\n",(0,r.jsx)(n.p,{children:"Esta propiedad es de s\xf3lo lectura."})]})}function j(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>i});var r=s(296540);const t={},d=r.createContext(t);function c(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);