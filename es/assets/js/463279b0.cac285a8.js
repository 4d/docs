"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["53034"],{98827:function(e,n,r){r.r(n),r.d(n,{default:()=>p,frontMatter:()=>s,metadata:()=>i,assets:()=>t,toc:()=>l,contentTitle:()=>d});var i=JSON.parse('{"id":"WritePro/commands-legacy/wp-get-position","title":"WP Get position","description":"WP Get position ( objRango {; layout} ) -> Resultado","source":"@site/i18n/es/docusaurus-plugin-content-docs/version-20-R7/WritePro/commands-legacy/wp-get-position.md","sourceDirName":"WritePro/commands-legacy","slug":"/WritePro/commands/wp-get-position","permalink":"/docs/es/20-R7/WritePro/commands/wp-get-position","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20WritePro%2Fcommands-legacy%2Fwp-get-position.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"wp-get-position","title":"WP Get position","slug":"/WritePro/commands/wp-get-position","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"WP Get page count","permalink":"/docs/es/20-R7/WritePro/commands/wp-get-page-count"},"next":{"title":"WP Get section","permalink":"/docs/es/20-R7/WritePro/commands/wp-get-section"}}'),a=r("785893"),o=r("250065");let s={id:"wp-get-position",title:"WP Get position",slug:"/WritePro/commands/wp-get-position",displayed_sidebar:"docs"},d=void 0,t={},l=[{value:"Descripci\xf3n",id:"descripci\xf3n",level:2},{value:"Ejemplo 1",id:"ejemplo-1",level:2},{value:"Ejemplo 2",id:"ejemplo-2",level:2},{value:"Ejemplo 3",id:"ejemplo-3",level:2},{value:"Ejemplo 4",id:"ejemplo-4",level:2},{value:"Ver tambi\xe9n",id:"ver-tambi\xe9n",level:2}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"WP Get position"})," ( ",(0,a.jsx)(n.em,{children:"objRango"})," {; ",(0,a.jsx)(n.em,{children:"layout"}),"} ) -> Resultado"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Par\xe1metro"}),(0,a.jsx)(n.th,{children:"Tipo"}),(0,a.jsx)(n.th,{}),(0,a.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"objRango"}),(0,a.jsx)(n.td,{children:"Object"}),(0,a.jsx)(n.td,{children:"\u2192"}),(0,a.jsx)(n.td,{children:"Rango o elemento o documento 4D Write Pro"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"layout"}),(0,a.jsx)(n.td,{children:"Integer"}),(0,a.jsx)(n.td,{children:"\u2192"}),(0,a.jsx)(n.td,{children:"Dise\xf1o de documento 4D Write Pro utilizado para la evaluaci\xf3n: 0 (predeterminado)= dise\xf1o 4D Write Pro, 1=HTML WYSIWYG"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Resultado"}),(0,a.jsx)(n.td,{children:"Object"}),(0,a.jsx)(n.td,{children:"\u2190"}),(0,a.jsx)(n.td,{children:"Informaci\xf3n de la posici\xf3n"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"descripci\xf3n",children:"Descripci\xf3n"}),"\n",(0,a.jsxs)(n.p,{children:["El comando ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devuelve un objeto que describe la posici\xf3n actual de ",(0,a.jsx)(n.em,{children:"objRango"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["En el par\xe1metro ",(0,a.jsx)(n.em,{children:"objRango"}),", puede pasar:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"un rango, o"}),"\n",(0,a.jsx)(n.li,{children:"un elemento (tabla / l\xednea / p\xe1rrafo / cuerpo / encabezado / pie de p\xe1gina / imagen / secci\xf3n / subsecci\xf3n / caja de texto), o"}),"\n",(0,a.jsx)(n.li,{children:"un documento 4D Write Pro"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"El comando devuelve la informaci\xf3n de posici\xf3n en un objeto con las siguientes propiedades:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Nombre de la propiedad"})}),(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Tipo"})}),(0,a.jsx)(n.th,{children:(0,a.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"secci\xf3n"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["N\xfamero de la primera secci\xf3n que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"p\xe1gina"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["N\xfamero de la primera p\xe1gina que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"columna"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["\xcdndice de la primera columna que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})," (basado-1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"linea"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["\xcdndice de la primera l\xednea que intersecta ",(0,a.jsx)(n.em,{children:"objRango"})," (relativo a la columna - o p\xe1gina si no hay ninguna columna con base - 1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"posici\xf3n"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["Posici\xf3n en la l\xednea del primer caracter de ",(0,a.jsx)(n.em,{children:"objRango"})," (basado -1)"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"delimitadores"}),(0,a.jsx)(n.td,{children:"Objeto"}),(0,a.jsxs)(n.td,{children:["Coordenadas del rect\xe1ngulo delimitador del ",(0,a.jsx)(n.em,{children:"objRango"}),", expresadas en la unidad de documento actual y en relaci\xf3n con la esquina superior izquierda de la p\xe1gina. Se tienen en cuenta los tama\xf1os de relleno y borde (si los hay); Los m\xe1rgenes y las reglas no se tienen en cuenta."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"arriba"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada superior del rect\xe1ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"izquierda"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada izquierda del rect\xe1ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"abajo"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada inferior del rect\xe1ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"derecha"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsx)(n.td,{children:"Coordenada derecha del rect\xe1ngulo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"rangoAltura"}),(0,a.jsx)(n.td,{children:"N\xfamero"}),(0,a.jsxs)(n.td,{children:["Altura del rect\xe1ngulo delimitador del ",(0,a.jsx)(n.em,{children:"objRango"}),". Este valor puede ser diferente de las opciones ",(0,a.jsx)(n.em,{children:"bounds.bottom-bounds.top"})," si el ",(0,a.jsx)(n.em,{children:"objRango"})," se extiende sobre varias columnas (ver ejemplo 4)"]})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["Si ",(0,a.jsx)(n.em,{children:"objRango"})," es un rango vac\xedo, ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devuelve la informaci\xf3n de posici\xf3n al inicio del rango. Tenga en cuenta que en el caso de un rango vac\xedo del tipo predeterminado (texto), la altura del rango (",(0,a.jsx)(n.em,{children:"rangeHeight"})," o ",(0,a.jsx)(n.em,{children:"bounds.bottom"}),"-",(0,a.jsx)(n.em,{children:"bounds.top"}),") es la altura del cursor y el ancho del rango (",(0,a.jsx)(n.em,{children:"bounds.right"}),"-",(0,a.jsx)(n.em,{children:"bounds.left"}),") es de 1 p\xedxel .",(0,a.jsx)(n.br,{}),"\nSi ",(0,a.jsx)(n.em,{children:"objRango"})," es texto en un encabezado o pie de p\xe1gina, ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devuelve la informaci\xf3n de posici\xf3n donde se muestran el encabezado y el pie de p\xe1gina en la primera secci\xf3n/p\xe1gina.",(0,a.jsx)(n.br,{}),"\nSi ",(0,a.jsx)(n.em,{children:"objRango"})," es una imagen anclada (que se puede replicar en varias p\xe1ginas), ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devuelve la informaci\xf3n de posici\xf3n donde la imagen est\xe1 anclada en la primera secci\xf3n/p\xe1gina.",(0,a.jsx)(n.br,{}),"\nSi ",(0,a.jsx)(n.em,{children:"objRango"})," es una subsecci\xf3n, ",(0,a.jsx)(n.strong,{children:"WP Get position"})," devuelve la informaci\xf3n de posici\xf3n de la primera p\xe1gina de la secci\xf3n padre."]}),"\n",(0,a.jsxs)(n.p,{children:["El par\xe1metro opcional ",(0,a.jsx)(n.em,{children:"layout"})," se puede usar para definir la vista HTML wysiwyg para la evaluaci\xf3n ",(0,a.jsx)(n.em,{children:"objRango"}),'. Puede pasar una de las siguientes constantes del tema "4D Write Pro":']}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Constante"}),(0,a.jsx)(n.th,{children:"Tipo"}),(0,a.jsx)(n.th,{children:"Valor"}),(0,a.jsx)(n.th,{children:"Comentario"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"wk 4D Write Pro layout"}),(0,a.jsx)(n.td,{children:"Entero largo"}),(0,a.jsx)(n.td,{children:"0"}),(0,a.jsx)(n.td,{children:"Formato 4D Write Pro est\xe1ndar, puede incluir algunos atributos de estilo espec\xedficos"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"wk html wysiwyg"}),(0,a.jsx)(n.td,{children:"Entero largo"}),(0,a.jsx)(n.td,{children:"1"}),(0,a.jsx)(n.td,{children:"En este formato, los atributos avanzados 4D Write Pro que no son compatibles con todos los navegadores se eliminan"})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["Si se omite ",(0,a.jsx)(n.em,{children:"layout"}),", el dise\xf1o de 4D Write Pro se usa de forma predeterminada."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Notas sobre rendimiento"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["La misma configuraci\xf3n de visualizaci\xf3n que para el comando ",(0,a.jsx)(n.a,{href:"/docs/es/20-R7/WritePro/commands/wp-print",children:"WP PRINT"})," se usa con ",(0,a.jsx)(n.strong,{children:"WP Get position"}),":\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"encabezados: visibles"}),"\n",(0,a.jsx)(n.li,{children:"pies de p\xe1gina: visibles"}),"\n",(0,a.jsx)(n.li,{children:"expresiones: computadas y mostradas"}),"\n",(0,a.jsxs)(n.li,{children:["modo p\xe1gina: p\xe1gina o borrador (vista wysiwyg HTML seg\xfan lo definido por el comando)",(0,a.jsx)(n.br,{}),"\nSi ",(0,a.jsx)(n.em,{children:"objRango"}),' se muestra en un \xe1rea de formulario 4D Write Pro, aseg\xfarese de que la configuraci\xf3n de visualizaci\xf3n del \xe1rea coincida con la configuraci\xf3n de visualizaci\xf3n del comando para obtener informaci\xf3n consistente. Tenga en cuenta tambi\xe9n que si estas configuraciones son diferentes en el \xe1rea, 4D Write Pro tendr\xe1 que "clonar" el documento para calcular el dise\xf1o en cada llamada del comando, lo que puede tomar mucho tiempo. Por motivos de rendimiento, en este caso, se recomienda construir el documento fuera de l\xednea y copiarlo en el \xe1rea de objetos de formulario solo cuando se complete la compilaci\xf3n.']}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["No se debe llamar a este comando dentro de los eventos que se generan con frecuencia (como On After Edit) ya que ",(0,a.jsx)(n.em,{children:"result.rangeHeight"})," por ejemplo, puede requerir c\xe1lculos de renderizaci\xf3n que requieren mucho tiempo y que deben realizarse en cada llamada de evento."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,a.jsx)(n.p,{children:"Desea saber el n\xfamero de p\xe1gina de un rango:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:'\xa0var $range;$rangePosition : Object\n\xa0$range:=WP Text range(WParea)\xa0//range from user selection\n\xa0$rangePosition:=WP Get position($range;wk 4D Write Pro layout)\n\xa0ALERT("First page number in selection is "+String($rangePosition.page))\n'})}),"\n",(0,a.jsx)(n.h2,{id:"ejemplo-2",children:"Ejemplo 2"}),"\n",(0,a.jsx)(n.p,{children:"Desea definir en color azul el texto en la primera y \xfaltima p\xe1gina del documento:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:'\xa0var $nbPages : Integer\n\xa0var $body : Object\n\xa0var $_paragraphs : Collection\n\xa0\n\xa0$nbPages:=WP Get page count([DOC]Sample)\n\xa0$body:=WP Get body([DOC]Sample)\n\xa0$_paragraphs:=WP Get elements($body;wk type paragraph)\n\xa0For each($paragraph;$_paragraphs)\n\xa0\xa0\xa0\xa0$info:=WP Get position($paragraph)\n\xa0\xa0\xa0\xa0If($info.page=1)|($info.page=$nbPages)\xa0//p\xe1rrafos de la primera y \xfaltima p\xe1gina en azul\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET ATTRIBUTES($paragraph;wk text color;"blue")\n\xa0\xa0\xa0\xa0Else\xa0//other pages paragraphs in black\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP SET ATTRIBUTES($paragraph;wk text color;"black")\n\xa0\xa0\xa0\xa0End if\n\xa0End for each\n'})}),"\n",(0,a.jsx)(n.h2,{id:"ejemplo-3",children:"Ejemplo 3"}),"\n",(0,a.jsx)(n.p,{children:"Mientras crea un documento, desea evitar divisiones de p\xe1rrafo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:"\xa0var WParea;$body : Object\n\xa0var $_paragraphs : Collection\n\xa0WParea:=WP New\n\xa0\n\xa0$body:=WP Get body([DOC]Sample)\n\xa0$_paragraphs:=WP Get elements($body;wk type paragraph)\n\xa0\n\xa0For each($paragraph;$_paragraphs)\n\xa0\xa0\xa0\xa0$insert:=WP New($paragraph)\n\xa0\n\xa0\xa0//memoriza el rango actual y el n\xfamero de p\xe1gina\n\xa0\xa0\xa0\xa0$rangeBefore:=WP Text range(WParea;wk end text;wk end text)\n\xa0\xa0\xa0\xa0$info:=WP Get position($rangeBefore)\n\xa0\xa0\xa0\xa0$memoPage:=$info.page\n\xa0\n\xa0\xa0//inserta el contenido, conserva el rango intacto\n\xa0\xa0\xa0\xa0WP INSERT DOCUMENT($rangeBefore;$insert;wk append;wk exclude from range)\n\xa0\n\xa0\xa0//verifica la posici\xf3n despu\xe9s de la inserci\xf3n\n\xa0\xa0\xa0\xa0$rangeAfter:=WP Text range(WParea;wk end text;wk end text)\n\xa0\xa0\xa0\xa0$info:=WP Get position($rangeAfter)\n\xa0\n\xa0\xa0\xa0\xa0If($memoPage#$info.page)\xa0// si la p\xe1gina ha cambiado, inserta un salto de p\xe1gina\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0WP INSERT BREAK($rangeBefore;wk page break;wk replace)\n\xa0\xa0\xa0\xa0End if\n\xa0\n\xa0End for each\n"})}),"\n",(0,a.jsx)(n.h2,{id:"ejemplo-4",children:"Ejemplo 4"}),"\n",(0,a.jsxs)(n.p,{children:["Los siguientes ejemplos ilustran las coordenadas del rect\xe1ngulo delimitador devueltas, seg\xfan el ",(0,a.jsx)(n.em,{children:"objRango"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-4d",children:"\xa0$default:=WP Text range(WPArea)\xa0//rango predeterminado (texto)\n\xa0$textCoordinates:=WP Get position($default)\xa0//l\xednea de puntos roja\n\xa0\n\xa0$paragraph:=WP Create paragraph range($default)\xa0//rango de p\xe1rrafo\n\xa0$paraCoordinates:=WP Get position($paragraph)\xa0// l\xednea punteada verde\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:r(5469).Z+"",width:"800",height:"421"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"L\xednea de puntos roja:"})," ",(0,a.jsx)(n.em,{children:"valores de objeto $textCoordinates"}),"\n",(0,a.jsx)(n.em,{children:"L\xednea de puntos verde:"})," ",(0,a.jsx)(n.em,{children:"valores de objeto $"})," ",(0,a.jsx)(n.em,{children:"paraCoordinates"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Nota:"})," en el caso de una visualizaci\xf3n en varias columnas, la propiedad ",(0,a.jsx)(n.em,{children:"rangeHeight"})," (l\xedneas sin formato) podr\xeda ser m\xe1s grande que ",(0,a.jsx)(n.em,{children:"bounds.bottom"}),"-",(0,a.jsx)(n.em,{children:"bounds.top"})," (l\xedneas de puntos):"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:r(175744).Z+"",width:"567",height:"427"})}),"\n",(0,a.jsx)(n.h2,{id:"ver-tambi\xe9n",children:"Ver tambi\xe9n"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"/docs/es/20-R7/WritePro/commands/wp-print",children:"WP PRINT"})})]})}function p(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},5469:function(e,n,r){r.d(n,{Z:function(){return i}});let i=r.p+"assets/images/pict4096405.es-06494b17daf4c188448c7a627e5e83c7.png"},175744:function(e,n,r){r.d(n,{Z:function(){return i}});let i=r.p+"assets/images/pict4096411.en-392fb0a306ecaaf16fc2ed9654286496.png"},250065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return s}});var i=r(667294);let a={},o=i.createContext(a);function s(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);