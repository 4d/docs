<!doctype html><html lang=es dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-20-R6 docs-doc-page docs-doc-id-API/IMAPTransporterClass" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>IMAPTransporter | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/es/20-R6/API/IMAPTransporterClass><meta data-rh=true property=og:locale content=es><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true property=og:locale:alternate content=pt><meta data-rh=true name=docusaurus_locale content=es><meta data-rh=true name=docsearch:language content=es><meta data-rh=true name=docusaurus_version content=20-R6><meta data-rh=true name=docusaurus_tag content=docs-default-20-R6><meta data-rh=true name=docsearch:version content=20-R6><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-20-R6><meta data-rh=true property=og:title content="IMAPTransporter | 4D Docs"><meta data-rh=true name=description content="La clase IMAPTransporter le permite recuperar mensajes de un servidor de correo IMAP."><meta data-rh=true property=og:description content="La clase IMAPTransporter le permite recuperar mensajes de un servidor de correo IMAP."><link data-rh=true rel=icon href=/docs/es/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/es/20-R6/API/IMAPTransporterClass><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20-R6/API/IMAPTransporterClass hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/20-R6/API/IMAPTransporterClass hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/20-R6/API/IMAPTransporterClass hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/20-R6/API/IMAPTransporterClass hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/20-R6/API/IMAPTransporterClass hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/20-R6/API/IMAPTransporterClass hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/es/opensearch.xml><link rel=stylesheet href=/docs/es/assets/css/styles.eef951bf.css><script src=/docs/es/assets/js/main.5c9b85c5.js defer></script><script src=/docs/es/assets/js/runtime~main.77030b1c.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Saltar al contenido principal"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Saltar al contenido principal</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label="Alternar la barra de navegación" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/es/><div class=navbar__logo><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Documentación 4D</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/es/20-R6/API/IMAPTransporterClass>20 R6</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/es/API/IMAPTransporterClass>20 R7 BETA</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/es/20-R6/API/IMAPTransporterClass>20 R6</a><li><a class=dropdown__link href=/docs/es/20/API/IMAPTransporterClass>20</a><li><a class=dropdown__link href=/docs/es/19/API/IMAPTransporterClass>19</a><li><a class=dropdown__link href=/docs/es/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Español</a><ul class=dropdown__menu><li><a href=/docs/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/docs/fr/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/docs/es/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=es>Español</a><li><a href=/docs/ja/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a><li><a href=/docs/pt/20-R6/API/IMAPTransporterClass rel="noopener noreferrer" class=dropdown__link lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Cambia entre el modo oscuro y el claro (actualmente modo Claro)" aria-label="Cambia entre el modo oscuro y el claro (actualmente modo Claro)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Buscar (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Buscar</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Volver arriba" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/es/><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Documentación 4D</b></a><nav aria-label="Barra lateral de Documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/20-R6/category/getting-started>Comencemos</a><button aria-label="Ampliar la categoría 'Comencemos' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/es/20-R6/category/core-development>Desarrollo</a><button aria-label="Contraer categoría de la barra lateral 'Desarrollo'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/es/20-R6/Project/overview>Gestión del proyecto</a><button aria-label="Ampliar la categoría 'Gestión del proyecto' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/es/20-R6/Project/code-overview>Entorno de desarrollo</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/es/20-R6/ORDA/overview>ORDA</a><button aria-label="Ampliar la categoría 'ORDA' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/es/20-R6/Concepts/about>Lenguaje</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/es/20-R6/Concepts/about>Conceptos</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href=https://doc.4d.com/4Dv20R6/4D/20-R6/4D-Language-Reference.100-6957482.en.html target=_blank rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex=0>Comandos<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/es/20-R6/category/class-API-reference>Clases</a><button aria-label="Contraer categoría de la barra lateral 'Clases'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/overview>Acerca de las funciones clase</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/BlobClass>Blob</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/ClassClass>Class</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/CollectionClass>Collection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/CryptoKeyClass>CryptoKey</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/DataClassClass>DataClass</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/DataStoreClass>DataStore</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/EmailObjectClass>Email</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/EntityClass>Entity</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/EntitySelectionClass>EntitySelection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/FileClass>File</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/FileHandleClass>FileHandle</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/FolderClass>Folder</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/FunctionClass>Function</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/HTTPAgentClass>HTTPAgent</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/HTTPRequestClass>HTTPRequest</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/es/20-R6/API/IMAPTransporterClass>IMAPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/MailAttachmentClass>MailAttachment</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/POP3TransporterClass>POP3Transporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/SessionClass>Session</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/SignalClass>Signal</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/SMTPTransporterClass>SMTPTransporter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/SystemWorkerClass>SystemWorker</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebFormClass>WebForm</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebFormItemClass>WebFormItem</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebServerClass>WebServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebSocketClass>WebSocket</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebSocketConnectionClass>WebSocketConnection</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/WebSocketServerClass>WebSocketServer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/ZipArchiveClass>ZIPArchive</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/ZipFileClass>ZIPFile</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/API/ZipFolderClass>ZIPFolder</a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/es/20-R6/Develop/processes>Procesos</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/20-R6/Tags/transformation-tags>Etiquetas de transformación</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/es/20-R6/Preferences/overview>Preferencias</a><button aria-label="Ampliar la categoría 'Preferencias' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/20-R6/category/administration>Administración</a><button aria-label="Ampliar la categoría 'Administración' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/20-R6/Extensions/overview>Extensiones</a><button aria-label="Ampliar la categoría 'Extensiones' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/20-R6/category/web-applications>Aplicaciones web</a><button aria-label="Ampliar la categoría 'Aplicaciones web' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/20-R6/category/desktop-applications>Aplicaciones de escritorio</a><button aria-label="Ampliar la categoría 'Aplicaciones de escritorio' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a href=https://developer.4d.com/go-mobile/ target=_blank rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false>Aplicaciones móviles</a></div></ul></nav><button type=button title="Contraer la barra lateral" aria-label="Contraer la barra lateral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Camino de navegación"><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Página de inicio" class=breadcrumbs__link href=/docs/es/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/es/20-R6/category/core-development><span itemprop=name>Desarrollo</span></a><meta itemprop=position content=1><li class=breadcrumbs__item><span class=breadcrumbs__link>Lenguaje</span><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/es/20-R6/category/class-API-reference><span itemprop=name>Clases</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>IMAPTransporter</span><meta itemprop=position content=4></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Versión: 20 R6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">En esta página</button></div><div class="theme-doc-markdown markdown"><header><h1>IMAPTransporter</h1></header><p>La clase <code>IMAPTransporter</code> le permite recuperar mensajes de un servidor de correo IMAP.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objeto-imap-transporter>Objeto IMAP Transporter<a href=#objeto-imap-transporter class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h3>
<p>Los objetos IMAP Transporter se instancian con el comando <a href=#imap-new-transporter>IMAP New transporter</a>. Ofrecen las siguientes propiedades y funciones:</p>


































































































<table><thead><tr><th><tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a><br><strong>True</strong> si se autoriza a 4D establecer una conexión no cifrada<tr><td><a href=#addflags><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</a><br>agrega banderas a los <code>msgIDs</code> para las <code>keywords</code> especificadas<tr><td><a href=#append><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</a><br>añade un <code>mailObj</code> al <code>destinationBox</code><tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a><br>el modo de autenticación utilizado para abrir la sesión en el servidor de correo<tr><td><a href=#checkconnection><strong>.checkConnection()</strong> : Object</a><br> comprueba la conexión utilizando la información almacenada en el objeto transporter<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a><br>el tiempo máximo (en segundos) permitido antes de verificar la conexión con el servidor<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a><br>el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor<tr><td><a href=#copy><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br>copia los mensajes definidos por <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP<tr><td><a href=#createbox><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</a><br>crea un buzón con el nombre dado<tr><td><a href=#delete><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><br>define el marcador "deleted" para los mensajes definidos en <code>msgsIDs</code> o <code>allMsgs</code><tr><td><a href=#deletebox><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</a><br>elimina permanentemente el buzón de correo con el <code>name</code> dado del servidor IMAP<tr><td><a href=#expunge><strong>.expunge()</strong> : Object</a><br>elimina todos los mensajes con el marcador "deleted" del servidor de correo IMAP.<tr><td><a href=#getboxinfo><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</a><br>devuelve un objeto <code>boxInfo</code> correspondiente al buzón de correo actual o el buzón de correo <em>name</em><tr><td><a href=#getboxlist><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</a><br>devuelve una colección de bandejas de entrada que describe todas las bandejas de entrada disponibles<tr><td><a href=#getdelimiter><strong>.getDelimiter()</strong> : Text</a><br>devuelve el caracter utilizado para delimitar niveles de jerarquía en el nombre del buzón<tr><td><a href=#getmail><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</a><br>devuelve el objeto <code>Email</code> correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code><tr><td><a href=#getmails><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</a><br>devuelve un objeto que contiene una colección de objetos <code>Email</code><tr><td><a href=#getmimeasblob><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</a><br>devuelve un BLOB con el contenido MIME del mensaje correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code><tr><td><a href=#host><strong>.host</strong> : Text</a><br>el nombre o la dirección IP del servidor local<tr><td><a href=#logfile><strong>.logFile</strong> : Text</a><br>la ruta del archivo de registro extendido definido (si existe) para la conexión de correo<tr><td><a href=#move><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</a><br>mueve los mensajes definidos por <em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em> del servidor IMAP<tr><td><a href=#numtoid><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</a><br>convierte los números de secuencia en IDs únicos IMAP para los mensajes en el rango secuencial designado por <em>startMsg</em> y <em>endMsg</em><tr><td><a href=#removeflags><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</a><br>elimina las banderas de los <code>msgIDs</code> para las <code>keywords</code> especificadas<tr><td><a href=#renamebox><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</a><br>cambia el nombre de un buzón en el servidor IMAP<tr><td><a href=#port><strong>.port</strong> : Integer</a><br> el número de puerto utilizado para las transacciones de correo<tr><td><a href=#searchmails><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</a><br>busca los mensajes que coincidan con los criterios de búsqueda <em>searchCriteria</em> dados en el buzón actual<tr><td><a href=#selectbox><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><br>selecciona el buzón <em>name</em> como buzón actual<tr><td><a href=#subscribe><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</a><br>permite añadir el buzón especificado al conjunto de buzones "suscritos" del servidor IMAP<tr><td><a href=#unsubscribe><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</a><br>elimina un buzón de un conjunto de buzones suscritos<tr><td><a href=#user><strong>.user</strong> : Text</a><br> el nombre de usuario utilizado para la autenticación en el servidor de correo</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=imap-new-transporter>IMAP New transporter<a href=#imap-new-transporter class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>IMAP New transporter</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Información del servidor de correo<tr><td>Result<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#objeto-imap-transporter>Objeto transportador IMAP</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción>Descripción<a href=#descripción class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>El comando <code>IMAP New transporter</code> configura una nueva conexión IMAP según el parámetro <em>server</em> y devuelve un nuevo objeto <em>transporter</em>. El objeto transportador devuelto se utilizará normalmente para recibir correos electrónicos.</p>
<p>En el parámetro <em>server</em>, pase un objeto que contenga las siguientes propiedades:</p>

















































<table><thead><tr><th><em>server</em><th>Valor por defecto (si se omite)<tbody><tr><td><a href=#acceptunsecureconnection><strong>.acceptUnsecureConnection</strong> : Boolean</a><br><strong>True</strong> si se autoriza a 4D establecer una conexión no cifrada<td>False<tr><td>.<strong>accessTokenOAuth2</strong>: Text<br>.<strong>accessTokenOAuth2</strong>: Object<br>Cadena u objeto token que representa las credenciales de autorización OAuth2. Utilizado sólo con OAUTH2 <code>authationMode</code>. Si se utiliza <code>accessTokenOAuth2</code> pero se omite <code>authenticationMode</code>, se utiliza el protocolo OAuth 2 (si el servidor lo permite). No se devuelve en el objeto <em><a href=#imap-transporter-object>IMAP transporter</a></em>.<td>ninguno<tr><td><a href=#authenticationmode><strong>.authenticationMode</strong> : Text</a><br>el modo de autenticación utilizado para abrir la sesión en el servidor de correo<td>se utiliza el modo de autenticación más seguro soportado por el servidor<tr><td><a href=#checkconnectiondelay><strong>.checkConnectionDelay</strong> : Integer</a><br>el tiempo máximo (en segundos) permitido antes de verificar la conexión con el servidor<td>300<tr><td><a href=#connectiontimeout><strong>.connectionTimeOut</strong> : Integer</a><br>el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor<td>30<tr><td><a href=#host><strong>.host</strong> : Text</a><br>el nombre o la dirección IP del servidor local<td><em>obligatorio</em><tr><td><a href=#logfile><strong>.logFile</strong> : Text</a><br>la ruta del archivo de registro extendido definido (si existe) para la conexión de correo<td>ninguno<tr><td>.<strong>password</strong> : Text<br>contraseña de usuario para la autenticación en el servidor. No se devuelve en el objeto <em><a href=#imap-transporter-object>IMAP transporter</a></em>.<td>ninguno<tr><td><a href=#port><strong>.port</strong> : Integer</a><br> el número de puerto utilizado para las transacciones de correo<td>993<tr><td><a href=#user><strong>.user</strong> : Text</a><br> el nombre de usuario utilizado para la autenticación en el servidor de correo<td>ninguno</table>
<blockquote>
<p><strong>Atención</strong>: asegúrese de que el tiempo de espera definido sea menor que el tiempo de espera del servidor, de lo contrario el tiempo de espera del cliente será inútil.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result>Result<a href=#result class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función devuelve un <a href=#object-imap-transporter><strong>objeto transportador IMAP</strong></a>. Todas las propiedades devueltas son de sólo lectura**.</p>
<blockquote>
<p>La conexión IMAP se cierra automáticamente cuando se destruye el objeto transportador.</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo>Ejemplo<a href=#ejemplo class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$server.logFile:="LogTest.txt" //log a guardar en la carpeta Logs</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.checkConnection()</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(Not($status.success))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("An error occurred: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4dimaptransporternew>4D.IMAPTransporter.new()<a href=#4dimaptransporternew class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> : Object ) : 4D.IMAPTransporter</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>server<td>Object<td style=text-align:center>-><td>Información del servidor de correo<tr><td>Result<td>4D.IMAPTransporter<td style=text-align:center>&lt;-<td><a href=#objeto-imap-transporter>Objeto transportador IMAP</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-1>Descripción<a href=#descripción-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>4D.IMAPTransporter.new()</code> crea y devuelve un nuevo objeto de tipo <code>4D.IMAPTransporter</code>. Es idéntico al comando <a href=#imap-new-transporter><code>IMAP New transporter</code></a> (acceso directo).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=acceptunsecureconnection>.acceptUnsecureConnection<a href=#acceptunsecureconnection class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.acceptUnsecureConnection</strong> : Boolean</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-2>Descripción<a href=#descripción-2 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.acceptUnsecureConnection</code> contiene <strong>True</strong> si se autoriza a 4D establecer una conexión no cifrada cuando la conexión cifrada no es posible.</p>
<p>Contiene <strong>False</strong> si no se permiten las conexiones no cifradas, en cuyo caso se devuelve un error cuando no es posible la conexión cifrada.</p>
<p>Los puertos seguros disponibles son:</p>
<ul>
<li>
<p>SMTP</p>
<ul>
<li>465: SMTPS</li>
<li>587 o 25: SMTP con actualización STARTTLS si lo soporta el servidor.</li>
</ul>
</li>
<li>
<p>IMAP</p>
<ul>
<li>143: Puerto IMAP no encriptado</li>
<li>993: IMAP con actualización STARTTLS si lo soporta el servidor</li>
</ul>
</li>
<li>
<p>POP3</p>
<ul>
<li>110: Puerto POP3 no encriptado</li>
<li>995: POP3 con actualización STARTTLS si lo soporta el servidor.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=addflags>.addFlags()<a href=#addflags class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>20<td>Soporta palabras claves personalizadas<tr><td>18 R6<td>Añadidos</table>
</div></div></details>
<p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.addFlags</strong>( <em>msgIDs</em> : Longint  ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgIDs<td>Collection<td style=text-align:center>-><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado<tr><td>keywords<td>Object<td style=text-align:center>-><td>Banderas de palabras claves a añadir<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación addFlags</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-3>Descripción<a href=#descripción-3 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.addFlags()</code> agrega banderas a los <code>msgIDs</code> para las <code>keywords</code> especificadas.</p>
<p>En el parámetro <code>msgIDs</code>, puedes pasar:</p>
<ul>
<li>una <em>colección</em> que contiene los IDs únicos de mensajes específicos o</li>
<li>el ID único (<em>text</em>) de un solo mensaje o</li>
<li>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</li>
</ul>















<table><thead><tr><th>Constante<th>Valor<th>Comentario<tbody><tr><td>IMAP all<td>1<td>Seleccionar todos los mensajes del buzón seleccionado</table>
<p>El parámetro <code>keywords</code> permite definir las banderas a añadir a <code>msgIDs</code>. Puede utilizar las siguientes banderas estándar, así como banderas personalizadas (la compatibilidad con banderas personalizadas depende de la implementación del servidor):</p>








































<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>$draft<td>Boolean<td>True para añadir el marcador "draft" al mensaje<tr><td>$seen<td>Boolean<td>True para añadir el marcador "seen" al mensaje<tr><td>$flagged<td>Boolean<td>True para añadir el marcador "flagged" al mensaje<tr><td>$answered<td>Boolean<td>True para añadir el marcador "answered" al mensaje<tr><td>$deleted<td>Boolean<td>True para añadir el marcador "deleted" al mensaje<tr><td><code>&lt;custom flag></code><td>Boolean<td>True para añadir la bandera personalizada al mensaje</table>
<p>Los nombres de las banderas personalizadas deben respetar esta regla: la palabra clave debe ser una cadena que no distinga entre mayúsculas y minúsculas, excluyendo los caracteres de control y el espacio, y no puede incluir ninguno de estos caracteres: <code>( ) { ] % * " \</code></p>
<blockquote>
<ul>
<li>Para que una palabra clave se tenga en cuenta tiene que ser true.</li>
<li>La interpretación de los indicadores de palabras claves puede variar según el cliente de correo.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-1>Ejemplo<a href=#ejemplo-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Seleccionar buzón de correo</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Marcar todos los mensajes de INBOX como leídos/vistos</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.addFlags(IMAP all;$flags)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=append>.append()<a href=#append class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R6<td>Añadidos</table>
</div></div></details>
<p><strong>.append</strong>( <em>mailObj</em> : Object ; <em>destinationBox</em> : Text ; <em>options</em> : Object ) : Object</p>



































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>mailObj<td>Object<td style=text-align:center>-><td>Objeto Email<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Buzón para recibir el objeto Email<tr><td>options<td>Object<td style=text-align:center>-><td>Objeto que contiene información del charset<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-4>Descripción<a href=#descripción-4 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.append()</code> añade un <code>mailObj</code> al <code>destinationBox</code>.</p>
<p>En el parámetro <code>mailObj</code>, pase un objeto email. Para obtener una descripción completa de las propiedades del correo, consulte <a href=/docs/es/20-R6/API/EmailObjectClass#objeto-email>objeto Email</a>. La función <code>.append()</code> soporta los marcadores de palabras claves en el atributo <code>keywords</code> de objetos Email.</p>
<p>El parámetro opcional <code>destinationBox</code> permite pasar el nombre de un buzón donde se añadirá el objeto <code>mailObj</code>. Si se omite, se utiliza el buzón actual.</p>
<p>En el parámetro opcional <code>options</code>, puede pasar un objeto para definir el conjunto de caracteres y la codificación para partes específicas del correo electrónico. Propiedades disponibles:</p>




















<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>headerCharset<td>Text<td>Charset y codificación utilizados para las siguientes partes del correo electrónico: asunto, nombres de archivos adjuntos y atributo(s) del nombre del correo electrónico. Valores posibles: ver la tabla de charsets posibles a continuación<tr><td>bodyCharset<td>Text<td>Charset y codificación utilizados para el contenido html y el texto del cuerpo del correo electrónico. Valores posibles: ver la tabla de charsets posibles a continuación</table>
<p>Charsets posibles:</p>






























<table><thead><tr><th>Constante<th>Valor<th>Comentario<tbody><tr><td>mail mode ISO2022JP<td>US-ASCII_ISO-2022-JP_UTF8_QP<td><ul><li>headerCharset: US-ASCII si es posible, Japanese (ISO-2022-JP) &Quoted-printable si es posible, de lo contrario UTF-8 & Quoted-printable<li>bodyCharset: US-ASCII si es posible, Japanese (ISO-2022-JP) & 7-bit si es posible, de lo contrario UTF-8 & Quoted-printable</ul><tr><td>mail mode ISO88591<td>ISO-8859-1<td><ul><li>headerCharset: ISO-8859-1 & Quoted-printable<li>bodyCharset: ISO-8859-1 & 8-bit</ul><tr><td>mail mode UTF8<td>US-ASCII_UTF8_QP<td>headerCharset & bodyCharset: US-ASCII si es posible, de lo contrario UTF-8 & Quoted-printable (<strong>valor por defecto</strong>)<tr><td>mail mode UTF8 in base64<td>US-ASCII_UTF8_B64<td>headerCharset & bodyCharset: US-ASCII si es posible, de lo contrario UTF-8 & base64</table>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-2>Ejemplo<a href=#ejemplo-2 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para guardar un correo electrónico en el buzón de borradores:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $settings; $status; $msg; $imap: Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$settings:=New object("host"; "domain.com"; "user"; "xxxx"; "password"; "xxxx"; "port"; 993)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$imap:=IMAP New transporter($settings)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.from:="xxxx@domain.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.subject:="Lorem Ipsum"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.textBody:="Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$seen"]:=True//flag the message as read</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$msg.keywords["$draft"]:=True//flag the message as a draft</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$imap.append($msg; "Drafts")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=authenticationmode>.authenticationMode<a href=#authenticationmode class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.authenticationMode</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-5>Descripción<a href=#descripción-5 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.authenticationMode</code> contiene el modo de autenticación utilizado para abrir la sesión en el servidor de correo.</p>
<p>Por defecto, se utiliza el modo más seguro soportado por el servidor.</p>
<p>Los valores posibles son:</p>






























<table><thead><tr><th>Valor<th>Constantes<th>Comentario<tbody><tr><td>CRAM-MD5<td><code>IMAP authentication CRAM MD5</code><td>Autenticación utilizando el protocolo CRAM-MD5<tr><td>LOGIN<td><code>IMAP authentication login</code><td>Autenticación utilizando el protocolo LOGIN<tr><td>OAUTH2<td><code>IMAP authentication OAUTH2</code><td>Autenticación utilizando el protocolo OAuth2<tr><td>PLAIN<td><code>IMAP authentication plain</code><td>Autenticación utilizando el protocolo PLAIN</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnection>.checkConnection()<a href=#checkconnection class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.checkConnection()</strong> : Object</p>

















<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la conexión del objeto transportador</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-6>Descripción<a href=#descripción-6 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.checkConnection()</code>  comprueba la conexión utilizando la información almacenada en el objeto transporter, recrea la conexión si es necesario y devuelve el estado. Esta función permite verificar que los valores proporcionados por el usuario son válidos y coherentes.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=objeto-devuelto>Objeto devuelto<a href=#objeto-devuelto class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función envía una solicitud al servidor de correo y devuelve un objeto que describe el estado del correo. Este objeto puede contener las siguientes propiedades:</p>





















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>boolean<td>True si la verificación es exitosa, False en caso contrario<tr><td>status<td><td>number<td>(sólo SMTP) Código de estado devuelto por el servidor de correo (0 en caso de un problema no relacionado con el procesamiento del correo)<tr><td>statusText<td><td>text<td>Mensaje de estado devuelto por el servidor de correo, o último error devuelto en la pila de errores de 4D<tr><td>errors<td><td>collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor de correo)<tr><td><td>[ ].errCode<td>number<td>Código de error 4D<tr><td><td>[ ].message<td>text<td>Descripción del error 4D<tr><td><td>[ ].componentSignature<td>text<td>Firma del componente interno que ha devuelto el error</table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=checkconnectiondelay>.checkConnectionDelay<a href=#checkconnectiondelay class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.checkConnectionDelay</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-7>Descripción<a href=#descripción-7 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.checkConnectionDelay</code> contiene el tiempo máximo (en segundos) permitido antes de verificar la conexión con el servidor.  Si se supera este tiempo entre dos llamadas al método, se comprobará la conexión con el servidor. Por defecto, si la propiedad no se ha definido en el objeto <em>server</em>, el valor es de 300.</p>
<blockquote>
<p><strong>Atención</strong>: asegúrese de que el tiempo de espera definido sea menor que el tiempo de espera del servidor, de lo contrario el tiempo de espera del cliente será inútil.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=connectiontimeout>.connectionTimeOut<a href=#connectiontimeout class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.connectionTimeOut</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-8>Descripción<a href=#descripción-8 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.connectionTimeOut</code> contiene el tiempo máximo de espera (en segundos) permitido para establecer una conexión con el servidor. Por defecto, si la propiedad no se ha definido en el objeto servidor (utilizado para crear el objeto transportador con <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, o <code>IMAP New transporter</code>), el valor es 30.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=copy>.copy()<a href=#copy class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.copy</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Colección de identificadores únicos de mensajes (cadenas)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: todos los mensajes en el buzón seleccionado<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Buzón para recibir mensajes copiados<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación de copia</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-9>Descripción<a href=#descripción-9 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.copy()</code> copia los mensajes definidos por <em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em> en el servidor IMAP.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección que contiene los IDs únicos de los mensajes específicos a copiar, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para copiar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>El parámetro <em>destinationBox</em> permite pasar un valor texto con el nombre del buzón donde se colocarán las copias de los mensajes.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-1-1>Ejemplo 1<a href=#ejemplo-1-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para copiar una selección de mensajes:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener la colección de IDs únicos de los mensajes</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copiar los mensajes encontrados en el buzón "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy($mailIds;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-2-1>Ejemplo 2<a href=#ejemplo-2-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para copiar todos los mensajes del buzón actual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // copiar los mensajes encontrados en el buzón "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.copy(IMAP all;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=createbox>.createBox()<a href=#createbox class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>19<td>Añadidos</table>
</div></div></details>
<p><strong>.createBox</strong>( <em>name</em> :  Text ) : Object</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del nuevo buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación de creación del buzón</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-10>Descripción<a href=#descripción-10 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.createBox()</code> crea un buzón con el nombre dado. Si el caracter separador de jerarquía del servidor IMAP aparece en otra parte del nombre del buzón, el servidor IMAP creará todos los nombre padre necesarios para crear el buzón dado.</p>
<p>En otras palabras, un intento de crear "Projects/IMAP/Doc" en un servidor en el que "/" es el carácter separador de jerarquía creará:</p>
<ul>
<li>Sólo el buzón "Doc" si "Projects" & "IMAP" ya existen.</li>
<li>Los buzones "IMAP" & "Doc" si sólo existe "Projects".</li>
<li>Los buzones "Projects" & "IMAP" & "Doc", si no existen.</li>
</ul>
<p>En el parámetro <code>name</code>, pase el nombre del nuevo buzón.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-3>Ejemplo<a href=#ejemplo-3 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para crear un nuevo buzón "Invoices":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.createBox("Invoices")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("Mailbox creation successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=delete>.delete()<a href=#delete class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) : Object<br><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Colección de identificadores únicos de mensajes (cadenas)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: todos los mensajes en el buzón seleccionado<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación de eliminación</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-11>Descripción<a href=#descripción-11 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.delete()</code> define el marcador "deleted" para los mensajes definidos en <code>msgsIDs</code> o <code>allMsgs</code>.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <code>msgsIDs</code>, una colección contiene los IDs únicos de los mensajes específicos a eliminar, o</li>
<li>en el parámetro <code>allMsgs</code>, la constante <code>IMAP all</code> (entero) para borrar todos los mensajes en el buzón de correo seleccionado.</li>
</ul>
<p>La ejecución de esta función no elimina realmente los mensajes. Los mensajes con el marcador "delete" pueden seguir siendo encontrados por la función <a href=#searchmails>.searchMails()</a>. Los mensajes marcados se eliminan del servidor IMAP con la <a href=#expunge>función <code>.expunge()</code></a> o al seleccionar otro buzón o cuando el <a href=#imap-transporter-object>objeto transporter</a> (creado con <a href=#imap-new-transporter>IMAP New transporter</a>) es destruido.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-1-2>Ejemplo 1<a href=#ejemplo-1-2 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para eliminar una selección de mensajes:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener la colección de IDs únicos de los mensajes</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"Reports\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // Borrar los mensajes seleccionados</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-2-2>Ejemplo 2<a href=#ejemplo-2-2 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para eliminar todos los mensajes del buzón actual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Junk Email")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // Borrar los mensajes seleccionados en el buzón actual</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete(IMAP all)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=deletebox>.deleteBox()<a href=#deletebox class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>19<td>Añadidos</table>
</div></div></details>
<p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del buzón a eliminar<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación de eliminación del buzón</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-12>Descripción<a href=#descripción-12 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.deleteBox()</code> elimina permanentemente el buzón de correo con el <code>name</code> dado del servidor IMAP. Intentar eliminar un INBOX o un buzón que no existe generará un error.</p>
<p>En el parámetro <code>name</code>, pase el nombre del buzón a eliminar.</p>
<blockquote>
<ul>
<li>La función no puede eliminar un buzón que tiene buzones hijos si el buzón padre tiene el atributo "\Noselect".</li>
<li>Todos los mensajes del buzón eliminado también se borrarán.</li>
<li>La posibilidad de eliminar un buzón depende del servidor de correo.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-4>Ejemplo<a href=#ejemplo-4 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para eliminar el buzón secundario "Nova Orion Industries" del interior del buzón "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// eliminar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Nova Orion Industries"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.deleteBox($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("Mailbox deletion successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=expunge>.expunge()<a href=#expunge class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R6<td>Añadidos</table>
</div></div></details>
<p><strong>.expunge()</strong> : Object</p>

















<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación expunge</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-13>Descripción<a href=#descripción-13 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.expunge()</code> elimina todos los mensajes con el marcador "deleted" del servidor de correo IMAP. El marcador "deleted" puede definirse con los métodos <a href=#delete><code>delete()</code></a> o <a href=#addflags><code>addFlags()</code></a>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-5>Ejemplo<a href=#ejemplo-5 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $ids : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Buscar y eliminar todos los mensajes vistos en INBOX</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$ids:=$transporter.searchMails("SEEN")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.delete($ids)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Purgar todos los mensajes marcados como borrados</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.expunge()</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxinfo>.getBoxInfo()<a href=#getboxinfo class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>





















<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>20<td>*se devuelve el <em>id</em><tr><td>18 R5<td><em>name</em> es opcional<tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) : Object</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>objeto boxInfo</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-14>Descripción<a href=#descripción-14 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getBoxInfo()</code> devuelve un objeto <code>boxInfo</code> correspondiente al buzón de correo actual o el buzón de correo <em>name</em>. Esta función devuelve la misma información que <a href=#selectbox><code>.selectBox()</code></a> sin cambiar el buzón actual.</p>
<p>En el parámetro opcional <em>name</em>, pase el nombre del buzón a acceder. El nombre representa una jerarquía inequívoca de izquierda a derecha, con niveles separados por un carácter delimitador específico. El delimitador se puede encontrar con la función <a href=#getdelimiter><code>.getDelimiter()</code></a>.</p>
<p>Si el buzón <em>name</em> no es seleccionable o no existe, la función genera un error y devuelve <strong>null</strong>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>






























<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>name<td>text<td>Nombre del buzón<tr><td>mailCount<td>number<td>Número de mensajes en el buzón<tr><td>mailRecent<td>number<td>Número de mensajes con el marcador "reciente" (que indica los mensajes nuevos)<tr><td>id<td>text<td>Id. único del buzón</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-6>Ejemplo<a href=#ejemplo-6 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $info:=$transporter.getBoxInfo("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALERT("INBOX contains "+String($info.mailRecent)+" recent emails.")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getboxlist>.getBoxList()<a href=#getboxlist class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos<tr><td>19<td>Añadir parámetro <code>isSubscribed</code></table>
</div></div></details>
<p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ) : Collection</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>parameters<td>Object<td style=text-align:center>-><td>Objeto de parámetro<tr><td>Result<td>Collection<td style=text-align:center>&lt;-<td>Colección de objetos mailbox</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-15>Descripción<a href=#descripción-15 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getBoxList()</code> devuelve una colección de bandejas de entrada que describe todas las bandejas de entrada disponibles. Esta función permite gestionar localmente la lista de mensajes localizados en el servidor de correo IMAP.</p>
<p>En el parámetro opcional <code>parameters</code>, pase un objeto que contenga valores para filtrar los buzones devueltos. Puede pasar:</p>















<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>isSubscribed<td>Boolean<td><li><strong>True</strong> para devolver sólo los buzones a los que se haya suscrito</li><li> <strong>False</strong> para devolver todos los buzones disponibles</li></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-1>Result<a href=#result-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Cada objeto de la colección devuelta contiene las siguientes propiedades:</p>






























<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>[].name<td>text<td>Nombre del buzón<tr><td>[].selectable<td>boolean<td>Indica si los derechos de acceso permiten o no seleccionar el buzón: <ul><li>true - el buzón puede ser seleccionado<li>false - el buzón no puede ser seleccionado</ul><tr><td>[].inferior<td>boolean<td>Indica si los derechos de acceso permiten o no crear una jerarquía inferior en el buzón: <ul><li>true - se puede crear un nivel inferior<li>false - no se puede crear un nivel inferior</ul><tr><td>[].interesting<td>boolean<td>Indica si el buzón ha sido marcado como "interesante" por el servidor: <ul><li>true - El buzón ha sido marcado como "interesante" por el servidor. Por ejemplo, puede contener nuevos mensajes.<li>false - El buzón no ha sido marcado como "interesante" por el servidor.</ul></table>
<p>Si la cuenta no contiene buzones, se devuelve una colección vacía.</p>
<blockquote>
<ul>
<li>Si no hay ninguna conexión abierta, <code>.getBoxList()</code> abrirá una conexión.</li>
<li>Si la conexión no ha sido utilizada desde el retraso de conexión designado (ver <code>IMAP New transporter</code>), la función <code>.checkConnection()</code> se llama automáticamente.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-7>Ejemplo<a href=#ejemplo-7 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getdelimiter>.getDelimiter()<a href=#getdelimiter class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.getDelimiter()</strong> : Text</p>

















<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>Result<td>Text<td style=text-align:center>&lt;-<td>Caracter delimitador de jerarquía</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-16>Descripción<a href=#descripción-16 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getDelimiter()</code> devuelve el caracter utilizado para delimitar niveles de jerarquía en el nombre del buzón.</p>
<p>El delimitador es un carácter que puede utilizarse para:</p>
<ul>
<li>crear buzones de nivel inferior</li>
<li>buscar más arriba o más abajo en la jerarquía del buzón</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-2>Result<a href=#result-2 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Caracter delimitador del nombre del buzón.</p>
<blockquote>
<ul>
<li>Si no hay ninguna conexión abierta, <code>.getDelimiter()</code> abrirá una conexión.</li>
<li>Si la conexión no se ha utilizado desde la <a href=#checkconnectiondelay>duración máxima definida</a>, se llama automáticamente a la función <a href=#checkconnection><code>.checkConnection()</code></a>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-8>Ejemplo<a href=#ejemplo-8 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxList:=$transporter.getBoxList()</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> For each($box;$boxList)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If($box.interesting)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       $split:=Split string($box.name;$transporter.getDelimiter())</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       ALERT("New emails are available in the box: "+$split[$split.length-1])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End for each</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmail>.getMail()<a href=#getmail class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) : Object<br><strong>.getMail</strong>( <em>msgID</em>: Text { ; <em>options</em> : Object } ) : Object</p>



































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Número de secuencia del mensaje<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID único del mensaje<tr><td>options<td>Object<td style=text-align:center>-><td>Instrucciones sobre la gestión de mensajes<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td><a href=/docs/es/20-R6/API/EmailObjectClass#objet-email>Objet Email</a></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-17>Descripción<a href=#descripción-17 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getMail()</code> devuelve el objeto <code>Email</code> correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code>. Esta función permite recuperar la información sobre el email.</p>
<p>En el primer parámetro, puede pasar:</p>
<ul>
<li><em>msgNumber</em>, un valor <em>integer</em> indicando el número de secuencia del mensaje a recuperar o</li>
<li><em>msgID</em>, un valor <em>text</em> indicando el ID único del mensaje a recuperar.</li>
</ul>
<p>El parámetro opcional <em>options</em> permite pasar un objeto que define las instrucciones adicionales para la gestión del mensaje. Las siguientes propiedades están disponibles:</p>




















<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>updateSeen<td>boolean<td>Si True, el mensaje se marca como "visto" en el buzón. Si es False, el mensaje no se marca como "visto". Valor por defecto: True<tr><td>withBody<td>boolean<td>Pase True para devolver el cuerpo del mensaje. Si es False, sólo se devuelve el encabezado del mensaje. Valor por defecto: True</table>
<blockquote>
<ul>
<li>La función genera un error y devuelve <strong>Null</strong> si <em>msgID</em> designa un mensaje inexistente,</li>
<li>Si no se selecciona ningún buzón con la función <a href=#selectbox><code>.selectBox()</code></a>, se genera un error,</li>
<li>Si no hay ninguna conexión abierta, <code>.getMail()</code> abrirá una conexión el último buzón especificado con <a href=#selectbox><code>.selectBox()</code></a>`.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-3>Result<a href=#result-3 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p><code>.getMail()</code> devuelve un objeto <a href=/docs/es/20-R6/API/EmailObjectClass#email-object><code>Email</code></a> con las siguientes propiedades IMAP específicas: <em>id</em>, <em>receivedAt</em>, y <em>size</em>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-9>Ejemplo<a href=#ejemplo-9 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Quiere obtener el mensaje con ID = 1:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $info; $mail; $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener el objeto Email con ID 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mail:=$transporter.getMail(1)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmails>.getMails()<a href=#getmails class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.getMails</strong>( <em>ids</em> : Collection { ; <em>options</em> : Object } ) : Object<br><strong>.getMails</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer { ; <em>options</em> : Object } ) : Object</p>









































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>ids<td>Collection<td style=text-align:center>-><td>Colección de identificadores de mensajes<tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Número de secuencia del primer mensaje<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Número de secuencia del último mensaje<tr><td>options<td>Object<td style=text-align:center>-><td>Instrucciones sobre la gestión de mensajes<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Objeto que contiene<br><ul><li>una colección de <a href=/docs/es/20-R6/API/EmailObjectClass#email-object>objetos Email</a> y<li>una colección de IDs o de números para los mensajes que faltan, si los hay</ul></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-18>Descripción<a href=#descripción-18 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getMails()</code> devuelve un objeto que contiene una colección de objetos <code>Email</code>.</p>
<p><strong>Primera sintaxis:</strong></p>
<p><em><strong>.getMails( ids { ; options } ) -> result</strong></em></p>
<p>La primera sintaxis permite recuperar los mensajes en función de sus identificadores.</p>
<p>En el parámetro <em>ids</em>, pase una colección de IDs para los mensajes a devolver. Puedes obtener los IDs con <a href=#getmail><code>.getMail()</code></a>.</p>
<p>El parámetro opcional <em>options</em> permite definir las partes de los mensajes a devolver. Consulte la tabla <strong>Options</strong> a continuación para obtener una descripción de las propiedades disponibles.</p>
<p><strong>Segunda sintaxis:</strong></p>
<p><em><strong>.getMails( startMsg ; endMsg { ; options } ) -> result</strong></em></p>
<p>La segunda sintaxis permite recuperar los mensajes en función de un rango secuencial. Los valores pasados representan la posición de los mensajes en el buzón.</p>
<p>En el parámetro <em>startMsg</em>, pase un valor <em>entero</em> correspondiente al número del primer mensaje en un rango secuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;= 0), se utilizará el primer mensaje del buzón como inicio de la secuencia.</p>
<p>En el parámetro <em>endMsg</em>, pase un valor <em>entero</em> correspondiente al número del último mensaje que se incluirá en un rango secuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;= 0), se utilizará el último mensaje del buzón como fin de secuencia.</p>
<p>El parámetro opcional <em>options</em> permite definir las partes de los mensajes a devolver.</p>
<p><strong>Options</strong></p>




















<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>updateSeen<td>Boolean<td>Si True, los mensajes especificados se marcan como "vistos" en el buzón. Si False, los mensajes no se marcan como "vistos". Valor por defecto: True<tr><td>withBody<td>Boolean<td>Pase True para devolver el cuerpo de los mensajes específicos. Si False, sólo se devuelve los encabezados de los mensajes. Valor por defecto: True</table>
<blockquote>
<ul>
<li>Si no se selecciona ningún buzón con el comando <a href=#selectbox><code>.selectBox()</code></a>, se genera un error.</li>
<li>Si no hay ninguna conexión abierta, <code>.getMails()</code> abrirá una conexión el último buzón especificado con <a href=#selectbox><code>.selectBox()</code></a>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-4>Result<a href=#result-4 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p><code>.getMails()</code> devuelve un objeto que contiene las siguientes colecciones:</p>




















<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>lista<td>Collection<td>Colección de <a href=/docs/es/20-R6/API/EmailObjectClass#objeto-email><code>objetos Email</code></a>. Si no se encuentran objetos Email, se devuelve una colección vacía.<tr><td>notFound<td>Collection<td>Colección de:<br><ul><li>primera sintaxis - IDs de mensajes previamente pasados que no existen<li>segunda sintaxis - números de secuencia de mensajes entre startMsg y endMsg que no existen</ul>Si se encuentran todos los mensajes, se devuelve una colección vacía.</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-10>Ejemplo<a href=#ejemplo-10 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Quiere recuperar los 20 correos electrónicos más recientes sin cambiar el estado "visto":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server,$boxInfo,$result : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  $boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  If($boxInfo.mailCount>0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // recuperar los encabezados de los últimos 20 mensajes sin marcarlos como leídos</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    $result:=$transporter.getMails($boxInfo.mailCount-20;$boxInfo.mailCount;\</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        New object("withBody";False;"updateSeen";False))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    For each($mail;$result.list)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      // ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End for each</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=getmimeasblob>.getMIMEAsBlob()<a href=#getmimeasblob class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ) : Blob<br><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ; <em>updateSeen</em> : Boolean } ) : Blob</p>



































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgNumber<td>Integer<td style=text-align:center>-><td>Número de secuencia del mensaje<tr><td>msgID<td>Text<td style=text-align:center>-><td>ID único del mensaje<tr><td>updateSeen<td>Boolean<td style=text-align:center>-><td>Si True, el mensaje se marca como "visto" en el buzón. Si False, el mensaje se deja igual.<tr><td>Result<td>BLOB<td style=text-align:center>&lt;-<td>Blob de la cadena MIME devuelta por el servidor de correo</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-19>Descripción<a href=#descripción-19 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.getMIMEAsBlob()</code> devuelve un BLOB con el contenido MIME del mensaje correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzón designado por el <code>IMAP_transporter</code>.</p>
<p>En el primer parámetro, puede pasar:</p>
<ul>
<li><em>msgNumber</em>, un valor <em>integer</em> indicando el número de secuencia del mensaje a recuperar o</li>
<li><em>msgID</em>, un valor <em>text</em> indicando el ID único del mensaje a recuperar.</li>
</ul>
<p>El parámetro opcional <em>updateSeen</em> permite indicar si el mensaje está marcado como "visto" en el buzón. Puede pasar:</p>
<ul>
<li><strong>True</strong> - para marcar el mensaje como "visto" (indicando que el mensaje ha sido leído)</li>
<li><strong>False</strong> - para dejar intacto el estado "visto" del mensaje</li>
</ul>
<blockquote>
<ul>
<li>La función devuelve un BLOB vacío si <em>msgNumber</em> o msgID* designa un mensaje inexistente,</li>
<li>Si no se selecciona ningún buzón con el comando <a href=#selectbox><code>.selectBox()</code></a>, se genera un error,</li>
<li>Si no hay ninguna conexión abierta, <code>.getMIMEAsBlob()</code> abrirá una conexión el último buzón especificado con <code>.selectBox()</code>.</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-5>Result<a href=#result-5 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p><code>.getMIMEAsBlob()</code> devuelve un <code>BLOB</code> que puede almacenarse en una base de datos o convertirse en un objeto <a href=/docs/es/20-R6/API/EmailObjectClass#email-object><code>Email</code></a> con el comando <code>MAIL Convert from MIME</code>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-11>Ejemplo<a href=#ejemplo-11 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $boxInfo : Variant</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $blob : Blob</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("Inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener BLOB</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $blob:=$transporter.getMIMEAsBlob(1)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=host>.host<a href=#host class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.host</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-20>Descripción<a href=#descripción-20 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.host</code> contiene el nombre o la dirección IP del servidor local. Se utiliza para las transacciones de correo (SMTP, POP3, IMAP).</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=logfile>.logFile<a href=#logfile class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.logFile</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-21>Descripción<a href=#descripción-21 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.logFile</code> contiene la ruta del archivo de registro extendido definido (si existe) para la conexión de correo. Puede ser relativo (a la carpeta actual Logs) o absoluto.</p>
<p>A diferencia de los archivos log habituales (activados mediante el comando <code>SET DATABASE PARAMETER</code>), los archivos log extendidos almacenan el contenido MIME de todos los correos enviados y no tienen límite de tamaño. Para más información sobre los archivos de registro extendidos, consulte:</p>
<ul>
<li><strong>SMTP connections</strong> - <a href=/docs/es/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DSMTPLog.txt</a></li>
<li><strong>POP3 connections</strong> - <a href=/docs/es/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DPOP3Log.txt</a></li>
<li><strong>IMAP connections</strong> - <a href=/docs/es/20-R6/Debugging/debugLogFiles#4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt>4DIMAPLog.txt</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=move>.move()<a href=#move class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.move</strong>( <em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) : Object<br><strong>.move</strong>( <em>allMsgs</em> : Integer ; <em>destinationBox</em> : Text ) : Object</p>



































<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgsIDs<td>Collection<td style=text-align:center>-><td>Colección de identificadores únicos de mensajes (cadenas)<tr><td>allMsgs<td>Integer<td style=text-align:center>-><td><code>IMAP all</code>: todos los mensajes en el buzón seleccionado<tr><td>destinationBox<td>Text<td style=text-align:center>-><td>Buzón para recibir los mensajes desplazados<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación de desplazamiento</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-22>Descripción<a href=#descripción-22 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.move()</code> mueve los mensajes definidos por <em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em> del servidor IMAP.</p>
<p>Puede pasar:</p>
<ul>
<li>en el parámetro <em>msgsIDs</em>, una colección contiene los IDs únicos de los mensajes específicos a mover, o</li>
<li>en el parámetro <em>allMsgs</em>, la constante <code>IMAP all</code> (entero) para desplazar todos los mensajes del buzón seleccionado.</li>
</ul>
<p>El parámetro <em>destinationBox</em> permite pasar un valor texto con el nombre del buzón donde los mensajes serán desplazados.</p>
<blockquote>
<p>Esta función sólo es compatible con los servidores IMAP que cumplen la RFC <a href=https://tools.ietf.org/html/rfc8474 target=_blank rel="noopener noreferrer">8474</a>.</p>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-1-3>Ejemplo 1<a href=#ejemplo-1-3 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para mover una selección de mensajes:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener la colección de IDs únicos de los mensajes</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.searchMails("subject \"4D new feature:\"")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // Mover los mensajes encontrados del buzón actual al buzón "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move($mailIds;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-2-3>Ejemplo 2<a href=#ejemplo-2-3 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para mover todos los mensajes del buzón actual:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // mover todos los mensajes del buzón actual al buzón "documents"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.move(IMAP all;"documents")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=numtoid>.numToID()<a href=#numtoid class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.numToID</strong>( <em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) : Collection</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>startMsg<td>Integer<td style=text-align:center>-><td>Número de secuencia del primer mensaje<tr><td>endMsg<td>Integer<td style=text-align:center>-><td>Número de secuencia del último mensaje<tr><td>Result<td>Collection<td style=text-align:center>&lt;-<td>Colección de identificadores de mensajes únicos</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-23>Descripción<a href=#descripción-23 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.numToID()</code> convierte los números de secuencia en IDs únicos IMAP para los mensajes en el rango secuencial designado por <em>startMsg</em> y <em>endMsg</em> en el buzón actualmente seleccionado.</p>
<p>En el parámetro <em>startMsg</em>, pase un valor entero correspondiente al número del primer mensaje en un rango secuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;= 0), se utilizará el primer mensaje del buzón como inicio de la secuencia.</p>
<p>En el parámetro <em>endMsg</em>, pase un valor entero correspondiente al número del último mensaje que se incluirá en un rango secuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;= 0), se utilizará el último mensaje del buzón como fin de secuencia.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=result-6>Result<a href=#result-6 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función devuelve una colección de cadenas (IDs únicos).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-12>Ejemplo<a href=#ejemplo-12 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $server;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $mailIds : Collection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Obligatorio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("inbox")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //obtener los ID de los 5 últimos mensajes recibidos</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $mailIds:=$transporter.numToID(($boxInfo.mailCount-5);$boxInfo.mailCount)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //eliminar los mensajes del buzón actual</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $status:=$transporter.delete($mailIds)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=removeflags>.removeFlags()<a href=#removeflags class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>20<td>Soporta palabras claves personalizadas<tr><td>18 R6<td>Añadidos</table>
</div></div></details>
<p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ; <em>keywords</em> :  Object ) : Object<br><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ; <em>keywords</em> :  Object ) : Object</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>msgIDs<td>Collection<td style=text-align:center>-><td>Colección de cadenas: identificadores únicos de mensajes (texto)<br>Texto: ID único de un mensaje<br>Longint (IMAP all): todos los mensajes del buzón seleccionado<tr><td>keywords<td>Object<td style=text-align:center>-><td>Banderas de palabras claves a eliminar<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación removeFlags</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-24>Descripción<a href=#descripción-24 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.removeFlags()</code> elimina las banderas de los <code>msgIDs</code> para las <code>keywords</code> especificadas.</p>
<p>En el parámetro <code>msgIDs</code>, puedes pasar:</p>
<ul>
<li>una <em>colección</em> que contiene los IDs únicos de mensajes específicos o</li>
<li>el ID único (<em>text</em>) de un solo mensaje o</li>
<li>la siguiente constante (<em>longint</em>) para todos los mensajes del buzón seleccionado:</li>
</ul>















<table><thead><tr><th>Constante<th>Valor<th>Comentario<tbody><tr><td>IMAP all<td>1<td>Seleccionar todos los mensajes del buzón seleccionado</table>
<p>El parámetro <code>keywords</code> permite definir las banderas a eliminar de <code>msgIDs</code>. Puede utilizar las siguientes banderas estándar, así como banderas personalizadas:</p>








































<table><thead><tr><th>Parámetros<th>Tipo<th>Descripción<tbody><tr><td>$draft<td>Boolean<td>True para eliminar el marcador "draft" del mensaje<tr><td>$seen<td>Boolean<td>True para eliminar el marcador "seen" del mensaje<tr><td>$flagged<td>Boolean<td>True para eliminar el marcador "flagged" del mensaje<tr><td>$answered<td>Boolean<td>True para eliminar el marcador "answered" del mensaje<tr><td>$deleted<td>Boolean<td>True para eliminar el marcador "deleted" del mensaje<tr><td><code>&lt;custom flag></code><td>Boolean<td>True para eliminar la bandera personalizada del mensaje</table>
<p>Consulte <a href=#addflags>.addFlags()</a> para obtener más información sobre las banderas personalizadas.</p>
<blockquote>
<ul>
<li>Para que una palabra clave se tenga en cuenta tiene que ser true.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-13>Ejemplo<a href=#ejemplo-13 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $options;$transporter;$boxInfo;$status : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.port:=993</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:="xxxxx"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Crear transportador</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Seleccionar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$boxInfo:=$transporter.selectBox("INBOX")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// Marcar todos los mensajes de INBOX como no vistos</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$flags["$seen"]:=True</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.removeFlags(IMAP all;$flags)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=renamebox>.renameBox()<a href=#renamebox class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>19<td>Añadidos</table>
</div></div></details>
<p><strong>.renameBox</strong>( <em>currentName</em> : Text ; <em>newName</em> : Text ) : Object</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>currentName<td>Text<td style=text-align:center>-><td>Nombre del nuevo actual<tr><td>newName<td>Text<td style=text-align:center>-><td>Nuevo nombre del buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación renombrar</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-25>Descripción<a href=#descripción-25 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.renameBox()</code> cambia el nombre de un buzón en el servidor IMAP. Si se intenta renombrar un buzón desde un nombre de buzón que no existe o a un nombre de buzón que ya existe, se generará un error.</p>
<p>En el parámetro <code>currentName</code>, pase el nombre del buzón a renombrar.</p>
<p>Pase el nuevo nombre del buzón en el parámetro <code>newName</code>.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-14>Ejemplo<a href=#ejemplo-14 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para cambiar el nombre de su buzón de "Invoices" a "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=Nuevo objeto</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Por favor, introduzca su contraseña:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// renombrar buzón</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.renameBox("Facturas"; "Facturas")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("¡Cambio de nombre de buzón correcto!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=port>.port<a href=#port class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.port</strong> : Integer</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-26>Descripción<a href=#descripción-26 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.port</code> contiene  el número de puerto utilizado para las transacciones de correo. Por defecto, si la propiedad <em>port</em> no se ha definido en el objeto <em>server</em> (utilizado para crear el objeto transportador con <code>SMTP New transporter</code>, <code>POP3 New transporter</code>, <code>IMAP New transporter</code>), el puerto utilizado es:</p>
<ul>
<li><strong>SMTP</strong> - 587</li>
<li><strong>POP3</strong> - 995</li>
<li><strong>IMAP</strong> - 993</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=searchmails>.searchMails()<a href=#searchmails class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>18 R5<td>Añadidos</table>
</div></div></details>
<p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ) : Collection</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>searchCriteria<td>Text<td style=text-align:center>-><td>Criterio de búsqueda<tr><td>Result<td>Collection<td style=text-align:center>&lt;-<td>Colección de números de mensajes</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-27>Descripción<a href=#descripción-27 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<blockquote>
<p>Esta función se basa en la especificación del <a href=https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol target=_blank rel="noopener noreferrer">protocolo IMAP</a>.</p>
</blockquote>
<p>La función <code>.searchMails()</code> busca los mensajes que coincidan con los criterios de búsqueda <em>searchCriteria</em> dados en el buzón actual. <em>searchCriteria</em> consiste en una o más llaves de búsqueda.</p>
<p><em>searchCriteria</em> es un parámetro texto que enumera una o varias llaves de búsqueda (ver <a href=#authorized-search-keys>llaves de búsqueda autorizadas</a> abajo) asociadas o no a valores a buscar. Una llave de búsqueda puede ser uno o varios elementos. Por ejemplo:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">SearchKey1 = FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey2 = NOT FLAGGED</span><br></span><span class=token-line style=color:#393A34><span class="token plain">SearchKey3 = FLAGGED DRAFT</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<blockquote>
<p>Para obtener la información de un buzón sin cambiar el buzón actual, utilice <a href=#getboxinfo><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<ul>
<li>Si el <em>searchCriteria</em> es una cadena null, la búsqueda será equivalente a un "seleccionar todo".</li>
<li>Si <em>searchCriteria</em> incluye varias llaves de búsqueda, el resultado es la intersección (función AND) de todos los mensajes que coinciden con esas llaves.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = FLAGGED FROM "SMITH"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... devuelve todos los mensajes con el marcador \Flagged AND activado y enviados por Smith.</p>
<ul>
<li>Puede utilizar los operadores <strong>OR</strong> o <strong>NOT</strong> de la siguiente manera:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = OR SEEN FLAGGED</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... devuelve todos los mensajes con el marcador \Seen O \Flagged</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = NOT SEEN</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... devuelve todos los mensajes con el marcador \Seen.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... devuelve los mensajes cuyo encabezado content-type contiene "Mixed" y no contiene "Text".</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... devuelve los mensajes cuyo encabezado content-type contiene " e " y cuyo encabezado Subject no contiene " o " y cuyo encabezado content-type no es " Mixed ".</p>
<p>En cuanto a los dos últimos ejemplos, observe que el resultado de la búsqueda es diferente cuando se eliminan los paréntesis de la primera lista de llaves de búsqueda.</p>
<ul>
<li>El parámetro <em>searchCriteria</em> puede incluir opcionalmente la instrucción [CHARSET]. Esta instrucción consiste en la palabra "CHARSET" seguida de un conjunto de caracteres definido [CHARSET] (US ASCII, ISO-8859). Indica el conjunto de caracteres de la cadena <em>searchCriteria</em>. Por lo tanto, debe convertir la cadena <em>searchCriteria</em> al conjunto de caracteres especificado si utiliza la instrucción [CHARSET] (consulte los comandos <code>CONVERT FROM TEXT</code> o <code>Convert to text</code>).
Por defecto, 4D codifica la cadena de criterios searchCriteria en Quotable Printable si contiene los caracteres extendidos.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">searchCriteria = CHARSET "ISO-8859" BODY "Help"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>... significa que los criterios de búsqueda utilizan el conjunto de caracteres iso-8859 y el servidor tendrá que convertir los criterios de búsqueda antes de buscar, si es necesario.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=tipos-de-valores-de-búsqueda>Tipos de valores de búsqueda<a href=#tipos-de-valores-de-búsqueda class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Las claves de búsqueda pueden solicitar el valor a buscar:</p>
<ul>
<li>
<p><strong>Valores de tipo fecha</strong>: los valores de tipo fecha se colocan en cadenas con el siguiente formato: <em>date-day+"-"+date-month+"-"+date-year</em> donde date-day indica la fecha del día del mes (2 caracteres como máximo), date-month indica el mes (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) y date-year indica el año (4 dígitos).
Ejemplo: <code>searchCriteria = SENTBEFORE 1-Feb-2020</code> (una fecha no suele necesitar comillas, ya que no contiene caracteres especiales)</p>
</li>
<li>
<p><strong>Valores de tipo cadena</strong>: la cadena puede contener cualquier caracter y debe ir entre comillas. Si la cadena no contiene ningún caracter especial, como el espacio, por ejemplo, no es necesario colocarla entre comillas. Al colocar entre comillas estas cadenas se garantiza que su valor se interpretará correctamente.
Ejemplo: <code>searchCriteria = FROM "SMITH"</code>
Para todas las llaves de búsqueda que utilizan cadenas, un mensaje coincide con la llave si la cadena es una subcadena del campo. Las coincidencias no diferencian entre mayúsculas y minúsculas.</p>
</li>
<li>
<p><strong>Llaves de búsqueda con un valor nombres de campo</strong>: los valores de tipo nombre de campo contienen el nombre de un campo de encabezado.
Ejemplo: <code>searchCriteria = HEADER CONTENT-TYPE "MIXED"</code></p>
</li>
<li>
<p><strong>Llaves de búsqueda con marcadores</strong>: los valores de tipo marcador (flags) aceptan una o varias palabras claves (incluyendo marcadores estándar) separados por espacios.
Ejemplo: <code>searchCriteria = KEYWORD \Flagged \Draft</code></p>
</li>
<li>
<p><strong>Llaves de búsqueda con un valor de conjunto de mensajes</strong>: identifica un conjunto de mensajes. En el caso de los números de secuencia de los mensajes, se trata de números consecutivos desde el 1 hasta el número total de mensajes en el buzón. Los números son separados por coma; un dos puntos (:) delimita entre dos números inclusive.
Ejemplos:
<code>2,4:7,9,12:*</code> es <code>2,4,5,6,7,9,12,13,14,15</code> para un buzón con 15 mensajes.
<code>searchCriteria = 1:5 ANSWERED</code> busca en la selección de mensajes 1 a 5, los mensajes que tienen el marcador \Answered.
<code>searchCriteria= 2,4 ANSWERED</code> busca en la selección de mensajes (números de mensaje 2 y 4) los mensajes que tienen el indicador \Answered activado.</p>
</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=teclas-de-búsqueda-disponibles>Teclas de búsqueda disponibles<a href=#teclas-de-búsqueda-disponibles class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p><strong>ALL</strong>: todos los mensajes en el buzón.<br>
<strong>ANSWERED</strong>: mensajes con el indicador \Answered activado.<br>
<strong>UNANSWERED</strong>: mensajes que no tienen el indicador \Answered activo.<br>
<strong>DELETED</strong>: mensajes con el indicador \Deleted activado.<br>
<strong>UNDELETED</strong>: mensajes que no tienen el indicador \Deleted activado.<br>
<strong>DRAFT</strong>: mensajes con el indicador \Draft activado.<br>
<strong>UNDRAFT</strong>: mensajes que no tienen el indicador \Draft activado.<br>
<strong>FLAGGED</strong>: mensajes con el indicador \Flagged activado.<br>
<strong>UNFLAGGED</strong>: mensajes que no tienen el indicador \Flagged activado.<br>
<strong>RECENT</strong>: mensajes que tienen el indicador \Recent activado.<br>
<strong>OLD</strong>: mensajes que no tienen el indicador \Recent activado.<br>
<strong>SEEN</strong>: mensajes que tienen el indicador \Seen activo.<br>
<strong>UNSEEN</strong>: mensajes que no tienen el indicador \Seen activo.<br>
<strong>NEW</strong>: mensajes que tienen el indicador \Recent activado pero no el indicador \Seen. Esto es funcionalmente equivalente a “(RECENT UNSEEN)”.<br>
<strong>KEYWORD <em>flag</em></strong>: mensajes con el conjunto de palabras clave especificado.<br>
<strong>UNKEYWORD <em>flag</em></strong>: mensajes que no tienen la palabra clave especificada.<br>
<strong>BEFORE <em>date</em></strong>: mensajes cuya fecha interna es anterior a la fecha especificada.<br>
<strong>ON <em>date</em></strong>: mensajes cuya fecha interna está dentro de la fecha especificada.<br>
<strong>SINCE <em>date</em></strong>: mensajes cuya fecha interna es anterior o posterior a la fecha especificada.<br>
<strong>SENTBEFORE <em>date</em></strong>: mensajes cuyo encabezado Date es anterior a la fecha especificada.<br>
<strong>SENTON <em>date</em></strong>: mensajes cuyo encabezado Date está dentro de la fecha especificada.<br>
<strong>SENTSINCE <em>date</em></strong>: mensajes cuyo encabezado Date está dentro o posterior a la fecha especificada.<br>
<strong>TO <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado TO.<br>
<strong>FROM <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado FROM.<br>
<strong>CC <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado CC.<br>
<strong>BCC <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado BCC.<br>
<strong>SUBJECT <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado Asunto.<br>
<strong>BODY <em>string</em></strong>: mensajes que contienen la cadena especificada en el cuerpo del mensaje.<br>
<strong>TEXT <em>string</em></strong>: mensajes que contienen la cadena especificada en el encabezado o en el cuerpo del mensaje.<br>
<strong>HEADER <em>field-name</em> <em>string</em></strong>: mensajes que tienen un encabezado con el nombre de campo especificado y que contiene la cadena especificada en el field-body.<br>
<strong>UID <em>message-UID</em></strong>: mensajes con identificadores únicos correspondientes al conjunto de identificadores únicos especificados.<br>
<strong>LARGER <em>n</em></strong>: mensajes con un tamaño superior al número de bytes especificado.<br>
<strong>SMALLER <em>n</em></strong>: mensajes con un tamaño menor que el número especificado de bytes.<br>
<strong>NOT <em>search-key</em></strong>: mensajes que no coinciden con la llave de búsqueda especificada.<br>
<strong>OR <em>search-key1</em> <em>search-key2</em></strong>: mensajes que corresponden con cualquiera de las palabras clave de búsqueda.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=selectbox>.selectBox()<a href=#selectbox class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>

















<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>20<td><em>id</em>, <em>flags</em>, <em>permanentFlags</em> se devuelven<tr><td>18 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.selectBox</strong>( <em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</p>





























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del buzón<tr><td>state<td>Integer<td style=text-align:center>-><td>Estado de acceso al buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>objeto boxInfo</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-28>Descripción<a href=#descripción-28 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.selectBox()</code> selecciona el buzón <em>name</em> como buzón actual. Esta función permite recuperar la información sobre el buzón.</p>
<blockquote>
<p>Para obtener la información de un buzón sin cambiar el buzón actual, utilice <a href=#getboxinfo><code>.getBoxInfo()</code></a>.</p>
</blockquote>
<p>En el parámetro <em>name</em>, pase el nombre del buzón a acceder. El nombre representa una jerarquía inequívoca de izquierda a derecha, con niveles separados por un carácter delimitador específico. El delimitador se puede encontrar con la función <a href=#getdelimiter><code>.getDelimiter()</code></a>.</p>
<p>El parámetro opcional <em>state</em> define el tipo de acceso al buzón. Los valores posibles son:</p>




















<table><thead><tr><th>Constante<th>Valor<th>Comentario<tbody><tr><td>IMAP read only state<td>1<td>Se accede al buzón seleccionado con privilegios de sólo lectura. Los mensajes con la bandera "reciente" (que indica que son nuevos) no se modifican.<tr><td>IMAP read write state<td>0<td>Se accede al buzón seleccionado con privilegios de lectura y escritura. Los mensajes se consideran "vistos" y pierden la bandera "reciente" (que indica que son mensajes nuevos). Default value:</table>
<blockquote>
<ul>
<li>La función genera un error y devuelve <strong>Null</strong> si <em>name</em> designa un buzón inexistente.</li>
<li>Si no hay ninguna conexión abierta, <code>.selectBox()</code> abrirá una conexión.</li>
<li>Si la conexión no ha sido usada desde la demora de conexión designada (ver <code>IMAP New transporter</code>), la función <a href=#checkconnection><code>.checkConnection()</code></a> es llamada automáticamente.</li>
</ul>
</blockquote>
<p><strong>Objeto devuelto</strong></p>
<p>El objeto <code>boxInfo</code> devuelto contiene las siguientes propiedades:</p>








































<table><thead><tr><th>Propiedad<th>Tipo<th>Descripción<tbody><tr><td>name<td>Text<td>Nombre del buzón<tr><td>mailCount<td>number<td>Número de mensajes en el buzón<tr><td>mailRecent<td>number<td>Número de mensajes con la bandera "recent"<tr><td>id<td>text<td>Id. único del buzón<tr><td>flags<td>text<td>Lista de banderas utilizadas actualmente para el buzón, separadas por espacios<tr><td>permanentFlags<td>text<td>Lista de banderas que el cliente puede cambiar permanentemente (excepto el indicador \Recent, que gestiona el servidor IMAP), separados por espacios</table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p>Si la cadena <code>permanentFlags</code> incluye la bandera especial *, significa que el servidor soporta <a href=#addflags>banderas personalizadas</a>.</div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-15>Ejemplo<a href=#ejemplo-15 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> var $server; $boxinfo : Object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.host:="imap.gmail.com" //Mandatory</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.user:="4d@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $server.password:="XXXXXXXX"</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> var $transporter : 4D.IMAPTransporter</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $transporter:=IMAP New transporter($server)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $boxInfo:=$transporter.selectBox("INBOX")</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=subscribe>.subscribe()<a href=#subscribe class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>19<td>Añadidos</table>
</div></div></details>
<p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación subscribe</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-29>Descripción<a href=#descripción-29 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.subscribe()</code> permite añadir el buzón especificado al conjunto de buzones "suscritos" del servidor IMAP. De este modo, puede optar por acotar una gran lista de buzones disponibles suscribiéndose a los que habitualmente consulta.</p>
<p>En el parámetro <code>name</code>, pase el nombre del buzón a añadir (suscribir) a sus buzones "suscritos".</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-16>Ejemplo<a href=#ejemplo-16 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para suscribirse al buzón "Atlas Corp" en la jerarquía "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.subscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox subscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=unsubscribe>.unsubscribe()<a href=#unsubscribe class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>19<td>Añadidos</table>
</div></div></details>
<p><strong>.unsubscribe</strong>( <em>name</em> : Text ) : Object</p>























<table><thead><tr><th>Parámetros<th>Tipo<th style=text-align:center><th>Descripción<tbody><tr><td>name<td>Text<td style=text-align:center>-><td>Nombre del buzón<tr><td>Result<td>Object<td style=text-align:center>&lt;-<td>Estado de la operación unsubscribe</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-30>Descripción<a href=#descripción-30 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La función <code>.unsubscribe()</code> elimina un buzón de un conjunto de buzones suscritos. Esto le permite reducir el número de buzones que suele ver.</p>
<p>En el parámetro <code>name</code>, pase el nombre del buzón a eliminar (darse de baja) de sus buzones activos.</p>
<p><strong>Objeto devuelto</strong></p>
<p>La función devuelve un objeto que describe el estado IMAP:</p>















































<table><thead><tr><th>Propiedad<th><th>Tipo<th>Descripción<tbody><tr><td>success<td><td>Boolean<td>True si la operación tiene éxito, False en caso contrario<tr><td>statusText<td><td>Text<td>Mensaje de estado devuelto por el servidor IMAP, o último error devuelto en la pila de errores 4D<tr><td>errors<td><td>Collection<td>Pila de errores 4D (no se devuelve si se recibe una respuesta del servidor IMAP)<tr><td><td>[].errcode<td>Number<td>Código de error 4D<tr><td><td>[].message<td>Text<td>Descripción del error 4D<tr><td><td>[].componentSignature<td>Text<td>Firma del componente interno que ha devuelto el error</table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-17>Ejemplo<a href=#ejemplo-17 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Para desuscribirse del buzón "Atlas Corp" en la jerarquía "Bills":</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">var $pw; $name : text</span><br></span><span class=token-line style=color:#393A34><span class="token plain">var $options; $transporter; $status : object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options:=New object</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$pw:=Request("Please enter your password:")</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If(OK=1) $options.host:="imap.gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.user:="test@gmail.com"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$options.password:=$pw</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$transporter:=IMAP New transporter($options)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$name:="Bills"+$transporter.getDelimiter()+"Atlas Corp"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">$status:=$transporter.unsubscribe($name)</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If ($status.success)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Mailbox unsubscription successful!")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   ALERT("Error: "+$status.statusText)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">End if</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=user>.user<a href=#user class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed=true><summary>Historia</summary><div><div class=collapsibleContent_i85q>













<table><thead><tr><th>Lanzamiento<th>Modificaciones<tbody><tr><td>17 R4<td>Añadidos</table>
</div></div></details>
<p><strong>.user</strong> : Text</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción-31>Descripción<a href=#descripción-31 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>La propiedad <code>.user</code> contiene  el nombre de usuario utilizado para la autenticación en el servidor de correo.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20API%2FIMAPTransporterClass.md%20(20-R6)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Comente esta página</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navegación de páginas de documentos"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/es/20-R6/API/HTTPRequestClass><div class=pagination-nav__sublabel>Anterior</div><div class=pagination-nav__label>HTTPRequest</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/es/20-R6/API/MailAttachmentClass><div class=pagination-nav__sublabel>Siguiente</div><div class=pagination-nav__label>MailAttachment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#objeto-imap-transporter class="table-of-contents__link toc-highlight">Objeto IMAP Transporter</a><li><a href=#imap-new-transporter class="table-of-contents__link toc-highlight">IMAP New transporter</a><li><a href=#4dimaptransporternew class="table-of-contents__link toc-highlight">4D.IMAPTransporter.new()</a><li><a href=#acceptunsecureconnection class="table-of-contents__link toc-highlight">.acceptUnsecureConnection</a><li><a href=#addflags class="table-of-contents__link toc-highlight">.addFlags()</a><li><a href=#append class="table-of-contents__link toc-highlight">.append()</a><li><a href=#authenticationmode class="table-of-contents__link toc-highlight">.authenticationMode</a><li><a href=#checkconnection class="table-of-contents__link toc-highlight">.checkConnection()</a><li><a href=#checkconnectiondelay class="table-of-contents__link toc-highlight">.checkConnectionDelay</a><li><a href=#connectiontimeout class="table-of-contents__link toc-highlight">.connectionTimeOut</a><li><a href=#copy class="table-of-contents__link toc-highlight">.copy()</a><li><a href=#createbox class="table-of-contents__link toc-highlight">.createBox()</a><li><a href=#delete class="table-of-contents__link toc-highlight">.delete()</a><li><a href=#deletebox class="table-of-contents__link toc-highlight">.deleteBox()</a><li><a href=#expunge class="table-of-contents__link toc-highlight">.expunge()</a><li><a href=#getboxinfo class="table-of-contents__link toc-highlight">.getBoxInfo()</a><li><a href=#getboxlist class="table-of-contents__link toc-highlight">.getBoxList()</a><li><a href=#getdelimiter class="table-of-contents__link toc-highlight">.getDelimiter()</a><li><a href=#getmail class="table-of-contents__link toc-highlight">.getMail()</a><li><a href=#getmails class="table-of-contents__link toc-highlight">.getMails()</a><li><a href=#getmimeasblob class="table-of-contents__link toc-highlight">.getMIMEAsBlob()</a><li><a href=#host class="table-of-contents__link toc-highlight">.host</a><li><a href=#logfile class="table-of-contents__link toc-highlight">.logFile</a><li><a href=#move class="table-of-contents__link toc-highlight">.move()</a><li><a href=#numtoid class="table-of-contents__link toc-highlight">.numToID()</a><li><a href=#removeflags class="table-of-contents__link toc-highlight">.removeFlags()</a><li><a href=#renamebox class="table-of-contents__link toc-highlight">.renameBox()</a><li><a href=#port class="table-of-contents__link toc-highlight">.port</a><li><a href=#searchmails class="table-of-contents__link toc-highlight">.searchMails()</a><li><a href=#selectbox class="table-of-contents__link toc-highlight">.selectBox()</a><li><a href=#subscribe class="table-of-contents__link toc-highlight">.subscribe()</a><li><a href=#unsubscribe class="table-of-contents__link toc-highlight">.unsubscribe()</a><li><a href=#user class="table-of-contents__link toc-highlight">.user</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Comunidad</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://developer.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Centro de desarrollo 4D</a><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://twitter.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="col footer__col"><div class=footer__title>Soporte</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (Donde todo empezó)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Base de conocimientos</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>Descargas<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>Obtener soporte<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Empresa</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>Acerca de 4D<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>Contáctenos<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>4D en el mundo<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Careers<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>2024 4D SAS - Todos los derechos reservados</div></div></div></footer></div>