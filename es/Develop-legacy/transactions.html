<!doctype html><html lang=es dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-20-R10 docs-doc-page docs-doc-id-Develop-legacy/transactions" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Transactions | 4D Docs</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://developer.4d.com/docs/es/Develop-legacy/transactions><meta data-rh=true property=og:locale content=es><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true property=og:locale:alternate content=pt><meta data-rh=true name=docusaurus_locale content=es><meta data-rh=true name=docsearch:language content=es><meta data-rh=true name=docusaurus_version content=20-R10><meta data-rh=true name=docusaurus_tag content=docs-default-20-R10><meta data-rh=true name=docsearch:version content=20-R10><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-20-R10><meta data-rh=true property=og:title content="Transactions | 4D Docs"><meta data-rh=true name=description content=Descripción><meta data-rh=true property=og:description content=Descripción><link data-rh=true rel=icon href=/docs/es/img/favicon/4d.gif><link data-rh=true rel=canonical href=https://developer.4d.com/docs/es/Develop-legacy/transactions><link data-rh=true rel=alternate href=https://developer.4d.com/docs/Develop-legacy/transactions hreflang=en><link data-rh=true rel=alternate href=https://developer.4d.com/docs/fr/Develop-legacy/transactions hreflang=fr><link data-rh=true rel=alternate href=https://developer.4d.com/docs/es/Develop-legacy/transactions hreflang=es><link data-rh=true rel=alternate href=https://developer.4d.com/docs/ja/Develop-legacy/transactions hreflang=ja><link data-rh=true rel=alternate href=https://developer.4d.com/docs/pt/Develop-legacy/transactions hreflang=pt><link data-rh=true rel=alternate href=https://developer.4d.com/docs/Develop-legacy/transactions hreflang=x-default><link data-rh=true rel=preconnect href=https://OJ04C0M3CU-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="4D Docs" href=/docs/es/opensearch.xml><link rel=stylesheet href=/docs/es/assets/css/styles.1ba35a04.css><script src=/docs/es/assets/js/main.5d6b5d42.js defer></script><script src=/docs/es/assets/js/runtime~main.11508c94.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Saltar al contenido principal"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Saltar al contenido principal</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label="Alternar la barra de navegación" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/docs/es/><div class=navbar__logo><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Documentación 4D</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/es/Develop-legacy/transactions>20 R10 BETA</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/es/Develop-legacy/transactions>20 R10 BETA</a><li><a class=dropdown__link href=/docs/es/20-R9/GettingStarted/installation>20 R9</a><li><a class=dropdown__link href=/docs/es/20/GettingStarted/installation>20</a><li><a class=dropdown__link href=/docs/es/19/GettingStarted/installation>19</a><li><a class=dropdown__link href=/docs/es/18/GettingStarted/installation>18</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Español</a><ul class=dropdown__menu><li><a href=/docs/Develop-legacy/transactions rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/docs/fr/Develop-legacy/transactions rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/docs/es/Develop-legacy/transactions rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=es>Español</a><li><a href=/docs/ja/Develop-legacy/transactions rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a><li><a href=/docs/pt/Develop-legacy/transactions rel="noopener noreferrer" class=dropdown__link lang=pt>Português</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Cambia entre el modo oscuro y el claro (actualmente modo Claro)" aria-label="Cambia entre el modo oscuro y el claro (actualmente modo Claro)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Buscar (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Buscar</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Volver arriba" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/docs/es/><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/docs/es/img/logohome.png alt="Logo 4D" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Documentación 4D</b></a><nav aria-label="Barra lateral de Documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/category/getting-started>Comencemos</a><button aria-label="Ampliar la categoría 'Comencemos' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/es/category/core-development>Desarrollo</a><button aria-label="Contraer categoría de la barra lateral 'Desarrollo'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/es/Project/overview>Gestión del proyecto</a><button aria-label="Ampliar la categoría 'Gestión del proyecto' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/es/Project/code-overview>Entorno de desarrollo</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/es/ORDA/overview>ORDA</a><button aria-label="Ampliar la categoría 'ORDA' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/es/Develop/processes>Procesos</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/es/Develop-legacy/transactions>Transactions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/es/Tags/transformation-tags>Etiquetas de transformación</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/category/4d-language>Lenguaje 4D</a><button aria-label="Ampliar la categoría 'Lenguaje 4D' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/category/administration>Administración</a><button aria-label="Ampliar la categoría 'Administración' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/Extensions/overview>Extensiones</a><button aria-label="Ampliar la categoría 'Extensiones' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/category/web-applications>Aplicaciones web</a><button aria-label="Ampliar la categoría 'Aplicaciones web' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/es/category/desktop-applications>Aplicaciones de escritorio</a><button aria-label="Ampliar la categoría 'Aplicaciones de escritorio' de la barra lateral" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a href=https://developer.4d.com/go-mobile/ target=_blank rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false>Aplicaciones móviles</a></div></ul></nav><button type=button title="Contraer la barra lateral" aria-label="Contraer la barra lateral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Camino de navegación"><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Página de inicio" class=breadcrumbs__link href=/docs/es/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/es/category/core-development><span itemprop=name>Desarrollo</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Transactions</span><meta itemprop=position content=2></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Versión: 20 R10 BETA</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">En esta página</button></div><div class="theme-doc-markdown markdown"><header><h1>Transactions</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=descripción>Descripción<a href=#descripción class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<p>Las transacciones son una serie de modificaciones de datos relacionadas que se realizan en una base de datos o almacén de datos dentro de un <a href=/docs/es/Develop-legacy/processes.md>proceso</a>. Una transacción no se guarda en una base de datos de forma permanente hasta que se valida la transacción. Si una transacción no se completa, ya sea porque se cancela o por algún evento externo, las modificaciones no se guardan.</p>
<p>Durante una transacción, todos los cambios realizados en los datos de la base de datos dentro de un proceso se almacenan localmente en un buffer temporal. Si la transacción se acepta con <a href=/docs/es/commands/validate-transaction><code>VALIDATE TRANSACTION</code></a> o <a href=/docs/es/API/DataStoreClass#validatetransaction><code>validateTransaction()</code></a>, los cambios se guardan permanentemente. Si la transacción se cancela con <a href=/docs/es/commands/cancel-transaction><code>CANCEL TRANSACTION</code></a> o <a href=/docs/es/API/DataStoreClass#canceltransaction><code>cancelTransaction()</code></a>, los cambios no se guardan. En todos los casos, ni la selección actual ni el registro actual son modificados por los comandos de gestión de transacciones.</p>
<p>4D soporta transacciones anidadas, es decir, transacciones en varios niveles jerárquicos. El número de subtransacciones permitidas es ilimitado. El comando <a href=/docs/es/commands/transaction-level><code>Transaction level</code></a> puede utilizarse para averiguar el nivel de transacción actual en el que se ejecuta el código. Cuando se utilizan transacciones anidadas, el resultado de cada subtransacción depende de la validación o cancelación de la transacción de nivel superior. Si se valida la transacción de nivel superior, se confirman los resultados de las subtransacciones (validación o cancelación). Por el contrario, si se anula la operación de nivel superior, se anulan todas las suboperaciones, independientemente de sus respectivos resultados.</p>
<p>4D incluye una funcionalidad que le permite <a href=#suspending-transactions>suspender y resumir transacciones</a> dentro de su código 4D. Cuando una transacción está suspendida, puede ejecutar operaciones independientemente de la transacción misma y luego reanudar la transacción para validarla o cancelarla como de costumbre.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo>Ejemplo<a href=#ejemplo class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h3>
<p>En este ejemplo, la base de datos es un simple sistema de facturación. Las líneas de factura se almacenan en una tabla llamada [Invoice Lines], que está relacionada con la tabla [Invoices] mediante una relación entre los campos [Invoices]Invoice ID y [Invoice Lines]Invoice ID. Cuando se añade una factura, se calcula un ID único, utilizando el comando <a href=/docs/es/commands/sequence-number><code>Sequence number</code></a>. La relación entre [Invoices] e [Invoice Lines] es una relación automática Relate Many. La casilla <strong>Asignar automáticamente valor relacionado en subformulario</strong> está marcada.</p>
<p>La relación entre [Invoice Lines] y [Parts] es manual.</p>
<p><img decoding=async loading=lazy src=/docs/es/assets/images/transactions-structure-c214a6d4a24718af8586b4af126d02bd.png width=489 height=259 class=img_ev3q></p>
<p>Cuando un usuario introduce una factura, se ejecutan las siguientes acciones:</p>
<ul>
<li>Añadir un registro en la tabla [Invoices].</li>
<li>Añadir varios registros en la tabla [Invoice Lines].</li>
<li>Actualizar el campo [Parts]In Warehouse de cada parte listada en la factura.</li>
</ul>
<p>Este ejemplo es una situación típica en la que necesita utilizar una transacción. Debe estar seguro de que podrá guardar todos estos registros durante la operación o de que podrá cancelar la transacción si no se puede añadir o actualizar un registro. En otras palabras, debe guardar los datos relacionados. Si no utiliza una transacción, no podrá garantizar la integridad lógica de los datos de su base de datos. Por ejemplo, si uno de los registros de [Parts] está bloqueado, no podrá actualizar la cantidad almacenada en el campo [Parts]In Warehouse. Por lo tanto, este campo será lógicamente incorrecto. La suma de las piezas vendidas y las piezas que quedan en el almacén no será igual a la cantidad original introducida en el registro. Puede evitar esta situación utilizando transacciones.</p>
<p>Existen varias formas de realizar la introducción de datos utilizando transacciones:</p>
<ol>
<li>Puede gestionar las transacciones usted mismo utilizando los comandos de transacción <a href=/docs/es/commands/start-transaction><code>START TRANSACTION</code></a>, <a href=/docs/es/commands/validate-transaction><code>VALIDATE TRANSACTION</code></a> y <a href=/docs/es/commands/cancel-transaction><code>CANCEL TRANSACTION</code></a>. Puede escribir, por ejemplo:</li>
</ol>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> READ WRITE([Invoice Lines])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> READ WRITE([Parts])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> FORM SET INPUT([Invoices];"Input")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Repeat</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    START TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ADD RECORD([Invoices])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       VALIDATE TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       CANCEL TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Until(OK=0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> READ ONLY(*)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ol start=2>
<li>Para reducir el bloqueo de registros mientras se realiza la entrada de datos, también puede optar por gestionar las transacciones desde el método del formulario y acceder a las tablas en <code>READ WRITE</code> sólo cuando sea necesario. La entrada de datos se realiza mediante el formulario de entrada de [Invoices], que contiene la tabla relacionada [Invoice Lines] en un subformulario. El formulario tiene dos botones: <em>bCancel</em> y <em>bOK</em>, ue no son botones de acción.</li>
</ol>
<p>El bucle de adición se convierte en:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> READ WRITE([Invoice Lines])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> READ ONLY([Parts])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> FORM SET INPUT([Invoices];"Input")</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Repeat</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ADD RECORD([Invoices])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> Until(bOK=0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> READ ONLY([Invoice Lines])</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Tenga en cuenta que la tabla [Parts] está ahora en modo de acceso de sólo lectura durante la entrada de datos. El acceso de lectura/escritura sólo estará disponible si se valida la entrada de datos.</p>
<p>La transacción se inicia en el método del formulario de entrada [Invoices] que se indica a continuación:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> Case of</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    :(Form event code=On Load)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       START TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       [Invoices]Invoice ID:=Sequence number([Invoices]Invoice ID)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       [Invoices]Total Invoice:=Sum([Invoice Lines]Total line)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End case</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Si hace clic en el botón <em>bCancel</em>, e cancelará tanto la entrada de datos como la transacción. Este es el método objeto del botón <em>bCancel</em>:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> Case of</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    :(Form event code=On Clicked)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       CANCEL TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       CANCEL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End case</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Si hace clic en el botón <em>bOK</em>, la entrada de datos debe ser aceptada y la transacción debe ser validada. Este es el método objeto del botón <em>bOK</em>:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain"> Case of</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    :(Form event code=On Clicked)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       var $NbLines:=Records in selection([Invoice Lines])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       READ WRITE([Parts]) //Switch to Read/Write access for the [Parts] table</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       FIRST RECORD([Invoice Lines]) //Start at the first line</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       var $ValidTrans:=True //Assume everything will be OK</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       var $Line : Integer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       For($Line;1;$NbLines) //For each line</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          RELATE ONE([Invoice Lines]Part No)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          OK:=1 //Assume you want to continue</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          While(Locked([Parts]) & (OK=1)) //Try getting the record in Read/Write access</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             CONFIRM("The Part "+[Invoice Lines]Part No+" is in use. Wait?")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                DELAY PROCESS(Current process;60)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                LOAD RECORD([Parts])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          End while</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          If(OK=1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">               //Update quantity in the warehouse</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             [Parts]In Warehouse:=[Parts]In Warehouse-[Invoice Lines]Quantity</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             SAVE RECORD([Parts]) //Save the record</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             $Line:=$NbLines+1 //Leave the loop</span><br></span><span class=token-line style=color:#393A34><span class="token plain">             $ValidTrans:=False</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          NEXT RECORD([Invoice Lines]) //Go next line</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       End for</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       READ ONLY([Parts]) //Set the table state to read only</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       If($ValidTrans)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          SAVE RECORD([Invoices]) //Save the Invoices record</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          VALIDATE TRANSACTION //Validate all database modifications</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       Else</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          CANCEL TRANSACTION //Cancel everything</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       CANCEL //Salir del formulario</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End case</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>En este código, llamamos al comando <code>CANCEL</code> independientemente del botón pulsado. El nuevo registro no se valida mediante una llamada a <a href=/docs/es/commands/accept><code>ACCEPT</code></a>, sino mediante el comando <a href=/docs/es/commands/save-record><code>SAVE RECORD</code></a>. Además, tenga en cuenta que <code>SAVE RECORD</code> se ejecuta justo antes del comando <a href=/docs/es/commands/validate-transaction><code>VALIDATE TRANSACTION</code></a>. Por lo tanto, guardar el registro [Invoices] es en realidad una parte de la transacción. El comando  <code>ACCEPT</code> también validaría el registro, pero en este caso la transacción se validaría antes de guardar el registro [Invoices]. En otras palabras, el registro se guardaría fuera de la transacción.</p>
<p>Dependiendo de sus necesidades, puede personalizar su base de datos, como se muestra en estos ejemplos. En el último ejemplo, la gestión de registros bloqueados en la tabla [Parts] podría desarrollarse aún más.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=suspender-transacciones>Suspender transacciones<a href=#suspender-transacciones class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=principio>Principio<a href=#principio class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h3>
<p>Suspender una transacción es útil cuando necesita realizar, desde dentro de una transacción, ciertas operaciones que no necesitan ser ejecutadas bajo el control de esta transacción. Por ejemplo, imagine el caso en el que un cliente realiza un pedido, por tanto dentro de una transacción, y también actualiza su dirección. A continuación, el cliente cambia de opinión y cancela el pedido. La transacción se cancela, pero usted no desea que se revierta el cambio de dirección. Este es un ejemplo típico en el que resulta útil suspender la transacción. Se utilizan tres comandos para suspender y reanudar transacciones:</p>
<ul>
<li><a href=/docs/es/commands/suspend-transaction><code>SUSPEND TRANSACTION</code></a>: pausa la transacción actual. Los registros actualizados o añadidos permanecen bloqueados.</li>
<li><a href=/docs/es/commands/resume-transaction><code>RESUME TRANSACTION</code></a>: reactiva una transacción suspendida.</li>
<li><a href=/docs/es/commands/active-transaction><code>Active transaction</code></a>: devuelve False si la transacción está suspendida o si no hay transacción en curso, y True si se ha iniciado o reanudado.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ejemplo-1>Ejemplo<a href=#ejemplo-1 class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h3>
<p>Este ejemplo ilustra la necesidad de una transacción suspendida. En una base Invoices, queremos obtener un nuevo número de factura durante una transacción. Este número se calcula y almacena en una tabla [Settings]. En un entorno multiusuario, los accesos concurrentes deben estar protegidos; sin embargo, debido a la transacción, la tabla [Settings] podría estar bloqueada por otro usuario, aunque estos datos sean independientes de la transacción principal. En este caso, puede suspender la transacción cuando acceda a la tabla.</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  //Método estándar que crea una factura</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> START TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> CREATE RECORD([Invoices])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> //llamar al método para obtener un número disponible</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> [Invoices]InvoiceID:=GetInvoiceNum </span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ...</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> SAVE RECORD([Invoices])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> VALIDATE TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>El método <em>GetInvoiceNum</em> suspende la transacción antes de ejecutarse. Tenga en cuenta que este código funcionará incluso cuando el método sea llamado desde fuera de una transacción:</p>
<div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-4d codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  //Método proyecto GetInvoiceNum</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //GetInvoiceNum -> Siguiente número de factura disponible</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> #DECLARE -> $freeNum : Integer</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> SUSPEND TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> ALL RECORDS([Settings])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> If(Locked([Settings])) //acceso multiusuario</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    While(Locked([Settings]))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       MESSAGE("Waiting for locked Settings record")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       DELAY PROCESS(Current process;30)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">       LOAD RECORD([Settings])</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    End while</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> End if</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> [Settings]InvoiceNum:=[Settings]InvoiceNum+1</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> $freeNum:=[Settings]InvoiceNum</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> SAVE RECORD([Settings])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> UNLOAD RECORD([Settings])</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> RESUME TRANSACTION</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copiar código al portapaples" title=Copiar class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=operación-detallada>Operación detallada<a href=#operación-detallada class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=cómo-funciona-una-transacción-suspendida>¿Cómo funciona una transacción suspendida?<a href=#cómo-funciona-una-transacción-suspendida class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>Cuando se suspende una transacción, se aplican los siguientes principios:</p>
<ul>
<li>Puede acceder a los registros que se añadieron o modificaron durante la transacción, y no puede ver los registros que se eliminaron durante la transacción.</li>
<li>Puede crear, guardar, eliminar o modificar registros fuera de la transacción.</li>
<li>Puede iniciar una nueva transacción, pero dentro de esta transacción incluida no podrá ver ningún registro o valor de registro que se haya añadido o modificado durante la transacción suspendida. De hecho, esta nueva transacción es totalmente independiente de la suspendida, similar a una transacción de otro proceso, y dado que la transacción suspendida podría reanudarse o cancelarse posteriormente, cualquier registro añadido o modificado se oculta automáticamente para la nueva transacción. En cuanto se reanude o cancele la nueva transacción, se podrán ver de nuevo estos registros.</li>
<li>Los registros modificados, borrados o añadidos dentro de la transacción suspendida permanecen bloqueados para otros procesos. Si se intenta modificar o eliminar estos registros fuera de la transacción o en una nueva transacción, se genera un error.</li>
</ul>
<p>Estas implementaciones se resumen en el siguiente gráfico:</p>
<p><img decoding=async loading=lazy src=/docs/es/assets/images/transactions-schema1-b8e1bad3d5f701207c70ba0375006274.png width=671 height=302 class=img_ev3q></p>
<p><em>Los valores editados durante la transacción A (el registro ID1 obtiene Val11) no están disponibles en una nueva transacción (B) creada durante el periodo «suspendido». Los valores editados durante el periodo «suspendido» (el registro ID2 obtiene Val22 y el registro ID3 obtiene Val33) se guardan incluso después de cancelar la transacción A.</em></p>
<p>Se han añadido funcionalidades específicas para gestionar los errores:</p>
<ul>
<li>El registro actual de cada tabla se bloquea temporalmente si se modifica durante la transacción y se desbloquea automáticamente cuando ésta se reanuda. Este mecanismo es importante para evitar guardados no deseados en partes de la transacción.</li>
<li>Si se ejecuta una secuencia no válida como iniciar transacción / suspender transacción / iniciar transacción / reanudar transacción, se genera un error. Este mecanismo evita que los desarrolladores olviden consignar o cancelar cualquier transacción incluida antes de reanudar la transacción suspendida.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=transacciones-suspendidas-y-estado-del-proceso>Transacciones suspendidas y estado del proceso<a href=#transacciones-suspendidas-y-estado-del-proceso class=hash-link aria-label="Enlace directo al encabezado" title="Enlace directo al encabezado">​</a></h4>
<p>El comando <a href=/docs/es/commands/in-transaction><code>In transaction</code></a> devuelve True cuando se ha iniciado una transacción, aunque esté suspendida. Para saber si la transacción actual está suspendida, es necesario utilizar el comando <a href=/docs/es/commands/active-transaction><code>Active transaction</code></a>, que devuelve False en este caso.</p>
<p>Ambos comandos, sin embargo, también devuelven False si no se ha iniciado ninguna transacción. En ese caso, es posible que tenga que utilizar el comando <a href=/docs/es/commands/transaction-level><code>Transaction level</code></a>, que devuelve 0 en este contexto (no se ha iniciado ninguna transacción).</p>
<p>El siguiente gráfico ilustra los distintos contextos de transacción y los valores correspondientes devueltos por los comandos de transacción:</p>
<p><img decoding=async loading=lazy src=/docs/es/assets/images/transactions-schema2-aafb10d686c45336a126b62e3cb113bd.png width=691 height=304 class=img_ev3q></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href="https://github.com/4d/docs/issues/new?title=Comment%20on%20Develop-legacy%2Ftransactions.md%20(20-R10)&body=Please%20enter%20your%20comment%3A" target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Comente esta página</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navegación de páginas de documentos"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/es/Develop/preemptive-processes><div class=pagination-nav__sublabel>Anterior</div><div class=pagination-nav__label>Procesos apropiativos</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/es/Tags/transformation-tags><div class=pagination-nav__sublabel>Siguiente</div><div class=pagination-nav__label>Etiquetas de transformación</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#descripción class="table-of-contents__link toc-highlight">Descripción</a><ul><li><a href=#ejemplo class="table-of-contents__link toc-highlight">Ejemplo</a></ul><li><a href=#suspender-transacciones class="table-of-contents__link toc-highlight">Suspender transacciones</a><ul><li><a href=#principio class="table-of-contents__link toc-highlight">Principio</a><li><a href=#ejemplo-1 class="table-of-contents__link toc-highlight">Ejemplo</a><li><a href=#operación-detallada class="table-of-contents__link toc-highlight">Operación detallada</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Comunidad</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://blog.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Blog</a><li class=footer__item><a href=https://discuss.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Forum</a><li class=footer__item><a href=https://facebook.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook</a><li class=footer__item><a href=https://x.com/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>X</a><li class=footer__item><a href=https://youtube.com/user/4Dsoftware target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube</a><li class=footer__item><a href=https://github.com/4D target=_blank rel="noopener noreferrer" class=footer__link-item>Github</a></ul></div><div class="col footer__col"><div class=footer__title>Soporte</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/4d/docs/releases/tag/latest target=_blank rel="noopener noreferrer" class=footer__link-item>Documentation download<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://doc.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>4D Doc Center (Donde todo empezó)</a><li class=footer__item><a href=https://kb.4d.com target=_blank rel="noopener noreferrer" class=footer__link-item>Base de conocimientos</a><li class=footer__item><a href=https://us.4d.com/product-download/Feature-Release target=_blank rel="noopener noreferrer" class=footer__link-item>Descargas</a><li class=footer__item><a href=https://us.4d.com/resources target=_blank rel="noopener noreferrer" class=footer__link-item>Resources</a><li class=footer__item><a href=https://us.4d.com/4d-technical-support target=_blank rel="noopener noreferrer" class=footer__link-item>Obtener soporte</a></ul></div><div class="col footer__col"><div class=footer__title>Empresa</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://us.4d.com/about-us target=_blank rel="noopener noreferrer" class=footer__link-item>Acerca de 4D</a><li class=footer__item><a href=https://us.4d.com/contact-us target=_blank rel="noopener noreferrer" class=footer__link-item>Contáctenos</a><li class=footer__item><a href=https://us.4d.com/4d-around-the-world target=_blank rel="noopener noreferrer" class=footer__link-item>4D en el mundo</a><li class=footer__item><a href=https://us.4d.com/Careers target=_blank rel="noopener noreferrer" class=footer__link-item>Careers</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>2025 4D SAS - Todos los derechos reservados</div></div></div></footer></div>