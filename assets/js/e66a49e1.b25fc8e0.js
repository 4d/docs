"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[40466],{603905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>d});var n=a(667294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=n.createContext({}),m=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},s=function(e){var t=m(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=m(a),d=l,b=u["".concat(p,".").concat(d)]||u[d]||c[d]||r;return a?n.createElement(b,o(o({ref:t},s),{},{components:a})):n.createElement(b,o({ref:t},s))}));function d(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,o=new Array(r);o[0]=u;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var m=2;m<r;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},587546:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>p,toc:()=>s});a(667294);var n=a(603905);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l.apply(this,arguments)}function r(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}const o={id:"vp-create-table",title:"VP CREATE TABLE"},i=void 0,p={unversionedId:"ViewPro/commands/vp-create-table",id:"version-20-R5/ViewPro/commands/vp-create-table",title:"VP CREATE TABLE",description:"History",source:"@site/versioned_docs/version-20-R5/ViewPro/commands/vp-create-table.md",sourceDirName:"ViewPro/commands",slug:"/ViewPro/commands/vp-create-table",permalink:"/docs/ViewPro/commands/vp-create-table",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20ViewPro%2Fcommands%2Fvp-create-table.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"vp-create-table",title:"VP CREATE TABLE"},sidebar:"docs",previous:{title:"VP Copy to object",permalink:"/docs/ViewPro/commands/vp-copy-to-object"},next:{title:"D",permalink:"/docs/commands/D"}},m={},s=[{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4},{value:"See also",id:"see-also",level:4}],c={toc:s};function u(e){var{components:t}=e,o=r(e,["components"]);return(0,n.kt)("wrapper",l({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("details",null,(0,n.kt)("summary",null,"History"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",l({parentName:"tr"},{align:null}),"Release"),(0,n.kt)("th",l({parentName:"tr"},{align:null}),"Changes"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"19 R8"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Support of theme options: ",(0,n.kt)("inlineCode",{parentName:"td"},"bandColumns"),", ",(0,n.kt)("inlineCode",{parentName:"td"},"bandRows"),", ",(0,n.kt)("inlineCode",{parentName:"td"},"highlightFirstColumn"),", ",(0,n.kt)("inlineCode",{parentName:"td"},"highlightLastColumn"),", ",(0,n.kt)("inlineCode",{parentName:"td"},"theme"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"19 R7"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Support of ",(0,n.kt)("inlineCode",{parentName:"td"},"allowAutoExpand")," option")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"19 R6"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Added"))))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"VP CREATE TABLE")," ( ",(0,n.kt)("em",{parentName:"p"},"rangeObj")," : Object ; ",(0,n.kt)("em",{parentName:"p"},"tableName")," : Text {; ",(0,n.kt)("em",{parentName:"p"},"source")," : Text} {; ",(0,n.kt)("em",{parentName:"p"},"options")," : cs.ViewPro.TableOptions} )"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",l({parentName:"tr"},{align:null}),"Parameter"),(0,n.kt)("th",l({parentName:"tr"},{align:null}),"Type"),(0,n.kt)("th",l({parentName:"tr"},{align:null})),(0,n.kt)("th",l({parentName:"tr"},{align:null}),"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"rangeObj"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Object"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"->"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Range object")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"tableName"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"->"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Name for the table")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"source"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Text"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"->"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Data context property name to display in the table")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",l({parentName:"tr"},{align:null}),"options"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),(0,n.kt)("a",l({parentName:"td"},{href:"/docs/ViewPro/classes#tableoptions"}),"cs.ViewPro.TableOptions")),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"->"),(0,n.kt)("td",l({parentName:"tr"},{align:null}),"Additional options")))),(0,n.kt)("h4",l({},{id:"description"}),"Description"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"VP CREATE TABLE")," command creates a table in the specified range. You can create a table in a range of cells to make managing and analyzing a group of related data easier. A table typically contains related data in rows and columns, and takes advantage of a ",(0,n.kt)("a",l({parentName:"p"},{href:"vp-set-data-context"}),"data context"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(475825).Z,width:"1078",height:"324"})),(0,n.kt)("p",null,"In ",(0,n.kt)("em",{parentName:"p"},"rangeObj"),", pass the cell range where the table will be created."),(0,n.kt)("p",null,"In ",(0,n.kt)("em",{parentName:"p"},"tableName"),", pass a name for the table. The name must:  "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"be unique in the sheet"),(0,n.kt)("li",{parentName:"ul"},"include at least 5 characters"),(0,n.kt)("li",{parentName:"ul"},"not include spaces or start with a number")),(0,n.kt)("p",null,"In ",(0,n.kt)("em",{parentName:"p"},"source"),", you can pass a property name of a ",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-set-data-context"}),"data context")," to display its data in the table. This binds the table to the data context. When the data context is updated, the data displayed in the table is updated accordingly. The ",(0,n.kt)("em",{parentName:"p"},"source")," property must contain a collection of objects and each element represents a row. "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If you don't specify a ",(0,n.kt)("em",{parentName:"li"},"source"),", the command creates an empty table with the size defined in ",(0,n.kt)("em",{parentName:"li"},"rangeObj"),". "),(0,n.kt)("li",{parentName:"ul"},"If the specified ",(0,n.kt)("em",{parentName:"li"},"source")," cannot be fully displayed in the document, no table is created.")),(0,n.kt)("p",null,"In the ",(0,n.kt)("em",{parentName:"p"},"options")," parameter, pass an object of the ",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/classes#tableoptions"}),(0,n.kt)("inlineCode",{parentName:"a"},"cs.ViewPro.TableOptions")," class")," that contains the table properties to set. "),(0,n.kt)("p",null,"Within the ",(0,n.kt)("em",{parentName:"p"},"options")," object, the ",(0,n.kt)("em",{parentName:"p"},"tableColumns")," collection determines the structure of the table's columns. The length of the ",(0,n.kt)("em",{parentName:"p"},"tableColumns")," collection must be equal to the range column count:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"When the column count in ",(0,n.kt)("em",{parentName:"li"},"rangeObj")," exceeds the number of columns in ",(0,n.kt)("em",{parentName:"li"},"tableColumns"),", the table is filled with additional empty columns."),(0,n.kt)("li",{parentName:"ul"},"When the column count in ",(0,n.kt)("em",{parentName:"li"},"rangeObj")," is inferior to the number of ",(0,n.kt)("em",{parentName:"li"},"tableColumns"),", the table displays a number of columns that match the range's column count.")),(0,n.kt)("p",null,"If you pass a ",(0,n.kt)("em",{parentName:"p"},"source")," but no ",(0,n.kt)("em",{parentName:"p"},"tableColumn")," option, the command generates columns automatically. In this case, ",(0,n.kt)("em",{parentName:"p"},"rangeObj")," must be a cell range. Otherwise, the first cell of the range is used. When generating columns automatically, the following rules apply:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If the data passed to the command is a collection of objects, the property names are used as column titles. For example:")),(0,n.kt)("pre",null,(0,n.kt)("code",l({parentName:"pre"},{className:"language-4d"}),'([{ LastName: \\"Freehafer\\", FirstName: \\"Nancy\\"},{ LastName: \\"John\\", FirstName: \\"Doe\\"})\n')),(0,n.kt)("p",null,"Here the titles of the columns would be ",(0,n.kt)("inlineCode",{parentName:"p"},"LastName")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"FirstName"),"."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"If the data passed to the command is a collection of scalar values, it must contain a collection of subcollections:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The first-level collection contains subcollections of values. Each subcollection defines a row. Pass an empty collection to skip a row. The number of values in the first subcollection determines how many columns are created."),(0,n.kt)("li",{parentName:"ul"},"The subcollections' indices are used as column titles."),(0,n.kt)("li",{parentName:"ul"},"Each subcollection defines cell values for the row. Values can be ",(0,n.kt)("inlineCode",{parentName:"li"},"Integer"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Real"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Boolean"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Text"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Date"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Null"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Time")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"Picture"),". A ",(0,n.kt)("inlineCode",{parentName:"li"},"Time")," value must be an a object containing a time attribute, as described in ",(0,n.kt)("a",l({parentName:"li"},{href:"/docs/ViewPro/commands/vp-set-value"}),"VP SET VALUE"),". ")))),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"This only works when generating columns automatically. You cannot use a collection of scalar data with the ",(0,n.kt)("em",{parentName:"p"},"tableColumns")," option.")),(0,n.kt)("h4",l({},{id:"example"}),"Example"),(0,n.kt)("p",null,"To create a table using a data context:"),(0,n.kt)("pre",null,(0,n.kt)("code",l({parentName:"pre"},{className:"language-4d"}),'// Set a data context\nvar $data : Object\n\n$data:=New object()\n$data.people:=New collection()\n$data.people.push(New object("firstName"; "John"; "lastName"; "Smith"; "email"; "johnsmith@gmail.com"))\n$data.people.push(New object("firstName"; "Mary"; "lastName"; "Poppins"; "email"; "marypoppins@gmail.com"))\n\n\nVP SET DATA CONTEXT("ViewProArea"; $data)\n\n// Define the columns for the table\nvar $options : cs.ViewPro.TableOptions\n\n$options:=cs.ViewPro.TableOptions.new()\n$options.tableColumns:=New collection()\n$options.tableColumns.push(cs.ViewPro.TableColumns.new("name"; "First name"; "dataField"; "firstName"))\n$options.tableColumns.push(cs.ViewPro.TableColumns.new("name"; "Last name"; "dataField"; "lastName"))\n$options.tableColumns.push(cs.ViewPro.TableColumns.new("name"; "Email"; "dataField"; "email"))\n\n// Create a table from the "people" collection\nVP CREATE TABLE(VP Cells("ViewProArea"; 1; 1; $options.tableColumns.length; 1); "ContextTable"; "people"; $options)\n')),(0,n.kt)("p",null,"Here's the result:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(475825).Z,width:"1078",height:"324"})),(0,n.kt)("h4",l({},{id:"see-also"}),"See also"),(0,n.kt)("p",null,(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-find-table"}),"VP Find table"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-get-table-column-attributes"}),"VP Get table column attributes"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-get-table-column-index"}),"VP Get table column index"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-insert-table-columns"}),"VP INSERT TABLE COLUMNS"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-insert-table-rows"}),"VP INSERT TABLE ROWS"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-remove-table"}),"VP REMOVE TABLE"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-resize-table"}),"VP RESIZE TABLE"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-set-data-context"}),"VP SET DATA CONTEXT"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-set-table-column-attributes"}),"VP SET TABLE COLUMN ATTRIBUTES"),(0,n.kt)("br",null),"\n",(0,n.kt)("a",l({parentName:"p"},{href:"/docs/ViewPro/commands/vp-set-table-theme"}),"VP SET TABLE THEME")))}u.isMDXComponent=!0},475825:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/vp-create-table-58d4f5dc15eb48b9682accf08d7b8926.png"}}]);