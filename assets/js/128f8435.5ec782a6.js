"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["83930"],{260228:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>o,assets:()=>l,toc:()=>i,contentTitle:()=>d});var o=JSON.parse('{"id":"commands/form-event-code","title":"Form event code","description":"Form event code  : Integer","source":"@site/versioned_docs/version-20-R8/commands/form-event-code.md","sourceDirName":"commands","slug":"/commands/form-event-code","permalink":"/docs/commands/form-event-code","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands%2Fform-event-code.md%20(20-R8)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R8","frontMatter":{"id":"form-event-code","title":"Form event code","slug":"/commands/form-event-code","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"FORM Event","permalink":"/docs/commands/form-event"},"next":{"title":"In break","permalink":"/docs/commands/in-break"}}'),s=t("785893"),r=t("250065");let a={id:"form-event-code",title:"Form event code",slug:"/commands/form-event-code",displayed_sidebar:"docs"},d=void 0,l={},i=[{value:"Description",id:"description",level:2},{value:"Example 1",id:"example-1",level:2},{value:"Example 2",id:"example-2",level:2},{value:"Example 3",id:"example-3",level:2},{value:"Example 4",id:"example-4",level:2},{value:"Example 5",id:"example-5",level:2},{value:"Example 6",id:"example-6",level:2},{value:"Example 7",id:"example-7",level:2},{value:"Example 8",id:"example-8",level:2},{value:"Example 9",id:"example-9",level:2},{value:"Example 10",id:"example-10",level:2},{value:"Example 11",id:"example-11",level:2},{value:"Example 12",id:"example-12",level:2},{value:"Example 13",id:"example-13",level:2},{value:"See also",id:"see-also",level:2},{value:"Properties",id:"properties",level:2}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Form event code"}),"  : Integer"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Function result"}),(0,s.jsx)(n.td,{children:"Integer"}),(0,s.jsx)(n.td,{children:"\u2190"}),(0,s.jsx)(n.td,{children:"Form event number"})]})})]}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Form event code"})," returns a numeric value identifying the type of form event that has just occurred. Usually, you will use ",(0,s.jsx)(n.strong,{children:"Form event code"})," from within a form or object method."]}),"\n",(0,s.jsxs)(n.p,{children:["4D provides predefined constants (found in the ",(0,s.jsx)(n.em,{children:"Form Events"})," theme) in order to compare the values returned by the ",(0,s.jsx)(n.strong,{children:"Form event code"})," command. Certain events are generic (generated for any type of object) and others are specific to a particular type of object."]}),"\n",(0,s.jsxs)(n.p,{children:["For a description of events, please refer to the ",(0,s.jsx)(n.a,{href:"/docs/Events/overview",children:(0,s.jsx)(n.strong,{children:"Form Events"})})," section."]}),"\n",(0,s.jsx)(n.h2,{id:"example-1",children:"Example 1"}),"\n",(0,s.jsx)(n.p,{children:"This example shows the On Validate event being used to automatically assign (to a field) the date that the record is modified:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:"\xa0\xa0//Method of a form\n\xa0Case of\n\xa0\xa0// ...\n\xa0\xa0\xa0\xa0:(Form event code=On Validate)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0[aTable]Last Modified On:=Current date\n\xa0End case\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-2",children:"Example 2"}),"\n",(0,s.jsx)(n.p,{children:"In this example, the complete handling of a drop-down list (initialization, user clicks, and object release) is encapsulated in the method of the object:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//asBurgerSize Drop-down list Object Method\n\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0ARRAY TEXT(asBurgerSize;3)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asBurgerSize{1}:="Small"\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asBurgerSize{1}:="Medium"\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asBurgerSize{1}:="Large"\n\xa0\xa0\xa0\xa0:(Form event code=On Clicked)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(asBurgerSize#0)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ALERT("You chose a "+asBurgerSize{asBurgerSize}+" burger.")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0:(Form event code=On Unload)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0CLEAR VARIABLE(asBurgerSize)\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-3",children:"Example 3"}),"\n",(0,s.jsx)(n.p,{children:"This example is a template for a form method. It shows each of the possible events that can occur when a summary report uses a form as an output form:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:"\xa0\xa0//Method of a form being used as output form for a summary report\n\xa0$vpFormTable:=Current form table\n\xa0Case of\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0:(Form event code=On Header)\n\xa0\xa0//A header area is about to be printed\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Case of\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:(Before selection($vpFormTable->))\n\xa0\xa0//Code for the first break header goes here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:(Level=1)\n\xa0\xa0//Code for a break header level 1 goes here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:(Level=2)\n\xa0\xa0//Code for a break header level 2 goes here\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End case\n\xa0\xa0\xa0\xa0:(Form event code=On Printing Detail)\n\xa0\xa0//A record is about to be printed\n\xa0\xa0//Code for each record goes here\n\xa0\xa0\xa0\xa0:(Form event code=On Printing Break)\n\xa0\xa0//A break area is about to be printed\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Case of\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:(Level=0)\n\xa0\xa0//Code for a break level 0 goes here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:(Level=1)\n\xa0\xa0//Code for a break level 1 goes here\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End case\n\xa0\xa0\xa0\xa0:(Form event code=On Printing Footer)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(End selection($vpFormTable->))\n\xa0\xa0//Code for the last footer goes here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0//Code for a footer goes here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0End case\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-4",children:"Example 4"}),"\n",(0,s.jsxs)(n.p,{children:["This example shows the template of a form method that handles the events that can occur for a form displayed using the ",(0,s.jsx)(n.a,{href:"/docs/commands/display-selection",children:"DISPLAY SELECTION"})," or ",(0,s.jsx)(n.a,{href:"/docs/commands/modify-selection",children:"MODIFY SELECTION"})," commands. For didactic purposes, it displays the nature of the event in the title bar of the form window."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//A form method\n\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The form is about to be displayed"\n\xa0\xa0\xa0\xa0:(Form event code=On Unload)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The output form has been exited and is about to disappear from the screen"\n\xa0\xa0\xa0\xa0:(Form event code=On Display Detail)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="Displaying record #"+String(Selected record number([TheTable]))\n\xa0\xa0\xa0\xa0:(Form event code=On Menu Selected)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="A menu item has been selected"\n\xa0\xa0\xa0\xa0:(Form event code=On Header")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The header area is about to be drawn"\n\xa0\xa0\xa0\xa0:(Form event code=On Clicked")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="A record has been clicked"\n\xa0\xa0\xa0\xa0:(Form event code=On Double Clicked")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="A record has been double clicked"\n\xa0\xa0\xa0\xa0:(Form event code=On Open Detail)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The record #"+String(Selected record number([TheTable]))+" is double-clicked"\n\xa0\xa0\xa0\xa0:(Form event code=On Close Detail)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="Going back to the output form"\n\xa0\xa0\xa0\xa0:(Form event code=On Activate)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The form\'s window has just become the frontmost window"\n\xa0\xa0\xa0\xa0:(Form event code=On Deactivate)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="The form\'s window is no longer the frontmost window"\n\xa0\xa0\xa0\xa0:(Form event code=On Menu Selected)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="A menu item has been chosen"\n\xa0\xa0\xa0\xa0:(Form event code=On Outside Call)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="A call from another has been received"\n\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vsTheEvent:="What\'s going on? Event #"+String(Form event)\n\xa0End case\n\xa0SET WINDOW TITLE($vsTheEvent)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-5",children:"Example 5"}),"\n",(0,s.jsxs)(n.p,{children:["For examples on how to handle ",(0,s.jsx)(n.a,{href:"/docs/Events/onBeforeKeystroke",children:(0,s.jsx)(n.code,{children:"On Before Keystroke"})})," and ",(0,s.jsx)(n.a,{href:"/docs/Events/onAfterKeystroke",children:(0,s.jsx)(n.code,{children:"On After Keystroke"})})," events, see examples for the ",(0,s.jsx)(n.a,{href:"/docs/commands/get-edited-text",children:"Get edited text"}),", ",(0,s.jsx)(n.a,{href:"/docs/commands/keystroke",children:"Keystroke"})," and ",(0,s.jsx)(n.a,{href:"/docs/commands/filter-keystroke",children:"FILTER KEYSTROKE"})," commands."]}),"\n",(0,s.jsx)(n.h2,{id:"example-6",children:"Example 6"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to treat clicks and double clicks in the same way in a scrollable area:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:"\xa0\xa0//asChoices scrollable area object method\n\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0ARRAY TEXT(asChoices;...)\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asChoices:=0\n\xa0\xa0\xa0\xa0:((Form event code=On Clicked)|(Form event code=On Double Clicked))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(asChoices#0)\n\xa0\xa0//An item has been clicked, do something here\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0//...\n\xa0End case\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-7",children:"Example 7"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to treat clicks and double clicks using a different response. Note the use of the element zero for keeping track of the selected element:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//asChoices scrollable area object method\n\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0ARRAY TEXT(asChoices;...)\n\xa0\xa0// ...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asChoices:=0\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0asChoices{0}:="0"\n\xa0\xa0\xa0\xa0:(Form event code=On Clicked)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(asChoices#0)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(asChoices#Num(asChoices))\n\xa0\xa0//A new item has been clicked, do something here\n\xa0\xa0//...\n\xa0\xa0//Save the new selected element for the next time\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0asChoices{0}:=String(asChoices)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0asChoices:=Num(asChoices{0})\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0:(Form event code=On Double Clicked)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(asChoices#0)\n\xa0\xa0//An item has been double clicked, do something different here\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0// ...\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-8",children:"Example 8"}),"\n",(0,s.jsxs)(n.p,{children:["This example shows how to maintain a status text information area from within a form method, using the ",(0,s.jsx)(n.a,{href:"/docs/Events/onGettingFocus",children:(0,s.jsx)(n.code,{children:"On Getting Focus"})})," and ",(0,s.jsx)(n.a,{href:"/docs/Events/onLosingFocus",children:(0,s.jsx)(n.code,{children:"On Losing Focus"})})," events:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//[Contacts];"Data Entry" form method\n\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0var vtStatusArea : Text\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0vtStatusArea:=""\n\xa0\xa0\xa0\xa0:(Form event code=On Getting Focus)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0RESOLVE POINTER(Focus object;$vsVarName;$vlTableNum;$vlFieldNum)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(($vlTableNum#0)&($vlFieldNum#0))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Case of\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:($vlFieldNum=1)\xa0//Last name field\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0vtStatusArea:="Enter the Last name of the Contact; it will be capitalized automatically"\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:($vlFieldNum=10)\xa0//Zip Code field\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0vtStatusArea:="Enter a 5-digit zip code; it will be checked and validated automatically"\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0End case\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0:(Form event code=On Losing Focus)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0vtStatusArea:=""\n\xa0\xa0//...\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-9",children:"Example 9"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to respond to a close window event with a form used for record data entry:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0//Method for an input form\n\xa0$vpFormTable:=Current form table\n\xa0Case of\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0:(Form event code=On Close Box)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(Modified record($vpFormTable->))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CONFIRM("This record has been modified. Save Changes?")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(OK=1)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ACCEPT\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CANCEL\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0CANCEL\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0//...\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-10",children:"Example 10"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to capitalize a text or alphanumeric field each time its data source value is modified:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:"\xa0\xa0//[Contacts]First Name Object method\n\xa0Case of\n\xa0\xa0//...\n\xa0\xa0\xa0\xa0:(Form event code=On Data Change)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0[Contacts]First Name:=Uppercase(Substring([Contacts]First Name;1;1))+Lowercase(Substring([Contacts]First Name;2))\n\xa0\xa0//...\n\xa0End case\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-11",children:"Example 11"}),"\n",(0,s.jsx)(n.p,{children:"The following example illustrates how to manage a deletion action in a hierarchical list:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0...\xa0//method of hierarchical list\n:(Form event code=On Delete Action)\n\xa0ARRAY LONGINT($itemsArray;0)\n\xa0$Ref:=Selected list items(<>HL;$itemsArray;*)\n\xa0$n:=Size of array($itemsArray)\n\xa0\n\xa0Case of\n\xa0\xa0\xa0\xa0:($n=0)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0ALERT("No item selected")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OK:=0\n\xa0\xa0\xa0\xa0:($n=1)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0CONFIRM("Do you want to delete this item?")\n\xa0\xa0\xa0\xa0:($n>1)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0CONFIRM("Do you want to delete these items?")\n\xa0End case\n\xa0\n\xa0If(OK=1)\n\xa0\xa0\xa0\xa0For($i;1;$n)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0DELETE FROM LIST(<>HL;$itemsArray{$i};*)\n\xa0\xa0\xa0\xa0End for\n\xa0End if\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-12",children:"Example 12"}),"\n",(0,s.jsxs)(n.p,{children:["In this example, the ",(0,s.jsx)(n.a,{href:"/docs/Events/onScroll",children:(0,s.jsx)(n.code,{children:"On Scroll"})}),' form event allows us to synchronize the display of two pictures in a form. The following code is added in the "satellite" object method (picture field or variable):']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Scroll)\n\xa0\xa0// we take the position of the left picture\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT GET SCROLL POSITION(*;"satellite";vPos;hPos)\n\xa0\xa0// and we apply it to the right picture\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET SCROLL POSITION(*;"plan";vPos;hPos;*)\n\xa0End case\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Result: ",(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=YIRfsW1BmHE",children:"https://www.youtube.com/watch?v=YIRfsW1BmHE"})]}),"\n",(0,s.jsx)(n.h2,{id:"example-13",children:"Example 13"}),"\n",(0,s.jsx)(n.p,{children:"You want to draw a red rectangle around the selected cell of a list box, and you want the rectangle to move along with the list box if it is scrolled vertically by the user. In the list box object method, you can write:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\xa0Case of\n\xa0\n\xa0\xa0\xa0\xa0:(Form event code=On Clicked)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0LISTBOX GET CELL POSITION(*;"LB1";$col;$raw)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0LISTBOX GET CELL COORDINATES(*;"LB1";$col;$raw;$x1;$y1;$x2;$y2)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET VISIBLE(*;"RedRect";True)\xa0//initialize a red rectangle\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET COORDINATES(*;"RedRect";$x1;$y1;$x2;$y2)\n\xa0\n\xa0\xa0\xa0\xa0:(Form event code=On Scroll)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0LISTBOX GET CELL POSITION(*;"LB1";$col;$raw)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0LISTBOX GET CELL COORDINATES(*;"LB1";$col;$raw;$x1;$y1;$x2;$y2)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT GET COORDINATES(*;"LB1";$xlb1;$ylb1;$xlb2;$ylb2)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$toAdd:=LISTBOX Get headers height(*;"LB1")\xa0//height of the header so as not to overlap it\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If($ylb1+$toAdd<$y1)&($ylb2>$y2)\xa0//if we are inside the list box\n\xa0\xa0//to keep it simple, we only handle headers\n\xa0\xa0//but we should handle horizontal clipping\n\xa0\xa0//as well as scroll bars\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET VISIBLE(*;"RedRect";True)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET COORDINATES(*;"RedRect";$x1;$y1;$x2;$y2)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0OBJECT SET VISIBLE(*;"RedRect";False)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\n\xa0End case\n'})}),"\n",(0,s.jsx)(n.p,{children:"As a result, the red rectangle follows the scrolling of the list box:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(537270).Z+"",width:"1053",height:"253"})}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/Events/overview",children:"Form Events"}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/call-subform-container",children:"CALL SUBFORM CONTAINER"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/current-form-table",children:"Current form table"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/filter-keystroke",children:"FILTER KEYSTROKE"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/form-event",children:"FORM Event"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/get-edited-text",children:"Get edited text"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/keystroke",children:"Keystroke"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/post-outside-call",children:"POST OUTSIDE CALL"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/commands/set-timer",children:"SET TIMER"})]}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Command number"}),(0,s.jsx)(n.td,{children:"388"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Thread safe"}),(0,s.jsx)(n.td,{children:"\u2717"})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},537270:function(e,n,t){t.d(n,{Z:function(){return o}});let o=t.p+"assets/images/pict1900395.en-569763c683cf0898d7abbac68fb6d734.png"},250065:function(e,n,t){t.d(n,{Z:function(){return d},a:function(){return a}});var o=t(667294);let s={},r=o.createContext(s);function a(e){let n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);