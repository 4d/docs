"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[35591],{844595:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var r=t(474848),s=t(28453);const i={id:"set-current-printer",title:"SET CURRENT PRINTER",slug:"/commands/set-current-printer",displayed_sidebar:"docs"},d=void 0,o={id:"commands-legacy/set-current-printer",title:"SET CURRENT PRINTER",description:"SET CURRENT PRINTER ( printerName )",source:"@site/versioned_docs/version-20-R7/commands-legacy/set-current-printer.md",sourceDirName:"commands-legacy",slug:"/commands/set-current-printer",permalink:"/docs/commands/set-current-printer",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fset-current-printer.md%20(20-R7)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R7",frontMatter:{id:"set-current-printer",title:"SET CURRENT PRINTER",slug:"/commands/set-current-printer",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"Printing page",permalink:"/docs/commands/printing-page"},next:{title:"SET PRINT MARKER",permalink:"/docs/commands/set-print-marker"}},a={},c=[{value:"Description",id:"description",level:4},{value:"System variables and sets",id:"system-variables-and-sets",level:4},{value:"Example",id:"example",level:4},{value:"See also",id:"see-also",level:4}];function l(e){const n={a:"a",br:"br",code:"code",em:"em",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," ( ",(0,r.jsx)(n.em,{children:"printerName"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"printerName"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2192"}),(0,r.jsx)(n.td,{children:"Name of printer to be used"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"This command is not thread-safe, it cannot be used in preemptive code."})}),"\n",(0,r.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," command designates the printer to be used for printing with the current 4D application."]}),"\n",(0,r.jsxs)(n.p,{children:["Pass the name of the printer to be selected in the ",(0,r.jsx)(n.em,{children:"printerName"})," parameter. To get a list of available printers, use the ",(0,r.jsx)(n.a,{href:"/docs/commands/printers-list",children:"PRINTERS LIST"})," command beforehand. If you pass an empty string in ",(0,r.jsx)(n.em,{children:"printerName"}),", the current printer defined in the system will be used."]}),"\n",(0,r.jsxs)(n.p,{children:["You can also designate the generic PDF printer automatically, regardless of the platform, by passing the following constant found in the ",(0,r.jsx)(n.em,{children:"Print Options"})," theme:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Constant"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Comment"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Generic PDF driver"}),(0,r.jsx)(n.td,{children:"_4d_pdf_printer"}),(0,r.jsxs)(n.td,{children:["On macOS, sets the current printer to the default driver. This driver is invisible; it is not found in the list returned by ",(0,r.jsx)(n.a,{href:"/docs/commands/printers-list",children:"PRINTERS LIST"}),". Note that a PDF document path must be set using ",(0,r.jsx)(n.a,{href:"/docs/commands/set-print-option",children:"SET PRINT OPTION"}),', otherwise error 3107 is returned. On Windows, sets the current printer to the Windows PDF driver (named "Microsoft Print to PDF"). This feature is only available in Windows 10 and higher with the PDF option installed. In older Windows versions, or if no PDF driver is available, the command does nothing and the ',(0,r.jsx)(n.em,{children:"OK"})," variable is set to 0."]})]})})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," command must be called before ",(0,r.jsx)(n.a,{href:"/docs/commands/set-print-option",children:"SET PRINT OPTION"}),", so that the options available correspond to the selected printer. On the other hand, ",(0,r.jsx)(n.strong,{children:"SET CURRENT PRINTER"})," must be called after ",(0,r.jsx)(n.em,{children:"_o_PAGE SETUP"}),", otherwise the print settings are lost."]}),"\n",(0,r.jsxs)(n.p,{children:["This command can be used with the ",(0,r.jsx)(n.a,{href:"/docs/commands/print-selection",children:"PRINT SELECTION"}),", ",(0,r.jsx)(n.a,{href:"/docs/commands/print-record",children:"PRINT RECORD"}),", ",(0,r.jsx)(n.a,{href:"/docs/commands/print-form",children:"Print form"}),", and ",(0,r.jsx)(n.a,{href:"/docs/commands/qr-report",children:"QR REPORT"})," commands, and is applied to all 4D printing, including that in Design mode.",(0,r.jsx)(n.br,{}),"\nIt is imperative for print commands to be called with the ",(0,r.jsx)(n.em,{children:">"})," parameter (where applicable) so that the specified settings are not lost."]}),"\n",(0,r.jsx)(n.h4,{id:"system-variables-and-sets",children:"System variables and sets"}),"\n",(0,r.jsx)(n.p,{children:"If printer selection is carried out correctly, the system variable OK is set to 1. Should the opposite occur (for instance if the designated printer is not found), the system variable OK is set to 0 and the current printer remains unchanged."}),"\n",(0,r.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"Creation of a PDF document under Windows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:'\xa0var $pdfpath : Text\n\xa0$pdfpath:=System folder(Desktop)+"test.pdf"\n\xa0SET CURRENT PRINTER(Generic PDF driver)\n\xa0SET PRINT OPTION(Destination option;3;$pdfpath)\n\xa0ALL RECORDS([Table_1])\n\xa0PRINT SELECTION([Table_1];*)\n\xa0SET CURRENT PRINTER("")\n'})}),"\n",(0,r.jsx)(n.h4,{id:"see-also",children:"See also"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"/docs/commands/get-current-printer",children:"Get current printer"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.a,{href:"/docs/commands/printers-list",children:"PRINTERS LIST"})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>o});var r=t(296540);const s={},i=r.createContext(s);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);