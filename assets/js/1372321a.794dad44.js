"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[44599],{603905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>c});var a=n(667294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=a.createContext({}),p=function(e){var t=a.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=p(e.components);return a.createElement(m.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,m=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,N=d["".concat(m,".").concat(c)]||d[c]||u[c]||l;return n?a.createElement(N,o(o({ref:t},s),{},{components:n})):a.createElement(N,o({ref:t},s))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=d;var i={};for(var m in t)hasOwnProperty.call(t,m)&&(i[m]=t[m]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},350184:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>m,toc:()=>s});n(667294);var a=n(603905);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const o={id:"vp-set-custom-functions",title:"VP SET CUSTOM FUNCTIONS"},i=void 0,m={unversionedId:"ViewPro/commands/vp-set-custom-functions",id:"version-20-R5/ViewPro/commands/vp-set-custom-functions",title:"VP SET CUSTOM FUNCTIONS",description:"VP SET CUSTOM FUNCTIONS ( vpAreaName Object  )",source:"@site/versioned_docs/version-20-R5/ViewPro/commands/vp-set-custom-functions.md",sourceDirName:"ViewPro/commands",slug:"/ViewPro/commands/vp-set-custom-functions",permalink:"/docs/ViewPro/commands/vp-set-custom-functions",draft:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20ViewPro%2Fcommands%2Fvp-set-custom-functions.md%20(20-R5)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R5",frontMatter:{id:"vp-set-custom-functions",title:"VP SET CUSTOM FUNCTIONS"},sidebar:"docs",previous:{title:"VP SET CURRENT SHEET",permalink:"/docs/ViewPro/commands/vp-set-current-sheet"},next:{title:"VP SET DATA CONTEXT",permalink:"/docs/ViewPro/commands/vp-set-data-context"}},p={},s=[{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4},{value:"See also",id:"see-also",level:4}],u={toc:s};function d(e){var{components:t}=e,n=l(e,["components"]);return(0,a.kt)("wrapper",r({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"VP SET CUSTOM FUNCTIONS")," ( ",(0,a.kt)("em",{parentName:"p"},"vpAreaName")," : Text ; ",(0,a.kt)("em",{parentName:"p"},"formulaObj")," : Object  ) "),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Parameter"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:null})),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"vpAreaName"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"4D View Pro area form object name")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),"formulaObj"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"->"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Formula object")))),(0,a.kt)("h4",r({},{id:"description"}),"Description"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"VP SET CUSTOM FUNCTIONS")," command designates the 4D formulas that can be called directly from 4D View Pro formulas. Because custom functions are not stored in the document,",(0,a.kt)("inlineCode",{parentName:"p"},"VP SET CUSTOM FUNCTIONS")," must be executed in the ",(0,a.kt)("inlineCode",{parentName:"p"},"On Load")," form event."),(0,a.kt)("p",null,"The formulas specified by ",(0,a.kt)("inlineCode",{parentName:"p"},"VP SET CUSTOM FUNCTIONS")," appear in a pop-up menu when the first letter of their name is entered. See the ",(0,a.kt)("a",r({parentName:"p"},{href:"/docs/ViewPro/formulas"}),"Formulas and Functions")," page."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If ",(0,a.kt)("inlineCode",{parentName:"p"},"VP SET CUSTOM FUNCTIONS")," is called multiple times for the same area, in the same session, only the last call is taken into account.")),(0,a.kt)("p",null,"Pass the name of the 4D View Pro area in ",(0,a.kt)("em",{parentName:"p"},"vpAreaName"),". If you pass a name that does not exist, an error is returned."),(0,a.kt)("p",null,"In the ",(0,a.kt)("em",{parentName:"p"},"formulaObj")," parameter, pass an object containing the 4D formulas that can be called from 4D View Pro formulas as well as additional properties. Each ",(0,a.kt)("inlineCode",{parentName:"p"},"customFunction")," property passed in ",(0,a.kt)("em",{parentName:"p"},"formulaObj")," becomes the name of a function in the 4D View Pro area."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Property"),(0,a.kt)("th",r({parentName:"tr"},{align:null})),(0,a.kt)("th",r({parentName:"tr"},{align:null})),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Type"),(0,a.kt)("th",r({parentName:"tr"},{align:null}),"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null}),(0,a.kt)("inlineCode",{parentName:"td"},"<customFunction>")),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Custom function definition. ",(0,a.kt)("inlineCode",{parentName:"td"},"<customFunction>")," defines the name of the custom function to display in 4D View Pro formulas (no spaces allowed)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"formula"),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Object"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"4D formula object (mandatory). See the ",(0,a.kt)("inlineCode",{parentName:"td"},"Formula")," command.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"parameters"),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Collection of objects"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Collection of parameters (in the order they are defined in the formula). For more information, please refer to the ",(0,a.kt)("a",r({parentName:"td"},{href:"/docs/ViewPro/formulas#parameters"}),"Parameters")," section.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"["," ].name"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Name of parameter to display in 4D View Pro")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"["," ].type"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Type of the parameter. Supported types:",(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is Boolean")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is collection")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is date")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is Integer")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is object")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is real")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is text")),(0,a.kt)("li",null,(0,a.kt)("inlineCode",{parentName:"td"},"Is time")),(0,a.kt)("em",{parentName:"td"},"type")," can be omitted or the default value (-1) can be passed (except when at least one parameter is of collection type, in which case parameter's type declaration is mandatory). ",(0,a.kt)("br",null)," If ",(0,a.kt)("em",{parentName:"td"},"type")," is omitted or -1, the value is automatically sent with its type, except date or time values which are sent as an object. If ",(0,a.kt)("em",{parentName:"td"},"type")," is ",(0,a.kt)("inlineCode",{parentName:"td"},"Is object"),", the object is sent in a ",(0,a.kt)("inlineCode",{parentName:"td"},".value")," property. See ",(0,a.kt)("a",r({parentName:"td"},{href:"/docs/ViewPro/formulas#parameters"}),"Parameters")," section.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"summary"),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Text"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Formula description to display in 4D View Pro")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"minParams"),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Minimum number of parameters")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"maxParams"),(0,a.kt)("td",r({parentName:"tr"},{align:null})),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Number"),(0,a.kt)("td",r({parentName:"tr"},{align:null}),"Maximum number of parameters. Passing a number higher than the length of ",(0,a.kt)("em",{parentName:"td"},"parameters"),' allows declaring "optional" parameters with default type')))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"WARNING"))),(0,a.kt)("blockquote",null,(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"As soon as ",(0,a.kt)("inlineCode",{parentName:"li"},"VP SET CUSTOM FUNCTIONS")," is called, the methods allowed by the ",(0,a.kt)("a",r({parentName:"li"},{href:"/docs/ViewPro/commands/vp-set-allowed-methods"}),"VP SET ALLOWED METHODS")," command (if any) are ignored in the 4D View Pro area."),(0,a.kt)("li",{parentName:"ul"},"As soon as ",(0,a.kt)("inlineCode",{parentName:"li"},"VP SET CUSTOM FUNCTIONS")," is called, the functions based upon ",(0,a.kt)("inlineCode",{parentName:"li"},"SET TABLE TITLES")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"SET FIELD TITLES")," commands are ignored in the 4D View Pro area."))),(0,a.kt)("h4",r({},{id:"example"}),"Example"),(0,a.kt)("p",null,"You want to use formula objects in a 4D View Pro area to add numbers, retrieve a customer's last name and gender and the company's peak month:"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-4d"}),'Case of\n    :(FORM Event.code=On Load)\n \n       var $o : Object\n       $o:=New object\n \n// Define "addnum" function from a method named "addnum"\n       $o.addnum:=New object\n       $o.addnum.formula:=Formula(addnum)\n       $o.addnum.parameters:=New collection\n       $o.addnum.parameters.push(New object("name";"num1";"type";Is Integer))\n       $o.addnum.parameters.push(New object("name";"num2";"type";Is Integer))\n \n// Define "ClientLastName" function from a database field\n       $o.ClientLastName:=New object\n       $o.ClientLastName.formula:=Formula([Customers]lastname)\n       $o.ClientLastName.summary:="Lastname of the current client"\n \n// Define "label" function from a 4D expression with one parameter\n       $o.label:=New object\n       $o.label.formula:=Formula(ds.Customers.get($1).label)\n       $o.label.parameters:=New collection\n       $o.label.parameters.push(New object("name";"ID";"type";Is Integer))\n \n// Define "AverageValues" function from a method named "AverageValues"\n       $o.AverageValues:=New object\n       $o.AverageValues.formula:=Formula(AverageValues)\n       $o.AverageValues.parameters:=New collection\n       $o.AverageValues.parameters.push(New object("name";"Mycollection";"type";Is collection))\n        \n// Define "Title" function from a variable named "Title"\n       $o.Title:=New object\n       $o.Title.formula:=Formula(Title)\n \n       VP SET CUSTOM FUNCTIONS("ViewProArea";$o)\n \nEnd case\n')),(0,a.kt)("h4",r({},{id:"see-also"}),"See also"),(0,a.kt)("p",null,(0,a.kt)("a",r({parentName:"p"},{href:"/docs/ViewPro/formulas#4d-functions"}),"4D functions"),(0,a.kt)("br",null),"\n",(0,a.kt)("a",r({parentName:"p"},{href:"/docs/ViewPro/commands/vp-set-allowed-methods"}),"VP SET ALLOWED METHODS"),(0,a.kt)("br",null),"\n",(0,a.kt)("a",r({parentName:"p"},{href:"https://blog.4d.com/4d-view-pro-enhancement-of-custom-functions"}),"4D View Pro: enhancement of custom functions (blog post)")))}d.isMDXComponent=!0}}]);