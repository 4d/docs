"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["68438"],{19753:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>c,metadata:()=>r,assets:()=>o,toc:()=>a,contentTitle:()=>d});var r=JSON.parse('{"id":"commands-legacy/sql-execute-script","title":"SQL EXECUTE SCRIPT","description":"SQL EXECUTE SCRIPT ( scriptPath ; errorAction {; attribName ; attribValue} {; attribName2 ; attribValue2 ; ... ; attribNameN ; attribValueN} )","source":"@site/versioned_docs/version-20-R7/commands-legacy/sql-execute-script.md","sourceDirName":"commands-legacy","slug":"/commands/sql-execute-script","permalink":"/docs/commands/sql-execute-script","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fsql-execute-script.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"sql-execute-script","title":"SQL EXECUTE SCRIPT","slug":"/commands/sql-execute-script","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"SQL EXECUTE","permalink":"/docs/commands/sql-execute"},"next":{"title":"SQL EXPORT DATABASE","permalink":"/docs/commands/sql-export-database"}}'),s=t("785893"),i=t("250065");let c={id:"sql-execute-script",title:"SQL EXECUTE SCRIPT",slug:"/commands/sql-execute-script",displayed_sidebar:"docs"},d=void 0,o={},a=[{value:"Description",id:"description",level:4},{value:"Properties",id:"properties",level:4}];function l(e){let n={a:"a",br:"br",em:"em",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SQL EXECUTE SCRIPT"})," ( ",(0,s.jsx)(n.em,{children:"scriptPath"})," ; ",(0,s.jsx)(n.em,{children:"errorAction"})," {; ",(0,s.jsx)(n.em,{children:"attribName"})," ; ",(0,s.jsx)(n.em,{children:"attribValue"}),"} {; ",(0,s.jsx)(n.em,{children:"attribName2"})," ; ",(0,s.jsx)(n.em,{children:"attribValue2"})," ; ... ; ",(0,s.jsx)(n.em,{children:"attribNameN"})," ; ",(0,s.jsx)(n.em,{children:"attribValueN"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"scriptPath"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Complete pathname of file containing SQL script to execute"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"errorAction"}),(0,s.jsx)(n.td,{children:"Integer"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Action to carry out in case of error during script execution"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"attribName"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Name of attribute to use"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"attribValue"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{children:"\u2192"}),(0,s.jsx)(n.td,{children:"Value of attribute"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"SQL EXECUTE SCRIPT"})," command is used to execute a series of SQL statements placed in the script file designated by ",(0,s.jsx)(n.em,{children:"scriptPath"}),". This command can only be executed on a local machine (local 4D or stored procedure on 4D Server). It works with the current database (internal or external database)."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," This command cannot be used with an external connection that is opened directly or via ODBC."]}),"\n",(0,s.jsxs)(n.p,{children:["Pass the complete pathname of the text file containing the SQL statements to be executed in the ",(0,s.jsx)(n.em,{children:"scriptPath"}),' parameter. The pathname must be expressed using the syntax of the current system. If you pass an empty string ("") in ',(0,s.jsx)(n.em,{children:"scriptPath"}),", a standard Open document dialog box will be displayed so that the user can select the script file to be executed."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," The ",(0,s.jsx)(n.a,{href:"/docs/commands/sql-export-database",children:"SQL EXPORT DATABASE"})," and ",(0,s.jsx)(n.a,{href:"/docs/commands/sql-export-selection",children:"SQL EXPORT SELECTION"})," commands automatically generate this script file."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"errorAction"})," parameter is used to configure the functioning of the command when an error occurs during script execution. You can pass one of the three following constants, placed in the ",(0,s.jsx)(n.em,{children:"SQL"})," theme:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Constant"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Comment"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SQL On error abort"}),(0,s.jsx)(n.td,{children:"Integer"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"In the event of an error, 4D immediately stops script execution."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SQL On error confirm"}),(0,s.jsx)(n.td,{children:"Integer"}),(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"In the event of an error, 4D displays a dialog box describing the error and allowing the user to interrupt or continue script execution."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SQL On error continue"}),(0,s.jsx)(n.td,{children:"Integer"}),(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"In the event of an error, 4D ignores it and continues script execution."})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"attribName"})," and ",(0,s.jsx)(n.em,{children:"attribValue"})," parameters must be passed by pairs. These parameters are intended to be used to specify specific attributes for the script execution. In the current version of 4D, a single attribute can be passed in ",(0,s.jsx)(n.em,{children:"attribName"}),", available via the following constant, placed in the ",(0,s.jsx)(n.em,{children:"SQL"})," theme:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Constant"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Comment"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SQL use access rights"}),(0,s.jsx)(n.td,{children:"Text"}),(0,s.jsx)(n.td,{children:"SQL_Use_Access_Rights"}),(0,s.jsxs)(n.td,{children:["Used to restrict the access rights to be applied during execution of the SQL commands of the script. When you use this attribute, you must pass 0 or 1 in ",(0,s.jsx)(n.em,{children:"attribValue"}),": ",(0,s.jsx)(n.br,{}),(0,s.jsx)(n.em,{children:"attribValue"})," = 1: 4D uses the access rights of the current 4D user.",(0,s.jsx)(n.em,{children:"attribValue"})," = 0 (or attribute not specified): 4D does not restrict access, the Designer rights are used."]})]})})]}),"\n",(0,s.jsxs)(n.p,{children:["If the 4D log file is activated (via the selectors 28 or 45 of the ",(0,s.jsx)(n.a,{href:"/docs/commands/set-database-parameter",children:"SET DATABASE PARAMETER"})," command), each SQL command executed will generate an entry with the following information:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Type of SQL command"}),"\n",(0,s.jsx)(n.li,{children:"Number of records affected by the command"}),"\n",(0,s.jsx)(n.li,{children:"Duration of command execution"}),"\n",(0,s.jsxs)(n.li,{children:["For each error encountered:\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"the error code"}),"\n",(0,s.jsx)(n.li,{children:"the error text if available"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If the script is executed correctly (no error occurs), the ",(0,s.jsx)(n.em,{children:"OK"})," system variable is set to 1. In the event of an error, the ",(0,s.jsx)(n.em,{children:"OK"})," system variable is set to 0 or not according to the ",(0,s.jsx)(n.em,{children:"errorAction"})," parameter:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.em,{children:"errorAction"})," is SQL On error abort (value 1), ",(0,s.jsx)(n.em,{children:"OK"})," is set to 0."]}),"\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.em,{children:"errorAction"})," is SQL On error confirm (value 2), the ",(0,s.jsx)(n.em,{children:"OK"})," variable is set to 0 if the user chooses to stop the operation and 1 if they choose to continue ."]}),"\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.em,{children:"errorAction"})," is SQL On error continue (value 3), the ",(0,s.jsx)(n.em,{children:"OK"})," variable is always 1."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," If you use this command to execute memory-consuming actions such as massive data imports, you can consider calling the ",(0,s.jsx)(n.em,{children:"ALTER DATABASE"})," SQL command in order to temporarily disable the SQL options."]}),"\n",(0,s.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Command number"}),(0,s.jsx)(n.td,{children:"1089"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Thread safe"}),(0,s.jsx)(n.td,{children:"\u2717"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Modifies variables"}),(0,s.jsx)(n.td,{children:"OK"})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return d},a:function(){return c}});var r=t(667294);let s={},i=r.createContext(s);function c(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);