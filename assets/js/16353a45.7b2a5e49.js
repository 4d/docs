"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["25954"],{704278:function(e,n,s){s.r(n),s.d(n,{metadata:()=>t,contentTitle:()=>d,default:()=>h,assets:()=>l,toc:()=>a,frontMatter:()=>o});var t=JSON.parse('{"id":"commands-legacy/on-event-call","title":"ON EVENT CALL","description":"ON EVENT CALL ( eventMethod {; processName} )","source":"@site/versioned_docs/version-20-R7/commands-legacy/on-event-call.md","sourceDirName":"commands-legacy","slug":"/commands/on-event-call","permalink":"/docs/commands/on-event-call","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fon-event-call.md%20(20-R7)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R7","frontMatter":{"id":"on-event-call","title":"ON EVENT CALL","slug":"/commands/on-event-call","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"ON ERR CALL","permalink":"/docs/commands/on-err-call"},"next":{"title":"SET ASSERT ENABLED","permalink":"/docs/commands/set-assert-enabled"}}'),i=s("785893"),r=s("250065");let o={id:"on-event-call",title:"ON EVENT CALL",slug:"/commands/on-event-call",displayed_sidebar:"docs"},d=void 0,l={},a=[{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4},{value:"See also",id:"see-also",level:4},{value:"Properties",id:"properties",level:4}];function c(e){let n={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," ( ",(0,i.jsx)(n.em,{children:"eventMethod"})," {; ",(0,i.jsx)(n.em,{children:"processName"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"eventMethod"}),(0,i.jsx)(n.td,{children:"Text"}),(0,i.jsx)(n.td,{children:"\u2192"}),(0,i.jsx)(n.td,{children:"Event method to be invoked, or Empty string to stop intercepting events"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"processName"}),(0,i.jsx)(n.td,{children:"Text"}),(0,i.jsx)(n.td,{children:"\u2192"}),(0,i.jsx)(n.td,{children:"Process name"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," command installs the method, whose name you pass in ",(0,i.jsx)(n.em,{children:"eventMethod"}),", as the method for catching (trapping) events. This method is called the ",(0,i.jsx)(n.strong,{children:"event-handling method"})," or ",(0,i.jsx)(n.strong,{children:"event-catching method"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tip:"})," This command requires advanced programming knowledge. Usually, you do not need to use ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," for working with events. While using forms, 4D handles the events and sends them to the appropriate forms and objects."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tip:"})," Commands such as ",(0,i.jsx)(n.a,{href:"/docs/commands/mouse-position",children:"MOUSE POSITION"}),", ",(0,i.jsx)(n.a,{href:"/docs/commands/shift-down",children:"Shift down"}),", etc., can be used for getting information about events. These commands can be called from within object methods to get the information you need about an event involving an object. Using them spares you the writing of an algorithm based on the ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," scheme."]}),"\n",(0,i.jsxs)(n.p,{children:["The scope of this command is the current working session. By default, the method is run in a separate local process. You can have only one event-handling method at a time. To stop catching events with a method, call ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," again and pass an empty string in ",(0,i.jsx)(n.em,{children:"eventMethod"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Since the event-handling method is run in a separate process, it is constantly active, even if no 4D method is running. After installation, 4D calls the event-handling method each time an event occurs. An event can be a mouse click or a keystroke."}),"\n",(0,i.jsxs)(n.p,{children:["The optional ",(0,i.jsx)(n.em,{children:"processName"})," parameter names the process created by the ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," command. If ",(0,i.jsx)(n.em,{children:"processName"})," is prefixed with a dollar sign (",(0,i.jsx)(n.em,{children:"$"}),"), a local process is started, which is usually what you want. If you omit the ",(0,i.jsx)(n.em,{children:"processName"})," parameter, 4D creates, by default, a local process named ",(0,i.jsx)(n.em,{children:"$Event Manager"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"WARNING:"})," Be very careful in what you do within an event-handling method. Do NOT call commands that generate events, otherwise it will be extremely difficult to get out of the event-handling method execution. The key combination ",(0,i.jsx)(n.strong,{children:"Ctrl+Shift+Backspace"})," (on Windows) or ",(0,i.jsx)(n.strong,{children:"Command-Shift-Control-Backspace"})," (on Macintosh) allows you to kill the Event Manager process. You may want to use this technique to recover an event-handling gone wrong (i.e., one that has bugs triggering events)."]}),"\n",(0,i.jsx)(n.p,{children:"In the event-handling method, you can read the following system variables\u2014MouseDown, KeyCode, Modifiers, MouseX, MouseY and MouseProc. Note that these variables are process variables. Their scope is therefore the event-handling process. Copy them into interprocess variables if you want their values available in another process."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The MouseDown system variable is set to 1 if the event is a mouse click, and to 0 if it is not."}),"\n",(0,i.jsxs)(n.li,{children:["The KeyCode system variable is set to the code for a keystroke. This variable may return an character code or a function key code. These codes are listed in the sections ",(0,i.jsx)(n.em,{children:"Unicode Codes"})," and ",(0,i.jsx)(n.a,{href:"/docs/commands/export-text",children:"EXPORT TEXT"})," (and its subsections) as well as in the section ",(0,i.jsx)(n.em,{children:"Function Key Codes"}),". 4D provides predefined constants for the major ASCII Codes and for Function Keys. In the Explorer window, look for the themes of these constants."]}),"\n",(0,i.jsx)(n.li,{children:"The Modifiers system variable contains the modifier value. It indicates whether a modifier key was down when the event occurred. The following keys can be detected:"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Platform"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Modifiers"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Windows"}),(0,i.jsx)(n.td,{children:"Shift key, Caps Lock, Alt key, Ctrl key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Macintosh"}),(0,i.jsx)(n.td,{children:"Shift key, Caps Lock, Alt (or Option) key, Command key, Ctrl key"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"The modifier keys do not generate an event on their own; another key or the mouse button must also be pressed. The Modifiers variable is a Long Integer variable containing a bit field. 4D provides predefined constants specifying the bit position or bit mask for each modifier key. For example, to detect if the Shift key was pressed for the event, you can write either:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:"\xa0If(Modifiers?? Shift key bit)\xa0//If the Shift key was down  \n"})}),"\n",(0,i.jsx)(n.p,{children:"or:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:"\xa0If((Modifiers&Shift key mask)#0)\xa0//If the Shift key was down  \n"})}),"\n",(0,i.jsxs)(n.p,{children:["You can use one of the following constants, depending on the modifier key to be tested and the platform, which are found in the ",(0,i.jsx)(n.em,{children:"Events (Modifiers)"})," theme:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Modifier"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Constant"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Shift"}),(0,i.jsx)(n.td,{children:"Shift key bit / Shift key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Caps Lock"}),(0,i.jsx)(n.td,{children:"Caps lock key bit / Caps lock key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Alt (also called Option under OS X)"}),(0,i.jsx)(n.td,{children:"Option key bit / Option key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Ctrl under Windows"}),(0,i.jsx)(n.td,{children:"Command key bit / Command key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Ctrl under OS X"}),(0,i.jsx)(n.td,{children:"Control key bit / Control key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Command under OS X"}),(0,i.jsx)(n.td,{children:"Command key bit / Command key mask"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Right click"}),(0,i.jsx)(n.td,{children:"Control key bit / Control key mask"})]})]})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The system variables MouseX and MouseY contain the horizontal and vertical positions of the mouse click, expressed in the local coordinate system of the window where the click occurred. The upper left corner of the window is position 0,0. These are meaningful only when there is a mouse click."}),"\n",(0,i.jsx)(n.li,{children:"The MouseProc system variable contains the process reference number of the process in which the event occurred (mouse click)."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," The system variables MouseDown, KeyCode, Modifiers, MouseX, MouseY, and MouseProc contain significant values only within an event-handling method installed with ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["This example will cancel printing if the user presses ",(0,i.jsx)(n.strong,{children:"Ctrl+period"}),". First, the event-handling method is installed. Then a message is displayed, announcing that the user can cancel printing. If the interprocess variable ",(0,i.jsx)(n.em,{children:"\u25CAvbWeStop"})," is set to True in the event-handling method, the user is alerted to the number of records that have already been printed. Then the event-handling method is deinstalled:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:'\xa0PAGE SETUP\n\xa0If(OK=1)\n\xa0\xa0\xa0\xa0\u25CAvbWeStop:=False\n\xa0\xa0\xa0\xa0ON EVENT CALL("EVENT HANDLER")\xa0// Installs the event-handling method\n\xa0\xa0\xa0\xa0ALL RECORDS([People])\n\xa0\xa0\xa0\xa0MESSAGE("To interrupt printing press Ctrl+Period")\n\xa0\xa0\xa0\xa0$vlNbRecords:=Records in selection([People])\n\xa0\xa0\xa0\xa0For($vlRecord;1;$vlNbRecords)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0If(\u25CAvbWeStop)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ALERT("Printing cancelled at record "+String($vlRecord)+" of "+String($vlNbRecords))\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$vlRecord:=$vlNbRecords+1\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Print form([People];"Special Report")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End if\n\xa0\xa0\xa0\xa0End for\n\xa0\xa0\xa0\xa0PAGE BREAK\n\xa0\xa0\xa0\xa0ON EVENT CALL("")\xa0// Deinstalls the event-handling method\n\xa0End if\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.strong,{children:"Ctrl+period"})," has been pressed, the event-handling method sets ",(0,i.jsx)(n.em,{children:"\u25CAvbWeStop"})," to True:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-4d",children:'\xa0\xa0// EVENT HANDLER project method\n\xa0If((Modifiers?? Command key bit)\xa0&\xa0(KeyCode=Period))\n\xa0\xa0\xa0\xa0CONFIRM("Are you sure?")\n\xa0\xa0\xa0\xa0If(OK=1)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\u25CAvbWeStop:=True\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0FILTER EVENT\xa0// Do NOT forget this call; otherwise 4D will also get this event\n\xa0\xa0\xa0\xa0End if\n\xa0End if\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Note that this example uses ",(0,i.jsx)(n.strong,{children:"ON EVENT CALL"})," because it performs a special printing report using the ",(0,i.jsx)(n.em,{children:"_o_PAGE SETUP"}),", ",(0,i.jsx)(n.a,{href:"/docs/commands/print-form",children:"Print form"})," and ",(0,i.jsx)(n.a,{href:"/docs/commands/page-break",children:"PAGE BREAK"})," commands with a ",(0,i.jsx)(n.a,{href:"/docs/commands/array-to-list",children:"ARRAY TO LIST"})," loop."]}),"\n",(0,i.jsxs)(n.p,{children:["If you print a report using ",(0,i.jsx)(n.a,{href:"/docs/commands/print-selection",children:"PRINT SELECTION"}),", you do NOT need to handle events that let the user interrupt the printing; this command does that for you."]}),"\n",(0,i.jsx)(n.h4,{id:"see-also",children:"See also"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/docs/commands/filter-event",children:"FILTER EVENT"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"/docs/commands/mouse-position",children:"MOUSE POSITION"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"/docs/commands/method-called-on-event",children:"Method called on event"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"/docs/commands/shift-down",children:"Shift down"})]}),"\n",(0,i.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{}),(0,i.jsx)(n.th,{})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Command number"}),(0,i.jsx)(n.td,{children:"190"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Thread safe"}),(0,i.jsx)(n.td,{children:"\u2717"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Forbidden on the server"}),(0,i.jsx)(n.td,{})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return d},a:function(){return o}});var t=s(667294);let i={},r=t.createContext(i);function o(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);