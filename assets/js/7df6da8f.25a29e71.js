"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6445],{214446:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>d,toc:()=>i});var o=n(474848),r=n(28453);const s={id:"execute-method-in-subform",title:"EXECUTE METHOD IN SUBFORM",slug:"/commands/execute-method-in-subform",displayed_sidebar:"docs"},a=void 0,d={id:"commands-legacy/execute-method-in-subform",title:"EXECUTE METHOD IN SUBFORM",description:"EXECUTE METHOD IN SUBFORM ( subformObject ; formula {; return {; param} {; param2 ; ... ; paramN}} )",source:"@site/versioned_docs/version-20-R7/commands-legacy/execute-method-in-subform.md",sourceDirName:"commands-legacy",slug:"/commands/execute-method-in-subform",permalink:"/docs/commands/execute-method-in-subform",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fexecute-method-in-subform.md%20(20-R7)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R7",frontMatter:{id:"execute-method-in-subform",title:"EXECUTE METHOD IN SUBFORM",slug:"/commands/execute-method-in-subform",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"Deactivated",permalink:"/docs/commands/deactivated"},next:{title:"FORM Event",permalink:"/docs/commands/form-event"}},c={},i=[{value:"Description",id:"description",level:4},{value:"Example 1",id:"example-1",level:4},{value:"Example 2",id:"example-2",level:4},{value:"System variables and sets",id:"system-variables-and-sets",level:4}];function l(e){const t={br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"EXECUTE METHOD IN SUBFORM"})," ( ",(0,o.jsx)(t.em,{children:"subformObject"})," ; ",(0,o.jsx)(t.em,{children:"formula"})," {; ",(0,o.jsx)(t.em,{children:"return"})," {; ",(0,o.jsx)(t.em,{children:"param"}),"} {; ",(0,o.jsx)(t.em,{children:"param2"})," ; ... ; ",(0,o.jsx)(t.em,{children:"paramN"}),"}} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Parameter"}),(0,o.jsx)(t.th,{children:"Type"}),(0,o.jsx)(t.th,{}),(0,o.jsx)(t.th,{children:"Description"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"subformObject"}),(0,o.jsx)(t.td,{children:"Text"}),(0,o.jsx)(t.td,{children:"\u2192"}),(0,o.jsx)(t.td,{children:"Name of subform object"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"formula"}),(0,o.jsx)(t.td,{children:"Object, Text"}),(0,o.jsx)(t.td,{children:"\u2192"}),(0,o.jsx)(t.td,{children:"Formula object or Name of project method"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"return"}),(0,o.jsx)(t.td,{children:"*, Variable"}),(0,o.jsx)(t.td,{children:"\u2192"}),(0,o.jsx)(t.td,{children:"* if formula does not return a value"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"\u2190"}),(0,o.jsx)(t.td,{children:"Value returned by formula"}),(0,o.jsx)(t.td,{}),(0,o.jsx)(t.td,{})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"param"}),(0,o.jsx)(t.td,{children:"Expression"}),(0,o.jsx)(t.td,{children:"\u2192"}),(0,o.jsx)(t.td,{children:"Parameter(s) passed to formula"})]})]})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"This command is not thread-safe, it cannot be used in preemptive code."})}),"\n",(0,o.jsx)(t.h4,{id:"description",children:"Description"}),"\n",(0,o.jsxs)(t.p,{children:["The EXECUTE METHOD IN SUBFORM command can be used to execute the code designated by ",(0,o.jsx)(t.em,{children:"formula"})," in the context of the ",(0,o.jsx)(t.em,{children:"subformObject"})," subform object."]}),"\n",(0,o.jsxs)(t.p,{children:["The called code can receive from 1 to X parameters in ",(0,o.jsx)(t.em,{children:"param"})," and return a value in ",(0,o.jsx)(t.em,{children:"return"}),". Pass ",(0,o.jsx)(t.em,{children:"*"})," in the ",(0,o.jsx)(t.em,{children:"return"})," parameter if the code does not return parameters."]}),"\n",(0,o.jsxs)(t.p,{children:["In ",(0,o.jsx)(t.em,{children:"formula"}),", you designate the 4D code to be executed in the context of ",(0,o.jsx)(t.em,{children:"subformObject"}),". You can pass either:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["a ",(0,o.jsx)(t.strong,{children:"formula object"})," (see ",(0,o.jsx)(t.em,{children:"Formula Objects"}),"). Formula objects can encapsulate any executable expressions, including functions and project methods;"]}),"\n",(0,o.jsxs)(t.li,{children:["a ",(0,o.jsx)(t.strong,{children:"string"})," containing the name of a project method."]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:'The execution context is preserved in the called code, which means that the current form and current form event remain specified. If the subform comes from a component, a called method or function must belong to the component and have the "Shared by components and host database" property.'}),"\n",(0,o.jsxs)(t.p,{children:["This command must be called in the context of the parent form (containing the ",(0,o.jsx)(t.em,{children:"subformObject"})," object), for example via the form method."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Note:"})," The formula is not executed if the ",(0,o.jsx)(t.em,{children:"subformObject"})," is not found in the current page or is not yet instantiated."]}),"\n",(0,o.jsx)(t.h4,{id:"example-1",children:"Example 1"}),"\n",(0,o.jsx)(t.p,{children:'Given the "ContactDetail" form used as subform in the parent form "Company". The subform object that contains the ContactDetail form is named "ContactSubform". Imagine that we want to modify the appearance of certain elements of the subform according to the value of the field(s) of the company (for example, "contactname" must switch to red when [Company]City="New York" and to blue when [Company]City="San Diego"). This mechanism is implemented via the SetToColor method. To be able to get this result, the SetToColor method cannot be called directly from the process of the "On Load" form event of the Company parent form because the "contactname" object does not belong to the current form, but to the form displayed in the "ContactSubform" subform object. The method must therefore be executed using the EXECUTE METHOD IN SUBFORM command in order to function correctly.'}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-4d",children:'\xa0Case of\n\xa0\xa0\xa0\xa0:(Form event code=On Load)\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0Case of\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:([Company]City="New York")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Red\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0:([Company]City="San Diego")\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Blue\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Else\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0$Color:=$Black\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0End case\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0EXECUTE METHOD IN SUBFORM("ContactSubform";Formula(SetToColor);*;$Color)\n\xa0End case\n'})}),"\n",(0,o.jsx)(t.h4,{id:"example-2",children:"Example 2"}),"\n",(0,o.jsxs)(t.p,{children:["You are developing a database that will be used as a component. It includes a shared project form (named, for instance, Calendar) that contains ",(0,o.jsx)(t.em,{children:"dynamic variables"})," as well as a public project method that is used to adjust the calendar: SetCalendarDate(varDate).",(0,o.jsx)(t.br,{}),'\nIf this method was used directly in the Calendar form method, you could call it directly in the "On Load" event:']}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-4d",children:"\xa0SetCalendarDate(Current date)\n"})}),"\n",(0,o.jsx)(t.p,{children:'But, in the context of the host database, imagine that a project form contains two "Calendar" subforms, in subform objects called "Cal1" and "Cal2". You must set the date of Cal1 to 01/01/10 and the date of Cal2 to 05/05/10. You cannot call SetCalendarDate directly because the method will not "know" which forms and variables it should apply. Therefore, you must call it via the following code:'}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-4d",children:'\xa0EXECUTE METHOD IN SUBFORM("Cal1";Formula(SetCalendarDate);*;!01/01/20!)\n\xa0EXECUTE METHOD IN SUBFORM("Cal2";Formula(SetCalendarDate);*;!05/05/20!)\n'})}),"\n",(0,o.jsx)(t.h4,{id:"system-variables-and-sets",children:"System variables and sets"}),"\n",(0,o.jsx)(t.p,{children:"If this command is executed correctly, the system variable OK is set to 1; otherwise, it is set to 0."})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>d});var o=n(296540);const r={},s=o.createContext(r);function a(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);