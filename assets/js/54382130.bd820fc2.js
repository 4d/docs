"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[24699],{826189:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var s=n(474848),r=n(28453);const a={id:"sql-set-parameter",title:"SQL SET PARAMETER",slug:"/commands/sql-set-parameter",displayed_sidebar:"docs"},o=void 0,i={id:"commands-legacy/sql-set-parameter",title:"SQL SET PARAMETER",description:"SQL SET PARAMETER ( object ; paramType )",source:"@site/versioned_docs/version-20-R7/commands-legacy/sql-set-parameter.md",sourceDirName:"commands-legacy",slug:"/commands/sql-set-parameter",permalink:"/docs/commands/sql-set-parameter",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fsql-set-parameter.md%20(20-R7)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R7",frontMatter:{id:"sql-set-parameter",title:"SQL SET PARAMETER",slug:"/commands/sql-set-parameter",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"SQL SET OPTION",permalink:"/docs/commands/sql-set-option"},next:{title:"START SQL SERVER",permalink:"/docs/commands/start-sql-server"}},d={},l=[{value:"Description",id:"description",level:4},{value:"Example 1",id:"example-1",level:4},{value:"Example 2",id:"example-2",level:4},{value:"System variables and sets",id:"system-variables-and-sets",level:4}];function c(e){const t={a:"a",br:"br",code:"code",em:"em",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"SQL SET PARAMETER"})," ( ",(0,s.jsx)(t.em,{children:"object"})," ; ",(0,s.jsx)(t.em,{children:"paramType"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Parameter"}),(0,s.jsx)(t.th,{children:"Type"}),(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"object"}),(0,s.jsx)(t.td,{children:"Object"}),(0,s.jsx)(t.td,{children:"\u2192"}),(0,s.jsx)(t.td,{children:"4D object to be used (variable, array or field)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"paramType"}),(0,s.jsx)(t.td,{children:"Integer"}),(0,s.jsx)(t.td,{children:"\u2192"}),(0,s.jsx)(t.td,{children:"Type of parameter"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"This command is not thread-safe, it cannot be used in preemptive code."})}),"\n",(0,s.jsx)(t.h4,{id:"description",children:"Description"}),"\n",(0,s.jsx)(t.p,{children:"The SQL SET PARAMETER command allows the use of a 4D variable, array or field value in SQL requests."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note:"})," It is also possible to directly insert the name of a 4D object to be used (variable, array or field) between the ",(0,s.jsx)(t.em,{children:"<<"})," and ",(0,s.jsx)(t.em,{children:">>"})," characters in the text of the request (see example 1). For more information about this, please refer to the ",(0,s.jsx)(t.em,{children:"Overview of SQL Commands"})," section."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["In the ",(0,s.jsx)(t.em,{children:"object"})," parameter, pass the 4D object (variable, array or field) to be used in the request."]}),"\n",(0,s.jsxs)(t.li,{children:["In the ",(0,s.jsx)(t.em,{children:"paramType"})," parameter, pass the SQL type of the parameter. You can pass a value or use one of the following constants, located in the \u201c",(0,s.jsx)(t.em,{children:"SQL"}),"\u201d theme:",(0,s.jsx)(t.br,{}),"\n| Constant         | Type    | Value | Comment                                                                                                  |",(0,s.jsx)(t.br,{}),"\n| ---------------- | ------- | ----- | -------------------------------------------------------------------------------------------------------- |",(0,s.jsx)(t.br,{}),"\n| SQL param in     | Longint | 1     |                                                                                                          |",(0,s.jsx)(t.br,{}),"\n| SQL param in out | Longint | 2     | Usable only in the context of an SQL stored procedure (in-out parameter defined in the stored procedure) |",(0,s.jsx)(t.br,{}),"\n| SQL param out    | Longint | 4     | Usable only in the context of an SQL stored procedure (out parameter defined in the stored procedure)    |"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The value of the 4D object replaces the ",(0,s.jsx)(t.em,{children:"?"})," character in the SQL request (standard syntax). If the request contains more than one ",(0,s.jsx)(t.em,{children:"?"})," character, several calls to SQL SET PARAMETER will be necessary. The values of the 4D objects will be assigned sequentially in the request, in accordance with the execution order of the commands."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Warning:"})," This command is used for handling ",(0,s.jsx)(t.em,{children:"parameters"})," passed to the SQL request. It is not possible to use the SQL param out type to associate a 4D object with the ",(0,s.jsx)(t.em,{children:"result"})," of an SQL request. SQL request results are retrieved, for example, using the ",(0,s.jsx)(t.em,{children:"boundObj"})," parameter of the ",(0,s.jsx)(t.a,{href:"/docs/commands/sql-execute",children:"SQL EXECUTE"})," command (see the ",(0,s.jsx)(t.em,{children:"Overview of SQL Commands"}),"). The ",(0,s.jsx)(t.strong,{children:"SQL SET PARAMETER"})," command is mainly intended for setting parameters passed to the request (SQL param in); the SQL param out and SQL param in out types are reserved for use in the context of SQL stored procedures that could return parameters."]}),"\n",(0,s.jsx)(t.h4,{id:"example-1",children:"Example 1"}),"\n",(0,s.jsx)(t.p,{children:"This example is used to execute an SQL request which calls the associated 4D variables directly:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-4d",children:'\xa0var MyText : Text\n\xa0var MyLongint : Integer\n\xa0\n\xa0SQL LOGIN("mysql";"root";"")\n\xa0SQLStmt:="insert into app_testTable (alpha_field, longint_field) VALUES (<>, <>)"\n\xa0For(vCounter;1;10)\n\xa0\xa0\xa0\xa0MyText:="Text"+String(vCounter)\n\xa0\xa0\xa0\xa0MyLongint:=vCounter\n\xa0\xa0\xa0\xa0SQL EXECUTE(SQLStmt)\n\xa0\xa0\xa0\xa0SQL CANCEL LOAD\n\xa0End for\n\xa0SQL LOGOUT\n'})}),"\n",(0,s.jsx)(t.h4,{id:"example-2",children:"Example 2"}),"\n",(0,s.jsx)(t.p,{children:"Same example as the previous one, but using the SQL SET PARAMETER command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-4d",children:'\xa0var MyText : Text\n\xa0var MyLongint : Integer\n\xa0\n\xa0SQL LOGIN("mysql";"root";"")\n\xa0SQLStmt:="insert into app_testTable (alpha_field, longint_field) VALUES (?,?)"\n\xa0For(vCounter;1;10)\n\xa0\xa0\xa0\xa0MyText:="Text"+String(vCounter)\n\xa0\xa0\xa0\xa0MyLongint:=vCounter\n\xa0\xa0\xa0\xa0SQL SET PARAMETER(MyText;SQL param in)\n\xa0\xa0\xa0\xa0SQL SET PARAMETER(MyLongint;SQL param in)\n\xa0\xa0\xa0\xa0SQL EXECUTE(SQLStmt)\n\xa0\xa0\xa0\xa0SQL CANCEL LOAD\n\xa0End for\n\xa0SQL LOGOUT\n'})}),"\n",(0,s.jsx)(t.h4,{id:"system-variables-and-sets",children:"System variables and sets"}),"\n",(0,s.jsx)(t.p,{children:"If the command has been executed correctly, the system variable OK returns 1. Otherwise, it returns 0."})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var s=n(296540);const r={},a=s.createContext(r);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);