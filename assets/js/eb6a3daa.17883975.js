"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["6700"],{954298:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>d,toc:()=>h,default:()=>l,metadata:()=>s,assets:()=>a,contentTitle:()=>o});var s=JSON.parse('{"id":"commands-legacy/on-web-connection-database-method","title":"On Web Connection database method","description":"On Web Connection($url Text ; $ipBrowser Text ; $user Text) -> $result : Boolean","source":"@site/versioned_docs/version-20-R10/commands-legacy/on-web-connection-database-method.md","sourceDirName":"commands-legacy","slug":"/commands/on-web-connection-database-method","permalink":"/docs/commands/on-web-connection-database-method","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fon-web-connection-database-method.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"on-web-connection-database-method","title":"On Web Connection database method","slug":"/commands/on-web-connection-database-method","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"On Web Authentication database method","permalink":"/docs/commands/on-web-authentication-database-method"},"next":{"title":"On Web Legacy Close Session database method","permalink":"/docs/commands/on-web-legacy-close-session-database-method"}}'),r=t(785893),i=t(250065);let d={id:"on-web-connection-database-method",title:"On Web Connection database method",slug:"/commands/on-web-connection-database-method",displayed_sidebar:"docs"},o=void 0,a={},h=[{value:"On Web Connection Database Method Calls",id:"on-web-connection-database-method-calls",level:2}];function c(e){let n={a:"a",action:"action",br:"br",code:"code",em:"em",file:"file",h2:"h2",li:"li",p:"p",path:"path",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"On Web Connection($url : Text ; $http : Text ; $ipBrowser : Text ; $ipServer : Text ; $user : Text ; $pw : Text) -> $result : Boolean"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$url"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"URL"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$http"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"HTTP header + HTTP body"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$ipBrowser"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"IP address of browser"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$ipServer"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"IP address of the server"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$user"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"User name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$pw"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"\u2190"}),(0,r.jsx)(n.td,{children:"Password"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:""}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"On Web Connection database method"})," can be called in the following cases:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["the web server receives a request beginning with the ",(0,r.jsx)(n.em,{children:"4DCGI"})," URL."]}),"\n",(0,r.jsx)(n.li,{children:"the web server receives an invalid request."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The request should have previously been accepted by the ",(0,r.jsx)(n.a,{href:"/docs/commands/on-web-authentication-database-method",children:"On Web Authentication database method"})," (if it exists) and the web server must be launched."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"On Web Connection database method"})," receives six text parameters passed by 4D ($url, $http, $ipBrowser, $ipServer, $user, and $pw). These parameters are described in the following table:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Parameters"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Type"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$url"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"URL"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$http"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"HTTP header + HTTP body (up to 32 kb limit)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$ipBrowser"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"IP address of the Web client (browser)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$ipServer"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"IP address of the server"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$user"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"User name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"$pw"}),(0,r.jsx)(n.td,{children:"Text"}),(0,r.jsx)(n.td,{children:"Password"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"You must declare these parameters as shown below:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-4d",children:"\xa0\xa0// On Web Connection Database Method\n\xa0\n#DECLARE($url : Text ; $http : Text ; $ipBrowser : Text ; $ipServer : Text ;\\ $user : Text ; $pw : Text) -> $result : Boolean\n\xa0\n\xa0\xa0// Code for the method\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"URL extra data"}),(0,r.jsx)(n.br,{}),"\nThe first parameter (",(0,r.jsx)(n.em,{children:"$url"}),") is the URL entered by users in the address area of their web browser, without the host address.",(0,r.jsx)(n.br,{}),"\nLet\u2019s use an intranet connection as an example. Suppose that the IP address of your 4D Web Server machine is ",(0,r.jsx)(n.em,{children:"123.45.67.89"}),". The following table shows the values of ",(0,r.jsx)(n.em,{children:"$url"})," depending on the URL entered in the web browser:"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"URL entered in Web browser Location area"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Value of parameter $url"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"123.45.67.89"}),(0,r.jsx)(n.td,{children:"/"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"http://123.45.67.89",children:"http://123.45.67.89"})}),(0,r.jsx)(n.td,{children:"/"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"123.45.67.89/Customers"}),(0,r.jsx)(n.td,{children:"/Customers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"http://123.45.67.89/Customers",children:"http://123.45.67.89/Customers"})}),(0,r.jsx)(n.td,{children:"/Customers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"http://123.45.67.89/Customers/Add",children:"http://123.45.67.89/Customers/Add"})}),(0,r.jsx)(n.td,{children:"/Customers/Add"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"123.45.67.89/Do_This/If_OK/Do_That"}),(0,r.jsx)(n.td,{children:"/Do_This/If_OK/Do_That"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Note that you are free to use this parameter at your convenience. 4D simply ignores the value passed beyond the host part of the URL. For example, you can establish a convention where the value ",(0,r.jsx)(n.em,{children:'"/Customers/Add"'})," means \u201Cgo directly to add a new record in the ",(0,r.jsx)(n.em,{children:"[Customers]"})," table.\u201D By supplying the web users of your database with a list of possible values and/or default bookmarks, you can provide shortcuts to different parts of your application. This way, web users can quickly access resources of your website without going through the entire navigation path each time they make a new connection to your database."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ATTENTION:"})," In order to prevent a user from directly accessing a database with a bookmark created during a previous session, 4D intercepts any URL that corresponds to one of the standard 4D URLs."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Header and body of the HTTP request"}),(0,r.jsx)(n.br,{}),"\nThe second parameter (",(0,r.jsx)(n.em,{children:"$http"}),') is the header and the body of the HTTP request sent by the web browser. Note that this information is passed to your On Web Connection database method "as is". Its contents will vary depending on the nature of the web browser attempting the connection.']}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"With Safari running on Mac OS, you may receive a header similar to this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /favicon.ico HTTP/1.1Referer: http://123.45.67.89/4dcgi/testUser-Agent:  Mozilla/5.0 (Macintosh; U; Intel macOS; fr-fr) AppleWebKit/523.10.3  (KHTML, like Gecko) Version/3.0.4 Safari/523.10Cache-Control: max-age=0Accept: */*Accept-Language: fr-frAccept-Encoding: gzip, deflateConnection: keep-aliveHost: 123.45.67.89  \n"})}),"\n",(0,r.jsx)(n.p,{children:"With Microsoft Internet Explorer 8 running on Windows, you may receive a header similar to this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET / HTTP/1.1Accept: image/jpeg, application/x-ms-application,  image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap,  application/vnd.ms-powerpoint, application/vnd.ms-excel,  application/msword, */*Accept-Language: fr-FRUser-Agent:  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2;  .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center  PC 6.0; .NET4.0C)Accept-Encoding: gzip, deflateHost: 123.45.67.89Connection: Keep-Alive  \n"})}),"\n",(0,r.jsx)(n.p,{children:"If your application uses this information, it is up to you to parse the header and the body."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," For performance reasons, the size of this data cannot be more than 32 KB. Beyond this, they are truncated by the 4D HTTP server."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IP address of the web client"}),(0,r.jsx)(n.br,{}),"\nThe ",(0,r.jsx)(n.em,{children:"$ipBrowser"})," parameter receives the IP address of the browser\u2019s machine. This information can allow you to distinguish between intranet and internet connections."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," 4D returns IPv4 addresses in a hybrid IPv6/IPv4 format written with a 96-bit prefix, for example ::ffff:192.168.2.34 for the IPv4 address 192.168.2.34. For more information, refer to the ",(0,r.jsx)(n.em,{children:"Support of IPv6"})," section."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IP address of the server"}),(0,r.jsx)(n.br,{}),"\nThe ",(0,r.jsx)(n.em,{children:"$ipServer"})," parameter receives the IP address requested by the 4D Web Server. 4D allows for multi-homing, which allows you to use machines with more than one IP address. For more information, please refer to the section ",(0,r.jsx)(n.em,{children:"Web Server Settings"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User Name and Password"}),(0,r.jsx)(n.br,{}),"\nThe ",(0,r.jsx)(n.em,{children:"$user"})," and ",(0,r.jsx)(n.em,{children:"$pw"})," parameters receive the user name and password entered by the user in the standard identification dialog box displayed by the browser, if applicable. This dialog box appears for each connection, if the ",(0,r.jsx)(n.strong,{children:"Use Passwords"})," option has been selected in the Database Settings dialog box (see section ",(0,r.jsx)(n.em,{children:"Connection Security"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," If the user name sent by the browser exists in 4D, the ",(0,r.jsx)(n.em,{children:"$pw"})," parameter (the user\u2019s password) is not returned for security reasons."]}),"\n",(0,r.jsx)(n.h2,{id:"on-web-connection-database-method-calls",children:"On Web Connection Database Method Calls"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"On Web Connection database method"})," can be used as the entry point for the 4D Web server, either using the special ",(0,r.jsx)(n.em,{children:"4DCGI"})," URL, or using customized command URLs."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Warning:"})," Calling a 4D command that displays an interface element (",(0,r.jsx)(n.a,{href:"/docs/commands/dialog",children:"DIALOG"}),", ",(0,r.jsx)(n.a,{href:"/docs/commands/alert",children:"ALERT"}),", etc.) ends the method processing."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"On Web Connection database method"})," is therefore called in the following cases:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When 4D receives the ",(0,r.jsx)(n.em,{children:"/4DCGI"})," URL. The database method is called with the ",(0,r.jsxs)(n.em,{children:["/4DCGI/",(0,r.jsx)(n.action,{})]})," URL in ",(0,r.jsx)(n.em,{children:"$url"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["When a Web page is called with a URL of type ",(0,r.jsx)(n.em,{children:(0,r.jsxs)(n.path,{children:["/",(0,r.jsx)(n.file,{})]})})," is not found. The database method is called with the URL."]}),"\n",(0,r.jsxs)(n.li,{children:["When a Web page is called with a URL of type ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.file,{children:"/"})})," and no home page has been defined by default. The database method is called with the URL."]}),"\n"]})]})}function l(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,n,t){t.d(n,{Z:()=>o,a:()=>d});var s=t(667294);let r={},i=s.createContext(r);function d(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);