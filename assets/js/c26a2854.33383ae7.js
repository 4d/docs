"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["86394"],{258733:function(e,r,n){n.r(r),n.d(r,{default:()=>h,frontMatter:()=>l,metadata:()=>s,assets:()=>d,toc:()=>o,contentTitle:()=>i});var s=JSON.parse('{"id":"commands-legacy/selection-range-to-array","title":"SELECTION RANGE TO ARRAY","description":"SELECTION RANGE TO ARRAY ( start ; end ; aField ; array} {; aField2 ; array2 ; ... ; aFieldN ; arrayN} )SELECTION RANGE TO ARRAY ( start ; end ; aTable ; array {; aTable2 ; array2 ; ... ; aTableN ; arrayN} )","source":"@site/versioned_docs/version-20-R9/commands-legacy/selection-range-to-array.md","sourceDirName":"commands-legacy","slug":"/commands/selection-range-to-array","permalink":"/docs/commands/selection-range-to-array","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fselection-range-to-array.md%20(20-R9)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R9","frontMatter":{"id":"selection-range-to-array","title":"SELECTION RANGE TO ARRAY","slug":"/commands/selection-range-to-array","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"MULTI SORT ARRAY","permalink":"/docs/commands/multi-sort-array"},"next":{"title":"SELECTION TO ARRAY","permalink":"/docs/commands/selection-to-array"}}'),t=n("785893"),a=n("250065");let l={id:"selection-range-to-array",title:"SELECTION RANGE TO ARRAY",slug:"/commands/selection-range-to-array",displayed_sidebar:"docs"},i=void 0,d={},o=[{value:"Description",id:"description",level:2},{value:"Example 1",id:"example-1",level:2},{value:"Example 2",id:"example-2",level:2},{value:"Example 3",id:"example-3",level:2},{value:"Example 4",id:"example-4",level:2},{value:"See also",id:"see-also",level:2},{value:"Properties",id:"properties",level:2}];function c(e){let r={a:"a",br:"br",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," ( ",(0,t.jsx)(r.em,{children:"start"})," ; ",(0,t.jsx)(r.em,{children:"end"})," ; ",(0,t.jsx)(r.em,{children:"aField"})," ; ",(0,t.jsx)(r.em,{children:"array"}),"} {; aField2 ; ",(0,t.jsx)(r.em,{children:"array2"})," ; ... ; aFieldN ; ",(0,t.jsx)(r.em,{children:"arrayN"}),"} )",(0,t.jsx)(r.br,{}),(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," ( ",(0,t.jsx)(r.em,{children:"start"})," ; ",(0,t.jsx)(r.em,{children:"end"})," ; ",(0,t.jsx)(r.em,{children:"aTable"})," ; ",(0,t.jsx)(r.em,{children:"array"})," {; aTable2 ; ",(0,t.jsx)(r.em,{children:"array2"})," ; ... ; aTableN ; ",(0,t.jsx)(r.em,{children:"arrayN"}),"} )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Parameter"}),(0,t.jsx)(r.th,{children:"Type"}),(0,t.jsx)(r.th,{}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"start"}),(0,t.jsx)(r.td,{children:"Integer"}),(0,t.jsx)(r.td,{children:"\u2192"}),(0,t.jsx)(r.td,{children:"Selected record number where data retrieval starts"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"end"}),(0,t.jsx)(r.td,{children:"Integer"}),(0,t.jsx)(r.td,{children:"\u2192"}),(0,t.jsx)(r.td,{children:"Selected record number where data retrieval ends"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"aField | aTable"}),(0,t.jsx)(r.td,{children:"Field, Table"}),(0,t.jsx)(r.td,{children:"\u2192"}),(0,t.jsx)(r.td,{children:"Field to use for retrieving data or Table to use for retrieving record numbers"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"array"}),(0,t.jsx)(r.td,{children:"Array"}),(0,t.jsx)(r.td,{children:"\u2190"}),(0,t.jsx)(r.td,{children:"Array to receive field data or record numbers"})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," creates one or more arrays and copies data from the fields or record numbers from the current selection into the arrays."]}),"\n",(0,t.jsxs)(r.p,{children:["Unlike ",(0,t.jsx)(r.a,{href:"/docs/commands/selection-to-array",children:"SELECTION TO ARRAY"}),", which applies to the current selection in its entirety, ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," only applies to the range of selected records specified by the parameters ",(0,t.jsx)(r.em,{children:"start"})," and ",(0,t.jsx)(r.em,{children:"end"}),"."]}),"\n",(0,t.jsxs)(r.p,{children:["The command expects you to pass in ",(0,t.jsx)(r.em,{children:"start"})," and ",(0,t.jsx)(r.em,{children:"end"})," the selected record numbers complying with the formula ",(0,t.jsx)(r.em,{children:"1 <= start <= end <= Records in selection ([...])"}),"."]}),"\n",(0,t.jsxs)(r.p,{children:["If you pass ",(0,t.jsx)(r.em,{children:"1 <= start = end < Records in selection ([...])"}),", you will load fields or get the record number from the record whose selected record is ",(0,t.jsx)(r.em,{children:"start = end"}),"."]}),"\n",(0,t.jsx)(r.p,{children:"If you pass incorrect selected record numbers, the command does the following:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["If ",(0,t.jsx)(r.em,{children:"end > Records in selection ([...])"}),", it returns values from the selected record specified by ",(0,t.jsx)(r.em,{children:"start"})," to the last selected record."]}),"\n",(0,t.jsxs)(r.li,{children:["If ",(0,t.jsx)(r.em,{children:"start > end"}),", it returns values from the record whose selected record is ",(0,t.jsx)(r.em,{children:"start"})," only."]}),"\n",(0,t.jsx)(r.li,{children:"If both parameters are inconsistent with the size of the selection, it returns empty arrays."}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["Like ",(0,t.jsx)(r.a,{href:"/docs/commands/selection-to-array",children:"SELECTION TO ARRAY"}),", the ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," command applies to the selection for the table specified in the first parameter."]}),"\n",(0,t.jsxs)(r.p,{children:["Also like ",(0,t.jsx)(r.a,{href:"/docs/commands/selection-to-array",children:"SELECTION TO ARRAY"}),", ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," can perform the following:"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Load values from one or several fields."}),"\n",(0,t.jsxs)(r.li,{children:["Load Record numbers using the syntax ",(0,t.jsx)(r.em,{children:"...;[table];Array;..."})]}),"\n",(0,t.jsxs)(r.li,{children:["Load values from related fields, if there is a Many to One automatic relation between the tables or if you have previously called ",(0,t.jsx)(r.a,{href:"/docs/commands/set-automatic-relations",children:"SET AUTOMATIC RELATIONS"})," to change manual Many to One relations to automatic. In both cases, values can be loaded from tables through several levels of Many to One relations."]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"Each array is typed according to the field type."}),"\n",(0,t.jsxs)(r.p,{children:["When you apply ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," to a Time type field, it is important to note that they only create a Time type array if the array has not already been defined as another type. For example, in the following context, the ",(0,t.jsx)(r.em,{children:"myArray"})," array remains a Longint type array:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-4d",children:"\xa0ARRAY LONGINT(myArray;0)\n\xa0SELECTION TO ARRAY([myTable]myTimeField;myArray)\n"})}),"\n",(0,t.jsx)(r.p,{children:"If you load record numbers, they are copied into a Long Integer array."}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Note:"})," You can call the ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," command with just the ",(0,t.jsx)(r.em,{children:"start"})," and ",(0,t.jsx)(r.em,{children:"end"})," parameters. You use this special syntax to launch, on a limited selection, the execution of a deferred series of ",(0,t.jsx)(r.a,{href:"/docs/commands/selection-to-array",children:"SELECTION TO ARRAY"})," commands using the ",(0,t.jsx)(r.em,{children:"*"})," parameter (see example 4)."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"4D Server"}),": ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," is optimized for 4D Server. Each array is created on the server and then sent, in its entirety, to the client machine."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"WARNING:"})," ",(0,t.jsx)(r.strong,{children:"SELECTION RANGE TO ARRAY"})," can create large arrays, depending on the range you specify in ",(0,t.jsx)(r.em,{children:"start"})," and ",(0,t.jsx)(r.em,{children:"end,"})," and on the type and size of the data you are loading. Arrays reside in memory, so it is a good idea to test the result after the command is completed. To do so, test the size of each resulting array or cover the call to the command, using an ",(0,t.jsx)(r.a,{href:"/docs/commands/on-err-call",children:"ON ERR CALL"})," project method."]}),"\n",(0,t.jsxs)(r.p,{children:["If the command is successful, the size of each resulting array is equal to ",(0,t.jsx)(r.em,{children:"(end-start)+1"}),", except if the ",(0,t.jsx)(r.em,{children:"end"})," parameter exceeded the number of records in the selection. In such a case, each resulting array contains ",(0,t.jsx)(r.em,{children:"(Records in selection([...])-start)+1"})," elements."]}),"\n",(0,t.jsx)(r.h2,{id:"example-1",children:"Example 1"}),"\n",(0,t.jsxs)(r.p,{children:["The following code addresses the first 50 records from the current selection for the ",(0,t.jsx)(r.em,{children:"[Invoices]"})," table. It loads the values from the ",(0,t.jsx)(r.em,{children:"[Invoices]Invoice ID"})," field and the ",(0,t.jsx)(r.em,{children:"[Customers]Customer ID"})," related field."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-4d",children:"\xa0SELECTION RANGE TO ARRAY(1;50;[Invoices]Invoice ID;alInvoID;[Customers]Customer ID;alCustID)\n"})}),"\n",(0,t.jsx)(r.h2,{id:"example-2",children:"Example 2"}),"\n",(0,t.jsxs)(r.p,{children:["The following code addresses the last 50 records from the current selection for the ",(0,t.jsx)(r.em,{children:"[Invoices]"})," table. It loads the record numbers of the ",(0,t.jsx)(r.em,{children:"[Invoices]"})," records as well as those of the ",(0,t.jsx)(r.em,{children:"[Customers]"})," related records:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-4d",children:"\xa0lSelSize:=Records in selection([Invoices])\n\xa0SELECTION RANGE TO ARRAY(lSelSize-49;lSelSize;[Invoices];alInvRecN;[Customers];alCustRecN)\n"})}),"\n",(0,t.jsx)(r.h2,{id:"example-3",children:"Example 3"}),"\n",(0,t.jsx)(r.p,{children:"The following code process, in sequential \u201Cchunks\u201Dof 1000 records, a large selection that could not be downloaded in its entirety into arrays:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-4d",children:"\xa0lMaxPage:=1000\n\xa0lSelSize:=Records in selection([Phone Directory])\n\xa0For($lPage ;1;1+((lSelSize-1)\\lMaxPage))\n\xa0\xa0// Load the values and/or record numbers\n\xa0\xa0\xa0\xa0SELECTION RANGE TO ARRAY(1+(lMaxPage*($lPage-1));lMaxPage*$lPage;...;...;...;...;...;...)\n\xa0\xa0// Do something with the arrays\n\xa0End for\n"})}),"\n",(0,t.jsx)(r.h2,{id:"example-4",children:"Example 4"}),"\n",(0,t.jsx)(r.p,{children:"Use the first 50 current records of the [Invoices] table to load various arrays, in deferred execution:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-4d",children:"\xa0\xa0// Deferred statements\n\xa0SELECTION TO ARRAY([Invoices]InvoiceRef;arrLInvRef;*)\n\xa0SELECTION TO ARRAY([Invoices]Date;arrDInvDate;*)\n\xa0SELECTION TO ARRAY([Clients]ClientRef;arrLClientRef;*)\n\xa0\xa0// Execution of deferred statements\n\xa0SELECTION RANGE TO ARRAY(1;50)\n"})}),"\n",(0,t.jsx)(r.h2,{id:"see-also",children:"See also"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"/docs/commands/on-err-call",children:"ON ERR CALL"}),(0,t.jsx)(r.br,{}),"\n",(0,t.jsx)(r.a,{href:"/docs/commands/selection-to-array",children:"SELECTION TO ARRAY"}),(0,t.jsx)(r.br,{}),"\n",(0,t.jsx)(r.a,{href:"/docs/commands/set-automatic-relations",children:"SET AUTOMATIC RELATIONS"})]}),"\n",(0,t.jsx)(r.h2,{id:"properties",children:"Properties"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{}),(0,t.jsx)(r.th,{})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Command number"}),(0,t.jsx)(r.td,{children:"368"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Thread safe"}),(0,t.jsx)(r.td,{children:"\u2713"})]})]})]})]})}function h(e={}){let{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},250065:function(e,r,n){n.d(r,{Z:function(){return i},a:function(){return l}});var s=n(667294);let t={},a=s.createContext(t);function l(e){let r=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);