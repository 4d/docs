"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1147],{468839:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>i});var t=n(474848),s=n(28453);const d={id:"sql-get-last-error",title:"SQL GET LAST ERROR",slug:"/commands/sql-get-last-error",displayed_sidebar:"docs"},o=void 0,l={id:"commands-legacy/sql-get-last-error",title:"SQL GET LAST ERROR",description:"SQL GET LAST ERROR ( errCode ; errText ; errODBC ; errSQLServer )",source:"@site/versioned_docs/version-20-R7/commands-legacy/sql-get-last-error.md",sourceDirName:"commands-legacy",slug:"/commands/sql-get-last-error",permalink:"/docs/commands/sql-get-last-error",draft:!1,unlisted:!1,editUrl:"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands-legacy%2Fsql-get-last-error.md%20(20-R7)&body=Please%20enter%20your%20comment%3A",tags:[],version:"20-R7",frontMatter:{id:"sql-get-last-error",title:"SQL GET LAST ERROR",slug:"/commands/sql-get-last-error",displayed_sidebar:"docs"},sidebar:"docs",previous:{title:"SQL GET DATA SOURCE LIST",permalink:"/docs/commands/sql-get-data-source-list"},next:{title:"SQL GET OPTION",permalink:"/docs/commands/sql-get-option"}},c={},i=[{value:"Description",id:"description",level:4},{value:"See also",id:"see-also",level:4}];function a(e){const r={a:"a",br:"br",em:"em",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"SQL GET LAST ERROR"})," ( ",(0,t.jsx)(r.em,{children:"errCode"})," ; ",(0,t.jsx)(r.em,{children:"errText"})," ; ",(0,t.jsx)(r.em,{children:"errODBC"})," ; ",(0,t.jsx)(r.em,{children:"errSQLServer"})," )"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Parameter"}),(0,t.jsx)(r.th,{children:"Type"}),(0,t.jsx)(r.th,{}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"errCode"}),(0,t.jsx)(r.td,{children:"Integer"}),(0,t.jsx)(r.td,{children:"\u2190"}),(0,t.jsx)(r.td,{children:"Error code"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"errText"}),(0,t.jsx)(r.td,{children:"Text"}),(0,t.jsx)(r.td,{children:"\u2190"}),(0,t.jsx)(r.td,{children:"Error text"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"errODBC"}),(0,t.jsx)(r.td,{children:"Text"}),(0,t.jsx)(r.td,{children:"\u2190"}),(0,t.jsx)(r.td,{children:"ODBC error code"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"errSQLServer"}),(0,t.jsx)(r.td,{children:"Integer"}),(0,t.jsx)(r.td,{children:"\u2190"}),(0,t.jsx)(r.td,{children:"SQL server native error code"})]})]})]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.em,{children:"This command is not thread-safe, it cannot be used in preemptive code."})}),"\n",(0,t.jsx)(r.h4,{id:"description",children:"Description"}),"\n",(0,t.jsx)(r.p,{children:"The SQL GET LAST ERROR command returns information related to the last error encountered during the execution of an ODBC command. The error may come from the 4D application, the network, the ODBC source, etc."}),"\n",(0,t.jsxs)(r.p,{children:["This command must generally be called in the context of an error-handling method installed using the ",(0,t.jsx)(r.a,{href:"/docs/commands/on-err-call",children:"ON ERR CALL"})," command."]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["The ",(0,t.jsx)(r.em,{children:"errCode"})," parameter returns the error code."]}),"\n",(0,t.jsxs)(r.li,{children:["The ",(0,t.jsx)(r.em,{children:"errText"})," parameter returns the error text."]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"The last two parameters are only filled when the error comes from the ODBC source; otherwise, they are returned empty."}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["The ",(0,t.jsx)(r.em,{children:"errODBC"})," parameter returns the ODBC error code (SQL state)."]}),"\n",(0,t.jsxs)(r.li,{children:["The ",(0,t.jsx)(r.em,{children:"errSQLServer"})," parameter returns the SQL server native error code."]}),"\n"]}),"\n",(0,t.jsx)(r.h4,{id:"see-also",children:"See also"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"/docs/commands/last-errors",children:"Last errors"}),(0,t.jsx)(r.br,{}),"\n",(0,t.jsx)(r.a,{href:"/docs/commands/on-err-call",children:"ON ERR CALL"})]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var t=n(296540);const s={},d=t.createContext(s);function o(e){const r=t.useContext(d);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(d.Provider,{value:r},e.children)}}}]);