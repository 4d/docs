"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["32961"],{646895:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>t,toc:()=>i,default:()=>h,metadata:()=>l,assets:()=>c,contentTitle:()=>o});var l=JSON.parse('{"id":"commands/formula","title":"Formula","description":"History","source":"@site/versioned_docs/version-20-R10/commands/formula.md","sourceDirName":"commands","slug":"/commands/formula","permalink":"/docs/20-R10/commands/formula","draft":false,"unlisted":false,"editUrl":"https://github.com/4d/docs/issues/new?title=Comment%20on%20commands%2Fformula.md%20(20-R10)&body=Please%20enter%20your%20comment%3A","tags":[],"version":"20-R10","frontMatter":{"id":"formula","title":"Formula","slug":"/commands/formula","displayed_sidebar":"docs"},"sidebar":"docs","previous":{"title":"EXECUTE FORMULA","permalink":"/docs/20-R10/commands/execute-formula"},"next":{"title":"Formula from string","permalink":"/docs/20-R10/commands/formula-from-string"}}'),s=r(474848),a=r(884429);let t={id:"formula",title:"Formula",slug:"/commands/formula",displayed_sidebar:"docs"},o,c={},i=[{value:"Description",id:"description",level:2},{value:"Example 1",id:"example-1",level:2},{value:"Example 2",id:"example-2",level:2},{value:"Example 3",id:"example-3",level:2},{value:"Example 4",id:"example-4",level:2},{value:"Example 5",id:"example-5",level:2},{value:"Example 6",id:"example-6",level:2},{value:"See also",id:"see-also",level:2},{value:"Properties",id:"properties",level:2}];function d(e){let n={a:"a",br:"br",code:"code",details:"details",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",summary:"summary",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.details,{children:[(0,s.jsx)(n.summary,{children:"History"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Release"}),(0,s.jsx)(n.th,{children:"Changes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"17 R6"}),(0,s.jsx)(n.td,{children:"Renamed (New formula -> Formula)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"17 R3"}),(0,s.jsx)(n.td,{children:"Added"})]})]})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Formula"})," ( ",(0,s.jsx)(n.em,{children:"formulaExp"})," : Expression ) : 4D.Function"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{style:{textAlign:"center"}}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"formulaExp"}),(0,s.jsx)(n.td,{children:"Expression"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u2192"}),(0,s.jsx)(n.td,{children:"Formula to be returned as object"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Result"}),(0,s.jsx)(n.td,{children:"4D.Function"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u2190"}),(0,s.jsx)(n.td,{children:"Native function encapsulating the formula"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Formula"})," command creates a ",(0,s.jsx)(n.code,{children:"4D Function"})," object based upon the ",(0,s.jsx)(n.em,{children:"formulaExp"})," expression. ",(0,s.jsx)(n.em,{children:"formulaExp"})," can be as simple as a single value or complex, such as a project method with parameters."]}),"\n",(0,s.jsx)(n.p,{children:'Having a formula as an object allows it to be passed as a parameter (calculated attribute) to commands or methods or to be executed from various components without needing to declare them as "shared by components and host database". When called, the formula object is evaluated within the context of the database or component that created it.'}),"\n",(0,s.jsx)(n.p,{children:"The returned formula can be called with:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/20-R10/API/FunctionClass#call",children:(0,s.jsx)(n.code,{children:".call()"})})," or ",(0,s.jsx)(n.a,{href:"/docs/20-R10/API/FunctionClass#apply",children:(0,s.jsx)(n.code,{children:".apply()"})})," methods, or"]}),"\n",(0,s.jsxs)(n.li,{children:["object notation syntax (see ",(0,s.jsx)(n.a,{href:"../commands/formula.md-object",children:"formula object"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' var $f : 4D.Function\n $f:=Formula(1+2)\n $o:=New object("myFormula";$f)\n\n  //three different ways to call the formula\n $f.call($o) //returns 3\n $f.apply($o) //returns 3\n $o.myFormula() //returns 3\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can pass ",(0,s.jsx)(n.a,{href:"/docs/20-R10/API/FunctionClass#passing-parameters",children:"parameters"})," to the ",(0,s.jsx)(n.code,{children:"Formula"}),", as seen below in ",(0,s.jsx)(n.a,{href:"#example-4",children:"example 4"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can specify the object on which the formula is executed, as seen in ",(0,s.jsx)(n.a,{href:"#example-5",children:"example 5"}),". The properties of the object can then be accessed via the ",(0,s.jsx)(n.code,{children:"This"})," command."]}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.em,{children:"formulaExp"})," uses local variables, their values are copied and stored in the returned formula object when it is created. When executed, the formula uses these copied values rather than the current value of the local variables. Note that using arrays as local variables is not supported."]}),"\n",(0,s.jsxs)(n.p,{children:["The object created by ",(0,s.jsx)(n.code,{children:"Formula"})," can be saved, for example, in a database field or in a blob document."]}),"\n",(0,s.jsx)(n.h2,{id:"example-1",children:"Example 1"}),"\n",(0,s.jsx)(n.p,{children:"A simple formula:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' var $f : 4D.Function\n $f:=Formula(1+2)\n\n var $o : Object\n $o:=New object("f";$f)\n\n $result:=$o.f() // returns 3\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-2",children:"Example 2"}),"\n",(0,s.jsx)(n.p,{children:"A formula using local variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:'\n\n $value:=10\n $o:=New object("f";Formula($value))\n $value:=20\n\n $result:=$o.f() // returns 10\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-3",children:"Example 3"}),"\n",(0,s.jsx)(n.p,{children:"A simple formula using parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' $o:=New object("f";Formula($1+$2))\n $result:=$o.f(10;20) //returns 30\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-4",children:"Example 4"}),"\n",(0,s.jsx)(n.p,{children:"A formula using a project method with parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' $o:=New object("f";Formula(myMethod))\n $result:=$o.f("param1";"param2") // equivalent to $result:=myMethod("param1";"param2")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-5",children:"Example 5"}),"\n",(0,s.jsxs)(n.p,{children:["Using ",(0,s.jsx)(n.code,{children:"This"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' $o:=New object("fullName";Formula(This.firstName+" "+This.lastName))\n $o.firstName:="John"\n $o.lastName:="Smith"\n $result:=$o.fullName() //returns "John Smith"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-6",children:"Example 6"}),"\n",(0,s.jsx)(n.p,{children:"Calling a formula using object notation:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-4d",children:' var $feta; $robot : Object\n var $calc : 4D.Function\n $robot:=New object("name";"Robot";"price";543;"quantity";2)\n $feta:=New object("name";"Feta";"price";12.5;"quantity";5)\n\n $calc:=Formula(This.total:=This.price*This.quantity)\n\n  //sets the formula to object properties\n $feta.calc:=$calc\n $robot.calc:=$calc\n\n  //call the formula\n $feta.calc() // $feta={name:Feta,price:12.5,quantity:5,total:62.5,calc:"[object Formula]"}\n $robot.calc() // $robot={name:Robot,price:543,quantity:2,total:1086,calc:"[object Formula]"}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://blog.4d.com/new-formula-more-power-behind-simplicity/",children:"4D Blog - Formula: More power behind simplicity"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://blog.4d.com/new-formula-think-outside-the-box/",children:"4D Blog - Formula: Think outside the box"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"https://blog.4d.com/write-your-own-methods-for-objects/",children:"4D Blog - Write your own methods for objects"}),(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.a,{href:"/docs/20-R10/commands/formula-from-string",children:"Formula from string"})]}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{}),(0,s.jsx)(n.th,{})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Command number"}),(0,s.jsx)(n.td,{children:"1597"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Thread safe"}),(0,s.jsx)(n.td,{children:"yes"})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},884429:function(e,n,r){r.d(n,{R:()=>t,x:()=>o});var l=r(296540);let s={},a=l.createContext(s);function t(e){let n=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(a.Provider,{value:n},e.children)}}}]);